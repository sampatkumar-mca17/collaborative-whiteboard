import{B as jl,C as Vl,F as Hl,G as Ul,H as Oa,I as $n,J as vx,K as bx,N as yf,O as xx,P as _x,Q as Ma,R as Sa,S as yx,T as Cx,U as Gl,V as Vo,W as sr,X as Ho,Z as wx,_ as Px,e as hx,o as px,p as fx,r as ui,s as xf,t as gx,u as Bl,v as Ll,w as jo,x as ql,y as _f,z as mx}from"./chunk-TCVX4O3S.js";import{a as Ox}from"./chunk-TIWCUDTS.js";import{$a as pf,A as hf,Ab as K,B as Dl,Bb as ne,Bc as Nl,C as Zi,Cb as ff,Cc as Ca,Db as ir,Ea as Bo,Eb as di,Ec as Kn,Fb as Ct,Fc as ux,Gb as We,Gc as vf,Hb as Ke,Hc as wa,I as Fl,Ib as wr,Ic as Pa,Jb as ot,Jc as bf,Kb as _a,Lb as to,Mb as pn,Nb as xe,Ob as tx,Pb as nx,Qb as rx,R as $b,Ra as Jb,S as Xb,Sa as xa,T as zl,Ua as U,Ub as ix,V as No,Va as X,X as Il,Xa as Qb,Xb as ox,Y as eo,Z as Et,Za as Yb,Zb as or,_ as At,a as jb,aa as it,bb as Wt,c as Vb,ca as pt,cc as gf,da as hn,f as nt,fb as Gn,fc as no,g as kl,ha as tn,ia as fe,ja as kt,k as Hb,ka as Ye,kb as Ae,kc as sx,lb as me,mb as ee,mc as qo,nb as Nn,nc as ya,o as Ub,ob as Ie,oc as ax,p as Gb,pa as nr,pb as Zb,pc as cx,qa as se,qb as ex,qc as lx,ra as ae,rb as wn,rc as mf,sa as ce,sb as L,sc as dx,t as Wb,ta as rr,tb as j,tc as Wn,ua as Rl,ub as Z,va as Cr,vb as ci,wb as li,xa as mt,xb as yt,y as Tl,ya as ie,yb as Lo,z as Kb}from"./chunk-CW5SESIC.js";import{a as Nt,b as ai,d as W,e as z,f as Yi,g as Ce,h as en,i as tr,j as v}from"./chunk-SO6VPFYA.js";function w(n,e){if(!n)throw new Error(typeof e=="number"?`0x${e.toString(16).padStart(3,"0")}`:e)}var Va=W(()=>{});function Pn(n,e){switch(e){case"base64":return pd.fromByteArray(n);case"utf8":case"utf-8":case void 0:return new TextDecoder().decode(n);default:throw new Error("invalid/unsupported encoding")}}function ng(n){let e=n;return n instanceof ArrayBuffer||typeof e=="object"&&e!==null&&typeof e.byteLength=="number"&&typeof e.slice=="function"&&e.byteOffset===void 0&&e.buffer===void 0}var pd,Bn,pi,Kt,rg=W(()=>{pd=Ce(Ox());Va();Bn=(n,e)=>Kt.from(n,e).buffer,pi=(n,e)=>Kt.from(n).toString(e);Kt=class n extends Uint8Array{toString(e){return Pn(this,e)}static from(e,t,r){if(typeof e=="string")return n.fromString(e,t);if(e!==null&&typeof e=="object"&&ng(e.buffer))return w(e.byteOffset===0,0),w(e.byteLength===e.buffer.byteLength,1),n.fromArrayBuffer(e.buffer,t,r);if(ng(e))return n.fromArrayBuffer(e,t,r);throw new TypeError}static fromArrayBuffer(e,t,r){let i=t??0,o=r??e.byteLength-i;if(i<0||i>e.byteLength||o<0||o+i>e.byteLength)throw new RangeError;return new n(e,i,o)}static fromString(e,t){switch(t){case"base64":{let r=this.sanitizeBase64(e),i=pd.toByteArray(r);return new n(i.buffer)}case"utf8":case"utf-8":case void 0:{let r=new TextEncoder().encode(e);return new n(r.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0&&(t+=["","===","==","="][t.length%4]),t}}});function gF(n,e){return v(this,null,function*(){let t=yield crypto.subtle.digest(e,n);return new Uint8Array(t)})}function mF(n,e){switch(e){case"hex":return Array.prototype.map.call(n,r=>r.toString(16).padStart(2,"0")).join("");case"base64":return cy.fromByteArray(n)}}function ly(n,e="SHA-1",t="hex"){return v(this,null,function*(){if(crypto.subtle===void 0)return import("./chunk-KRUCD4QG.js").then(i=>v(this,null,function*(){return i.hashFile(n,e,t)}));let r=yield gF(n,e);return mF(r,t)})}function ig(n){return v(this,null,function*(){let t=`blob ${n.byteLength.toString()}\0`,r=Kt.from(t+n.toString());return ly(r)})}var cy,dy=W(()=>{cy=Ce(Ox());rg();});var de,uy=W(()=>{de=window.performance});var fd=W(()=>{rg();dy();uy();});var og,Ha,vF,hy=W(()=>{fd();og=n=>Kt.from(n,"base64").toString("utf-8"),Ha=n=>Kt.from(n,"utf8").toString("base64"),vF=(n,e)=>{switch(e){case"utf8":case"utf-8":return n;default:return Kt.from(n,e).toString()}}});var sg,py=W(()=>{sg=class{constructor(e,t=100){this.process=e,this.maxBatchSize=t,this.pendingWork=new Map}add(e,t){this.pendingWork.has(e)||this.pendingWork.set(e,[]),this.pendingWork.get(e).push(t),this.pendingWork.get(e).length>=this.maxBatchSize?(this.pendingTimer!==void 0&&clearTimeout(this.pendingTimer),this.pendingTimer=void 0,this.startWork()):this.pendingTimer===void 0&&(this.pendingTimer=setTimeout(()=>{this.pendingTimer=void 0,this.startWork()},0))}drain(){this.startWork()}startWork(){let e=this.pendingWork;this.pendingWork=new Map;for(let[t,r]of e)this.process(t,r)}}});function ao(n,e){return(...t)=>{if(n.disposed)throw new Error("Already disposed");return e(...t)}}var fy=W(()=>{});var fi=z((NY,ag)=>{"use strict";var Qo=typeof Reflect=="object"?Reflect:null,gy=Qo&&typeof Qo.apply=="function"?Qo.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},gd;Qo&&typeof Qo.ownKeys=="function"?gd=Qo.ownKeys:Object.getOwnPropertySymbols?gd=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:gd=function(e){return Object.getOwnPropertyNames(e)};function bF(n){console&&console.warn&&console.warn(n)}var vy=Number.isNaN||function(e){return e!==e};function Ze(){Ze.init.call(this)}ag.exports=Ze;ag.exports.once=CF;Ze.EventEmitter=Ze;Ze.prototype._events=void 0;Ze.prototype._eventsCount=0;Ze.prototype._maxListeners=void 0;var my=10;function md(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Ze,"defaultMaxListeners",{enumerable:!0,get:function(){return my},set:function(n){if(typeof n!="number"||n<0||vy(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");my=n}});Ze.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ze.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||vy(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function by(n){return n._maxListeners===void 0?Ze.defaultMaxListeners:n._maxListeners}Ze.prototype.getMaxListeners=function(){return by(this)};Ze.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")gy(c,this,t);else for(var l=c.length,h=wy(c,l),r=0;r<l;++r)gy(h[r],this,t);return!0};function xy(n,e,t,r){var i,o,s;if(md(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),s=o[e]),s===void 0)s=o[e]=t,++n._eventsCount;else if(typeof s=="function"?s=o[e]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),i=by(n),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=s.length,bF(a)}return n}Ze.prototype.addListener=function(e,t){return xy(this,e,t,!1)};Ze.prototype.on=Ze.prototype.addListener;Ze.prototype.prependListener=function(e,t){return xy(this,e,t,!0)};function xF(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _y(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=xF.bind(r);return i.listener=t,r.wrapFn=i,i}Ze.prototype.once=function(e,t){return md(t),this.on(e,_y(this,e,t)),this};Ze.prototype.prependOnceListener=function(e,t){return md(t),this.prependListener(e,_y(this,e,t)),this};Ze.prototype.removeListener=function(e,t){var r,i,o,s,a;if(md(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():_F(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Ze.prototype.off=Ze.prototype.removeListener;Ze.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function yy(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?yF(i):wy(i,i.length)}Ze.prototype.listeners=function(e){return yy(this,e,!0)};Ze.prototype.rawListeners=function(e){return yy(this,e,!1)};Ze.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):Cy.call(n,e)};Ze.prototype.listenerCount=Cy;function Cy(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ze.prototype.eventNames=function(){return this._eventsCount>0?gd(this._events):[]};function wy(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function _F(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function yF(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function CF(n,e){return new Promise(function(t,r){function i(s){n.removeListener(e,o),r(s)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}Py(n,e,o,{once:!0}),e!=="error"&&wF(n,i,{once:!0})})}function wF(n,e,t){typeof n.on=="function"&&Py(n,"error",e,t)}function Py(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}});var Oy,we,cg=W(()=>{Oy=Ce(fi());we=class extends Oy.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}});var gi,My=W(()=>{cg();gi=(()=>{class n extends we{constructor(t){if(super(),this.isDisposed=!1,this.forwardingEvents=new Map,t!==void 0){let r=o=>this.unforwardEvent(t,o),i=o=>this.forwardEvent(t,o);this.on(n.removeListenerEvent,r),this.on(n.newListenerEvent,i)}}static isEmitterEvent(t){return t===n.newListenerEvent||t===n.removeListenerEvent}get disposed(){return this.isDisposed}dispose(){this.isDisposed=!0;for(let t of this.forwardingEvents.values())for(let r of t.values())try{r()}catch{}this.removeAllListeners(),this.forwardingEvents.clear()}forwardEvent(t,...r){for(let i of r)if(t!==void 0&&i!==void 0&&!n.isEmitterEvent(i)){let o=this.forwardingEvents.get(i);if(o===void 0&&(o=new Map,this.forwardingEvents.set(i,o)),!o.has(t)){let s=(...a)=>this.emit(i,...a);o.set(t,()=>t.off(i,s)),t.on(i,s)}}}unforwardEvent(t,...r){for(let i of r)if(i!==void 0&&!n.isEmitterEvent(i)){let o=this.forwardingEvents.get(i);if(o?.has(t)&&this.listenerCount(i)===0){let s=o.get(t);s!==void 0&&s(),o.delete(t),o.size===0&&this.forwardingEvents.delete(i)}}}}return n.newListenerEvent="newListener",n.removeListenerEvent="removeListener",n})()});var PF,lg,Sy=W(()=>{PF={compare:(n,e)=>n-e,min:Number.MIN_VALUE},lg=class{constructor(e){this.comp=e,this.L=[{value:e.min,position:0}]}peek(){return this.L[1]}get(){this.swap(1,this.count());let e=this.L.pop();return this.fixdown(1),e.value}add(e){let t={value:e,position:this.L.length};return this.L.push(t),this.fixup(this.count()),t}update(e){let t=e.position;this.isGreaterThanParent(t)?this.fixup(t):this.fixdown(t)}remove(e){let t=e.position;this.swap(e.position,this.L.length-1),this.L.splice(this.L.length-1),t!==this.L.length&&this.update(this.L[t])}count(){return this.L.length-1}fixup(e){let t=e;for(;this.isGreaterThanParent(t);){let r=t>>1;this.swap(t,r),t=r}}isGreaterThanParent(e){return e>1&&this.comp.compare(this.L[e>>1].value,this.L[e].value)>0}fixdown(e){let t=e;for(;t<<1<=this.count();){let r=t<<1;if(r<this.count()&&this.comp.compare(this.L[r].value,this.L[r+1].value)>0&&r++,this.comp.compare(this.L[t].value,this.L[r].value)<=0)break;this.swap(t,r),t=r}}swap(e,t){let r=this.L[e];this.L[e]=this.L[t],this.L[e].position=e,this.L[t]=r,this.L[t].position=t}}});function dg(n){let e=o=>o!==null&&!Array.isArray(o)&&typeof o=="object",t=(o,s)=>{let a=o.split(`
`);return a.shift(),s!==void 0&&a.unshift(s),a.join(`
`)},i={message:typeof n?.message=="string"?n.message:String(n)};if(e(n)){let{errorType:o,stack:s,name:a}=n;if(typeof o=="string"&&(i.errorType=o),typeof s=="string"){let c=typeof a=="string"?a:void 0;i.stack=t(s,c)}}return i}var Ua,Ga,Ey=W(()=>{Ua=class{send(e){}},Ga=class{send(e){}sendTelemetryEvent(e,t){}sendErrorEvent(e,t){}sendPerformanceEvent(e,t){}}});var ug,hg,Ay=W(()=>{ug=class{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){this.expiry.policy!=="indefinite"&&this.gcTimeouts.set(e,setTimeout(()=>{this.cleanup(e),this.cancel(e)},this.expiry.durationMs))}cancel(e){let t=this.gcTimeouts.get(e);t!==void 0&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){this.expiry.policy==="sliding"&&(this.cancel(e),this.schedule(e))}},hg=class{constructor({expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}={}){this.cache=new Map,this.removeOnError=t,this.gc=new ug(e,r=>this.remove(r))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}addOrGet(e,t){return v(this,null,function*(){let r=this.get(e);return r===void 0&&(r=v(this,null,function*(){return t()}),this.cache.set(e,r),r.catch(o=>{this.removeOnError(o)&&this.remove(e)}),this.gc.schedule(e)),r})}add(e,t){let r=this.has(e);return this.addOrGet(e,t).catch(()=>{}),!r}addValueOrGet(e,t){return v(this,null,function*(){return this.addOrGet(e,()=>v(this,null,function*(){return t}))})}addValue(e,t){return this.add(e,()=>v(this,null,function*(){return t}))}}});var Se,Lt,pg=W(()=>{Se=class{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){this.res!==void 0&&(this.completed=!0,this.res(e))}reject(e){this.rej!==void 0&&(this.completed=!0,this.rej(e))}},Lt=class{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}then(r,i){return v(this,arguments,function*(e,t){return this.getPromise().then(...arguments)})}catch(t){return v(this,arguments,function*(e){return this.getPromise().catch(...arguments)})}finally(t){return v(this,arguments,function*(e){return this.getPromise().finally(...arguments)})}getPromise(){return v(this,null,function*(){return this.result===void 0&&(this.result=this.execute()),this.result})}}});var Ty=z((KY,ky)=>{function OF(){this.__data__=[],this.size=0}ky.exports=OF});var Wa=z(($Y,Dy)=>{function MF(n,e){return n===e||n!==n&&e!==e}Dy.exports=MF});var Ka=z((XY,Fy)=>{var SF=Wa();function EF(n,e){for(var t=n.length;t--;)if(SF(n[t][0],e))return t;return-1}Fy.exports=EF});var Iy=z((JY,zy)=>{var AF=Ka(),kF=Array.prototype,TF=kF.splice;function DF(n){var e=this.__data__,t=AF(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():TF.call(e,t,1),--this.size,!0}zy.exports=DF});var Ny=z((QY,Ry)=>{var FF=Ka();function zF(n){var e=this.__data__,t=FF(e,n);return t<0?void 0:e[t][1]}Ry.exports=zF});var Ly=z((YY,By)=>{var IF=Ka();function RF(n){return IF(this.__data__,n)>-1}By.exports=RF});var jy=z((ZY,qy)=>{var NF=Ka();function BF(n,e){var t=this.__data__,r=NF(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}qy.exports=BF});var $a=z((eZ,Vy)=>{var LF=Ty(),qF=Iy(),jF=Ny(),VF=Ly(),HF=jy();function Yo(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Yo.prototype.clear=LF;Yo.prototype.delete=qF;Yo.prototype.get=jF;Yo.prototype.has=VF;Yo.prototype.set=HF;Vy.exports=Yo});var Uy=z((tZ,Hy)=>{var UF=$a();function GF(){this.__data__=new UF,this.size=0}Hy.exports=GF});var Wy=z((nZ,Gy)=>{function WF(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}Gy.exports=WF});var $y=z((rZ,Ky)=>{function KF(n){return this.__data__.get(n)}Ky.exports=KF});var Jy=z((iZ,Xy)=>{function $F(n){return this.__data__.has(n)}Xy.exports=$F});var fg=z((oZ,Qy)=>{var XF=typeof global=="object"&&global&&global.Object===Object&&global;Qy.exports=XF});var dr=z((sZ,Yy)=>{var JF=fg(),QF=typeof self=="object"&&self&&self.Object===Object&&self,YF=JF||QF||Function("return this")();Yy.exports=YF});var vd=z((aZ,Zy)=>{var ZF=dr(),e6=ZF.Symbol;Zy.exports=e6});var r1=z((cZ,n1)=>{var e1=vd(),t1=Object.prototype,t6=t1.hasOwnProperty,n6=t1.toString,Xa=e1?e1.toStringTag:void 0;function r6(n){var e=t6.call(n,Xa),t=n[Xa];try{n[Xa]=void 0;var r=!0}catch{}var i=n6.call(n);return r&&(e?n[Xa]=t:delete n[Xa]),i}n1.exports=r6});var o1=z((lZ,i1)=>{var i6=Object.prototype,o6=i6.toString;function s6(n){return o6.call(n)}i1.exports=s6});var Zo=z((dZ,c1)=>{var s1=vd(),a6=r1(),c6=o1(),l6="[object Null]",d6="[object Undefined]",a1=s1?s1.toStringTag:void 0;function u6(n){return n==null?n===void 0?d6:l6:a1&&a1 in Object(n)?a6(n):c6(n)}c1.exports=u6});var jr=z((uZ,l1)=>{function h6(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}l1.exports=h6});var bd=z((hZ,d1)=>{var p6=Zo(),f6=jr(),g6="[object AsyncFunction]",m6="[object Function]",v6="[object GeneratorFunction]",b6="[object Proxy]";function x6(n){if(!f6(n))return!1;var e=p6(n);return e==m6||e==v6||e==g6||e==b6}d1.exports=x6});var h1=z((pZ,u1)=>{var _6=dr(),y6=_6["__core-js_shared__"];u1.exports=y6});var g1=z((fZ,f1)=>{var gg=h1(),p1=function(){var n=/[^.]+$/.exec(gg&&gg.keys&&gg.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function C6(n){return!!p1&&p1 in n}f1.exports=C6});var mg=z((gZ,m1)=>{var w6=Function.prototype,P6=w6.toString;function O6(n){if(n!=null){try{return P6.call(n)}catch{}try{return n+""}catch{}}return""}m1.exports=O6});var b1=z((mZ,v1)=>{var M6=bd(),S6=g1(),E6=jr(),A6=mg(),k6=/[\\^$.*+?()[\]{}|]/g,T6=/^\[object .+?Constructor\]$/,D6=Function.prototype,F6=Object.prototype,z6=D6.toString,I6=F6.hasOwnProperty,R6=RegExp("^"+z6.call(I6).replace(k6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function N6(n){if(!E6(n)||S6(n))return!1;var e=M6(n)?R6:T6;return e.test(A6(n))}v1.exports=N6});var _1=z((vZ,x1)=>{function B6(n,e){return n?.[e]}x1.exports=B6});var mi=z((bZ,y1)=>{var L6=b1(),q6=_1();function j6(n,e){var t=q6(n,e);return L6(t)?t:void 0}y1.exports=j6});var xd=z((xZ,C1)=>{var V6=mi(),H6=dr(),U6=V6(H6,"Map");C1.exports=U6});var Ja=z((_Z,w1)=>{var G6=mi(),W6=G6(Object,"create");w1.exports=W6});var M1=z((yZ,O1)=>{var P1=Ja();function K6(){this.__data__=P1?P1(null):{},this.size=0}O1.exports=K6});var E1=z((CZ,S1)=>{function $6(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}S1.exports=$6});var k1=z((wZ,A1)=>{var X6=Ja(),J6="__lodash_hash_undefined__",Q6=Object.prototype,Y6=Q6.hasOwnProperty;function Z6(n){var e=this.__data__;if(X6){var t=e[n];return t===J6?void 0:t}return Y6.call(e,n)?e[n]:void 0}A1.exports=Z6});var D1=z((PZ,T1)=>{var ez=Ja(),tz=Object.prototype,nz=tz.hasOwnProperty;function rz(n){var e=this.__data__;return ez?e[n]!==void 0:nz.call(e,n)}T1.exports=rz});var z1=z((OZ,F1)=>{var iz=Ja(),oz="__lodash_hash_undefined__";function sz(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=iz&&e===void 0?oz:e,this}F1.exports=sz});var R1=z((MZ,I1)=>{var az=M1(),cz=E1(),lz=k1(),dz=D1(),uz=z1();function es(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}es.prototype.clear=az;es.prototype.delete=cz;es.prototype.get=lz;es.prototype.has=dz;es.prototype.set=uz;I1.exports=es});var L1=z((SZ,B1)=>{var N1=R1(),hz=$a(),pz=xd();function fz(){this.size=0,this.__data__={hash:new N1,map:new(pz||hz),string:new N1}}B1.exports=fz});var j1=z((EZ,q1)=>{function gz(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}q1.exports=gz});var Qa=z((AZ,V1)=>{var mz=j1();function vz(n,e){var t=n.__data__;return mz(e)?t[typeof e=="string"?"string":"hash"]:t.map}V1.exports=vz});var U1=z((kZ,H1)=>{var bz=Qa();function xz(n){var e=bz(this,n).delete(n);return this.size-=e?1:0,e}H1.exports=xz});var W1=z((TZ,G1)=>{var _z=Qa();function yz(n){return _z(this,n).get(n)}G1.exports=yz});var $1=z((DZ,K1)=>{var Cz=Qa();function wz(n){return Cz(this,n).has(n)}K1.exports=wz});var J1=z((FZ,X1)=>{var Pz=Qa();function Oz(n,e){var t=Pz(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}X1.exports=Oz});var Y1=z((zZ,Q1)=>{var Mz=L1(),Sz=U1(),Ez=W1(),Az=$1(),kz=J1();function ts(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}ts.prototype.clear=Mz;ts.prototype.delete=Sz;ts.prototype.get=Ez;ts.prototype.has=Az;ts.prototype.set=kz;Q1.exports=ts});var eC=z((IZ,Z1)=>{var Tz=$a(),Dz=xd(),Fz=Y1(),zz=200;function Iz(n,e){var t=this.__data__;if(t instanceof Tz){var r=t.__data__;if(!Dz||r.length<zz-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Fz(r)}return t.set(n,e),this.size=t.size,this}Z1.exports=Iz});var vg=z((RZ,tC)=>{var Rz=$a(),Nz=Uy(),Bz=Wy(),Lz=$y(),qz=Jy(),jz=eC();function ns(n){var e=this.__data__=new Rz(n);this.size=e.size}ns.prototype.clear=Nz;ns.prototype.delete=Bz;ns.prototype.get=Lz;ns.prototype.has=qz;ns.prototype.set=jz;tC.exports=ns});var rC=z((NZ,nC)=>{function Vz(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}nC.exports=Vz});var bg=z((BZ,iC)=>{var Hz=mi(),Uz=function(){try{var n=Hz(Object,"defineProperty");return n({},"",{}),n}catch{}}();iC.exports=Uz});var _d=z((LZ,sC)=>{var oC=bg();function Gz(n,e,t){e=="__proto__"&&oC?oC(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}sC.exports=Gz});var xg=z((qZ,aC)=>{var Wz=_d(),Kz=Wa(),$z=Object.prototype,Xz=$z.hasOwnProperty;function Jz(n,e,t){var r=n[e];(!(Xz.call(n,e)&&Kz(r,t))||t===void 0&&!(e in n))&&Wz(n,e,t)}aC.exports=Jz});var rs=z((jZ,cC)=>{var Qz=xg(),Yz=_d();function Zz(n,e,t,r){var i=!t;t||(t={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=r?r(t[a],n[a],a,t,n):void 0;c===void 0&&(c=n[a]),i?Yz(t,a,c):Qz(t,a,c)}return t}cC.exports=Zz});var dC=z((VZ,lC)=>{function eI(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}lC.exports=eI});var vi=z((HZ,uC)=>{function tI(n){return n!=null&&typeof n=="object"}uC.exports=tI});var pC=z((UZ,hC)=>{var nI=Zo(),rI=vi(),iI="[object Arguments]";function oI(n){return rI(n)&&nI(n)==iI}hC.exports=oI});var _g=z((GZ,mC)=>{var fC=pC(),sI=vi(),gC=Object.prototype,aI=gC.hasOwnProperty,cI=gC.propertyIsEnumerable,lI=fC(function(){return arguments}())?fC:function(n){return sI(n)&&aI.call(n,"callee")&&!cI.call(n,"callee")};mC.exports=lI});var Ya=z((WZ,vC)=>{var dI=Array.isArray;vC.exports=dI});var xC=z((KZ,bC)=>{function uI(){return!1}bC.exports=uI});var yd=z((Za,is)=>{var hI=dr(),pI=xC(),CC=typeof Za=="object"&&Za&&!Za.nodeType&&Za,_C=CC&&typeof is=="object"&&is&&!is.nodeType&&is,fI=_C&&_C.exports===CC,yC=fI?hI.Buffer:void 0,gI=yC?yC.isBuffer:void 0,mI=gI||pI;is.exports=mI});var yg=z(($Z,wC)=>{var vI=9007199254740991,bI=/^(?:0|[1-9]\d*)$/;function xI(n,e){var t=typeof n;return e=e??vI,!!e&&(t=="number"||t!="symbol"&&bI.test(n))&&n>-1&&n%1==0&&n<e}wC.exports=xI});var Cg=z((XZ,PC)=>{var _I=9007199254740991;function yI(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=_I}PC.exports=yI});var MC=z((JZ,OC)=>{var CI=Zo(),wI=Cg(),PI=vi(),OI="[object Arguments]",MI="[object Array]",SI="[object Boolean]",EI="[object Date]",AI="[object Error]",kI="[object Function]",TI="[object Map]",DI="[object Number]",FI="[object Object]",zI="[object RegExp]",II="[object Set]",RI="[object String]",NI="[object WeakMap]",BI="[object ArrayBuffer]",LI="[object DataView]",qI="[object Float32Array]",jI="[object Float64Array]",VI="[object Int8Array]",HI="[object Int16Array]",UI="[object Int32Array]",GI="[object Uint8Array]",WI="[object Uint8ClampedArray]",KI="[object Uint16Array]",$I="[object Uint32Array]",ft={};ft[qI]=ft[jI]=ft[VI]=ft[HI]=ft[UI]=ft[GI]=ft[WI]=ft[KI]=ft[$I]=!0;ft[OI]=ft[MI]=ft[BI]=ft[SI]=ft[LI]=ft[EI]=ft[AI]=ft[kI]=ft[TI]=ft[DI]=ft[FI]=ft[zI]=ft[II]=ft[RI]=ft[NI]=!1;function XI(n){return PI(n)&&wI(n.length)&&!!ft[CI(n)]}OC.exports=XI});var Cd=z((QZ,SC)=>{function JI(n){return function(e){return n(e)}}SC.exports=JI});var wd=z((ec,os)=>{var QI=fg(),EC=typeof ec=="object"&&ec&&!ec.nodeType&&ec,tc=EC&&typeof os=="object"&&os&&!os.nodeType&&os,YI=tc&&tc.exports===EC,wg=YI&&QI.process,ZI=function(){try{var n=tc&&tc.require&&tc.require("util").types;return n||wg&&wg.binding&&wg.binding("util")}catch{}}();os.exports=ZI});var Pg=z((YZ,TC)=>{var e8=MC(),t8=Cd(),AC=wd(),kC=AC&&AC.isTypedArray,n8=kC?t8(kC):e8;TC.exports=n8});var Og=z((ZZ,DC)=>{var r8=dC(),i8=_g(),o8=Ya(),s8=yd(),a8=yg(),c8=Pg(),l8=Object.prototype,d8=l8.hasOwnProperty;function u8(n,e){var t=o8(n),r=!t&&i8(n),i=!t&&!r&&s8(n),o=!t&&!r&&!i&&c8(n),s=t||r||i||o,a=s?r8(n.length,String):[],c=a.length;for(var l in n)(e||d8.call(n,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||a8(l,c)))&&a.push(l);return a}DC.exports=u8});var Pd=z((eee,FC)=>{var h8=Object.prototype;function p8(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||h8;return n===t}FC.exports=p8});var Mg=z((tee,zC)=>{function f8(n,e){return function(t){return n(e(t))}}zC.exports=f8});var RC=z((nee,IC)=>{var g8=Mg(),m8=g8(Object.keys,Object);IC.exports=m8});var BC=z((ree,NC)=>{var v8=Pd(),b8=RC(),x8=Object.prototype,_8=x8.hasOwnProperty;function y8(n){if(!v8(n))return b8(n);var e=[];for(var t in Object(n))_8.call(n,t)&&t!="constructor"&&e.push(t);return e}NC.exports=y8});var nc=z((iee,LC)=>{var C8=bd(),w8=Cg();function P8(n){return n!=null&&w8(n.length)&&!C8(n)}LC.exports=P8});var Od=z((oee,qC)=>{var O8=Og(),M8=BC(),S8=nc();function E8(n){return S8(n)?O8(n):M8(n)}qC.exports=E8});var VC=z((see,jC)=>{var A8=rs(),k8=Od();function T8(n,e){return n&&A8(e,k8(e),n)}jC.exports=T8});var UC=z((aee,HC)=>{function D8(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}HC.exports=D8});var WC=z((cee,GC)=>{var F8=jr(),z8=Pd(),I8=UC(),R8=Object.prototype,N8=R8.hasOwnProperty;function B8(n){if(!F8(n))return I8(n);var e=z8(n),t=[];for(var r in n)r=="constructor"&&(e||!N8.call(n,r))||t.push(r);return t}GC.exports=B8});var ss=z((lee,KC)=>{var L8=Og(),q8=WC(),j8=nc();function V8(n){return j8(n)?L8(n,!0):q8(n)}KC.exports=V8});var XC=z((dee,$C)=>{var H8=rs(),U8=ss();function G8(n,e){return n&&H8(e,U8(e),n)}$C.exports=G8});var Sg=z((rc,as)=>{var W8=dr(),ZC=typeof rc=="object"&&rc&&!rc.nodeType&&rc,JC=ZC&&typeof as=="object"&&as&&!as.nodeType&&as,K8=JC&&JC.exports===ZC,QC=K8?W8.Buffer:void 0,YC=QC?QC.allocUnsafe:void 0;function $8(n,e){if(e)return n.slice();var t=n.length,r=YC?YC(t):new n.constructor(t);return n.copy(r),r}as.exports=$8});var Eg=z((uee,ew)=>{function X8(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}ew.exports=X8});var nw=z((hee,tw)=>{function J8(n,e){for(var t=-1,r=n==null?0:n.length,i=0,o=[];++t<r;){var s=n[t];e(s,t,n)&&(o[i++]=s)}return o}tw.exports=J8});var Ag=z((pee,rw)=>{function Q8(){return[]}rw.exports=Q8});var Md=z((fee,ow)=>{var Y8=nw(),Z8=Ag(),eR=Object.prototype,tR=eR.propertyIsEnumerable,iw=Object.getOwnPropertySymbols,nR=iw?function(n){return n==null?[]:(n=Object(n),Y8(iw(n),function(e){return tR.call(n,e)}))}:Z8;ow.exports=nR});var aw=z((gee,sw)=>{var rR=rs(),iR=Md();function oR(n,e){return rR(n,iR(n),e)}sw.exports=oR});var kg=z((mee,cw)=>{function sR(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}cw.exports=sR});var Sd=z((vee,lw)=>{var aR=Mg(),cR=aR(Object.getPrototypeOf,Object);lw.exports=cR});var Tg=z((bee,dw)=>{var lR=kg(),dR=Sd(),uR=Md(),hR=Ag(),pR=Object.getOwnPropertySymbols,fR=pR?function(n){for(var e=[];n;)lR(e,uR(n)),n=dR(n);return e}:hR;dw.exports=fR});var hw=z((xee,uw)=>{var gR=rs(),mR=Tg();function vR(n,e){return gR(n,mR(n),e)}uw.exports=vR});var Dg=z((_ee,pw)=>{var bR=kg(),xR=Ya();function _R(n,e,t){var r=e(n);return xR(n)?r:bR(r,t(n))}pw.exports=_R});var gw=z((yee,fw)=>{var yR=Dg(),CR=Md(),wR=Od();function PR(n){return yR(n,wR,CR)}fw.exports=PR});var vw=z((Cee,mw)=>{var OR=Dg(),MR=Tg(),SR=ss();function ER(n){return OR(n,SR,MR)}mw.exports=ER});var xw=z((wee,bw)=>{var AR=mi(),kR=dr(),TR=AR(kR,"DataView");bw.exports=TR});var yw=z((Pee,_w)=>{var DR=mi(),FR=dr(),zR=DR(FR,"Promise");_w.exports=zR});var ww=z((Oee,Cw)=>{var IR=mi(),RR=dr(),NR=IR(RR,"Set");Cw.exports=NR});var Ow=z((Mee,Pw)=>{var BR=mi(),LR=dr(),qR=BR(LR,"WeakMap");Pw.exports=qR});var Ed=z((See,Dw)=>{var Fg=xw(),zg=xd(),Ig=yw(),Rg=ww(),Ng=Ow(),Tw=Zo(),cs=mg(),Mw="[object Map]",jR="[object Object]",Sw="[object Promise]",Ew="[object Set]",Aw="[object WeakMap]",kw="[object DataView]",VR=cs(Fg),HR=cs(zg),UR=cs(Ig),GR=cs(Rg),WR=cs(Ng),co=Tw;(Fg&&co(new Fg(new ArrayBuffer(1)))!=kw||zg&&co(new zg)!=Mw||Ig&&co(Ig.resolve())!=Sw||Rg&&co(new Rg)!=Ew||Ng&&co(new Ng)!=Aw)&&(co=function(n){var e=Tw(n),t=e==jR?n.constructor:void 0,r=t?cs(t):"";if(r)switch(r){case VR:return kw;case HR:return Mw;case UR:return Sw;case GR:return Ew;case WR:return Aw}return e});Dw.exports=co});var zw=z((Eee,Fw)=>{var KR=Object.prototype,$R=KR.hasOwnProperty;function XR(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&$R.call(n,"index")&&(t.index=n.index,t.input=n.input),t}Fw.exports=XR});var Rw=z((Aee,Iw)=>{var JR=dr(),QR=JR.Uint8Array;Iw.exports=QR});var Ad=z((kee,Bw)=>{var Nw=Rw();function YR(n){var e=new n.constructor(n.byteLength);return new Nw(e).set(new Nw(n)),e}Bw.exports=YR});var qw=z((Tee,Lw)=>{var ZR=Ad();function eN(n,e){var t=e?ZR(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}Lw.exports=eN});var Vw=z((Dee,jw)=>{var tN=/\w*$/;function nN(n){var e=new n.constructor(n.source,tN.exec(n));return e.lastIndex=n.lastIndex,e}jw.exports=nN});var Kw=z((Fee,Ww)=>{var Hw=vd(),Uw=Hw?Hw.prototype:void 0,Gw=Uw?Uw.valueOf:void 0;function rN(n){return Gw?Object(Gw.call(n)):{}}Ww.exports=rN});var Bg=z((zee,$w)=>{var iN=Ad();function oN(n,e){var t=e?iN(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}$w.exports=oN});var Jw=z((Iee,Xw)=>{var sN=Ad(),aN=qw(),cN=Vw(),lN=Kw(),dN=Bg(),uN="[object Boolean]",hN="[object Date]",pN="[object Map]",fN="[object Number]",gN="[object RegExp]",mN="[object Set]",vN="[object String]",bN="[object Symbol]",xN="[object ArrayBuffer]",_N="[object DataView]",yN="[object Float32Array]",CN="[object Float64Array]",wN="[object Int8Array]",PN="[object Int16Array]",ON="[object Int32Array]",MN="[object Uint8Array]",SN="[object Uint8ClampedArray]",EN="[object Uint16Array]",AN="[object Uint32Array]";function kN(n,e,t){var r=n.constructor;switch(e){case xN:return sN(n);case uN:case hN:return new r(+n);case _N:return aN(n,t);case yN:case CN:case wN:case PN:case ON:case MN:case SN:case EN:case AN:return dN(n,t);case pN:return new r;case fN:case vN:return new r(n);case gN:return cN(n);case mN:return new r;case bN:return lN(n)}}Xw.exports=kN});var Zw=z((Ree,Yw)=>{var TN=jr(),Qw=Object.create,DN=function(){function n(){}return function(e){if(!TN(e))return{};if(Qw)return Qw(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();Yw.exports=DN});var Lg=z((Nee,eP)=>{var FN=Zw(),zN=Sd(),IN=Pd();function RN(n){return typeof n.constructor=="function"&&!IN(n)?FN(zN(n)):{}}eP.exports=RN});var nP=z((Bee,tP)=>{var NN=Ed(),BN=vi(),LN="[object Map]";function qN(n){return BN(n)&&NN(n)==LN}tP.exports=qN});var sP=z((Lee,oP)=>{var jN=nP(),VN=Cd(),rP=wd(),iP=rP&&rP.isMap,HN=iP?VN(iP):jN;oP.exports=HN});var cP=z((qee,aP)=>{var UN=Ed(),GN=vi(),WN="[object Set]";function KN(n){return GN(n)&&UN(n)==WN}aP.exports=KN});var hP=z((jee,uP)=>{var $N=cP(),XN=Cd(),lP=wd(),dP=lP&&lP.isSet,JN=dP?XN(dP):$N;uP.exports=JN});var vP=z((Vee,mP)=>{var QN=vg(),YN=rC(),ZN=xg(),e7=VC(),t7=XC(),n7=Sg(),r7=Eg(),i7=aw(),o7=hw(),s7=gw(),a7=vw(),c7=Ed(),l7=zw(),d7=Jw(),u7=Lg(),h7=Ya(),p7=yd(),f7=sP(),g7=jr(),m7=hP(),v7=Od(),b7=ss(),x7=1,_7=2,y7=4,pP="[object Arguments]",C7="[object Array]",w7="[object Boolean]",P7="[object Date]",O7="[object Error]",fP="[object Function]",M7="[object GeneratorFunction]",S7="[object Map]",E7="[object Number]",gP="[object Object]",A7="[object RegExp]",k7="[object Set]",T7="[object String]",D7="[object Symbol]",F7="[object WeakMap]",z7="[object ArrayBuffer]",I7="[object DataView]",R7="[object Float32Array]",N7="[object Float64Array]",B7="[object Int8Array]",L7="[object Int16Array]",q7="[object Int32Array]",j7="[object Uint8Array]",V7="[object Uint8ClampedArray]",H7="[object Uint16Array]",U7="[object Uint32Array]",st={};st[pP]=st[C7]=st[z7]=st[I7]=st[w7]=st[P7]=st[R7]=st[N7]=st[B7]=st[L7]=st[q7]=st[S7]=st[E7]=st[gP]=st[A7]=st[k7]=st[T7]=st[D7]=st[j7]=st[V7]=st[H7]=st[U7]=!0;st[O7]=st[fP]=st[F7]=!1;function kd(n,e,t,r,i,o){var s,a=e&x7,c=e&_7,l=e&y7;if(t&&(s=i?t(n,r,i,o):t(n)),s!==void 0)return s;if(!g7(n))return n;var h=h7(n);if(h){if(s=l7(n),!a)return r7(n,s)}else{var u=c7(n),d=u==fP||u==M7;if(p7(n))return n7(n,a);if(u==gP||u==pP||d&&!i){if(s=c||d?{}:u7(n),!a)return c?o7(n,t7(s,n)):i7(n,e7(s,n))}else{if(!st[u])return i?n:{};s=d7(n,u,a)}}o||(o=new QN);var p=o.get(n);if(p)return p;o.set(n,s),m7(n)?n.forEach(function(x){s.add(kd(x,e,t,x,n,o))}):f7(n)&&n.forEach(function(x,b){s.set(b,kd(x,e,t,b,n,o))});var m=l?c?a7:s7:c?b7:v7,g=h?void 0:m(n);return YN(g||n,function(x,b){g&&(b=x,x=n[b]),ZN(s,b,kd(x,e,t,b,n,o))}),s}mP.exports=kd});var Td=z((Hee,bP)=>{var G7=vP(),W7=1,K7=4;function $7(n){return G7(n,W7|K7)}bP.exports=$7});var qg,jg,xP=W(()=>{qg=Ce(Td());Va();jg=class{constructor(e,t){typeof e=="number"?(this.ranges=[{length:0,primary:e,secondary:t}],this.lastPrimary=e,this.lastSecondary=t):(this.ranges=(0,qg.default)(e.ranges),this.lastPrimary=e.lastPrimary,this.lastSecondary=e.lastSecondary)}get base(){return this.ranges[0].primary}get primaryHead(){return this.lastPrimary}get secondaryHead(){return this.lastSecondary}serialize(){return{lastPrimary:this.lastPrimary,lastSecondary:this.lastSecondary,ranges:(0,qg.default)(this.ranges)}}add(e,t){w(e>=this.lastPrimary,3),this.lastSecondary!==void 0&&w(t>=this.lastSecondary,4),this.lastPrimary=e,this.lastSecondary=t;let r=this.ranges[this.ranges.length-1],i=r.primary+r.length,o=r.secondary+r.length;t!==o&&(e===i?r.length===0?r.secondary=t:(r.length--,this.ranges.push({length:0,primary:e,secondary:t})):i+1===e&&o+1===t?r.length++:this.ranges.push({length:0,primary:e,secondary:t}))}get(e){w(e>=this.ranges[0].primary,5);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);w(e>=this.ranges[t-1].primary,6);let r=this.ranges[t-1];return Math.min(e-r.primary,r.length)+r.secondary}updateBase(e){w(e>=this.ranges[0].primary,7);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);w(e>=this.ranges[t-1].primary,8);let r=this.ranges[t-1],i=e-r.primary;r.secondary=r.secondary+Math.min(i,r.length),r.length=Math.max(r.length-i,0),r.primary=e,this.ranges=t-1>0?this.ranges.slice(t-1):this.ranges,w(e===this.ranges[0].primary,9)}}});var Vg,_P=W(()=>{Vg=class{constructor(e){this.windowMSec=e,this.requestMap=new Map}filter(e,t){let r=[],i=Date.now();for(let o of t){let s=`${e}/${o}`;if(!this.requestMap.has(s))this.requestMap.set(s,i),r.push(o);else{if(this.requestMap.get(s)+this.windowMSec>i)continue;this.requestMap.set(s,i),r.push(o)}}return r}}});function X7(n){let e;try{e=JSON.parse(n)}catch{}return e}var yP=W(()=>{});var fn,ic,CP=W(()=>{Va();pg();fn=class{constructor(e,t,r=()=>Date.now()){this.defaultTimeout=e,this.defaultHandler=t,this.getCurrentTick=r}get hasTimer(){return!!this.runningState}start(e=this.defaultTimeout,t=this.defaultHandler){this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){var r,i;if(!this.runningState)this.start(e,t);else{let o=e??this.runningState.intendedDuration,s=(i=t??((r=this.runningState.restart)===null||r===void 0?void 0:r.handler))!==null&&i!==void 0?i:this.runningState.handler,a=this.calculateRemainingTime(this.runningState);o<a?this.start(o,s):o===a?(this.runningState.handler=s,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:s}}}startCore(e,t,r){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:setTimeout(()=>this.handler(),e)}}handler(){w(!!this.runningState,10);let e=this.runningState.restart;if(e!==void 0){let t=this.calculateRemainingTime(e);this.startCore(t,()=>e.handler(),e.duration)}else{let t=this.runningState.handler;this.clear(),t()}}calculateRemainingTime(e){let t=this.getCurrentTick()-e.startTick;return e.duration-t}},ic=class{constructor(e,t){this.timer=new fn(e,()=>this.wrapHandler(t))}get hasTimer(){return this.timer.hasTimer}start(e,t){return v(this,null,function*(){return this.clear(),this.deferred=new Se,this.timer.start(e,t?()=>this.wrapHandler(t):void 0),this.deferred.promise})}clear(){this.timer.clear(),this.deferred&&(this.deferred.resolve({timerResult:"cancel"}),this.deferred=void 0)}wrapHandler(e){e(),w(!!this.deferred,11),this.deferred.resolve({timerResult:"timeout"}),this.deferred=void 0}}});var ls,wP=W(()=>{fd();ls=class n{constructor(e){this.startTick=e,this.lastTick=e}static start(){let e=de.now();return new n(e)}trace(){let e=de.now(),t={totalTimeElapsed:e-this.startTick,duration:e-this.lastTick,tick:e};return this.lastTick=e,t}}});function vt(n,e="Unreachable Case"){throw new Error(e)}var PP=W(()=>{});var On,OP=W(()=>{On=class{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}});var MP=W(()=>{});var oc,SP=W(()=>{oc=n=>v(void 0,null,function*(){return new Promise(e=>setTimeout(()=>e(),n))})});function Hg(n){return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}var EP=W(()=>{});var sc={};Yi(sc,{BaseTelemetryNullLogger:()=>Ua,BatchManager:()=>sg,Deferred:()=>Se,EventForwarder:()=>gi,Heap:()=>lg,IsoBuffer:()=>Kt,Lazy:()=>On,LazyPromise:()=>Lt,NumberComparer:()=>PF,PromiseCache:()=>hg,PromiseTimer:()=>ic,RangeTracker:()=>jg,RateLimiter:()=>Vg,TelemetryNullLogger:()=>Ga,Timer:()=>fn,Trace:()=>ls,TypedEventEmitter:()=>we,Uint8ArrayToArrayBuffer:()=>Hg,Uint8ArrayToString:()=>Pn,assert:()=>w,bufferToString:()=>pi,delay:()=>oc,doIfNotDisposed:()=>ao,extractLogSafeErrorProperties:()=>dg,fromBase64ToUtf8:()=>og,fromUtf8ToBase64:()=>Ha,gitHashFile:()=>ig,hashFile:()=>ly,isArrayBuffer:()=>ng,performance:()=>de,safelyParseJSON:()=>X7,stringToBuffer:()=>Bn,toUtf8:()=>vF,unreachableCase:()=>vt});var Y=W(()=>{Va();fd();hy();py();fy();My();Sy();Ey();Ay();pg();xP();_P();yP();CP();wP();cg();PP();OP();MP();SP();EP();});var TP=z((Ute,kP)=>{var ds=1e3,us=ds*60,hs=us*60,uo=hs*24,J7=uo*7,Q7=uo*365.25;kP.exports=function(n,e){e=e||{};var t=typeof n;if(t==="string"&&n.length>0)return Y7(n);if(t==="number"&&isFinite(n))return e.long?eB(n):Z7(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function Y7(n){if(n=String(n),!(n.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*Q7;case"weeks":case"week":case"w":return t*J7;case"days":case"day":case"d":return t*uo;case"hours":case"hour":case"hrs":case"hr":case"h":return t*hs;case"minutes":case"minute":case"mins":case"min":case"m":return t*us;case"seconds":case"second":case"secs":case"sec":case"s":return t*ds;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Z7(n){var e=Math.abs(n);return e>=uo?Math.round(n/uo)+"d":e>=hs?Math.round(n/hs)+"h":e>=us?Math.round(n/us)+"m":e>=ds?Math.round(n/ds)+"s":n+"ms"}function eB(n){var e=Math.abs(n);return e>=uo?zd(n,e,uo,"day"):e>=hs?zd(n,e,hs,"hour"):e>=us?zd(n,e,us,"minute"):e>=ds?zd(n,e,ds,"second"):n+" ms"}function zd(n,e,t,r){var i=e>=t*1.5;return Math.round(n/t)+" "+r+(i?"s":"")}});var FP=z((Gte,DP)=>{function tB(n){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=s,t.humanize=TP(),t.destroy=l,Object.keys(n).forEach(h=>{t[h]=n[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let u=0;for(let d=0;d<h.length;d++)u=(u<<5)-u+h.charCodeAt(d),u|=0;return t.colors[Math.abs(u)%t.colors.length]}t.selectColor=e;function t(h){let u,d=null,p,m;function g(...x){if(!g.enabled)return;let b=g,_=Number(new Date),O=_-(u||_);b.diff=O,b.prev=u,b.curr=_,u=_,x[0]=t.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let S=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(D,I)=>{if(D==="%%")return"%";S++;let y=t.formatters[I];if(typeof y=="function"){let P=x[S];D=y.call(b,P),x.splice(S,1),S--}return D}),t.formatArgs.call(b,x),(b.log||t.log).apply(b,x)}return g.namespace=h,g.useColors=t.useColors(),g.color=t.selectColor(h),g.extend=r,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==t.namespaces&&(p=t.namespaces,m=t.enabled(h)),m),set:x=>{d=x}}),typeof t.init=="function"&&t.init(g),g}function r(h,u){let d=t(this.namespace+(typeof u>"u"?":":u)+h);return d.log=this.log,d}function i(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let u,d=(typeof h=="string"?h:"").split(/[\s,]+/),p=d.length;for(u=0;u<p;u++)d[u]&&(h=d[u].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function o(){let h=[...t.names.map(a),...t.skips.map(a).map(u=>"-"+u)].join(",");return t.enable(""),h}function s(h){if(h[h.length-1]==="*")return!0;let u,d;for(u=0,d=t.skips.length;u<d;u++)if(t.skips[u].test(h))return!1;for(u=0,d=t.names.length;u<d;u++)if(t.names[u].test(h))return!0;return!1}function a(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}DP.exports=tB});var Gg=z((Ln,Id)=>{Ln.formatArgs=rB;Ln.save=iB;Ln.load=oB;Ln.useColors=nB;Ln.storage=sB();Ln.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ln.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function nB(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function rB(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+Id.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;n.splice(1,0,e,"color: inherit");let t=0,r=0;n[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(r=t))}),n.splice(r,0,e)}Ln.log=console.debug||console.log||(()=>{});function iB(n){try{n?Ln.storage.setItem("debug",n):Ln.storage.removeItem("debug")}catch{}}function oB(){let n;try{n=Ln.storage.getItem("debug")}catch{}return!n&&typeof process<"u"&&"env"in process&&(n=process.env.DEBUG),n}function sB(){try{return localStorage}catch{}}Id.exports=FP()(Ln);var{formatters:aB}=Id.exports;aB.j=function(n){try{return JSON.stringify(n)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});function zP(n){switch(n){case"boolean":case"number":case"string":return!0;default:return!1}}function IP(n){let e=n,t;if(typeof n=="string")try{e=JSON.parse(n),t={raw:n,string:n}}catch{}if(e===void 0)return t;let r=typeof e;if(zP(r))return Object.assign(Object.assign({},t),{raw:n,[r]:e});if(Array.isArray(e)){let i=typeof e[0];if(!zP(i))return t;for(let o of e)if(typeof o!==i)return t;return Object.assign(Object.assign({},t),{raw:n,[`${i}[]`]:e})}return t}function Rd(n){let e=n;return RP(e?.config)&&e?.logger!==void 0}function Mn(n){return Rd(n)?n:ho(n,dc.value)}function ho(n,...e){if(Rd(n))throw new Error("Logger is already a monitoring context");let t=n;return t.config=new ps(...e),t.logger=n,t}function RP(n){let e=n;return typeof e?.getRawConfig=="function"}var dc,cB,lB,dB,ps,Wg=W(()=>{Y();dc=new On(()=>lB(dB())),cB={getRawConfig:()=>{}},lB=n=>n!=null?new ps({getRawConfig:e=>{var t,r;try{return(r=IP((t=n.getItem(e))!==null&&t!==void 0?t:void 0))===null||r===void 0?void 0:r.raw}catch{}}}):cB;dB=()=>{try{return sessionStorage!==null?sessionStorage:void 0}catch{return}},ps=class n{constructor(...e){this.configCache=new Map,this.orderedBaseProviders=[];let t=new Set,r=[...e];for(;r.length>0;){let i=r.shift();i!==void 0&&RP(i)&&!t.has(i)&&(t.add(i),i instanceof n?r.push(...i.orderedBaseProviders):this.orderedBaseProviders.push(i))}}getBoolean(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.boolean}getNumber(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.number}getString(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.string}getBooleanArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["boolean[]"]}getNumberArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["number[]"]}getStringArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["string[]"]}getRawConfig(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(let t of this.orderedBaseProviders){let r=IP(t?.getRawConfig(e));if(r!==void 0)return this.configCache.set(e,r),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}});function uc(){if(!Nd&&(Nd=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Nd))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nd(uB)}var Nd,uB,Kg=W(()=>{uB=new Uint8Array(16)});var NP,BP=W(()=>{NP=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function hB(n){return typeof n=="string"&&NP.test(n)}var _i,hc=W(()=>{BP();_i=hB});function pB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=($t[n[e+0]]+$t[n[e+1]]+$t[n[e+2]]+$t[n[e+3]]+"-"+$t[n[e+4]]+$t[n[e+5]]+"-"+$t[n[e+6]]+$t[n[e+7]]+"-"+$t[n[e+8]]+$t[n[e+9]]+"-"+$t[n[e+10]]+$t[n[e+11]]+$t[n[e+12]]+$t[n[e+13]]+$t[n[e+14]]+$t[n[e+15]]).toLowerCase();if(!_i(t))throw TypeError("Stringified UUID is invalid");return t}var $t,Bd,yi,pc=W(()=>{hc();$t=[];for(Bd=0;Bd<256;++Bd)$t.push((Bd+256).toString(16).substr(1));yi=pB});function fB(n,e,t){var r=e&&t||0,i=e||new Array(16);n=n||{};var o=n.node||LP,s=n.clockseq!==void 0?n.clockseq:$g;if(o==null||s==null){var a=n.random||(n.rng||uc)();o==null&&(o=LP=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),s==null&&(s=$g=(a[6]<<8|a[7])&16383)}var c=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:Jg+1,h=c-Xg+(l-Jg)/1e4;if(h<0&&n.clockseq===void 0&&(s=s+1&16383),(h<0||c>Xg)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Xg=c,Jg=l,$g=s,c+=122192928e5;var u=((c&268435455)*1e4+l)%4294967296;i[r++]=u>>>24&255,i[r++]=u>>>16&255,i[r++]=u>>>8&255,i[r++]=u&255;var d=c/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=d&255,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=s>>>8|128,i[r++]=s&255;for(var p=0;p<6;++p)i[r+p]=o[p];return e||yi(i)}var LP,$g,Xg,Jg,qP,jP=W(()=>{Kg();pc();Xg=0,Jg=0;qP=fB});function gB(n){if(!_i(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var Ld,Qg=W(()=>{hc();Ld=gB});function mB(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}function qd(n,e,t){function r(i,o,s,a){if(typeof i=="string"&&(i=mB(i)),typeof o=="string"&&(o=Ld(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){a=a||0;for(var l=0;l<16;++l)s[a+l]=c[l];return s}return yi(c)}try{r.name=n}catch{}return r.DNS=vB,r.URL=bB,r}var vB,bB,Yg=W(()=>{pc();Qg();vB="6ba7b810-9dad-11d1-80b4-00c04fd430c8",bB="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});function xB(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return _B(yB(CB(n),n.length*8))}function _B(n){for(var e=[],t=n.length*32,r="0123456789abcdef",i=0;i<t;i+=8){var o=n[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);e.push(s)}return e}function VP(n){return(n+64>>>9<<4)+14+1}function yB(n,e){n[e>>5]|=128<<e%32,n[VP(e)-1]=e;for(var t=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<n.length;s+=16){var a=t,c=r,l=i,h=o;t=nn(t,r,i,o,n[s],7,-680876936),o=nn(o,t,r,i,n[s+1],12,-389564586),i=nn(i,o,t,r,n[s+2],17,606105819),r=nn(r,i,o,t,n[s+3],22,-1044525330),t=nn(t,r,i,o,n[s+4],7,-176418897),o=nn(o,t,r,i,n[s+5],12,1200080426),i=nn(i,o,t,r,n[s+6],17,-1473231341),r=nn(r,i,o,t,n[s+7],22,-45705983),t=nn(t,r,i,o,n[s+8],7,1770035416),o=nn(o,t,r,i,n[s+9],12,-1958414417),i=nn(i,o,t,r,n[s+10],17,-42063),r=nn(r,i,o,t,n[s+11],22,-1990404162),t=nn(t,r,i,o,n[s+12],7,1804603682),o=nn(o,t,r,i,n[s+13],12,-40341101),i=nn(i,o,t,r,n[s+14],17,-1502002290),r=nn(r,i,o,t,n[s+15],22,1236535329),t=rn(t,r,i,o,n[s+1],5,-165796510),o=rn(o,t,r,i,n[s+6],9,-1069501632),i=rn(i,o,t,r,n[s+11],14,643717713),r=rn(r,i,o,t,n[s],20,-373897302),t=rn(t,r,i,o,n[s+5],5,-701558691),o=rn(o,t,r,i,n[s+10],9,38016083),i=rn(i,o,t,r,n[s+15],14,-660478335),r=rn(r,i,o,t,n[s+4],20,-405537848),t=rn(t,r,i,o,n[s+9],5,568446438),o=rn(o,t,r,i,n[s+14],9,-1019803690),i=rn(i,o,t,r,n[s+3],14,-187363961),r=rn(r,i,o,t,n[s+8],20,1163531501),t=rn(t,r,i,o,n[s+13],5,-1444681467),o=rn(o,t,r,i,n[s+2],9,-51403784),i=rn(i,o,t,r,n[s+7],14,1735328473),r=rn(r,i,o,t,n[s+12],20,-1926607734),t=on(t,r,i,o,n[s+5],4,-378558),o=on(o,t,r,i,n[s+8],11,-2022574463),i=on(i,o,t,r,n[s+11],16,1839030562),r=on(r,i,o,t,n[s+14],23,-35309556),t=on(t,r,i,o,n[s+1],4,-1530992060),o=on(o,t,r,i,n[s+4],11,1272893353),i=on(i,o,t,r,n[s+7],16,-155497632),r=on(r,i,o,t,n[s+10],23,-1094730640),t=on(t,r,i,o,n[s+13],4,681279174),o=on(o,t,r,i,n[s],11,-358537222),i=on(i,o,t,r,n[s+3],16,-722521979),r=on(r,i,o,t,n[s+6],23,76029189),t=on(t,r,i,o,n[s+9],4,-640364487),o=on(o,t,r,i,n[s+12],11,-421815835),i=on(i,o,t,r,n[s+15],16,530742520),r=on(r,i,o,t,n[s+2],23,-995338651),t=sn(t,r,i,o,n[s],6,-198630844),o=sn(o,t,r,i,n[s+7],10,1126891415),i=sn(i,o,t,r,n[s+14],15,-1416354905),r=sn(r,i,o,t,n[s+5],21,-57434055),t=sn(t,r,i,o,n[s+12],6,1700485571),o=sn(o,t,r,i,n[s+3],10,-1894986606),i=sn(i,o,t,r,n[s+10],15,-1051523),r=sn(r,i,o,t,n[s+1],21,-2054922799),t=sn(t,r,i,o,n[s+8],6,1873313359),o=sn(o,t,r,i,n[s+15],10,-30611744),i=sn(i,o,t,r,n[s+6],15,-1560198380),r=sn(r,i,o,t,n[s+13],21,1309151649),t=sn(t,r,i,o,n[s+4],6,-145523070),o=sn(o,t,r,i,n[s+11],10,-1120210379),i=sn(i,o,t,r,n[s+2],15,718787259),r=sn(r,i,o,t,n[s+9],21,-343485551),t=Ci(t,a),r=Ci(r,c),i=Ci(i,l),o=Ci(o,h)}return[t,r,i,o]}function CB(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(VP(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function Ci(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function wB(n,e){return n<<e|n>>>32-e}function jd(n,e,t,r,i,o){return Ci(wB(Ci(Ci(e,n),Ci(r,o)),i),t)}function nn(n,e,t,r,i,o,s){return jd(e&t|~e&r,n,e,i,o,s)}function rn(n,e,t,r,i,o,s){return jd(e&r|t&~r,n,e,i,o,s)}function on(n,e,t,r,i,o,s){return jd(e^t^r,n,e,i,o,s)}function sn(n,e,t,r,i,o,s){return jd(t^(e|~r),n,e,i,o,s)}var HP,UP=W(()=>{HP=xB});var PB,GP,WP=W(()=>{Yg();UP();PB=qd("v3",48,HP),GP=PB});function OB(n,e,t){n=n||{};var r=n.random||(n.rng||uc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=r[i];return e}return yi(r)}var ke,KP=W(()=>{Kg();pc();ke=OB});function MB(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function Zg(n,e){return n<<e|n>>>32-e}function SB(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var i=0;i<r.length;++i)n.push(r.charCodeAt(i))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var o=n.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var l=new Uint32Array(16),h=0;h<16;++h)l[h]=n[c*64+h*4]<<24|n[c*64+h*4+1]<<16|n[c*64+h*4+2]<<8|n[c*64+h*4+3];a[c]=l}a[s-1][14]=(n.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(n.length-1)*8&4294967295;for(var u=0;u<s;++u){for(var d=new Uint32Array(80),p=0;p<16;++p)d[p]=a[u][p];for(var m=16;m<80;++m)d[m]=Zg(d[m-3]^d[m-8]^d[m-14]^d[m-16],1);for(var g=t[0],x=t[1],b=t[2],_=t[3],O=t[4],S=0;S<80;++S){var E=Math.floor(S/20),D=Zg(g,5)+MB(E,x,b,_)+O+e[E]+d[S]>>>0;O=_,_=b,b=Zg(x,30)>>>0,x=g,g=D}t[0]=t[0]+g>>>0,t[1]=t[1]+x>>>0,t[2]=t[2]+b>>>0,t[3]=t[3]+_>>>0,t[4]=t[4]+O>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var $P,XP=W(()=>{$P=SB});var EB,JP,QP=W(()=>{Yg();XP();EB=qd("v5",80,$P),JP=EB});var YP,ZP=W(()=>{YP="00000000-0000-0000-0000-000000000000"});function AB(n){if(!_i(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}var eO,tO=W(()=>{hc();eO=AB});var fc={};Yi(fc,{NIL:()=>YP,parse:()=>Ld,stringify:()=>yi,v1:()=>qP,v3:()=>GP,v4:()=>ke,v5:()=>JP,validate:()=>_i,version:()=>eO});var qt=W(()=>{jP();WP();KP();QP();ZP();tO();hc();pc();Qg()});function gc(n){return typeof n?.errorType=="string"&&typeof n?.message=="string"&&Vd(n)&&nO(n)}function Hd(n){return typeof n?.errorType=="string"&&typeof n?.message=="string"&&nO(n)}var nO,Vd,em=W(()=>{nO=n=>typeof n?.getTelemetryProperties=="function"&&typeof n?.addTelemetryProperties=="function",Vd=n=>typeof n?.errorInstanceId=="string"});function mc(n,e){let t=(o,s)=>{if(!e)return o;let a=o.split(`
`);return a.shift(),s!==void 0&&a.unshift(s),a.join(`
`)},i={message:typeof n?.message=="string"?n.message:String(n)};if(kB(n)){let{errorType:o,stack:s,name:a}=n;if(typeof o=="string"&&(i.errorType=o),typeof s=="string"){let c=typeof a=="string"?a:void 0;i.stack=t(s,c)}}return i}function TB(n,e){for(let t of Object.keys(e))n[t]===void 0&&(n[t]=e[t])}function DB(n){let e=n;e.errorInstanceId===void 0&&(e.errorInstanceId=ke())}function an(n,e={}){var t;if(Hd(n)&&DB(n),gc(n))return n.addTelemetryProperties((t=e.props)!==null&&t!==void 0?t:{}),n;let{message:r,stack:i}=mc(n,!1),o=new oO({message:r,stack:i});if(typeof n=="object"&&n!==null){let{canRetry:a,retryAfterSeconds:c}=n;Object.assign(an,{canRetry:a,retryAfterSeconds:c})}typeof n!="object"&&o.addTelemetryProperties({typeofError:typeof n});let s=vc(n)?n.getTelemetryProperties():{};return o.addTelemetryProperties(Object.assign(Object.assign(Object.assign({},s),e.props),{untrustedOrigin:1})),o}function fs(){let n=new Error("<<generated stack>>");if(tm===void 0&&(tm=n.stack!==void 0),tm)return n;try{throw n}catch(e){return e}}function nm(){return fs().stack}function wi(n,e){let{message:t,stack:r}=mc(n,!1),i=e(t);return r!==void 0&&rO(i,r),Ud(n)&&i.addTelemetryProperties({untrustedOrigin:1}),Vd(n)&&(i.overwriteErrorInstanceId(n.errorInstanceId),i.addTelemetryProperties({innerErrorInstanceId:n.errorInstanceId})),vc(n)&&i.addTelemetryProperties(n.getTelemetryProperties()),i}function bc(n,e,t){let r=wi(n,e),i=r.errorInstanceId,o=i;return t.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:i,wrappedByErrorInstanceId:o},n),r}function rO(n,e){try{Object.assign(n,{stack:e})}catch{n.addTelemetryProperties({stack2:e})}}function Ud(n){return!Hd(n)||n.getTelemetryProperties().untrustedOrigin===1&&n.errorType===oO.normalizedErrorType}function iO(n){return typeof n?.value!="object"&&typeof n?.tag=="string"}function FB(n,e){let t={};for(let r of Object.keys(n)){if(e.has(r))continue;let i=n[r];switch(typeof i){case"string":case"number":case"boolean":case"undefined":t[r]=i;break;default:{iO(i)?t[r]=i:t[r]="REDACTED (arbitrary object)";break}}}return t}var kB,vc,tm,rm,Be,oO,im=W(()=>{qt();em();kB=n=>n!==null&&!Array.isArray(n)&&typeof n=="object";vc=n=>typeof n?.getTelemetryProperties=="function";rm=()=>{let n=new WeakSet;return(e,t)=>{if(typeof t=="object"&&t!==null){if(n.has(t))return"<removed/circular>";n.add(t)}return t}},Be=class extends Error{constructor(e,t,r=new Set){super(e),this.omitPropsFromLogging=r,this._errorInstanceId=ke(),this.fluidErrorCode="-",r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}addTelemetryProperties(e){TB(this,e)}getTelemetryProperties(){let e=FB(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}},oO=(()=>{class n extends Be{constructor(t){super(t.message),this.errorType=n.normalizedErrorType,t.stack!==void 0&&rO(this,t.stack)}}return n.normalizedErrorType="genericError",n})()});var Ne,at,xc,ue,_c,le,om,Gd=W(()=>{Y();Wg();im();Ne=function(n){return n.PackageData="PackageData",n.CodeArtifact="CodeArtifact",n.UserData="UserData",n}(Ne||{}),at=(()=>{class n{constructor(t,r){this.namespace=t,this.properties=r}static formatTick(t){return Math.floor(t)}static numberFromString(t){if(t==null)return;let r=Number(t);return Number.isNaN(r)?t:r}static sanitizePkgName(t){return t.replace("@","").replace("/","-")}static prepareErrorObject(t,r,i){let{message:o,errorType:s,stack:a}=mc(r,!0);if(t.stack=a,t.error=o,t.errorType=s,vc(r)){let c=r.getTelemetryProperties();for(let l of Object.keys(c))t[l]===void 0&&(t[l]=c[l])}t.stack===void 0&&i&&(t.stack=nm())}sendTelemetryEvent(t,r){var i;this.sendTelemetryEventCore(Object.assign(Object.assign({},t),{category:(i=t.category)!==null&&i!==void 0?i:"generic"}),r)}sendTelemetryEventCore(t,r){let i=Object.assign({},t);r!==void 0&&n.prepareErrorObject(i,r,!1),typeof i.duration=="number"&&(i.duration=n.formatTick(i.duration)),this.send(i)}sendErrorEvent(t,r){this.sendTelemetryEventCore(Object.assign(Object.assign({error:t.eventName},t),{category:"error"}),r)}sendPerformanceEvent(t,r){var i;let o=Object.assign(Object.assign({},t),{category:(i=t.category)!==null&&i!==void 0?i:"performance"});this.sendTelemetryEventCore(o,r)}prepareEvent(t){let r=t.category==="error"||t.error!==void 0,i=Object.assign({},t);if(this.namespace!==void 0&&(i.eventName=`${this.namespace}${n.eventNamespaceSeparator}${i.eventName}`),this.properties){let o=[];o.push(this.properties.all),r&&o.push(this.properties.error);for(let s of o)if(s!==void 0)for(let a of Object.keys(s)){if(t[a]!==void 0)continue;let c=s[a],l=typeof c=="function"?c():c;l!==void 0&&(i[a]=l)}}return i}}return n.eventNamespaceSeparator=":",n})(),xc=class{constructor(e){this.logger=e}send(e){let t={category:e.category,eventName:e.eventName};for(let r of Object.keys(e)){let i=e[r],{value:o,tag:s}=typeof i=="object"?i:{value:i,tag:void 0};switch(s){case void 0:t[r]=o;break;case Ne.PackageData:t[r]=o;break;case Ne.UserData:t[r]="REDACTED (UserData)";break;default:t[r]="REDACTED (unknown tag)";break}}this.logger.send(t)}},ue=class n extends at{constructor(e,t,r){super(t,r),this.baseLogger=e,Rd(e)&&ho(this,new ps(e.config))}static create(e,t,r){if(e instanceof n){let i={};for(let s of[e.properties,r])s!==void 0&&(s.all!==void 0&&(i.all=Object.assign(Object.assign({},i.all),s.all)),s.error!==void 0&&(i.error=Object.assign(Object.assign({},i.error),s.error)));let o=e.namespace===void 0?t:t===void 0?e.namespace:`${e.namespace}${at.eventNamespaceSeparator}${t}`;return new n(e.baseLogger,o,i)}return new n(e||new Ua,t,r)}send(e){this.baseLogger.send(this.prepareEvent(e))}},_c=class extends at{constructor(e,t){super(e,t),this.loggers=[]}addLogger(e){e!=null&&this.loggers.push(e)}send(e){let t=this.prepareEvent(e);this.loggers.forEach(r=>{r.send(t)})}},le=class n{constructor(e,t,r={end:!0,cancel:"generic"}){this.logger=e,this.markers=r,this.startTime=de.now(),this.event=Object.assign({},t),this.markers.start&&this.reportEvent("start"),typeof window=="object"&&window!=null&&window.performance&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}static start(e,t,r){return new n(e,t,r)}static timedExec(e,t,r,i){let o=n.start(e,t,i);try{let s=r(o);return o.autoEnd(),s}catch(s){throw o.cancel(void 0,s),s}}static timedExecAsync(e,t,r,i){return v(this,null,function*(){let o=n.start(e,t,i);try{let s=yield r(o);return o.autoEnd(),s}catch(s){throw o.cancel(void 0,s),s}})}get duration(){return de.now()-this.startTime}reportProgress(e,t="update"){this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(this.startMark&&this.event){let e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){this.markers.cancel!==void 0&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;let i=Object.assign(Object.assign({},this.event),t);i.eventName=`${i.eventName}_${e}`,e!=="start"&&(i.duration=this.duration),this.logger.sendPerformanceEvent(i,r)}},om=class{send(e){}sendTelemetryEvent(e,t){}sendErrorEvent(e,t){this.reportError("errorEvent in UT logger!",e,t)}sendPerformanceEvent(e,t){}logGenericError(e,t){this.reportError("genericError in UT logger!",{eventName:e},t)}logException(e,t){this.reportError("exception in UT logger!",e,t)}debugAssert(e,t){this.reportError("debugAssert in UT logger!")}shipAssert(e,t){this.reportError("shipAssert in UT logger!")}reportError(e,t,r){let i=new Error(e);throw i.error=i,i.event=t,console.error(e),console.error(i),i}}});var sm,yc,sO=W(()=>{Y();sm=Ce(Gg());Gd();yc=class n extends at{constructor(e,t,r){super(void 0,r),this.debug=e,this.debugErr=t}static create(e,t){let r=(0,sm.debug)(e),i=(0,sm.debug)(e);return i.log=console.error.bind(console),i.enabled=!0,new n(r,i,t)}static mixinDebugLogger(e,t,r){if(!t)return n.create(e,r);let i=new _c(void 0,r);return i.addLogger(n.create(e,this.tryGetBaseLoggerProps(t))),i.addLogger(ue.create(t,e)),i}static tryGetBaseLoggerProps(e){if(e instanceof at)return e.properties}send(e){let t=this.prepareEvent(e),r=t.category==="error",i=r?this.debugErr:this.debug,o=e.eventName.lastIndexOf(at.eventNamespaceSeparator),s=e.eventName.substring(o+1);o>0&&(i=i.extend(e.eventName.substring(0,o))),t.eventName=void 0;let a="";a=`tick=${at.formatTick(de.now())}`;let c=t.stack?t.stack:"";t.stack=void 0;let l;try{l=JSON.stringify(t)}catch{t.error=void 0,l=JSON.stringify(t)}l==="{}"&&(l=""),r&&(i.enabled=!0),i(`${s} ${l} ${a} ${c}`)}}});var Vr,aO=W(()=>{Y();Vr=class extends we{constructor(e){super(),this.errorHandler=e}emit(e,...t){try{return super.emit(e,...t)}catch(r){return this.errorHandler(e,r),!0}}}});function am(n,e,t,...r){try{n.emit(t,...r)}catch(i){e.sendErrorEvent({eventName:"RaiseEventError",event:t},i)}}function po(n,e,t,r){try{t?e.emit(Wd,r):e.emit(Kd)}catch(i){n.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}var Wd,Kd,cO=W(()=>{Wd="connected",Kd="disconnected"});var cm,lO=W(()=>{Gd();cm=class n extends at{constructor(){super(),this.events=[]}clear(){this.events=[]}send(e){this.events.push(e)}matchEvents(e){let t=this.getMatchedEventsCount(e);return e.length-t===0}assertMatch(e,t){let r=this.events;if(!this.matchEvents(e))throw new Error(`${t}
expected:
${JSON.stringify(e)}

actual:
${JSON.stringify(r)}`)}matchAnyEvent(e){return this.getMatchedEventsCount(e)>0}assertMatchAny(e,t){let r=this.events;if(!this.matchAnyEvent(e))throw new Error(`${t}
expected:
${JSON.stringify(e)}

actual:
${JSON.stringify(r)}`)}getMatchedEventsCount(e){let t=0;return this.events.forEach(r=>{t<e.length&&n.eventsMatch(r,e[t])&&++t}),this.events=[],t}static eventsMatch(e,t){let r=Object.assign(Object.assign({},e),t);return JSON.stringify(r)===JSON.stringify(e)}}});var fo,dO=W(()=>{fo=class{constructor(e,t,r=e){this.threshold=e,this.logger=t,this.thresholdMultiple=r}send(e,t){t<this.threshold||this.logger.sendPerformanceEvent({eventName:e,value:t})}sendIfMultiple(e,t){t===this.thresholdMultiple&&(this.logger.sendPerformanceEvent({eventName:e,value:t}),this.thresholdMultiple=this.thresholdMultiple*2)}}});function lm(n,e,t){if(n)return!0;let r=typeof t=="string"?{eventName:t,category:"error"}:Object.assign({category:"error"},t);return e.send(r),!1}var uO=W(()=>{});var gs,hO=W(()=>{Y();gs=class{constructor(e,t,r,i=!1,o=new Map){this.eventBase=e,this.logger=t,this.sampleThreshold=r,this.includeAggregateMetrics=i,this.perBucketProperties=o,this.disposed=!1,this.measurementsMap=new Map}measure(e,t=""){var r,i,o;let s=de.now(),a=e(),c=de.now()-s,l=this.measurementsMap.get(t);return l===void 0&&(l={count:0,duration:-1},this.measurementsMap.set(t,l)),l.count++,l.duration=c,this.includeAggregateMetrics&&(l.totalDuration=((r=l.totalDuration)!==null&&r!==void 0?r:0)+c,l.minDuration=Math.min((i=l.minDuration)!==null&&i!==void 0?i:c,c),l.maxDuration=Math.max((o=l.maxDuration)!==null&&o!==void 0?o:0,c)),l.count>=this.sampleThreshold&&this.flushBucket(t),a}flushBucket(e){let t=this.measurementsMap.get(e);if(t!==void 0&&t.count!==0){let r=this.perBucketProperties.get(e),i=Object.assign(Object.assign(Object.assign({},this.eventBase),r),t);this.logger.sendPerformanceEvent(i),this.measurementsMap.delete(e)}}dispose(e){this.measurementsMap.forEach((t,r)=>this.flushBucket(r))}}});var dm={};Yi(dm,{ChildLogger:()=>ue,DebugLogger:()=>yc,EventEmitterWithErrorHandling:()=>Vr,LoggingError:()=>Be,MockLogger:()=>cm,MultiSinkLogger:()=>_c,PerformanceEvent:()=>le,SampledTelemetryHelper:()=>gs,TaggedLoggerAdapter:()=>xc,TelemetryDataTag:()=>Ne,TelemetryLogger:()=>at,TelemetryUTLogger:()=>om,ThresholdCounter:()=>fo,connectedEventName:()=>Wd,disconnectedEventName:()=>Kd,extractLogSafeErrorProperties:()=>mc,generateErrorWithStack:()=>fs,generateStack:()=>nm,getCircularReplacer:()=>rm,hasErrorInstanceId:()=>Vd,isExternalError:()=>Ud,isFluidError:()=>gc,isILoggingError:()=>vc,isTaggedTelemetryPropertyValue:()=>iO,isValidLegacyError:()=>Hd,logIfFalse:()=>lm,loggerToMonitoringContext:()=>Mn,mixinMonitoringContext:()=>ho,normalizeError:()=>an,raiseConnectedEvent:()=>po,safeRaiseEvent:()=>am,sessionStorageConfigProvider:()=>dc,wrapError:()=>wi,wrapErrorAndLog:()=>bc});var Pe=W(()=>{sO();im();aO();cO();em();Gd();lO();dO();uO();hO();Wg();});var pO=W(()=>{});var fO=W(()=>{});var gO=W(()=>{});var Pi,mO=W(()=>{Pi=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(Pi||{})});var go,Cc,vO=W(()=>{go=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(go||{}),Cc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(Cc||{})});var Or,bO=W(()=>{Or=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Or||{})});var xO=W(()=>{});var _O=W(()=>{});var yO=W(()=>{});var CO=W(()=>{});var um=W(()=>{pO();fO();gO();mO();vO();bO();xO();_O();yO();CO();});function wO(n){let e=n.type===Or.Handle?n.handleType:n.type;switch(e){case Or.Blob:case Or.Attachment:return go.File;case Or.Tree:return go.Directory;default:vt(e,`Unknown type: ${e}`)}}function Jd(n){let e=n.type===Or.Handle?n.handleType:n.type;switch(e){case Or.Blob:case Or.Attachment:return"blob";case Or.Tree:return"tree";default:vt(e,`Unknown type: ${e}`)}}function vs(n,e=new Map,t=!1){let r={},i={id:n.sha,blobs:{},trees:{}};r[""]=i;for(let o of n.tree){let s=t?o.path.replace(/^\.app\//,""):o.path,a=s.lastIndexOf("/"),c=s.slice(0,Math.max(0,a)),l=s.slice(a+1),h=r[c];if(o.type==="tree"){let u={id:o.sha,blobs:{},commits:{},trees:{}};h.trees[decodeURIComponent(l)]=u,r[s]=u}else if(o.type==="blob")h.blobs[decodeURIComponent(l)]=o.sha,e.set(o.sha,`/${s}`);else throw new Error("Unknown entry type!!")}return i}var ms,$d,Xd,PO=W(()=>{um();Y();ms=class{constructor(e,t,r="utf-8"){this.path=e,this.mode=go.File,this.type=Cc.Blob,this.value={contents:t,encoding:r}}},$d=class{constructor(e,t){this.path=e,this.value=t,this.mode=go.Directory,this.type=Cc.Tree}},Xd=class{constructor(e,t){this.path=e,this.id=t,this.mode=go.File,this.type=Cc.Attachment,this.value={id:t}}}});var OO,Qd,Yd,hm,pm,Zd,fm=W(()=>{OO=Ce(fi()),Qd=Ce(Td());Y();Yd=class{constructor(e,t,r,i){this.sequenceNumber=e,this.key=t,this.value=r,this.local=i}},hm=class extends we{constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}get disposed(){return this.isDisposed}snapshot(){var e;return(e=this.snapshotCache)!==null&&e!==void 0||(this.snapshotCache=(0,Qd.default)(Array.from(this.members))),this.snapshotCache}addMember(e,t){w(!this.members.has(e),462),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){w(this.members.has(e),463),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}},pm=class extends we{constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new OO.EventEmitter,this.proposals=new Map(e.proposals.map(([,r])=>[r.sequenceNumber,new Yd(r.sequenceNumber,r.key,r.value,!1)])),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}get disposed(){return this.isDisposed}snapshot(){var e,t;return(e=this.proposalsSnapshotCache)!==null&&e!==void 0||(this.proposalsSnapshotCache=Array.from(this.proposals).map(([r,i])=>[r,{sequenceNumber:r,key:i.key,value:i.value},[]])),(t=this.valuesSnapshotCache)!==null&&t!==void 0||(this.valuesSnapshotCache=(0,Qd.default)(Array.from(this.values))),{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){var t;return(t=this.values.get(e))===null||t===void 0?void 0:t.value}getApprovalData(e){let t=this.values.get(e);return t?(0,Qd.default)(t):void 0}propose(e,t){return v(this,null,function*(){let r=this.sendProposal(e,t);if(r<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise((i,o)=>{let s,a=(d,p)=>{d===r&&(s=p,this.stateEvents.off("localProposalSequenced",a),this.stateEvents.off("disconnected",l),this.stateEvents.on("localProposalApproved",c))},c=d=>{d===s&&(i(),u())},l=()=>{s===void 0&&this.stateEvents.once("connected",()=>{s===void 0&&(o(new Error("Client disconnected without successfully sending proposal")),u())})},h=()=>{o(new Error("QuorumProposals was disposed")),u()},u=()=>{this.stateEvents.off("localProposalSequenced",a),this.stateEvents.off("localProposalApproved",c),this.stateEvents.off("disconnected",l),this.stateEvents.off("disposed",h)};this.stateEvents.on("localProposalSequenced",a),this.stateEvents.on("disconnected",l),this.stateEvents.on("disposed",h)})})}addProposal(e,t,r,i,o){w(!this.proposals.has(r),464);let s=new Yd(r,e,t,i);this.proposals.set(r,s),this.emit("addProposal",s),i&&this.stateEvents.emit("localProposalSequenced",o,r),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){let t=e.minimumSequenceNumber,r=[];for(let[i,o]of this.proposals)i<=t&&r.push(o);r.sort((i,o)=>i.sequenceNumber-o.sequenceNumber);for(let i of r){let o={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:i.key,sequenceNumber:i.sequenceNumber,value:i.value};this.values.set(o.key,o),this.valuesSnapshotCache=void 0,this.emit("approveProposal",o.sequenceNumber,o.key,o.value,o.approvalSequenceNumber),this.proposals.delete(i.sequenceNumber),this.proposalsSnapshotCache=void 0,i.local&&this.stateEvents.emit("localProposalApproved",i.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}},Zd=class extends we{constructor(e,t,r,i){super(),this.isDisposed=!1,this.quorumClients=new hm(e),this.quorumClients.on("addMember",(o,s)=>{this.emit("addMember",o,s)}),this.quorumClients.on("removeMember",o=>{this.emit("removeMember",o)}),this.quorumProposals=new pm({proposals:t,values:r},i),this.quorumProposals.on("addProposal",o=>{this.emit("addProposal",o)}),this.quorumProposals.on("approveProposal",(o,s,a,c)=>{this.emit("approveProposal",o,s,a,c)})}get disposed(){return this.isDisposed}close(){this.removeAllListeners()}snapshot(){let e=this.quorumClients.snapshot(),{proposals:t,values:r}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:r}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}getApprovalData(e){return this.quorumProposals.getApprovalData(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}propose(e,t){return v(this,null,function*(){return this.quorumProposals.propose(e,t)})}addProposal(e,t,r,i,o){return this.quorumProposals.addProposal(e,t,r,i,o)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}});var gm,eu,MO=W(()=>{um();fm();gm=class{constructor(e,t,r,i,o,s,a){this.minimumSequenceNumber=e,this.sequenceNumber=t,this.term=r??1,this._quorum=new Zd(i,o,s,a)}get quorum(){return this._quorum}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber,term:this.term}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let r=!1;switch(e.type){case Pi.ClientJoin:let i=e,o=JSON.parse(i.data),s={client:o.detail,sequenceNumber:i.sequenceNumber};this._quorum.addMember(o.clientId,s);break;case Pi.ClientLeave:let c=JSON.parse(e.data);this._quorum.removeMember(c);break;case Pi.Propose:let l=e.contents;this._quorum.addProposal(l.key,l.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0;break;case Pi.Reject:throw new Error("Quorum rejection is removed.");default:}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}getProtocolState(){return Object.assign({sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber},this._quorum.snapshot())}},eu=class extends gm{processMessage(e,t){let r=this._quorum.getMember(e.clientId);if(e.clientId!=null){if(r===void 0&&e.type!==Pi.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(r?.shouldHaveLeft===!0&&e.type!==Pi.NoOp)throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}}});var SO=W(()=>{});var EO=W(()=>{});var Hr=W(()=>{PO();MO();fm();SO();EO();});var kO=z((bs,xs)=>{(function(n){var e=typeof bs=="object"&&bs&&!bs.nodeType&&bs,t=typeof xs=="object"&&xs&&!xs.nodeType&&xs,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(n=r);var i,o=2147483647,s=36,a=1,c=26,l=38,h=700,u=72,d=128,p="-",m=/^xn--/,g=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=s-a,O=Math.floor,S=String.fromCharCode,E;function D(q){throw new RangeError(b[q])}function I(q,V){for(var G=q.length,re=[];G--;)re[G]=V(q[G]);return re}function y(q,V){var G=q.split("@"),re="";G.length>1&&(re=G[0]+"@",q=G[1]),q=q.replace(x,".");var te=q.split("."),be=I(te,V).join(".");return re+be}function P(q){for(var V=[],G=0,re=q.length,te,be;G<re;)te=q.charCodeAt(G++),te>=55296&&te<=56319&&G<re?(be=q.charCodeAt(G++),(be&64512)==56320?V.push(((te&1023)<<10)+(be&1023)+65536):(V.push(te),G--)):V.push(te);return V}function C(q){return I(q,function(V){var G="";return V>65535&&(V-=65536,G+=S(V>>>10&1023|55296),V=56320|V&1023),G+=S(V),G}).join("")}function M(q){return q-48<10?q-22:q-65<26?q-65:q-97<26?q-97:s}function A(q,V){return q+22+75*(q<26)-((V!=0)<<5)}function F(q,V,G){var re=0;for(q=G?O(q/h):q>>1,q+=O(q/V);q>_*c>>1;re+=s)q=O(q/_);return O(re+(_+1)*q/(q+l))}function k(q){var V=[],G=q.length,re,te=0,be=d,ge=u,rt,He,Ue,Je,ze,pe,Ee,Oe,Ge;for(rt=q.lastIndexOf(p),rt<0&&(rt=0),He=0;He<rt;++He)q.charCodeAt(He)>=128&&D("not-basic"),V.push(q.charCodeAt(He));for(Ue=rt>0?rt+1:0;Ue<G;){for(Je=te,ze=1,pe=s;Ue>=G&&D("invalid-input"),Ee=M(q.charCodeAt(Ue++)),(Ee>=s||Ee>O((o-te)/ze))&&D("overflow"),te+=Ee*ze,Oe=pe<=ge?a:pe>=ge+c?c:pe-ge,!(Ee<Oe);pe+=s)Ge=s-Oe,ze>O(o/Ge)&&D("overflow"),ze*=Ge;re=V.length+1,ge=F(te-Je,re,Je==0),O(te/re)>o-be&&D("overflow"),be+=O(te/re),te%=re,V.splice(te++,0,be)}return C(V)}function T(q){var V,G,re,te,be,ge,rt,He,Ue,Je,ze,pe=[],Ee,Oe,Ge,St;for(q=P(q),Ee=q.length,V=d,G=0,be=u,ge=0;ge<Ee;++ge)ze=q[ge],ze<128&&pe.push(S(ze));for(re=te=pe.length,te&&pe.push(p);re<Ee;){for(rt=o,ge=0;ge<Ee;++ge)ze=q[ge],ze>=V&&ze<rt&&(rt=ze);for(Oe=re+1,rt-V>O((o-G)/Oe)&&D("overflow"),G+=(rt-V)*Oe,V=rt,ge=0;ge<Ee;++ge)if(ze=q[ge],ze<V&&++G>o&&D("overflow"),ze==V){for(He=G,Ue=s;Je=Ue<=be?a:Ue>=be+c?c:Ue-be,!(He<Je);Ue+=s)St=He-Je,Ge=s-Je,pe.push(S(A(Je+St%Ge,0))),He=O(St/Ge);pe.push(S(A(He,0))),be=F(G,Oe,re==te),G=0,++re}++G,++V}return pe.join("")}function R(q){return y(q,function(V){return m.test(V)?k(V.slice(4).toLowerCase()):V})}function N(q){return y(q,function(V){return g.test(V)?"xn--"+T(V):V})}if(i={version:"1.4.1",ucs2:{decode:P,encode:C},decode:k,encode:T,toASCII:N,toUnicode:R},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return i});else if(e&&t)if(xs.exports==e)t.exports=i;else for(E in i)i.hasOwnProperty(E)&&(e[E]=i[E]);else n.punycode=i})(bs)});var DO=z((Wre,TO)=>{"use strict";TO.exports=Error});var zO=z((Kre,FO)=>{"use strict";FO.exports=EvalError});var RO=z(($re,IO)=>{"use strict";IO.exports=RangeError});var BO=z((Xre,NO)=>{"use strict";NO.exports=ReferenceError});var mm=z((Jre,LO)=>{"use strict";LO.exports=SyntaxError});var _s=z((Qre,qO)=>{"use strict";qO.exports=TypeError});var VO=z((Yre,jO)=>{"use strict";jO.exports=URIError});var UO=z((Zre,HO)=>{"use strict";HO.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,t);if(s.value!==i||s.enumerable!==!0)return!1}return!0}});var KO=z((eie,WO)=>{"use strict";var GO=typeof Symbol<"u"&&Symbol,IB=UO();WO.exports=function(){return typeof GO!="function"||typeof Symbol!="function"||typeof GO("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:IB()}});var XO=z((tie,$O)=>{"use strict";var vm={__proto__:null,foo:{}},RB=Object;$O.exports=function(){return{__proto__:vm}.foo===vm.foo&&!(vm instanceof RB)}});var YO=z((nie,QO)=>{"use strict";var NB="Function.prototype.bind called on incompatible ",BB=Object.prototype.toString,LB=Math.max,qB="[object Function]",JO=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r},jB=function(e,t){for(var r=[],i=t||0,o=0;i<e.length;i+=1,o+=1)r[o]=e[i];return r},VB=function(n,e){for(var t="",r=0;r<n.length;r+=1)t+=n[r],r+1<n.length&&(t+=e);return t};QO.exports=function(e){var t=this;if(typeof t!="function"||BB.apply(t)!==qB)throw new TypeError(NB+t);for(var r=jB(arguments,1),i,o=function(){if(this instanceof i){var h=t.apply(this,JO(r,arguments));return Object(h)===h?h:this}return t.apply(e,JO(r,arguments))},s=LB(0,t.length-r.length),a=[],c=0;c<s;c++)a[c]="$"+c;if(i=Function("binder","return function ("+VB(a,",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var l=function(){};l.prototype=t.prototype,i.prototype=new l,l.prototype=null}return i}});var nu=z((rie,ZO)=>{"use strict";var HB=YO();ZO.exports=Function.prototype.bind||HB});var tM=z((iie,eM)=>{"use strict";var UB=Function.prototype.call,GB=Object.prototype.hasOwnProperty,WB=nu();eM.exports=WB.call(UB,GB)});var bo=z((oie,sM)=>{"use strict";var Te,KB=DO(),$B=zO(),XB=RO(),JB=BO(),Ps=mm(),ws=_s(),QB=VO(),oM=Function,bm=function(n){try{return oM('"use strict"; return ('+n+").constructor;")()}catch{}},mo=Object.getOwnPropertyDescriptor;if(mo)try{mo({},"")}catch{mo=null}var xm=function(){throw new ws},YB=mo?function(){try{return arguments.callee,xm}catch{try{return mo(arguments,"callee").get}catch{return xm}}}():xm,ys=KO()(),ZB=XO()(),jt=Object.getPrototypeOf||(ZB?function(n){return n.__proto__}:null),Cs={},e9=typeof Uint8Array>"u"||!jt?Te:jt(Uint8Array),vo={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Te:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Te:ArrayBuffer,"%ArrayIteratorPrototype%":ys&&jt?jt([][Symbol.iterator]()):Te,"%AsyncFromSyncIteratorPrototype%":Te,"%AsyncFunction%":Cs,"%AsyncGenerator%":Cs,"%AsyncGeneratorFunction%":Cs,"%AsyncIteratorPrototype%":Cs,"%Atomics%":typeof Atomics>"u"?Te:Atomics,"%BigInt%":typeof BigInt>"u"?Te:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Te:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Te:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Te:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":KB,"%eval%":eval,"%EvalError%":$B,"%Float32Array%":typeof Float32Array>"u"?Te:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Te:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Te:FinalizationRegistry,"%Function%":oM,"%GeneratorFunction%":Cs,"%Int8Array%":typeof Int8Array>"u"?Te:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Te:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Te:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ys&&jt?jt(jt([][Symbol.iterator]())):Te,"%JSON%":typeof JSON=="object"?JSON:Te,"%Map%":typeof Map>"u"?Te:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ys||!jt?Te:jt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Te:Promise,"%Proxy%":typeof Proxy>"u"?Te:Proxy,"%RangeError%":XB,"%ReferenceError%":JB,"%Reflect%":typeof Reflect>"u"?Te:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Te:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ys||!jt?Te:jt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Te:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ys&&jt?jt(""[Symbol.iterator]()):Te,"%Symbol%":ys?Symbol:Te,"%SyntaxError%":Ps,"%ThrowTypeError%":YB,"%TypedArray%":e9,"%TypeError%":ws,"%Uint8Array%":typeof Uint8Array>"u"?Te:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Te:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Te:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Te:Uint32Array,"%URIError%":QB,"%WeakMap%":typeof WeakMap>"u"?Te:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Te:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Te:WeakSet};if(jt)try{null.error}catch(n){nM=jt(jt(n)),vo["%Error.prototype%"]=nM}var nM,t9=function n(e){var t;if(e==="%AsyncFunction%")t=bm("async function () {}");else if(e==="%GeneratorFunction%")t=bm("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=bm("async function* () {}");else if(e==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=n("%AsyncGenerator%");i&&jt&&(t=jt(i.prototype))}return vo[e]=t,t},rM={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},wc=nu(),ru=tM(),n9=wc.call(Function.call,Array.prototype.concat),r9=wc.call(Function.apply,Array.prototype.splice),iM=wc.call(Function.call,String.prototype.replace),iu=wc.call(Function.call,String.prototype.slice),i9=wc.call(Function.call,RegExp.prototype.exec),o9=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,s9=/\\(\\)?/g,a9=function(e){var t=iu(e,0,1),r=iu(e,-1);if(t==="%"&&r!=="%")throw new Ps("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new Ps("invalid intrinsic syntax, expected opening `%`");var i=[];return iM(e,o9,function(o,s,a,c){i[i.length]=a?iM(c,s9,"$1"):s||o}),i},c9=function(e,t){var r=e,i;if(ru(rM,r)&&(i=rM[r],r="%"+i[0]+"%"),ru(vo,r)){var o=vo[r];if(o===Cs&&(o=t9(r)),typeof o>"u"&&!t)throw new ws("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:o}}throw new Ps("intrinsic "+e+" does not exist!")};sM.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new ws("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new ws('"allowMissing" argument must be a boolean');if(i9(/^%?[^%]*%?$/,e)===null)throw new Ps("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=a9(e),i=r.length>0?r[0]:"",o=c9("%"+i+"%",t),s=o.name,a=o.value,c=!1,l=o.alias;l&&(i=l[0],r9(r,n9([0,1],l)));for(var h=1,u=!0;h<r.length;h+=1){var d=r[h],p=iu(d,0,1),m=iu(d,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new Ps("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(c=!0),i+="."+d,s="%"+i+"%",ru(vo,s))a=vo[s];else if(a!=null){if(!(d in a)){if(!t)throw new ws("base intrinsic for "+e+" exists, but the property is not available.");return}if(mo&&h+1>=r.length){var g=mo(a,d);u=!!g,u&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[d]}else u=ru(a,d),a=a[d];u&&!c&&(vo[s]=a)}}return a}});var su=z((sie,aM)=>{"use strict";var l9=bo(),ou=l9("%Object.defineProperty%",!0)||!1;if(ou)try{ou({},"a",{value:1})}catch{ou=!1}aM.exports=ou});var _m=z((aie,cM)=>{"use strict";var d9=bo(),au=d9("%Object.getOwnPropertyDescriptor%",!0);if(au)try{au([],"length")}catch{au=null}cM.exports=au});var hM=z((cie,uM)=>{"use strict";var lM=su(),u9=mm(),Os=_s(),dM=_m();uM.exports=function(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new Os("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Os("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Os("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Os("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Os("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Os("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,c=!!dM&&dM(e,t);if(lM)lM(e,t,{configurable:s===null&&c?c.configurable:!s,enumerable:i===null&&c?c.enumerable:!i,value:r,writable:o===null&&c?c.writable:!o});else if(a||!i&&!o&&!s)e[t]=r;else throw new u9("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var gM=z((lie,fM)=>{"use strict";var ym=su(),pM=function(){return!!ym};pM.hasArrayLengthDefineBug=function(){if(!ym)return null;try{return ym([],"length",{value:1}).length!==1}catch{return!0}};fM.exports=pM});var _M=z((die,xM)=>{"use strict";var h9=bo(),mM=hM(),p9=gM()(),vM=_m(),bM=_s(),f9=h9("%Math.floor%");xM.exports=function(e,t){if(typeof e!="function")throw new bM("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||f9(t)!==t)throw new bM("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,o=!0;if("length"in e&&vM){var s=vM(e,"length");s&&!s.configurable&&(i=!1),s&&!s.writable&&(o=!1)}return(i||o||!r)&&(p9?mM(e,"length",t,!0,!0):mM(e,"length",t)),e}});var MM=z((uie,cu)=>{"use strict";var Cm=nu(),lu=bo(),g9=_M(),m9=_s(),wM=lu("%Function.prototype.apply%"),PM=lu("%Function.prototype.call%"),OM=lu("%Reflect.apply%",!0)||Cm.call(PM,wM),yM=su(),v9=lu("%Math.max%");cu.exports=function(e){if(typeof e!="function")throw new m9("a function is required");var t=OM(Cm,PM,arguments);return g9(t,1+v9(0,e.length-(arguments.length-1)),!0)};var CM=function(){return OM(Cm,wM,arguments)};yM?yM(cu.exports,"apply",{value:CM}):cu.exports.apply=CM});var kM=z((hie,AM)=>{"use strict";var SM=bo(),EM=MM(),b9=EM(SM("String.prototype.indexOf"));AM.exports=function(e,t){var r=SM(e,!!t);return typeof r=="function"&&b9(e,".prototype.")>-1?EM(r):r}});var TM=z(()=>{});var QM=z((gie,JM)=>{var Dm=typeof Map=="function"&&Map.prototype,wm=Object.getOwnPropertyDescriptor&&Dm?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,uu=Dm&&wm&&typeof wm.get=="function"?wm.get:null,DM=Dm&&Map.prototype.forEach,Fm=typeof Set=="function"&&Set.prototype,Pm=Object.getOwnPropertyDescriptor&&Fm?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,hu=Fm&&Pm&&typeof Pm.get=="function"?Pm.get:null,FM=Fm&&Set.prototype.forEach,x9=typeof WeakMap=="function"&&WeakMap.prototype,Oc=x9?WeakMap.prototype.has:null,_9=typeof WeakSet=="function"&&WeakSet.prototype,Mc=_9?WeakSet.prototype.has:null,y9=typeof WeakRef=="function"&&WeakRef.prototype,zM=y9?WeakRef.prototype.deref:null,C9=Boolean.prototype.valueOf,w9=Object.prototype.toString,P9=Function.prototype.toString,O9=String.prototype.match,zm=String.prototype.slice,Mi=String.prototype.replace,M9=String.prototype.toUpperCase,IM=String.prototype.toLowerCase,UM=RegExp.prototype.test,RM=Array.prototype.concat,Mr=Array.prototype.join,S9=Array.prototype.slice,NM=Math.floor,Sm=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Om=Object.getOwnPropertySymbols,Em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="object",cn=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ms||!0)?Symbol.toStringTag:null,GM=Object.prototype.propertyIsEnumerable,BM=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function LM(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||UM.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var r=n<0?-NM(-n):NM(n);if(r!==n){var i=String(r),o=zm.call(e,i.length+1);return Mi.call(i,t,"$&_")+"."+Mi.call(Mi.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Mi.call(e,t,"$&_")}var Am=TM(),qM=Am.custom,jM=KM(qM)?qM:null;JM.exports=function n(e,t,r,i){var o=t||{};if(Oi(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Oi(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=Oi(o,"customInspect")?o.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Oi(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Oi(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return XM(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?LM(e,c):c}if(typeof e=="bigint"){var l=String(e)+"n";return a?LM(e,l):l}var h=typeof o.depth>"u"?5:o.depth;if(typeof r>"u"&&(r=0),r>=h&&h>0&&typeof e=="object")return km(e)?"[Array]":"[Object]";var u=G9(o,r);if(typeof i>"u")i=[];else if($M(i,e)>=0)return"[Circular]";function d(F,k,T){if(k&&(i=S9.call(i),i.push(k)),T){var R={depth:o.depth};return Oi(o,"quoteStyle")&&(R.quoteStyle=o.quoteStyle),n(F,R,r+1,i)}return n(F,o,r+1,i)}if(typeof e=="function"&&!VM(e)){var p=R9(e),m=du(e,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+Mr.call(m,", ")+" }":"")}if(KM(e)){var g=Ms?Mi.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Em.call(e);return typeof e=="object"&&!Ms?Pc(g):g}if(V9(e)){for(var x="<"+IM.call(String(e.nodeName)),b=e.attributes||[],_=0;_<b.length;_++)x+=" "+b[_].name+"="+WM(E9(b[_].value),"double",o);return x+=">",e.childNodes&&e.childNodes.length&&(x+="..."),x+="</"+IM.call(String(e.nodeName))+">",x}if(km(e)){if(e.length===0)return"[]";var O=du(e,d);return u&&!U9(O)?"["+Tm(O,u)+"]":"[ "+Mr.call(O,", ")+" ]"}if(k9(e)){var S=du(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!GM.call(e,"cause")?"{ ["+String(e)+"] "+Mr.call(RM.call("[cause]: "+d(e.cause),S),", ")+" }":S.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Mr.call(S,", ")+" }"}if(typeof e=="object"&&s){if(jM&&typeof e[jM]=="function"&&Am)return Am(e,{depth:h-r});if(s!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(N9(e)){var E=[];return DM&&DM.call(e,function(F,k){E.push(d(k,e,!0)+" => "+d(F,e))}),HM("Map",uu.call(e),E,u)}if(q9(e)){var D=[];return FM&&FM.call(e,function(F){D.push(d(F,e))}),HM("Set",hu.call(e),D,u)}if(B9(e))return Mm("WeakMap");if(j9(e))return Mm("WeakSet");if(L9(e))return Mm("WeakRef");if(D9(e))return Pc(d(Number(e)));if(z9(e))return Pc(d(Sm.call(e)));if(F9(e))return Pc(C9.call(e));if(T9(e))return Pc(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===global)return"{ [object globalThis] }";if(!A9(e)&&!VM(e)){var I=du(e,d),y=BM?BM(e)===Object.prototype:e instanceof Object||e.constructor===Object,P=e instanceof Object?"":"null prototype",C=!y&&cn&&Object(e)===e&&cn in e?zm.call(Si(e),8,-1):P?"Object":"",M=y||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",A=M+(C||P?"["+Mr.call(RM.call([],C||[],P||[]),": ")+"] ":"");return I.length===0?A+"{}":u?A+"{"+Tm(I,u)+"}":A+"{ "+Mr.call(I,", ")+" }"}return String(e)};function WM(n,e,t){var r=(t.quoteStyle||e)==="double"?'"':"'";return r+n+r}function E9(n){return Mi.call(String(n),/"/g,"&quot;")}function km(n){return Si(n)==="[object Array]"&&(!cn||!(typeof n=="object"&&cn in n))}function A9(n){return Si(n)==="[object Date]"&&(!cn||!(typeof n=="object"&&cn in n))}function VM(n){return Si(n)==="[object RegExp]"&&(!cn||!(typeof n=="object"&&cn in n))}function k9(n){return Si(n)==="[object Error]"&&(!cn||!(typeof n=="object"&&cn in n))}function T9(n){return Si(n)==="[object String]"&&(!cn||!(typeof n=="object"&&cn in n))}function D9(n){return Si(n)==="[object Number]"&&(!cn||!(typeof n=="object"&&cn in n))}function F9(n){return Si(n)==="[object Boolean]"&&(!cn||!(typeof n=="object"&&cn in n))}function KM(n){if(Ms)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!Em)return!1;try{return Em.call(n),!0}catch{}return!1}function z9(n){if(!n||typeof n!="object"||!Sm)return!1;try{return Sm.call(n),!0}catch{}return!1}var I9=Object.prototype.hasOwnProperty||function(n){return n in this};function Oi(n,e){return I9.call(n,e)}function Si(n){return w9.call(n)}function R9(n){if(n.name)return n.name;var e=O9.call(P9.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function $M(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1}function N9(n){if(!uu||!n||typeof n!="object")return!1;try{uu.call(n);try{hu.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function B9(n){if(!Oc||!n||typeof n!="object")return!1;try{Oc.call(n,Oc);try{Mc.call(n,Mc)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function L9(n){if(!zM||!n||typeof n!="object")return!1;try{return zM.call(n),!0}catch{}return!1}function q9(n){if(!hu||!n||typeof n!="object")return!1;try{hu.call(n);try{uu.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function j9(n){if(!Mc||!n||typeof n!="object")return!1;try{Mc.call(n,Mc);try{Oc.call(n,Oc)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function V9(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function XM(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,r="... "+t+" more character"+(t>1?"s":"");return XM(zm.call(n,0,e.maxStringLength),e)+r}var i=Mi.call(Mi.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,H9);return WM(i,"single",e)}function H9(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+M9.call(e.toString(16))}function Pc(n){return"Object("+n+")"}function Mm(n){return n+" { ? }"}function HM(n,e,t,r){var i=r?Tm(t,r):Mr.call(t,", ");return n+" ("+e+") {"+i+"}"}function U9(n){for(var e=0;e<n.length;e++)if($M(n[e],`
`)>=0)return!1;return!0}function G9(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Mr.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Mr.call(Array(e+1),t)}}function Tm(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Mr.call(n,","+t)+`
`+e.prev}function du(n,e){var t=km(n),r=[];if(t){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=Oi(n,i)?e(n[i],n):""}var o=typeof Om=="function"?Om(n):[],s;if(Ms){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var c in n)Oi(n,c)&&(t&&String(Number(c))===c&&c<n.length||Ms&&s["$"+c]instanceof Symbol||(UM.call(/[^\w$]/,c)?r.push(e(c,n)+": "+e(n[c],n)):r.push(c+": "+e(n[c],n))));if(typeof Om=="function")for(var l=0;l<o.length;l++)GM.call(n,o[l])&&r.push("["+e(o[l])+"]: "+e(n[o[l]],n));return r}});var eS=z((mie,ZM)=>{"use strict";var YM=bo(),Ss=kM(),W9=QM(),K9=_s(),pu=YM("%WeakMap%",!0),fu=YM("%Map%",!0),$9=Ss("WeakMap.prototype.get",!0),X9=Ss("WeakMap.prototype.set",!0),J9=Ss("WeakMap.prototype.has",!0),Q9=Ss("Map.prototype.get",!0),Y9=Ss("Map.prototype.set",!0),Z9=Ss("Map.prototype.has",!0),Im=function(n,e){for(var t=n,r;(r=t.next)!==null;t=r)if(r.key===e)return t.next=r.next,r.next=n.next,n.next=r,r},eL=function(n,e){var t=Im(n,e);return t&&t.value},tL=function(n,e,t){var r=Im(n,e);r?r.value=t:n.next={key:e,next:n.next,value:t}},nL=function(n,e){return!!Im(n,e)};ZM.exports=function(){var e,t,r,i={assert:function(o){if(!i.has(o))throw new K9("Side channel does not contain "+W9(o))},get:function(o){if(pu&&o&&(typeof o=="object"||typeof o=="function")){if(e)return $9(e,o)}else if(fu){if(t)return Q9(t,o)}else if(r)return eL(r,o)},has:function(o){if(pu&&o&&(typeof o=="object"||typeof o=="function")){if(e)return J9(e,o)}else if(fu){if(t)return Z9(t,o)}else if(r)return nL(r,o);return!1},set:function(o,s){pu&&o&&(typeof o=="object"||typeof o=="function")?(e||(e=new pu),X9(e,o,s)):fu?(t||(t=new fu),Y9(t,o,s)):(r||(r={key:{},next:null}),tL(r,o,s))}};return i}});var gu=z((vie,tS)=>{"use strict";var rL=String.prototype.replace,iL=/%20/g,Rm={RFC1738:"RFC1738",RFC3986:"RFC3986"};tS.exports={default:Rm.RFC3986,formatters:{RFC1738:function(n){return rL.call(n,iL,"+")},RFC3986:function(n){return String(n)}},RFC1738:Rm.RFC1738,RFC3986:Rm.RFC3986}});var Lm=z((bie,rS)=>{"use strict";var oL=gu(),Nm=Object.prototype.hasOwnProperty,xo=Array.isArray,Sr=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),sL=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(xo(r)){for(var i=[],o=0;o<r.length;++o)typeof r[o]<"u"&&i.push(r[o]);t.obj[t.prop]=i}}},nS=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},aL=function n(e,t,r){if(!t)return e;if(typeof t!="object"){if(xo(e))e.push(t);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Nm.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var i=e;return xo(e)&&!xo(t)&&(i=nS(e,r)),xo(e)&&xo(t)?(t.forEach(function(o,s){if(Nm.call(e,s)){var a=e[s];a&&typeof a=="object"&&o&&typeof o=="object"?e[s]=n(a,o,r):e.push(o)}else e[s]=o}),e):Object.keys(t).reduce(function(o,s){var a=t[s];return Nm.call(o,s)?o[s]=n(o[s],a,r):o[s]=a,o},i)},cL=function(e,t){return Object.keys(t).reduce(function(r,i){return r[i]=t[i],r},e)},lL=function(n,e,t){var r=n.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},Bm=1024,dL=function(e,t,r,i,o){if(e.length===0)return e;var s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),r==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var a="",c=0;c<s.length;c+=Bm){for(var l=s.length>=Bm?s.slice(c,c+Bm):s,h=[],u=0;u<l.length;++u){var d=l.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||o===oL.RFC1738&&(d===40||d===41)){h[h.length]=l.charAt(u);continue}if(d<128){h[h.length]=Sr[d];continue}if(d<2048){h[h.length]=Sr[192|d>>6]+Sr[128|d&63];continue}if(d<55296||d>=57344){h[h.length]=Sr[224|d>>12]+Sr[128|d>>6&63]+Sr[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|l.charCodeAt(u)&1023),h[h.length]=Sr[240|d>>18]+Sr[128|d>>12&63]+Sr[128|d>>6&63]+Sr[128|d&63]}a+=h.join("")}return a},uL=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var o=t[i],s=o.obj[o.prop],a=Object.keys(s),c=0;c<a.length;++c){var l=a[c],h=s[l];typeof h=="object"&&h!==null&&r.indexOf(h)===-1&&(t.push({obj:s,prop:l}),r.push(h))}return sL(t),e},hL=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},pL=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},fL=function(e,t){return[].concat(e,t)},gL=function(e,t){if(xo(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)};rS.exports={arrayToObject:nS,assign:cL,combine:fL,compact:uL,decode:lL,encode:dL,isBuffer:pL,isRegExp:hL,maybeMap:gL,merge:aL}});var lS=z((xie,cS)=>{"use strict";var oS=eS(),mu=Lm(),Sc=gu(),mL=Object.prototype.hasOwnProperty,sS={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Er=Array.isArray,vL=Array.prototype.push,aS=function(n,e){vL.apply(n,Er(e)?e:[e])},bL=Date.prototype.toISOString,iS=Sc.default,Dt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:mu.encode,encodeValuesOnly:!1,format:iS,formatter:Sc.formatters[iS],indices:!1,serializeDate:function(e){return bL.call(e)},skipNulls:!1,strictNullHandling:!1},xL=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},qm={},_L=function n(e,t,r,i,o,s,a,c,l,h,u,d,p,m,g,x,b,_){for(var O=e,S=_,E=0,D=!1;(S=S.get(qm))!==void 0&&!D;){var I=S.get(e);if(E+=1,typeof I<"u"){if(I===E)throw new RangeError("Cyclic object value");D=!0}typeof S.get(qm)>"u"&&(E=0)}if(typeof h=="function"?O=h(t,O):O instanceof Date?O=p(O):r==="comma"&&Er(O)&&(O=mu.maybeMap(O,function(G){return G instanceof Date?p(G):G})),O===null){if(s)return l&&!x?l(t,Dt.encoder,b,"key",m):t;O=""}if(xL(O)||mu.isBuffer(O)){if(l){var y=x?t:l(t,Dt.encoder,b,"key",m);return[g(y)+"="+g(l(O,Dt.encoder,b,"value",m))]}return[g(t)+"="+g(String(O))]}var P=[];if(typeof O>"u")return P;var C;if(r==="comma"&&Er(O))x&&l&&(O=mu.maybeMap(O,l)),C=[{value:O.length>0?O.join(",")||null:void 0}];else if(Er(h))C=h;else{var M=Object.keys(O);C=u?M.sort(u):M}var A=c?t.replace(/\./g,"%2E"):t,F=i&&Er(O)&&O.length===1?A+"[]":A;if(o&&Er(O)&&O.length===0)return F+"[]";for(var k=0;k<C.length;++k){var T=C[k],R=typeof T=="object"&&typeof T.value<"u"?T.value:O[T];if(!(a&&R===null)){var N=d&&c?T.replace(/\./g,"%2E"):T,q=Er(O)?typeof r=="function"?r(F,N):F:F+(d?"."+N:"["+N+"]");_.set(e,E);var V=oS();V.set(qm,_),aS(P,n(R,q,r,i,o,s,a,c,r==="comma"&&x&&Er(O)?null:l,h,u,d,p,m,g,x,b,V))}}return P},yL=function(e){if(!e)return Dt;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Dt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=Sc.default;if(typeof e.format<"u"){if(!mL.call(Sc.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=Sc.formatters[r],o=Dt.filter;(typeof e.filter=="function"||Er(e.filter))&&(o=e.filter);var s;if(e.arrayFormat in sS?s=e.arrayFormat:"indices"in e?s=e.indices?"indices":"repeat":s=Dt.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Dt.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Dt.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Dt.allowEmptyArrays,arrayFormat:s,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Dt.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Dt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Dt.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Dt.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Dt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Dt.encodeValuesOnly,filter:o,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Dt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Dt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Dt.strictNullHandling}};cS.exports=function(n,e){var t=n,r=yL(e),i,o;typeof r.filter=="function"?(o=r.filter,t=o("",t)):Er(r.filter)&&(o=r.filter,i=o);var s=[];if(typeof t!="object"||t===null)return"";var a=sS[r.arrayFormat],c=a==="comma"&&r.commaRoundTrip;i||(i=Object.keys(t)),r.sort&&i.sort(r.sort);for(var l=oS(),h=0;h<i.length;++h){var u=i[h];r.skipNulls&&t[u]===null||aS(s,_L(t[u],u,a,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}var d=s.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""}});var hS=z((_ie,uS)=>{"use strict";var Es=Lm(),jm=Object.prototype.hasOwnProperty,CL=Array.isArray,wt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Es.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},wL=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},dS=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},PL="utf8=%26%2310003%3B",OL="utf8=%E2%9C%93",ML=function(e,t){var r={__proto__:null},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,s=i.split(t.delimiter,o),a=-1,c,l=t.charset;if(t.charsetSentinel)for(c=0;c<s.length;++c)s[c].indexOf("utf8=")===0&&(s[c]===OL?l="utf-8":s[c]===PL&&(l="iso-8859-1"),a=c,c=s.length);for(c=0;c<s.length;++c)if(c!==a){var h=s[c],u=h.indexOf("]="),d=u===-1?h.indexOf("="):u+1,p,m;d===-1?(p=t.decoder(h,wt.decoder,l,"key"),m=t.strictNullHandling?null:""):(p=t.decoder(h.slice(0,d),wt.decoder,l,"key"),m=Es.maybeMap(dS(h.slice(d+1),t),function(x){return t.decoder(x,wt.decoder,l,"value")})),m&&t.interpretNumericEntities&&l==="iso-8859-1"&&(m=wL(m)),h.indexOf("[]=")>-1&&(m=CL(m)?[m]:m);var g=jm.call(r,p);g&&t.duplicates==="combine"?r[p]=Es.combine(r[p],m):(!g||t.duplicates==="last")&&(r[p]=m)}return r},SL=function(n,e,t,r){for(var i=r?e:dS(e,t),o=n.length-1;o>=0;--o){var s,a=n[o];if(a==="[]"&&t.parseArrays)s=t.allowEmptyArrays&&i===""?[]:[].concat(i);else{s=t.plainObjects?Object.create(null):{};var c=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=t.decodeDotInKeys?c.replace(/%2E/g,"."):c,h=parseInt(l,10);!t.parseArrays&&l===""?s={0:i}:!isNaN(h)&&a!==l&&String(h)===l&&h>=0&&t.parseArrays&&h<=t.arrayLimit?(s=[],s[h]=i):l!=="__proto__"&&(s[l]=i)}i=s}return i},EL=function(e,t,r,i){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,c=r.depth>0&&s.exec(o),l=c?o.slice(0,c.index):o,h=[];if(l){if(!r.plainObjects&&jm.call(Object.prototype,l)&&!r.allowPrototypes)return;h.push(l)}for(var u=0;r.depth>0&&(c=a.exec(o))!==null&&u<r.depth;){if(u+=1,!r.plainObjects&&jm.call(Object.prototype,c[1].slice(1,-1))&&!r.allowPrototypes)return;h.push(c[1])}return c&&h.push("["+o.slice(c.index)+"]"),SL(h,t,r,i)}},AL=function(e){if(!e)return wt;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?wt.charset:e.charset,r=typeof e.duplicates>"u"?wt.duplicates:e.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:wt.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:wt.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:wt.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:wt.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:wt.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:wt.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:wt.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:wt.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:wt.decoder,delimiter:typeof e.delimiter=="string"||Es.isRegExp(e.delimiter)?e.delimiter:wt.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:wt.depth,duplicates:r,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:wt.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:wt.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:wt.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:wt.strictNullHandling}};uS.exports=function(n,e){var t=AL(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var r=typeof n=="string"?ML(n,t):n,i=t.plainObjects?Object.create(null):{},o=Object.keys(r),s=0;s<o.length;++s){var a=o[s],c=EL(a,r[a],t,typeof n=="string");i=Es.merge(i,c,t)}return t.allowSparse===!0?i:Es.compact(i)}});var fS=z((yie,pS)=>{"use strict";var kL=lS(),TL=hS(),DL=gu();pS.exports={formats:DL,parse:TL,stringify:kL}});var Gm=z(ks=>{"use strict";var FL=kO();function Jn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var zL=/^([a-z0-9.+-]+:)/i,IL=/:[0-9]*$/,RL=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,NL=["<",">",'"',"`"," ","\r",`
`,"	"],BL=["{","}","|","\\","^","`"].concat(NL),Vm=["'"].concat(BL),gS=["%","/","?",";","#"].concat(Vm),mS=["/","?","#"],LL=255,vS=/^[+a-z0-9A-Z_-]{0,63}$/,qL=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jL={javascript:!0,"javascript:":!0},Hm={javascript:!0,"javascript:":!0},As={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Um=fS();function Ec(n,e,t){if(n&&typeof n=="object"&&n instanceof Jn)return n;var r=new Jn;return r.parse(n,e,t),r}Jn.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var r=n.indexOf("?"),i=r!==-1&&r<n.indexOf("#")?"?":"#",o=n.split(i),s=/\\/g;o[0]=o[0].replace(s,"/"),n=o.join(i);var a=n;if(a=a.trim(),!t&&n.split("#").length===1){var c=RL.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=Um.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=zL.exec(a);if(l){l=l[0];var h=l.toLowerCase();this.protocol=h,a=a.substr(l.length)}if(t||l||a.match(/^\/\/[^@/]+@[^@/]+/)){var u=a.substr(0,2)==="//";u&&!(l&&Hm[l])&&(a=a.substr(2),this.slashes=!0)}if(!Hm[l]&&(u||l&&!As[l])){for(var d=-1,p=0;p<mS.length;p++){var m=a.indexOf(mS[p]);m!==-1&&(d===-1||m<d)&&(d=m)}var g,x;d===-1?x=a.lastIndexOf("@"):x=a.lastIndexOf("@",d),x!==-1&&(g=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(g)),d=-1;for(var p=0;p<gS.length;p++){var m=a.indexOf(gS[p]);m!==-1&&(d===-1||m<d)&&(d=m)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var b=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!b)for(var _=this.hostname.split(/\./),p=0,O=_.length;p<O;p++){var S=_[p];if(S&&!S.match(vS)){for(var E="",D=0,I=S.length;D<I;D++)S.charCodeAt(D)>127?E+="x":E+=S[D];if(!E.match(vS)){var y=_.slice(0,p),P=_.slice(p+1),C=S.match(qL);C&&(y.push(C[1]),P.unshift(C[2])),P.length&&(a="/"+P.join(".")+a),this.hostname=y.join(".");break}}}this.hostname.length>LL?this.hostname="":this.hostname=this.hostname.toLowerCase(),b||(this.hostname=FL.toASCII(this.hostname));var M=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+M,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!jL[h])for(var p=0,O=Vm.length;p<O;p++){var F=Vm[p];if(a.indexOf(F)!==-1){var k=encodeURIComponent(F);k===F&&(k=escape(F)),a=a.split(F).join(k)}}var T=a.indexOf("#");T!==-1&&(this.hash=a.substr(T),a=a.slice(0,T));var R=a.indexOf("?");if(R!==-1?(this.search=a.substr(R),this.query=a.substr(R+1),e&&(this.query=Um.parse(this.query)),a=a.slice(0,R)):e&&(this.search="",this.query={}),a&&(this.pathname=a),As[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",N=this.search||"";this.path=M+N}return this.href=this.format(),this};function VL(n){return typeof n=="string"&&(n=Ec(n)),n instanceof Jn?n.format():Jn.prototype.format.call(n)}Jn.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=n+this.host:this.hostname&&(i=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=Um.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||o&&"?"+o||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||As[e])&&i!==!1?(i="//"+(i||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),s&&s.charAt(0)!=="?"&&(s="?"+s),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),s=s.replace("#","%23"),e+i+t+s+r};function HL(n,e){return Ec(n,!1,!0).resolve(e)}Jn.prototype.resolve=function(n){return this.resolveObject(Ec(n,!1,!0)).format()};function UL(n,e){return n?Ec(n,!1,!0).resolveObject(e):e}Jn.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Jn;e.parse(n,!1,!0),n=e}for(var t=new Jn,r=Object.keys(this),i=0;i<r.length;i++){var o=r[i];t[o]=this[o]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var s=Object.keys(n),a=0;a<s.length;a++){var c=s[a];c!=="protocol"&&(t[c]=n[c])}return As[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!As[n.protocol]){for(var l=Object.keys(n),h=0;h<l.length;h++){var u=l[h];t[u]=n[u]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!Hm[n.protocol]){for(var O=(n.pathname||"").split("/");O.length&&!(n.host=O.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),O[0]!==""&&O.unshift(""),O.length<2&&O.unshift(""),t.pathname=O.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var d=t.pathname||"",p=t.search||"";t.path=d+p}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var m=t.pathname&&t.pathname.charAt(0)==="/",g=n.host||n.pathname&&n.pathname.charAt(0)==="/",x=g||m||t.host&&n.pathname,b=x,_=t.pathname&&t.pathname.split("/")||[],O=n.pathname&&n.pathname.split("/")||[],S=t.protocol&&!As[t.protocol];if(S&&(t.hostname="",t.port=null,t.host&&(_[0]===""?_[0]=t.host:_.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(O[0]===""?O[0]=n.host:O.unshift(n.host)),n.host=null),x=x&&(O[0]===""||_[0]==="")),g)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,_=O;else if(O.length)_||(_=[]),_.pop(),_=_.concat(O),t.search=n.search,t.query=n.query;else if(n.search!=null){if(S){t.host=_.shift(),t.hostname=t.host;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!_.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var D=_.slice(-1)[0],I=(t.host||n.host||_.length>1)&&(D==="."||D==="..")||D==="",y=0,P=_.length;P>=0;P--)D=_[P],D==="."?_.splice(P,1):D===".."?(_.splice(P,1),y++):y&&(_.splice(P,1),y--);if(!x&&!b)for(;y--;y)_.unshift("..");x&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),I&&_.join("/").substr(-1)!=="/"&&_.push("");var C=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(S){t.hostname=C?"":_.length?_.shift():"",t.host=t.hostname;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return x=x||t.host&&_.length,x&&!C&&_.unshift(""),_.length>0?t.pathname=_.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Jn.prototype.parseHost=function(){var n=this.host,e=IL.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};ks.parse=Ec;ks.resolve=HL;ks.resolveObject=UL;ks.format=VL;ks.Url=Jn});var Wm=z((Mie,bS)=>{"use strict";bS.exports=function(e,t){return function(){return e.apply(t,arguments)}}});var Mt=z((Sie,CS)=>{"use strict";var GL=Wm(),Xm=Object.prototype.toString,Jm=function(n){return function(e){var t=Xm.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())}}(Object.create(null));function ki(n){return n=n.toLowerCase(),function(t){return Jm(t)===n}}function bu(n){return Array.isArray(n)}function Km(n){return typeof n>"u"}function WL(n){return n!==null&&!Km(n)&&n.constructor!==null&&!Km(n.constructor)&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}var xS=ki("ArrayBuffer");function KL(n){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&xS(n.buffer),e}function $L(n){return typeof n=="string"}function _S(n){return typeof n=="number"}function yS(n){return n!==null&&typeof n=="object"}function vu(n){if(Jm(n)!=="object")return!1;var e=Object.getPrototypeOf(n);return e===null||e===Object.prototype}function XL(n){return n&&Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}var JL=ki("Date"),QL=ki("File"),YL=ki("Blob"),ZL=ki("FileList");function Qm(n){return Xm.call(n)==="[object Function]"}function eq(n){return yS(n)&&Qm(n.pipe)}function tq(n){var e="[object FormData]";return n&&(typeof FormData=="function"&&n instanceof FormData||Xm.call(n)===e||Qm(n.toString)&&n.toString()===e)}var nq=ki("URLSearchParams");function rq(n){return n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function iq(){var n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Ym(n,e){if(!(n===null||typeof n>"u"))if(typeof n!="object"&&(n=[n]),bu(n))for(var t=0,r=n.length;t<r;t++)e.call(null,n[t],t,n);else for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.call(null,n[i],i,n)}function $m(){var n={};function e(i,o){vu(n[o])&&vu(i)?n[o]=$m(n[o],i):vu(i)?n[o]=$m({},i):bu(i)?n[o]=i.slice():n[o]=i}for(var t=0,r=arguments.length;t<r;t++)Ym(arguments[t],e);return n}function oq(n,e,t){return Ym(e,function(i,o){t&&typeof i=="function"?n[o]=GL(i,t):n[o]=i}),n}function sq(n){return n.charCodeAt(0)===65279&&(n=n.slice(1)),n}function aq(n,e,t,r){n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,t&&Object.assign(n.prototype,t)}function cq(n,e,t,r){var i,o,s,a={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),o=i.length;o-- >0;)s=i[o],(!r||r(s,n,e))&&!a[s]&&(e[s]=n[s],a[s]=!0);n=t!==!1&&Object.getPrototypeOf(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e}function lq(n,e,t){n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return r!==-1&&r===t}function dq(n){if(!n)return null;if(bu(n))return n;var e=n.length;if(!_S(e))return null;for(var t=new Array(e);e-- >0;)t[e]=n[e];return t}var uq=function(n){return function(e){return n&&e instanceof n}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array));function hq(n,e){for(var t=n&&n[Symbol.iterator],r=t.call(n),i;(i=r.next())&&!i.done;){var o=i.value;e.call(n,o[0],o[1])}}function pq(n,e){for(var t,r=[];(t=n.exec(e))!==null;)r.push(t);return r}var fq=ki("HTMLFormElement"),gq=function(e){return function(t,r){return e.call(t,r)}}(Object.prototype.hasOwnProperty);CS.exports={isArray:bu,isArrayBuffer:xS,isBuffer:WL,isFormData:tq,isArrayBufferView:KL,isString:$L,isNumber:_S,isObject:yS,isPlainObject:vu,isEmptyObject:XL,isUndefined:Km,isDate:JL,isFile:QL,isBlob:YL,isFunction:Qm,isStream:eq,isURLSearchParams:nq,isStandardBrowserEnv:iq,forEach:Ym,merge:$m,extend:oq,trim:rq,stripBOM:sq,inherits:aq,toFlatObject:cq,kindOf:Jm,kindOfTest:ki,endsWith:lq,toArray:dq,isTypedArray:uq,isFileList:ZL,forEachEntry:hq,matchAll:pq,isHTMLForm:fq,hasOwnProperty:gq}});var Ti=z((Eie,MS)=>{"use strict";var wS=Mt();function Ts(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i)}wS.inherits(Ts,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var PS=Ts.prototype,OS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(n){OS[n]={value:n}});Object.defineProperties(Ts,OS);Object.defineProperty(PS,"isAxiosError",{value:!0});Ts.from=function(n,e,t,r,i,o){var s=Object.create(PS);return wS.toFlatObject(n,s,function(c){return c!==Error.prototype}),Ts.call(s,n.message,e,t,r,i),s.cause=n,s.name=n.name,o&&Object.assign(s,o),s};MS.exports=Ts});var ES=z((Aie,SS)=>{SS.exports=typeof self=="object"?self.FormData:window.FormData});var kS=z((kie,AS)=>{AS.exports=ES()});var Ac=z((Tie,FS)=>{"use strict";var ct=Mt(),mq=Ti(),vq=kS();function Zm(n){return ct.isPlainObject(n)||ct.isArray(n)}function DS(n){return ct.endsWith(n,"[]")?n.slice(0,-2):n}function TS(n,e,t){return n?n.concat(e).map(function(i,o){return i=DS(i),!t&&o?"["+i+"]":i}).join(t?".":""):e}function bq(n){return ct.isArray(n)&&!n.some(Zm)}var xq=ct.toFlatObject(ct,{},null,function(e){return/^is[A-Z]/.test(e)});function _q(n){return n&&ct.isFunction(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator]}function yq(n,e,t){if(!ct.isObject(n))throw new TypeError("target must be an object");e=e||new(vq||FormData),t=ct.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,x){return!ct.isUndefined(x[g])});var r=t.metaTokens,i=t.visitor||h,o=t.dots,s=t.indexes,a=t.Blob||typeof Blob<"u"&&Blob,c=a&&_q(e);if(!ct.isFunction(i))throw new TypeError("visitor must be a function");function l(m){if(m===null)return"";if(ct.isDate(m))return m.toISOString();if(!c&&ct.isBlob(m))throw new mq("Blob is not supported. Use a Buffer instead.");return ct.isArrayBuffer(m)||ct.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function h(m,g,x){var b=m;if(m&&!x&&typeof m=="object"){if(ct.endsWith(g,"{}"))g=r?g:g.slice(0,-2),m=JSON.stringify(m);else if(ct.isArray(m)&&bq(m)||ct.isFileList(m)||ct.endsWith(g,"[]")&&(b=ct.toArray(m)))return g=DS(g),b.forEach(function(O,S){!ct.isUndefined(O)&&e.append(s===!0?TS([g],S,o):s===null?g:g+"[]",l(O))}),!1}return Zm(m)?!0:(e.append(TS(x,g,o),l(m)),!1)}var u=[],d=Object.assign(xq,{defaultVisitor:h,convertValue:l,isVisitable:Zm});function p(m,g){if(!ct.isUndefined(m)){if(u.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(m),ct.forEach(m,function(b,_){var O=!ct.isUndefined(b)&&i.call(e,b,ct.isString(_)?_.trim():_,g,d);O===!0&&p(b,g?g.concat(_):[_])}),u.pop()}}if(!ct.isObject(n))throw new TypeError("data must be an object");return p(n),e}FS.exports=yq});var ev=z((Die,NS)=>{"use strict";var Cq=Ac();function zS(n){var e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'\(\)~]|%20|%00/g,function(r){return e[r]})}function IS(n,e){this._pairs=[],n&&Cq(n,this,e)}var RS=IS.prototype;RS.append=function(e,t){this._pairs.push([e,t])};RS.toString=function(e){var t=e?function(r){return e.call(this,r,zS)}:zS;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};NS.exports=IS});var tv=z((Fie,BS)=>{"use strict";var wq=Mt(),Pq=ev();function Oq(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}BS.exports=function(e,t,r){if(!t)return e;var i=e.indexOf("#");i!==-1&&(e=e.slice(0,i));var o=r&&r.encode||Oq,s=r&&r.serialize,a;return s?a=s(t,r):a=wq.isURLSearchParams(t)?t.toString():new Pq(t,r).toString(o),a&&(e+=(e.indexOf("?")===-1?"?":"&")+a),e}});var qS=z((zie,LS)=>{"use strict";var Mq=Mt();function kc(){this.handlers=[]}kc.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};kc.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};kc.prototype.clear=function(){this.handlers&&(this.handlers=[])};kc.prototype.forEach=function(e){Mq.forEach(this.handlers,function(r){r!==null&&e(r)})};LS.exports=kc});var nv=z((Iie,jS)=>{"use strict";var Sq=Mt();jS.exports=function(e,t){Sq.forEach(e,function(i,o){o!==t&&o.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[o])})}});var rv=z((Rie,VS)=>{"use strict";VS.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}});var US=z((Nie,HS)=>{"use strict";var Eq=ev();HS.exports=typeof URLSearchParams<"u"?URLSearchParams:Eq});var WS=z((Bie,GS)=>{"use strict";GS.exports=FormData});var $S=z((Lie,KS)=>{"use strict";KS.exports={isBrowser:!0,classes:{URLSearchParams:US(),FormData:WS(),Blob},protocols:["http","https","file","blob","url","data"]}});var xu=z((qie,XS)=>{"use strict";XS.exports=$S()});var YS=z((jie,QS)=>{"use strict";var Aq=Mt(),kq=Ac(),JS=xu();QS.exports=function(e,t){return kq(e,new JS.classes.URLSearchParams,Object.assign({visitor:function(r,i,o,s){return JS.isNode&&Aq.isBuffer(r)?(this.append(i,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}});var iv=z((Vie,ZS)=>{"use strict";var Di=Mt();function Tq(n){return Di.matchAll(/\w+|\[(\w*)]/g,n).map(function(e){return e[0]==="[]"?"":e[1]||e[0]})}function Dq(n){var e={},t=Object.keys(n),r,i=t.length,o;for(r=0;r<i;r++)o=t[r],e[o]=n[o];return e}function Fq(n){function e(r,i,o,s){var a=r[s++],c=Number.isFinite(+a),l=s>=r.length;if(a=!a&&Di.isArray(o)?o.length:a,l)return Di.hasOwnProperty(o,a)?o[a]=[o[a],i]:o[a]=i,!c;(!o[a]||!Di.isObject(o[a]))&&(o[a]=[]);var h=e(r,i,o[a],s);return h&&Di.isArray(o[a])&&(o[a]=Dq(o[a])),!c}if(Di.isFormData(n)&&Di.isFunction(n.entries)){var t={};return Di.forEachEntry(n,function(r,i){e(Tq(r),i,t,0)}),t}return null}ZS.exports=Fq});var t2=z((Hie,e2)=>{"use strict";var ov=Ti();e2.exports=function(e,t,r){var i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new ov("Request failed with status code "+r.status,[ov.ERR_BAD_REQUEST,ov.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}});var r2=z((Uie,n2)=>{"use strict";var _u=Mt();n2.exports=_u.isStandardBrowserEnv()?function(){return{write:function(t,r,i,o,s,a){var c=[];c.push(t+"="+encodeURIComponent(r)),_u.isNumber(i)&&c.push("expires="+new Date(i).toGMTString()),_u.isString(o)&&c.push("path="+o),_u.isString(s)&&c.push("domain="+s),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(t){var r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var o2=z((Gie,i2)=>{"use strict";i2.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}});var a2=z((Wie,s2)=>{"use strict";s2.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}});var sv=z((Kie,c2)=>{"use strict";var zq=o2(),Iq=a2();c2.exports=function(e,t){return e&&!zq(t)?Iq(e,t):t}});var d2=z(($ie,l2)=>{"use strict";var av=Mt(),Rq=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];l2.exports=function(e){var t={},r,i,o;return e&&av.forEach(e.split(`
`),function(a){if(o=a.indexOf(":"),r=av.trim(a.slice(0,o)).toLowerCase(),i=av.trim(a.slice(o+1)),r){if(t[r]&&Rq.indexOf(r)>=0)return;r==="set-cookie"?t[r]=(t[r]?t[r]:[]).concat([i]):t[r]=t[r]?t[r]+", "+i:i}}),t}});var p2=z((Xie,h2)=>{"use strict";var u2=Mt();h2.exports=u2.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),r;function i(o){var s=o;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=i(window.location.href),function(s){var a=u2.isString(s)?i(s):s;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}()});var Tc=z((Jie,g2)=>{"use strict";var cv=Ti(),Nq=Mt();function f2(n,e,t){cv.call(this,n??"canceled",cv.ERR_CANCELED,e,t),this.name="CanceledError"}Nq.inherits(f2,cv,{__CANCEL__:!0});g2.exports=f2});var v2=z((Qie,m2)=>{"use strict";m2.exports=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}});var lv=z((Yie,b2)=>{"use strict";var Ds=Mt(),Bq=t2(),Lq=r2(),qq=tv(),jq=sv(),Vq=d2(),Hq=p2(),Uq=rv(),Ur=Ti(),Gq=Tc(),Wq=v2(),Kq=xu();b2.exports=function(e){return new Promise(function(r,i){var o=e.data,s=e.headers,a=e.responseType,c=e.withXSRFToken,l;function h(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}Ds.isFormData(o)&&Ds.isStandardBrowserEnv()&&delete s["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.Authorization="Basic "+btoa(d+":"+p)}var m=jq(e.baseURL,e.url);u.open(e.method.toUpperCase(),qq(m,e.params,e.paramsSerializer),!0),u.timeout=e.timeout;function g(){if(u){var _="getAllResponseHeaders"in u?Vq(u.getAllResponseHeaders()):null,O=!a||a==="text"||a==="json"?u.responseText:u.response,S={data:O,status:u.status,statusText:u.statusText,headers:_,config:e,request:u};Bq(function(D){r(D),h()},function(D){i(D),h()},S),u=null}}if("onloadend"in u?u.onloadend=g:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(g)},u.onabort=function(){u&&(i(new Ur("Request aborted",Ur.ECONNABORTED,e,u)),u=null)},u.onerror=function(){i(new Ur("Network Error",Ur.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){var O=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",S=e.transitional||Uq;e.timeoutErrorMessage&&(O=e.timeoutErrorMessage),i(new Ur(O,S.clarifyTimeoutError?Ur.ETIMEDOUT:Ur.ECONNABORTED,e,u)),u=null},Ds.isStandardBrowserEnv()&&(c&&Ds.isFunction(c)&&(c=c(e)),c||c!==!1&&Hq(m))){var x=e.xsrfHeaderName&&e.xsrfCookieName&&Lq.read(e.xsrfCookieName);x&&(s[e.xsrfHeaderName]=x)}"setRequestHeader"in u&&Ds.forEach(s,function(O,S){typeof o>"u"&&S.toLowerCase()==="content-type"?delete s[S]:u.setRequestHeader(S,O)}),Ds.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),a&&a!=="json"&&(u.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&u.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(l=function(_){u&&(i(!_||_.type?new Gq(null,e,u):_),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l))),!o&&o!==!1&&o!==0&&o!==""&&(o=null);var b=Wq(m);if(b&&Kq.protocols.indexOf(b)===-1){i(new Ur("Unsupported protocol "+b+":",Ur.ERR_BAD_REQUEST,e));return}u.send(o)})}});var Cu=z((Zie,w2)=>{"use strict";var Ft=Mt(),x2=nv(),_2=Ti(),$q=rv(),Xq=Ac(),Jq=YS(),y2=xu(),Qq=iv(),Yq={"Content-Type":"application/x-www-form-urlencoded"};function C2(n,e){!Ft.isUndefined(n)&&Ft.isUndefined(n["Content-Type"])&&(n["Content-Type"]=e)}function Zq(){var n;return typeof XMLHttpRequest<"u"?n=lv():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(n=lv()),n}function ej(n,e,t){if(Ft.isString(n))try{return(e||JSON.parse)(n),Ft.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}var yu={transitional:$q,adapter:Zq(),transformRequest:[function(e,t){x2(t,"Accept"),x2(t,"Content-Type");var r=t&&t["Content-Type"]||"",i=r.indexOf("application/json")>-1,o=Ft.isObject(e);o&&Ft.isHTMLForm(e)&&(e=new FormData(e));var s=Ft.isFormData(e);if(s)return i?JSON.stringify(Qq(e)):e;if(Ft.isArrayBuffer(e)||Ft.isBuffer(e)||Ft.isStream(e)||Ft.isFile(e)||Ft.isBlob(e))return e;if(Ft.isArrayBufferView(e))return e.buffer;if(Ft.isURLSearchParams(e))return C2(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var a;if(o){if(r.indexOf("application/x-www-form-urlencoded")!==-1)return Jq(e,this.formSerializer).toString();if((a=Ft.isFileList(e))||r.indexOf("multipart/form-data")>-1){var c=this.env&&this.env.FormData;return Xq(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||i?(C2(t,"application/json"),ej(e)):e}],transformResponse:[function(e){var t=this.transitional||yu.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(e&&Ft.isString(e)&&(r&&!this.responseType||i)){var o=t&&t.silentJSONParsing,s=!o&&i;try{return JSON.parse(e)}catch(a){if(s)throw a.name==="SyntaxError"?_2.from(a,_2.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:y2.classes.FormData,Blob:y2.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ft.forEach(["delete","get","head"],function(e){yu.headers[e]={}});Ft.forEach(["post","put","patch"],function(e){yu.headers[e]=Ft.merge(Yq)});w2.exports=yu});var O2=z((eoe,P2)=>{"use strict";var tj=Mt(),nj=Cu();P2.exports=function(e,t,r,i){var o=this||nj;return tj.forEach(i,function(a){e=a.call(o,e,t,r)}),e}});var dv=z((toe,M2)=>{"use strict";M2.exports=function(e){return!!(e&&e.__CANCEL__)}});var k2=z((noe,A2)=>{"use strict";var S2=Mt(),uv=O2(),rj=dv(),ij=Cu(),oj=Tc(),E2=nv();function hv(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new oj}A2.exports=function(e){hv(e),e.headers=e.headers||{},e.data=uv.call(e,e.data,e.headers,null,e.transformRequest),E2(e.headers,"Accept"),E2(e.headers,"Content-Type"),e.headers=S2.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),S2.forEach(["delete","get","head","post","put","patch","common"],function(i){delete e.headers[i]});var t=e.adapter||ij.adapter;return t(e).then(function(i){return hv(e),i.data=uv.call(e,i.data,i.headers,i.status,e.transformResponse),i},function(i){return rj(i)||(hv(e),i&&i.response&&(i.response.data=uv.call(e,i.response.data,i.response.headers,i.response.status,e.transformResponse))),Promise.reject(i)})}});var pv=z((roe,T2)=>{"use strict";var gn=Mt();T2.exports=function(e,t){t=t||{};var r={};function i(h,u){return gn.isPlainObject(h)&&gn.isPlainObject(u)?gn.merge(h,u):gn.isEmptyObject(u)?gn.merge({},h):gn.isPlainObject(u)?gn.merge({},u):gn.isArray(u)?u.slice():u}function o(h){if(gn.isUndefined(t[h])){if(!gn.isUndefined(e[h]))return i(void 0,e[h])}else return i(e[h],t[h])}function s(h){if(!gn.isUndefined(t[h]))return i(void 0,t[h])}function a(h){if(gn.isUndefined(t[h])){if(!gn.isUndefined(e[h]))return i(void 0,e[h])}else return i(void 0,t[h])}function c(h){if(h in t)return i(e[h],t[h]);if(h in e)return i(void 0,e[h])}var l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return gn.forEach(Object.keys(e).concat(Object.keys(t)),function(u){var d=l[u]||o,p=d(u);gn.isUndefined(p)&&d!==c||(r[u]=p)}),r}});var fv=z((ioe,D2)=>{D2.exports={version:"0.28.1"}});var I2=z((ooe,z2)=>{"use strict";var sj=fv().version,Fi=Ti(),gv={};["object","boolean","number","function","string","symbol"].forEach(function(n,e){gv[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});var F2={};gv.transitional=function(e,t,r){function i(o,s){return"[Axios v"+sj+"] Transitional option '"+o+"'"+s+(r?". "+r:"")}return function(o,s,a){if(e===!1)throw new Fi(i(s," has been removed"+(t?" in "+t:"")),Fi.ERR_DEPRECATED);return t&&!F2[s]&&(F2[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,s,a):!0}};function aj(n,e,t){if(typeof n!="object")throw new Fi("options must be an object",Fi.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(n),i=r.length;i-- >0;){var o=r[i],s=e[o];if(s){var a=n[o],c=a===void 0||s(a,o,n);if(c!==!0)throw new Fi("option "+o+" must be "+c,Fi.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Fi("Unknown option "+o,Fi.ERR_BAD_OPTION)}}z2.exports={assertOptions:aj,validators:gv}});var L2=z((soe,B2)=>{"use strict";var vv=Mt(),cj=tv(),R2=qS(),N2=k2(),wu=pv(),lj=sv(),mv=I2(),zi=mv.validators;function Fs(n){this.defaults=n,this.interceptors={request:new R2,response:new R2}}Fs.prototype.request=function(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=wu(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;r!==void 0&&mv.assertOptions(r,{silentJSONParsing:zi.transitional(zi.boolean),forcedJSONParsing:zi.transitional(zi.boolean),clarifyTimeoutError:zi.transitional(zi.boolean)},!1);var i=t.paramsSerializer;i!==void 0&&mv.assertOptions(i,{encode:zi.function,serialize:zi.function},!0),vv.isFunction(i)&&(t.paramsSerializer={serialize:i});var o=[],s=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(s=s&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});var a=[];this.interceptors.response.forEach(function(m){a.push(m.fulfilled,m.rejected)});var c;if(!s){var l=[N2,void 0];for(Array.prototype.unshift.apply(l,o),l=l.concat(a),c=Promise.resolve(t);l.length;)c=c.then(l.shift(),l.shift());return c}for(var h=t;o.length;){var u=o.shift(),d=o.shift();try{h=u(h)}catch(p){d(p);break}}try{c=N2(h)}catch(p){return Promise.reject(p)}for(;a.length;)c=c.then(a.shift(),a.shift());return c};Fs.prototype.getUri=function(e){e=wu(this.defaults,e);var t=lj(e.baseURL,e.url);return cj(t,e.params,e.paramsSerializer)};vv.forEach(["delete","get","head","options"],function(e){Fs.prototype[e]=function(t,r){return this.request(wu(r||{},{method:e,url:t,data:(r||{}).data}))}});vv.forEach(["post","put","patch"],function(e){function t(r){return function(o,s,a){return this.request(wu(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Fs.prototype[e]=t(),Fs.prototype[e+"Form"]=t(!0)});B2.exports=Fs});var j2=z((aoe,q2)=>{"use strict";var dj=Tc();function zs(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(i){e=i});var t=this;this.promise.then(function(r){if(t._listeners){for(var i=t._listeners.length;i-- >0;)t._listeners[i](r);t._listeners=null}}),this.promise.then=function(r){var i,o=new Promise(function(s){t.subscribe(s),i=s}).then(r);return o.cancel=function(){t.unsubscribe(i)},o},n(function(i,o,s){t.reason||(t.reason=new dj(i,o,s),e(t.reason))})}zs.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};zs.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};zs.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}};zs.source=function(){var e,t=new zs(function(i){e=i});return{token:t,cancel:e}};q2.exports=zs});var H2=z((coe,V2)=>{"use strict";V2.exports=function(e){return function(r){return e.apply(null,r)}}});var G2=z((loe,U2)=>{"use strict";var uj=Mt();U2.exports=function(e){return uj.isObject(e)&&e.isAxiosError===!0}});var K2=z((doe,xv)=>{"use strict";var bv=Mt(),hj=Wm(),Pu=L2(),pj=pv(),fj=Cu(),gj=iv();function W2(n){var e=new Pu(n),t=hj(Pu.prototype.request,e);return bv.extend(t,Pu.prototype,e),bv.extend(t,e),t.create=function(i){return W2(pj(n,i))},t}var mn=W2(fj);mn.Axios=Pu;mn.CanceledError=Tc();mn.CancelToken=j2();mn.isCancel=dv();mn.VERSION=fv().version;mn.toFormData=Ac();mn.AxiosError=Ti();mn.Cancel=mn.CanceledError;mn.all=function(e){return Promise.all(e)};mn.spread=H2();mn.isAxiosError=G2();mn.formToJSON=function(n){return gj(bv.isHTMLForm(n)?new FormData(n):n)};xv.exports=mn;xv.exports.default=mn});var X2=z((uoe,$2)=>{$2.exports=K2()});function ur(n,e){if(n==="")return e===void 0?"":e.absolutePath;{let t=n.startsWith("/")?n.slice(1):n;return t=t.endsWith("/")?t.slice(0,-1):t,e===void 0?`/${t}`:`${e.absolutePath==="/"?"":e.absolutePath}/${t}`}}var iE=W(()=>{});function Ni(n){if(n!==null&&typeof n=="object"&&n.errorFromRequestFluidObject===!0){let r=n;return{mimeType:"text/plain",status:r.code,value:r.message,get stack(){return r.stack}}}let t=fs();return{mimeType:"text/plain",status:500,value:`${n}`,get stack(){var r;return(r=n?.stack)!==null&&r!==void 0?r:t.stack}}}function Bi(n,e){let t=n.value,r=fs();return{errorFromRequestFluidObject:!0,message:t,name:"Error",code:n.status,get stack(){var o;return(o=n.stack)!==null&&o!==void 0?o:r.stack}}}function Tr(n,e){return v(this,null,function*(){let t=typeof e=="string"?{url:e}:e,r=yield n.request(t);if(r.status!==200||r.mimeType!=="fluid/object")throw Bi(r,t);return w(r.value,410),r.value})}function ku(n,e,t){var r;w(n!==200,411);let i=(r=t.url)===null||r===void 0?void 0:r.split("?")[0],o=fs();return{mimeType:"text/plain",status:n,value:i===void 0?e:`${e}: ${i}`,get stack(){return o.stack}}}function _j(n,e){return{type:n,get IFluidDataStoreFactory(){return this},get IFluidDataStoreRegistry(){return this},instantiateDataStore:(t,r)=>v(this,null,function*(){return(yield e).instantiateDataStore(t,r)}),get:t=>v(this,null,function*(){var r;return(r=(yield e).IFluidDataStoreRegistry)===null||r===void 0?void 0:r.get(t)})}}var zt,oE=W(()=>{Y();Pe();zt=n=>ku(404,"not found",n)});var Av,sE=W(()=>{Y();Av=class{constructor(e,t){this.storage=e,this.path=t,w(!t.endsWith("/"),412)}readBlob(e){return v(this,null,function*(){return this.storage.readBlob(`${this.path}/${e}`)})}contains(e){return v(this,null,function*(){return this.storage.contains(`${this.path}/${e}`)})}list(e){return v(this,null,function*(){return this.storage.list(`${this.path}/${e}`)})}}});function Tu(n){let e=n;return e.startsWith("/")&&(e=e.substr(1)),e.endsWith("/")&&(e=e.substr(0,e.length-1)),e.length>0?e.split("/"):[]}function yj(n,e){return v(this,null,function*(){let t=Tu(e),r=n;for(;r?.entries!==void 0&&t.length>0;){let i=t.shift(),o=r.entries.find(s=>s.type==="Tree"&&s.path===i);o?.type==="Tree"?r=o.value:r=void 0}if(r?.entries===void 0||t.length!==0)throw new Error("path does not exist");return r.entries.filter(i=>i.type==="Blob").map(i=>i.path)})}var aE=W(()=>{});var Sn,cE=W(()=>{Sn=class n{constructor(e){this.request=e;let t=this.request.url.indexOf("?");t>=0?this.query=this.request.url.substring(t):this.query=""}static getPathParts(e){let t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((r,i)=>(i!==void 0&&i.length>0&&r.push(decodeURIComponent(i)),r),[])}static create(e){return e instanceof n?e:new n(e)}get url(){return this.request.url}get headers(){return this.request.headers}get pathParts(){return this.requestPathParts===void 0&&(this.requestPathParts=n.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return this.query===""&&this.pathParts.length===e}createSubRequest(e){let t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};let r=`/${this.pathParts.slice(e).join("/")}`;return{url:this.query===""?r:`${r}/${this.query}`,headers:this.headers}}}});var Nc,lE=W(()=>{Nc=class{get IRuntimeFactory(){return this}instantiateRuntime(e,t){return v(this,null,function*(){let r=t===void 0?e.existing===!0:t,i=yield this.preInitialize(e,r);return r?yield this.instantiateFromExisting(i):yield this.instantiateFirstTime(i),yield this.hasInitialized(i),i})}instantiateFirstTime(e){return v(this,null,function*(){})}instantiateFromExisting(e){return v(this,null,function*(){})}hasInitialized(e){return v(this,null,function*(){})}}});var dE=z(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.IFluidDataStoreFactory=void 0;Du.IFluidDataStoreFactory="IFluidDataStoreFactory"});var uE=z(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.IFluidDataStoreRegistry=void 0;Fu.IFluidDataStoreRegistry="IFluidDataStoreRegistry"});var hE=z(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.VisibilityState=Co.FlushMode=void 0;var Cj;(function(n){n[n.Immediate=0]="Immediate",n[n.TurnBased=1]="TurnBased"})(Cj=Co.FlushMode||(Co.FlushMode={}));Co.VisibilityState={NotVisible:"NotVisible",LocallyVisible:"LocallyVisible",GloballyVisible:"GloballyVisible"}});var pE=z(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.gcBlobKey=void 0;zu.gcBlobKey="gc"});var gE=z(fE=>{"use strict";Object.defineProperty(fE,"__esModule",{value:!0})});var mE=z(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.totalBlobSizePropertyName=hr.blobCountPropertyName=hr.channelsTreeName=hr.CreateSummarizerNodeSource=void 0;var wj;(function(n){n[n.FromSummary=0]="FromSummary",n[n.FromAttach=1]="FromAttach",n[n.Local=2]="Local"})(wj=hr.CreateSummarizerNodeSource||(hr.CreateSummarizerNodeSource={}));hr.channelsTreeName=".channels";hr.blobCountPropertyName="BlobCount";hr.totalBlobSizePropertyName="TotalBlobSize"});var qn=z(Qn=>{"use strict";var Pj=Qn&&Qn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Bs=Qn&&Qn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Pj(e,n,t)};Object.defineProperty(Qn,"__esModule",{value:!0});Bs(dE(),Qn);Bs(uE(),Qn);Bs(hE(),Qn);Bs(pE(),Qn);Bs(gE(),Qn);Bs(mE(),Qn)});var vE=W(()=>{});var bE=W(()=>{});var xE=W(()=>{});var _E=W(()=>{});var Bc,yE=W(()=>{Bc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(Bc||{})});var xt,CE=W(()=>{xt=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(xt||{})});var wE=W(()=>{});var PE=W(()=>{});var OE=W(()=>{});var ME=W(()=>{});var Iu=W(()=>{vE();bE();xE();_E();yE();CE();wE();PE();OE();ME();});function pr(...n){let e={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0,unreferencedBlobSize:0};for(let t of n)e.treeNodeCount+=t.treeNodeCount,e.blobNodeCount+=t.blobNodeCount,e.handleNodeCount+=t.handleNodeCount,e.totalBlobSize+=t.totalBlobSize,e.unreferencedBlobSize+=t.unreferencedBlobSize;return e}function SE(n){let e=n.length;for(let t=n.length-1;t>=0;t--){let r=n.charCodeAt(t);r>127&&r<=2047?e++:r>2047&&r<=65535&&(e+=2),r>=56320&&r<=57343&&t--}return e}function kv(n){return typeof n=="string"?SE(n):n.byteLength}function EE(n,e){switch(n.type){case xt.Tree:{e.treeNodeCount++;for(let t of Object.values(n.tree))EE(t,e);return}case xt.Handle:{e.handleNodeCount++;return}case xt.Blob:{e.blobNodeCount++,e.totalBlobSize+=kv(n.content);return}default:return}}function qc(n){let e=pr();return EE(n,e),e}function En(n,e,t){let r={type:xt.Blob,content:t};n.summary.tree[e]=r,n.stats.blobNodeCount++,n.stats.totalBlobSize+=kv(t)}function Tv(n,e,t){n.summary.tree[e]=t.summary,n.stats=pr(n.stats,t.stats)}function Dv(n,e,t){n.summary.tree[e]=t.summary,n.stats=pr(n.stats,t.stats)}function AE(n,e=!1){let t=new Pt;for(let i of n.entries)switch(i.type){case Bc.Blob:{let o=i.value,s;o.encoding==="base64"?s=Kt.from(o.contents,"base64"):s=o.contents,t.addBlob(i.path,s);break}case Bc.Tree:{let o=Ls(i.value,e);t.addWithStats(i.path,o);break}case Bc.Attachment:{let o=i.value.id;t.addAttachment(o);break}default:throw new Error("Unexpected TreeEntry type")}let r=t.getSummaryTree();return r.summary.unreferenced=n.unreferenced,r}function Ls(n,e=!1){if(n.id&&!e){let t=pr();return t.handleNodeCount++,{summary:{handle:n.id,handleType:xt.Tree,type:xt.Handle},stats:t}}else return AE(n,e)}function qs(n){let e=new Pt;for(let[r,i]of Object.entries(n.blobs)){let o;if(n.blobsContents!==void 0){let s=n.blobsContents[i];s!==void 0&&(o=pi(s,"utf-8"))}else n.blobs[i]!==void 0&&(o=og(n.blobs[i]));o!==void 0&&e.addBlob(r,o)}for(let[r,i]of Object.entries(n.trees)){let o=qs(i);e.addWithStats(r,o)}let t=e.getSummaryTree();return t.summary.unreferenced=n.unreferenced,t}function js(n){let e=[];for(let[t,r]of Object.entries(n.tree))switch(r.type){case xt.Blob:{let i,o="utf-8";typeof r.content=="string"?i=r.content:(i=Pn(r.content,"base64"),o="base64"),e.push(new ms(t,i,o));break}case xt.Tree:{e.push(new $d(t,js(r)));break}case xt.Attachment:{e.push(new Xd(t,r.id));break}case xt.Handle:throw new Error("Should not have Handle type in summary tree");default:vt(r,"Unexpected summary tree type")}return{entries:e,unreferenced:n.unreferenced}}var Pt,Lc,Ru=W(()=>{Y();Hr();Iu();Pt=class{constructor(){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=pr(),this.summaryStats.treeNodeCount++}get summary(){return{type:xt.Tree,tree:Object.assign({},this.summaryTree)}}get stats(){return Object.assign({},this.summaryStats)}addBlob(e,t){En({summary:{type:xt.Tree,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,r){this.summaryTree[e]={type:xt.Handle,handleType:t,handle:r},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=pr(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:xt.Attachment}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}};Lc=class{constructor(){this.telemetry=new Map}set(e,t,r){this.telemetry.set(`${e}${t}`,r)}get(e,t){return this.telemetry.get(`${e}${t}`)}serialize(){let e={};return this.telemetry.forEach((t,r)=>{e[r]=t}),JSON.stringify(e)}}});function Fv(n,e){let t=n,r=[],i=[];for(let o=0;;o++){o>kE&&e.sendTelemetryEvent({eventName:"DecodeSummaryMaxDepth",maxDecodeDepth:kE});let s=t.blobs[TE],a=t.trees[jc];if(s===void 0&&a===void 0){let c;return{baseSummary:t,pathParts:r,getOutstandingOps(l){return v(this,null,function*(){let h=[];for(let u of i){let d=yield l(u);if(h.length>0&&d.length>0){let p=h[h.length-1].sequenceNumber,m=d[0].sequenceNumber;if(m<=p)for(e.sendTelemetryEvent({eventName:"DuplicateOutstandingOps",message:`newEarliestSeq <= latestSeq in decodeSummary: ${m} <= ${p}`});d.length>0&&d[0].sequenceNumber<=p;)d.shift()}h=h.concat(d)}return h})}}}w(!!s,431),w(a!==void 0,432),t=a,r.push(jc),i.unshift(s)}}function DE(n,e){let t=An.create(jc),r=new Pt;if(r.addBlob(TE,JSON.stringify(e)),n.fromSummary){let o=n.summaryNode;o.additionalPath!==void 0&&(t=t.concat(o.additionalPath)),r.addHandle(jc,xt.Tree,o.fullPath.path)}else r.addWithStats(jc,n.initialSummary);let i=r.getSummaryTree();return Object.assign(Object.assign({},i),{additionalPath:t})}function Nu(n){let e=n.trees[Vc.channelsTreeName];return e!==void 0?{childrenTree:e,childrenPathPart:Vc.channelsTreeName}:{childrenTree:n,childrenPathPart:void 0}}function FE(n){let e=n.tree[Vc.channelsTreeName];return e!==void 0?{childrenTree:e,childrenPathPart:Vc.channelsTreeName}:{childrenTree:n,childrenPathPart:void 0}}var Vc,jc,TE,kE,An,Dr,zv=W(()=>{Y();Iu();Vc=Ce(qn());Ru();jc="_baseSummary",TE="_outstandingOps",kE=100,An=class n{constructor(e){this.path=e}static create(e){return new n(encodeURIComponent(e))}static createAndConcat(e){var t;let r=n.create((t=e[0])!==null&&t!==void 0?t:"");for(let i=1;i<e.length;i++)r=r.concat(n.create(e[i]));return r}toString(){return this.path}concat(e){return new n(`${this.path}/${e.path}`)}},Dr=class n{constructor(e){this.summary=e}static createForRoot(e){return new n({referenceSequenceNumber:e,basePath:void 0,localPath:An.create("")})}get referenceSequenceNumber(){return this.summary.referenceSequenceNumber}get basePath(){return this.summary.basePath}get localPath(){return this.summary.localPath}get additionalPath(){return this.summary.additionalPath}set additionalPath(e){this.summary.additionalPath=e}get fullPath(){var e,t;return(t=(e=this.basePath)===null||e===void 0?void 0:e.concat(this.localPath))!==null&&t!==void 0?t:this.localPath}get fullPathForChildren(){return this.additionalPath!==void 0?this.fullPath.concat(this.additionalPath):this.fullPath}createForChild(e){return new n({referenceSequenceNumber:this.referenceSequenceNumber,basePath:this.fullPathForChildren,localPath:An.create(e)})}}});var Hc,Uc,zE,Iv=W(()=>{Hc=Ce(qn());Iu();Y();Ru();zv();Uc=class n{constructor(e,t,r,i,o,s,a){var c;this.defaultLogger=e,this.summarizeInternalFn=t,this._changeSequenceNumber=i,this._latestSummary=o,this.initialSummary=s,this.wipSummaryLogger=a,this.children=new Map,this.pendingSummaries=new Map,this.outstandingOps=[],this.wipSkipRecursion=!1,this.canReuseHandle=(c=r.canReuseHandle)!==null&&c!==void 0?c:!0,this.throwOnError=!0,this.trackingSequenceNumber=this._changeSequenceNumber}get referenceSequenceNumber(){var e,t;return(t=(e=this._latestSummary)===null||e===void 0?void 0:e.referenceSequenceNumber)!==null&&t!==void 0?t:0}startSummary(e,t){w(this.wipSummaryLogger===void 0,415),w(this.wipReferenceSequenceNumber===void 0,416),this.wipSummaryLogger=t;for(let r of this.children.values())r.startSummary(e,this.wipSummaryLogger);this.wipReferenceSequenceNumber=e}summarize(e,t=!0,r){return v(this,null,function*(){if(w(this.isTrackingInProgress(),417),w(this.wipSummaryLogger!==void 0,418),this.canReuseHandle&&!e&&!this.hasChanged()){let i=this._latestSummary;if(i!==void 0){this.wipLocalPaths={localPath:i.localPath,additionalPath:i.additionalPath},this.wipSkipRecursion=!0;let o=pr();return o.handleNodeCount++,{summary:{type:xt.Handle,handle:i.fullPath.path,handleType:xt.Tree},stats:o}}}try{let i=yield this.summarizeInternalFn(e,!0,r);return this.wipLocalPaths={localPath:An.create(i.id)},i.pathPartsForChildren!==void 0&&(this.wipLocalPaths.additionalPath=An.createAndConcat(i.pathPartsForChildren)),{summary:i.summary,stats:i.stats}}catch(i){if(this.throwOnError||this.trackingSequenceNumber<this._changeSequenceNumber)throw i;let o=this._latestSummary,s=this.initialSummary,a,c;if(o!==void 0)a={fromSummary:!0,summaryNode:o},c=o.localPath;else if(s?.summary!==void 0)a={fromSummary:!1,initialSummary:s.summary},c=An.create(s.id);else throw i;this.wipSummaryLogger.sendErrorEvent({eventName:"SummarizingWithBasePlusOps"},i);let l=DE(a,this.outstandingOps);return this.wipLocalPaths={localPath:c,additionalPath:l.additionalPath},this.wipSkipRecursion=!0,{summary:l.summary,stats:l.stats}}})}completeSummary(e){this.completeSummaryCore(e,void 0,!1)}completeSummaryCore(e,t,r){w(this.wipSummaryLogger!==void 0,419),w(this.wipReferenceSequenceNumber!==void 0,420);let i=this.wipLocalPaths;if(r){let a=this._latestSummary;if(a!==void 0)i={localPath:a.localPath,additionalPath:a.additionalPath};else{this.clearSummary();return}}w(!!i,421);let o=new Dr(Object.assign(Object.assign({},i),{referenceSequenceNumber:this.wipReferenceSequenceNumber,basePath:t})),s=o.fullPathForChildren;for(let a of this.children.values())a.completeSummaryCore(e,s,this.wipSkipRecursion||r);this.pendingSummaries.set(e,o),this.clearSummary()}clearSummary(){this.wipReferenceSequenceNumber=void 0,this.wipLocalPaths=void 0,this.wipSkipRecursion=!1,this.wipSummaryLogger=void 0;for(let e of this.children.values())e.clearSummary()}refreshLatestSummary(e,t,r,i,o){return v(this,null,function*(){if(e!==void 0){let a=this.pendingSummaries.get(e);if(a!==void 0)return this.refreshLatestSummaryFromPending(e,a.referenceSequenceNumber),{latestSummaryUpdated:!0,wasSummaryTracked:!0}}if(this.referenceSequenceNumber>=t)return{latestSummaryUpdated:!1};let s=yield r();return yield this.refreshLatestSummaryFromSnapshot(t,s,void 0,An.create(""),o,i),{latestSummaryUpdated:!0,wasSummaryTracked:!1,snapshot:s}})}refreshLatestSummaryFromPending(e,t){let r=this.pendingSummaries.get(e);if(r===void 0){w(this._latestSummary===void 0,422);return}else w(t===r.referenceSequenceNumber,423),this.pendingSummaries.delete(e);this.refreshLatestSummaryCore(t),this._latestSummary=r;for(let i of this.children.values())i.refreshLatestSummaryFromPending(e,t)}refreshLatestSummaryFromSnapshot(e,t,r,i,o,s){return v(this,null,function*(){if(this.referenceSequenceNumber>=e)return;this.refreshLatestSummaryCore(e);let{baseSummary:a,pathParts:c}=Fv(t,o);this._latestSummary=new Dr({referenceSequenceNumber:e,basePath:r,localPath:i});let{childrenTree:l,childrenPathPart:h}=Nu(a);h!==void 0&&c.push(h),c.length>0&&(this._latestSummary.additionalPath=An.createAndConcat(c));let u=this._latestSummary.fullPathForChildren;yield Promise.all(Array.from(this.children).filter(([d])=>l.trees[d]!==void 0).map(m=>v(this,[m],function*([d,p]){return p.refreshLatestSummaryFromSnapshot(e,l.trees[d],u,An.create(d),o,s)})))})}refreshLatestSummaryCore(e){for(let[t,r]of this.pendingSummaries)r.referenceSequenceNumber<e&&this.pendingSummaries.delete(t);for(;this.outstandingOps.length>0&&this.outstandingOps[0].sequenceNumber<=e;)this.outstandingOps.shift()}loadBaseSummaryWithoutDifferential(e){let{childrenPathPart:t}=Nu(e);t!==void 0&&this._latestSummary!==void 0&&(this._latestSummary.additionalPath=An.create(t))}loadBaseSummary(e,t){return v(this,null,function*(){let r=Fv(e,this.defaultLogger),i=yield r.getOutstandingOps(t),{childrenPathPart:o}=Nu(r.baseSummary);if(o!==void 0&&r.pathParts.push(o),r.pathParts.length>0&&this._latestSummary!==void 0&&(this._latestSummary.additionalPath=An.createAndConcat(r.pathParts)),i.length>0){let s=i[i.length-1].sequenceNumber;w(s<=this.trackingSequenceNumber,425)}return{baseSummary:r.baseSummary,outstandingOps:i}})}recordChange(e){let t=this.outstandingOps[this.outstandingOps.length-1];t!==void 0&&w(t.sequenceNumber<e.sequenceNumber,426),this.invalidate(e.sequenceNumber),this.trackingSequenceNumber=e.sequenceNumber,this.outstandingOps.push(e)}invalidate(e){e>this._changeSequenceNumber&&(this._changeSequenceNumber=e)}hasChanged(){return this._changeSequenceNumber>this.referenceSequenceNumber}get latestSummary(){return this._latestSummary}createChild(e,t,r,i={}){w(!this.children.has(t),427);let o=this.getCreateDetailsForChild(t,r),s=new n(this.defaultLogger,e,i,o.changeSequenceNumber,o.latestSummary,o.initialSummary,this.wipSummaryLogger);return this.maybeUpdateChildState(s),this.children.set(t,s),s}getChild(e){return this.children.get(e)}getCreateDetailsForChild(e,t){var r;let i,o,s,a=this._latestSummary;switch(t.type){case Hc.CreateSummarizerNodeSource.FromAttach:{if(a!==void 0&&t.sequenceNumber<=a.referenceSequenceNumber)o=a.createForChild(e);else{let c=Ls(t.snapshot);i={sequenceNumber:t.sequenceNumber,id:e,summary:c}}s=t.sequenceNumber;break}case Hc.CreateSummarizerNodeSource.FromSummary:this.initialSummary===void 0&&w(!!a,428);case Hc.CreateSummarizerNodeSource.Local:{let c=this.initialSummary;if(c!==void 0){let l;if(c.summary!==void 0){let{childrenTree:u}=FE(c.summary.summary);w(u.type===xt.Tree,470),l=u.tree[e]}t.type===Hc.CreateSummarizerNodeSource.FromSummary&&w(!!l,429);let h;l!==void 0&&(w(l.type===xt.Tree,430),h={summary:l,stats:qc(l)}),i={sequenceNumber:c.sequenceNumber,id:e,summary:h}}o=a?.createForChild(e),s=(r=a?.referenceSequenceNumber)!==null&&r!==void 0?r:-1;break}default:{let c=t.type;vt(t,`Unexpected CreateSummarizerNodeSource: ${c}`)}}return{initialSummary:i,latestSummary:o,changeSequenceNumber:s}}maybeUpdateChildState(e){if(this.isTrackingInProgress()&&(e.wipReferenceSequenceNumber=this.wipReferenceSequenceNumber),e._latestSummary!==void 0)for(let[t,r]of this.pendingSummaries.entries()){let i=new Dr({referenceSequenceNumber:r.referenceSequenceNumber,basePath:e._latestSummary.basePath,localPath:e._latestSummary.localPath});e.addPendingSummary(t,i)}}addPendingSummary(e,t){this.pendingSummaries.set(e,t)}isTrackingInProgress(){return this.wipReferenceSequenceNumber!==void 0}},zE=(n,e,t,r,i={})=>new Uc(n,e,i,t,r===void 0?void 0:Dr.createForRoot(r))});function Bu(n,e){let t=new Set,r=[...e];for(let s of r){if(t.has(s))continue;t.add(s);let a=n[s];a!==void 0&&r.push(...a)}let i=[],o=[];for(let s of Object.keys(n))t.has(s)?i.push(s):o.push(s);return{referencedNodeIds:i,deletedNodeIds:o}}var IE=W(()=>{});function RE(n){return n.replace(/^\/+|\/+$/g,"")}function Oj(n){return n.replace(/^\/+/g,"")}function Mj(n){return n.replace(/\/+$/g,"")}function wo(n){let e={};for(let[t,r]of Object.entries(n.gcNodes))e[t]=Array.from(r);return{gcNodes:e}}function Lu(n){let e=new Map;if(n.gcData===void 0)return e;let t=n.gcData.gcNodes;delete t["/"];for(let[i,o]of Object.entries(t)){w(i.startsWith("/"),686);let s=i.split("/")[1],a=i.slice(s.length+1);a===""&&(a="/");let c=e.get(s);c===void 0&&(c={gcData:{gcNodes:{}},usedRoutes:[]}),w(c.gcData!==void 0,687),c.gcData.gcNodes[a]=[...new Set(o)],e.set(s,c)}if(n.usedRoutes===void 0)return e;let r=n.usedRoutes.filter(i=>i!==""&&i!=="/");for(let i of r){w(i.startsWith("/"),688);let o=i.split("/")[1],s=i.slice(o.length+1),a=e.get(o);w(a?.usedRoutes!==void 0,689),a.usedRoutes.push(s),e.set(o,a)}return e}function qu(n){let e=n.filter(r=>r!==""&&r!=="/"),t=new Map;for(let r of e){w(r.startsWith("/"),408);let i=r.split("/")[1],o=r.slice(i.length+1),s=t.get(i);s!==void 0?s.push(o):t.set(i,[o])}return t}function NE(n,e){let t=Object.entries(n);for(let[r,i]of t){let o=new Set(i);o.delete(e),n[r]=[...o]}}function BE(n,e){var t;let r={};for(let[i,o]of Object.entries(n.gcNodes))r[i]={outboundRoutes:Array.from(o.outboundRoutes),unreferencedTimestampMs:o.unreferencedTimestampMs};for(let[i,o]of Object.entries(e.gcNodes)){let s=r[i];s===void 0?s={outboundRoutes:Array.from(o.outboundRoutes),unreferencedTimestampMs:o.unreferencedTimestampMs}:(o.unreferencedTimestampMs!==void 0&&s.unreferencedTimestampMs!==void 0&&w(o.unreferencedTimestampMs===s.unreferencedTimestampMs,690),s={outboundRoutes:[...new Set([...o.outboundRoutes,...s.outboundRoutes])],unreferencedTimestampMs:(t=o.unreferencedTimestampMs)!==null&&t!==void 0?t:s.unreferencedTimestampMs}),r[i]=s}return{gcNodes:r}}function LE(n,e){let t=wo(n);for(let[r,i]of Object.entries(e.gcNodes))if(t.gcNodes[r]===void 0)t.gcNodes[r]=Array.from(i);else{let o=[...i,...t.gcNodes[r]];t.gcNodes[r]=[...new Set(o)]}return t}var Li,qE=W(()=>{Y();Li=class{constructor(){this.gcNodesSet={}}get gcNodes(){let e={};for(let[t,r]of Object.entries(this.gcNodesSet))e[t]=[...r];return e}addNode(e,t){this.gcNodesSet[e]=new Set(t)}prefixAndAddNodes(e,t){for(let[r,i]of Object.entries(t)){let o=Oj(r);o=`/${e}/${o}`,o=Mj(o),this.gcNodesSet[o]=new Set(i)}}addNodes(e){for(let[t,r]of Object.entries(e))this.gcNodesSet[t]=new Set(r)}addRouteToAllNodes(e){for(let t of Object.values(this.gcNodesSet))t.add(e)}getGCData(){return{gcNodes:this.gcNodes}}}});var jE=W(()=>{});var Vs=W(()=>{IE();qE();jE();});var VE,Rv,Nv,ju,HE=W(()=>{Y();Vs();VE=Ce(qn());Iv();zv();Rv=class extends Dr{constructor(e,t){super(t),this.serializedUsedRoutes=e}},Nv=class n extends Uc{constructor(e,t,r,i,o,s,a,c,l){super(e,(h,u,d)=>v(this,null,function*(){return t(h,!0,d)}),r,i,o,s,a),this.summarizeFn=t,this.getGCDataFn=c,this.baseGCDetailsLoaded=!1,this.usedRoutes=[""],this.gcDisabled=r.gcDisabled===!0,this.baseGCDetailsP=new Lt(()=>v(this,null,function*(){var h;return(h=yield l?.())!==null&&h!==void 0?h:{usedRoutes:[]}}))}getGCSummaryDetails(){return this.getBaseGCDetails()}getBaseGCDetails(){return{gcData:this.gcData,usedRoutes:this.usedRoutes,unrefTimestamp:this.unreferencedTimestampMs}}loadBaseGCDetails(){return v(this,null,function*(){var e;let t=yield this.baseGCDetailsP;this.baseGCDetailsLoaded||(this.baseGCDetailsLoaded=!0,t.gcData!==void 0&&(this.gcData=wo(t.gcData)),this.referenceUsedRoutes=(e=t.usedRoutes)===null||e===void 0?void 0:e.sort(),this.unreferencedTimestampMs=t.unrefTimestamp)})}summarize(e,t=!0,r){return v(this,null,function*(){return!this.gcDisabled&&this.isTrackingInProgress()&&w(this.wipSerializedUsedRoutes!==void 0,433),t?tr(n.prototype,this,"summarize").call(this,e,!0,r):this.summarizeFn(e,t,r)})}getGCData(e=!1){return v(this,null,function*(){if(w(!this.gcDisabled,434),w(this.getGCDataFn!==void 0,435),yield this.loadBaseGCDetails(),!e&&!this.hasDataChanged()&&this.gcData!==void 0)return wo(this.gcData);let t=yield this.getGCDataFn(e);return this.gcData=wo(t),t})}startSummary(e,t){this.gcDisabled||w(this.wipSerializedUsedRoutes===void 0,436),super.startSummary(e,t)}completeSummaryCore(e,t,r){let i;if(this.gcDisabled||(i=this.wipSerializedUsedRoutes,w(i!==void 0,437)),super.completeSummaryCore(e,t,r),!this.gcDisabled){let o=this.pendingSummaries.get(e);if(o!==void 0){let s=new Rv(i,o);this.pendingSummaries.set(e,s)}}}clearSummary(){this.wipSerializedUsedRoutes=void 0,super.clearSummary()}refreshLatestSummaryFromPending(e,t){if(!this.gcDisabled){let r=this.pendingSummaries.get(e);r!==void 0&&(this.referenceUsedRoutes=JSON.parse(r.serializedUsedRoutes))}return super.refreshLatestSummaryFromPending(e,t)}refreshLatestSummaryFromSnapshot(e,t,r,i,o,s){return v(this,null,function*(){if(!this.gcDisabled){let a=t.blobs[VE.gcBlobKey];if(a!==void 0){let c=yield s(a);if(this.referenceSequenceNumber>=e)return;this.referenceUsedRoutes=c.usedRoutes}}return tr(n.prototype,this,"refreshLatestSummaryFromSnapshot").call(this,e,t,r,i,o,s)})}createChild(e,t,r,i={},o,s){var a;w(!this.children.has(t),438);let c=this.getCreateDetailsForChild(t,r),l=new n(this.defaultLogger,e,Object.assign(Object.assign({},i),{gcDisabled:(a=i.gcDisabled)!==null&&a!==void 0?a:this.gcDisabled}),c.changeSequenceNumber,c.latestSummary,c.initialSummary,this.wipSummaryLogger,o,s);return this.maybeUpdateChildState(l),this.children.set(t,l),l}deleteChild(e){this.children.delete(e)}getChild(e){return this.children.get(e)}isReferenced(){return this.usedRoutes.includes("")||this.usedRoutes.includes("/")}updateUsedRoutes(e,t){if(this.usedRoutes=e.sort(),!this.gcDisabled&&this.isTrackingInProgress()&&(this.wipSerializedUsedRoutes=JSON.stringify(this.usedRoutes)),this.isReferenced()){this.unreferencedTimestampMs=void 0;return}this.unreferencedTimestampMs===void 0&&(this.unreferencedTimestampMs=t)}hasChanged(){return this.hasDataChanged()||this.hasUsedStateChanged()}hasDataChanged(){return super.hasChanged()}hasUsedStateChanged(){return this.gcDisabled?!1:this.referenceUsedRoutes===void 0||JSON.stringify(this.usedRoutes)!==JSON.stringify(this.referenceUsedRoutes)}},ju=(n,e,t,r,i={},o,s)=>new Nv(n,e,i,t,r===void 0?void 0:Dr.createForRoot(r),void 0,void 0,o,s)});var UE=W(()=>{Iv();HE();});function Bv(n,e){return v(this,null,function*(){let t=n.trees[".protocol"].blobs.attributes;return(yield e(t)).sequenceNumber})}var GE=W(()=>{});var Lv={};Yi(Lv,{ObjectStoragePartition:()=>Av,RequestParser:()=>Sn,RuntimeFactoryHelper:()=>Nc,SummaryTreeBuilder:()=>Pt,TelemetryContext:()=>Lc,addBlobToSummary:()=>En,addSummarizeResultToSummary:()=>Dv,addTreeToSummary:()=>Tv,calculateStats:()=>qc,convertSnapshotTreeToSummaryTree:()=>qs,convertSummaryTreeToITree:()=>js,convertToSummaryTree:()=>Ls,convertToSummaryTreeWithStats:()=>AE,create404Response:()=>zt,createDataStoreFactory:()=>_j,createResponseError:()=>ku,createRootSummarizerNode:()=>zE,createRootSummarizerNodeWithGC:()=>ju,exceptionToResponse:()=>Ni,generateHandleContextPath:()=>ur,getBlobSize:()=>kv,getNormalizedObjectStoragePathParts:()=>Tu,listBlobsAtTreePath:()=>yj,mergeStats:()=>pr,requestFluidObject:()=>Tr,responseToException:()=>Bi,seqFromTree:()=>Bv,utf8ByteLength:()=>SE});var bt=W(()=>{iE();oE();sE();aE();cE();lE();UE();Ru();GE();});var WE=W(()=>{});var Hs,Vu,Sj,qv=W(()=>{Hs=n=>typeof n=="object"&&typeof n?.name=="string"&&typeof n?.fluid=="object",Vu=n=>{let e=n;return typeof e=="object"&&(typeof e?.package=="string"||Hs(e?.package))&&(e?.config===void 0||typeof e?.config=="object")},Sj="IFluidCodeDetailsComparer"});var Ej,KE=W(()=>{qv();Ej=n=>{var e,t,r,i,o,s;return Hs(n)&&typeof((r=(t=(e=n?.fluid)===null||e===void 0?void 0:e.browser)===null||t===void 0?void 0:t.umd)===null||r===void 0?void 0:r.library)=="string"&&Array.isArray((s=(o=(i=n?.fluid)===null||i===void 0?void 0:i.browser)===null||o===void 0?void 0:o.umd)===null||s===void 0?void 0:s.files)}});var $E=W(()=>{});var qi,XE=W(()=>{qi=function(n){return n.genericError="genericError",n.throttlingError="throttlingError",n.dataCorruptionError="dataCorruptionError",n.dataProcessingError="dataProcessingError",n.usageError="usageError",n.clientSessionExpiredError="clientSessionExpiredError",n}(qi||{})});var lt,JE=W(()=>{lt=function(n){return n.cache="fluid-cache",n.clientDetails="fluid-client-details",n.loadMode="loadMode",n.reconnect="fluid-reconnect",n.sequenceNumber="fluid-sequence-number",n.version="version",n}(lt||{})});var QE=W(()=>{});var oe,bn,Aj,YE=W(()=>{oe=function(n){return n.Detached="Detached",n.Attaching="Attaching",n.Attached="Attached",n}(oe||{}),bn=function(n){return n.NotBound="NotBound",n.Binding="Binding",n.Bound="Bound",n}(bn||{}),Aj="IRuntimeFactory"});var kj,ZE=W(()=>{kj="IFluidTokenProvider"});var jv={};Yi(jv,{AttachState:()=>oe,BindState:()=>bn,ContainerErrorType:()=>qi,IFluidCodeDetailsComparer:()=>Sj,IFluidTokenProvider:()=>kj,IRuntimeFactory:()=>Aj,LoaderHeader:()=>lt,isFluidBrowserPackage:()=>Ej,isFluidCodeDetails:()=>Vu,isFluidPackage:()=>Hs});var Vt=W(()=>{WE();KE();$E();XE();JE();QE();qv();YE();ZE();});var Kv=z((Ile,uA)=>{"use strict";function je(n){if(this._capacity=dA(n),this._length=0,this._front=0,lA(n)){for(var e=n.length,t=0;t<e;++t)this[t]=n[t];this._length=e}}je.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,i=this._capacity,o=0;o<e;++o)t[o]=this[r+o&i-1];return t};je.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var i=this._capacity;if(r+t>i){for(var s=0;s<t;++s){this._checkCapacity(r+1);var o=this._front+r&this._capacity-1;this[o]=arguments[s],r++,this._length=r}return r}else{for(var o=this._front,s=0;s<t;++s)this[o+r&i-1]=arguments[s],o++;return this._length=r+t,r+t}}if(t===0)return r;this._checkCapacity(r+1);var s=this._front+r&this._capacity-1;return this[s]=e,this._length=r+1,r+1};je.prototype.pop=function(){var e=this._length;if(e!==0){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}};je.prototype.shift=function(){var e=this._length;if(e!==0){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}};je.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){var s=this._capacity;if(t+r>s){for(var a=r-1;a>=0;a--){this._checkCapacity(t+1);var s=this._capacity,i=(this._front-1&s-1^s)-s;this[i]=arguments[a],t++,this._length=t,this._front=i}return t}else{for(var o=this._front,a=r-1;a>=0;a--){var i=(o-1&s-1^s)-s;this[i]=arguments[a],o=i}return this._front=o,this._length=t+r,t+r}}if(r===0)return t;this._checkCapacity(t+1);var s=this._capacity,a=(this._front-1&s-1^s)-s;return this[a]=e,this._length=t+1,this._front=a,t+1};je.prototype.peekBack=function(){var e=this._length;if(e!==0){var t=this._front+e-1&this._capacity-1;return this[t]}};je.prototype.peekFront=function(){if(this._length!==0)return this[this._front]};je.prototype.get=function(e){var t=e;if(t===(t|0)){var r=this._length;if(t<0&&(t=t+r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}};je.prototype.isEmpty=function(){return this._length===0};je.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,i=0;i<e;++i)this[t+i&r-1]=void 0;this._length=0,this._front=0};je.prototype.toString=function(){return this.toArray().toString()};je.prototype.valueOf=je.prototype.toString;je.prototype.removeFront=je.prototype.shift;je.prototype.removeBack=je.prototype.pop;je.prototype.insertFront=je.prototype.unshift;je.prototype.insertBack=je.prototype.push;je.prototype.enqueue=je.prototype.push;je.prototype.dequeue=je.prototype.shift;je.prototype.toJSON=je.prototype.toArray;Object.defineProperty(je.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}});je.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(dA(this._capacity*1.5+16))};je.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,i=this._length;if(r+i>t){var o=r+i&t-1;Nj(this,0,this,t,o)}};var lA=Array.isArray;function Nj(n,e,t,r,i){for(var o=0;o<i;++o)t[o+r]=n[o+e],n[o+e]=void 0}function Bj(n){return n=n>>>0,n=n-1,n=n|n>>1,n=n|n>>2,n=n|n>>4,n=n|n>>8,n=n|n>>16,n+1}function dA(n){if(typeof n!="number")if(lA(n))n=n.length;else return 16;return Bj(Math.min(Math.max(16,n),1073741824))}uA.exports=je});var FA=z((Bhe,DA)=>{"use strict";function Rr(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}function TA(n,e){for(var t="",r=0,i=-1,o=0,s,a=0;a<=n.length;++a){if(a<n.length)s=n.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var c=t.lastIndexOf("/");if(c!==t.length-1){c===-1?(t="",r=0):(t=t.slice(0,c),r=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a),r=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function cV(n,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+n+r:r}var Zs={resolve:function(){for(var e="",t=!1,r,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(r===void 0&&(r=process.cwd()),o=r),Rr(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=TA(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Rr(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=TA(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Rr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];Rr(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":Zs.normalize(e)},relative:function(e,t){if(Rr(e),Rr(t),e===t||(e=Zs.resolve(e),t=Zs.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var i=e.length,o=i-r,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,c=a-s,l=o<c?o:c,h=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(t.charCodeAt(s+u)===47)return t.slice(s+u+1);if(u===0)return t.slice(s+u)}else o>l&&(e.charCodeAt(r+u)===47?h=u:u===0&&(h=0));break}var d=e.charCodeAt(r+u),p=t.charCodeAt(s+u);if(d!==p)break;d===47&&(h=u)}var m="";for(u=r+h+1;u<=i;++u)(u===i||e.charCodeAt(u)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(s+h):(s+=h,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Rr(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?r?"/":".":r&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Rr(e);var r=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,c=-1;for(s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(l===47){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=c))}return r===i?i=c:i===-1&&(i=e.length),e.slice(r,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){r=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(r,i)}},extname:function(e){Rr(e);for(var t=-1,r=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(c===47){if(!o){r=a+1;break}continue}i===-1&&(o=!1,i=a+1),c===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return cV("/",e)},parse:function(e){Rr(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),i=r===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,c=-1,l=!0,h=e.length-1,u=0;h>=o;--h){if(r=e.charCodeAt(h),r===47){if(!l){a=h+1;break}continue}c===-1&&(l=!1,c=h+1),r===46?s===-1?s=h:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||c===-1||u===0||u===1&&s===c-1&&s===a+1?c!==-1&&(a===0&&i?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(a,c)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,c)):(t.name=e.slice(a,s),t.base=e.slice(a,c)),t.ext=e.slice(s,c)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Zs.posix=Zs;DA.exports=Zs});var WA=z(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.IContainerRuntime=void 0;Rh.IContainerRuntime="IContainerRuntime"});var KA=z(So=>{"use strict";var dV=So&&So.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),uV=So&&So.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&dV(e,n,t)};Object.defineProperty(So,"__esModule",{value:!0});uV(WA(),So)});var b0=z((tfe,YA)=>{var hV=_d(),pV=Wa();function fV(n,e,t){(t!==void 0&&!pV(n[e],t)||t===void 0&&!(e in n))&&hV(n,e,t)}YA.exports=fV});var e4=z((nfe,ZA)=>{function gV(n){return function(e,t,r){for(var i=-1,o=Object(e),s=r(e),a=s.length;a--;){var c=s[n?a:++i];if(t(o[c],c,o)===!1)break}return e}}ZA.exports=gV});var n4=z((rfe,t4)=>{var mV=e4(),vV=mV();t4.exports=vV});var i4=z((ife,r4)=>{var bV=nc(),xV=vi();function _V(n){return xV(n)&&bV(n)}r4.exports=_V});var a4=z((ofe,s4)=>{var yV=Zo(),CV=Sd(),wV=vi(),PV="[object Object]",OV=Function.prototype,MV=Object.prototype,o4=OV.toString,SV=MV.hasOwnProperty,EV=o4.call(Object);function AV(n){if(!wV(n)||yV(n)!=PV)return!1;var e=CV(n);if(e===null)return!0;var t=SV.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&o4.call(t)==EV}s4.exports=AV});var x0=z((sfe,c4)=>{function kV(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}c4.exports=kV});var d4=z((afe,l4)=>{var TV=rs(),DV=ss();function FV(n){return TV(n,DV(n))}l4.exports=FV});var m4=z((cfe,g4)=>{var u4=b0(),zV=Sg(),IV=Bg(),RV=Eg(),NV=Lg(),h4=_g(),p4=Ya(),BV=i4(),LV=yd(),qV=bd(),jV=jr(),VV=a4(),HV=Pg(),f4=x0(),UV=d4();function GV(n,e,t,r,i,o,s){var a=f4(n,t),c=f4(e,t),l=s.get(c);if(l){u4(n,t,l);return}var h=o?o(a,c,t+"",n,e,s):void 0,u=h===void 0;if(u){var d=p4(c),p=!d&&LV(c),m=!d&&!p&&HV(c);h=c,d||p||m?p4(a)?h=a:BV(a)?h=RV(a):p?(u=!1,h=zV(c,!0)):m?(u=!1,h=IV(c,!0)):h=[]:VV(c)||h4(c)?(h=a,h4(a)?h=UV(a):(!jV(a)||qV(a))&&(h=NV(c))):u=!1}u&&(s.set(c,h),i(h,c,r,o,s),s.delete(c)),u4(n,t,h)}g4.exports=GV});var x4=z((lfe,b4)=>{var WV=vg(),KV=b0(),$V=n4(),XV=m4(),JV=jr(),QV=ss(),YV=x0();function v4(n,e,t,r,i){n!==e&&$V(e,function(o,s){if(i||(i=new WV),JV(o))XV(n,e,s,t,v4,r,i);else{var a=r?r(YV(n,s),o,s+"",n,e,i):void 0;a===void 0&&(a=o),KV(n,s,a)}},QV)}b4.exports=v4});var _0=z((dfe,_4)=>{function ZV(n){return n}_4.exports=ZV});var C4=z((ufe,y4)=>{function eH(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}y4.exports=eH});var O4=z((hfe,P4)=>{var tH=C4(),w4=Math.max;function nH(n,e,t){return e=w4(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,o=w4(r.length-e,0),s=Array(o);++i<o;)s[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=t(s),tH(n,this,a)}}P4.exports=nH});var S4=z((pfe,M4)=>{function rH(n){return function(){return n}}M4.exports=rH});var k4=z((ffe,A4)=>{var iH=S4(),E4=bg(),oH=_0(),sH=E4?function(n,e){return E4(n,"toString",{configurable:!0,enumerable:!1,value:iH(e),writable:!0})}:oH;A4.exports=sH});var D4=z((gfe,T4)=>{var aH=800,cH=16,lH=Date.now;function dH(n){var e=0,t=0;return function(){var r=lH(),i=cH-(r-t);if(t=r,i>0){if(++e>=aH)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}T4.exports=dH});var z4=z((mfe,F4)=>{var uH=k4(),hH=D4(),pH=hH(uH);F4.exports=pH});var R4=z((vfe,I4)=>{var fH=_0(),gH=O4(),mH=z4();function vH(n,e){return mH(gH(n,e,fH),n+"")}I4.exports=vH});var B4=z((bfe,N4)=>{var bH=Wa(),xH=nc(),_H=yg(),yH=jr();function CH(n,e,t){if(!yH(t))return!1;var r=typeof e;return(r=="number"?xH(t)&&_H(e,t.length):r=="string"&&e in t)?bH(t[e],n):!1}N4.exports=CH});var q4=z((xfe,L4)=>{var wH=R4(),PH=B4();function OH(n){return wH(function(e,t){var r=-1,i=t.length,o=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(o=n.length>3&&typeof o=="function"?(i--,o):void 0,s&&PH(t[0],t[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=t[r];a&&n(e,a,r,o)}return e})}L4.exports=OH});var V4=z((_fe,j4)=>{var MH=x4(),SH=q4(),EH=SH(function(n,e,t){MH(n,e,t)});j4.exports=EH});var y0=z((Ffe,Uh)=>{"use strict";var{AbortController:G4,AbortSignal:kH}=typeof self<"u"?self:typeof window<"u"?window:void 0;Uh.exports=G4;Uh.exports.AbortSignal=kH;Uh.exports.default=G4});var Mk=z(J=>{var sl={};sl.userAgent=!1;var na={},HH="11.1.0",UH="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var Q=Q||function(n,e){var t={},r=t.lib={},i=r.Base=function(){function p(){}return{extend:function(m){p.prototype=this;var g=new p;return m&&g.mixIn(m),g.hasOwnProperty("init")||(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var g in m)m.hasOwnProperty(g)&&(this[g]=m[g]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=i.extend({init:function(p,m){p=this.words=p||[],m!=e?this.sigBytes=m:this.sigBytes=p.length*4},toString:function(p){return(p||a).stringify(this)},concat:function(p){var m=this.words,g=p.words,x=this.sigBytes,b=p.sigBytes;if(this.clamp(),x%4)for(var _=0;_<b;_++){var O=g[_>>>2]>>>24-_%4*8&255;m[x+_>>>2]|=O<<24-(x+_)%4*8}else for(var _=0;_<b;_+=4)m[x+_>>>2]=g[_>>>2];return this.sigBytes+=b,this},clamp:function(){var p=this.words,m=this.sigBytes;p[m>>>2]&=4294967295<<32-m%4*8,p.length=n.ceil(m/4)},clone:function(){var p=i.clone.call(this);return p.words=this.words.slice(0),p},random:function(p){for(var m=[],g=0;g<p;g+=4)m.push(n.random()*4294967296|0);return new o.init(m,p)}}),s=t.enc={},a=s.Hex={stringify:function(p){for(var m=p.words,g=p.sigBytes,x=[],b=0;b<g;b++){var _=m[b>>>2]>>>24-b%4*8&255;x.push((_>>>4).toString(16)),x.push((_&15).toString(16))}return x.join("")},parse:function(p){for(var m=p.length,g=[],x=0;x<m;x+=2)g[x>>>3]|=parseInt(p.substr(x,2),16)<<24-x%8*4;return new o.init(g,m/2)}},c=s.Latin1={stringify:function(p){for(var m=p.words,g=p.sigBytes,x=[],b=0;b<g;b++){var _=m[b>>>2]>>>24-b%4*8&255;x.push(String.fromCharCode(_))}return x.join("")},parse:function(p){for(var m=p.length,g=[],x=0;x<m;x++)g[x>>>2]|=(p.charCodeAt(x)&255)<<24-x%4*8;return new o.init(g,m)}},l=s.Utf8={stringify:function(p){try{return decodeURIComponent(escape(c.stringify(p)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(p){return c.parse(unescape(encodeURIComponent(p)))}},h=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(p){typeof p=="string"&&(p=l.parse(p)),this._data.concat(p),this._nDataBytes+=p.sigBytes},_process:function(p){var m=this._data,g=m.words,x=m.sigBytes,b=this.blockSize,_=b*4,O=x/_;p?O=n.ceil(O):O=n.max((O|0)-this._minBufferSize,0);var S=O*b,E=n.min(S*4,x);if(S){for(var D=0;D<S;D+=b)this._doProcessBlock(g,D);var I=g.splice(0,S);m.sigBytes-=E}return new o.init(I,E)},clone:function(){var p=i.clone.call(this);return p._data=this._data.clone(),p},_minBufferSize:0}),u=r.Hasher=h.extend({cfg:i.extend(),init:function(p){this.cfg=this.cfg.extend(p),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(p){return this._append(p),this._process(),this},finalize:function(p){p&&this._append(p);var m=this._doFinalize();return m},blockSize:512/32,_createHelper:function(p){return function(m,g){return new p.init(g).finalize(m)}},_createHmacHelper:function(p){return function(m,g){return new d.HMAC.init(p,g).finalize(m)}}}),d=t.algo={};return t}(Math);(function(n){var i=Q,e=i.lib,t=e.Base,r=e.WordArray,i=i.x64={};i.Word=t.extend({init:function(o,s){this.high=o,this.low=s}}),i.WordArray=t.extend({init:function(o,s){o=this.words=o||[],this.sigBytes=s!=n?s:8*o.length},toX32:function(){for(var o=this.words,s=o.length,a=[],c=0;c<s;c++){var l=o[c];a.push(l.high),a.push(l.low)}return r.create(a,this.sigBytes)},clone:function(){for(var o=t.clone.call(this),s=o.words=this.words.slice(0),a=s.length,c=0;c<a;c++)s[c]=s[c].clone();return o}})})();Q.lib.Cipher||function(n){var p=Q,e=p.lib,t=e.Base,r=e.WordArray,i=e.BufferedBlockAlgorithm,o=p.enc.Base64,s=p.algo.EvpKDF,a=e.Cipher=i.extend({cfg:t.extend(),createEncryptor:function(g,x){return this.create(this._ENC_XFORM_MODE,g,x)},createDecryptor:function(g,x){return this.create(this._DEC_XFORM_MODE,g,x)},init:function(g,x,b){this.cfg=this.cfg.extend(b),this._xformMode=g,this._key=x,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(g){return this._append(g),this._process()},finalize:function(g){return g&&this._append(g),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(g){return{encrypt:function(x,b,_){return(typeof b=="string"?m:d).encrypt(g,x,b,_)},decrypt:function(x,b,_){return(typeof b=="string"?m:d).decrypt(g,x,b,_)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=p.mode={},c=function(g,x,b){var _=this._iv;_?this._iv=n:_=this._prevBlock;for(var O=0;O<b;O++)g[x+O]^=_[O]},l=(e.BlockCipherMode=t.extend({createEncryptor:function(g,x){return this.Encryptor.create(g,x)},createDecryptor:function(g,x){return this.Decryptor.create(g,x)},init:function(g,x){this._cipher=g,this._iv=x}})).extend();l.Encryptor=l.extend({processBlock:function(g,x){var b=this._cipher,_=b.blockSize;c.call(this,g,x,_),b.encryptBlock(g,x),this._prevBlock=g.slice(x,x+_)}}),l.Decryptor=l.extend({processBlock:function(g,x){var b=this._cipher,_=b.blockSize,O=g.slice(x,x+_);b.decryptBlock(g,x),c.call(this,g,x,_),this._prevBlock=O}}),u=u.CBC=l,l=(p.pad={}).Pkcs7={pad:function(g,x){for(var b=4*x,b=b-g.sigBytes%b,_=b<<24|b<<16|b<<8|b,O=[],S=0;S<b;S+=4)O.push(_);b=r.create(O,b),g.concat(b)},unpad:function(g){g.sigBytes-=g.words[g.sigBytes-1>>>2]&255}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var x=this.cfg,g=x.iv,x=x.mode;if(this._xformMode==this._ENC_XFORM_MODE)var b=x.createEncryptor;else b=x.createDecryptor,this._minBufferSize=1;this._mode=b.call(x,this,g&&g.words)},_doProcessBlock:function(g,x){this._mode.processBlock(g,x)},_doFinalize:function(){var g=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){g.pad(this._data,this.blockSize);var x=this._process(!0)}else x=this._process(!0),g.unpad(x);return x},blockSize:4});var h=e.CipherParams=t.extend({init:function(g){this.mixIn(g)},toString:function(g){return(g||this.formatter).stringify(this)}}),u=(p.format={}).OpenSSL={stringify:function(g){var x=g.ciphertext;return g=g.salt,(g?r.create([1398893684,1701076831]).concat(g).concat(x):x).toString(o)},parse:function(g){g=o.parse(g);var x=g.words;if(x[0]==1398893684&&x[1]==1701076831){var b=r.create(x.slice(2,4));x.splice(0,4),g.sigBytes-=16}return h.create({ciphertext:g,salt:b})}},d=e.SerializableCipher=t.extend({cfg:t.extend({format:u}),encrypt:function(g,x,b,_){_=this.cfg.extend(_);var O=g.createEncryptor(b,_);return x=O.finalize(x),O=O.cfg,h.create({ciphertext:x,key:b,iv:O.iv,algorithm:g,mode:O.mode,padding:O.padding,blockSize:g.blockSize,formatter:_.format})},decrypt:function(g,x,b,_){return _=this.cfg.extend(_),x=this._parse(x,_.format),g.createDecryptor(b,_).finalize(x.ciphertext)},_parse:function(g,x){return typeof g=="string"?x.parse(g,this):g}}),p=(p.kdf={}).OpenSSL={execute:function(g,x,b,_){return _||(_=r.random(8)),g=s.create({keySize:x+b}).compute(g,_),b=r.create(g.words.slice(x),4*b),g.sigBytes=4*x,h.create({key:g,iv:b,salt:_})}},m=e.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:p}),encrypt:function(g,x,b,_){return _=this.cfg.extend(_),b=_.kdf.execute(b,g.keySize,g.ivSize),_.iv=b.iv,g=d.encrypt.call(this,g,x,b.key,_),g.mixIn(b),g},decrypt:function(g,x,b,_){return _=this.cfg.extend(_),x=this._parse(x,_.format),b=_.kdf.execute(b,g.keySize,g.ivSize,x.salt),_.iv=b.iv,d.decrypt.call(this,g,x,b.key,_)}})}();(function(){for(var n=Q,e=n.lib.BlockCipher,D=n.algo,t=[],r=[],i=[],o=[],s=[],a=[],c=[],l=[],h=[],u=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;for(var m=0,g=0,p=0;256>p;p++){var x=g^g<<1^g<<2^g<<3^g<<4,x=x>>>8^x&255^99;t[m]=x,r[x]=m;var b=d[m],_=d[b],O=d[_],S=257*d[x]^16843008*x;i[m]=S<<24|S>>>8,o[m]=S<<16|S>>>16,s[m]=S<<8|S>>>24,a[m]=S,S=16843009*O^65537*_^257*b^16843008*m,c[x]=S<<24|S>>>8,l[x]=S<<16|S>>>16,h[x]=S<<8|S>>>24,u[x]=S,m?(m=b^d[d[d[O^b]]],g^=d[d[g]]):m=g=1}var E=[0,1,2,4,8,16,32,64,128,27,54],D=D.AES=e.extend({_doReset:function(){for(var P=this._key,I=P.words,y=P.sigBytes/4,P=4*((this._nRounds=y+6)+1),C=this._keySchedule=[],M=0;M<P;M++)if(M<y)C[M]=I[M];else{var A=C[M-1];M%y?6<y&&M%y==4&&(A=t[A>>>24]<<24|t[A>>>16&255]<<16|t[A>>>8&255]<<8|t[A&255]):(A=A<<8|A>>>24,A=t[A>>>24]<<24|t[A>>>16&255]<<16|t[A>>>8&255]<<8|t[A&255],A^=E[M/y|0]<<24),C[M]=C[M-y]^A}for(I=this._invKeySchedule=[],y=0;y<P;y++)M=P-y,A=y%4?C[M]:C[M-4],I[y]=4>y||4>=M?A:c[t[A>>>24]]^l[t[A>>>16&255]]^h[t[A>>>8&255]]^u[t[A&255]]},encryptBlock:function(I,y){this._doCryptBlock(I,y,this._keySchedule,i,o,s,a,t)},decryptBlock:function(I,y){var P=I[y+1];I[y+1]=I[y+3],I[y+3]=P,this._doCryptBlock(I,y,this._invKeySchedule,c,l,h,u,r),P=I[y+1],I[y+1]=I[y+3],I[y+3]=P},_doCryptBlock:function(I,y,P,C,M,A,F,k){for(var T=this._nRounds,te=I[y]^P[0],be=I[y+1]^P[1],ge=I[y+2]^P[2],re=I[y+3]^P[3],R=4,N=1;N<T;N++)var q=C[te>>>24]^M[be>>>16&255]^A[ge>>>8&255]^F[re&255]^P[R++],V=C[be>>>24]^M[ge>>>16&255]^A[re>>>8&255]^F[te&255]^P[R++],G=C[ge>>>24]^M[re>>>16&255]^A[te>>>8&255]^F[be&255]^P[R++],re=C[re>>>24]^M[te>>>16&255]^A[be>>>8&255]^F[ge&255]^P[R++],te=q,be=V,ge=G;q=(k[te>>>24]<<24|k[be>>>16&255]<<16|k[ge>>>8&255]<<8|k[re&255])^P[R++],V=(k[be>>>24]<<24|k[ge>>>16&255]<<16|k[re>>>8&255]<<8|k[te&255])^P[R++],G=(k[ge>>>24]<<24|k[re>>>16&255]<<16|k[te>>>8&255]<<8|k[be&255])^P[R++],re=(k[re>>>24]<<24|k[te>>>16&255]<<16|k[be>>>8&255]<<8|k[ge&255])^P[R++],I[y]=q,I[y+1]=V,I[y+2]=G,I[y+3]=re},keySize:8});n.AES=e._createHelper(D)})();(function(){function n(d,p){var m=(this._lBlock>>>d^this._rBlock)&p;this._rBlock^=m,this._lBlock^=m<<d}function e(d,p){var m=(this._rBlock>>>d^this._lBlock)&p;this._lBlock^=m,this._rBlock^=m<<d}var t=Q,i=t.lib,r=i.WordArray,i=i.BlockCipher,o=t.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=o.DES=i.extend({_doReset:function(){for(var d=this._key.words,p=[],m=0;56>m;m++){var g=s[m]-1;p[m]=d[g>>>5]>>>31-g%32&1}for(d=this._subKeys=[],g=0;16>g;g++){for(var x=d[g]=[],b=c[g],m=0;24>m;m++)x[m/6|0]|=p[(a[m]-1+b)%28]<<31-m%6,x[4+(m/6|0)]|=p[28+(a[m+24]-1+b)%28]<<31-m%6;for(x[0]=x[0]<<1|x[0]>>>31,m=1;7>m;m++)x[m]>>>=4*(m-1)+3;x[7]=x[7]<<5|x[7]>>>27}for(p=this._invSubKeys=[],m=0;16>m;m++)p[m]=d[15-m]},encryptBlock:function(d,p){this._doCryptBlock(d,p,this._subKeys)},decryptBlock:function(d,p){this._doCryptBlock(d,p,this._invSubKeys)},_doCryptBlock:function(d,p,m){this._lBlock=d[p],this._rBlock=d[p+1],n.call(this,4,252645135),n.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),n.call(this,1,1431655765);for(var g=0;16>g;g++){for(var x=m[g],b=this._lBlock,_=this._rBlock,O=0,S=0;8>S;S++)O|=l[S][((_^x[S])&h[S])>>>0];this._lBlock=_,this._rBlock=b^O}m=this._lBlock,this._lBlock=this._rBlock,this._rBlock=m,n.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),n.call(this,16,65535),n.call(this,4,252645135),d[p]=this._lBlock,d[p+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});t.DES=i._createHelper(u),o=o.TripleDES=i.extend({_doReset:function(){var d=this._key.words;this._des1=u.createEncryptor(r.create(d.slice(0,2))),this._des2=u.createEncryptor(r.create(d.slice(2,4))),this._des3=u.createEncryptor(r.create(d.slice(4,6)))},encryptBlock:function(d,p){this._des1.encryptBlock(d,p),this._des2.decryptBlock(d,p),this._des3.encryptBlock(d,p)},decryptBlock:function(d,p){this._des3.decryptBlock(d,p),this._des2.encryptBlock(d,p),this._des1.decryptBlock(d,p)},keySize:6,ivSize:2,blockSize:2}),t.TripleDES=i._createHelper(o)})();(function(){var n=Q,e=n.lib.WordArray;n.enc.Base64={stringify:function(t){var r=t.words,i=t.sigBytes,o=this._map;t.clamp(),t=[];for(var s=0;s<i;s+=3)for(var a=(r[s>>>2]>>>24-8*(s%4)&255)<<16|(r[s+1>>>2]>>>24-8*((s+1)%4)&255)<<8|r[s+2>>>2]>>>24-8*((s+2)%4)&255,c=0;4>c&&s+.75*c<i;c++)t.push(o.charAt(a>>>6*(3-c)&63));if(r=o.charAt(64))for(;t.length%4;)t.push(r);return t.join("")},parse:function(t){var r=t.length,i=this._map,o=i.charAt(64);o&&(o=t.indexOf(o),o!=-1&&(r=o));for(var o=[],s=0,a=0;a<r;a++)if(a%4){var c=i.indexOf(t.charAt(a-1))<<2*(a%4),l=i.indexOf(t.charAt(a))>>>6-2*(a%4);o[s>>>2]|=(c|l)<<24-8*(s%4),s++}return e.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(n){function e(u,d,p,m,g,x,b){return u=u+(d&p|~d&m)+g+b,(u<<x|u>>>32-x)+d}function t(u,d,p,m,g,x,b){return u=u+(d&m|p&~m)+g+b,(u<<x|u>>>32-x)+d}function r(u,d,p,m,g,x,b){return u=u+(d^p^m)+g+b,(u<<x|u>>>32-x)+d}function i(u,d,p,m,g,x,b){return u=u+(p^(d|~m))+g+b,(u<<x|u>>>32-x)+d}for(var o=Q,c=o.lib,s=c.WordArray,a=c.Hasher,c=o.algo,l=[],h=0;64>h;h++)l[h]=4294967296*n.abs(n.sin(h+1))|0;c=c.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(u,d){for(var p=0;16>p;p++){var m=d+p,g=u[m];u[m]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var p=this._hash.words,m=u[d+0],g=u[d+1],x=u[d+2],b=u[d+3],_=u[d+4],O=u[d+5],S=u[d+6],E=u[d+7],D=u[d+8],I=u[d+9],y=u[d+10],P=u[d+11],C=u[d+12],M=u[d+13],A=u[d+14],F=u[d+15],k=p[0],N=p[1],R=p[2],T=p[3],k=e(k,N,R,T,m,7,l[0]),T=e(T,k,N,R,g,12,l[1]),R=e(R,T,k,N,x,17,l[2]),N=e(N,R,T,k,b,22,l[3]),k=e(k,N,R,T,_,7,l[4]),T=e(T,k,N,R,O,12,l[5]),R=e(R,T,k,N,S,17,l[6]),N=e(N,R,T,k,E,22,l[7]),k=e(k,N,R,T,D,7,l[8]),T=e(T,k,N,R,I,12,l[9]),R=e(R,T,k,N,y,17,l[10]),N=e(N,R,T,k,P,22,l[11]),k=e(k,N,R,T,C,7,l[12]),T=e(T,k,N,R,M,12,l[13]),R=e(R,T,k,N,A,17,l[14]),N=e(N,R,T,k,F,22,l[15]),k=t(k,N,R,T,g,5,l[16]),T=t(T,k,N,R,S,9,l[17]),R=t(R,T,k,N,P,14,l[18]),N=t(N,R,T,k,m,20,l[19]),k=t(k,N,R,T,O,5,l[20]),T=t(T,k,N,R,y,9,l[21]),R=t(R,T,k,N,F,14,l[22]),N=t(N,R,T,k,_,20,l[23]),k=t(k,N,R,T,I,5,l[24]),T=t(T,k,N,R,A,9,l[25]),R=t(R,T,k,N,b,14,l[26]),N=t(N,R,T,k,D,20,l[27]),k=t(k,N,R,T,M,5,l[28]),T=t(T,k,N,R,x,9,l[29]),R=t(R,T,k,N,E,14,l[30]),N=t(N,R,T,k,C,20,l[31]),k=r(k,N,R,T,O,4,l[32]),T=r(T,k,N,R,D,11,l[33]),R=r(R,T,k,N,P,16,l[34]),N=r(N,R,T,k,A,23,l[35]),k=r(k,N,R,T,g,4,l[36]),T=r(T,k,N,R,_,11,l[37]),R=r(R,T,k,N,E,16,l[38]),N=r(N,R,T,k,y,23,l[39]),k=r(k,N,R,T,M,4,l[40]),T=r(T,k,N,R,m,11,l[41]),R=r(R,T,k,N,b,16,l[42]),N=r(N,R,T,k,S,23,l[43]),k=r(k,N,R,T,I,4,l[44]),T=r(T,k,N,R,C,11,l[45]),R=r(R,T,k,N,F,16,l[46]),N=r(N,R,T,k,x,23,l[47]),k=i(k,N,R,T,m,6,l[48]),T=i(T,k,N,R,E,10,l[49]),R=i(R,T,k,N,A,15,l[50]),N=i(N,R,T,k,O,21,l[51]),k=i(k,N,R,T,C,6,l[52]),T=i(T,k,N,R,b,10,l[53]),R=i(R,T,k,N,y,15,l[54]),N=i(N,R,T,k,g,21,l[55]),k=i(k,N,R,T,D,6,l[56]),T=i(T,k,N,R,F,10,l[57]),R=i(R,T,k,N,S,15,l[58]),N=i(N,R,T,k,M,21,l[59]),k=i(k,N,R,T,_,6,l[60]),T=i(T,k,N,R,P,10,l[61]),R=i(R,T,k,N,x,15,l[62]),N=i(N,R,T,k,I,21,l[63]);p[0]=p[0]+k|0,p[1]=p[1]+N|0,p[2]=p[2]+R|0,p[3]=p[3]+T|0},_doFinalize:function(){var u=this._data,d=u.words,p=8*this._nDataBytes,m=8*u.sigBytes;d[m>>>5]|=128<<24-m%32;var g=n.floor(p/4294967296);for(d[(m+64>>>9<<4)+15]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,d[(m+64>>>9<<4)+14]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,u.sigBytes=4*(d.length+1),this._process(),u=this._hash,d=u.words,p=0;4>p;p++)m=d[p],d[p]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360;return u},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}}),o.MD5=a._createHelper(c),o.HmacMD5=a._createHmacHelper(c)})(Math);(function(){var n=Q,i=n.lib,e=i.WordArray,t=i.Hasher,r=[],i=n.algo.SHA1=t.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(o,s){for(var a=this._hash.words,c=a[0],l=a[1],h=a[2],u=a[3],d=a[4],p=0;80>p;p++){if(16>p)r[p]=o[s+p]|0;else{var m=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=m<<1|m>>>31}m=(c<<5|c>>>27)+d+r[p],m=20>p?m+((l&h|~l&u)+1518500249):40>p?m+((l^h^u)+1859775393):60>p?m+((l&h|l&u|h&u)-1894007588):m+((l^h^u)-899497514),d=u,u=h,h=l<<30|l>>>2,l=c,c=m}a[0]=a[0]+c|0,a[1]=a[1]+l|0,a[2]=a[2]+h|0,a[3]=a[3]+u|0,a[4]=a[4]+d|0},_doFinalize:function(){var o=this._data,s=o.words,a=8*this._nDataBytes,c=8*o.sigBytes;return s[c>>>5]|=128<<24-c%32,s[(c+64>>>9<<4)+14]=Math.floor(a/4294967296),s[(c+64>>>9<<4)+15]=a,o.sigBytes=4*s.length,this._process(),this._hash},clone:function(){var o=t.clone.call(this);return o._hash=this._hash.clone(),o}});n.SHA1=t._createHelper(i),n.HmacSHA1=t._createHmacHelper(i)})();(function(n){for(var e=Q,p=e.lib,t=p.WordArray,r=p.Hasher,p=e.algo,i=[],o=[],s=function(g){return 4294967296*(g-(g|0))|0},a=2,c=0;64>c;){var l;e:{l=a;for(var h=n.sqrt(l),u=2;u<=h;u++)if(!(l%u)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(n.pow(a,.5))),o[c]=s(n.pow(a,1/3)),c++),a++}var d=[],p=p.SHA256=r.extend({_doReset:function(){this._hash=new t.init(i.slice(0))},_doProcessBlock:function(m,g){for(var x=this._hash.words,b=x[0],_=x[1],O=x[2],S=x[3],E=x[4],D=x[5],I=x[6],y=x[7],P=0;64>P;P++){if(16>P)d[P]=m[g+P]|0;else{var C=d[P-15],M=d[P-2];d[P]=((C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3)+d[P-7]+((M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10)+d[P-16]}C=y+((E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25))+(E&D^~E&I)+o[P]+d[P],M=((b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22))+(b&_^b&O^_&O),y=I,I=D,D=E,E=S+C|0,S=O,O=_,_=b,b=C+M|0}x[0]=x[0]+b|0,x[1]=x[1]+_|0,x[2]=x[2]+O|0,x[3]=x[3]+S|0,x[4]=x[4]+E|0,x[5]=x[5]+D|0,x[6]=x[6]+I|0,x[7]=x[7]+y|0},_doFinalize:function(){var m=this._data,g=m.words,x=8*this._nDataBytes,b=8*m.sigBytes;return g[b>>>5]|=128<<24-b%32,g[(b+64>>>9<<4)+14]=n.floor(x/4294967296),g[(b+64>>>9<<4)+15]=x,m.sigBytes=4*g.length,this._process(),this._hash},clone:function(){var m=r.clone.call(this);return m._hash=this._hash.clone(),m}});e.SHA256=r._createHelper(p),e.HmacSHA256=r._createHmacHelper(p)})(Math);(function(){var n=Q,e=n.lib.WordArray,r=n.algo,t=r.SHA256,r=r.SHA224=t.extend({_doReset:function(){this._hash=new e.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=t._doFinalize.call(this);return i.sigBytes-=4,i}});n.SHA224=t._createHelper(r),n.HmacSHA224=t._createHmacHelper(r)})();(function(){function n(){return r.create.apply(r,arguments)}for(var e=Q,t=e.lib.Hasher,o=e.x64,r=o.Word,i=o.WordArray,o=e.algo,s=[n(1116352408,3609767458),n(1899447441,602891725),n(3049323471,3964484399),n(3921009573,2173295548),n(961987163,4081628472),n(1508970993,3053834265),n(2453635748,2937671579),n(2870763221,3664609560),n(3624381080,2734883394),n(310598401,1164996542),n(607225278,1323610764),n(1426881987,3590304994),n(1925078388,4068182383),n(2162078206,991336113),n(2614888103,633803317),n(3248222580,3479774868),n(3835390401,2666613458),n(4022224774,944711139),n(264347078,2341262773),n(604807628,2007800933),n(770255983,1495990901),n(1249150122,1856431235),n(1555081692,3175218132),n(1996064986,2198950837),n(2554220882,3999719339),n(2821834349,766784016),n(2952996808,2566594879),n(3210313671,3203337956),n(3336571891,1034457026),n(3584528711,2466948901),n(113926993,3758326383),n(338241895,168717936),n(666307205,1188179964),n(773529912,1546045734),n(1294757372,1522805485),n(1396182291,2643833823),n(1695183700,2343527390),n(1986661051,1014477480),n(2177026350,1206759142),n(2456956037,344077627),n(2730485921,1290863460),n(2820302411,3158454273),n(3259730800,3505952657),n(3345764771,106217008),n(3516065817,3606008344),n(3600352804,1432725776),n(4094571909,1467031594),n(275423344,851169720),n(430227734,3100823752),n(506948616,1363258195),n(659060556,3750685593),n(883997877,3785050280),n(958139571,3318307427),n(1322822218,3812723403),n(1537002063,2003034995),n(1747873779,3602036899),n(1955562222,1575990012),n(2024104815,1125592928),n(2227730452,2716904306),n(2361852424,442776044),n(2428436474,593698344),n(2756734187,3733110249),n(3204031479,2999351573),n(3329325298,3815920427),n(3391569614,3928383900),n(3515267271,566280711),n(3940187606,3454069534),n(4118630271,4000239992),n(116418474,1914138554),n(174292421,2731055270),n(289380356,3203993006),n(460393269,320620315),n(685471733,587496836),n(852142971,1086792851),n(1017036298,365543100),n(1126000580,2618297676),n(1288033470,3409855158),n(1501505948,4234509866),n(1607167915,987167468),n(1816402316,1246189591)],a=[],c=0;80>c;c++)a[c]=n();o=o.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(l,h){for(var _=this._hash.words,u=_[0],d=_[1],p=_[2],m=_[3],g=_[4],x=_[5],b=_[6],_=_[7],O=u.high,S=u.low,E=d.high,D=d.low,I=p.high,y=p.low,P=m.high,C=m.low,M=g.high,A=g.low,F=x.high,k=x.low,T=b.high,R=b.low,N=_.high,q=_.low,V=O,G=S,re=E,te=D,be=I,ge=y,rt=P,He=C,Ue=M,Je=A,ze=F,pe=k,Ee=T,Oe=R,Ge=N,St=q,Qe=0;80>Qe;Qe++){var si=a[Qe];if(16>Qe)var Cn=si.high=l[h+2*Qe]|0,qe=si.low=l[h+2*Qe+1]|0;else{var Cn=a[Qe-15],qe=Cn.high,_r=Cn.low,Cn=(qe>>>1|_r<<31)^(qe>>>8|_r<<24)^qe>>>7,_r=(_r>>>1|qe<<31)^(_r>>>8|qe<<24)^(_r>>>7|qe<<25),Qi=a[Qe-2],qe=Qi.high,ht=Qi.low,Qi=(qe>>>19|ht<<13)^(qe<<3|ht>>>29)^qe>>>6,ht=(ht>>>19|qe<<13)^(ht<<3|qe>>>29)^(ht>>>6|qe<<26),qe=a[Qe-7],ba=qe.high,oi=a[Qe-16],yr=oi.high,oi=oi.low,qe=_r+qe.low,Cn=Cn+ba+(qe>>>0<_r>>>0?1:0),qe=qe+ht,Cn=Cn+Qi+(qe>>>0<ht>>>0?1:0),qe=qe+oi,Cn=Cn+yr+(qe>>>0<oi>>>0?1:0);si.high=Cn,si.low=qe}var ba=Ue&ze^~Ue&Ee,oi=Je&pe^~Je&Oe,si=V&re^V&be^re&be,P5=G&te^G&ge^te&ge,_r=(V>>>28|G<<4)^(V<<30|G>>>2)^(V<<25|G>>>7),Qi=(G>>>28|V<<4)^(G<<30|V>>>2)^(G<<25|V>>>7),ht=s[Qe],O5=ht.high,qb=ht.low,ht=St+((Je>>>14|Ue<<18)^(Je>>>18|Ue<<14)^(Je<<23|Ue>>>9)),yr=Ge+((Ue>>>14|Je<<18)^(Ue>>>18|Je<<14)^(Ue<<23|Je>>>9))+(ht>>>0<St>>>0?1:0),ht=ht+oi,yr=yr+ba+(ht>>>0<oi>>>0?1:0),ht=ht+qb,yr=yr+O5+(ht>>>0<qb>>>0?1:0),ht=ht+qe,yr=yr+Cn+(ht>>>0<qe>>>0?1:0),qe=Qi+P5,si=_r+si+(qe>>>0<Qi>>>0?1:0),Ge=Ee,St=Oe,Ee=ze,Oe=pe,ze=Ue,pe=Je,Je=He+ht|0,Ue=rt+yr+(Je>>>0<He>>>0?1:0)|0,rt=be,He=ge,be=re,ge=te,re=V,te=G,G=ht+qe|0,V=yr+si+(G>>>0<ht>>>0?1:0)|0}S=u.low=S+G,u.high=O+V+(S>>>0<G>>>0?1:0),D=d.low=D+te,d.high=E+re+(D>>>0<te>>>0?1:0),y=p.low=y+ge,p.high=I+be+(y>>>0<ge>>>0?1:0),C=m.low=C+He,m.high=P+rt+(C>>>0<He>>>0?1:0),A=g.low=A+Je,g.high=M+Ue+(A>>>0<Je>>>0?1:0),k=x.low=k+pe,x.high=F+ze+(k>>>0<pe>>>0?1:0),R=b.low=R+Oe,b.high=T+Ee+(R>>>0<Oe>>>0?1:0),q=_.low=q+St,_.high=N+Ge+(q>>>0<St>>>0?1:0)},_doFinalize:function(){var l=this._data,h=l.words,u=8*this._nDataBytes,d=8*l.sigBytes;return h[d>>>5]|=128<<24-d%32,h[(d+128>>>10<<5)+30]=Math.floor(u/4294967296),h[(d+128>>>10<<5)+31]=u,l.sigBytes=4*h.length,this._process(),this._hash.toX32()},clone:function(){var l=t.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:32}),e.SHA512=t._createHelper(o),e.HmacSHA512=t._createHmacHelper(o)})();(function(){var n=Q,i=n.x64,e=i.Word,t=i.WordArray,i=n.algo,r=i.SHA512,i=i.SHA384=r.extend({_doReset:function(){this._hash=new t.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var o=r._doFinalize.call(this);return o.sigBytes-=16,o}});n.SHA384=r._createHelper(i),n.HmacSHA384=r._createHmacHelper(i)})();(function(){var n=Q,l=n.lib,e=l.WordArray,t=l.Hasher,l=n.algo,r=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),s=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),a=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),l=l.RIPEMD160=t.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,u){for(var d=0;16>d;d++){var p=u+d,m=h[p];h[p]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var p=this._hash.words,m=a.words,g=c.words,x=r.words,b=i.words,_=o.words,O=s.words,S,E,D,I,y,P,C,M,A,F;P=S=p[0],C=E=p[1],M=D=p[2],A=I=p[3],F=y=p[4];for(var k,d=0;80>d;d+=1)k=S+h[u+x[d]]|0,k=16>d?k+((E^D^I)+m[0]):32>d?k+((E&D|~E&I)+m[1]):48>d?k+(((E|~D)^I)+m[2]):64>d?k+((E&I|D&~I)+m[3]):k+((E^(D|~I))+m[4]),k|=0,k=k<<_[d]|k>>>32-_[d],k=k+y|0,S=y,y=I,I=D<<10|D>>>22,D=E,E=k,k=P+h[u+b[d]]|0,k=16>d?k+((C^(M|~A))+g[0]):32>d?k+((C&A|M&~A)+g[1]):48>d?k+(((C|~M)^A)+g[2]):64>d?k+((C&M|~C&A)+g[3]):k+((C^M^A)+g[4]),k|=0,k=k<<O[d]|k>>>32-O[d],k=k+F|0,P=F,F=A,A=M<<10|M>>>22,M=C,C=k;k=p[1]+D+A|0,p[1]=p[2]+I+F|0,p[2]=p[3]+y+P|0,p[3]=p[4]+S+C|0,p[4]=p[0]+E+M|0,p[0]=k},_doFinalize:function(){var h=this._data,u=h.words,d=8*this._nDataBytes,p=8*h.sigBytes;for(u[p>>>5]|=128<<24-p%32,u[(p+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,h.sigBytes=4*(u.length+1),this._process(),h=this._hash,u=h.words,d=0;5>d;d++)p=u[d],u[d]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360;return h},clone:function(){var h=t.clone.call(this);return h._hash=this._hash.clone(),h}});n.RIPEMD160=t._createHelper(l),n.HmacRIPEMD160=t._createHmacHelper(l)})(Math);(function(){var n=Q,e=n.enc.Utf8;n.algo.HMAC=n.lib.Base.extend({init:function(t,r){t=this._hasher=new t.init,typeof r=="string"&&(r=e.parse(r));var i=t.blockSize,o=4*i;r.sigBytes>o&&(r=t.finalize(r)),r.clamp();for(var s=this._oKey=r.clone(),a=this._iKey=r.clone(),c=s.words,l=a.words,h=0;h<i;h++)c[h]^=1549556828,l[h]^=909522486;s.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var r=this._hasher;return t=r.finalize(t),r.reset(),r.finalize(this._oKey.clone().concat(t))}})})();(function(){var n=Q,r=n.lib,e=r.Base,t=r.WordArray,r=n.algo,i=r.HMAC,o=r.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:r.SHA1,iterations:1}),init:function(s){this.cfg=this.cfg.extend(s)},compute:function(s,a){for(var m=this.cfg,c=i.create(m.hasher,s),l=t.create(),h=t.create([1]),u=l.words,d=h.words,p=m.keySize,m=m.iterations;u.length<p;){var g=c.update(a).finalize(h);c.reset();for(var x=g.words,b=x.length,_=g,O=1;O<m;O++){_=c.finalize(_),c.reset();for(var S=_.words,E=0;E<b;E++)x[E]^=S[E]}l.concat(g),d[0]++}return l.sigBytes=4*p,l}});n.PBKDF2=function(s,a,c){return o.create(c).compute(s,a)}})();var ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A0="=";function Zr(n){var e,t,r="";for(e=0;e+3<=n.length;e+=3)t=parseInt(n.substring(e,e+3),16),r+=ra.charAt(t>>6)+ra.charAt(t&63);if(e+1==n.length?(t=parseInt(n.substring(e,e+1),16),r+=ra.charAt(t<<2)):e+2==n.length&&(t=parseInt(n.substring(e,e+2),16),r+=ra.charAt(t>>2)+ra.charAt((t&3)<<4)),A0)for(;(r.length&3)>0;)r+=A0;return r}function oa(n){var e="",t,r=0,i,o;for(t=0;t<n.length&&n.charAt(t)!=A0;++t)o=ra.indexOf(n.charAt(t)),!(o<0)&&(r==0?(e+=Yr(o>>2),i=o&3,r=1):r==1?(e+=Yr(i<<2|o>>4),i=o&15,r=2):r==2?(e+=Yr(i),e+=Yr(o>>2),i=o&3,r=3):(e+=Yr(i<<2|o>>4),e+=Yr(o&15),r=0));return r==1&&(e+=Yr(i<<2)),e}function sk(n){var e=oa(n),t,r=new Array;for(t=0;2*t<e.length;++t)r[t]=parseInt(e.substring(2*t,2*t+2),16);return r}var Ki,GH=0xdeadbeefcafe,rk=(GH&16777215)==15715070;function B(n,e,t){n!=null&&(typeof n=="number"?this.fromNumber(n,e,t):e==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,e))}function De(){return new B(null)}function WH(n,e,t,r,i,o){for(;--o>=0;){var s=e*this[n++]+t[r]+i;i=Math.floor(s/67108864),t[r++]=s&67108863}return i}function KH(n,e,t,r,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var c=this[n]&32767,l=this[n++]>>15,h=a*c+l*s;c=s*c+((h&32767)<<15)+t[r]+(i&1073741823),i=(c>>>30)+(h>>>15)+a*l+(i>>>30),t[r++]=c&1073741823}return i}function $H(n,e,t,r,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var c=this[n]&16383,l=this[n++]>>14,h=a*c+l*s;c=s*c+((h&16383)<<14)+t[r]+i,i=(c>>28)+(h>>14)+a*l,t[r++]=c&268435455}return i}rk&&sl.appName=="Microsoft Internet Explorer"?(B.prototype.am=KH,Ki=30):rk&&sl.appName!="Netscape"?(B.prototype.am=WH,Ki=26):(B.prototype.am=$H,Ki=28);B.prototype.DB=Ki;B.prototype.DM=(1<<Ki)-1;B.prototype.DV=1<<Ki;var z0=52;B.prototype.FV=Math.pow(2,z0);B.prototype.F1=z0-Ki;B.prototype.F2=2*Ki-z0;var XH="0123456789abcdefghijklmnopqrstuvwxyz",dp=new Array,sa,er;sa=48;for(er=0;er<=9;++er)dp[sa++]=er;sa=97;for(er=10;er<36;++er)dp[sa++]=er;sa=65;for(er=10;er<36;++er)dp[sa++]=er;function Yr(n){return XH.charAt(n)}function ak(n,e){var t=dp[n.charCodeAt(e)];return t??-1}function JH(n){for(var e=this.t-1;e>=0;--e)n[e]=this[e];n.t=this.t,n.s=this.s}function QH(n){this.t=1,this.s=n<0?-1:0,n>0?this[0]=n:n<-1?this[0]=n+this.DV:this.t=0}function Wi(n){var e=De();return e.fromInt(n),e}function YH(n,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(n,e);return}this.t=0,this.s=0;for(var r=n.length,i=!1,o=0;--r>=0;){var s=t==8?n[r]&255:ak(n,r);if(s<0){n.charAt(r)=="-"&&(i=!0);continue}i=!1,o==0?this[this.t++]=s:o+t>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,o+=t,o>=this.DB&&(o-=this.DB)}t==8&&n[0]&128&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&B.ZERO.subTo(this,this)}function ZH(){for(var n=this.s&this.DM;this.t>0&&this[this.t-1]==n;)--this.t}function eU(n){if(this.s<0)return"-"+this.negate().toString(n);var e;if(n==16)e=4;else if(n==8)e=3;else if(n==2)e=1;else if(n==32)e=5;else if(n==4)e=2;else return this.toRadix(n);var t=(1<<e)-1,r,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=Yr(r));s>=0;)a<e?(r=(this[s]&(1<<a)-1)<<e-a,r|=this[--s]>>(a+=this.DB-e)):(r=this[s]>>(a-=e)&t,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=Yr(r));return i?o:"0"}function tU(){var n=De();return B.ZERO.subTo(this,n),n}function nU(){return this.s<0?this.negate():this}function rU(n){var e=this.s-n.s;if(e!=0)return e;var t=this.t;if(e=t-n.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this[t]-n[t])!=0)return e;return 0}function up(n){var e=1,t;return(t=n>>>16)!=0&&(n=t,e+=16),(t=n>>8)!=0&&(n=t,e+=8),(t=n>>4)!=0&&(n=t,e+=4),(t=n>>2)!=0&&(n=t,e+=2),(t=n>>1)!=0&&(n=t,e+=1),e}function iU(){return this.t<=0?0:this.DB*(this.t-1)+up(this[this.t-1]^this.s&this.DM)}function oU(n,e){var t;for(t=this.t-1;t>=0;--t)e[t+n]=this[t];for(t=n-1;t>=0;--t)e[t]=0;e.t=this.t+n,e.s=this.s}function sU(n,e){for(var t=n;t<this.t;++t)e[t-n]=this[t];e.t=Math.max(this.t-n,0),e.s=this.s}function aU(n,e){var t=n%this.DB,r=this.DB-t,i=(1<<r)-1,o=Math.floor(n/this.DB),s=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e[a+o+1]=this[a]>>r|s,s=(this[a]&i)<<t;for(a=o-1;a>=0;--a)e[a]=0;e[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function cU(n,e){e.s=this.s;var t=Math.floor(n/this.DB);if(t>=this.t){e.t=0;return}var r=n%this.DB,i=this.DB-r,o=(1<<r)-1;e[0]=this[t]>>r;for(var s=t+1;s<this.t;++s)e[s-t-1]|=(this[s]&o)<<i,e[s-t]=this[s]>>r;r>0&&(e[this.t-t-1]|=(this.s&o)<<i),e.t=this.t-t,e.clamp()}function lU(n,e){for(var t=0,r=0,i=Math.min(n.t,this.t);t<i;)r+=this[t]-n[t],e[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r-=n.s;t<this.t;)r+=this[t],e[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r-=n[t],e[t++]=r&this.DM,r>>=this.DB;r-=n.s}e.s=r<0?-1:0,r<-1?e[t++]=this.DV+r:r>0&&(e[t++]=r),e.t=t,e.clamp()}function dU(n,e){var t=this.abs(),r=n.abs(),i=t.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+t.t]=t.am(0,r[i],e,i,0,t.t);e.s=0,e.clamp(),this.s!=n.s&&B.ZERO.subTo(e,e)}function uU(n){for(var e=this.abs(),t=n.t=2*e.t;--t>=0;)n[t]=0;for(t=0;t<e.t-1;++t){var r=e.am(t,e[t],n,2*t,0,1);(n[t+e.t]+=e.am(t+1,2*e[t],n,2*t+1,r,e.t-t-1))>=e.DV&&(n[t+e.t]-=e.DV,n[t+e.t+1]=1)}n.t>0&&(n[n.t-1]+=e.am(t,e[t],n,2*t,0,1)),n.s=0,n.clamp()}function hU(n,e,t){var r=n.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t){e?.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=De());var o=De(),s=this.s,a=n.s,c=this.DB-up(r[r.t-1]);c>0?(r.lShiftTo(c,o),i.lShiftTo(c,t)):(r.copyTo(o),i.copyTo(t));var l=o.t,h=o[l-1];if(h!=0){var u=h*(1<<this.F1)+(l>1?o[l-2]>>this.F2:0),d=this.FV/u,p=(1<<this.F1)/u,m=1<<this.F2,g=t.t,x=g-l,b=e??De();for(o.dlShiftTo(x,b),t.compareTo(b)>=0&&(t[t.t++]=1,t.subTo(b,t)),B.ONE.dlShiftTo(l,b),b.subTo(o,o);o.t<l;)o[o.t++]=0;for(;--x>=0;){var _=t[--g]==h?this.DM:Math.floor(t[g]*d+(t[g-1]+m)*p);if((t[g]+=o.am(0,_,t,x,0,l))<_)for(o.dlShiftTo(x,b),t.subTo(b,t);t[g]<--_;)t.subTo(b,t)}e!=null&&(t.drShiftTo(l,e),s!=a&&B.ZERO.subTo(e,e)),t.t=l,t.clamp(),c>0&&t.rShiftTo(c,t),s<0&&B.ZERO.subTo(t,t)}}}function pU(n){var e=De();return this.abs().divRemTo(n,null,e),this.s<0&&e.compareTo(B.ZERO)>0&&n.subTo(e,e),e}function Ao(n){this.m=n}function fU(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function gU(n){return n}function mU(n){n.divRemTo(this.m,null,n)}function vU(n,e,t){n.multiplyTo(e,t),this.reduce(t)}function bU(n,e){n.squareTo(e),this.reduce(e)}Ao.prototype.convert=fU;Ao.prototype.revert=gU;Ao.prototype.reduce=mU;Ao.prototype.mulTo=vU;Ao.prototype.sqrTo=bU;function xU(){if(this.t<1)return 0;var n=this[0];if(!(n&1))return 0;var e=n&3;return e=e*(2-(n&15)*e)&15,e=e*(2-(n&255)*e)&255,e=e*(2-((n&65535)*e&65535))&65535,e=e*(2-n*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ko(n){this.m=n,this.mp=n.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}function _U(n){var e=De();return n.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),n.s<0&&e.compareTo(B.ZERO)>0&&this.m.subTo(e,e),e}function yU(n){var e=De();return n.copyTo(e),this.reduce(e),e}function CU(n){for(;n.t<=this.mt2;)n[n.t++]=0;for(var e=0;e<this.m.t;++e){var t=n[e]&32767,r=t*this.mpl+((t*this.mph+(n[e]>>15)*this.mpl&this.um)<<15)&n.DM;for(t=e+this.m.t,n[t]+=this.m.am(0,r,n,e,0,this.m.t);n[t]>=n.DV;)n[t]-=n.DV,n[++t]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function wU(n,e){n.squareTo(e),this.reduce(e)}function PU(n,e,t){n.multiplyTo(e,t),this.reduce(t)}ko.prototype.convert=_U;ko.prototype.revert=yU;ko.prototype.reduce=CU;ko.prototype.mulTo=PU;ko.prototype.sqrTo=wU;function OU(){return(this.t>0?this[0]&1:this.s)==0}function MU(n,e){if(n>4294967295||n<1)return B.ONE;var t=De(),r=De(),i=e.convert(this),o=up(n)-1;for(i.copyTo(t);--o>=0;)if(e.sqrTo(t,r),(n&1<<o)>0)e.mulTo(r,i,t);else{var s=t;t=r,r=s}return e.revert(t)}function SU(n,e){var t;return n<256||e.isEven()?t=new Ao(e):t=new ko(e),this.exp(n,t)}B.prototype.copyTo=JH;B.prototype.fromInt=QH;B.prototype.fromString=YH;B.prototype.clamp=ZH;B.prototype.dlShiftTo=oU;B.prototype.drShiftTo=sU;B.prototype.lShiftTo=aU;B.prototype.rShiftTo=cU;B.prototype.subTo=lU;B.prototype.multiplyTo=dU;B.prototype.squareTo=uU;B.prototype.divRemTo=hU;B.prototype.invDigit=xU;B.prototype.isEven=OU;B.prototype.exp=MU;B.prototype.toString=eU;B.prototype.negate=tU;B.prototype.abs=nU;B.prototype.compareTo=rU;B.prototype.bitLength=iU;B.prototype.mod=pU;B.prototype.modPowInt=SU;B.ZERO=Wi(0);B.ONE=Wi(1);function EU(){var n=De();return this.copyTo(n),n}function AU(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function kU(){return this.t==0?this.s:this[0]<<24>>24}function TU(){return this.t==0?this.s:this[0]<<16>>16}function DU(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function FU(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function zU(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var e=this.chunkSize(n),t=Math.pow(n,e),r=Wi(t),i=De(),o=De(),s="";for(this.divRemTo(r,i,o);i.signum()>0;)s=(t+o.intValue()).toString(n).substr(1)+s,i.divRemTo(r,i,o);return o.intValue().toString(n)+s}function IU(n,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),r=Math.pow(e,t),i=!1,o=0,s=0,a=0;a<n.length;++a){var c=ak(n,a);if(c<0){n.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+c,++o>=t&&(this.dMultiply(r),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&B.ZERO.subTo(this,this)}function RU(n,e,t){if(typeof e=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,t),this.testBit(n-1)||this.bitwiseTo(B.ONE.shiftLeft(n-1),I0,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(B.ONE.shiftLeft(n-1),this);else{var r=new Array,i=n&7;r.length=(n>>3)+1,e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}function NU(){var n=this.t,e=new Array;e[0]=this.s;var t=this.DB-n*this.DB%8,r,i=0;if(n-- >0)for(t<this.DB&&(r=this[n]>>t)!=(this.s&this.DM)>>t&&(e[i++]=r|this.s<<this.DB-t);n>=0;)t<8?(r=(this[n]&(1<<t)-1)<<8-t,r|=this[--n]>>(t+=this.DB-8)):(r=this[n]>>(t-=8)&255,t<=0&&(t+=this.DB,--n)),r&128&&(r|=-256),i==0&&(this.s&128)!=(r&128)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function BU(n){return this.compareTo(n)==0}function LU(n){return this.compareTo(n)<0?this:n}function qU(n){return this.compareTo(n)>0?this:n}function jU(n,e,t){var r,i,o=Math.min(n.t,this.t);for(r=0;r<o;++r)t[r]=e(this[r],n[r]);if(n.t<this.t){for(i=n.s&this.DM,r=o;r<this.t;++r)t[r]=e(this[r],i);t.t=this.t}else{for(i=this.s&this.DM,r=o;r<n.t;++r)t[r]=e(i,n[r]);t.t=n.t}t.s=e(this.s,n.s),t.clamp()}function VU(n,e){return n&e}function HU(n){var e=De();return this.bitwiseTo(n,VU,e),e}function I0(n,e){return n|e}function UU(n){var e=De();return this.bitwiseTo(n,I0,e),e}function ck(n,e){return n^e}function GU(n){var e=De();return this.bitwiseTo(n,ck,e),e}function lk(n,e){return n&~e}function WU(n){var e=De();return this.bitwiseTo(n,lk,e),e}function KU(){for(var n=De(),e=0;e<this.t;++e)n[e]=this.DM&~this[e];return n.t=this.t,n.s=~this.s,n}function $U(n){var e=De();return n<0?this.rShiftTo(-n,e):this.lShiftTo(n,e),e}function XU(n){var e=De();return n<0?this.lShiftTo(-n,e):this.rShiftTo(n,e),e}function JU(n){if(n==0)return-1;var e=0;return n&65535||(n>>=16,e+=16),n&255||(n>>=8,e+=8),n&15||(n>>=4,e+=4),n&3||(n>>=2,e+=2),n&1||++e,e}function QU(){for(var n=0;n<this.t;++n)if(this[n]!=0)return n*this.DB+JU(this[n]);return this.s<0?this.t*this.DB:-1}function YU(n){for(var e=0;n!=0;)n&=n-1,++e;return e}function ZU(){for(var n=0,e=this.s&this.DM,t=0;t<this.t;++t)n+=YU(this[t]^e);return n}function eG(n){var e=Math.floor(n/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<n%this.DB)!=0}function tG(n,e){var t=B.ONE.shiftLeft(n);return this.bitwiseTo(t,e,t),t}function nG(n){return this.changeBit(n,I0)}function rG(n){return this.changeBit(n,lk)}function iG(n){return this.changeBit(n,ck)}function oG(n,e){for(var t=0,r=0,i=Math.min(n.t,this.t);t<i;)r+=this[t]+n[t],e[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r+=n.s;t<this.t;)r+=this[t],e[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r+=n[t],e[t++]=r&this.DM,r>>=this.DB;r+=n.s}e.s=r<0?-1:0,r>0?e[t++]=r:r<-1&&(e[t++]=this.DV+r),e.t=t,e.clamp()}function sG(n){var e=De();return this.addTo(n,e),e}function aG(n){var e=De();return this.subTo(n,e),e}function cG(n){var e=De();return this.multiplyTo(n,e),e}function lG(){var n=De();return this.squareTo(n),n}function dG(n){var e=De();return this.divRemTo(n,e,null),e}function uG(n){var e=De();return this.divRemTo(n,null,e),e}function hG(n){var e=De(),t=De();return this.divRemTo(n,e,t),new Array(e,t)}function pG(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function fG(n,e){if(n!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=n;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function cl(){}function dk(n){return n}function gG(n,e,t){n.multiplyTo(e,t)}function mG(n,e){n.squareTo(e)}cl.prototype.convert=dk;cl.prototype.revert=dk;cl.prototype.mulTo=gG;cl.prototype.sqrTo=mG;function vG(n){return this.exp(n,new cl)}function bG(n,e,t){var r=Math.min(this.t+n.t,e);for(t.s=0,t.t=r;r>0;)t[--r]=0;var i;for(i=t.t-this.t;r<i;++r)t[r+this.t]=this.am(0,n[r],t,r,0,this.t);for(i=Math.min(n.t,e);r<i;++r)this.am(0,n[r],t,r,0,e-r);t.clamp()}function xG(n,e,t){--e;var r=t.t=this.t+n.t-e;for(t.s=0;--r>=0;)t[r]=0;for(r=Math.max(e-this.t,0);r<n.t;++r)t[this.t+r-e]=this.am(e-r,n[r],t,0,0,this.t+r-e);t.clamp(),t.drShiftTo(1,t)}function aa(n){this.r2=De(),this.q3=De(),B.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function _G(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var e=De();return n.copyTo(e),this.reduce(e),e}function yG(n){return n}function CG(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function wG(n,e){n.squareTo(e),this.reduce(e)}function PG(n,e,t){n.multiplyTo(e,t),this.reduce(t)}aa.prototype.convert=_G;aa.prototype.revert=yG;aa.prototype.reduce=CG;aa.prototype.mulTo=PG;aa.prototype.sqrTo=wG;function OG(n,e){var t=n.bitLength(),r,i=Wi(1),o;if(t<=0)return i;t<18?r=1:t<48?r=3:t<144?r=4:t<768?r=5:r=6,t<8?o=new Ao(e):e.isEven()?o=new aa(e):o=new ko(e);var s=new Array,a=3,c=r-1,l=(1<<r)-1;if(s[1]=o.convert(this),r>1){var h=De();for(o.sqrTo(s[1],h);a<=l;)s[a]=De(),o.mulTo(h,s[a-2],s[a]),a+=2}var u=n.t-1,d,p=!0,m=De(),g;for(t=up(n[u])-1;u>=0;){for(t>=c?d=n[u]>>t-c&l:(d=(n[u]&(1<<t+1)-1)<<c-t,u>0&&(d|=n[u-1]>>this.DB+t-c)),a=r;!(d&1);)d>>=1,--a;if((t-=a)<0&&(t+=this.DB,--u),p)s[d].copyTo(i),p=!1;else{for(;a>1;)o.sqrTo(i,m),o.sqrTo(m,i),a-=2;a>0?o.sqrTo(i,m):(g=i,i=m,m=g),o.mulTo(m,s[d],i)}for(;u>=0&&!(n[u]&1<<t);)o.sqrTo(i,m),g=i,i=m,m=g,--t<0&&(t=this.DB-1,--u)}return o.revert(i)}function MG(n){var e=this.s<0?this.negate():this.clone(),t=n.s<0?n.negate():n.clone();if(e.compareTo(t)<0){var r=e;e=t,t=r}var i=e.getLowestSetBit(),o=t.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),t.rShiftTo(o,t));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return o>0&&t.lShiftTo(o,t),t}function SG(n){if(n<=0)return 0;var e=this.DV%n,t=this.s<0?n-1:0;if(this.t>0)if(e==0)t=this[0]%n;else for(var r=this.t-1;r>=0;--r)t=(e*t+this[r])%n;return t}function EG(n){var e=n.isEven();if(this.isEven()&&e||n.signum()==0)return B.ZERO;for(var t=n.clone(),r=this.clone(),i=Wi(1),o=Wi(0),s=Wi(0),a=Wi(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(n,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(n,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(n,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(n,a),a.rShiftTo(1,a);t.compareTo(r)>=0?(t.subTo(r,t),e&&i.subTo(s,i),o.subTo(a,o)):(r.subTo(t,r),e&&s.subTo(i,s),a.subTo(o,a))}if(r.compareTo(B.ONE)!=0)return B.ZERO;if(a.compareTo(n)>=0)return a.subtract(n);if(a.signum()<0)a.addTo(n,a);else return a;return a.signum()<0?a.add(n):a}var yn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],AG=(1<<26)/yn[yn.length-1];function kG(n){var e,t=this.abs();if(t.t==1&&t[0]<=yn[yn.length-1]){for(e=0;e<yn.length;++e)if(t[0]==yn[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<yn.length;){for(var r=yn[e],i=e+1;i<yn.length&&r<AG;)r*=yn[i++];for(r=t.modInt(r);e<i;)if(r%yn[e++]==0)return!1}return t.millerRabin(n)}function TG(n){var e=this.subtract(B.ONE),t=e.getLowestSetBit();if(t<=0)return!1;var r=e.shiftRight(t);n=n+1>>1,n>yn.length&&(n=yn.length);for(var i=De(),o=0;o<n;++o){i.fromInt(yn[Math.floor(Math.random()*yn.length)]);var s=i.modPow(r,this);if(s.compareTo(B.ONE)!=0&&s.compareTo(e)!=0){for(var a=1;a++<t&&s.compareTo(e)!=0;)if(s=s.modPowInt(2,this),s.compareTo(B.ONE)==0)return!1;if(s.compareTo(e)!=0)return!1}}return!0}B.prototype.chunkSize=DU;B.prototype.toRadix=zU;B.prototype.fromRadix=IU;B.prototype.fromNumber=RU;B.prototype.bitwiseTo=jU;B.prototype.changeBit=tG;B.prototype.addTo=oG;B.prototype.dMultiply=pG;B.prototype.dAddOffset=fG;B.prototype.multiplyLowerTo=bG;B.prototype.multiplyUpperTo=xG;B.prototype.modInt=SG;B.prototype.millerRabin=TG;B.prototype.clone=EU;B.prototype.intValue=AU;B.prototype.byteValue=kU;B.prototype.shortValue=TU;B.prototype.signum=FU;B.prototype.toByteArray=NU;B.prototype.equals=BU;B.prototype.min=LU;B.prototype.max=qU;B.prototype.and=HU;B.prototype.or=UU;B.prototype.xor=GU;B.prototype.andNot=WU;B.prototype.not=KU;B.prototype.shiftLeft=$U;B.prototype.shiftRight=XU;B.prototype.getLowestSetBit=QU;B.prototype.bitCount=ZU;B.prototype.testBit=eG;B.prototype.setBit=nG;B.prototype.clearBit=rG;B.prototype.flipBit=iG;B.prototype.add=sG;B.prototype.subtract=aG;B.prototype.multiply=cG;B.prototype.divide=dG;B.prototype.remainder=uG;B.prototype.divideAndRemainder=hG;B.prototype.modPow=OG;B.prototype.modInverse=EG;B.prototype.pow=vG;B.prototype.gcd=MG;B.prototype.isProbablePrime=kG;B.prototype.square=lG;function R0(){this.i=0,this.j=0,this.S=new Array}function DG(n){var e,t,r;for(e=0;e<256;++e)this.S[e]=e;for(t=0,e=0;e<256;++e)t=t+this.S[e]+n[e%n.length]&255,r=this.S[e],this.S[e]=this.S[t],this.S[t]=r;this.i=0,this.j=0}function FG(){var n;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,n=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=n,this.S[n+this.S[this.i]&255]}R0.prototype.init=DG;R0.prototype.next=FG;function zG(){return new R0}var k0=256;var sp,Vn,Ut;function IG(n){Vn[Ut++]^=n&255,Vn[Ut++]^=n>>8&255,Vn[Ut++]^=n>>16&255,Vn[Ut++]^=n>>24&255,Ut>=k0&&(Ut-=k0)}function N0(){IG(new Date().getTime())}if(Vn==null){if(Vn=new Array,Ut=0,na!==void 0&&(na.crypto!==void 0||na.msCrypto!==void 0)){if(M0=na.crypto||na.msCrypto,M0.getRandomValues)for(S0=new Uint8Array(32),M0.getRandomValues(S0),Zn=0;Zn<32;++Zn)Vn[Ut++]=S0[Zn];else if(sl.appName=="Netscape"&&sl.appVersion<"5")for(E0=na.crypto.random(32),Zn=0;Zn<E0.length;++Zn)Vn[Ut++]=E0.charCodeAt(Zn)&255}for(;Ut<k0;)Zn=Math.floor(65536*Math.random()),Vn[Ut++]=Zn>>>8,Vn[Ut++]=Zn&255;Ut=0,N0()}var Zn,M0,S0,E0;function RG(){if(sp==null){for(N0(),sp=zG(),sp.init(Vn),Ut=0;Ut<Vn.length;++Ut)Vn[Ut]=0;Ut=0}return sp.next()}function NG(n){var e;for(e=0;e<n.length;++e)n[e]=RG()}function ca(){}ca.prototype.nextBytes=NG;function Fn(n,e){return new B(n,e)}function ve(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function BG(n,e){if(this.isPublic=!0,this.isPrivate=!1,typeof n!="string")this.n=n,this.e=e;else if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Fn(n,16),this.e=parseInt(e,16);else throw"Invalid RSA public key"}function LG(n){return n.modPowInt(this.e,this.n)}ve.prototype.doPublic=LG;ve.prototype.setPublic=BG;ve.prototype.type="RSA";function qG(n,e,t){if(this.isPrivate=!0,typeof n!="string")this.n=n,this.e=e,this.d=t;else if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Fn(n,16),this.e=parseInt(e,16),this.d=Fn(t,16);else throw"Invalid RSA private key"}function jG(n,e,t,r,i,o,s,a){if(this.isPrivate=!0,this.isPublic=!1,n==null)throw"RSASetPrivateEx N == null";if(e==null)throw"RSASetPrivateEx E == null";if(n.length==0)throw"RSASetPrivateEx N.length == 0";if(e.length==0)throw"RSASetPrivateEx E.length == 0";if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Fn(n,16),this.e=parseInt(e,16),this.d=Fn(t,16),this.p=Fn(r,16),this.q=Fn(i,16),this.dmp1=Fn(o,16),this.dmq1=Fn(s,16),this.coeff=Fn(a,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function VG(n,e){var t=new ca,r=n>>1;this.e=parseInt(e,16);for(var i=new B(e,16),o=n/2-100,s=B.ONE.shiftLeft(o);;){for(;this.p=new B(n-r,1,t),!(this.p.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new B(r,1,t),!(this.q.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var a=this.p;this.p=this.q,this.q=a}var c=this.q.subtract(this.p).abs();if(!(c.bitLength()<o||c.compareTo(s)<=0)){var l=this.p.subtract(B.ONE),h=this.q.subtract(B.ONE),u=l.multiply(h);if(u.gcd(i).compareTo(B.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==n)){this.d=i.modInverse(u),this.dmp1=this.d.mod(l),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function HG(n){if(this.p==null||this.q==null)return n.modPow(this.d,this.n);for(var e=n.mod(this.p).modPow(this.dmp1,this.p),t=n.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(t)<0;)e=e.add(this.p);return e.subtract(t).multiply(this.coeff).mod(this.p).multiply(this.q).add(t)}ve.prototype.doPrivate=HG;ve.prototype.setPrivate=qG;ve.prototype.setPrivateEx=jG;ve.prototype.generate=VG;function Rt(n,e){this.x=e,this.q=n}function UG(n){return n==this?!0:this.q.equals(n.q)&&this.x.equals(n.x)}function GG(){return this.x}function WG(){return new Rt(this.q,this.x.negate().mod(this.q))}function KG(n){return new Rt(this.q,this.x.add(n.toBigInteger()).mod(this.q))}function $G(n){return new Rt(this.q,this.x.subtract(n.toBigInteger()).mod(this.q))}function XG(n){return new Rt(this.q,this.x.multiply(n.toBigInteger()).mod(this.q))}function JG(){return new Rt(this.q,this.x.square().mod(this.q))}function QG(n){return new Rt(this.q,this.x.multiply(n.toBigInteger().modInverse(this.q)).mod(this.q))}Rt.prototype.equals=UG;Rt.prototype.toBigInteger=GG;Rt.prototype.negate=WG;Rt.prototype.add=KG;Rt.prototype.subtract=$G;Rt.prototype.multiply=XG;Rt.prototype.square=JG;Rt.prototype.divide=QG;Rt.prototype.sqrt=function(){return new Rt(this.q,this.x.sqrt().mod(this.q))};function Le(n,e,t,r){this.curve=n,this.x=e,this.y=t,r==null?this.z=B.ONE:this.z=r,this.zinv=null}function YG(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function ZG(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function eW(n){if(n==this)return!0;if(this.isInfinity())return n.isInfinity();if(n.isInfinity())return this.isInfinity();var e,t;return e=n.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(n.z)).mod(this.curve.q),e.equals(B.ZERO)?(t=n.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(n.z)).mod(this.curve.q),t.equals(B.ZERO)):!1}function tW(){return this.x==null&&this.y==null?!0:this.z.equals(B.ZERO)&&!this.y.toBigInteger().equals(B.ZERO)}function nW(){return new Le(this.curve,this.x,this.y.negate(),this.z)}function rW(n){if(this.isInfinity())return n;if(n.isInfinity())return this;var e=n.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(n.z)).mod(this.curve.q),t=n.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(n.z)).mod(this.curve.q);if(B.ZERO.equals(t))return B.ZERO.equals(e)?this.twice():this.curve.getInfinity();var r=new B("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),s=n.x.toBigInteger(),a=n.y.toBigInteger(),c=t.square(),l=c.multiply(t),h=i.multiply(c),u=e.square().multiply(this.z),d=u.subtract(h.shiftLeft(1)).multiply(n.z).subtract(l).multiply(t).mod(this.curve.q),p=h.multiply(r).multiply(e).subtract(o.multiply(l)).subtract(u.multiply(e)).multiply(n.z).add(e.multiply(l)).mod(this.curve.q),m=l.multiply(this.z).multiply(n.z).mod(this.curve.q);return new Le(this.curve,this.curve.fromBigInteger(d),this.curve.fromBigInteger(p),m)}function iW(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var n=new B("3"),e=this.x.toBigInteger(),t=this.y.toBigInteger(),r=t.multiply(this.z),i=r.multiply(t).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=e.square().multiply(n);B.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o))),s=s.mod(this.curve.q);var a=s.square().subtract(e.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(r).mod(this.curve.q),c=s.multiply(n).multiply(e).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(s.square().multiply(s)).mod(this.curve.q),l=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new Le(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(c),l)}function oW(n){if(this.isInfinity())return this;if(n.signum()==0)return this.curve.getInfinity();var e=n,t=e.multiply(new B("3")),r=this.negate(),i=this,o=this.curve.q.subtract(n),s=o.multiply(new B("3")),a=new Le(this.curve,this.x,this.y),c=a.negate(),l;for(l=t.bitLength()-2;l>0;--l){i=i.twice();var h=t.testBit(l),u=e.testBit(l);h!=u&&(i=i.add(h?this:r))}for(l=s.bitLength()-2;l>0;--l){a=a.twice();var d=s.testBit(l),p=o.testBit(l);d!=p&&(a=a.add(d?a:c))}return i}function sW(n,e,t){var r;n.bitLength()>t.bitLength()?r=n.bitLength()-1:r=t.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(e);r>=0;)i=i.twice(),n.testBit(r)?t.testBit(r)?i=i.add(o):i=i.add(this):t.testBit(r)&&(i=i.add(e)),--r;return i}Le.prototype.getX=YG;Le.prototype.getY=ZG;Le.prototype.equals=eW;Le.prototype.isInfinity=tW;Le.prototype.negate=nW;Le.prototype.add=rW;Le.prototype.twice=iW;Le.prototype.multiply=oW;Le.prototype.multiplyTwo=sW;function ei(n,e,t){this.q=n,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(t),this.infinity=new Le(this,null,null)}function aW(){return this.q}function cW(){return this.a}function lW(){return this.b}function dW(n){return n==this?!0:this.q.equals(n.q)&&this.a.equals(n.a)&&this.b.equals(n.b)}function uW(){return this.infinity}function hW(n){return new Rt(this.q,n)}function pW(n){switch(parseInt(n.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var e=n.substr(0,2),t=n.substr(2),r=this.fromBigInteger(new B(l,16)),i=this.getA(),o=this.getB(),s=r.square().add(i).multiply(r).add(o),a=s.sqrt();return e=="03"&&(a=a.negate()),new Le(this,r,a);case 4:case 6:case 7:var c=(n.length-2)/2,l=n.substr(2,c),h=n.substr(c+2,c);return new Le(this,this.fromBigInteger(new B(l,16)),this.fromBigInteger(new B(h,16)));default:return null}}ei.prototype.getQ=aW;ei.prototype.getA=cW;ei.prototype.getB=lW;ei.prototype.equals=dW;ei.prototype.getInfinity=uW;ei.prototype.fromBigInteger=hW;ei.prototype.decodePointHex=pW;Rt.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};Le.prototype.getEncoded=function(n){var e=function(o,s){var a=o.toByteArrayUnsigned();if(s<a.length)a=a.slice(a.length-s);else for(;s>a.length;)a.unshift(0);return a},t=this.getX().toBigInteger(),r=this.getY().toBigInteger(),i=e(t,32);return n?r.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(e(r,32))),i};Le.decodeFrom=function(n,e){var t=e[0],r=e.length-1,i=e.slice(1,1+r/2),o=e.slice(1+r/2,1+r);i.unshift(0),o.unshift(0);var s=new B(i),a=new B(o);return new Le(n,n.fromBigInteger(s),n.fromBigInteger(a))};Le.decodeFromHex=function(n,e){var t=e.substr(0,2),r=e.length-2,i=e.substr(2,r/2),o=e.substr(2+r/2,r/2),s=new B(i,16),a=new B(o,16);return new Le(n,n.fromBigInteger(s),n.fromBigInteger(a))};Le.prototype.add2D=function(n){if(this.isInfinity())return n;if(n.isInfinity())return this;if(this.x.equals(n.x))return this.y.equals(n.y)?this.twice():this.curve.getInfinity();var e=n.x.subtract(this.x),t=n.y.subtract(this.y),r=t.divide(e),i=r.square().subtract(this.x).subtract(n.x),o=r.multiply(this.x.subtract(i)).subtract(this.y);return new Le(this.curve,i,o)};Le.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var n=this.curve.fromBigInteger(B.valueOf(2)),e=this.curve.fromBigInteger(B.valueOf(3)),t=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(n)),r=t.square().subtract(this.x.multiply(n)),i=t.multiply(this.x.subtract(r)).subtract(this.y);return new Le(this.curve,r,i)};Le.prototype.multiply2D=function(n){if(this.isInfinity())return this;if(n.signum()==0)return this.curve.getInfinity();var e=n,t=e.multiply(new B("3")),r=this.negate(),i=this,o;for(o=t.bitLength()-2;o>0;--o){i=i.twice();var s=t.testBit(o),a=e.testBit(o);s!=a&&(i=i.add2D(s?this:r))}return i};Le.prototype.isOnCurve=function(){var n=this.getX().toBigInteger(),e=this.getY().toBigInteger(),t=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=e.multiply(e).mod(i),s=n.multiply(n).multiply(n).add(t.multiply(n)).add(r).mod(i);return o.equals(s)};Le.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};Le.prototype.validate=function(){var n=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),t=this.getY().toBigInteger();if(e.compareTo(B.ONE)<0||e.compareTo(n.subtract(B.ONE))>0)throw new Error("x coordinate out of bounds");if(t.compareTo(B.ONE)<0||t.compareTo(n.subtract(B.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(n).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var uk=function(){var n="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",e='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',t='(?:"'+e+'*")',r=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+n+"|"+t+")","g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),o={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function s(u,d,p){return d?o[d]:String.fromCharCode(parseInt(p,16))}var a=new String(""),c="\\",l={"{":Object,"[":Array},h=Object.hasOwnProperty;return function(u,d){var p=u.match(r),m,g=p[0],x=!1;g==="{"?m={}:g==="["?m=[]:(m=[],x=!0);for(var b,_=[m],O=1-x,S=p.length;O<S;++O){g=p[O];var E;switch(g.charCodeAt(0)){default:E=_[0],E[b||E.length]=+g,b=void 0;break;case 34:if(g=g.substring(1,g.length-1),g.indexOf(c)!==-1&&(g=g.replace(i,s)),E=_[0],!b)if(E instanceof Array)b=E.length;else{b=g||a;break}E[b]=g,b=void 0;break;case 91:E=_[0],_.unshift(E[b||E.length]=[]),b=void 0;break;case 93:_.shift();break;case 102:E=_[0],E[b||E.length]=!1,b=void 0;break;case 110:E=_[0],E[b||E.length]=null,b=void 0;break;case 116:E=_[0],E[b||E.length]=!0,b=void 0;break;case 123:E=_[0],_.unshift(E[b||E.length]={}),b=void 0;break;case 125:_.shift();break}}if(x){if(_.length!==1)throw new Error;m=m[0]}else if(_.length)throw new Error;if(d){var D=function(I,y){var P=I[y];if(P&&typeof P=="object"){var C=null;for(var M in P)if(h.call(P,M)&&P!==I){var A=D(P,M);A!==void 0?P[M]=A:(C||(C=[]),C.push(M))}if(C)for(var F=C.length;--F>=0;)delete P[C[F]]}return d.call(I,y,P)};m=D({"":m},"")}return m}}();(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});f.asn1.ASN1Util=new function(){this.integerToByteHex=function(n){var e=n.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(n){return dl(n)},this.getPEMStringFromHex=function(n,e){return dn(n,e)},this.newObject=function(n){var e=f,t=e.asn1,r=t.ASN1Object,i=t.DERBoolean,o=t.DERInteger,s=t.DERBitString,a=t.DEROctetString,c=t.DERNull,l=t.DERObjectIdentifier,h=t.DEREnumerated,u=t.DERUTF8String,d=t.DERNumericString,p=t.DERPrintableString,m=t.DERTeletexString,g=t.DERIA5String,x=t.DERUTCTime,b=t.DERGeneralizedTime,_=t.DERVisibleString,O=t.DERBMPString,S=t.DERSequence,E=t.DERSet,D=t.DERTaggedObject,I=t.ASN1Util.newObject;if(n instanceof t.ASN1Object)return n;var y=Object.keys(n);if(y.length!=1)throw new Error("key of param shall be only one.");var P=y[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+P+":")==-1)throw new Error("undefined key: "+P);if(P=="bool")return new i(n[P]);if(P=="int")return new o(n[P]);if(P=="bitstr")return new s(n[P]);if(P=="octstr")return new a(n[P]);if(P=="null")return new c(n[P]);if(P=="oid")return new l(n[P]);if(P=="enum")return new h(n[P]);if(P=="utf8str")return new u(n[P]);if(P=="numstr")return new d(n[P]);if(P=="prnstr")return new p(n[P]);if(P=="telstr")return new m(n[P]);if(P=="ia5str")return new g(n[P]);if(P=="utctime")return new x(n[P]);if(P=="gentime")return new b(n[P]);if(P=="visstr")return new _(n[P]);if(P=="bmpstr")return new O(n[P]);if(P=="asn1")return new r(n[P]);if(P=="seq"){for(var C=n[P],M=[],A=0;A<C.length;A++){var F=I(C[A]);M.push(F)}return new S({array:M})}if(P=="set"){for(var C=n[P],M=[],A=0;A<C.length;A++){var F=I(C[A]);M.push(F)}return new E({array:M})}if(P=="tag"){var k=n[P];if(Object.prototype.toString.call(k)==="[object Array]"&&k.length==3){var T=I(k[2]);return new D({tag:k[0],explicit:k[1],obj:T})}else return new D(k)}},this.jsonToASN1HEX=function(n){var e=this.newObject(n);return e.tohex()}};f.asn1.ASN1Util.oidHexToInt=function(n){for(var i="",e=parseInt(n.substr(0,2),16),t=Math.floor(e/40),r=e%40,i=t+"."+r,o="",s=2;s<n.length;s+=2){var a=parseInt(n.substr(s,2),16),c=("00000000"+a.toString(2)).slice(-8);if(o=o+c.substr(1,7),c.substr(0,1)=="0"){var l=new B(o,2);i=i+"."+l.toString(10),o=""}}return i};f.asn1.ASN1Util.oidIntToHex=function(n){var e=function(a){var c=a.toString(16);return c.length==1&&(c="0"+c),c},t=function(a){var c="",l=new B(a,10),h=l.toString(2),u=7-h.length%7;u==7&&(u=0);for(var d="",p=0;p<u;p++)d+="0";h=d+h;for(var p=0;p<h.length-1;p+=7){var m=h.substr(p,7);p!=h.length-7&&(m="1"+m),c+=e(parseInt(m,2))}return c};if(!n.match(/^[0-9.]+$/))throw"malformed oid string: "+n;var r="",i=n.split("."),o=parseInt(i[0])*40+parseInt(i[1]);r+=e(o),i.splice(0,2);for(var s=0;s<i.length;s++)r+=t(i[s]);return r};f.asn1.ASN1Object=function(n){var e=!0,t=null,r="00",i="00",o="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+o.length+",v="+this.hV);var s=this.hV.length/2,a=s.toString(16);if(a.length%2==1&&(a="0"+a),s<128)return a;var c=a.length/2;if(c>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+s.toString(16));var l=128+c;return l.toString(16)+a},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(s){this.params=s},n!=null&&n.tlv!=null&&(this.hTLV=n.tlv,this.isModified=!1)};f.asn1.DERAbstractString=function(n){f.asn1.DERAbstractString.superclass.constructor.call(this);var e=null,t=null;this.getString=function(){return this.s},this.setString=function(r){this.hTLV=null,this.isModified=!0,this.s=r,this.hV=pp(this.s).toLowerCase()},this.setStringHex=function(r){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n=="string"?this.setString(n):typeof n.str<"u"?this.setString(n.str):typeof n.hex<"u"&&this.setStringHex(n.hex))};H(f.asn1.DERAbstractString,f.asn1.ASN1Object);f.asn1.DERAbstractTime=function(n){f.asn1.DERAbstractTime.superclass.constructor.call(this);var e=null,t=null;this.localDateToUTC=function(r){var i=r.getTime()+r.getTimezoneOffset()*6e4,o=new Date(i);return o},this.formatDate=function(r,i,o){var s=this.zeroPadding,a=this.localDateToUTC(r),c=String(a.getFullYear());i=="utc"&&(c=c.substr(2,2));var l=s(String(a.getMonth()+1),2),h=s(String(a.getDate()),2),u=s(String(a.getHours()),2),d=s(String(a.getMinutes()),2),p=s(String(a.getSeconds()),2),m=c+l+h+u+d+p;if(o===!0){var g=a.getMilliseconds();if(g!=0){var x=s(String(g),3);x=x.replace(/[0]+$/,""),m=m+"."+x}}return m+"Z"},this.zeroPadding=function(r,i){return r.length>=i?r:new Array(i-r.length+1).join("0")+r},this.setByParam=function(r){this.hV=null,this.hTLV=null,this.params=r},this.getString=function(){},this.setString=function(r){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=r},this.setByDate=function(r){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=r},this.setByDateValue=function(r,i,o,s,a,c){var l=new Date(Date.UTC(r,i-1,o,s,a,c,0));this.setByDate(l)},this.getFreshValueHex=function(){return this.hV}};H(f.asn1.DERAbstractTime,f.asn1.ASN1Object);f.asn1.DERAbstractStructured=function(n){f.asn1.DERAbstractString.superclass.constructor.call(this);var e=null;this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,typeof n<"u"&&typeof n.array<"u"&&(this.asn1Array=n.array)};H(f.asn1.DERAbstractStructured,f.asn1.ASN1Object);f.asn1.DERBoolean=function(n){f.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",n==!1?this.hTLV="010100":this.hTLV="0101ff"};H(f.asn1.DERBoolean,f.asn1.ASN1Object);f.asn1.DERInteger=function(n){f.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var e=dl;this.setByBigInteger=function(t){this.isModified=!0,this.params={bigint:t}},this.setByInteger=function(t){this.isModified=!0,this.params=t},this.setValueHex=function(t){this.isModified=!0,this.params={hex:t}},this.getFreshValueHex=function(){var t=this.params,r=null;if(t==null)throw new Error("value not set");if(typeof t=="object"&&t.hex!=null)return this.hV=t.hex,this.hV;if(typeof t=="number")r=new B(String(t),10);else if(t.int!=null)r=new B(String(t.int),10);else if(t.bigint!=null)r=t.bigint;else throw new Error("wrong parameter");return this.hV=e(r),this.hV},n!=null&&(this.params=n)};H(f.asn1.DERInteger,f.asn1.ASN1Object);f.asn1.DERBitString=function(n){if(n!==void 0&&typeof n.obj<"u"){var e=f.asn1.ASN1Util.newObject(n.obj);n.hex="00"+e.tohex()}f.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,r){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+r},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var r=8-t.length%8;r==8&&(r=0),t+="0000000".substr(0,r);for(var i="",o=0;o<t.length-1;o+=8){var s=t.substr(o,8),a=parseInt(s,2).toString(16);a.length==1&&(a="0"+a),i+=a}this.hTLV=null,this.isModified=!0,this.hV="0"+r+i},this.setByBooleanArray=function(t){for(var r="",i=0;i<t.length;i++)t[i]==!0?r+="1":r+="0";this.setByBinaryString(r)},this.newFalseArray=function(t){for(var r=new Array(t),i=0;i<t;i++)r[i]=!1;return r},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n=="string"&&n.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(n):typeof n.hex<"u"?this.setHexValueIncludingUnusedBits(n.hex):typeof n.bin<"u"?this.setByBinaryString(n.bin):typeof n.array<"u"&&this.setByBooleanArray(n.array))};H(f.asn1.DERBitString,f.asn1.ASN1Object);f.asn1.DEROctetString=function(n){if(n!==void 0&&typeof n.obj<"u"){var e=f.asn1.ASN1Util.newObject(n.obj);n.hex=e.tohex()}f.asn1.DEROctetString.superclass.constructor.call(this,n),this.hT="04"};H(f.asn1.DEROctetString,f.asn1.DERAbstractString);f.asn1.DERNull=function(){f.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};H(f.asn1.DERNull,f.asn1.ASN1Object);f.asn1.DERObjectIdentifier=function(n){f.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=bk(e);if(t==null)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=f.asn1.x509.OID.name2oid(e);if(t!=="")this.setValueOidString(t);else throw new Error("DERObjectIdentifier oidName undefined: "+e)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){typeof e=="string"?this.setValueNameOrOid(e):e.oid!==void 0?this.setValueNameOrOid(e.oid):e.name!==void 0?this.setValueNameOrOid(e.name):e.hex!==void 0&&this.setValueHex(e.hex)},n!==void 0&&this.setByParam(n)};H(f.asn1.DERObjectIdentifier,f.asn1.ASN1Object);f.asn1.DEREnumerated=function(n){f.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=dl(e)},this.setByInteger=function(e){var t=new B(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n.int<"u"?this.setByInteger(n.int):typeof n=="number"?this.setByInteger(n):typeof n.hex<"u"&&this.setValueHex(n.hex))};H(f.asn1.DEREnumerated,f.asn1.ASN1Object);f.asn1.DERUTF8String=function(n){f.asn1.DERUTF8String.superclass.constructor.call(this,n),this.hT="0c"};H(f.asn1.DERUTF8String,f.asn1.DERAbstractString);f.asn1.DERNumericString=function(n){f.asn1.DERNumericString.superclass.constructor.call(this,n),this.hT="12"};H(f.asn1.DERNumericString,f.asn1.DERAbstractString);f.asn1.DERPrintableString=function(n){f.asn1.DERPrintableString.superclass.constructor.call(this,n),this.hT="13"};H(f.asn1.DERPrintableString,f.asn1.DERAbstractString);f.asn1.DERTeletexString=function(n){f.asn1.DERTeletexString.superclass.constructor.call(this,n),this.hT="14"};H(f.asn1.DERTeletexString,f.asn1.DERAbstractString);f.asn1.DERIA5String=function(n){f.asn1.DERIA5String.superclass.constructor.call(this,n),this.hT="16"};H(f.asn1.DERIA5String,f.asn1.DERAbstractString);f.asn1.DERVisibleString=function(n){f.asn1.DERIA5String.superclass.constructor.call(this,n),this.hT="1a"};H(f.asn1.DERVisibleString,f.asn1.DERAbstractString);f.asn1.DERBMPString=function(n){f.asn1.DERBMPString.superclass.constructor.call(this,n),this.hT="1e"};H(f.asn1.DERBMPString,f.asn1.DERAbstractString);f.asn1.DERUTCTime=function(n){f.asn1.DERUTCTime.superclass.constructor.call(this,n),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var e=this.params;if(this.params==null&&(e={date:new Date}),typeof e=="string")if(e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=zn(e);else throw new Error("malformed string for UTCTime: "+e);else if(e.str!=null)this.hV=zn(e.str);else if(e.date==null&&e.millis==!0){var t=new Date;this.hV=zn(this.formatDate(t,"utc",!0))}else if(e.date!=null&&e.date instanceof Date){var r=e.millis===!0;this.hV=zn(this.formatDate(e.date,"utc",r))}else e instanceof Date&&(this.hV=zn(this.formatDate(e,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},n!=null&&this.setByParam(n)};H(f.asn1.DERUTCTime,f.asn1.DERAbstractTime);f.asn1.DERGeneralizedTime=function(n){f.asn1.DERGeneralizedTime.superclass.constructor.call(this,n),this.hT="18",this.params=n,this.getFreshValueHex=function(){var e=this.params;if(this.params==null&&(e={date:new Date}),typeof e=="string")if(e.match(/^[0-9]{14}Z$/)||e.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=zn(e);else throw new Error("malformed string for GeneralizedTime: "+e);else if(e.str!=null)this.hV=zn(e.str);else if(e.date==null&&e.millis==!0){var t=new Date;this.hV=zn(this.formatDate(t,"gen",!0))}else if(e.date!=null&&e.date instanceof Date){var r=e.millis===!0;this.hV=zn(this.formatDate(e.date,"gen",r))}else e instanceof Date&&(this.hV=zn(this.formatDate(e,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},n!=null&&this.setByParam(n)};H(f.asn1.DERGeneralizedTime,f.asn1.DERAbstractTime);f.asn1.DERSequence=function(n){f.asn1.DERSequence.superclass.constructor.call(this,n),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e+=r.tohex()}return this.hV=e,this.hV}};H(f.asn1.DERSequence,f.asn1.DERAbstractStructured);f.asn1.DERSet=function(n){f.asn1.DERSet.superclass.constructor.call(this,n),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.tohex())}return this.sortFlag==!0&&e.sort(),this.hV=e.join(""),this.hV},typeof n<"u"&&typeof n.sortflag<"u"&&n.sortflag==!1&&(this.sortFlag=!1)};H(f.asn1.DERSet,f.asn1.DERAbstractStructured);f.asn1.DERTaggedObject=function(n){f.asn1.DERTaggedObject.superclass.constructor.call(this);var e=f.asn1,t=$,r=t.getV,i=t.isASN1HEX,o=e.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(s,a,c){this.params={tag:a,explicit:s,obj:c}},this.getFreshValueHex=function(){var s=this.params;if(s.explicit==null&&(s.explicit=!0),s.tage!=null&&(s.tag=s.tage,s.explicit=!0),s.tagi!=null&&(s.tag=s.tagi,s.explicit=!1),s.str!=null)this.hV=pp(s.str);else if(s.hex!=null)this.hV=s.hex;else if(s.obj!=null){var a;s.obj instanceof e.ASN1Object?a=s.obj.tohex():typeof s.obj=="object"&&(a=o(s.obj).tohex()),s.explicit?this.hV=a:this.hV=r(a,0)}else throw new Error("str, hex nor obj not specified");return s.tag==null&&(s.tag="a0"),this.hT=s.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(s){this.params=s},n!==void 0&&this.setByParam(n)};H(f.asn1.DERTaggedObject,f.asn1.ASN1Object);var $=new function(){};$.getLblen=function(n,e){if(n.substr(e+2,1)!="8")return 1;var t=parseInt(n.substr(e+3,1));return t==0?-1:0<t&&t<10?t+1:-2};$.getL=function(n,e){var t=$.getLblen(n,e);return t<1?"":n.substr(e+2,t*2)};$.getVblen=function(n,e){var t,r;return t=$.getL(n,e),t==""?-1:(t.substr(0,1)==="8"?r=new B(t.substr(2),16):r=new B(t,16),r.intValue())};$.getVidx=function(n,e){var t=$.getLblen(n,e);return t<0?t:e+(t+1)*2};$.getV=function(n,e){var t=$.getVidx(n,e),r=$.getVblen(n,e);return n.substr(t,r*2)};$.getTLV=function(n,e){return n.substr(e,2)+$.getL(n,e)+$.getV(n,e)};$.getTLVblen=function(n,e){return 2+$.getLblen(n,e)*2+$.getVblen(n,e)*2};$.getNextSiblingIdx=function(n,e){var t=$.getVidx(n,e),r=$.getVblen(n,e);return t+r*2};$.getChildIdx=function(n,e){var t=$,r=[],i,o,s;i=t.getVidx(n,e),o=t.getVblen(n,e)*2,n.substr(e,2)=="03"&&(i+=2,o-=2),s=0;for(var a=i;s<=o;){var c=t.getTLVblen(n,a);if(s+=c,s<=o&&r.push(a),a+=c,s>=o)break}return r};$.getNthChildIdx=function(n,e,t){var r=$.getChildIdx(n,e);return r[t]};$.getIdxbyList=function(n,e,t,r){var i=$,o,s;return t.length==0?r!==void 0&&n.substr(e,2)!==r?-1:e:(o=t.shift(),s=i.getChildIdx(n,e),o>=s.length?-1:i.getIdxbyList(n,s[o],t,r))};$.getIdxbyListEx=function(n,e,t,r){var i=$,o,s;if(t.length==0)return r!==void 0&&n.substr(e,2)!==r?-1:e;o=t.shift(),s=i.getChildIdx(n,e);for(var a=0,c=0;c<s.length;c++){var l=n.substr(s[c],2);if(typeof o=="number"&&!i.isContextTag(l)&&a==o||typeof o=="string"&&i.isContextTag(l,o))return i.getIdxbyListEx(n,s[c],t,r);i.isContextTag(l)||a++}return-1};$.getTLVbyList=function(n,e,t,r){var i=$,o=i.getIdxbyList(n,e,t,r);return o==-1||o>=n.length?null:i.getTLV(n,o)};$.getTLVbyListEx=function(n,e,t,r){var i=$,o=i.getIdxbyListEx(n,e,t,r);return o==-1?null:i.getTLV(n,o)};$.getVbyList=function(n,e,t,r,i){var o=$,s,a;return s=o.getIdxbyList(n,e,t,r),s==-1||s>=n.length?null:(a=o.getV(n,s),i===!0&&(a=a.substr(2)),a)};$.getVbyListEx=function(n,e,t,r,i){var o=$,s,a,c;return s=o.getIdxbyListEx(n,e,t,r),s==-1?null:(c=o.getV(n,s),n.substr(s,2)=="03"&&i!==!1&&(c=c.substr(2)),c)};$.getInt=function(n,e,t){t==null&&(t=-1);try{var r=n.substr(e,2);if(r!="02"&&r!="03")return t;var i=$.getV(n,e);return r=="02"?parseInt(i,16):_k(i)}catch{return t}};$.getOID=function(n,e,t){t==null&&(t=null);try{if(n.substr(e,2)!="06")return t;var r=$.getV(n,e);return bp(r)}catch{return t}};$.getOIDName=function(n,e,t){t==null&&(t=null);try{var r=$.getOID(n,e,t);if(r==t)return t;var i=f.asn1.x509.OID.oid2name(r);return i==""?r:i}catch{return t}};$.getString=function(n,e,t){t==null&&(t=null);try{var r=$.getV(n,e);return In(r)}catch{return t}};$.hextooidstr=function(n){var e=function(u,d){return u.length>=d?u:new Array(d-u.length+1).join("0")+u},t=[],r=n.substr(0,2),i=parseInt(r,16);t[0]=new String(Math.floor(i/40)),t[1]=new String(i%40);for(var o=n.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(a*2,2),16));for(var c=[],l="",a=0;a<s.length;a++)s[a]&128?l=l+e((s[a]&127).toString(2),7):(l=l+e((s[a]&127).toString(2),7),c.push(new String(parseInt(l,2))),l="");var h=t.join(".");return c.length>0&&(h=h+"."+c.join(".")),h};$.dump=function(n,e,t,r){var i=$,o=i.getV,s=i.dump,a=i.getChildIdx,c=n;n instanceof f.asn1.ASN1Object&&(c=n.tohex());var l=function(I,y){if(I.length<=y*2)return I;var P=I.substr(0,y)+"..(total "+I.length/2+"bytes).."+I.substr(I.length-y,y);return P};e===void 0&&(e={ommit_long_octet:32}),t===void 0&&(t=0),r===void 0&&(r="");var h=e.ommit_long_octet,E=c.substr(t,2);if(E=="01"){var u=o(c,t);return u=="00"?r+`BOOLEAN FALSE
`:r+`BOOLEAN TRUE
`}if(E=="02"){var u=o(c,t);return r+"INTEGER "+l(u,h)+`
`}if(E=="03"){var u=o(c,t);if(i.isASN1HEX(u.substr(2))){var d=r+`BITSTRING, encapsulates
`;return d=d+s(u.substr(2),e,0,r+"  "),d}else return r+"BITSTRING "+l(u,h)+`
`}if(E=="04"){var u=o(c,t);if(i.isASN1HEX(u)){var d=r+`OCTETSTRING, encapsulates
`;return d=d+s(u,e,0,r+"  "),d}else return r+"OCTETSTRING "+l(u,h)+`
`}if(E=="05")return r+`NULL
`;if(E=="06"){var p=o(c,t),m=f.asn1.ASN1Util.oidHexToInt(p),g=f.asn1.x509.OID.oid2name(m),x=m.replace(/\./g," ");return g!=""?r+"ObjectIdentifier "+g+" ("+x+`)
`:r+"ObjectIdentifier ("+x+`)
`}if(E=="0a")return r+"ENUMERATED "+parseInt(o(c,t))+`
`;if(E=="0c")return r+"UTF8String '"+Ve(o(c,t))+`'
`;if(E=="13")return r+"PrintableString '"+Ve(o(c,t))+`'
`;if(E=="14")return r+"TeletexString '"+Ve(o(c,t))+`'
`;if(E=="16")return r+"IA5String '"+Ve(o(c,t))+`'
`;if(E=="17")return r+"UTCTime "+Ve(o(c,t))+`
`;if(E=="18")return r+"GeneralizedTime "+Ve(o(c,t))+`
`;if(E=="1a")return r+"VisualString '"+Ve(o(c,t))+`'
`;if(E=="1e")return r+"BMPString '"+j0(o(c,t))+`'
`;if(E=="30"){if(c.substr(t,4)=="3000")return r+`SEQUENCE {}
`;var d=r+`SEQUENCE
`,b=a(c,t),_=e;if((b.length==2||b.length==3)&&c.substr(b[0],2)=="06"&&c.substr(b[b.length-1],2)=="04"){var g=i.oidname(o(c,b[0])),O=JSON.parse(JSON.stringify(e));O.x509ExtName=g,_=O}for(var S=0;S<b.length;S++)d=d+s(c,_,b[S],r+"  ");return d}if(E=="31"){for(var d=r+`SET
`,b=a(c,t),S=0;S<b.length;S++)d=d+s(c,e,b[S],r+"  ");return d}var E=parseInt(E,16);if(E&128){var D=E&31;if(E&32){for(var d=r+"["+D+`]
`,b=a(c,t),S=0;S<b.length;S++)d=d+s(c,e,b[S],r+"  ");return d}else{var u=o(c,t);if($.isASN1HEX(u)){var d=r+"["+D+`]
`;return d=d+s(u,e,0,r+"  "),d}else(u.substr(0,8)=="68747470"||e.x509ExtName==="subjectAltName"&&D==2)&&(u=Ve(u));var d=r+"["+D+"] "+u+`
`;return d}}return r+"UNKNOWN("+E+") "+o(c,t)+`
`};$.parse=function(n){var e=$,t=e.parse,r=e.isASN1HEX,i=e.getV,o=e.getTLV,s=e.getChildIdx,a=f.asn1,c=a.ASN1Util.oidHexToInt,l=a.x509.OID.oid2name,h=Ve,u=j0,d=xW,p={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},m=function(P){for(var C=[],M=s(P,0),A=0;A<M.length;A++){var F=M[A],k=o(P,F),T=t(k);C.push(T)}return C},g=n.substr(0,2),x={},b=i(n,0);if(g=="01")return n=="0101ff"?{bool:!0}:{bool:!1};if(g=="02")return{int:{hex:b}};if(g=="03")try{if(b.substr(0,2)!="00")throw"not encap";var _=b.substr(2);if(!r(_))throw"not encap";return{bitstr:{obj:t(_)}}}catch{var O=null;return b.length<=10&&(O=Ck(b)),O==null?{bitstr:{hex:b}}:{bitstr:{bin:O}}}else if(g=="04")try{if(!r(b))throw"not encap";return{octstr:{obj:t(b)}}}catch{return{octstr:{hex:b}}}else{if(g=="05")return{null:""};if(g=="06"){var S=c(b),E=l(S);return E==""?{oid:S}:{oid:E}}else{if(g=="0a")return b.length>4?{enum:{hex:b}}:{enum:parseInt(b,16)};if(g=="30"||g=="31")return x[p[g]]=m(n),x;if(g=="14"){var D=d(b);return x[p[g]]={str:D},x}else if(g=="1e"){var D=u(b);return x[p[g]]={str:D},x}else if(":0c:12:13:16:17:18:1a:".indexOf(g)!=-1){var D=h(b);return x[p[g]]={str:D},x}else if(g.match(/^8[0-9]$/)){var D=h(b);return D==null|D==""?{tag:{tag:g,explicit:!1,hex:b}}:D.match(/[\x00-\x1F\x7F-\x9F]/)!=null||D.match(/[\u0000-\u001F\u0080–\u009F]/)!=null?{tag:{tag:g,explicit:!1,hex:b}}:{tag:{tag:g,explicit:!1,str:D}}}else if(g.match(/^a[0-9]$/))try{if(!r(b))throw new Error("not encap");return{tag:{tag:g,explicit:!0,obj:t(b)}}}catch{return{tag:{tag:g,explicit:!0,hex:b}}}else{var I=new f.asn1.ASN1Object;I.hV=b;var y=I.getLengthHexFromValue();return{asn1:{tlv:g+y+b}}}}}};$.isContextTag=function(n,e){n=n.toLowerCase();var t,r;try{t=parseInt(n,16)}catch{return-1}if(e===void 0)return(t&192)==128;try{var i=e.match(/^\[[0-9]+\]$/);return i==null||(r=parseInt(e.substr(1,e.length-1),10),r>31)?!1:(t&192)==128&&(t&31)==r}catch{return!1}};$.isASN1HEX=function(n){var e=$;if(n.length%2==1)return!1;var t=e.getVblen(n,0),r=n.substr(0,2),i=e.getL(n,0),o=n.length-r.length-i.length;return o==t*2};$.checkStrictDER=function(n,e,t,r,i){var o=$;if(t===void 0){if(typeof n!="string")throw new Error("not hex string");if(n=n.toLowerCase(),!f.lang.String.isHex(n))throw new Error("not hex string");t=n.length,r=n.length/2,r<128?i=1:i=Math.ceil(r.toString(16))+1}var s=o.getL(n,e);if(s.length>i*2)throw new Error("L of TLV too long: idx="+e);var a=o.getVblen(n,e);if(a>r)throw new Error("value of L too long than hex: idx="+e);var c=o.getTLV(n,e),l=c.length-2-o.getL(n,e).length;if(l!==a*2)throw new Error("V string length and L's value not the same:"+l+"/"+a*2);if(e===0&&n.length!=c.length)throw new Error("total length and TLV length unmatch:"+n.length+"!="+c.length);var h=n.substr(e,2);if(h==="02"){var u=o.getVidx(n,e);if(n.substr(u,2)=="00"&&n.charCodeAt(u+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(h,16)&32){for(var d=o.getVblen(n,e),p=0,m=o.getChildIdx(n,e),g=0;g<m.length;g++){var x=o.getTLV(n,m[g]);p+=x.length,o.checkStrictDER(n,m[g],t,r,i)}if(d*2!=p)throw new Error("sum of children's TLV length and L unmatch: "+d*2+"!="+p)}};$.oidname=function(n){var e=f.asn1;f.lang.String.isHex(n)&&(n=e.ASN1Util.oidHexToInt(n));var t=e.x509.OID.oid2name(n);return t===""&&(t=n),t};(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});(typeof f.asn1.x509>"u"||!f.asn1.x509)&&(f.asn1.x509={});f.asn1.x509.Certificate=function(n){f.asn1.x509.Certificate.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.x509,s=o.TBSCertificate,a=o.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,l=c.sigalg;c.sigalg.name!=null&&(l=c.sigalg.name);var h=c.tbsobj.tohex(),u=new f.crypto.Signature({alg:l});u.init(c.cakey),u.updateHex(h),c.sighex=u.sign()},this.getPEM=function(){return dn(this.tohex(),"CERTIFICATE")},this.tohex=function(){var c=this.params;if((c.tbsobj==null||c.tbsobj==null)&&(c.tbsobj=new s(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(c.tbsobj),l.push(new a({name:c.sigalg})),l.push(new r({hex:"00"+c.sighex}));var h=new i({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&(this.params=n)};H(f.asn1.x509.Certificate,f.asn1.ASN1Object);f.asn1.x509.TBSCertificate=function(n){f.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.x509,i=t.DERTaggedObject,o=t.DERInteger,s=t.DERSequence,a=r.AlgorithmIdentifier,c=r.Time,l=r.X500Name,h=r.Extensions,u=r.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(d){this.params=d},this.tohex=function(){var d=[],p=this.params;if(p.version!=null||p.version!=1){var m=2;p.version!=null&&(m=p.version-1);var g=new i({obj:new o({int:m})});d.push(g)}d.push(new o(p.serial)),d.push(new a({name:p.sigalg})),d.push(new l(p.issuer)),d.push(new s({array:[new c(p.notbefore),new c(p.notafter)]})),d.push(new l(p.subject)),d.push(new u(Me.getKey(p.sbjpubkey))),p.ext!==void 0&&p.ext.length>0&&d.push(new i({tag:"a3",obj:new h(p.ext)}));var x=new f.asn1.DERSequence({array:d});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.TBSCertificate,f.asn1.ASN1Object);f.asn1.x509.Extensions=function(n){f.asn1.x509.Extensions.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.DERSequence,i=t.x509;this.aParam=[],this.setByParam=function(o){this.aParam=o},this.tohex=function(){for(var o=[],s=0;s<this.aParam.length;s++){var a=this.aParam[s],c=a.extname,l=null;if(a.extn!=null)l=new i.PrivateExtension(a);else if(c=="subjectKeyIdentifier")l=new i.SubjectKeyIdentifier(a);else if(c=="keyUsage")l=new i.KeyUsage(a);else if(c=="subjectAltName")l=new i.SubjectAltName(a);else if(c=="issuerAltName")l=new i.IssuerAltName(a);else if(c=="basicConstraints")l=new i.BasicConstraints(a);else if(c=="nameConstraints")l=new i.NameConstraints(a);else if(c=="cRLDistributionPoints")l=new i.CRLDistributionPoints(a);else if(c=="certificatePolicies")l=new i.CertificatePolicies(a);else if(c=="policyMappings")l=new i.PolicyMappings(a);else if(c=="policyConstraints")l=new i.PolicyConstraints(a);else if(c=="inhibitAnyPolicy")l=new i.InhibitAnyPolicy(a);else if(c=="authorityKeyIdentifier")l=new i.AuthorityKeyIdentifier(a);else if(c=="extKeyUsage")l=new i.ExtKeyUsage(a);else if(c=="authorityInfoAccess")l=new i.AuthorityInfoAccess(a);else if(c=="cRLNumber")l=new i.CRLNumber(a);else if(c=="cRLReason")l=new i.CRLReason(a);else if(c=="ocspNonce")l=new i.OCSPNonce(a);else if(c=="ocspNoCheck")l=new i.OCSPNoCheck(a);else if(c=="adobeTimeStamp")l=new i.AdobeTimeStamp(a);else if(c=="subjectDirectoryAttributes")l=new i.SubjectDirectoryAttributes(a);else throw new Error("extension not supported:"+JSON.stringify(a));l!=null&&o.push(l)}var h=new r({array:o});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.x509.Extensions,f.asn1.ASN1Object);f.asn1.x509.Extension=function(n){f.asn1.x509.Extension.superclass.constructor.call(this);var e=null,t=f,r=t.asn1,i=r.DERObjectIdentifier,o=r.DEROctetString,s=r.DERBitString,a=r.DERBoolean,c=r.DERSequence;this.tohex=function(){var l=new i({oid:this.oid}),h=new o({hex:this.getExtnValueHex()}),u=new Array;u.push(l),this.critical&&u.push(new a),u.push(h);var d=new c({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,n!==void 0&&n.critical!==void 0&&(this.critical=n.critical)};H(f.asn1.x509.Extension,f.asn1.ASN1Object);f.asn1.x509.KeyUsage=function(n){f.asn1.x509.KeyUsage.superclass.constructor.call(this,n);var e=Error,t={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var r=this.getBinValue();return this.asn1ExtnValue=new f.asn1.DERBitString({bin:r}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var r=this.params;if(typeof r!="object"||typeof r.names!="object"&&typeof r.bin!="string")throw new e("parameter not yet set");if(r.names!=null)return lp(r.names,t);if(r.bin!=null)return r.bin;throw new e("parameter not set properly")},this.oid="2.5.29.15",n!==void 0&&(this.params=n)};H(f.asn1.x509.KeyUsage,f.asn1.x509.Extension);f.asn1.x509.BasicConstraints=function(n){f.asn1.x509.BasicConstraints.superclass.constructor.call(this,n);var e=f.asn1,t=e.DERBoolean,r=e.DERInteger,i=e.DERSequence,o=!1,s=-1;this.getExtnValueHex=function(){var a=new Array;this.cA&&a.push(new t),this.pathLen>-1&&a.push(new r({int:this.pathLen}));var c=new i({array:a});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,n!==void 0&&(n.cA!==void 0&&(this.cA=n.cA),n.pathLen!==void 0&&(this.pathLen=n.pathLen))};H(f.asn1.x509.BasicConstraints,f.asn1.x509.Extension);f.asn1.x509.CRLDistributionPoints=function(n){f.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(i){for(var o=[],s=0;s<i.length;s++)if(i[s]instanceof f.asn1.ASN1Object)o.push(i[s]);else{var a=new r.DistributionPoint(i[s]);o.push(a)}this.asn1ExtnValue=new t.DERSequence({array:o})},this.setByOneURI=function(i){var o=new r.DistributionPoint({fulluri:i});this.setByDPArray([o])},this.oid="2.5.29.31",n!==void 0&&(n.array!==void 0?this.setByDPArray(n.array):n.uri!==void 0&&this.setByOneURI(n.uri))};H(f.asn1.x509.CRLDistributionPoints,f.asn1.x509.Extension);f.asn1.x509.DistributionPoint=function(n){f.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=null,t=f,r=t.asn1,i=r.x509.DistributionPointName;this.tohex=function(){var o=new r.DERSequence;if(this.asn1DP!=null){var s=new r.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});o.appendASN1Object(s)}return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.dpobj!==void 0?this.asn1DP=n.dpobj:n.dpname!==void 0?this.asn1DP=new i(n.dpname):n.fulluri!==void 0&&(this.asn1DP=new i({full:[{uri:n.fulluri}]})))};H(f.asn1.x509.DistributionPoint,f.asn1.ASN1Object);f.asn1.x509.DistributionPointName=function(n){f.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=null,t=null,r=null,i=null,o=f,s=o.asn1,a=s.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new a({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0)if(s.x509.GeneralNames.prototype.isPrototypeOf(n))this.type="full",this.tag="a0",this.asn1V=n;else if(n.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new s.x509.GeneralNames(n.full);else throw new Error("This class supports GeneralNames only as argument")};H(f.asn1.x509.DistributionPointName,f.asn1.ASN1Object);f.asn1.x509.CertificatePolicies=function(n){f.asn1.x509.CertificatePolicies.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509,i=t.DERSequence,o=r.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var s=[],a=0;a<this.params.array.length;a++)s.push(new o(this.params.array[a]));var c=new i({array:s});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",n!==void 0&&(this.params=n)};H(f.asn1.x509.CertificatePolicies,f.asn1.x509.Extension);f.asn1.x509.PolicyInformation=function(n){f.asn1.x509.PolicyInformation.superclass.constructor.call(this,n);var e=f.asn1,t=e.DERSequence,r=e.DERObjectIdentifier,i=e.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var o=[new r(this.params.policyoid)];if(this.params.array!==void 0){for(var s=[],a=0;a<this.params.array.length;a++)s.push(new i(this.params.array[a]));s.length>0&&o.push(new t({array:s}))}var c=new t({array:o});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};H(f.asn1.x509.PolicyInformation,f.asn1.ASN1Object);f.asn1.x509.PolicyQualifierInfo=function(n){f.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,n);var e=f.asn1,t=e.DERSequence,r=e.DERIA5String,i=e.DERObjectIdentifier,o=e.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var s=new t({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new r({str:this.params.cps})]});return s.tohex()}if(this.params.unotice!=null){var s=new t({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new o(this.params.unotice)]});return s.tohex()}},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};H(f.asn1.x509.PolicyQualifierInfo,f.asn1.ASN1Object);f.asn1.x509.UserNotice=function(n){f.asn1.x509.UserNotice.superclass.constructor.call(this,n);var e=f.asn1.DERSequence,t=f.asn1.DERInteger,r=f.asn1.x509.DisplayText,i=f.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var o=[];this.params.noticeref!==void 0&&o.push(new i(this.params.noticeref)),this.params.exptext!==void 0&&o.push(new r(this.params.exptext));var s=new e({array:o});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};H(f.asn1.x509.UserNotice,f.asn1.ASN1Object);f.asn1.x509.NoticeReference=function(n){f.asn1.x509.NoticeReference.superclass.constructor.call(this,n);var e=f.asn1.DERSequence,t=f.asn1.DERInteger,r=f.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var i=[];if(this.params.org!==void 0&&i.push(new r(this.params.org)),this.params.noticenum!==void 0){for(var o=[],s=this.params.noticenum,a=0;a<s.length;a++)o.push(new t(s[a]));i.push(new e({array:o}))}if(i.length==0)throw new Error("parameter is empty");var c=new e({array:i});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};H(f.asn1.x509.NoticeReference,f.asn1.ASN1Object);f.asn1.x509.DisplayText=function(n){f.asn1.x509.DisplayText.superclass.constructor.call(this,n),this.hT="0c",n!==void 0&&(n.type==="ia5"?this.hT="16":n.type==="vis"?this.hT="1a":n.type==="bmp"&&(this.hT="1e"))};H(f.asn1.x509.DisplayText,f.asn1.DERAbstractString);f.asn1.x509.PolicyMappings=function(n){f.asn1.x509.PolicyMappings.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var o=this.params,s=[],a=0;a<o.array.length;a++){var c=o.array[a];s.push({seq:[{oid:c[0]},{oid:c[1]}]})}return this.asn1ExtnValue=i({seq:s}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",n!==void 0&&(this.params=n)};H(f.asn1.x509.PolicyMappings,f.asn1.x509.Extension);f.asn1.x509.PolicyConstraints=function(n){f.asn1.x509.PolicyConstraints.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var o=this.params,s=[];return o.reqexp!=null&&s.push({tag:{tagi:"80",obj:{int:o.reqexp}}}),o.inhibit!=null&&s.push({tag:{tagi:"81",obj:{int:o.inhibit}}}),this.asn1ExtnValue=i({seq:s}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",n!==void 0&&(this.params=n)};H(f.asn1.x509.PolicyConstraints,f.asn1.x509.Extension);f.asn1.x509.InhibitAnyPolicy=function(n){f.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=i({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",n!==void 0&&(this.params=n)};H(f.asn1.x509.InhibitAnyPolicy,f.asn1.x509.Extension);f.asn1.x509.NameConstraints=function(n){f.asn1.x509.NameConstraints.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject,o=r.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var s=this.params,a=[];if(s.permit!=null&&s.permit.length!=null){for(var c=[],l=0;l<s.permit.length;l++)c.push(new o(s.permit[l]));a.push({tag:{tagi:"a0",obj:{seq:c}}})}if(s.exclude!=null&&s.exclude.length!=null){for(var h=[],l=0;l<s.exclude.length;l++)h.push(new o(s.exclude[l]));a.push({tag:{tagi:"a1",obj:{seq:h}}})}return this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",n!==void 0&&(this.params=n)};H(f.asn1.x509.NameConstraints,f.asn1.x509.Extension);f.asn1.x509.GeneralSubtree=function(n){f.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var e=f.asn1,t=e.x509,r=t.GeneralName,i=e.ASN1Util.newObject;this.params=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params,s=[new r(o)];o.min!=null&&s.push({tag:{tagi:"80",obj:{int:o.min}}}),o.max!=null&&s.push({tag:{tagi:"81",obj:{int:o.max}}});var a=i({seq:s});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.GeneralSubtree,f.asn1.ASN1Object);f.asn1.x509.ExtKeyUsage=function(n){f.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,n);var e=f,t=e.asn1;this.setPurposeArray=function(r){this.asn1ExtnValue=new t.DERSequence;for(var i=0;i<r.length;i++){var o=new t.DERObjectIdentifier(r[i]);this.asn1ExtnValue.appendASN1Object(o)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",n!==void 0&&n.array!==void 0&&this.setPurposeArray(n.array)};H(f.asn1.x509.ExtKeyUsage,f.asn1.x509.Extension);f.asn1.x509.AuthorityKeyIdentifier=function(n){f.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.DERTaggedObject,i=t.x509.GeneralNames,o=e.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var s=new Array;this.asn1KID&&s.push(new r({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&s.push(new r({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&s.push(new r({explicit:!1,tag:"82",obj:this.asn1CertSN}));var a=new t.DERSequence({array:s});return this.asn1ExtnValue=a,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(s){if(s.str!==void 0||s.hex!==void 0)this.asn1KID=new f.asn1.DEROctetString(s);else if(typeof s=="object"&&f.crypto.Util.isKey(s)||typeof s=="string"&&s.indexOf("BEGIN ")!=-1){var a=s;typeof s=="string"&&(a=Me.getKey(s));var c=Me.getKeyID(a);this.asn1KID=new f.asn1.DEROctetString({hex:c})}},this.setCertIssuerByParam=function(s){s.str!==void 0||s.ldapstr!==void 0||s.hex!==void 0||s.certsubject!==void 0||s.certissuer!==void 0?this.asn1CertIssuer=new f.asn1.x509.X500Name(s):typeof s=="string"&&s.indexOf("BEGIN ")!=-1&&s.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new f.asn1.x509.X500Name({certissuer:s}))},this.setCertSNByParam=function(s){if(s.str!==void 0||s.bigint!==void 0||s.hex!==void 0)this.asn1CertSN=new f.asn1.DERInteger(s);else if(typeof s=="string"&&s.indexOf("BEGIN ")!=-1&&s.indexOf("CERTIFICATE")){var a=new he;a.readCertPEM(s);var c=a.getSerialNumberHex();this.asn1CertSN=new f.asn1.DERInteger({hex:c})}},this.oid="2.5.29.35",n!==void 0&&(n.kid!==void 0&&this.setKIDByParam(n.kid),n.issuer!==void 0&&this.setCertIssuerByParam(n.issuer),n.sn!==void 0&&this.setCertSNByParam(n.sn),n.issuersn!==void 0&&typeof n.issuersn=="string"&&n.issuersn.indexOf("BEGIN ")!=-1&&n.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(n.issuersn),this.setCertIssuerByParam(n.issuersn)))};H(f.asn1.x509.AuthorityKeyIdentifier,f.asn1.x509.Extension);f.asn1.x509.SubjectKeyIdentifier=function(n){f.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new r(i);else if(typeof i=="object"&&f.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN")!=-1){var o=i;typeof i=="string"&&(o=Me.getKey(i));var s=Me.getKeyID(o);this.asn1KID=new f.asn1.DEROctetString({hex:s})}},this.oid="2.5.29.14",n!==void 0&&n.kid!==void 0&&this.setKIDByParam(n.kid)};H(f.asn1.x509.SubjectKeyIdentifier,f.asn1.x509.Extension);f.asn1.x509.AuthorityInfoAccess=function(n){f.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,n),this.setAccessDescriptionArray=function(e){for(var t=new Array,r=f,i=r.asn1,o=i.DERSequence,s=i.DERObjectIdentifier,a=i.x509.GeneralName,c=0;c<e.length;c++){var l,h=e[c];if(h.ocsp!==void 0)l=new o({array:[new s({oid:"1.3.6.1.5.5.7.48.1"}),new a({uri:h.ocsp})]});else if(h.caissuer!==void 0)l=new o({array:[new s({oid:"1.3.6.1.5.5.7.48.2"}),new a({uri:h.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(h));t.push(l)}this.asn1ExtnValue=new o({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",n!==void 0&&n.array!==void 0&&this.setAccessDescriptionArray(n.array)};H(f.asn1.x509.AuthorityInfoAccess,f.asn1.x509.Extension);f.asn1.x509.SubjectAltName=function(n){f.asn1.x509.SubjectAltName.superclass.constructor.call(this,n),this.setNameArray=function(e){this.asn1ExtnValue=new f.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",n!==void 0&&n.array!==void 0&&this.setNameArray(n.array)};H(f.asn1.x509.SubjectAltName,f.asn1.x509.Extension);f.asn1.x509.IssuerAltName=function(n){f.asn1.x509.IssuerAltName.superclass.constructor.call(this,n),this.setNameArray=function(e){this.asn1ExtnValue=new f.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",n!==void 0&&n.array!==void 0&&this.setNameArray(n.array)};H(f.asn1.x509.IssuerAltName,f.asn1.x509.Extension);f.asn1.x509.SubjectDirectoryAttributes=function(n){f.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,n);var e=f.asn1,t=e.DERSequence,r=e.ASN1Util.newObject,i=e.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var o=[],s=0;s<this.params.array.length;s++){var a=this.params.array[s];if(a.attr!=null&&a.array!=null){var c={seq:[{oid:a.attr},{set:a.array}]};o.push(r(c));continue}var l={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(a.attr=="dateOfBirth")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={gentime:a.str};else if(a.attr=="placeOfBirth")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={utf8str:a.str};else if(a.attr=="gender")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else if(a.attr=="countryOfCitizenship")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else if(a.attr=="countryOfResidence")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else throw new Error("unsupported attribute: "+a.attr);o.push(new r(l))}var h=new t({array:o});return this.asn1ExtnValue=h,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",n!==void 0&&(this.params=n)};H(f.asn1.x509.SubjectDirectoryAttributes,f.asn1.x509.Extension);f.asn1.x509.PrivateExtension=function(n){f.asn1.x509.PrivateExtension.superclass.constructor.call(this,n);var e=f,t=e.lang.String.isHex,r=e.asn1,i=r.x509.OID.name2oid,o=r.ASN1Util.newObject;this.params=null,this.setByParam=function(s){this.oid=i(s.extname),this.params=s},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var s=this.params.extn;if(typeof s=="string"&&t(s))return s;if(typeof s=="object")try{return o(s).tohex()}catch{}throw new Error("unsupported extn value")},n!=null&&this.setByParam(n)};H(f.asn1.x509.PrivateExtension,f.asn1.x509.Extension);f.asn1.x509.CRL=function(n){f.asn1.x509.CRL.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.DERSequence,i=t.DERBitString,o=t.x509,s=o.AlgorithmIdentifier,a=o.TBSCertList;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=new a(this.params).tohex(),l=new f.crypto.Signature({alg:this.params.sigalg});l.init(this.params.cakey),l.updateHex(c);var h=l.sign();this.params.sighex=h},this.getPEM=function(){return dn(this.tohex(),"X509 CRL")},this.tohex=function(){var c=this.params;if(c.tbsobj==null&&(c.tbsobj=new a(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(c.tbsobj),l.push(new s({name:c.sigalg})),l.push(new i({hex:"00"+c.sighex}));var h=new r({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&(this.params=n)};H(f.asn1.x509.CRL,f.asn1.ASN1Object);f.asn1.x509.TBSCertList=function(n){f.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.DERTaggedObject,s=t.DERObjectIdentifier,a=t.x509,c=a.AlgorithmIdentifier,l=a.Time,h=a.Extensions,u=a.X500Name;this.params=null,this.setByParam=function(d){this.params=d},this.getRevCertSequence=function(){for(var d=[],p=this.params.revcert,m=0;m<p.length;m++){var g=[new r(p[m].sn),new l(p[m].date)];p[m].ext!=null&&g.push(new h(p[m].ext)),d.push(new i({array:g}))}return new i({array:d})},this.tohex=function(){var d=[],p=this.params;if(p.version!=null){var m=p.version-1,g=new r({int:m});d.push(g)}if(d.push(new c({name:p.sigalg})),d.push(new u(p.issuer)),d.push(new l(p.thisupdate)),p.nextupdate!=null&&d.push(new l(p.nextupdate)),p.revcert!=null&&d.push(this.getRevCertSequence()),p.ext!=null){var x=new h(p.ext);d.push(new o({tag:"a0",explicit:!0,obj:x}))}var b=new i({array:d});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.TBSCertList,f.asn1.ASN1Object);f.asn1.x509.CRLEntry=function(n){f.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=null,t=null,r=f,i=r.asn1;this.setCertSerial=function(o){this.sn=new i.DERInteger(o)},this.setRevocationDate=function(o){this.time=new i.x509.Time(o)},this.tohex=function(){var o=new i.DERSequence({array:[this.sn,this.time]});return this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.time!==void 0&&this.setRevocationDate(n.time),n.sn!==void 0&&this.setCertSerial(n.sn))};H(f.asn1.x509.CRLEntry,f.asn1.ASN1Object);f.asn1.x509.CRLNumber=function(n){f.asn1.x509.CRLNumber.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new f.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",n!=null&&(this.params=n)};H(f.asn1.x509.CRLNumber,f.asn1.x509.Extension);f.asn1.x509.CRLReason=function(n){f.asn1.x509.CRLReason.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new f.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",n!=null&&(this.params=n)};H(f.asn1.x509.CRLReason,f.asn1.x509.Extension);f.asn1.x509.OCSPNonce=function(n){f.asn1.x509.OCSPNonce.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new f.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",n!=null&&(this.params=n)};H(f.asn1.x509.OCSPNonce,f.asn1.x509.Extension);f.asn1.x509.OCSPNoCheck=function(n){f.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new f.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",n!=null&&(this.params=n)};H(f.asn1.x509.OCSPNoCheck,f.asn1.x509.Extension);f.asn1.x509.AdobeTimeStamp=function(n){f.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,n);var e=f,t=e.asn1,r=t.DERInteger,i=t.DERBoolean,o=t.DERSequence,s=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var a=this.params,c=[new r(1)];return c.push(new s({uri:a.uri})),a.reqauth!=null&&c.push(new i(a.reqauth)),this.asn1ExtnValue=new o({array:c}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",n!==void 0&&this.setByParam(n)};H(f.asn1.x509.AdobeTimeStamp,f.asn1.x509.Extension);f.asn1.x509.X500Name=function(n){f.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var e=f,t=e.asn1,r=t.x509,i=r.RDN,o=_t;this.setByString=function(s,a){a!==void 0&&(this.sRule=a);var c=s.split("/");c.shift();for(var l=[],h=0;h<c.length;h++)if(c[h].match(/^[^=]+=.+$/))l.push(c[h]);else{var u=l.length-1;l[u]=l[u]+"/"+c[h]}for(var h=0;h<l.length;h++)this.asn1Array.push(new i({str:l[h],rule:this.sRule}))},this.setByLdapString=function(s,a){a!==void 0&&(this.sRule=a);var c=r.X500Name.ldapToCompat(s);this.setByString(c,a)},this.setByObject=function(s,a){a!==void 0&&(this.sRule=a);for(var c in s)if(s.hasOwnProperty(c)){var l=new i({str:c+"="+s[c],rule:this.sRule});this.asn1Array?this.asn1Array.push(l):this.asn1Array=[l]}},this.setByParam=function(s){if(s.rule!==void 0&&(this.sRule=s.rule),s.array!==void 0)this.paramArray=s.array;else if(s.str!==void 0)this.setByString(s.str);else if(s.ldapstr!==void 0)this.setByLdapString(s.ldapstr);else if(s.hex!==void 0)this.hTLV=s.hex;else if(s.certissuer!==void 0){var a=new he;a.readCertPEM(s.certissuer),this.hTLV=a.getIssuerHex()}else if(s.certsubject!==void 0){var a=new he;a.readCertPEM(s.certsubject),this.hTLV=a.getSubjectHex()}else typeof s=="object"&&s.certsubject===void 0&&s.certissuer===void 0&&this.setByObject(s)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var s=0;s<this.paramArray.length;s++){var a={array:this.paramArray[s]};this.sRule!="utf8"&&(a.rule=this.sRule);var c=new i(a);this.asn1Array.push(c)}var l=new t.DERSequence({array:this.asn1Array});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.X500Name,f.asn1.ASN1Object);f.asn1.x509.X500Name.compatToLDAP=function(n){if(n.substr(0,1)!=="/")throw"malformed input";var e="";n=n.substr(1);var t=n.split("/");return t.reverse(),t=t.map(function(r){return r.replace(/,/,"\\,")}),t.join(",")};f.asn1.x509.X500Name.onelineToLDAP=function(n){return f.asn1.x509.X500Name.compatToLDAP(n)};f.asn1.x509.X500Name.ldapToCompat=function(n){for(var e=n.split(","),t=!1,r=[],i=0;e.length>0;i++){var o=e.shift();if(t===!0){var s=r.pop(),a=(s+","+o).replace(/\\,/g,",");r.push(a),t=!1}else r.push(o);o.substr(-1,1)==="\\"&&(t=!0)}return r=r.map(function(c){return c.replace("/","\\/")}),r.reverse(),"/"+r.join("/")};f.asn1.x509.X500Name.ldapToOneline=function(n){return f.asn1.x509.X500Name.ldapToCompat(n)};f.asn1.x509.RDN=function(n){f.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var e=f.asn1.x509.AttributeTypeAndValue;this.setByParam=function(t){t.rule!==void 0&&(this.sRule=t.rule),t.str!==void 0&&this.addByMultiValuedString(t.str),t.array!==void 0&&(this.paramArray=t.array)},this.addByString=function(t){this.asn1Array.push(new f.asn1.x509.AttributeTypeAndValue({str:t,rule:this.sRule}))},this.addByMultiValuedString=function(t){for(var r=f.asn1.x509.RDN.parseString(t),i=0;i<r.length;i++)this.addByString(r[i])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var t=0;t<this.paramArray.length;t++){var r=this.paramArray[t];r.rule!==void 0&&this.sRule!="utf8"&&(r.rule=this.sRule);var i=new e(r);this.asn1Array.push(i)}var o=new f.asn1.DERSet({array:this.asn1Array});return this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.RDN,f.asn1.ASN1Object);f.asn1.x509.RDN.parseString=function(n){for(var e=n.split(/\+/),t=!1,r=[],i=0;e.length>0;i++){var o=e.shift();if(t===!0){var s=r.pop(),a=(s+"+"+o).replace(/\\\+/g,"+");r.push(a),t=!1}else r.push(o);o.substr(-1,1)==="\\"&&(t=!0)}for(var c=!1,l=[],i=0;r.length>0;i++){var o=r.shift();if(c===!0){var h=l.pop();if(o.match(/"$/)){var a=(h+"+"+o).replace(/^([^=]+)="(.*)"$/,"$1=$2");l.push(a),c=!1}else l.push(h+"+"+o)}else l.push(o);o.match(/^[^=]+="/)&&(c=!0)}return l};f.asn1.x509.AttributeTypeAndValue=function(n){f.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var e=f,t=e.asn1,r=t.DERSequence,i=t.DERUTF8String,o=t.DERPrintableString,s=t.DERTeletexString,a=t.DERIA5String,c=t.DERVisibleString,l=t.DERBMPString,h=e.lang.String.isMail,u=e.lang.String.isPrintable;this.setByParam=function(d){if(d.rule!==void 0&&(this.sRule=d.rule),d.ds!==void 0&&(this.dsType=d.ds),d.value===void 0&&d.str!==void 0){var p=d.str,m=p.match(/^([^=]+)=(.+)$/);if(m)this.sType=m[1],this.sValue=m[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=d.type,this.sValue=d.value},this.setByString=function(d,p){p!==void 0&&(this.sRule=p);var m=d.match(/^([^=]+)=(.+)$/);if(m)this.setByAttrTypeAndValueStr(m[1],m[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var d=this.sType,p=this.sValue,m=this.sRule;return m==="prn"?d=="CN"&&h(p)?"ia5":u(p)?"prn":"utf8":m==="utf8"?d=="CN"&&h(p)?"ia5":d=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(d,p,m){m!==void 0&&(this.sRule=m),this.sType=d,this.sValue=p},this.getValueObj=function(d,p){if(d=="utf8")return new i({str:p});if(d=="prn")return new o({str:p});if(d=="tel")return new s({str:p});if(d=="ia5")return new a({str:p});if(d=="vis")return new c({str:p});if(d=="bmp")return new l({str:p});throw new Error("unsupported directory string type: type="+d+" value="+p)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var d=f.asn1.x509.OID.atype2obj(this.sType),p=this.getValueObj(this.dsType,this.sValue),m=new r({array:[d,p]});return this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.AttributeTypeAndValue,f.asn1.ASN1Object);f.asn1.x509.SubjectPublicKeyInfo=function(n){f.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=null,t=null,r=f,i=r.asn1,o=i.DERInteger,s=i.DERBitString,a=i.DERObjectIdentifier,c=i.DERSequence,l=i.ASN1Util.newObject,h=i.x509,u=h.AlgorithmIdentifier,d=r.crypto,p=d.ECDSA,m=d.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var g=new c({array:[this.asn1AlgId,this.asn1SubjPKey]});return g},this.tohex=function(){var g=this.getASN1Object();return this.hTLV=g.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(g){try{if(g instanceof ve){var x=l({seq:[{int:{bigint:g.n}},{int:{int:g.e}}]}),b=x.tohex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new s({hex:"00"+b})}}catch{}try{if(g instanceof f.crypto.ECDSA){var _=new a({name:g.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:_}),this.asn1SubjPKey=new s({hex:"00"+g.pubKeyHex})}}catch{}try{if(g instanceof f.crypto.DSA){var _=new l({seq:[{int:{bigint:g.p}},{int:{bigint:g.q}},{int:{bigint:g.g}}]});this.asn1AlgId=new u({name:"dsa",asn1params:_});var O=new o({bigint:g.y});this.asn1SubjPKey=new s({hex:"00"+O.tohex()})}}catch{}},n!==void 0&&this.setPubKey(n)};H(f.asn1.x509.SubjectPublicKeyInfo,f.asn1.ASN1Object);f.asn1.x509.Time=function(n){f.asn1.x509.Time.superclass.constructor.call(this);var e=null,t=null,r=f,i=r.asn1,o=i.DERUTCTime,s=i.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(a){this.timeParams=a},this.setByParam=function(a){this.params=a},this.getType=function(a){return a.match(/^[0-9]{12}Z$/)?"utc":a.match(/^[0-9]{14}Z$/)?"gen":a.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":a.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var a=this.params,c=null;if(typeof a=="string"&&(a={str:a}),a!=null&&a.str&&(a.type==null||a.type==null)&&(a.type=this.getType(a.str)),a!=null&&a.str?(a.type=="utc"&&(c=new o(a.str)),a.type=="gen"&&(c=new s(a.str))):this.type=="gen"?c=new s:c=new o,c==null)throw new Error("wrong setting for Time");return this.TLV=c.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};f.asn1.x509.Time_bak=function(n){f.asn1.x509.Time_bak.superclass.constructor.call(this);var e=null,t=null,r=f,i=r.asn1,o=i.DERUTCTime,s=i.DERGeneralizedTime;this.setTimeParams=function(a){this.timeParams=a},this.tohex=function(){var a=null;return this.timeParams!=null?this.type=="utc"?a=new o(this.timeParams):a=new s(this.timeParams):this.type=="utc"?a=new o:a=new s,this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",n!==void 0&&(n.type!==void 0?this.type=n.type:n.str!==void 0&&(n.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),n.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=n)};H(f.asn1.x509.Time,f.asn1.ASN1Object);f.asn1.x509.AlgorithmIdentifier=function(n){f.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=f,t=e.asn1,r=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var o=null;for(var s in r)s===this.nameAlg&&(o=r[s]);if(o!==null)return this.hTLV=o,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var a=[this.asn1Alg];this.asn1Params!==null&&a.push(this.asn1Params);var c=new t.DERSequence({array:a});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.name!==void 0&&(this.nameAlg=n.name),n.asn1params!==void 0&&(this.asn1Params=n.asn1params),n.paramempty!==void 0&&(this.paramEmpty=n.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();i.substr(-7,7)!=="withdsa"&&i.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new t.DERNull)}};H(f.asn1.x509.AlgorithmIdentifier,f.asn1.ASN1Object);f.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};f.asn1.x509.GeneralName=function(n){f.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},t=f,r=t.asn1,i=r.x509,o=i.X500Name,s=i.OtherName,a=r.DERIA5String,c=r.DERPrintableString,l=r.DEROctetString,h=r.DERTaggedObject,u=r.ASN1Object,d=Error;this.params=null,this.setByParam=function(p){this.params=p},this.tohex=function(){var p=this.params,m,x,g,x=!1;if(p.other!==void 0)m="a0",g=new s(p.other);else if(p.rfc822!==void 0)m="81",g=new a({str:p.rfc822});else if(p.dns!==void 0)m="82",g=new a({str:p.dns});else if(p.dn!==void 0)m="a4",x=!0,typeof p.dn=="string"?g=new o({str:p.dn}):p.dn instanceof f.asn1.x509.X500Name?g=p.dn:g=new o(p.dn);else if(p.ldapdn!==void 0)m="a4",x=!0,g=new o({ldapstr:p.ldapdn});else if(p.certissuer!==void 0||p.certsubj!==void 0){m="a4",x=!0;var b,_,O=null;if(p.certsubj!==void 0?(b=!1,_=p.certsubj):(b=!0,_=p.certissuer),_.match(/^[0-9A-Fa-f]+$/)&&O==_,_.indexOf("-----BEGIN ")!=-1&&(O=_t(_)),O==null)throw new Error("certsubj/certissuer not cert");var S=new he;S.hex=O;var E;b?E=S.getIssuerHex():E=S.getSubjectHex(),g=new u,g.hTLV=E}else if(p.uri!==void 0)m="86",g=new a({str:p.uri});else if(p.ip!==void 0){m="87";var D,I=p.ip;try{if(I.match(/^[0-9a-f]+$/)){var y=I.length;if(y==8||y==16||y==32||y==64)D=I;else throw"err"}else D=q0(I)}catch(C){throw new d("malformed IP address: "+p.ip+":"+C.message)}g=new l({hex:D})}else throw new d("improper params");var P=new h({tag:m,explicit:x,obj:g});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.GeneralName,f.asn1.ASN1Object);f.asn1.x509.GeneralNames=function(n){f.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=null,t=f,r=t.asn1;this.setByParamArray=function(i){for(var o=0;o<i.length;o++){var s=new r.x509.GeneralName(i[o]);this.asn1Array.push(s)}},this.tohex=function(){var i=new r.DERSequence({array:this.asn1Array});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof n<"u"&&this.setByParamArray(n)};H(f.asn1.x509.GeneralNames,f.asn1.ASN1Object);f.asn1.x509.OtherName=function(n){f.asn1.x509.OtherName.superclass.constructor.call(this);var e=null,t=null,r=f,i=r.asn1,o=i.DERObjectIdentifier,s=i.DERSequence,a=i.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if(c.oid==null||c.value==null)throw new Error("oid or value not specified");var l=new o({oid:c.oid}),h=a({tag:{tag:"a0",explicit:!0,obj:c.value}}),u=new s({array:[l,h]});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.x509.OtherName,f.asn1.ASN1Object);f.asn1.x509.OID=new function(){var n=f.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(e){if(typeof this.objCache[e]<"u")return this.objCache[e];if(typeof this.name2oidList[e]>"u")throw"Name of ObjectIdentifier not defined: "+e;var t=this.name2oidList[e],r=new n({oid:t});return this.objCache[e]=r,r},this.atype2obj=function(e){if(this.objCache[e]!==void 0)return this.objCache[e];var t;if(e.match(/^\d+\.\d+\.[0-9.]+$/))t=e;else if(this.atype2oidList[e]!==void 0)t=this.atype2oidList[e];else if(this.name2oidList[e]!==void 0)t=this.name2oidList[e];else throw new Error("AttributeType name undefined: "+e);var r=new n({oid:t});return this.objCache[e]=r,r},this.registerOIDs=function(e){if(this.checkOIDs(e))for(var t in e)this.name2oidList[t]=e[t]},this.checkOIDs=function(e){try{var t=Object.keys(e);return t.length==0?!1:(t.map(function(r,i,o){var s=this[r];if(!s.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},e),!0)}catch{return!1}}};f.asn1.x509.OID.oid2name=function(n){var e=f.asn1.x509.OID.name2oidList;for(var t in e)if(e[t]==n)return t;return""};f.asn1.x509.OID.oid2atype=function(n){var e=f.asn1.x509.OID.atype2oidList;for(var t in e)if(e[t]==n)return t;return n};f.asn1.x509.OID.name2oid=function(n){if(n.match(/^[0-9.]+$/))return n;var e=f.asn1.x509.OID.name2oidList;return e[n]===void 0?"":e[n]};f.asn1.x509.X509Util={};f.asn1.x509.X509Util.newCertPEM=function(n){var e=f.asn1.x509,t=e.TBSCertificate,r=e.Certificate,i=new r(n);return i.getPEM()};(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});(typeof f.asn1.cms>"u"||!f.asn1.cms)&&(f.asn1.cms={});f.asn1.cms.Attribute=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.DERSet,s=r.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(a){this.params=a},this.getValueArray=function(){throw new e("not yet implemented abstract")},this.tohex=function(){var a=new s({oid:this.typeOid}),c=new o({array:this.getValueArray()}),l=new i({array:[a,c]});return l.tohex()},this.getEncodedHex=function(){return this.tohex()}};H(f.asn1.cms.Attribute,f.asn1.ASN1Object);f.asn1.cms.ContentType=function(n){var e=f,t=e.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var r=new t.DERObjectIdentifier(this.params.type);return[r]},n!=null&&this.setByParam(n)};H(f.asn1.cms.ContentType,f.asn1.cms.Attribute);f.asn1.cms.MessageDigest=function(n){var e=f,t=e.asn1,r=t.DEROctetString,i=t.cms;i.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var o=new r(this.params);return[o]},n!=null&&this.setByParam(n)};H(f.asn1.cms.MessageDigest,f.asn1.cms.Attribute);f.asn1.cms.SigningTime=function(n){var e=f,t=e.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var r=new t.x509.Time(this.params);return[r]},n!=null&&this.setByParam(n)};H(f.asn1.cms.SigningTime,f.asn1.cms.Attribute);f.asn1.cms.SigningCertificate=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.cms,s=o.ESSCertID,a=t.crypto;o.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new e("parameter 'array' not specified");for(var c=this.params.array,l=[],h=0;h<c.length;h++){var u=c[h];n.hasis==!1&&typeof u=="string"&&(u.indexOf("-----BEGIN")!=-1||$.isASN1HEX(u))&&(u={cert:u}),u.hasis!=!1&&n.hasis==!1&&(u.hasis=!1),l.push(new s(u))}var d=new i({array:l}),p=new i({array:[d]});return[p]},n!=null&&this.setByParam(n)};H(f.asn1.cms.SigningCertificate,f.asn1.cms.Attribute);f.asn1.cms.ESSCertID=function(n){f.asn1.cms.ESSCertID.superclass.constructor.call(this);var e=Error,t=f,r=t.asn1,i=r.DEROctetString,o=r.DERSequence,s=r.cms.IssuerSerial;this.params=null,this.getCertHash=function(a,c){if(a.hash!=null)return a.hash;if(typeof a=="string"&&a.indexOf("-----BEGIN")==-1&&!$.isASN1HEX(a))return a;var l;if(typeof a=="string")l=a;else if(a.cert!=null)l=a.cert;else throw new e("hash nor cert unspecified");var h;l.indexOf("-----BEGIN")!=-1?h=_t(l):h=l,typeof a=="string"&&(a.indexOf("-----BEGIN")!=-1?h=_t(a):$.isASN1HEX(a)&&(h=a));var u;if(a.alg!=null)u=a.alg;else if(c!=null)u=c;else throw new e("hash alg unspecified");return t.crypto.Util.hashHex(h,u)},this.tohex=function(){var a=this.params,c=this.getCertHash(a,"sha1"),l=[];l.push(new i({hex:c})),(typeof a=="string"&&a.indexOf("-----BEGIN")!=-1||a.cert!=null&&a.hasis!=!1||a.issuer!=null&&a.serial!=null)&&l.push(new s(a));var h=new o({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.ESSCertID,f.asn1.ASN1Object);f.asn1.cms.SigningCertificateV2=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.x509,s=r.cms,a=s.ESSCertIDv2,c=t.crypto;s.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new e("parameter 'array' not specified");for(var l=this.params.array,h=[],u=0;u<l.length;u++){var d=l[u];(n.alg!=null||n.hasis==!1)&&typeof d=="string"&&(d.indexOf("-----BEGIN")!=-1||$.isASN1HEX(d))&&(d={cert:d}),d.alg==null&&n.alg!=null&&(d.alg=n.alg),d.hasis!=!1&&n.hasis==!1&&(d.hasis=!1),h.push(new a(d))}var p=new i({array:h}),m=new i({array:[p]});return[m]},n!=null&&this.setByParam(n)};H(f.asn1.cms.SigningCertificateV2,f.asn1.cms.Attribute);f.asn1.cms.ESSCertIDv2=function(n){f.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var e=Error,t=f,r=t.asn1,i=r.DEROctetString,o=r.DERSequence,s=r.cms.IssuerSerial,a=r.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var c=this.params,l=this.getCertHash(c,"sha256"),h=[];c.alg!=null&&c.alg!="sha256"&&h.push(new a({name:c.alg})),h.push(new i({hex:l})),(typeof c=="string"&&c.indexOf("-----BEGIN")!=-1||c.cert!=null&&c.hasis!=!1||c.issuer!=null&&c.serial!=null)&&h.push(new s(c));var u=new o({array:h});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.ESSCertIDv2,f.asn1.cms.ESSCertID);f.asn1.cms.IssuerSerial=function(n){var e=Error,t=f,r=t.asn1,i=r.DERInteger,o=r.DERSequence,s=r.cms,a=r.x509,c=a.GeneralNames,l=he;s.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(h){this.params=h},this.tohex=function(){var h=this.params,u,d;if(typeof h=="string"&&h.indexOf("-----BEGIN")!=-1||h.cert!=null){var p;h.cert!=null?p=h.cert:p=h;var m=new l;m.readCertPEM(p),u=m.getIssuer(),d={hex:m.getSerialNumberHex()}}else if(h.issuer!=null&&h.serial)u=h.issuer,d=h.serial;else throw new e("cert or issuer and serial parameter not specified");var g=new c([{dn:u}]),x=new i(d),b=new o({array:[g,x]});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.IssuerSerial,f.asn1.ASN1Object);f.asn1.cms.SignerIdentifier=function(n){var e=f,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.cms,s=o.IssuerAndSerialNumber,a=o.SubjectKeyIdentifier,c=t.x509,l=c.X500Name,h=he,u=Error;o.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params;if(d.type=="isssn"){var p=new s(d);return p.tohex()}else if(d.type=="skid"){var m=new a(d);return m.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.SignerIdentifier,f.asn1.ASN1Object);f.asn1.cms.IssuerAndSerialNumber=function(n){var e=f,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.cms,s=t.x509,a=s.X500Name,c=he,l=Error;o.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u,d;if(typeof h=="string"&&h.indexOf("-----BEGIN")!=-1||h.cert!=null){var p;h.cert!=null?p=h.cert:p=h;var m=new c;m.readCertPEM(p),u=m.getIssuer(),d={hex:m.getSerialNumberHex()}}else if(h.issuer!=null&&h.serial)u=h.issuer,d=h.serial;else throw new l("cert or issuer and serial parameter not specified");var g=new a(u),x=new r(d),b=new i({array:[g,x]});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},n!=null&&this.setByParam(n)};H(f.asn1.cms.IssuerAndSerialNumber,f.asn1.ASN1Object);f.asn1.cms.SubjectKeyIdentifier=function(n){var e=f,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.ASN1Util.newObject,s=t.cms,a=s.IssuerAndSerialName,c=s.SubjectKeyIdentifier,l=t.x509,h=l.X500Name,u=he,d=Error;s.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var p=this.params;if(p.cert==null&&p.skid==null)throw new d("property cert nor skid undefined");var m;if(p.cert!=null){var g=new u(p.cert),x=g.getExtSubjectKeyIdentifier();m=x.kid.hex}else p.skid!=null&&(m=p.skid);var b=o({tag:{tage:"a0",obj:{octstr:{hex:m}}}});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.SubjectKeyIdentifier,f.asn1.ASN1Object);f.asn1.cms.AttributeList=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSet,o=r.cms;o.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params;if(this.hTLV!=null)return this.hTLV;var a=!0;s.sortflag!=null&&(a=s.sortflag);for(var c=s.array,l=[],h=0;h<c.length;h++){var u=c[h],d=u.attr;if(d=="contentType")l.push(new o.ContentType(u));else if(d=="messageDigest")l.push(new o.MessageDigest(u));else if(d=="signingTime")l.push(new o.SigningTime(u));else if(d=="signingCertificate")l.push(new o.SigningCertificate(u));else if(d=="signingCertificateV2")l.push(new o.SigningCertificateV2(u));else if(d=="signaturePolicyIdentifier")l.push(new f.asn1.cades.SignaturePolicyIdentifier(u));else if(d=="signatureTimeStamp"||d=="timeStampToken")l.push(new f.asn1.cades.SignatureTimeStamp(u));else throw new e("unknown attr: "+d)}var p=new i({array:l,sortflag:a});return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.AttributeList,f.asn1.ASN1Object);f.asn1.cms.SignerInfo=function(n){var e=Error,t=f,r=t.asn1,i=r.DERInteger,o=r.DEROctetString,s=r.DERSequence,a=r.DERTaggedObject,c=r.cms,l=c.SignerIdentifier,h=c.AttributeList,u=c.ContentType,d=c.EncapsulatedContentInfo,p=c.MessageDigest,m=c.SignedData,g=r.x509,x=g.AlgorithmIdentifier,b=t.crypto,_=Me;c.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var O=this.params,S=O.sigalg,E=new h(O.sattrs).tohex(),D=_.getKey(O.signkey),I=new b.Signature({alg:S});I.init(D),I.updateHex(E);var y=I.sign();O.sighex=y},this.tohex=function(){var O=this.params,S=[];if(S.push(new i({int:O.version})),S.push(new l(O.id)),S.push(new x({name:O.hashalg})),O.sattrs!=null){var E=new h(O.sattrs);try{S.push(new a({tag:"a0",explicit:!1,obj:E}))}catch(I){throw new e("si sattr error: "+I)}}if(O.sigalgfield!=null?S.push(new x({name:O.sigalgfield})):S.push(new x({name:O.sigalg})),O.sighex==null&&O.signkey!=null&&this.sign(),S.push(new o({hex:O.sighex})),O.uattrs!=null){var E=new h(O.uattrs);try{S.push(new a({tag:"a1",explicit:!1,obj:E}))}catch(y){throw new e("si uattr error: "+y)}}var D=new s({array:S});return D.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.SignerInfo,f.asn1.ASN1Object);f.asn1.cms.EncapsulatedContentInfo=function(n){var e=f,t=e.asn1,r=t.DERTaggedObject,i=t.DERSequence,o=t.DERObjectIdentifier,s=t.DEROctetString,a=t.cms;a.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,l=[];if(l.push(new o(c.type)),c.content!=null&&(c.content.hex!=null||c.content.str!=null)&&c.isDetached!=!0){var h=new s(c.content),u=new r({tag:"a0",explicit:!0,obj:h});l.push(u)}var d=new i({array:l});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},n!=null&&this.setByParam(n)};H(f.asn1.cms.EncapsulatedContentInfo,f.asn1.ASN1Object);f.asn1.cms.ContentInfo=function(n){var e=f,t=e.asn1,r=t.DERTaggedObject,i=t.DERSequence,o=t.DERObjectIdentifier,s=t.x509,a=s.OID.name2obj;f.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,l=[];l.push(new o(c.type));var h=new r({tag:"a0",explicit:!0,obj:c.obj});l.push(h);var u=new i({array:l});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},n!=null&&this.setByParam(n)};H(f.asn1.cms.ContentInfo,f.asn1.ASN1Object);f.asn1.cms.SignedData=function(n){var e=Error,t=f,r=t.asn1,i=r.ASN1Object,o=r.DERInteger,s=r.DERSet,a=r.DERSequence,c=r.DERTaggedObject,l=r.cms,h=l.EncapsulatedContentInfo,u=l.SignerInfo,d=l.ContentInfo,p=l.CertificateSet,m=l.RevocationInfoChoices,g=r.x509,x=g.AlgorithmIdentifier;f.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var b=this.params;this._setDigestAlgs(b),this._setContentTypeByEContent(b),this._setMessageDigestByEContent(b),this._setSignerInfoVersion(b),this._setSignedDataVersion(b)},this._setDigestAlgs=function(b){for(var _={},O=b.sinfos,S=0;S<O.length;S++){var E=O[S];_[E.hashalg]=1}b.hashalgs=Object.keys(_).sort()},this._setContentTypeByEContent=function(b){for(var _=b.econtent.type,O=b.sinfos,S=0;S<O.length;S++){var E=O[S],D=this._getAttrParamByName(E,"contentType");D.type=_}},this._setMessageDigestByEContent=function(b){var _=b.econtent,O=b.econtent.type,S=_.content.hex;S==null&&_.type=="data"&&_.content.str!=null&&(S=Nr(_.content.str));for(var E=b.sinfos,D=0;D<E.length;D++){var I=E[D],y=I.hashalg,P=this._getAttrParamByName(I,"messageDigest"),C=f.crypto.Util.hashHex(S,y);P.hex=C}},this._getAttrParamByName=function(b,_){for(var O=b.sattrs.array,S=0;S<O.length;S++)if(O[S].attr==_)return O[S]},this._setSignerInfoVersion=function(b){for(var _=b.sinfos,O=0;O<_.length;O++){var S=_[O],E=1;S.id.type=="skid"&&(E=3),S.version=E}},this._setSignedDataVersion=function(b){var _=this._getSignedDataVersion(b);b.version=_},this._getSignedDataVersion=function(b){if(b.revinfos!=null)for(var _=b.revinfos,O=0;O<_.length;O++){var S=_[O];if(S.ocsp!=null)return 5}for(var E=b.sinfos,O=0;O<E.length;O++){var D=b.sinfos[O];if(D.version==3)return 3}return b.econtent.type!="data"?3:1},this.tohex=function(){var b=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),b.fixed!=!0&&this.checkAndFixParam();var _=[];_.push(new o({int:b.version}));for(var O=[],S=0;S<b.hashalgs.length;S++){var E=b.hashalgs[S];O.push(new x({name:E}))}_.push(new s({array:O})),_.push(new h(b.econtent)),b.certs!=null&&_.push(new p(b.certs)),b.revinfos!=null&&_.push(new m(b.revinfos));for(var D=[],S=0;S<b.sinfos.length;S++){var I=b.sinfos[S];D.push(new u(I))}_.push(new s({array:D}));var y=new a({array:_});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var b=new d({type:"signed-data",obj:this});return b},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.SignedData,f.asn1.ASN1Object);f.asn1.cms.CertificateSet=function(n){f.asn1.cms.CertificateSet.superclass.constructor.call(this);var e=Error,t=f.asn1,r=t.DERTaggedObject,i=t.DERSet,o=t.ASN1Object;this.params=null,this.tohex=function(){var s=this.params,a=[],c;if(s instanceof Array)c=s;else if(s.array!=null)c=s.array;else throw new e("cert array not specified");for(var l=0;l<c.length;l++){var h=c[l],u=_t(h),d=new o;d.hTLV=u,a.push(d)}var p={array:a};s.sortflag==!1&&(p.sortflag=!1);var m=new i(p),g=new r({tag:"a0",explicit:!1,obj:m});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.CertificateSet,f.asn1.ASN1Object);f.asn1.cms.RevocationInfoChoices=function(n){f.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],r=0;r<e.length;r++)t.push(new f.asn1.cms.RevocationInfoChoice(e[r]));var i=f.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.RevocationInfoChoices,f.asn1.ASN1Object);f.asn1.cms.RevocationInfoChoice=function(n){f.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(e.crl!=null&&typeof e.crl=="string"){var t=e.crl;return e.crl.indexOf("-----BEGIN")!=-1&&(t=_t(e.crl)),t}else if(e.ocsp!=null){var r=f.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new f.asn1.cms.OtherRevocationFormat(e)}});return r.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.RevocationInfoChoice,f.asn1.ASN1Object);f.asn1.cms.OtherRevocationFormat=function(n){f.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var e=Error,t=f,r=t.asn1,i=r.ASN1Util.newObject,o=t.lang.String.isHex;this.params=null,this.tohex=function(){var s=this.params;if(s.ocsp==null)throw new e("property ocsp not specified");if(!o(s.ocsp)||!$.isASN1HEX(s.ocsp))throw new e("ocsp value not ASN.1 hex string");var a=i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:s.ocsp}}]});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cms.OtherRevocationFormat,f.asn1.ASN1Object);f.asn1.cms.CMSUtil=new function(){};f.asn1.cms.CMSUtil.newSignedData=function(n){return new f.asn1.cms.SignedData(n)};f.asn1.cms.CMSUtil.verifySignedData=function(n){var e=f,t=e.asn1,r=t.cms,i=r.SignerInfo,o=r.SignedData,s=r.SigningTime,a=r.SigningCertificate,c=r.SigningCertificateV2,l=t.cades,h=l.SignaturePolicyIdentifier,u=e.lang.String.isHex,d=$,p=d.getVbyList,m=d.getTLVbyList,g=d.getIdxbyList,x=d.getChildIdx,b=d.getTLV,_=d.oidname,O=e.crypto.Util.hashHex;n.cms===void 0&&u(n.cms);var S=n.cms,E=function(T,R){for(var N,q=3;q<6;q++)if(N=g(T,0,[1,0,q]),N!==void 0){var V=T.substr(N,2);V==="a0"&&(R.certsIdx=N),V==="a1"&&(R.revinfosIdx=N),V==="31"&&(R.signerinfosIdx=N)}},D=function(T,R){var N=R.signerinfosIdx;if(N!==void 0){var q=x(T,N);R.signerInfoIdxList=q;for(var V=0;V<q.length;V++){var G=q[V],re={idx:G};I(T,re),R.signerInfos.push(re)}}},I=function(T,R){var N=R.idx;R.signerid_issuer1=m(T,N,[1,0],"30"),R.signerid_serial1=p(T,N,[1,1],"02"),R.hashalg=_(p(T,N,[2,0],"06"));var q=g(T,N,[3],"a0");R.idxSignedAttrs=q,y(T,R,q);var V=x(T,N),G=V.length;if(G<6)throw"malformed SignerInfo";R.sigalg=_(p(T,N,[G-2,0],"06")),R.sigval=p(T,N,[G-1],"04")},y=function(T,R,N){var q=x(T,N);R.signedAttrIdxList=q;for(var V=0;V<q.length;V++){var G=q[V],re=p(T,G,[0],"06"),te;re==="2a864886f70d010905"?(te=Ve(p(T,G,[1,0])),R.saSigningTime=te):re==="2a864886f70d010904"&&(te=p(T,G,[1,0],"04"),R.saMessageDigest=te)}},P=function(T,R){if(p(T,0,[0],"06")!=="2a864886f70d010702")return R;R.cmsType="signedData",R.econtent=p(T,0,[1,0,2,1,0]),E(T,R),R.signerInfos=[],D(T,R)},C=function(T,R){for(var N=R.parse.signerInfos,q=N.length,V=!0,G=0;G<q;G++){var re=N[G];A(T,R,re,G),re.isValid||(V=!1)}R.isValid=V},M=function(T,R,N,q){var V=R.parse.certsIdx,G;if(R.certs===void 0){G=[],R.certkeys=[];for(var re=x(T,V),te=0;te<re.length;te++){var be=b(T,re[te]),ge=new he;ge.readCertHex(be),G[te]=ge,R.certkeys[te]=ge.getPublicKey()}R.certs=G}else G=R.certs;R.cccc=G.length,R.cccci=re.length;for(var te=0;te<G.length;te++){var rt=ge.getIssuerHex(),He=ge.getSerialNumberHex();N.signerid_issuer1===rt&&N.signerid_serial1===He&&(N.certkey_idx=te)}},A=function(T,R,N,q){N.verifyDetail={};var V=N.verifyDetail,G=R.parse.econtent,re=N.hashalg,te=N.saMessageDigest;V.validMessageDigest=!1,O(G,re)===te&&(V.validMessageDigest=!0),M(T,R,N,q),V.validSignatureValue=!1;var be=N.sigalg,ge="31"+b(T,N.idxSignedAttrs).substr(2);N.signedattrshex=ge;var rt=R.certs[N.certkey_idx].getPublicKey(),He=new f.crypto.Signature({alg:be});He.init(rt),He.updateHex(ge);var Ue=He.verify(N.sigval);V.validSignatureValue_isValid=Ue,Ue===!0&&(V.validSignatureValue=!0),N.isValid=!1,V.validMessageDigest&&V.validSignatureValue&&(N.isValid=!0)},F=function(){},k={isValid:!1,parse:{}};return P(S,k.parse),C(S,k),k};f.asn1.cms.CMSParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,s=r.getIdxbyList,a=r.getTLVbyList,c=r.getTLVbyListEx,l=r.getVbyList,h=r.getVbyListEx,u=r.getChildIdx;this.getCMSSignedData=function(d){var p=a(d,0,[1,0]),m=this.getSignedData(p);return m},this.getSignedData=function(d){var p=u(d,0),m={},g=i(d,p[0]),x=parseInt(g,16);m.version=x;var b=o(d,p[1]);m.hashalgs=this.getHashAlgArray(b);var _=o(d,p[2]);m.econtent=this.getEContent(_);var O=c(d,0,["[0]"]);O!=null&&(m.certs=this.getCertificateSet(O));var S=c(d,0,["[1]"]);S!=null;var E=c(d,0,[3]);return m.sinfos=this.getSignerInfos(E),m},this.getHashAlgArray=function(d){for(var p=u(d,0),m=new e,g=[],x=0;x<p.length;x++){var b=o(d,p[x]),_=m.getAlgorithmIdentifierName(b);g.push(_)}return g},this.getEContent=function(d){var p={},m=l(d,0,[0]),g=l(d,0,[1,0]);return p.type=f.asn1.x509.OID.oid2name($.hextooidstr(m)),p.content={hex:g},p},this.getSignerInfos=function(d){for(var p=[],m=u(d,0),g=0;g<m.length;g++){var x=o(d,m[g]),b=this.getSignerInfo(x);p.push(b)}return p},this.getSignerInfo=function(d){var p={},m=u(d,0),g=r.getInt(d,m[0],-1);g!=-1&&(p.version=g);var x=o(d,m[1]),b=this.getIssuerAndSerialNumber(x);p.id=b;var _=o(d,m[2]),O=t.getAlgorithmIdentifierName(_);p.hashalg=O;var S=c(d,0,["[0]"]);if(S!=null){var E=this.getAttributeList(S);p.sattrs=E}var D=c(d,0,[3]),I=t.getAlgorithmIdentifierName(D);p.sigalg=I;var y=h(d,0,[4]);p.sighex=y;var P=c(d,0,["[1]"]);if(P!=null){var C=this.getAttributeList(P);p.uattrs=C}return p},this.getSignerIdentifier=function(d){if(d.substr(0,2)=="30")return this.getIssuerAndSerialNumber(d);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(d){var p={type:"isssn"},m=u(d,0),g=o(d,m[0]);p.issuer=t.getX500Name(g);var x=i(d,m[1]);return p.serial={hex:x},p},this.getAttributeList=function(d){for(var p=[],m=u(d,0),g=0;g<m.length;g++){var x=o(d,m[g]),b=this.getAttribute(x);p.push(b)}return{array:p}},this.getAttribute=function(d){var p={},m=u(d,0),g=r.getOID(d,m[0]),x=f.asn1.x509.OID.oid2name(g);p.attr=x;var b=o(d,m[1]),_=u(b,0);if(_.length==1)p.valhex=o(b,_[0]);else{for(var O=[],S=0;S<_.length;S++)O.push(o(b,_[S]));p.valhex=O}return x=="contentType"?this.setContentType(p):x=="messageDigest"?this.setMessageDigest(p):x=="signingTime"?this.setSigningTime(p):x=="signingCertificate"?this.setSigningCertificate(p):x=="signingCertificateV2"?this.setSigningCertificateV2(p):x=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(p),p},this.setContentType=function(d){var p=r.getOIDName(d.valhex,0,null);p!=null&&(d.type=p,delete d.valhex)},this.setSigningTime=function(d){var p=i(d.valhex,0),m=Ve(p);d.str=m,delete d.valhex},this.setMessageDigest=function(d){var p=i(d.valhex,0);d.hex=p,delete d.valhex},this.setSigningCertificate=function(d){var p=u(d.valhex,0);if(p.length>0){for(var m=o(d.valhex,p[0]),g=u(m,0),x=[],b=0;b<g.length;b++){var _=o(m,g[b]),O=this.getESSCertID(_);x.push(O)}d.array=x}if(p.length>1){var S=o(d.valhex,p[1]);d.polhex=S}delete d.valhex},this.setSignaturePolicyIdentifier=function(d){var p=u(d.valhex,0);if(p.length>0){var m=r.getOID(d.valhex,p[0]);d.oid=m}if(p.length>1){var g=new e,x=u(d.valhex,p[1]),b=o(d.valhex,x[0]),_=g.getAlgorithmIdentifierName(b);d.alg=_;var O=i(d.valhex,x[1]);d.hash=O}delete d.valhex},this.setSigningCertificateV2=function(d){var p=u(d.valhex,0);if(p.length>0){for(var m=o(d.valhex,p[0]),g=u(m,0),x=[],b=0;b<g.length;b++){var _=o(m,g[b]),O=this.getESSCertIDv2(_);x.push(O)}d.array=x}if(p.length>1){var S=o(d.valhex,p[1]);d.polhex=S}delete d.valhex},this.getESSCertID=function(d){var p={},m=u(d,0);if(m.length>0){var g=i(d,m[0]);p.hash=g}if(m.length>1){var x=o(d,m[1]),b=this.getIssuerSerial(x);b.serial!=null&&(p.serial=b.serial),b.issuer!=null&&(p.issuer=b.issuer)}return p},this.getESSCertIDv2=function(d){var p={},m=u(d,0);if(m.length<1||3<m.length)throw new n("wrong number of elements");var g=0;if(d.substr(m[0],2)=="30"){var x=o(d,m[0]);p.alg=t.getAlgorithmIdentifierName(x),g++}else p.alg="sha256";var b=i(d,m[g]);if(p.hash=b,m.length>g+1){var _=o(d,m[g+1]),O=this.getIssuerSerial(_);p.issuer=O.issuer,p.serial=O.serial}return p},this.getIssuerSerial=function(d){var p={},m=u(d,0),g=o(d,m[0]),x=t.getGeneralNames(g),b=x[0].dn;p.issuer=b;var _=i(d,m[1]);return p.serial={hex:_},p},this.getCertificateSet=function(d){for(var p=u(d,0),m=[],g=0;g<p.length;g++){var x=o(d,p[g]);if(x.substr(0,2)=="30"){var b=dn(x,"CERTIFICATE");m.push(b)}}return{array:m,sortflag:!1}}};(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});(typeof f.asn1.tsp>"u"||!f.asn1.tsp)&&(f.asn1.tsp={});f.asn1.tsp.TimeStampToken=function(n){var e=f,t=e.asn1,r=t.tsp;r.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var i=new r.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=i.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.TimeStampToken,f.asn1.cms.SignedData);f.asn1.tsp.TSTInfo=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.DERInteger,s=r.DERBoolean,a=r.DERGeneralizedTime,c=r.DERObjectIdentifier,l=r.DERTaggedObject,h=r.tsp,u=h.MessageImprint,d=h.Accuracy,p=r.x509.X500Name,m=r.x509.GeneralName;if(h.TSTInfo.superclass.constructor.call(this),this.dVersion=new o({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var g=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(g.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(g.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(g.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");g.push(this.dGenTime),this.dAccuracy!=null&&g.push(this.dAccuracy),this.dOrdering!=null&&g.push(this.dOrdering),this.dNonce!=null&&g.push(this.dNonce),this.dTsa!=null&&g.push(this.dTsa);var x=new i({array:g});return this.hTLV=x.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0){if(typeof n.policy=="string"){if(!n.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new c({oid:n.policy})}n.messageImprint!==void 0&&(this.dMessageImprint=new u(n.messageImprint)),n.serial!==void 0&&(this.dSerial=new o(n.serial)),n.genTime!==void 0&&(this.dGenTime=new a(n.genTime)),n.accuracy!==void 0&&(this.dAccuracy=new d(n.accuracy)),n.ordering!==void 0&&n.ordering==!0&&(this.dOrdering=new s),n.nonce!==void 0&&(this.dNonce=new o(n.nonce)),n.tsa!==void 0&&(this.dTsa=new l({tag:"a0",explicit:!0,obj:new m({dn:n.tsa})}))}};H(f.asn1.tsp.TSTInfo,f.asn1.ASN1Object);f.asn1.tsp.Accuracy=function(n){var e=f,t=e.asn1,r=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,o=[];return i.seconds!=null&&typeof i.seconds=="number"&&o.push({int:i.seconds}),i.millis!=null&&typeof i.millis=="number"&&o.push({tag:{tagi:"80",obj:{int:i.millis}}}),i.micros!=null&&typeof i.micros=="number"&&o.push({tag:{tagi:"81",obj:{int:i.micros}}}),r({seq:o}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.Accuracy,f.asn1.ASN1Object);f.asn1.tsp.MessageImprint=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.DEROctetString,o=t.x509,s=o.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=new s({name:a.alg}),l=new i({hex:a.hash}),h=new r({array:[c,l]});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.tsp.MessageImprint,f.asn1.ASN1Object);f.asn1.tsp.TimeStampReq=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.DERInteger,o=t.DERBoolean,s=t.ASN1Object,a=t.DERObjectIdentifier,c=t.tsp,l=c.MessageImprint;c.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u=[];u.push(new i({int:1})),h.messageImprint instanceof f.asn1.ASN1Object?u.push(h.messageImprint):u.push(new l(h.messageImprint)),h.policy!=null&&u.push(new a(h.policy)),h.nonce!=null&&u.push(new i(h.nonce)),h.certreq==!0&&u.push(new o);var d=new r({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.TimeStampReq,f.asn1.ASN1Object);f.asn1.tsp.TimeStampResp=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.ASN1Object,o=t.tsp,s=o.PKIStatusInfo;o.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if(a.econtent!=null||a.tst!=null)if(a.statusinfo!=null?c.push(new s(a.statusinfo)):c.push(new s("granted")),a.econtent!=null)c.push(new o.TimeStampToken(a).getContentInfo());else if(a.tst instanceof t.ASN1Object)c.push(a.tst);else throw new Error("improper member tst value");else if(a.statusinfo!=null)c.push(new s(a.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var l=new r({array:c});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.TimeStampResp,f.asn1.ASN1Object);f.asn1.tsp.PKIStatusInfo=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.tsp,s=o.PKIStatus,a=o.PKIFreeText,c=o.PKIFailureInfo;o.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var l=this.params,h=[];if(typeof l=="string")h.push(new s(l));else{if(l.status==null)throw new e("property 'status' unspecified");h.push(new s(l.status)),l.statusstr!=null&&h.push(new a(l.statusstr)),l.failinfo!=null&&h.push(new c(l.failinfo))}var u=new i({array:h});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.PKIStatusInfo,f.asn1.ASN1Object);f.asn1.tsp.PKIStatus=function(n){var e=Error,t=f,r=t.asn1,i=r.DERInteger,o=r.tsp;o.PKIStatus.superclass.constructor.call(this);var s={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var a=this.params,c,l;if(typeof a=="string")try{l=s[a]}catch{throw new e("undefined name: "+a)}else if(typeof a=="number")l=a;else throw new e("unsupported params");return new i({int:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.PKIStatus,f.asn1.ASN1Object);f.asn1.tsp.PKIFreeText=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.DERUTF8String,s=r.tsp;s.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw new e("wrong params: not array");for(var c=[],l=0;l<a.length;l++)c.push(new o({str:a[l]}));var h=new i({array:c});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.PKIFreeText,f.asn1.ASN1Object);f.asn1.tsp.PKIFailureInfo=function(n){var e=Error,t=f,r=t.asn1,i=r.DERBitString,o=r.tsp,s=o.PKIFailureInfo,a={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};s.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var c=this.params,l=0;if(typeof c=="number"&&0<=c&&c<=25){l|=1<<c;for(var h=l.toString(2),u="",d=h.length-1;d>=0;d--)u+=h[d];return u}else{if(typeof c=="string"&&a[c]!=null)return lp([c],a);if(typeof c=="object"&&c.length!=null)return lp(c,a);throw new e("wrong params")}},this.tohex=function(){var c=this.params,l=this.getBinValue();return new i({bin:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.tsp.PKIFailureInfo,f.asn1.ASN1Object);f.asn1.tsp.AbstractTSAAdapter=function(n){this.getTSTHex=function(e,t){throw"not implemented yet"}};f.asn1.tsp.SimpleTSAAdapter=function(n){var e=f,t=e.asn1,r=t.tsp,i=e.crypto.Util.hashHex;r.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(o,s){var a=i(o,s);this.params.econtent.content.messageImprint={alg:s,hash:a},this.params.econtent.content.serial={int:this.serial++};var c=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:c};var l=new r.TimeStampToken(this.params);return l.getContentInfoEncodedHex()},n!==void 0&&(this.params=n)};H(f.asn1.tsp.SimpleTSAAdapter,f.asn1.tsp.AbstractTSAAdapter);f.asn1.tsp.FixedTSAAdapter=function(n){var e=f,t=e.asn1,r=t.tsp,i=e.crypto.Util.hashHex;r.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(o,s){var a=i(o,s);this.params.econtent.content.messageImprint={alg:s,hash:a};var c=new r.TimeStampToken(this.params);return c.getContentInfoEncodedHex()},n!==void 0&&(this.params=n)};H(f.asn1.tsp.FixedTSAAdapter,f.asn1.tsp.AbstractTSAAdapter);f.asn1.tsp.TSPUtil=new function(){};f.asn1.tsp.TSPUtil.newTimeStampToken=function(n){return new f.asn1.tsp.TimeStampToken(n)};f.asn1.tsp.TSPUtil.parseTimeStampReq=function(n){var e=new f.asn1.tsp.TSPParser;return e.getTimeStampReq(n)};f.asn1.tsp.TSPUtil.parseMessageImprint=function(n){var e=new f.asn1.tsp.TSPParser;return e.getMessageImprint(n)};f.asn1.tsp.TSPParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,s=r.getIdxbyList,a=r.getTLVbyListEx,c=r.getChildIdx,l=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],h={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(u){var d=c(u,0);if(d.length==1)return this.getPKIStatusInfo(o(u,d[0]));if(d.length>1){var p=this.getPKIStatusInfo(o(u,d[0])),m=o(u,d[1]),g=this.getToken(m);return g.statusinfo=p,g}},this.getToken=function(u){var d=new f.asn1.cms.CMSParser,p=d.getCMSSignedData(u);return this.setTSTInfo(p),p},this.setTSTInfo=function(u){var d=u.econtent;if(d.type=="tstinfo"){var p=d.content.hex,m=this.getTSTInfo(p);d.content=m}},this.getTSTInfo=function(u){var d={},p=c(u,0),m=i(u,p[1]);d.policy=bp(m);var g=o(u,p[2]);d.messageImprint=this.getMessageImprint(g);var x=i(u,p[3]);d.serial={hex:x};var b=i(u,p[4]);d.genTime={str:Ve(b)};var _=0;if(p.length>5&&u.substr(p[5],2)=="30"){var O=o(u,p[5]);d.accuracy=this.getAccuracy(O),_++}if(p.length>5+_&&u.substr(p[5+_],2)=="01"){var S=i(u,p[5+_]);S=="ff"&&(d.ordering=!0),_++}if(p.length>5+_&&u.substr(p[5+_],2)=="02"){var E=i(u,p[5+_]);d.nonce={hex:E},_++}if(p.length>5+_&&u.substr(p[5+_],2)=="a0"){var D=o(u,p[5+_]);D="30"+D.substr(2),pGeneralNames=t.getGeneralNames(D);var I=pGeneralNames[0].dn;d.tsa=I,_++}if(p.length>5+_&&u.substr(p[5+_],2)=="a1"){var y=o(u,p[5+_]);y="30"+y.substr(2);var P=t.getExtParamArray(y);d.ext=P,_++}return d},this.getAccuracy=function(u){for(var d={},p=c(u,0),m=0;m<p.length;m++){var g=u.substr(p[m],2),x=i(u,p[m]),b=parseInt(x,16);g=="02"?d.seconds=b:g=="80"?d.millis=b:g=="81"&&(d.micros=b)}return d},this.getMessageImprint=function(u){if(u.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var d={},p=c(u,0),m=s(u,0,[0,0]),g=i(u,m),x=r.hextooidstr(g),b=f.asn1.x509.OID.oid2name(x);if(b=="")throw new Error("hashAlg name undefined: "+x);var _=b,O=s(u,0,[1]);return d.alg=_,d.hash=i(u,O),d},this.getPKIStatusInfo=function(u){var d={},p=c(u,0),m=0;try{var g=i(u,p[0]),x=parseInt(g,16);d.status=l[x]}catch{}if(p.length>1&&u.substr(p[1],2)=="30"){var b=o(u,p[1]);d.statusstr=this.getPKIFreeText(b),m++}if(p.length>m&&u.substr(p[1+m],2)=="03"){var _=o(u,p[1+m]);d.failinfo=this.getPKIFailureInfo(_)}return d},this.getPKIFreeText=function(u){for(var d=[],p=c(u,0),m=0;m<p.length;m++)d.push(r.getString(u,p[m]));return d},this.getPKIFailureInfo=function(u){var d=r.getInt(u,0);return h[d]!=null?h[d]:d},this.getTimeStampReq=function(u){var d={};d.certreq=!1;var p=c(u,0);if(p.length<2)throw new Error("TimeStampReq must have at least 2 items");var m=o(u,p[1]);d.messageImprint=f.asn1.tsp.TSPUtil.parseMessageImprint(m);for(var g=2;g<p.length;g++){var x=p[g],b=u.substr(x,2);if(b=="06"){var _=i(u,x);d.policy=r.hextooidstr(_)}b=="02"&&(d.nonce=i(u,x)),b=="01"&&(d.certreq=!0)}return d}};(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});(typeof f.asn1.cades>"u"||!f.asn1.cades)&&(f.asn1.cades={});f.asn1.cades.SignaturePolicyIdentifier=function(n){var e=f,t=e.asn1,r=t.cades,i=r.SignaturePolicyId;r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new i(this.params)]},this.setByParam=function(o){this.params=o},n!=null&&this.setByParam(n)};H(f.asn1.cades.SignaturePolicyIdentifier,f.asn1.cms.Attribute);f.asn1.cades.SignaturePolicyId=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.DERObjectIdentifier,o=t.x509,s=o.AlgorithmIdentifier,a=t.cades,c=a.SignaturePolicyId,l=a.OtherHashAlgAndValue;c.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u=[];u.push(new i(h.oid)),u.push(new l(h));var d=new r({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},n!=null&&this.setByParam(n)};H(f.asn1.cades.SignaturePolicyId,f.asn1.ASN1Object);f.asn1.cades.OtherHashAlgAndValue=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.DEROctetString,s=r.x509,a=s.AlgorithmIdentifier,c=r.cades,l=c.OtherHashAlgAndValue;l.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params;if(h.alg==null)throw new e("property 'alg' not specified");if(h.hash==null&&h.cert==null)throw new e("property 'hash' nor 'cert' not specified");var u=null;if(h.hash!=null)u=h.hash;else if(h.cert!=null){if(typeof h.cert!="string")throw new e("cert not string");var d=h.cert;h.cert.indexOf("-----BEGIN")!=-1&&(d=_t(h.cert)),u=f.crypto.Util.hashHex(d,h.alg)}var p=[];p.push(new a({name:h.alg})),p.push(new o({hex:u}));var m=new i({array:p});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cades.OtherHashAlgAndValue,f.asn1.ASN1Object);f.asn1.cades.OtherHashValue=function(n){f.asn1.cades.OtherHashValue.superclass.constructor.call(this);var e=Error,t=f,r=t.lang.String.isHex,i=t.asn1,o=i.DEROctetString,s=t.crypto.Util.hashHex;this.params=null,this.tohex=function(){var a=this.params;if(a.hash==null&&a.cert==null)throw new e("hash or cert not specified");var c=null;if(a.hash!=null)c=a.hash;else if(a.cert!=null){if(typeof a.cert!="string")throw new e("cert not string");var l=a.cert;a.cert.indexOf("-----BEGIN")!=-1&&(l=_t(a.cert)),c=f.crypto.Util.hashHex(l,"sha1")}return new o({hex:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cades.OtherHashValue,f.asn1.ASN1Object);f.asn1.cades.SignatureTimeStamp=function(n){var e=Error,t=f,r=t.lang.String.isHex,i=t.asn1,o=i.ASN1Object,s=i.x509,a=i.cades;a.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var c=this.params;if(c.tst!=null)if(r(c.tst)){var l=new o;return l.hTLV=c.tst,[l]}else{if(c.tst instanceof o)return[c.tst];throw new e("params.tst has wrong value")}else if(c.res!=null){var h=c.res;if(h instanceof o&&(h=h.tohex()),typeof h!="string"||!r(h))throw new e("params.res has wrong value");var u=$.getTLVbyList(h,0,[1]),l=new o;return l.hTLV=c.tst,[l]}},n!=null&&this.setByParam(n)};H(f.asn1.cades.SignatureTimeStamp,f.asn1.cms.Attribute);f.asn1.cades.CompleteCertificateRefs=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.cades,s=o.OtherCertID,a=t.lang.String.isHex;o.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var c=this.params,l=[],h=0;h<c.array.length;h++){var u=c.array[h];if(typeof u=="string")if(u.indexOf("-----BEGIN")!=-1)u={cert:u};else if(a(u))u={hash:u};else throw new e("unsupported value: "+u);c.alg!=null&&u.alg==null&&(u.alg=c.alg),c.hasis!=null&&u.hasis==null&&(u.hasis=c.hasis);var d=new s(u);l.push(d)}var p=new i({array:l});return[p]},n!=null&&this.setByParam(n)};H(f.asn1.cades.CompleteCertificateRefs,f.asn1.cms.Attribute);f.asn1.cades.OtherCertID=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.cms,o=i.IssuerSerial,s=t.cades,a=s.OtherHashValue,c=s.OtherHashAlgAndValue;s.OtherCertID.superclass.constructor.call(this),this.params=n,this.tohex=function(){var l=this.params;typeof l=="string"&&(l.indexOf("-----BEGIN")!=-1?l={cert:l}:_isHex(l)&&(l={hash:l}));var h=[],u=null;if(l.alg!=null?u=new c(l):u=new a(l),h.push(u),l.cert!=null&&l.hasis==!0||l.issuer!=null&&l.serial!=null){var d=new o(l);h.push(d)}var p=new r({array:h});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cades.OtherCertID,f.asn1.ASN1Object);f.asn1.cades.OtherHash=function(n){var e=Error,t=f,r=t.asn1,i=r.cms,o=r.cades,s=o.OtherHashAlgAndValue,a=o.OtherHashValue,c=t.crypto.Util.hashHex,l=t.lang.String.isHex;o.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params;typeof h=="string"&&(h.indexOf("-----BEGIN")!=-1?h={cert:h}:l(h)&&(h={hash:h}));var u=null;return h.alg!=null?u=new s(h):u=new a(h),u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};H(f.asn1.cades.OtherHash,f.asn1.ASN1Object);f.asn1.cades.CAdESUtil=new function(){};f.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(n){var e=new f.asn1.cms.CMSParser,t=e.getCMSSignedData(n);return t};f.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(n,e,t){var r=$,i=r.getChildIdx,o=r.getTLV,s=r.getV,a=f,c=a.asn1,l=c.ASN1Object,h=c.cms,u=h.AttributeList,d=h.SignerInfo,p={},m=i(n,e);if(m.length!=6)throw"not supported items for SignerInfo (!=6)";var g=m.shift();p.version=o(n,g);var x=m.shift();p.si=o(n,x);var b=m.shift();p.digalg=o(n,b);var _=m.shift();p.sattrs=o(n,_);var O=m.shift();p.sigalg=o(n,O);var S=m.shift();p.sig=o(n,S),p.sigval=s(n,S);var E=null;return p.obj=new d,E=new l,E.hTLV=p.version,p.obj.dCMSVersion=E,E=new l,E.hTLV=p.si,p.obj.dSignerIdentifier=E,E=new l,E.hTLV=p.digalg,p.obj.dDigestAlgorithm=E,E=new l,E.hTLV=p.sattrs,p.obj.dSignedAttrs=E,E=new l,E.hTLV=p.sigalg,p.obj.dSigAlg=E,E=new l,E.hTLV=p.sig,p.obj.dSig=E,p.obj.dUnsignedAttrs=new u,p};(typeof f.asn1.csr>"u"||!f.asn1.csr)&&(f.asn1.csr={});f.asn1.csr.CertificationRequest=function(n){var e=f,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.csr,s=t.x509,a=o.CertificationRequestInfo;o.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(c){this.params=c},this.sign=function(){var c=new a(this.params).tohex(),l=new f.crypto.Signature({alg:this.params.sigalg});l.init(this.params.sbjprvkey),l.updateHex(c);var h=l.sign();this.params.sighex=h},this.getPEM=function(){return dn(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var c=this.params,l=new f.asn1.csr.CertificationRequestInfo(this.params),h=new f.asn1.x509.AlgorithmIdentifier({name:c.sigalg});if(c.sighex==null&&c.sbjprvkey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var u=new r({hex:"00"+c.sighex}),d=new i({array:[l,h,u]});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.csr.CertificationRequest,f.asn1.ASN1Object);f.asn1.csr.CertificationRequestInfo=function(n){var e=f,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.DERInteger,s=t.DERUTF8String,a=t.DERTaggedObject,c=t.ASN1Util.newObject,l=t.csr,h=t.x509,u=h.X500Name,d=h.Extensions,p=h.SubjectPublicKeyInfo,m=l.AttributeList;l.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(x){x!=null&&(this.params=x)},this.tohex=function(){var x=this.params,b=[];if(b.push(new o({int:0})),b.push(new u(x.subject)),b.push(new p(Me.getKey(x.sbjpubkey))),x.attrs!=null){var _=g(x.attrs),O=c({tag:{tage:"a0",obj:_}});b.push(O)}else if(x.extreq!=null){var S=new d(x.extreq),O=c({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[S]}]}}});b.push(O)}else b.push(new a({tag:"a0",explicit:!1,obj:new s({str:""})}));var E=new i({array:b});return E.tohex()},this.getEncodedHex=function(){return this.tohex()};function g(x){for(var b=Error,_=f.asn1.x509.Extensions,O=[],S=0;S<x.length;S++){var E=x[S],D=E.attr;if(D=="extensionRequest"){var I=new _(E.ext),y={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[I]}]};O.push(y)}else if(D=="unstructuredName"){var y={seq:[{oid:"1.2.840.113549.1.9.2"},{set:E.names}]};O.push(y)}else if(D=="challengePassword"){var y={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:E.password}]}]};O.push(y)}else throw new b("unknown CSR attribute")}return{set:O}}n!=null&&this.setByParam(n)};H(f.asn1.csr.CertificationRequestInfo,f.asn1.ASN1Object);f.asn1.csr.AttributeList=function(n){function e(t){}};H(f.asn1.csr.AttributeList,f.asn1.ASN1Object);f.asn1.csr.CSRUtil=new function(){};f.asn1.csr.CSRUtil.newCSRPEM=function(n){var e=Me,t=f.asn1.csr,r=new t.CertificationRequest(n),i=r.getPEM();return i};f.asn1.csr.CSRUtil.getParam=function(n,e){var t=$,r=t.getV,i=t.getIdxbyList,o=t.getTLVbyList,s=t.getTLVbyListEx,a=t.getVbyListEx,c=function(_){var O=i(_,0,[0,3,0,0],"06");return r(_,O)!="2a864886f70d01090e"?null:o(_,0,[0,3,0,1,0],"30")},l={};if(n.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var h=_t(n,"CERTIFICATE REQUEST");e&&(l.tbs=o(h,0,[0]));try{var u=s(h,0,[0,1]);if(u=="3000")l.subject={};else{var g=new he;l.subject=g.getX500Name(u)}}catch{}var d=s(h,0,[0,2]),p=Me.getKey(d,null,"pkcs8pub");l.sbjpubkey=Me.getPEM(p,"PKCS8PUB");var m=c(h),g=new he;m!=null&&(l.extreq=g.getExtParamArray(m));try{var x=s(h,0,[1],"30"),g=new he;l.sigalg=g.getAlgorithmIdentifierName(x)}catch{}try{var b=a(h,0,[2]);l.sighex=b}catch{}return l};f.asn1.csr.CSRUtil.verifySignature=function(n){try{var e=null;if(typeof n=="string"&&n.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?e=f.asn1.csr.CSRUtil.getParam(n,!0):typeof n=="object"&&n.sbjpubkey!=null&&n.sigalg!=null&&n.sighex!=null&&n.tbs!=null&&(e=n),e==null)return!1;var t=new f.crypto.Signature({alg:e.sigalg});return t.init(e.sbjpubkey),t.updateHex(e.tbs),t.verify(e.sighex)}catch(r){return alert(r),!1}};(typeof f>"u"||!f)&&(f={});(typeof f.asn1>"u"||!f.asn1)&&(f.asn1={});(typeof f.asn1.ocsp>"u"||!f.asn1.ocsp)&&(f.asn1.ocsp={});f.asn1.ocsp.DEFAULT_HASH="sha1";f.asn1.ocsp.OCSPResponse=function(n){f.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var e=f.asn1.DEREnumerated,t=f.asn1.ASN1Util.newObject,r=f.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var o=this.params.resstatus;return typeof o=="number"?o:typeof o!="string"?-1:i.indexOf(o)},this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params,s=this._getStatusCode();if(s==-1)throw new Error("responseStatus not supported: "+o.resstatus);if(s!=0)return t({seq:[{enum:{int:s}}]}).tohex();var a=new r(o);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:a}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.OCSPResponse,f.asn1.ASN1Object);f.asn1.ocsp.ResponseBytes=function(n){f.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var e=f.asn1,t=e.DERSequence,r=e.DERObjectIdentifier,i=e.DEROctetString,o=e.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params;if(s.restype!="ocspBasic")throw new Error("not supported responseType: "+s.restype);var a=new o(s),c=[];c.push(new r({name:"ocspBasic"})),c.push(new i({hex:a.tohex()}));var l=new t({array:c});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.ResponseBytes,f.asn1.ASN1Object);f.asn1.ocsp.BasicOCSPResponse=function(n){f.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var e=Error,t=f.asn1,r=t.ASN1Object,i=t.DERSequence,o=t.DERGeneralizedTime,s=t.DERTaggedObject,a=t.DERBitString,c=t.x509.Extensions,l=t.x509.AlgorithmIdentifier,h=t.ocsp,u=h.ResponderID;_SingleResponseList=h.SingleResponseList,_ResponseData=h.ResponseData,this.params=null,this.setByParam=function(d){this.params=d},this.sign=function(){var d=this.params,p=d.tbsresp.tohex(),m=new f.crypto.Signature({alg:d.sigalg});m.init(d.reskey),m.updateHex(p),d.sighex=m.sign()},this.tohex=function(){var d=this.params;d.tbsresp==null&&(d.tbsresp=new _ResponseData(d)),d.sighex==null&&d.reskey!=null&&this.sign();var p=[];if(p.push(d.tbsresp),p.push(new l({name:d.sigalg})),p.push(new a({hex:"00"+d.sighex})),d.certs!=null&&d.certs.length!=null){for(var m=[],g=0;g<d.certs.length;g++){var x=d.certs[g],b=null;if($.isASN1HEX(x))b=x;else if(x.match(/-----BEGIN/))b=_t(x);else throw new e("certs["+g+"] not hex or PEM");m.push(new r({tlv:b}))}var _=new i({array:m});p.push(new s({tag:"a0",explicit:!0,obj:_}))}var O=new i({array:p});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.BasicOCSPResponse,f.asn1.ASN1Object);f.asn1.ocsp.ResponseData=function(n){f.asn1.ocsp.ResponseData.superclass.constructor.call(this);var e=Error,t=f.asn1,r=t.DERSequence,i=t.DERGeneralizedTime,o=t.DERTaggedObject,s=t.x509.Extensions,a=t.ocsp,c=a.ResponderID;_SingleResponseList=a.SingleResponseList,this.params=null,this.tohex=function(){var l=this.params;l.respid!=null&&new e("respid not specified"),l.prodat!=null&&new e("prodat not specified"),l.array!=null&&new e("array not specified");var h=[];if(h.push(new c(l.respid)),h.push(new i(l.prodat)),h.push(new _SingleResponseList(l.array)),l.ext!=null){var u=new s(l.ext);h.push(new o({tag:"a1",explicit:!0,obj:u}))}var d=new r({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(l){this.params=l},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.ResponseData,f.asn1.ASN1Object);f.asn1.ocsp.ResponderID=function(n){f.asn1.ocsp.ResponderID.superclass.constructor.call(this);var e=f,t=e.asn1,r=t.ASN1Util.newObject,i=t.x509.X500Name,o=e.lang.String.isHex,s=Error;this.params=null,this.tohex=function(){var a=this.params;if(a.key!=null){var c=null;if(typeof a.key=="string"){if(o(a.key)&&(c=a.key),a.key.match(/-----BEGIN CERTIFICATE/)){var l=new he(a.key),h=l.getExtSubjectKeyIdentifier();h!=null&&(c=h.kid.hex)}}else if(a.key instanceof he){var h=a.key.getExtSubjectKeyIdentifier();h!=null&&(c=h.kid.hex)}if(c==null)throw new s("wrong key member value");var u=r({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:c}}}});return u.tohex()}else if(a.name!=null){var d=null;if(typeof a.name=="string"&&a.name.match(/-----BEGIN CERTIFICATE/)){var l=new he(a.name);d=l.getSubject()}else a.name instanceof he?d=a.name.getSubject():typeof a.name=="object"&&(a.name.array!=null||a.name.str!=null)&&(d=a.name);if(d==null)throw new s("wrong name member value");var u=r({tag:{tag:"a1",explicit:!0,obj:new i(d)}});return u.tohex()}throw new s("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.ResponderID,f.asn1.ASN1Object);f.asn1.ocsp.SingleResponseList=function(n){f.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var e=f.asn1,t=e.DERSequence,r=e.ocsp.SingleResponse;this.params=null,this.tohex=function(){var i=this.params;if(typeof i!="object"||i.length==null)throw new Error("params not specified properly");for(var o=[],s=0;s<i.length;s++)o.push(new r(i[s]));var a=new t({array:o});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.SingleResponseList,f.asn1.ASN1Object);f.asn1.ocsp.SingleResponse=function(n){var e=Error,t=f,r=t.asn1,i=r.DERSequence,o=r.DERGeneralizedTime,s=r.DERTaggedObject,a=r.ocsp,c=a.CertID,l=a.CertStatus,h=r.x509,u=h.Extensions;a.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,p=[];if(d.certid==null)throw new e("certid unspecified");if(d.status==null)throw new e("status unspecified");if(d.thisupdate==null)throw new e("thisupdate unspecified");if(p.push(new c(d.certid)),p.push(new l(d.status)),p.push(new o(d.thisupdate)),d.nextupdate!=null){var m=new o(d.nextupdate);p.push(new s({tag:"a0",explicit:!0,obj:m}))}if(d.ext!=null){var g=new u(d.ext);p.push(new s({tag:"a1",explicit:!0,obj:g}))}var x=new i({array:p});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.SingleResponse,f.asn1.ASN1Object);f.asn1.ocsp.CertID=function(n){var e=f,t=e.asn1,r=t.DEROctetString,i=t.DERInteger,o=t.DERSequence,s=t.x509,a=s.AlgorithmIdentifier,c=t.ocsp,l=c.DEFAULT_HASH,h=e.crypto,u=h.Util.hashHex,d=he,p=$,m=p.getVbyList;c.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(g,x,b,_){_==null&&(_=this.DEFAULT_HASH),this.params={alg:_,issname:g,isskey:x,sbjsn:b}},this.setByCert=function(g,x,b){b==null&&(b=this.DEFAULT_HASH),this.params={alg:b,issuerCert:g,subjectCert:x}},this.getParamByCerts=function(g,x,b){b==null&&(b=this.DEFAULT_HASH);var _=new d(g),O=new d(x),S=u(_.getSubjectHex(),b),E=_.getPublicKeyHex(),D=u(m(E,0,[1],"03",!0),b),I=O.getSerialNumberHex(),y={alg:b,issname:S,isskey:D,sbjsn:I};return y},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var g=this.params,x,b,_,O;if(g.alg==null?O=this.DEFAULT_HASH:O=g.alg,g.issuerCert!=null&&g.subjectCert!=null){var S=this.getParamByCerts(g.issuerCert,g.subjectCert,O);x=S.issname,b=S.isskey,_=S.sbjsn}else if(g.issname!=null&&g.isskey!=null&&g.sbjsn!=null)x=g.issname,b=g.isskey,_=g.sbjsn;else throw new Error("required param members not defined");var E=new a({name:O}),D=new r({hex:x}),I=new r({hex:b}),y=new i({hex:_}),P=new o({array:[E,D,I,y]});return this.hTLV=P.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.CertID,f.asn1.ASN1Object);f.asn1.ocsp.CertStatus=function(n){f.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(e.status=="good")return"8000";if(e.status=="unknown")return"8200";if(e.status=="revoked"){var t=[{gentime:{str:e.time}}];e.reason!=null&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var r={tag:"a1",explicit:!1,obj:{seq:t}};return f.asn1.ASN1Util.newObject({tag:r}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},n!==void 0&&this.setByParam(n)};H(f.asn1.ocsp.CertStatus,f.asn1.ASN1Object);f.asn1.ocsp.Request=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var s=[];if(this.dReqCert===null)throw"reqCert not set";s.push(this.dReqCert);var a=new r({array:s});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof n<"u"){var o=new i.CertID(n);this.dReqCert=o}};H(f.asn1.ocsp.Request,f.asn1.ASN1Object);f.asn1.ocsp.TBSRequest=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(o){for(var s=[],a=0;a<o.length;a++){var c=new i.Request(o[0]);s.push(c)}this.dRequestList=s},this.tohex=function(){var o=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var s=new r({array:this.dRequestList});if(o.push(s),this.dRequestExt!==null)throw"requestExtensions not supported";var a=new r({array:o});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&n.reqList!==void 0&&this.setRequestListByParam(n.reqList)};H(f.asn1.ocsp.TBSRequest,f.asn1.ASN1Object);f.asn1.ocsp.OCSPRequest=function(n){var e=f,t=e.asn1,r=t.DERSequence,i=t.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var s=[];if(this.dTbsRequest!==null)s.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var a=new r({array:s});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&n.reqList!==void 0){var o=new i.TBSRequest(n);this.dTbsRequest=o}};H(f.asn1.ocsp.OCSPRequest,f.asn1.ASN1Object);f.asn1.ocsp.OCSPUtil={};f.asn1.ocsp.OCSPUtil.getRequestHex=function(n,e,t){var r=f,i=r.asn1,o=i.ocsp;t===void 0&&(t=o.DEFAULT_HASH);var s={alg:t,issuerCert:n,subjectCert:e},a=new o.OCSPRequest({reqList:[s]});return a.tohex()};f.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(n){var e=$,t=e.getVbyList,r=e.getVbyListEx,i=e.getIdxbyList,o=e.getIdxbyListEx,s=e.getV,a={};try{var c=r(n,0,[0],"0a");a.responseStatus=parseInt(c,16)}catch{}if(a.responseStatus!==0)return a;try{var l=i(n,0,[1,0,1,0,0,2,0,1]);n.substr(l,2)==="80"?a.certStatus="good":n.substr(l,2)==="a1"?(a.certStatus="revoked",a.revocationTime=Ve(t(n,l,[0]))):n.substr(l,2)==="82"&&(a.certStatus="unknown")}catch{}try{var h=i(n,0,[1,0,1,0,0,2,0,2]);a.thisUpdate=Ve(s(n,h))}catch{}try{var u=i(n,0,[1,0,1,0,0,2,0,3]);n.substr(u,2)==="a0"&&(a.nextUpdate=Ve(t(n,u,[0])))}catch{}return a};f.asn1.ocsp.OCSPParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,s=r.getIdxbyList,a=r.getVbyList,c=r.getTLVbyList,l=r.getVbyListEx,h=r.getTLVbyListEx,u=r.getChildIdx;this.getOCSPRequest=function(d){var p=u(d,0);if(p.length!=1&&p.length!=2)throw new n("wrong number elements: "+p.length);var m=this.getTBSRequest(o(d,p[0]));return m},this.getTBSRequest=function(d){var p={},m=h(d,0,[0],"30");p.array=this.getRequestList(m);var g=h(d,0,["[2]",0],"30");return g!=null&&(p.ext=t.getExtParamArray(g)),p},this.getRequestList=function(d){for(var p=[],m=u(d,0),g=0;g<m.length;g++){var d=o(d,m[g]);p.push(this.getRequest(d))}return p},this.getRequest=function(d){var p=u(d,0);if(p.length!=1&&p.length!=2)throw new n("wrong number elements: "+p.length);var m=this.getCertID(o(d,p[0]));if(p.length==2){var g=s(d,0,[1,0]);m.ext=t.getExtParamArray(o(d,g))}return m},this.getCertID=function(d){var p=u(d,0);if(p.length!=4)throw new n("wrong number elements: "+p.length);var m=new e,g={};return g.alg=m.getAlgorithmIdentifierName(o(d,p[0])),g.issname=i(d,p[1]),g.isskey=i(d,p[2]),g.sbjsn=i(d,p[3]),g},this.getOCSPResponse=function(d){var p=u(d,0),m,g=i(d,p[0]),x=parseInt(g);if(p.length==1)return{resstatus:x};var b=c(d,0,[1,0]);return m=this.getResponseBytes(b),m.resstatus=x,m},this.getResponseBytes=function(d){var p=u(d,0),m,g=c(d,0,[1,0]);m=this.getBasicOCSPResponse(g);var x=i(d,p[0]);return m.restype=f.asn1.x509.OID.oid2name(bp(x)),m},this.getBasicOCSPResponse=function(d){var p=u(d,0),m;m=this.getResponseData(o(d,p[0]));var g=new he;m.alg=g.getAlgorithmIdentifierName(o(d,p[1]));var x=i(d,p[2]);m.sighex=x.substr(2);var b=l(d,0,["[0]"]);if(b!=null){for(var _=u(b,0),O=[],S=0;S<_.length;S++){var E=o(b,_[S]);O.push(E)}m.certs=O}return m},this.getResponseData=function(d){var p=u(d,0),m=p.length,g={},x=0;d.substr(p[0],2)=="a0"&&x++,g.respid=this.getResponderID(o(d,p[x++]));var b=i(d,p[x++]);if(g.prodat=Ve(b),g.array=this.getSingleResponseList(o(d,p[x++])),d.substr(p[m-1],2)=="a1"){var _=c(d,p[m-1],[0]),O=new he;g.ext=O.getExtParamArray(_)}return g},this.getResponderID=function(d){var p={};if(d.substr(0,2)=="a2"){var m=a(d,0,[0]);p.key=m}if(d.substr(0,2)=="a1"){var g=c(d,0,[0]),x=new he;p.name=x.getX500Name(g)}return p},this.getSingleResponseList=function(d){for(var p=u(d,0),m=[],g=0;g<p.length;g++){var x=this.getSingleResponse(o(d,p[g]));m.push(x)}return m},this.getSingleResponse=function(d){var p=u(d,0),m={},g=this.getCertID(o(d,p[0]));m.certid=g;var x=this.getCertStatus(o(d,p[1]));if(m.status=x,d.substr(p[2],2)=="18"){var b=i(d,p[2]);m.thisupdate=Ve(b)}for(var _=3;_<p.length;_++){if(d.substr(p[_],2)=="a0"){var O=a(d,p[_],[0],"18");m.nextupdate=Ve(O)}if(d.substr(p[_],2)=="a1"){var S=new he,E=c(d,0,[_,0]);m.ext=S.getExtParamArray(E)}}return m},this.getCertStatus=function(d){var p={};if(d=="8000")return{status:"good"};if(d=="8200")return{status:"unknown"};if(d.substr(0,2)=="a1"){p.status="revoked";var m=a(d,0,[0]),g=Ve(m);p.time=g}return p}};var f;(typeof f>"u"||!f)&&(f={});(typeof f.lang>"u"||!f.lang)&&(f.lang={});f.lang.String=function(){};function hk(n){for(var e=new Array,t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}function pk(n){for(var e="",t=0;t<n.length;t++)e=e+String.fromCharCode(n[t]);return e}function hp(n){for(var e="",t=0;t<n.length;t++){var r=n[t].toString(16);r.length==1&&(r="0"+r),e=e+r}return e}function zn(n){return hp(hk(n))}function fW(n){return Zr(zn(n))}function gW(n){return ia(Zr(zn(n)))}function mW(n){return pk(sk(ll(n)))}function ia(n){return n=n.replace(/\=/g,""),n=n.replace(/\+/g,"-"),n=n.replace(/\//g,"_"),n}function ll(n){return n.length%4==2?n=n+"==":n.length%4==3&&(n=n+"="),n=n.replace(/-/g,"+"),n=n.replace(/_/g,"/"),n}function It(n){return n.length%2==1&&(n="0"+n),ia(Zr(n))}function gt(n){return oa(ll(n))}var al,vr;typeof Buffer=="function"?(al=function(n){return ia(Buffer.from(n,"utf8").toString("base64"))},vr=function(n){return Buffer.from(ll(n),"base64").toString("utf8")}):(al=function(n){return It(gp(vp(n)))},vr=function(n){return decodeURIComponent(mp(gt(n)))});function vW(n){return Zr(gp(vp(n)))}function bW(n){return decodeURIComponent(mp(oa(n)))}function pp(n){return gp(vp(n)).toLowerCase()}function Ve(n){try{return decodeURIComponent(mp(n))}catch{return null}}function xW(n){return Ve(_W(n))}function _W(n){for(var e=n.match(/.{1,2}/g),t=[],r=0;r<e.length;r++){var i=parseInt(e[r],16);161<=i&&i<=191?(t.push("c2"),t.push(e[r])):192<=i&&i<=255?(t.push("c3"),t.push((i-64).toString(16))):t.push(e[r])}return t.join("")}function In(n){for(var e="",t=0;t<n.length-1;t+=2)e+=String.fromCharCode(parseInt(n.substr(t,2),16));return e}function Nr(n){for(var e="",t=0;t<n.length;t++)e+=("0"+n.charCodeAt(t).toString(16)).slice(-2);return e}function B0(n){return Zr(n)}function yW(n){return fp(B0(n),64)}function fp(n,e){return n=n.replace(new RegExp("(.{"+e+"})","g"),`$1\r
`),n=n.replace(/\s+$/,""),n}function fk(n){var e=n.replace(/[^0-9A-Za-z\/+=]*/g,""),t=oa(e);return t}function CW(n,e){return"-----BEGIN "+e+`-----\r
`+fp(n,64)+`\r
-----END `+e+`-----\r
`}function dn(n,e){return"-----BEGIN "+e+`-----\r
`+fp(B0(n),64)+`\r
-----END `+e+`-----\r
`}function _t(n,e){if(n.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return e!==void 0?(n=n.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),""),n=n.replace(new RegExp("-----END "+e+"-----[^]*$"),"")):(n=n.replace(/^[^]*-----BEGIN [^-]+-----/,""),n=n.replace(/-----END [^-]+-----[^]*$/,"")),fk(n)}function wW(n){return n.indexOf("-----BEGIN ")==-1||n.indexOf("-----END ")==-1?null:(n=n.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),n=n.replace(/-----END [\s\S]+$/m,""),n=n.replace(/\s+/g,""),n.match(/^[0-9a-zA-Z+/=]+$/)?n:null)}function PW(n){if(n.length%2!=0)throw"input is not even length";if(n.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var e=new ArrayBuffer(n.length/2),t=new DataView(e),r=0;r<n.length/2;r++)t.setUint8(r,parseInt(n.substr(r*2,2),16));return e}function OW(n){for(var e="",t=new DataView(n),r=0;r<n.byteLength;r++)e+=("00"+t.getUint8(r).toString(16)).slice(-2);return e}function L0(n){var e,t,r,i,o,s,a,c,l,h,u,d;if(n=mk(n),d=n.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),d)return e=parseInt(d[1]),t=parseInt(d[2])-1,r=parseInt(d[3]),i=parseInt(d[4]),o=parseInt(d[5]),s=parseInt(d[6]),a=0,h=d[7],h!==""&&(u=(h.substr(1)+"00").substr(0,3),a=parseInt(u)),Date.UTC(e,t,r,i,o,s,a);throw new Error("unsupported zulu format: "+n)}function MW(n){var e=new Date(n),t=("0000"+e.getUTCFullYear()).slice(-4),r=("00"+(e.getUTCMonth()+1)).slice(-2),i=("00"+e.getUTCDate()).slice(-2),o=("00"+e.getUTCHours()).slice(-2),s=("00"+e.getUTCMinutes()).slice(-2),a=("00"+e.getUTCSeconds()).slice(-2),c=("000"+e.getUTCMilliseconds()).slice(-3);return c=c.replace(/0+$/,""),c=c!=""?"."+c:c,t+r+i+o+s+a+c+"Z"}function gk(n){return Math.round(L0(n)/1e3)}function SW(n){return new Date(L0(n))}function EW(n,e,t){var r,i=n.getUTCFullYear();if(e){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;r=(""+i).slice(-2)}else r=("000"+i).slice(-4);if(r+=("0"+(n.getUTCMonth()+1)).slice(-2),r+=("0"+n.getUTCDate()).slice(-2),r+=("0"+n.getUTCHours()).slice(-2),r+=("0"+n.getUTCMinutes()).slice(-2),r+=("0"+n.getUTCSeconds()).slice(-2),t){var o=n.getUTCMilliseconds();o!==0&&(o=("00"+o).slice(-3),o=o.replace(/0+$/g,""),r+="."+o)}return r+="Z",r}function mk(n){return n.match(/^[0-9]{12}Z$/)||n.match(/^[0-9]{12}[.][0-9]*Z$/)?n.match(/^[0-4]/)?"20"+n:"19"+n:n}function gp(n){return n.replace(/%/g,"")}function mp(n){return n.replace(/(..)/g,"%$1")}function T0(n){var e="malformed IPv6 address";if(!n.match(/^[0-9A-Fa-f:]+$/))throw e;n=n.toLowerCase();var t=n.split(":").length-1;if(t<2)throw e;var r=":".repeat(7-t+2);n=n.replace("::",r);var i=n.split(":");if(i.length!=8)throw e;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function D0(n){if(!n.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+n);n=n.toLowerCase();var e=n.match(/.{1,4}/g);e=e.map(function(i){return i.replace(/^0+/,"")}),e=e.map(function(i){return i==""?"0":i}),n=":"+e.join(":")+":";var t=n.match(/:(0:){2,}/g);if(t==null)return n.slice(1,-1);var r=t.sort().slice(-1)[0];return n=n.replace(r.substr(0,r.length-1),":"),n.substr(0,2)!="::"&&(n=n.substr(1)),n.substr(-2,2)!="::"&&(n=n.substr(0,n.length-1)),n}function ap(n){var e=new Error("malformed hex value");if(!n.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(n.length==8){var t;try{return t=parseInt(n.substr(0,2),16)+"."+parseInt(n.substr(2,2),16)+"."+parseInt(n.substr(4,2),16)+"."+parseInt(n.substr(6,2),16),t}catch{throw e}}else if(n.length==16)try{return ap(n.substr(0,8))+"/"+ik(n.substr(8))}catch{throw e}else{if(n.length==32)return D0(n);if(n.length==64){try{return D0(n.substr(0,32))+"/"+ik(n.substr(32))}catch{throw e}return}else return n}}function ik(n){var e=new Error("malformed mask"),t;try{t=new B(n,16).toString(2)}catch{throw e}if(!t.match(/^1*0*$/))throw e;return t.replace(/0+$/,"").length}function q0(n){var e=new Error("malformed IP address");if(n=n.toLowerCase(n),!n.match(/^[0-9a-f.:/]+$/))throw e;if(n.match(/^[0-9.]+$/)){var t=n.split(".");if(t.length!==4)throw e;var r="";try{for(var i=0;i<4;i++){var o=parseInt(t[i]);r+=("0"+o.toString(16)).slice(-2)}return r}catch{throw e}}else if(n.match(/^[0-9.]+\/[0-9]+$/)){var s=n.split("/");return q0(s[0])+ok(parseInt(s[1]),32)}else{if(n.match(/^[0-9a-f:]+$/)&&n.indexOf(":")!==-1)return T0(n);if(n.match(/^[0-9a-f:]+\/[0-9]+$/)&&n.indexOf(":")!==-1){var s=n.split("/");return T0(s[0])+ok(parseInt(s[1]),128)}else throw e}}function ok(n,e){if(e==32&&n==0)return"00000000";if(e==128&&n==0)return"00000000000000000000000000000000";var t=Array(n+1).join("1")+Array(e-n+1).join("0");return new B(t,2).toString(16)}function j0(n){function e(i){var o=parseInt(i.substr(0,2),16),s=parseInt(i.substr(2),16);if(o==0&s<128)return String.fromCharCode(s);if(o<8){var a=192|(o&7)<<3|(s&192)>>6,c=128|s&63;return Ve(a.toString(16)+c.toString(16))}var a=224|(o&240)>>4,c=128|(o&15)<<2|(s&192)>>6,l=128|s&63;return Ve(a.toString(16)+c.toString(16)+l.toString(16))}var t=n.match(/.{4}/g),r=t.map(e);return r.join("")}function vp(n){for(var e=encodeURIComponent(n),t="",r=0;r<e.length;r++)e[r]=="%"?(t=t+e.substr(r,3),r=r+2):t=t+"%"+zn(e[r]);return t}function AW(n){return n=n.replace(/\r\n/mg,`
`),n}function kW(n){return n=n.replace(/\r\n/mg,`
`),n=n.replace(/\n/mg,`\r
`),n}f.lang.String.isInteger=function(n){return n.match(/^[0-9]+$/)?!0:!!n.match(/^-[0-9]+$/)};f.lang.String.isHex=function(n){return vk(n)};function vk(n){return!!(n.length%2==0&&(n.match(/^[0-9a-f]+$/)||n.match(/^[0-9A-F]+$/)))}f.lang.String.isBase64=function(n){return n=n.replace(/\s+/g,""),!!(n.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&n.length%4==0)};f.lang.String.isBase64URL=function(n){return n.match(/[+/=]/)?!1:(n=ll(n),f.lang.String.isBase64(n))};function V0(n){return!!n.match(/^[0-9A-Za-z-_.]+$/)}f.lang.String.isIntegerArray=function(n){return n=n.replace(/\s+/g,""),!!n.match(/^\[[0-9,]+\]$/)};f.lang.String.isPrintable=function(n){return n.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};f.lang.String.isIA5=function(n){return n.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};f.lang.String.isMail=function(n){return n.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function F0(n){return n.length%2==1?"0"+n:n.substr(0,1)>"7"?"00"+n:n}function TW(n){n=n.replace(/^\s*\[\s*/,""),n=n.replace(/\s*\]\s*$/,""),n=n.replace(/\s*/g,"");try{var e=n.split(/,/).map(function(t,r,i){var o=parseInt(t);if(o<0||255<o)throw"integer not in range 0-255";var s=("00"+o.toString(16)).slice(-2);return s}).join("");return e}catch(t){throw"malformed integer array string: "+t}}var DW=function(n,e){var t=n.length;n.length>e.length&&(t=e.length);for(var r=0;r<t;r++)if(n.charCodeAt(r)!=e.charCodeAt(r))return r;return n.length!=e.length?t:-1};function bk(n){var e=function(a){var c=a.toString(16);return c.length==1&&(c="0"+c),c},t=function(a){var c="",l=parseInt(a,10),h=l.toString(2),u=7-h.length%7;u==7&&(u=0);for(var d="",p=0;p<u;p++)d+="0";h=d+h;for(var p=0;p<h.length-1;p+=7){var m=h.substr(p,7);p!=h.length-7&&(m="1"+m),c+=e(parseInt(m,2))}return c};try{if(!n.match(/^[0-9.]+$/))return null;var r="",i=n.split("."),o=parseInt(i[0],10)*40+parseInt(i[1],10);r+=e(o),i.splice(0,2);for(var s=0;s<i.length;s++)r+=t(i[s]);return r}catch{return null}}function bp(n){if(!vk(n))return null;try{var e=[],t=n.substr(0,2),r=parseInt(t,16);e[0]=new String(Math.floor(r/40)),e[1]=new String(r%40);for(var i=n.substr(2),o=[],s=0;s<i.length/2;s++)o.push(parseInt(i.substr(s*2,2),16));for(var a=[],c="",s=0;s<o.length;s++)o[s]&128?c=c+cp((o[s]&127).toString(2),7):(c=c+cp((o[s]&127).toString(2),7),a.push(new String(parseInt(c,2))),c="");var l=e.join(".");return a.length>0&&(l=l+"."+a.join(".")),l}catch{return null}}function xk(n){var e=new B(String(n),10);return dl(e)}function dl(n){var e=n.toString(16);if(e.substr(0,1)!="-")return e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e),e;var t=e.substr(1),r=t.length;r%2==1?r+=1:e.match(/^[0-7]/)||(r+=2);for(var i="",o=0;o<r;o++)i+="f";var s=new B(i,16),a=s.xor(n).add(B.ONE);return e=a.toString(16).replace(/^-/,""),e}var cp=function(n,e,t){return t==null&&(t="0"),n.length>=e?n:new Array(e-n.length+1).join(t)+n};function _k(n){if(n.length%2!=0||(n=n.toLowerCase(),n.match(/^[0-9a-f]+$/)==null))return-1;try{var e=n.substr(0,2);if(e=="00")return parseInt(n.substr(2),16);var t=parseInt(e,16);if(t>7)return-1;var r=n.substr(2),i=parseInt(r,16).toString(2);i=="0"&&(i="00000000"),i=i.slice(0,0-t);var o=parseInt(i,2);return o==NaN?-1:o}catch{return-1}}function yk(n){if(typeof n!="number"||n<0)return null;var e=Number(n).toString(2),t=8-e.length%8;t==8&&(t=0),e=e+cp("",t,"0");var r=parseInt(e,2).toString(16);r.length%2==1&&(r="0"+r);var i="0"+t;return i+r}function Ck(n){if(typeof n!="string"||n.length%2!=0||!n.match(/^[0-9a-f]+$/))return null;try{var e=parseInt(n.substr(0,2),16);if(e<0||7<e)return null;for(var t=n.substr(2),r="",i=0;i<t.length;i+=2){var o=t.substr(i,2),s=parseInt(o,16).toString(2);s=("0000000"+s).slice(-8),r+=s}return r.substr(0,r.length-e)}catch{return null}}function FW(n){if(typeof n!="string"||n.match(/^[01]+$/)==null)return null;try{var e=parseInt(n,2);return yk(e)}catch{return null}}function lp(n,e){for(var t=0,r=0;r<n.length;r++)t|=1<<e[n[r]];for(var i=t.toString(2),o="",r=i.length-1;r>=0;r--)o+=i[r];return o}function tt(n,r,t){if(typeof n=="object"){for(var r=String(r).split("."),i=0;i<r.length&&n;i++){var o=r[i];o.match(/^[0-9]+$/)&&(o=parseInt(o)),n=n[o]}return n||n===!1?n:t}}function H(n,e){var t=function(){};t.prototype=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)}(typeof f>"u"||!f)&&(f={});(typeof f.crypto>"u"||!f.crypto)&&(f.crypto={});f.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:Q.algo.MD5,sha1:Q.algo.SHA1,sha224:Q.algo.SHA224,sha256:Q.algo.SHA256,sha384:Q.algo.SHA384,sha512:Q.algo.SHA512,ripemd160:Q.algo.RIPEMD160},this.getDigestInfoHex=function(n,e){if(typeof this.DIGESTINFOHEAD[e]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+n},this.getPaddedDigestInfoHex=function(n,e,t){var r=this.getDigestInfoHex(n,e),i=t/4;if(r.length+22>i)throw"key is too short for SigAlg: keylen="+t+","+e;for(var o="0001",s="00"+r,a="",c=i-o.length-s.length,l=0;l<c;l+=2)a+="ff";var h=o+a+s;return h},this.hashString=function(n,e){var t=new f.crypto.MessageDigest({alg:e});return t.digestString(n)},this.hashHex=function(n,e){var t=new f.crypto.MessageDigest({alg:e});return t.digestHex(n)},this.sha1=function(n){return this.hashString(n,"sha1")},this.sha256=function(n){return this.hashString(n,"sha256")},this.sha256Hex=function(n){return this.hashHex(n,"sha256")},this.sha512=function(n){return this.hashString(n,"sha512")},this.sha512Hex=function(n){return this.hashHex(n,"sha512")},this.isKey=function(n){return n instanceof ve||n instanceof f.crypto.DSA||n instanceof f.crypto.ECDSA}};f.crypto.Util.md5=function(n){var e=new f.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return e.digestString(n)};f.crypto.Util.ripemd160=function(n){var e=new f.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return e.digestString(n)};f.crypto.Util.SECURERANDOMGEN=new ca;f.crypto.Util.getRandomHexOfNbytes=function(n){var e=new Array(n);return f.crypto.Util.SECURERANDOMGEN.nextBytes(e),hp(e)};f.crypto.Util.getRandomBigIntegerOfNbytes=function(n){return new B(f.crypto.Util.getRandomHexOfNbytes(n),16)};f.crypto.Util.getRandomHexOfNbits=function(n){var e=n%8,t=(n-e)/8,r=new Array(t+1);return f.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<e&255^255)&r[0],hp(r)};f.crypto.Util.getRandomBigIntegerOfNbits=function(n){return new B(f.crypto.Util.getRandomHexOfNbits(n),16)};f.crypto.Util.getRandomBigIntegerZeroToMax=function(n){for(var e=n.bitLength();;){var t=f.crypto.Util.getRandomBigIntegerOfNbits(e);if(n.compareTo(t)!=-1)return t}};f.crypto.Util.getRandomBigIntegerMinToMax=function(n,e){var t=n.compareTo(e);if(t==1)throw"biMin is greater than biMax";if(t==0)return n;var r=e.subtract(n),i=f.crypto.Util.getRandomBigIntegerZeroToMax(r);return i.add(n)};f.crypto.MessageDigest=function(n){var e=null,t=null,r=null;this.setAlgAndProvider=function(i,o){if(i=f.crypto.MessageDigest.getCanonicalAlgName(i),i!==null&&o===void 0&&(o=f.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&o=="cryptojs"){try{this.md=f.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(s){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+s}this.updateString=function(s){this.md.update(s)},this.updateHex=function(s){var a=Q.enc.Hex.parse(s);this.md.update(a)},this.digest=function(){var s=this.md.finalize();return s.toString(Q.enc.Hex)},this.digestString=function(s){return this.updateString(s),this.digest()},this.digestHex=function(s){return this.updateHex(s),this.digest()}}if(":sha256:".indexOf(i)!=-1&&o=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(s){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+s}this.updateString=function(s){this.md.update(s)},this.updateHex=function(s){var a=sjcl.codec.hex.toBits(s);this.md.update(a)},this.digest=function(){var s=this.md.finalize();return sjcl.codec.hex.fromBits(s)},this.digestString=function(s){return this.updateString(s),this.digest()},this.digestHex=function(s){return this.updateHex(s),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},n!==void 0&&n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0&&(this.provName=f.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};f.crypto.MessageDigest.getCanonicalAlgName=function(n){return typeof n=="string"&&(n=n.toLowerCase(),n=n.replace(/-/,"")),n};f.crypto.MessageDigest.getHashLength=function(n){var e=f.crypto.MessageDigest,t=e.getCanonicalAlgName(n);if(e.HASHLENGTH[t]===void 0)throw"not supported algorithm: "+n;return e.HASHLENGTH[t]};f.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};f.crypto.Mac=function(n){var e=null,t=null,r=null,i=null,o=null;this.setAlgAndProvider=function(s,a){if(s=s.toLowerCase(),s==null&&(s="hmacsha1"),s=s.toLowerCase(),s.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+s;a===void 0&&(a=f.crypto.Util.DEFAULTPROVIDER[s]),this.algProv=s+"/"+a;var c=s.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&a=="cryptojs"){try{var l=f.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c];this.mac=Q.algo.HMAC.create(l,this.pass)}catch(h){throw"setAlgAndProvider hash alg set fail hashAlg="+c+"/"+h}this.updateString=function(h){this.mac.update(h)},this.updateHex=function(h){var u=Q.enc.Hex.parse(h);this.mac.update(u)},this.doFinal=function(){var h=this.mac.finalize();return h.toString(Q.enc.Hex)},this.doFinalString=function(h){return this.updateString(h),this.doFinal()},this.doFinalHex=function(h){return this.updateHex(h),this.doFinal()}}},this.updateString=function(s){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(s){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(s){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(s){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(s){if(typeof s=="string"){var a=s;(s.length%2==1||!s.match(/^[0-9A-Fa-f]+$/))&&(a=Nr(s)),this.pass=Q.enc.Hex.parse(a);return}if(typeof s!="object")throw"KJUR.crypto.Mac unsupported password type: "+s;var a=null;if(s.hex!==void 0){if(s.hex.length%2!=0||!s.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+s.hex;a=s.hex}if(s.utf8!==void 0&&(a=pp(s.utf8)),s.rstr!==void 0&&(a=Nr(s.rstr)),s.b64!==void 0&&(a=oa(s.b64)),s.b64u!==void 0&&(a=gt(s.b64u)),a==null)throw"KJUR.crypto.Mac unsupported password type: "+s;this.pass=Q.enc.Hex.parse(a)},n!==void 0&&(n.pass!==void 0&&this.setPassword(n.pass),n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0&&(this.provName=f.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};f.crypto.Signature=function(n){var e=null,t=null,r=null,i=null,o=null,s=null,a=null,c=null,l=null,h=null,u=-1,d=null,p=null,m=null,g=null,x=null;if(this._setAlgNames=function(){var b=this.algName.match(/^(.+)with(.+)$/);b&&(this.mdAlgName=b[1].toLowerCase(),this.pubkeyAlgName=b[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(b,_){for(var O="",S=_/4-b.length,E=0;E<S;E++)O=O+"0";return O+b},this.setAlgAndProvider=function(b,_){if(this._setAlgNames(),_!="cryptojs/jsrsa")throw new Error("provider not supported: "+_);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new f.crypto.MessageDigest({alg:this.mdAlgName})}catch(O){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+O)}this.init=function(O,S){var E=null;try{S===void 0?E=Me.getKey(O):E=Me.getKey(O,S)}catch(D){throw"init failed:"+D}if(E.isPrivate===!0)this.prvKey=E,this.state="SIGN";else if(E.isPublic===!0)this.pubKey=E,this.state="VERIFY";else throw"init failed.:"+E},this.updateString=function(O){this.md.updateString(O)},this.updateHex=function(O){this.md.updateHex(O)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&f.crypto.ECDSA!==void 0&&(this.prvKey=new f.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ve&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof f.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof f.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(O){return this.updateString(O),this.sign()},this.signHex=function(O){return this.updateHex(O),this.sign()},this.verify=function(O){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&f.crypto.ECDSA!==void 0&&(this.pubKey=new f.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,O,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ve&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,O);if(f.crypto.ECDSA!==void 0&&this.pubKey instanceof f.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,O);if(f.crypto.DSA!==void 0&&this.pubKey instanceof f.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,O);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(b,_){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(b){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(b){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(b){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(b){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(b){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=n,n!==void 0&&(n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0?this.provName=f.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=n.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),n.psssaltlen!==void 0&&(this.pssSaltLen=n.psssaltlen),n.prvkeypem!==void 0)){if(n.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var e=Me.getKey(n.prvkeypem);this.init(e)}catch(b){throw"fatal error to load pem private key: "+b}}};f.crypto.Cipher=function(n){};f.crypto.Cipher.encrypt=function(n,e,t,r){if(tt(r,"enclag")!=null&&(t=r.encalg),typeof t=="string"&&t.substr(-4)=="-CBC"){var i=e,o=n;tt(r,"key")!=null&&(i=r.key),tt(r,"enc")!=null&&(hEnc=r.enc);var s=Q.enc.Hex.parse(i),a=Q.enc.Hex.parse(o),c=Q.enc.Hex.parse(r.iv),l;if(t=="des-EDE3-CBC")l=Q.TripleDES.encrypt(a,s,{iv:c});else if(t=="aes128-CBC"||t=="aes256-CBC")l=Q.AES.encrypt(a,s,{iv:c});else throw new Error("unsupported algorithm: "+t);return l+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")};f.crypto.Cipher.decrypt=function(n,e,t,r){if(tt(r,"enclag")!=null&&(t=r.encalg),typeof t=="string"&&t.substr(-4)=="-CBC"){var i=e,o=n;tt(r,"key")!=null&&(i=r.key),tt(r,"enc")!=null&&(o=r.enc);var s=Q.enc.Hex.parse(i),a=Q.enc.Hex.parse(o),c=Q.enc.Hex.parse(r.iv),l;if(t=="des-EDE3-CBC")l=Q.TripleDES.decrypt({ciphertext:a},s,{iv:c});else if(t=="aes128-CBC"||t=="aes256-CBC")l=Q.AES.decrypt({ciphertext:a},s,{iv:c});else throw new Error("unsupported algorithm: "+t);return Q.enc.Hex.stringify(l)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")};f.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof f>"u"||!f)&&(f={});(typeof f.crypto>"u"||!f.crypto)&&(f.crypto={});f.crypto.ECDSA=function(n){var e="secp256r1",t=null,r=null,i=null,o=Error,s=B,a=Le,c=f.crypto.ECDSA,l=f.crypto.ECParameterDB,h=c.getName,u=$,d=u.getVbyListEx,p=u.isASN1HEX,m=new ca,g=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function x(b,_,O,S){for(var E=Math.max(_.bitLength(),S.bitLength()),D=b.add2D(O),I=b.curve.getInfinity(),y=E-1;y>=0;--y)I=I.twice2D(),I.z=s.ONE,_.testBit(y)?S.testBit(y)?I=I.add2D(D):I=I.add2D(b):S.testBit(y)&&(I=I.add2D(O));return I}this.getBigRandom=function(b){return new s(b.bitLength(),m).mod(b.subtract(s.ONE)).add(s.ONE)},this.setNamedCurve=function(b){this.ecparams=l.getByName(b),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=b},this.setPrivateKeyHex=function(b){this.isPrivate=!0,this.prvKeyHex=b},this.setPublicKeyHex=function(b){this.isPublic=!0,this.pubKeyHex=b},this.getPublicKeyXYHex=function(){var b=this.pubKeyHex;if(b.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var _=this.ecparams.keycharlen;if(b.length!==2+_*2)throw"malformed public key hex length";var O={};return O.x=b.substr(2,_),O.y=b.substr(2+_),O},this.getShortNISTPCurveName=function(){var b=this.curveName;return b==="secp256r1"||b==="NIST P-256"||b==="P-256"||b==="prime256v1"?"P-256":b==="secp384r1"||b==="NIST P-384"||b==="P-384"?"P-384":b==="secp521r1"||b==="NIST P-521"||b==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var b=this.ecparams.n,_=this.getBigRandom(b),O=this.ecparams.keycharlen,S=("0000000000"+_.toString(16)).slice(-O);this.setPrivateKeyHex(S);var E=this.generatePublicKeyHex();return{ecprvhex:S,ecpubhex:E}},this.generatePublicKeyHex=function(){var b=new s(this.prvKeyHex,16),_=this.ecparams.G.multiply(b),O=_.getX().toBigInteger(),S=_.getY().toBigInteger(),E=this.ecparams.keycharlen,D=("0000000000"+O.toString(16)).slice(-E),I=("0000000000"+S.toString(16)).slice(-E),y="04"+D+I;return this.setPublicKeyHex(y),y},this.signWithMessageHash=function(b){return this.signHex(b,this.prvKeyHex)},this.signHex=function(b,_){var O=new s(_,16),S=this.ecparams.n,E=new s(b.substring(0,this.ecparams.keycharlen),16);do var D=this.getBigRandom(S),I=this.ecparams.G,y=I.multiply(D),P=y.getX().toBigInteger().mod(S);while(P.compareTo(s.ZERO)<=0);var C=D.modInverse(S).multiply(E.add(O.multiply(P))).mod(S);return c.biRSSigToASN1Sig(P,C)},this.sign=function(b,_){var O=_,S=this.ecparams.n,E=s.fromByteArrayUnsigned(b);do var D=this.getBigRandom(S),I=this.ecparams.G,y=I.multiply(D),P=y.getX().toBigInteger().mod(S);while(P.compareTo(B.ZERO)<=0);var C=D.modInverse(S).multiply(E.add(O.multiply(P))).mod(S);return this.serializeSig(P,C)},this.verifyWithMessageHash=function(b,_){return this.verifyHex(b,_,this.pubKeyHex)},this.verifyHex=function(b,_,O){try{var S,E,D=c.parseSigHex(_);S=D.r,E=D.s;var I=a.decodeFromHex(this.ecparams.curve,O),y=new s(b.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(y,S,E,I)}catch{return!1}},this.verify=function(b,_,O){var S,E;if(Bitcoin.Util.isArray(_)){var D=this.parseSig(_);S=D.r,E=D.s}else if(typeof _=="object"&&_.r&&_.s)S=_.r,E=_.s;else throw"Invalid value for signature";var I;if(O instanceof Le)I=O;else if(Bitcoin.Util.isArray(O))I=a.decodeFrom(this.ecparams.curve,O);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var y=s.fromByteArrayUnsigned(b);return this.verifyRaw(y,S,E,I)},this.verifyRaw=function(b,_,O,S){var E=this.ecparams.n,D=this.ecparams.G;if(_.compareTo(s.ONE)<0||_.compareTo(E)>=0||O.compareTo(s.ONE)<0||O.compareTo(E)>=0)return!1;var I=O.modInverse(E),y=b.multiply(I).mod(E),P=_.multiply(I).mod(E),C=D.multiply(y).add(S.multiply(P)),M=C.getX().toBigInteger().mod(E);return M.equals(_)},this.serializeSig=function(b,_){var O=b.toByteArraySigned(),S=_.toByteArraySigned(),E=[];return E.push(2),E.push(O.length),E=E.concat(O),E.push(2),E.push(S.length),E=E.concat(S),E.unshift(E.length),E.unshift(48),E},this.parseSig=function(b){var _;if(b[0]!=48)throw new Error("Signature not a valid DERSequence");if(_=2,b[_]!=2)throw new Error("First element in signature must be a DERInteger");var O=b.slice(_+2,_+2+b[_+1]);if(_+=2+b[_+1],b[_]!=2)throw new Error("Second element in signature must be a DERInteger");var S=b.slice(_+2,_+2+b[_+1]);_+=2+b[_+1];var E=s.fromByteArrayUnsigned(O),D=s.fromByteArrayUnsigned(S);return{r:E,s:D}},this.parseSigCompact=function(b){if(b.length!==65)throw"Signature has the wrong length";var _=b[0]-27;if(_<0||_>7)throw"Invalid signature type";var O=this.ecparams.n,S=s.fromByteArrayUnsigned(b.slice(1,33)).mod(O),E=s.fromByteArrayUnsigned(b.slice(33,65)).mod(O);return{r:S,s:E,i:_}},this.readPKCS5PrvKeyHex=function(b){if(p(b)===!1)throw new Error("not ASN.1 hex string");var _,O,S;try{_=d(b,0,["[0]",0],"06"),O=d(b,0,[1],"04");try{S=d(b,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=h(_),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(S),this.setPrivateKeyHex(O),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(b){if(p(b)===!1)throw new o("not ASN.1 hex string");var _,O,S,E;try{_=d(b,0,[1,0],"06"),O=d(b,0,[1,1],"06"),S=d(b,0,[2,0,1],"04");try{E=d(b,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new o("malformed PKCS#8 plain ECC private key")}if(this.curveName=h(O),this.curveName===void 0)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E),this.setPrivateKeyHex(S),this.isPublic=!1},this.readPKCS8PubKeyHex=function(b){if(p(b)===!1)throw new o("not ASN.1 hex string");var _,O,S;try{_=d(b,0,[0,0],"06"),O=d(b,0,[0,1],"06"),S=d(b,0,[1],"03")}catch{throw new o("malformed PKCS#8 ECC public key")}if(this.curveName=h(O),this.curveName===null)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(S)},this.readCertPubKeyHex=function(b,_){if(p(b)===!1)throw new o("not ASN.1 hex string");var O,S;try{O=d(b,0,[0,5,0,1],"06"),S=d(b,0,[0,5,1],"03")}catch{throw new o("malformed X.509 certificate ECC public key")}if(this.curveName=h(O),this.curveName===null)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(S)},n!==void 0&&n.curve!==void 0&&(this.curveName=n.curve),this.curveName===void 0&&(this.curveName=e),this.setNamedCurve(this.curveName),n!==void 0&&(n.prv!==void 0&&this.setPrivateKeyHex(n.prv),n.pub!==void 0&&this.setPublicKeyHex(n.pub))};f.crypto.ECDSA.parseSigHex=function(n){var e=f.crypto.ECDSA.parseSigHexInHexRS(n),t=new B(e.r,16),r=new B(e.s,16);return{r:t,s:r}};f.crypto.ECDSA.parseSigHexInHexRS=function(n){var e=$,t=e.getChildIdx,r=e.getV;if(e.checkStrictDER(n,0),n.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var i=t(n,0);if(i.length!=2)throw new Error("signature shall have two elements");var o=i[0],s=i[1];if(n.substr(o,2)!="02")throw new Error("1st item not ASN.1 integer");if(n.substr(s,2)!="02")throw new Error("2nd item not ASN.1 integer");var a=r(n,o),c=r(n,s);return{r:a,s:c}};f.crypto.ECDSA.asn1SigToConcatSig=function(n){var e=f.crypto.ECDSA.parseSigHexInHexRS(n),t=e.r,r=e.s;if(t.length>=130&&t.length<=134){if(t.length%2!=0)throw Error("unknown ECDSA sig r length error");if(r.length%2!=0)throw Error("unknown ECDSA sig s length error");t.substr(0,2)=="00"&&(t=t.substr(2)),r.substr(0,2)=="00"&&(r=r.substr(2));var i=Math.max(t.length,r.length);return t=("000000"+t).slice(-i),r=("000000"+r).slice(-i),t+r}if(t.substr(0,2)=="00"&&t.length%32==2&&(t=t.substr(2)),r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),t.length%32==30&&(t="00"+t),r.length%32==30&&(r="00"+r),t.length%32!=0)throw Error("unknown ECDSA sig r length error");if(r.length%32!=0)throw Error("unknown ECDSA sig s length error");return t+r};f.crypto.ECDSA.concatSigToASN1Sig=function(n){if(n.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var e=n.substr(0,n.length/2),t=n.substr(n.length/2);return f.crypto.ECDSA.hexRSSigToASN1Sig(e,t)};f.crypto.ECDSA.hexRSSigToASN1Sig=function(n,e){var t=new B(n,16),r=new B(e,16);return f.crypto.ECDSA.biRSSigToASN1Sig(t,r)};f.crypto.ECDSA.biRSSigToASN1Sig=function(n,e){var t=f.asn1,r=new t.DERInteger({bigint:n}),i=new t.DERInteger({bigint:e}),o=new t.DERSequence({array:[r,i]});return o.tohex()};f.crypto.ECDSA.getName=function(n){return n==="2b8104001f"?"secp192k1":n==="2a8648ce3d030107"?"secp256r1":n==="2b8104000a"?"secp256k1":n==="2b81040021"?"secp224r1":n==="2b81040022"?"secp384r1":n==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(n)!==-1?"secp256r1":"|secp256k1|".indexOf(n)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(n)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(n)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(n)!==-1?"secp521r1":null};(typeof f>"u"||!f)&&(f={});(typeof f.crypto>"u"||!f.crypto)&&(f.crypto={});f.crypto.ECParameterDB=new function(){var n={},e={};function t(r){return new B(r,16)}this.getByName=function(r){var i=r;if(typeof e[i]<"u"&&(i=e[r]),typeof n[i]<"u")return n[i];throw"unregistered EC curve name: "+i},this.regist=function(r,i,o,s,a,c,l,h,u,d,p,m){n[r]={};var g=t(o),x=t(s),b=t(a),_=t(c),O=t(l),S=new ei(g,x,b),E=S.decodePointHex("04"+h+u);n[r].name=r,n[r].keylen=i,n[r].keycharlen=Math.ceil(i/8)*2,n[r].curve=S,n[r].G=E,n[r].n=_,n[r].h=O,n[r].oid=p,n[r].info=m;for(var D=0;D<d.length;D++)e[d[D]]=r}};f.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");f.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");f.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");f.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);f.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);f.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);f.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);f.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);f.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);f.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof f>"u"||!f)&&(f={});(typeof f.crypto>"u"||!f.crypto)&&(f.crypto={});f.crypto.DSA=function(){var n=$,e=n.getVbyList,t=n.getVbyListEx,r=n.isASN1HEX,i=B;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(o,s,a,c,l){this.isPrivate=!0,this.p=o,this.q=s,this.g=a,this.y=c,this.x=l},this.setPrivateHex=function(o,s,a,c,l){var h,u,d,p,m;h=new B(o,16),u=new B(s,16),d=new B(a,16),typeof c=="string"&&c.length>1?p=new B(c,16):p=null,m=new B(l,16),this.setPrivate(h,u,d,p,m)},this.setPublic=function(o,s,a,c){this.isPublic=!0,this.p=o,this.q=s,this.g=a,this.y=c,this.x=null},this.setPublicHex=function(o,s,a,c){var l,h,u,d;l=new B(o,16),h=new B(s,16),u=new B(a,16),d=new B(c,16),this.setPublic(l,h,u,d)},this.signWithMessageHash=function(o){var s=this.p,a=this.q,c=this.g,l=this.y,h=this.x,u=f.crypto.Util.getRandomBigIntegerMinToMax(B.ONE.add(B.ONE),a.subtract(B.ONE)),d=o.substr(0,a.bitLength()/4),p=new B(d,16),m=c.modPow(u,s).mod(a),g=u.modInverse(a).multiply(p.add(h.multiply(m))).mod(a),x=f.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:m}},{int:{bigint:g}}]});return x},this.verifyWithMessageHash=function(o,s){var a=this.p,c=this.q,l=this.g,h=this.y,u=this.parseASN1Signature(s),d=u[0],p=u[1],m=o.substr(0,c.bitLength()/4),g=new B(m,16);if(B.ZERO.compareTo(d)>0||d.compareTo(c)>0||B.ZERO.compareTo(p)>=0||p.compareTo(c)>0)throw"invalid DSA signature";var x=p.modInverse(c),b=g.multiply(x).mod(c),_=d.multiply(x).mod(c),O=l.modPow(b,a).multiply(h.modPow(_,a)).mod(a).mod(c);return O.compareTo(d)==0},this.parseASN1Signature=function(o){try{var s=new i(t(o,0,[0],"02"),16),a=new i(t(o,0,[1],"02"),16);return[s,a]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(o){var s,a,c,l,h;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{s=t(o,0,[1],"02"),a=t(o,0,[2],"02"),c=t(o,0,[3],"02"),l=t(o,0,[4],"02"),h=t(o,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(s,a,c,l,h)},this.readPKCS8PrvKeyHex=function(o){var s,a,c,l;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{s=t(o,0,[1,1,0],"02"),a=t(o,0,[1,1,1],"02"),c=t(o,0,[1,1,2],"02"),l=t(o,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(s,a,c,null,l)},this.readPKCS8PubKeyHex=function(o){var s,a,c,l;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{s=t(o,0,[0,1,0],"02"),a=t(o,0,[0,1,1],"02"),c=t(o,0,[0,1,2],"02"),l=t(o,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(s,a,c,l)},this.readCertPubKeyHex=function(o,s){var a,c,l,h;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{a=t(o,0,[0,5,0,1,0],"02"),c=t(o,0,[0,5,0,1,1],"02"),l=t(o,0,[0,5,0,1,2],"02"),h=t(o,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(a,c,l,h)}};var Me=function(){var n=function(g,x,b){return r(Q.AES,g,x,b)},e=function(g,x,b){return r(Q.TripleDES,g,x,b)},t=function(g,x,b){return r(Q.DES,g,x,b)},r=function(g,x,b,_){var O=Q.enc.Hex.parse(x),S=Q.enc.Hex.parse(b),E=Q.enc.Hex.parse(_),D={};D.key=S,D.iv=E,D.ciphertext=O;var I=g.decrypt(D,S,{iv:E});return Q.enc.Hex.stringify(I)},i=function(g,x,b){return a(Q.AES,g,x,b)},o=function(g,x,b){return a(Q.TripleDES,g,x,b)},s=function(g,x,b){return a(Q.DES,g,x,b)},a=function(g,x,b,_){var O=Q.enc.Hex.parse(x),S=Q.enc.Hex.parse(b),E=Q.enc.Hex.parse(_),D=g.encrypt(O,S,{iv:E}),I=Q.enc.Hex.parse(D.toString()),y=Q.enc.Base64.stringify(I);return y},c={"AES-256-CBC":{proc:n,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:n,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:n,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:o,keylen:24,ivlen:8},"DES-CBC":{proc:t,eproc:s,keylen:8,ivlen:8}},l=function(g){return c[g].proc},h=function(g){var x=Q.lib.WordArray.random(g),b=Q.enc.Hex.stringify(x);return b},u=function(g){var x={},b=g.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));b&&(x.cipher=b[1],x.ivsalt=b[2]);var _=g.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));_&&(x.type=_[1]);var O=-1,S=0;g.indexOf(`\r
\r
`)!=-1&&(O=g.indexOf(`\r
\r
`),S=2),g.indexOf(`

`)!=-1&&(O=g.indexOf(`

`),S=1);var E=g.indexOf("-----END");if(O!=-1&&E!=-1){var D=g.substring(O+S*2,E-S);D=D.replace(/\s+/g,""),x.data=D}return x},d=function(g,x,b){for(var _=b.substring(0,16),O=Q.enc.Hex.parse(_),S=Q.enc.Utf8.parse(x),E=c[g].keylen+c[g].ivlen,D="",I=null;;){var y=Q.algo.MD5.create();if(I!=null&&y.update(I),y.update(S),y.update(O),I=y.finalize(),D=D+Q.enc.Hex.stringify(I),D.length>=E*2)break}var P={};return P.keyhex=D.substr(0,c[g].keylen*2),P.ivhex=D.substr(c[g].keylen*2,c[g].ivlen*2),P},p=function(g,x,b,_){var O=Q.enc.Base64.parse(g),S=Q.enc.Hex.stringify(O),E=c[x].proc,D=E(S,b,_);return D},m=function(g,x,b,_){var O=c[x].eproc,S=O(g,b,_);return S};return{version:"1.0.0",parsePKCS5PEM:function(g){return u(g)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(g,x,b){return d(g,x,b)},decryptKeyB64:function(g,x,b,_){return p(g,x,b,_)},getDecryptedKeyHex:function(g,x){var b=u(g),_=b.type,O=b.cipher,S=b.ivsalt,E=b.data,D=d(O,x,S),I=D.keyhex,y=p(E,O,I,S);return y},getEncryptedPKCS5PEMFromPrvKeyHex:function(g,x,b,_,O){var C="";if((typeof _>"u"||_==null)&&(_="AES-256-CBC"),typeof c[_]>"u")throw new Error("KEYUTIL unsupported algorithm: "+_);if(typeof O>"u"||O==null){var S=c[_].ivlen,E=h(S);O=E.toUpperCase()}var D=d(_,b,O),I=D.keyhex,y=m(x,_,I,O),P=y.replace(/(.{64})/g,`$1\r
`),C="-----BEGIN "+g+` PRIVATE KEY-----\r
`;return C+=`Proc-Type: 4,ENCRYPTED\r
`,C+="DEK-Info: "+_+","+O+`\r
`,C+=`\r
`,C+=P,C+=`\r
-----END `+g+` PRIVATE KEY-----\r
`,C},getEncryptedPKCS8PEM:function(g,x,b){var _=this.getEncryptedPKCS8Hex(g,x,b);return dn(_,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(g,x,b){var _;b==null||b==null?_={}:_=JSON.parse(JSON.stringify(b)),_.plain=g,this.initPBES2Param(_),this.encryptPBES2Param(_,x);var O=this.generatePBES2ASN1Param(_);return f.asn1.ASN1Util.newObject(O).tohex()},initPBES2Param:function(g){if(tt(g,"encalg")==null&&(g.encalg="aes256-CBC"),tt(g,"iter")==null&&(g.iter=2048),tt(g,"prf")==null&&(g.prf="hmacWithSHA256"),tt(g,"salt")==null&&(g.salt=Q.enc.Hex.stringify(Q.lib.WordArray.random(8))),tt(g,"enciv")==null){var x;g.encalg=="des-EDE3-CBC"&&(x=8),g.encalg=="aes128-CBC"&&(x=16),g.encalg=="aes256-CBC"&&(x=16),g.enciv=Q.enc.Hex.stringify(Q.lib.WordArray.random(x))}},encryptPBES2Param:function(g,x){var b=Me.getDKFromPBES2Param(g,x);try{var _=f.crypto.Cipher.encrypt(g.plain,b,g.encalg,{iv:g.enciv})}catch{throw new Error("encrypt error: "+g.plain+" "+b+" "+g.encalg+" "+g.enciv)}g.enc=_},generatePBES2ASN1Param:function(g){var x={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:g.salt}},{int:{hex:xk(g.iter)}}]}]},{seq:[{oid:g.encalg},{octstr:{hex:g.enciv}}]}]}]},{octstr:{hex:g.enc}}]};return g.prf!="hmacWithSHA1"&&x.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:g.prf},{null:""}]}),x},parseHexOfEncryptedPKCS8:function(g){var x=$,b=x.getChildIdx,_=x.getV,O={},S=b(g,0);if(S.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+S.length);O.ciphertext=_(g,S[1]);var E=b(g,S[0]);if(E.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+E.length);if(_(g,E[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var D=b(g,E[1]);if(E.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+D.length);var I=b(g,D[1]);if(I.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+I.length);if(_(g,I[0])!="2a864886f70d0307")throw"this only supports TripleDES";O.encryptionSchemeAlg="TripleDES",O.encryptionSchemeIV=_(g,I[1]);var y=b(g,D[0]);if(y.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+y.length);if(_(g,y[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var P=b(g,y[1]);if(P.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+P.length);O.pbkdf2Salt=_(g,P[0]);var C=_(g,P[1]);try{O.pbkdf2Iter=parseInt(C,16)}catch{throw new Error("malformed format pbkdf2Iter: "+C)}return O},getPBKDF2KeyHexFromParam:function(g,x){var b=Q.enc.Hex.parse(g.pbkdf2Salt),_=g.pbkdf2Iter,O=Q.PBKDF2(x,b,{keySize:192/32,iterations:_}),S=Q.enc.Hex.stringify(O);return S},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(g,x){var b=_t(g,"ENCRYPTED PRIVATE KEY"),_=this.parseHexOfEncryptedPKCS8(b),O=Me.getPBKDF2KeyHexFromParam(_,x),S={};S.ciphertext=Q.enc.Hex.parse(_.ciphertext);var E=Q.enc.Hex.parse(O),D=Q.enc.Hex.parse(_.encryptionSchemeIV),I=Q.TripleDES.decrypt(S,E,{iv:D}),y=Q.enc.Hex.stringify(I);return y},parsePBES2:function(g){var x=$.parse(g);if(tt(x,"seq.0.seq.0.oid")!="pkcs5PBES2"||tt(x,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var b=tt(x,"seq.0.seq.1.seq.0.seq.1.seq");if(b==null)throw new Error("PBKDF2 parameter not found");var _=tt(b,"0.octstr.hex"),O=tt(b,"1.int.hex"),S=tt(b,"2.seq.0.oid","hmacWithSHA1"),E=-1;try{E=parseInt(O,16)}catch{throw new Error("iter not proper value")}var D=tt(x,"seq.0.seq.1.seq.1.seq.0.oid"),I=tt(x,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),y=tt(x,"seq.1.octstr.hex");if(D==null||I==null||y==null)throw new Error("encalg, enciv or enc is undefined");var P={salt:_,iter:E,prf:S,encalg:D,enciv:I,enc:y};return P},getDKFromPBES2Param:function(g,x){var b={hmacWithSHA1:Q.algo.SHA1,hmacWithSHA224:Q.algo.SHA224,hmacWithSHA256:Q.algo.SHA256,hmacWithSHA384:Q.algo.SHA384,hmacWithSHA512:Q.algo.SHA512},_={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},O=b[g.prf];if(O==null)throw new Error("unsupported prf");var S=_[g.encalg];if(S==null)throw new Error("unsupported encalg");var E=Q.enc.Hex.parse(g.salt),D=g.iter;try{var I=Q.PBKDF2(x,E,{keySize:S,iterations:D,hasher:O});return Q.enc.Hex.stringify(I)}catch(y){throw new Error("PBKDF2 error: "+y+" "+JSON.stringify(g)+" "+x)}},getPlainHexFromEncryptedPKCS8PEM:function(g,x){if(g.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var b=_t(g),_;try{_=Me.parsePBES2(b)}catch(S){throw new Error("malformed PBES2 format: "+S.message)}var O=Me.getDKFromPBES2Param(_,x);return f.crypto.Cipher.decrypt(_.enc,O,_.encalg,{iv:_.enciv})},getKeyFromEncryptedPKCS8PEM:function(g,x){var b=this.getPlainHexFromEncryptedPKCS8PEM(g,x),_=this.getKeyFromPlainPrivatePKCS8Hex(b);return _},parsePlainPrivatePKCS8Hex:function(g){var x=$,b=x.getChildIdx,_=x.getV,O={};if(O.algparam=null,g.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var S=b(g,0);if(S.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(g.substr(S[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var E=b(g,S[1]);if(E.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(g.substr(E[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(O.algoid=_(g,E[0]),g.substr(E[1],2)=="06"&&(O.algparam=_(g,E[1])),g.substr(S[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return O.keyidx=x.getVidx(g,S[2]),O},getKeyFromPlainPrivatePKCS8PEM:function(g){var x=_t(g,"PRIVATE KEY"),b=this.getKeyFromPlainPrivatePKCS8Hex(x);return b},getKeyFromPlainPrivatePKCS8Hex:function(g){var x=this.parsePlainPrivatePKCS8Hex(g),b;if(x.algoid=="2a864886f70d010101")b=new ve;else if(x.algoid=="2a8648ce380401")b=new f.crypto.DSA;else if(x.algoid=="2a8648ce3d0201")b=new f.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return b.readPKCS8PrvKeyHex(g),b},_getKeyFromPublicPKCS8Hex:function(g){var x,b=$.getVbyList(g,0,[0,0],"06");if(b==="2a864886f70d010101")x=new ve;else if(b==="2a8648ce380401")x=new f.crypto.DSA;else if(b==="2a8648ce3d0201")x=new f.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return x.readPKCS8PubKeyHex(g),x},parsePublicRawRSAKeyHex:function(g){var x=$,b=x.getChildIdx,_=x.getV,O={};if(g.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var S=b(g,0);if(S.length!=2)throw new Error("malformed RSA key(code:002)");if(g.substr(S[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(O.n=_(g,S[0]),g.substr(S[1],2)!="02")throw new Error("malformed RSA key(code:004)");return O.e=_(g,S[1]),O},parsePublicPKCS8Hex:function(g){var x=$,b=x.getChildIdx,_=x.getV,O={};O.algparam=null;var S=b(g,0);if(S.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+S.length);var E=S[0];if(g.substr(E,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var D=b(g,E);if(D.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(g.substr(D[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(O.algoid=_(g,D[0]),g.substr(D[1],2)=="06"?O.algparam=_(g,D[1]):g.substr(D[1],2)=="30"&&(O.algparam={},O.algparam.p=x.getVbyList(g,D[1],[0],"02"),O.algparam.q=x.getVbyList(g,D[1],[1],"02"),O.algparam.g=x.getVbyList(g,D[1],[2],"02")),g.substr(S[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return O.key=_(g,S[1]).substr(2),O}}}();Me.getKey=function(n,e,t){var r=$,i=r.getChildIdx,o=r.getV,s=r.getVbyList,a=f.crypto,c=a.ECDSA,l=a.DSA,h=ve,u=_t,d=Me;if(typeof h<"u"&&n instanceof h||typeof c<"u"&&n instanceof c||typeof l<"u"&&n instanceof l)return n;if(n.curve!==void 0&&n.xy!==void 0&&n.d===void 0)return new c({pub:n.xy,curve:n.curve});if(n.curve!==void 0&&n.d!==void 0)return new c({prv:n.d,curve:n.curve});if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d===void 0){var p=new h;return p.setPublic(n.n,n.e),p}if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p!==void 0&&n.q!==void 0&&n.dp!==void 0&&n.dq!==void 0&&n.co!==void 0&&n.qi===void 0){var p=new h;return p.setPrivateEx(n.n,n.e,n.d,n.p,n.q,n.dp,n.dq,n.co),p}if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p===void 0){var p=new h;return p.setPrivate(n.n,n.e,n.d),p}if(n.p!==void 0&&n.q!==void 0&&n.g!==void 0&&n.y!==void 0&&n.x===void 0){var p=new l;return p.setPublic(n.p,n.q,n.g,n.y),p}if(n.p!==void 0&&n.q!==void 0&&n.g!==void 0&&n.y!==void 0&&n.x!==void 0){var p=new l;return p.setPrivate(n.p,n.q,n.g,n.y,n.x),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d===void 0){var p=new h;return p.setPublic(gt(n.n),gt(n.e)),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p!==void 0&&n.q!==void 0&&n.dp!==void 0&&n.dq!==void 0&&n.qi!==void 0){var p=new h;return p.setPrivateEx(gt(n.n),gt(n.e),gt(n.d),gt(n.p),gt(n.q),gt(n.dp),gt(n.dq),gt(n.qi)),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0){var p=new h;return p.setPrivate(gt(n.n),gt(n.e),gt(n.d)),p}if(n.kty==="EC"&&n.crv!==void 0&&n.x!==void 0&&n.y!==void 0&&n.d===void 0){var m=new c({curve:n.crv}),g=m.ecparams.keycharlen,x=("0000000000"+gt(n.x)).slice(-g),b=("0000000000"+gt(n.y)).slice(-g),_="04"+x+b;return m.setPublicKeyHex(_),m}if(n.kty==="EC"&&n.crv!==void 0&&n.x!==void 0&&n.y!==void 0&&n.d!==void 0){var m=new c({curve:n.crv}),g=m.ecparams.keycharlen,x=("0000000000"+gt(n.x)).slice(-g),b=("0000000000"+gt(n.y)).slice(-g),_="04"+x+b,O=("0000000000"+gt(n.d)).slice(-g);return m.setPublicKeyHex(_),m.setPrivateKeyHex(O),m}if(t==="pkcs5prv"){var S=n,r=$,E,p;if(E=i(S,0),E.length===9)p=new h,p.readPKCS5PrvKeyHex(S);else if(E.length===6)p=new l,p.readPKCS5PrvKeyHex(S);else if(E.length>2&&S.substr(E[1],2)==="04")p=new c,p.readPKCS5PrvKeyHex(S);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return p}if(t==="pkcs8prv"){var p=d.getKeyFromPlainPrivatePKCS8Hex(n);return p}if(t==="pkcs8pub")return d._getKeyFromPublicPKCS8Hex(n);if(t==="x509pub")return he.getPublicKeyFromCertHex(n);if(n.indexOf("-END CERTIFICATE-",0)!=-1||n.indexOf("-END X509 CERTIFICATE-",0)!=-1||n.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return he.getPublicKeyFromCertPEM(n);if(n.indexOf("-END PUBLIC KEY-")!=-1){var D=_t(n,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(D)}if(n.indexOf("-END RSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var I=u(n,"RSA PRIVATE KEY");return d.getKey(I,null,"pkcs5prv")}if(n.indexOf("-END DSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var y=u(n,"DSA PRIVATE KEY"),P=s(y,0,[1],"02"),C=s(y,0,[2],"02"),M=s(y,0,[3],"02"),A=s(y,0,[4],"02"),F=s(y,0,[5],"02"),p=new l;return p.setPrivate(new B(P,16),new B(C,16),new B(M,16),new B(A,16),new B(F,16)),p}if(n.indexOf("-END EC PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var I=u(n,"EC PRIVATE KEY");return d.getKey(I,null,"pkcs5prv")}if(n.indexOf("-END PRIVATE KEY-")!=-1)return d.getKeyFromPlainPrivatePKCS8PEM(n);if(n.indexOf("-END RSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var k=d.getDecryptedKeyHex(n,e),T=new ve;return T.readPKCS5PrvKeyHex(k),T}if(n.indexOf("-END EC PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var y=d.getDecryptedKeyHex(n,e),p=s(y,0,[1],"04"),R=s(y,0,[2,0],"06"),N=s(y,0,[3,0],"03").substr(2),q="";if(f.crypto.OID.oidhex2name[R]!==void 0)q=f.crypto.OID.oidhex2name[R];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+R);var m=new c({curve:q});return m.setPublicKeyHex(N),m.setPrivateKeyHex(p),m.isPublic=!1,m}if(n.indexOf("-END DSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var y=d.getDecryptedKeyHex(n,e),P=s(y,0,[1],"02"),C=s(y,0,[2],"02"),M=s(y,0,[3],"02"),A=s(y,0,[4],"02"),F=s(y,0,[5],"02"),p=new l;return p.setPrivate(new B(P,16),new B(C,16),new B(M,16),new B(A,16),new B(F,16)),p}if(n.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return d.getKeyFromEncryptedPKCS8PEM(n,e);throw new Error("not supported argument")};Me.generateKeypair=function(n,e){if(n=="RSA"){var t=e,r=new ve;r.generate(t,"10001"),r.isPrivate=!0,r.isPublic=!0;var i=new ve,o=r.n.toString(16),s=r.e.toString(16);i.setPublic(o,s),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=r,a.pubKeyObj=i,a}else if(n=="EC"){var c=e,l=new f.crypto.ECDSA({curve:c}),h=l.generateKeyPairHex(),r=new f.crypto.ECDSA({curve:c});r.setPublicKeyHex(h.ecpubhex),r.setPrivateKeyHex(h.ecprvhex),r.isPrivate=!0,r.isPublic=!1;var i=new f.crypto.ECDSA({curve:c});i.setPublicKeyHex(h.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=r,a.pubKeyObj=i,a}else throw new Error("unknown algorithm: "+n)};Me.getPEM=function(n,e,t,r,i,o){var s=f,a=s.asn1,c=a.DERObjectIdentifier,l=a.DERInteger,h=a.ASN1Util.newObject,u=a.x509,d=u.SubjectPublicKeyInfo,p=s.crypto,m=p.DSA,g=p.ECDSA,x=ve;function b(T){var R=h({seq:[{int:0},{int:{bigint:T.n}},{int:T.e},{int:{bigint:T.d}},{int:{bigint:T.p}},{int:{bigint:T.q}},{int:{bigint:T.dmp1}},{int:{bigint:T.dmq1}},{int:{bigint:T.coeff}}]});return R}function _(T){var R=h({seq:[{int:1},{octstr:{hex:T.prvKeyHex}},{tag:["a0",!0,{oid:{name:T.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+T.pubKeyHex}}]}]});return R}function O(T){var R=h({seq:[{int:0},{int:{bigint:T.p}},{int:{bigint:T.q}},{int:{bigint:T.g}},{int:{bigint:T.y}},{int:{bigint:T.x}}]});return R}if((x!==void 0&&n instanceof x||m!==void 0&&n instanceof m||g!==void 0&&n instanceof g)&&n.isPublic==!0&&(e===void 0||e=="PKCS8PUB")){var S=new d(n),E=S.tohex();return dn(E,"PUBLIC KEY")}if(e=="PKCS1PRV"&&x!==void 0&&n instanceof x&&(t===void 0||t==null)&&n.isPrivate==!0){var S=b(n),E=S.tohex();return dn(E,"RSA PRIVATE KEY")}if(e=="PKCS1PRV"&&g!==void 0&&n instanceof g&&(t===void 0||t==null)&&n.isPrivate==!0){var D=new c({name:n.curveName}),I=D.tohex(),y=_(n),P=y.tohex(),C="";return C+=dn(I,"EC PARAMETERS"),C+=dn(P,"EC PRIVATE KEY"),C}if(e=="PKCS1PRV"&&m!==void 0&&n instanceof m&&(t===void 0||t==null)&&n.isPrivate==!0){var S=O(n),E=S.tohex();return dn(E,"DSA PRIVATE KEY")}if(e=="PKCS5PRV"&&x!==void 0&&n instanceof x&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=b(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,t,r,o)}if(e=="PKCS5PRV"&&g!==void 0&&n instanceof g&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=_(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,t,r,o)}if(e=="PKCS5PRV"&&m!==void 0&&n instanceof m&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=O(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,t,r,o)}var M=function(T,R){if(typeof R=="string")return Me.getEncryptedPKCS8PEM(T,R);if(typeof R=="object"&&tt(R,"passcode")!=null){var N=JSON.parse(JSON.stringify(R)),q=N.passcode;return delete N.passcode,Me.getEncryptedPKCS8PEM(T,q,N)}};if(e=="PKCS8PRV"&&x!=null&&n instanceof x&&n.isPrivate==!0){var A=b(n),F=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:F}}]}),E=S.tohex();return t===void 0||t==null?dn(E,"PRIVATE KEY"):M(E,t)}if(e=="PKCS8PRV"&&g!==void 0&&n instanceof g&&n.isPrivate==!0){var k={seq:[{int:1},{octstr:{hex:n.prvKeyHex}}]};typeof n.pubKeyHex=="string"&&k.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+n.pubKeyHex}}]});var A=new h(k),F=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:n.curveName}}]},{octstr:{hex:F}}]}),E=S.tohex();return t===void 0||t==null?dn(E,"PRIVATE KEY"):M(E,t)}if(e=="PKCS8PRV"&&m!==void 0&&n instanceof m&&n.isPrivate==!0){var A=new l({bigint:n.x}),F=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:n.p}},{int:{bigint:n.q}},{int:{bigint:n.g}}]}]},{octstr:{hex:F}}]}),E=S.tohex();return t===void 0||t==null?dn(E,"PRIVATE KEY"):M(E,t)}throw new Error("unsupported object nor format")};Me.getKeyFromCSRPEM=function(n){var e=_t(n,"CERTIFICATE REQUEST"),t=Me.getKeyFromCSRHex(e);return t};Me.getKeyFromCSRHex=function(n){var e=Me.parseCSRHex(n),t=Me.getKey(e.p8pubkeyhex,null,"pkcs8pub");return t};Me.parseCSRHex=function(n){var e=$,t=e.getChildIdx,r=e.getTLV,i={},o=n;if(o.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var s=t(o,0);if(s.length<1)throw new Error("malformed CSR(code:002)");if(o.substr(s[0],2)!="30")throw new Error("malformed CSR(code:003)");var a=t(o,s[0]);if(a.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=r(o,a[2]),i};Me.getKeyID=function(n){var e=Me,t=$;typeof n=="string"&&n.indexOf("BEGIN ")!=-1&&(n=e.getKey(n));var r=_t(e.getPEM(n)),i=t.getIdxbyList(r,0,[1]),o=t.getV(r,i).substring(2);return f.crypto.Util.hashHex(o,"sha1")};Me.getJWK=function(n,e,t,r,i){var o,s={},a,c=f.crypto.Util.hashHex;if(typeof n=="string")o=Me.getKey(n),n.indexOf("CERTIFICATE")!=-1&&(a=_t(n));else if(typeof n=="object")n instanceof he?(o=n.getPublicKey(),a=n.hex):o=n;else throw new Error("unsupported keyinfo type");if(o instanceof ve&&o.isPrivate)s.kty="RSA",s.n=It(o.n.toString(16)),s.e=It(o.e.toString(16)),s.d=It(o.d.toString(16)),s.p=It(o.p.toString(16)),s.q=It(o.q.toString(16)),s.dp=It(o.dmp1.toString(16)),s.dq=It(o.dmq1.toString(16)),s.qi=It(o.coeff.toString(16));else if(o instanceof ve&&o.isPublic)s.kty="RSA",s.n=It(o.n.toString(16)),s.e=It(o.e.toString(16));else if(o instanceof f.crypto.ECDSA&&o.isPrivate){var l=o.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var h=o.getPublicKeyXYHex();s.kty="EC",s.crv=l,s.x=It(h.x),s.y=It(h.y),s.d=It(o.prvKeyHex)}else if(o instanceof f.crypto.ECDSA&&o.isPublic){var l=o.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var h=o.getPublicKeyXYHex();s.kty="EC",s.crv=l,s.x=It(h.x),s.y=It(h.y)}if(s.kty==null)throw new Error("unsupported keyinfo");return!o.isPrivate&&e!=!0&&(s.kid=f.jws.JWS.getJWKthumbprint(s)),a!=null&&t!=!0&&(s.x5c=[Zr(a)]),a!=null&&r!=!0&&(s.x5t=ia(Zr(c(a,"sha1")))),a!=null&&i!=!0&&(s["x5t#S256"]=ia(Zr(c(a,"sha256")))),s};Me.getJWKFromKey=function(n){return Me.getJWK(n,!0,!0,!0,!0)};ve.getPosArrayOfChildrenFromHex=function(n){return $.getChildIdx(n,0)};ve.getHexValueArrayOfChildrenFromHex=function(n){var e=$,t=e.getV,d=ve.getPosArrayOfChildrenFromHex(n),r=t(n,d[0]),i=t(n,d[1]),o=t(n,d[2]),s=t(n,d[3]),a=t(n,d[4]),c=t(n,d[5]),l=t(n,d[6]),h=t(n,d[7]),u=t(n,d[8]),d=new Array;return d.push(r,i,o,s,a,c,l,h,u),d};ve.prototype.readPrivateKeyFromPEMString=function(n){var e=_t(n),t=ve.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};ve.prototype.readPKCS5PrvKeyHex=function(n){var e=ve.getHexValueArrayOfChildrenFromHex(n);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};ve.prototype.readPKCS8PrvKeyHex=function(n){var e,t,r,i,o,s,a,c,l=$,h=l.getVbyListEx;if(l.isASN1HEX(n)===!1)throw new Error("not ASN.1 hex string");try{e=h(n,0,[2,0,1],"02"),t=h(n,0,[2,0,2],"02"),r=h(n,0,[2,0,3],"02"),i=h(n,0,[2,0,4],"02"),o=h(n,0,[2,0,5],"02"),s=h(n,0,[2,0,6],"02"),a=h(n,0,[2,0,7],"02"),c=h(n,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(e,t,r,i,o,s,a,c)};ve.prototype.readPKCS5PubKeyHex=function(n){var e=$,t=e.getV;if(e.isASN1HEX(n)===!1)throw new Error("keyHex is not ASN.1 hex string");var r=e.getChildIdx(n,0);if(r.length!==2||n.substr(r[0],2)!=="02"||n.substr(r[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var i=t(n,r[0]),o=t(n,r[1]);this.setPublic(i,o)};ve.prototype.readPKCS8PubKeyHex=function(n){var e=$;if(e.isASN1HEX(n)===!1)throw new Error("not ASN.1 hex string");if(e.getTLVbyListEx(n,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var t=e.getTLVbyListEx(n,0,[1,0]);this.readPKCS5PubKeyHex(t)};ve.prototype.readCertPubKeyHex=function(n,e){var t,r;t=new he,t.readCertHex(n),r=t.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)};var wme=new RegExp("[^0-9a-f]","gi");function wk(n,e){for(var t="",r=e/4-n.length,i=0;i<r;i++)t=t+"0";return t+n}ve.prototype.sign=function(n,e){var t=function(i){return f.crypto.Util.hashString(i,e)},r=t(n);return this.signWithMessageHash(r,e)};ve.prototype.signWithMessageHash=function(n,e){var t=f.crypto.Util.getPaddedDigestInfoHex(n,e,this.n.bitLength()),r=Fn(t,16),i=this.doPrivate(r),o=i.toString(16);return wk(o,this.n.bitLength())};function Pk(n,e,t){for(var r="",i=0;r.length<e;)r+=In(t(Nr(n+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])))),i+=1;return r}ve.prototype.signPSS=function(n,e,t){var r=function(o){return f.crypto.Util.hashHex(o,e)},i=r(Nr(n));return t===void 0&&(t=-1),this.signWithMessageHashPSS(i,e,t)};ve.prototype.signWithMessageHashPSS=function(n,e,t){var r=In(n),i=r.length,o=this.n.bitLength()-1,s=Math.ceil(o/8),a,c=function(x){return f.crypto.Util.hashHex(x,e)};if(t===-1||t===void 0)t=i;else if(t===-2)t=s-i-2;else if(t<-2)throw new Error("invalid salt length");if(s<i+t+2)throw new Error("data too long");var l="";t>0&&(l=new Array(t),new ca().nextBytes(l),l=String.fromCharCode.apply(String,l));var h=In(c(Nr("\0\0\0\0\0\0\0\0"+r+l))),u=[];for(a=0;a<s-t-i-2;a+=1)u[a]=0;var d=String.fromCharCode.apply(String,u)+""+l,p=Pk(h,d.length,c),m=[];for(a=0;a<d.length;a+=1)m[a]=d.charCodeAt(a)^p.charCodeAt(a);var g=65280>>8*s-o&255;for(m[0]&=~g,a=0;a<i;a++)m.push(h.charCodeAt(a));return m.push(188),wk(this.doPrivate(new B(m)).toString(16),this.n.bitLength())};function Ok(n){for(var e in f.crypto.Util.DIGESTINFOHEAD){var t=f.crypto.Util.DIGESTINFOHEAD[e],r=t.length;if(n.substring(0,r)==t){var i=[e,n.substring(r)];return i}}return[]}ve.prototype.verify=function(n,e){if(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null)return!1;var t=Fn(e,16),r=this.n.bitLength();if(t.bitLength()>r)return!1;var i=this.doPublic(t),o=i.toString(16);if(o.length+3!=r/4)return!1;var s=o.replace(/^1f+00/,""),a=Ok(s);if(a.length==0)return!1;var c=a[0],l=a[1],h=function(d){return f.crypto.Util.hashString(d,c)},u=h(n);return l==u};ve.prototype.verifyWithMessageHash=function(n,e){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var t=Fn(e,16);if(t.bitLength()>this.n.bitLength())return 0;var r=this.doPublic(t),i=r.toString(16).replace(/^1f+00/,""),o=Ok(i);if(o.length==0)return!1;var s=o[0],a=o[1];return a==n};ve.prototype.verifyPSS=function(n,e,t,r){var i=function(s){return f.crypto.Util.hashHex(s,t)},o=i(Nr(n));return r===void 0&&(r=-1),this.verifyWithMessageHashPSS(o,e,t,r)};ve.prototype.verifyWithMessageHashPSS=function(n,e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var i=new B(e,16),o=function(_){return f.crypto.Util.hashHex(_,t)},s=In(n),a=s.length,c=this.n.bitLength()-1,l=Math.ceil(c/8),h;if(r===-1||r===void 0)r=a;else if(r===-2)r=l-a-2;else if(r<-2)throw new Error("invalid salt length");if(l<a+r+2)throw new Error("data too long");var u=this.doPublic(i).toByteArray();for(h=0;h<u.length;h+=1)u[h]&=255;for(;u.length<l;)u.unshift(0);if(u[l-1]!==188)throw new Error("encoded message does not end in 0xbc");u=String.fromCharCode.apply(String,u);var d=u.substr(0,l-a-1),p=u.substr(d.length,a),m=65280>>8*l-c&255;if(d.charCodeAt(0)&m)throw new Error("bits beyond keysize not zero");var g=Pk(p,d.length,o),x=[];for(h=0;h<d.length;h+=1)x[h]=d.charCodeAt(h)^g.charCodeAt(h);x[0]&=~m;var b=l-a-r-2;for(h=0;h<b;h+=1)if(x[h]!==0)throw new Error("leftmost octets not zero");if(x[b]!==1)throw new Error("0x01 marker not found");return p===In(o(Nr("\0\0\0\0\0\0\0\0"+s+String.fromCharCode.apply(String,x.slice(-r)))))};ve.SALT_LEN_HLEN=-1;ve.SALT_LEN_MAX=-2;ve.SALT_LEN_RECOVER=-2;function he(n){var e=$,t=e.getChildIdx,r=e.getV,i=e.dump,o=e.parse,s=e.getTLV,a=e.getVbyList,c=e.getVbyListEx,l=e.getTLVbyList,h=e.getTLVbyListEx,u=e.getIdxbyList,d=e.getIdxbyListEx,p=e.getVidx,m=e.getInt,g=e.oidname,x=e.hextooidstr,b=he,_=_t,O,S=Error;try{O=f.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var y=l(this.hex,0,[0,0]);if(y.substr(0,2)=="a0"){var P=l(y,0,[0]),C=m(P,0);if(C<0||2<C)throw new Error("malformed version field");return this.version=C+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return c(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var y=h(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(y)},this.getAlgorithmIdentifierName=function(y){for(var P in O)if(y===O[P])return P;return g(c(y,0,[0],"06"))},this.getIssuer=function(y,P){return this.getX500Name(this.getIssuerHex(),y,P)},this.getIssuerHex=function(){return l(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var y=this.getIssuer();return y.str},this.getSubject=function(y,P){return this.getX500Name(this.getSubjectHex(),y,P)},this.getSubjectHex=function(){return l(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var y=this.getSubject();return y.str},this.getNotBefore=function(){var y=a(this.hex,0,[0,4+this.foffset,0]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getNotAfter=function(){var y=a(this.hex,0,[0,4+this.foffset,1]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var y=this.getSPKI();return y==null?null:a(y,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return u(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var y=this.getPublicKeyIdx();return u(this.hex,y,[1,0],"30")},this.getPublicKey=function(){return Me.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var y=l(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(y)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(y){var P=this.getSignatureAlgorithmField(),C=this.getSignatureValueHex(),M=l(this.hex,0,[0],"30"),A=new f.crypto.Signature({alg:P});return A.init(y),A.updateHex(M),A.verify(C)},this.parseExt=function(y){var P,C,M;if(y===void 0){if(M=this.hex,this.version!==3)return-1;P=u(M,0,[0,7,0],"30"),C=t(M,P)}else{M=_t(y);var A=u(M,0,[0,3,0,0],"06");if(r(M,A)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}P=u(M,0,[0,3,0,1,0],"30"),C=t(M,P),this.hex=M}this.aExtInfo=new Array;for(var F=0;F<C.length;F++){var k={};k.critical=!1;var T=t(M,C[F]),R=0;T.length===3&&(k.critical=!0,R=1),k.oid=e.hextooidstr(a(M,C[F],[0],"06"));var N=u(M,C[F],[1+R]);k.vidx=p(M,N),this.aExtInfo.push(k)}},this.getExtInfo=function(y){var P=this.aExtInfo,C=y;if(y.match(/^[0-9.]+$/)||(C=f.asn1.x509.OID.name2oid(y)),C!==""){for(var M=0;M<P.length;M++)if(P[M].oid===C)return P[M]}},this.getCriticalExtV=function(y,P,C){if(P!=null)return[P,C];var M=this.getExtInfo(y);return M==null?[null,null]:[s(this.hex,M.vidx),M.critical]},this.getExtBasicConstraints=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("basicConstraints");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"basicConstraints"};if(P&&(M.critical=!0),y==="3000")return M;if(y==="30030101ff")return M.cA=!0,M;if(y.substr(0,12)==="30060101ff02"){var A=r(y,10),F=parseInt(A,16);return M.cA=!0,M.pathLen=F,M}throw new Error("hExtV parse error: "+y)},this.getExtNameConstraints=function(y,P){var C=this.getCriticalExtV("nameConstraints",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"nameConstraints"};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++){for(var k=[],T=t(y,A[F]),R=0;R<T.length;R++){var N=s(y,T[R]),q=this.getGeneralSubtree(N);k.push(q)}var V=y.substr(A[F],2);V=="a0"?M.permit=k:V=="a1"&&(M.exclude=k)}return M}},this.getGeneralSubtree=function(y){var P=t(y,0),C=P.length;if(C<1||2<C)throw new Error("wrong num elements");for(var M=this.getGeneralName(s(y,P[0])),A=1;A<C;A++){var F=y.substr(P[A],2),k=r(y,P[A]),T=parseInt(k,16);F=="80"&&(M.min=T),F=="81"&&(M.max=T)}return M},this.getExtKeyUsage=function(y,P){var C=this.getCriticalExtV("keyUsage",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"keyUsage"};return P&&(M.critical=!0),M.names=this.getExtKeyUsageString(y).split(","),M}},this.getExtKeyUsageBin=function(y){if(y===void 0){var P=this.getExtInfo("keyUsage");if(P===void 0)return"";y=s(this.hex,P.vidx)}if(y.length!=8&&y.length!=10)throw new Error("malformed key usage value: "+y);var C="000000000000000"+parseInt(y.substr(6),16).toString(2);return y.length==8&&(C=C.slice(-8)),y.length==10&&(C=C.slice(-16)),C=C.replace(/0+$/,""),C==""&&(C="0"),C},this.getExtKeyUsageString=function(y){for(var P=this.getExtKeyUsageBin(y),C=new Array,M=0;M<P.length;M++)P.substr(M,1)=="1"&&C.push(he.KEYUSAGE_NAME[M]);return C.join(",")},this.getExtSubjectKeyIdentifier=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectKeyIdentifier");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"subjectKeyIdentifier"};P&&(M.critical=!0);var A=r(y,0);return M.kid={hex:A},M},this.getExtAuthorityKeyIdentifier=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("authorityKeyIdentifier");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"authorityKeyIdentifier"};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++){var k=y.substr(A[F],2);if(k==="80"&&(M.kid={hex:r(y,A[F])}),k==="a1"){var T=s(y,A[F]),R=this.getGeneralNames(T);M.issuer=R[0].dn}k==="82"&&(M.sn={hex:r(y,A[F])})}return M},this.getExtExtKeyUsage=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("extKeyUsage");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"extKeyUsage",array:[]};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++)M.array.push(g(r(y,A[F])));return M},this.getExtExtKeyUsageName=function(){var y=this.getExtInfo("extKeyUsage");if(y===void 0)return y;var P=new Array,C=s(this.hex,y.vidx);if(C==="")return P;for(var M=t(C,0),A=0;A<M.length;A++)P.push(g(r(C,M[A])));return P},this.getExtSubjectAltName=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectAltName");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"subjectAltName",array:[]};return P&&(M.critical=!0),M.array=this.getGeneralNames(y),M},this.getExtIssuerAltName=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("issuerAltName");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"issuerAltName",array:[]};return P&&(M.critical=!0),M.array=this.getGeneralNames(y),M},this.getGeneralNames=function(y){for(var P=t(y,0),C=[],M=0;M<P.length;M++){var A=this.getGeneralName(s(y,P[M]));A!==void 0&&C.push(A)}return C},this.getGeneralName=function(y){var P=y.substr(0,2),C=r(y,0),M=In(C);if(P=="81")return{rfc822:M};if(P=="82")return{dns:M};if(P=="86")return{uri:M};if(P=="87")return{ip:ap(C)};if(P=="a4")return{dn:this.getX500Name(C)};if(P=="a0")return{other:this.getOtherName(y)}},this.getExtSubjectAltName2=function(){var y,P,C,M=this.getExtInfo("subjectAltName");if(M===void 0)return M;for(var A=new Array,F=s(this.hex,M.vidx),k=t(F,0),T=0;T<k.length;T++)C=F.substr(k[T],2),y=r(F,k[T]),C==="81"&&(P=Ve(y),A.push(["MAIL",P])),C==="82"&&(P=Ve(y),A.push(["DNS",P])),C==="84"&&(P=he.hex2dn(y,0),A.push(["DN",P])),C==="86"&&(P=Ve(y),A.push(["URI",P])),C==="87"&&(P=ap(y),A.push(["IP",P]));return A},this.getExtCRLDistributionPoints=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("cRLDistributionPoints");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"cRLDistributionPoints",array:[]};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++){var k=s(y,A[F]);M.array.push(this.getDistributionPoint(k))}return M},this.getDistributionPoint=function(y){for(var P={},C=t(y,0),M=0;M<C.length;M++){var A=y.substr(C[M],2),F=s(y,C[M]);A=="a0"&&(P.dpname=this.getDistributionPointName(F))}return P},this.getDistributionPointName=function(y){for(var P={},C=t(y,0),M=0;M<C.length;M++){var A=y.substr(C[M],2),F=s(y,C[M]);A=="a0"&&(P.full=this.getGeneralNames(F))}return P},this.getExtCRLDistributionPointsURI=function(){var y=this.getExtCRLDistributionPoints();if(y==null)return y;for(var P=y.array,C=[],M=0;M<P.length;M++)try{P[M].dpname.full[0].uri!=null&&C.push(P[M].dpname.full[0].uri)}catch{}return C},this.getExtAIAInfo=function(){var y=this.getExtInfo("authorityInfoAccess");if(y===void 0)return y;for(var P={ocsp:[],caissuer:[]},C=t(this.hex,y.vidx),M=0;M<C.length;M++){var A=a(this.hex,C[M],[0],"06"),F=a(this.hex,C[M],[1],"86");A==="2b06010505073001"&&P.ocsp.push(Ve(F)),A==="2b06010505073002"&&P.caissuer.push(Ve(F))}return P},this.getExtAuthorityInfoAccess=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("authorityInfoAccess");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"authorityInfoAccess",array:[]};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++){var k=c(y,A[F],[0],"06"),T=a(y,A[F],[1],"86"),R=Ve(T);if(k=="2b06010505073001")M.array.push({ocsp:R});else if(k=="2b06010505073002")M.array.push({caissuer:R});else throw new Error("unknown method: "+k)}return M},this.getExtCertificatePolicies=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("certificatePolicies");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"certificatePolicies",array:[]};P&&(M.critical=!0);for(var A=t(y,0),F=0;F<A.length;F++){var k=s(y,A[F]),T=this.getPolicyInformation(k);M.array.push(T)}return M},this.getPolicyInformation=function(y){var P={},C=a(y,0,[0],"06");P.policyoid=g(C);var M=d(y,0,[1],"30");if(M!=-1){P.array=[];for(var A=t(y,M),F=0;F<A.length;F++){var k=s(y,A[F]),T=this.getPolicyQualifierInfo(k);P.array.push(T)}}return P},this.getOtherName=function(y){var P={},C=t(y,0),M=a(y,C[0],[],"06"),A=a(y,C[1],[]);return P.oid=g(M),P.value=o(A),P},this.getPolicyQualifierInfo=function(y){var P={},C=a(y,0,[0],"06");if(C==="2b06010505070201"){var M=c(y,0,[1],"16");P.cps=In(M)}else if(C==="2b06010505070202"){var A=l(y,0,[1],"30");P.unotice=this.getUserNotice(A)}return P},this.getUserNotice=function(y){var P=null,C={};try{P=e.parse(y);var M=this._asn1ToUnotice(P);return M}catch{return}},this._asn1ToUnotice=function(y){try{for(var P={},C=tt(y,"seq"),M=0;M<C.length;M++){var A=this._asn1ToNoticeRef(C[M]);A!=null&&(P.noticeref=A);var F=this.asn1ToDisplayText(C[M]);F!=null&&(P.exptext=F)}return Object.keys(P).length>0?P:void 0}catch{return}},this._asn1ToNoticeRef=function(y){try{for(var P={},C=tt(y,"seq"),M=0;M<C.length;M++){var A=this._asn1ToNoticeNum(C[M]);A!=null&&(P.noticenum=A);var F=this.asn1ToDisplayText(C[M]);F!=null&&(P.org=F)}return Object.keys(P).length>0?P:void 0}catch{return}},this._asn1ToNoticeNum=function(y){try{for(var P=tt(y,"seq"),C=[],M=0;M<P.length;M++){var A=P[M];C.push(parseInt(tt(A,"int.hex"),16))}return C}catch{return}},this.getDisplayText=function(y){var P={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},C={};return C.type=P[y.substr(0,2)],C.str=In(r(y,0)),C},this.asn1ToDisplayText=function(y){if(y.utf8str!=null)return{type:"utf8",str:y.utf8str.str};if(y.ia5str!=null)return{type:"ia5",str:y.ia5str.str};if(y.visstr!=null)return{type:"vis",str:y.visstr.str};if(y.bmpstr!=null)return{type:"bmp",str:y.bmpstr.str};if(y.prnstr!=null)return{type:"prn",str:y.prnstr.str}},this.getExtPolicyMappings=function(y,P){var C=this.getCriticalExtV("policyMappings",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"policyMappings"};P&&(M.critical=!0);try{for(var A=o(y),F=A.seq,k=[],T=0;T<F.length;T++){var R=F[T].seq;k.push([R[0].oid,R[1].oid])}M.array=k}catch{throw new S("malformed policyMappings")}return M}},this.getExtPolicyConstraints=function(y,P){var C=this.getCriticalExtV("policyConstraints",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"policyConstraints"};P&&(M.critical=!0);var A=o(y);try{for(var F=A.seq,k=0;k<F.length;k++){var T=F[k].tag;T.explicit==!1&&(T.tag=="80"&&(M.reqexp=parseInt(T.hex,16)),T.tag=="81"&&(M.inhibit=parseInt(T.hex,16)))}}catch{return new S("malformed policyConstraints value")}return M}},this.getExtInhibitAnyPolicy=function(y,P){var C=this.getCriticalExtV("inhibitAnyPolicy",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"inhibitAnyPolicy"};P&&(M.critical=!0);var A=m(y,0);return A==-1?new S("wrong value"):(M.skip=A,M)}},this.getExtCRLNumber=function(y,P){var C={extname:"cRLNumber"};if(P&&(C.critical=!0),y.substr(0,2)=="02")return C.num={hex:r(y,0)},C;throw new S("hExtV parse error: "+y)},this.getExtCRLReason=function(y,P){var C={extname:"cRLReason"};if(P&&(C.critical=!0),y.substr(0,2)=="0a")return C.code=parseInt(r(y,0),16),C;throw new Error("hExtV parse error: "+y)},this.getExtOcspNonce=function(y,P){var C={extname:"ocspNonce"};P&&(C.critical=!0);var M=r(y,0);return C.hex=M,C},this.getExtOcspNoCheck=function(y,P){var C={extname:"ocspNoCheck"};return P&&(C.critical=!0),C},this.getExtAdobeTimeStamp=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("adobeTimeStamp");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"adobeTimeStamp"};P&&(M.critical=!0);var A=t(y,0);if(A.length>1){var F=s(y,A[1]),k=this.getGeneralName(F);k.uri!=null&&(M.uri=k.uri)}if(A.length>2){var T=s(y,A[2]);T=="0101ff"&&(M.reqauth=!0),T=="010100"&&(M.reqauth=!1)}return M},this.getExtSubjectDirectoryAttributes=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectDirectoryAttributes");if(C===void 0)return;y=s(this.hex,C.vidx),P=C.critical}var M={extname:"subjectDirectoryAttributes"};P&&(M.critical=!0);try{for(var A=o(y),F=[],k=0;k<A.seq.length;k++){var T=A.seq[k],R=tt(T,"seq.0.oid"),N=tt(T,"seq.1.set");if(R==null||N==null)throw"error";F.push({attr:R,array:N})}return M.array=F,M}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var E=function(y){var P={};try{var C=y.seq[0].oid,M=f.asn1.x509.OID.name2oid(C);P.type=f.asn1.x509.OID.oid2atype(M);var A=y.seq[1];if(A.utf8str!=null)P.ds="utf8",P.value=A.utf8str.str;else if(A.numstr!=null)P.ds="num",P.value=A.numstr.str;else if(A.telstr!=null)P.ds="tel",P.value=A.telstr.str;else if(A.prnstr!=null)P.ds="prn",P.value=A.prnstr.str;else if(A.ia5str!=null)P.ds="ia5",P.value=A.ia5str.str;else if(A.visstr!=null)P.ds="vis",P.value=A.visstr.str;else if(A.bmpstr!=null)P.ds="bmp",P.value=A.bmpstr.str;else throw"error";return P}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},D=function(y){try{return y.set.map(function(P){return E(P)})}catch(P){throw new Error("improper ASN.1 parsed RDN: "+P)}},I=function(y){try{return y.seq.map(function(P){return D(P)})}catch(P){throw new Error("improper ASN.1 parsed X500Name: "+P)}};this.getX500NameRule=function(y){for(var P=!0,C=!0,M=!1,A="",F="",k=null,T=[],R=0;R<y.length;R++)for(var N=y[R],q=0;q<N.length;q++)T.push(N[q]);for(var R=0;R<T.length;R++){var V=T[R],G=V.ds,re=V.value,te=V.type;if(A+=":"+G,G!="prn"&&G!="utf8"&&G!="ia5")return"mixed";if(G=="ia5"){if(te!="CN")return"mixed";if(f.lang.String.isMail(re))continue;return"mixed"}if(te=="C"){if(G=="prn")continue;return"mixed"}if(F+=":"+G,k==null)k=G;else if(k!==G)return"mixed"}return k??"prn"},this.getAttrTypeAndValue=function(y){var P=o(y);return E(P)},this.getRDN=function(y){var P=o(y);return D(P)},this.getX500NameArray=function(y){var P=o(y);return I(P)},this.getX500Name=function(y,P,C){var M=this.getX500NameArray(y),A=this.dnarraytostr(M),F={str:A};return F.array=M,C==!0&&(F.hex=y),P==!0&&(F.canon=this.c14nRDNArray(M)),F},this.readCertPEM=function(y){this.readCertHex(_(y))},this.readCertHex=function(y){this.hex=y,this.getVersion();try{u(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(y){var P={};return y==null&&(y={}),P.version=this.getVersion(),P.serial={hex:this.getSerialNumberHex()},P.sigalg=this.getSignatureAlgorithmField(),P.issuer=this.getIssuer(y.dncanon,y.dnhex),P.notbefore=this.getNotBefore(),P.notafter=this.getNotAfter(),P.subject=this.getSubject(y.dncanon,y.dnhex),P.sbjpubkey=dn(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(P.ext=this.getExtParamArray()),P.sighex=this.getSignatureValueHex(),y.tbshex==!0&&(P.tbshex=l(this.hex,0,[0])),y.nodnarray==!0&&(delete P.issuer.array,delete P.subject.array),P},this.getExtParamArray=function(y){if(y==null){var P=d(this.hex,0,[0,"[3]"]);P!=-1&&(y=h(this.hex,0,[0,"[3]",0],"30"))}for(var C=[],M=t(y,0),A=0;A<M.length;A++){var F=s(y,M[A]),k=this.getExtParam(F);k!=null&&C.push(k)}return C},this.getExtParam=function(y){var P={},C=t(y,0),M=C.length;if(M!=2&&M!=3)throw new Error("wrong number elements in Extension: "+M+" "+y);var A=x(a(y,0,[0],"06")),F=!1;M==3&&l(y,0,[1])=="0101ff"&&(F=!0);var k=l(y,0,[M-1,0]),T=void 0;if(A=="2.5.29.14"?T=this.getExtSubjectKeyIdentifier(k,F):A=="2.5.29.15"?T=this.getExtKeyUsage(k,F):A=="2.5.29.17"?T=this.getExtSubjectAltName(k,F):A=="2.5.29.18"?T=this.getExtIssuerAltName(k,F):A=="2.5.29.19"?T=this.getExtBasicConstraints(k,F):A=="2.5.29.30"?T=this.getExtNameConstraints(k,F):A=="2.5.29.31"?T=this.getExtCRLDistributionPoints(k,F):A=="2.5.29.32"?T=this.getExtCertificatePolicies(k,F):A=="2.5.29.33"?T=this.getExtPolicyMappings(k,F):A=="2.5.29.35"?T=this.getExtAuthorityKeyIdentifier(k,F):A=="2.5.29.36"?T=this.getExtPolicyConstraints(k,F):A=="2.5.29.37"?T=this.getExtExtKeyUsage(k,F):A=="2.5.29.54"?T=this.getExtInhibitAnyPolicy(k,F):A=="1.3.6.1.5.5.7.1.1"?T=this.getExtAuthorityInfoAccess(k,F):A=="2.5.29.20"?T=this.getExtCRLNumber(k,F):A=="2.5.29.21"?T=this.getExtCRLReason(k,F):A=="2.5.29.9"?T=this.getExtSubjectDirectoryAttributes(k,F):A=="1.3.6.1.5.5.7.48.1.2"?T=this.getExtOcspNonce(k,F):A=="1.3.6.1.5.5.7.48.1.5"?T=this.getExtOcspNoCheck(k,F):A=="1.2.840.113583.1.1.9.1"?T=this.getExtAdobeTimeStamp(k,F):he.EXT_PARSER[A]!=null&&(T=he.EXT_PARSER[A](A,F,k)),T!=null)return T;var R={extname:A,extn:k};try{R.extn=o(k)}catch{}return F&&(R.critical=!0),R},this.findExt=function(y,P){for(var C=0;C<y.length;C++)if(y[C].extname==P)return y[C];return null},this.updateExtCDPFullURI=function(y,P){var C=this.findExt(y,"cRLDistributionPoints");if(C!=null&&C.array!=null){for(var M=C.array,A=0;A<M.length;A++)if(M[A].dpname!=null&&M[A].dpname.full!=null)for(var F=M[A].dpname.full,k=0;k<F.length;k++){var T=F[A];T.uri!=null&&(T.uri=P)}}},this.updateExtAIAOCSP=function(y,P){var C=this.findExt(y,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var M=C.array,A=0;A<M.length;A++)M[A].ocsp!=null&&(M[A].ocsp=P)},this.updateExtAIACAIssuer=function(y,P){var C=this.findExt(y,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var M=C.array,A=0;A<M.length;A++)M[A].caissuer!=null&&(M[A].caissuer=P)},this.dnarraytostr=function(y){function P(M){return M.map(function(A){return C(A).replace(/\+/,"\\+")}).join("+")}function C(M){return M.type+"="+M.value}return"/"+y.map(function(M){return P(M).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(y){var P;if(y.str!=null&&y.array==null){var C=new f.asn1.x509.X500Name({str:y.str}),M=C.tohex();P=this.getX500NameArray(M)}else P=y.array;y.canon==null&&(y.canon=this.c14nRDNArray(P))},this.c14nRDNArray=function(y){for(var P=[],C=0;C<y.length;C++){for(var M=y[C],A=[],F=0;F<M.length;F++){var k=M[F],T=k.value;T=T.replace(/^\s*/,""),T=T.replace(/\s*$/,""),T=T.replace(/\s+/g," "),T=T.toLowerCase(),A.push(k.type.toLowerCase()+"="+T)}P.push(A.join("+"))}return"/"+P.join("/")},this.getInfo=function(){var y=function(ze){for(var pe="",Ee="    ",Oe=`
`,Ge=ze.array,St=0;St<Ge.length;St++){var Qe=Ge[St];if(Qe.dn!=null&&(pe+=Ee+"dn: "+Qe.dn.str+Oe),Qe.ip!=null&&(pe+=Ee+"ip: "+Qe.ip+Oe),Qe.rfc822!=null&&(pe+=Ee+"rfc822: "+Qe.rfc822+Oe),Qe.dns!=null&&(pe+=Ee+"dns: "+Qe.dns+Oe),Qe.uri!=null&&(pe+=Ee+"uri: "+Qe.uri+Oe),Qe.other!=null){var Cn=Qe.other.oid,ba=JSON.stringify(Qe.other.value).replace(/\"/g,"");pe+=Ee+"other: "+Cn+"="+ba+Oe}}return pe=pe.replace(/\n$/,""),pe},P=function(ze){for(var pe="",Ee=ze.array,Oe=0;Oe<Ee.length;Oe++){var Ge=Ee[Oe];if(pe+="    policy oid: "+Ge.policyoid+`
`,Ge.array!==void 0)for(var St=0;St<Ge.array.length;St++){var Qe=Ge.array[St];Qe.cps!==void 0&&(pe+="    cps: "+Qe.cps+`
`)}}return pe},C=function(ze){for(var pe="",Ee=ze.array,Oe=0;Oe<Ee.length;Oe++){var Ge=Ee[Oe];try{Ge.dpname.full[0].uri!==void 0&&(pe+="    "+Ge.dpname.full[0].uri+`
`)}catch{}try{Ge.dname.full[0].dn.hex!==void 0&&(pe+="    "+he.hex2dn(Ge.dpname.full[0].dn.hex)+`
`)}catch{}}return pe},M=function(ze){for(var pe="",Ee=ze.array,Oe=0;Oe<Ee.length;Oe++){var Ge=Ee[Oe];Ge.caissuer!==void 0&&(pe+="    caissuer: "+Ge.caissuer+`
`),Ge.ocsp!==void 0&&(pe+="    ocsp: "+Ge.ocsp+`
`)}return pe},A=he,F,k,T;if(F=`Basic Fields
`,F+="  serial number: "+this.getSerialNumberHex()+`
`,F+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,F+="  issuer: "+this.getIssuerString()+`
`,F+="  notBefore: "+this.getNotBefore()+`
`,F+="  notAfter: "+this.getNotAfter()+`
`,F+="  subject: "+this.getSubjectString()+`
`,F+=`  subject public key info: 
`,k=this.getPublicKey(),F+="    key algorithm: "+k.type+`
`,k.type==="RSA"&&(F+="    n="+F0(k.n.toString(16)).substr(0,16)+`...
`,F+="    e="+F0(k.e.toString(16))+`
`),T=this.aExtInfo,T!=null){F+=`X509v3 Extensions:
`;for(var R=0;R<T.length;R++){var N=T[R],q=f.asn1.x509.OID.oid2name(N.oid);q===""&&(q=N.oid);var V="";if(N.critical===!0&&(V="CRITICAL"),F+="  "+q+" "+V+`:
`,q==="basicConstraints"){var G=this.getExtBasicConstraints();G.cA===void 0?F+=`    {}
`:(F+="    cA=true",G.pathLen!==void 0&&(F+=", pathLen="+G.pathLen),F+=`
`)}else if(q=="policyMappings"){var re=this.getExtPolicyMappings().array,te=re.map(function(ze){var pe=ze;return pe[0]+":"+pe[1]}).join(", ");F+="    "+te+`
`}else if(q=="policyConstraints"){var be=this.getExtPolicyConstraints();F+="    ",be.reqexp!=null&&(F+=" reqexp="+be.reqexp),be.inhibit!=null&&(F+=" inhibit="+be.inhibit),F+=`
`}else if(q=="inhibitAnyPolicy"){var be=this.getExtInhibitAnyPolicy();F+="    skip="+be.skip+`
`}else if(q=="keyUsage")F+="    "+this.getExtKeyUsageString()+`
`;else if(q=="subjectKeyIdentifier")F+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(q=="authorityKeyIdentifier"){var ge=this.getExtAuthorityKeyIdentifier();ge.kid!==void 0&&(F+="    kid="+ge.kid.hex+`
`)}else if(q=="extKeyUsage"){var rt=this.getExtExtKeyUsage().array;F+="    "+rt.join(", ")+`
`}else if(q=="subjectAltName"){var He=y(this.getExtSubjectAltName());F+=He+`
`}else if(q=="cRLDistributionPoints"){var Ue=this.getExtCRLDistributionPoints();F+=C(Ue)}else if(q=="authorityInfoAccess"){var Je=this.getExtAuthorityInfoAccess();F+=M(Je)}else q=="certificatePolicies"&&(F+=P(this.getExtCertificatePolicies()))}}return F+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,F+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,F},typeof n=="string"&&(n.indexOf("-----BEGIN")!=-1?this.readCertPEM(n):f.lang.String.isHex(n)&&this.readCertHex(n))}he.EXT_PARSER={};he.registExtParser=function(n,e){he.EXT_PARSER[n]=e};he.hex2dn=function(n,e){e===void 0&&(e=0);var t=new he,r=$.getTLV(n,e),i=t.getX500Name(n);return i.str};he.hex2rdn=function(n,e){if(e===void 0&&(e=0),n.substr(e,2)!=="31")throw new Error("malformed RDN");for(var t=new Array,r=$.getChildIdx(n,e),i=0;i<r.length;i++)t.push(he.hex2attrTypeValue(n,r[i]));return t=t.map(function(o){return o.replace("+","\\+")}),t.join("+")};he.hex2attrTypeValue=function(n,e){var t=$,r=t.getV;if(e===void 0&&(e=0),n.substr(e,2)!=="30")throw new Error("malformed attribute type and value");var i=t.getChildIdx(n,e);i.length!==2||n.substr(i[0],2);var o=r(n,i[0]),s=f.asn1.ASN1Util.oidHexToInt(o),a=f.asn1.x509.OID.oid2atype(s),c=r(n,i[1]),l=In(c);return a+"="+l};he.getPublicKeyFromCertHex=function(n){var e=new he;return e.readCertHex(n),e.getPublicKey()};he.getPublicKeyFromCertPEM=function(n){var e=new he;return e.readCertPEM(n),e.getPublicKey()};he.getPublicKeyInfoPropOfCertPEM=function(n){var e=$,t=e.getVbyList,r={},i,o,s;return r.algparam=null,i=new he,i.readCertPEM(n),o=i.getPublicKeyHex(),r.keyhex=t(o,0,[1],"03").substr(2),r.algoid=t(o,0,[0,0],"06"),r.algoid==="2a8648ce3d0201"&&(r.algparam=t(o,0,[0,1],"06")),r};he.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var zW=function(n){var e=f,t=e.lang.String.isHex,r=$,i=r.getV,o=r.getTLV,s=r.getVbyList,a=r.getTLVbyList,c=r.getTLVbyListEx,l=r.getIdxbyList,h=r.getIdxbyListEx,u=r.getChildIdx,d=new he;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var p=l(this.hex,0,[0,0]),m=this.hex.substr(p,2);if(m=="02")this.posSigAlg=1;else if(m=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+m);var g=l(this.hex,0,[0,this.posSigAlg+3]),x=this.hex.substr(g,2);if(x=="17"||x=="18"){var b,_;b=l(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,b!=-1&&(_=this.hex.substr(b,2),_=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(x=="30")this.posRevCert=this.posSigAlg+3;else if(x=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+x)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(s(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var p=a(this.hex,0,[0,this.posSigAlg],"30");return d.getAlgorithmIdentifierName(p)},this.getIssuer=function(){return d.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return a(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var p=s(this.hex,0,[0,this.posSigAlg+2]);return result=In(p)},this.getNextUpdate=function(){var p=l(this.hex,0,[0,this.posSigAlg+3]),m=this.hex.substr(p,2);return m!="17"&&m!="18"?null:In(i(this.hex,p))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var p=[],m=l(this.hex,0,[0,this.posRevCert]),g=u(this.hex,m),x=0;x<g.length;x++){var b=o(this.hex,g[x]);p.push(this.getRevCert(b))}return p},this.getRevCert=function(p){var m={},g=u(p,0);return m.sn={hex:s(p,0,[0],"02")},m.date=In(s(p,0,[1])),g.length==3&&(m.ext=d.getExtParamArray(a(p,0,[2]))),m},this.findRevCert=function(p){var m=new he(p),g=m.getSerialNumberHex();return this.findRevCertBySN(g)},this.findRevCertBySN=function(p){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var m=this.parsed.revcert,g=0;g<m.length;g++)if(p==m[g].sn.hex)return m[g];return null},this.getSignatureValueHex=function(){return s(this.hex,0,[2],"03",!0)},this.verifySignature=function(p){var m=this.getSignatureAlgorithmField(),g=this.getSignatureValueHex(),x=a(this.hex,0,[0],"30"),b=new f.crypto.Signature({alg:m});return b.init(p),b.updateHex(x),b.verify(g)},this.getParam=function(p){var m={},g=this.getVersion();g!=null&&(m.version=g),m.sigalg=this.getSignatureAlgorithmField(),m.issuer=this.getIssuer(),m.thisupdate=this.getThisUpdate();var x=this.getNextUpdate();x!=null&&(m.nextupdate=x);var b=this.getRevCertArray();b!=null&&(m.revcert=b);var _=h(this.hex,0,[0,"[0]"]);if(_!=-1){var O=c(this.hex,0,[0,"[0]",0]);m.ext=d.getExtParamArray(O)}return m.sighex=this.getSignatureValueHex(),this.parsed=m,typeof p=="object"&&(p.tbshex==!0&&(m.tbshex=a(this.hex,0,[0])),p.nodnarray==!0&&delete m.issuer.array),m},typeof n=="string"&&(t(n)?this.hex=n:n.match(/-----BEGIN X509 CRL/)&&(this.hex=_t(n)),this._setPos())};(typeof f>"u"||!f)&&(f={});(typeof f.jws>"u"||!f.jws)&&(f.jws={});f.jws.JWS=function(){var n=f,e=n.jws.JWS,t=e.isSafeJSONString;this.parseJWS=function(r,i){if(!(this.parsedJWS!==void 0&&(i||this.parsedJWS.sigvalH!==void 0))){var o=r.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(o==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var s=o[1],a=o[2],c=o[3],l=s+"."+a;if(this.parsedJWS={},this.parsedJWS.headB64U=s,this.parsedJWS.payloadB64U=a,this.parsedJWS.sigvalB64U=c,this.parsedJWS.si=l,!i){var h=gt(c),u=Fn(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=u}var d=vr(s),p=vr(a);if(this.parsedJWS.headS=d,this.parsedJWS.payloadS=p,!t(d,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+d}}};f.jws.JWS.sign=function(n,e,t,r,i){var o=f,s=o.jws,a=s.JWS,c=a.readSafeJSONString,l=a.isSafeJSONString,h=o.crypto,u=h.ECDSA,d=h.Mac,p=h.Signature,m=JSON,g,x,b;if(typeof e!="string"&&typeof e!="object")throw"spHeader must be JSON string or object: "+e;if(typeof e=="object"&&(x=e,g=m.stringify(x)),typeof e=="string"){if(g=e,!l(g))throw"JWS Head is not safe JSON string: "+g;x=c(g)}if(b=t,typeof t=="object"&&(b=m.stringify(t)),(n==""||n==null)&&x.alg!==void 0&&(n=x.alg),n!=""&&n!=null&&x.alg===void 0&&(x.alg=n,g=m.stringify(x)),n!==x.alg)throw"alg and sHeader.alg doesn't match: "+n+"!="+x.alg;var _=null;if(a.jwsalg2sigalg[n]===void 0)throw"unsupported alg name: "+n;_=a.jwsalg2sigalg[n];var O=al(g),S=al(b),E=O+"."+S,D="";if(_.substr(0,4)=="Hmac"){if(r===void 0)throw"mac key shall be specified for HS* alg";var I=new d({alg:_,prov:"cryptojs",pass:r});I.updateString(E),D=I.doFinal()}else if(_.indexOf("withECDSA")!=-1){var y=new p({alg:_});y.init(r,i),y.updateString(E);var P=y.sign();D=f.crypto.ECDSA.asn1SigToConcatSig(P)}else if(_!="none"){var y=new p({alg:_});y.init(r,i),y.updateString(E),D=y.sign()}var C=It(D);return E+"."+C};f.jws.JWS.verify=function(n,e,t){var r=f,i=r.jws,o=i.JWS,s=o.readSafeJSONString,a=r.crypto,c=a.ECDSA,l=a.Mac,h=a.Signature,u;if(typeof ve!==void 0&&(u=ve),!V0(n))return!1;var d=n.split(".");if(d.length!==3)return!1;var p=d[0],m=d[1],g=p+"."+m,x=gt(d[2]),b=s(vr(d[0])),_=null,O=null;if(b.alg===void 0)throw"algorithm not specified in header";if(_=b.alg,O=_.substr(0,2),t!=null&&Object.prototype.toString.call(t)==="[object Array]"&&t.length>0){var S=":"+t.join(":")+":";if(S.indexOf(":"+_+":")==-1)throw"algorithm '"+_+"' not accepted in the list"}if(_!="none"&&e===null)throw"key shall be specified to verify.";if(typeof e=="string"&&e.indexOf("-----BEGIN ")!=-1&&(e=Me.getKey(e)),(O=="RS"||O=="PS")&&!(e instanceof u))throw"key shall be a RSAKey obj for RS* and PS* algs";if(O=="ES"&&!(e instanceof c))throw"key shall be a ECDSA obj for ES* algs";_=="none";var E=null;if(o.jwsalg2sigalg[b.alg]===void 0)throw"unsupported alg name: "+_;if(E=o.jwsalg2sigalg[_],E=="none")throw"not supported";if(E.substr(0,4)=="Hmac"){var D=null;if(e===void 0)throw"hexadecimal key shall be specified for HMAC";var I=new l({alg:E,pass:e});return I.updateString(g),D=I.doFinal(),x==D}else if(E.indexOf("withECDSA")!=-1){var y=null;try{y=c.concatSigToASN1Sig(x)}catch{return!1}var P=new h({alg:E});return P.init(e),P.updateString(g),P.verify(y)}else{var P=new h({alg:E});return P.init(e),P.updateString(g),P.verify(x)}};f.jws.JWS.parse=function(n){var e=n.split("."),t={},r,i,o;if(e.length!=2&&e.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return r=e[0],i=e[1],e.length==3&&(o=e[2]),t.headerObj=f.jws.JWS.readSafeJSONString(vr(r)),t.payloadObj=f.jws.JWS.readSafeJSONString(vr(i)),t.headerPP=JSON.stringify(t.headerObj,null,"  "),t.payloadObj==null?t.payloadPP=vr(i):t.payloadPP=JSON.stringify(t.payloadObj,null,"  "),o!==void 0&&(t.sigHex=gt(o)),t};f.jws.JWS.verifyJWT=function(n,e,t){var r=f,i=r.jws,o=i.JWS,s=o.readSafeJSONString,a=o.inArray,c=o.includedArray;if(!V0(n))return!1;var l=n.split(".");if(l.length!=3)return!1;var h=l[0],u=l[1],d=h+"."+u,p=gt(l[2]),m=s(vr(h)),g=s(vr(u));if(m.alg===void 0)return!1;if(t.alg===void 0)throw"acceptField.alg shall be specified";if(!a(m.alg,t.alg)||g.iss!==void 0&&typeof t.iss=="object"&&!a(g.iss,t.iss)||g.sub!==void 0&&typeof t.sub=="object"&&!a(g.sub,t.sub))return!1;if(g.aud!==void 0&&typeof t.aud=="object"){if(typeof g.aud=="string"){if(!a(g.aud,t.aud))return!1}else if(typeof g.aud=="object"&&!c(g.aud,t.aud))return!1}var x=i.IntDate.getNow();return t.verifyAt!==void 0&&typeof t.verifyAt=="number"&&(x=t.verifyAt),(t.gracePeriod===void 0||typeof t.gracePeriod!="number")&&(t.gracePeriod=0),!(g.exp!==void 0&&typeof g.exp=="number"&&g.exp+t.gracePeriod<x||g.nbf!==void 0&&typeof g.nbf=="number"&&x<g.nbf-t.gracePeriod||g.iat!==void 0&&typeof g.iat=="number"&&x<g.iat-t.gracePeriod||g.jti!==void 0&&t.jti!==void 0&&g.jti!==t.jti||!o.verify(n,e,t.alg))};f.jws.JWS.includedArray=function(n,e){var t=f.jws.JWS.inArray;if(n===null||typeof n!="object"||typeof n.length!="number")return!1;for(var r=0;r<n.length;r++)if(!t(n[r],e))return!1;return!0};f.jws.JWS.inArray=function(n,e){if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var t=0;t<e.length;t++)if(e[t]==n)return!0;return!1};f.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};f.jws.JWS.isSafeJSONString=function(n,e,t){var r=null;try{return r=uk(n),typeof r!="object"||r.constructor===Array?0:(e&&(e[t]=r),1)}catch{return 0}};f.jws.JWS.readSafeJSONString=function(n){var e=null;try{return e=uk(n),typeof e!="object"||e.constructor===Array?null:e}catch{return null}};f.jws.JWS.getEncodedSignatureValueFromJWS=function(n){var e=n.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(e==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]};f.jws.JWS.getJWKthumbprint=function(n){if(n.kty!=="RSA"&&n.kty!=="EC"&&n.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var e="{";if(n.kty==="RSA"){if(typeof n.n!="string"||typeof n.e!="string")throw"wrong n and e value for RSA key";e+='"e":"'+n.e+'",',e+='"kty":"'+n.kty+'",',e+='"n":"'+n.n+'"}'}else if(n.kty==="EC"){if(typeof n.crv!="string"||typeof n.x!="string"||typeof n.y!="string")throw"wrong crv, x and y value for EC key";e+='"crv":"'+n.crv+'",',e+='"kty":"'+n.kty+'",',e+='"x":"'+n.x+'",',e+='"y":"'+n.y+'"}'}else if(n.kty==="oct"){if(typeof n.k!="string")throw"wrong k value for oct(symmetric) key";e+='"kty":"'+n.kty+'",',e+='"k":"'+n.k+'"}'}var t=Nr(e),r=f.crypto.Util.hashHex(t,"sha256"),i=It(r);return i};f.jws.IntDate={};f.jws.IntDate.get=function(n){var e=f.jws.IntDate,t=e.getNow,r=e.getZulu;if(n=="now")return t();if(n=="now + 1hour")return t()+60*60;if(n=="now + 1day")return t()+60*60*24;if(n=="now + 1month")return t()+60*60*24*30;if(n=="now + 1year")return t()+60*60*24*365;if(n.match(/Z$/))return r(n);if(n.match(/^[0-9]+$/))return parseInt(n);throw"unsupported format: "+n};f.jws.IntDate.getZulu=function(n){return gk(n)};f.jws.IntDate.getNow=function(){var n=~~(new Date/1e3);return n};f.jws.IntDate.intDate2UTCString=function(n){var e=new Date(n*1e3);return e.toUTCString()};f.jws.IntDate.intDate2Zulu=function(n){var e=new Date(n*1e3),t=("0000"+e.getUTCFullYear()).slice(-4),r=("00"+(e.getUTCMonth()+1)).slice(-2),i=("00"+e.getUTCDate()).slice(-2),o=("00"+e.getUTCHours()).slice(-2),s=("00"+e.getUTCMinutes()).slice(-2),a=("00"+e.getUTCSeconds()).slice(-2);return t+r+i+o+s+a+"Z"};(typeof f>"u"||!f)&&(f={});(typeof f.jws>"u"||!f.jws)&&(f.jws={});f.jws.JWSJS=function(){var n=f,e=n.jws,t=e.JWS,r=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(i){this.init();var o=i.split(".");if(o.length!=3)throw"malformed input JWS";this.aHeader.push(o[0]),this.sPayload=o[1],this.aSignature.push(o[2])},this.addSignature=function(i,o,s,a){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var c=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var l=f.jws.JWS.sign(i,o,this.sPayload,s,a),h=l.split("."),u=h[0],d=h[2];this.aHeader.push(h[0]),this.aSignature.push(h[2])}catch(p){throw this.aHeader.length>c&&this.aHeader.pop(),this.aSignature.length>c&&this.aSignature.pop(),"addSignature failed: "+p}},this.verifyAll=function(i){if(this.aHeader.length!==i.length||this.aSignature.length!==i.length)return!1;for(var o=0;o<i.length;o++){var s=i[o];if(s.length!==2)return!1;var a=this.verifyNth(o,s[0],s[1]);if(a===!1)return!1}return!0},this.verifyNth=function(i,o,s){if(this.aHeader.length<=i||this.aSignature.length<=i)return!1;var a=this.aHeader[i],c=this.aSignature[i],l=a+"."+this.sPayload+"."+c,h=!1;try{h=t.verify(l,o,s)}catch{return!1}return h},this.readJWSJS=function(i){if(typeof i=="string"){var o=r(i);if(o==null)throw"argument is not safe JSON object string";this.aHeader=o.headers,this.sPayload=o.payload,this.aSignature=o.signatures}else try{if(i.headers.length>0)this.aHeader=i.headers;else throw"malformed header";if(typeof i.payload=="string")this.sPayload=i.payload;else throw"malformed signatures";if(i.signatures.length>0)this.aSignature=i.signatures;else throw"malformed signatures"}catch(s){throw"malformed JWS-JS JSON object: "+s}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};J.SecureRandom=ca;J.rng_seed_time=N0;J.BigInteger=B;J.RSAKey=ve;J.ECDSA=f.crypto.ECDSA;J.DSA=f.crypto.DSA;J.Signature=f.crypto.Signature;J.MessageDigest=f.crypto.MessageDigest;J.Mac=f.crypto.Mac;J.KEYUTIL=Me;J.ASN1HEX=$;J.X509=he;J.X509CRL=zW;J.CryptoJS=Q;J.b64tohex=oa;J.b64toBA=sk;J.ECFieldElementFp=Rt;J.ECPointFp=Le;J.ECCurveFp=ei;J.stoBA=hk;J.BAtos=pk;J.BAtohex=hp;J.stohex=zn;J.stob64=fW;J.stob64u=gW;J.b64utos=mW;J.b64tob64u=ia;J.b64utob64=ll;J.hex2b64=Zr;J.hextob64u=It;J.b64utohex=gt;J.utf8tob64u=al;J.b64utoutf8=vr;J.utf8tob64=vW;J.b64toutf8=bW;J.utf8tohex=pp;J.hextoutf8=Ve;J.hextorstr=In;J.rstrtohex=Nr;J.hextob64=B0;J.hextob64nl=yW;J.b64nltohex=fk;J.hextopem=dn;J.pemtohex=_t;J.hextoArrayBuffer=PW;J.ArrayBuffertohex=OW;J.zulutomsec=L0;J.msectozulu=MW;J.zulutosec=gk;J.zulutodate=SW;J.datetozulu=EW;J.uricmptohex=gp;J.hextouricmp=mp;J.ipv6tohex=T0;J.hextoipv6=D0;J.hextoip=ap;J.iptohex=q0;J.ucs2hextoutf8=j0;J.encodeURIComponentAll=vp;J.newline_toUnix=AW;J.newline_toDos=kW;J.hextoposhex=F0;J.intarystrtohex=TW;J.strdiffidx=DW;J.oidtohex=bk;J.hextooid=bp;J.strpad=cp;J.bitstrtoint=_k;J.inttobitstr=yk;J.bitstrtobinstr=Ck;J.binstrtobitstr=FW;J.isBase64URLDot=V0;J.namearraytobinstr=lp;J.extendClass=H;J.foldnl=fp;J.b64topem=CW;J.pemtob64=wW;J.timeogen=mk;J.aryval=tt;J.inttohex=xk;J.twoscompl=dl;J.KJUR=f;J.crypto=f.crypto;J.asn1=f.asn1;J.jws=f.jws;J.lang=f.lang;J.VERSION=HH;J.VERSION_FULL=UH});var Tk=z((Bme,kk)=>{"use strict";function IW(n,e){return Object.prototype.hasOwnProperty.call(n,e)}kk.exports=function(n,e,t,r){e=e||"&",t=t||"=";var i={};if(typeof n!="string"||n.length===0)return i;var o=/\+/g;n=n.split(e);var s=1e3;r&&typeof r.maxKeys=="number"&&(s=r.maxKeys);var a=n.length;s>0&&a>s&&(a=s);for(var c=0;c<a;++c){var l=n[c].replace(o,"%20"),h=l.indexOf(t),u,d,p,m;h>=0?(u=l.substr(0,h),d=l.substr(h+1)):(u=l,d=""),p=decodeURIComponent(u),m=decodeURIComponent(d),IW(i,p)?Array.isArray(i[p])?i[p].push(m):i[p]=[i[p],m]:i[p]=m}return i}});var Fk=z((Lme,Dk)=>{"use strict";var hl=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};Dk.exports=function(n,e,t,r){return e=e||"&",t=t||"=",n===null&&(n=void 0),typeof n=="object"?Object.keys(n).map(function(i){var o=encodeURIComponent(hl(i))+t;return Array.isArray(n[i])?n[i].map(function(s){return o+encodeURIComponent(hl(s))}).join(e):o+encodeURIComponent(hl(n[i]))}).filter(Boolean).join(e):r?encodeURIComponent(hl(r))+t+encodeURIComponent(hl(n)):""}});var zk=z(pl=>{"use strict";pl.decode=pl.parse=Tk();pl.encode=pl.stringify=Fk()});var G0=z((U0,Rk)=>{U0=Rk.exports=RW;U0.getSerialize=Ik;function RW(n,e,t,r){return JSON.stringify(n,Ik(e,r),t)}function Ik(n,e){var t=[],r=[];return e==null&&(e=function(i,o){return t[0]===o?"[Circular ~]":"[Circular ~."+r.slice(0,t.indexOf(o)).join(".")+"]"}),function(i,o){if(t.length>0){var s=t.indexOf(this);~s?t.splice(s+1):t.push(this),~s?r.splice(s,1/0,i):r.push(i),~t.indexOf(o)&&(o=e.call(this,i,o))}else t.push(o);return n==null?o:n.call(this,i,o)}}});var M3=z((ii,O3)=>{var P3=typeof self<"u"?self:ii,Up=function(){function n(){this.fetch=!1,this.DOMException=P3.DOMException}return n.prototype=P3,new n}();(function(n){var e=function(t){var r={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function i(C){return C&&DataView.prototype.isPrototypeOf(C)}if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(C){return C&&o.indexOf(Object.prototype.toString.call(C))>-1};function a(C){if(typeof C!="string"&&(C=String(C)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(C))throw new TypeError("Invalid character in header field name");return C.toLowerCase()}function c(C){return typeof C!="string"&&(C=String(C)),C}function l(C){var M={next:function(){var A=C.shift();return{done:A===void 0,value:A}}};return r.iterable&&(M[Symbol.iterator]=function(){return M}),M}function h(C){this.map={},C instanceof h?C.forEach(function(M,A){this.append(A,M)},this):Array.isArray(C)?C.forEach(function(M){this.append(M[0],M[1])},this):C&&Object.getOwnPropertyNames(C).forEach(function(M){this.append(M,C[M])},this)}h.prototype.append=function(C,M){C=a(C),M=c(M);var A=this.map[C];this.map[C]=A?A+", "+M:M},h.prototype.delete=function(C){delete this.map[a(C)]},h.prototype.get=function(C){return C=a(C),this.has(C)?this.map[C]:null},h.prototype.has=function(C){return this.map.hasOwnProperty(a(C))},h.prototype.set=function(C,M){this.map[a(C)]=c(M)},h.prototype.forEach=function(C,M){for(var A in this.map)this.map.hasOwnProperty(A)&&C.call(M,this.map[A],A,this)},h.prototype.keys=function(){var C=[];return this.forEach(function(M,A){C.push(A)}),l(C)},h.prototype.values=function(){var C=[];return this.forEach(function(M){C.push(M)}),l(C)},h.prototype.entries=function(){var C=[];return this.forEach(function(M,A){C.push([A,M])}),l(C)},r.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function u(C){if(C.bodyUsed)return Promise.reject(new TypeError("Already read"));C.bodyUsed=!0}function d(C){return new Promise(function(M,A){C.onload=function(){M(C.result)},C.onerror=function(){A(C.error)}})}function p(C){var M=new FileReader,A=d(M);return M.readAsArrayBuffer(C),A}function m(C){var M=new FileReader,A=d(M);return M.readAsText(C),A}function g(C){for(var M=new Uint8Array(C),A=new Array(M.length),F=0;F<M.length;F++)A[F]=String.fromCharCode(M[F]);return A.join("")}function x(C){if(C.slice)return C.slice(0);var M=new Uint8Array(C.byteLength);return M.set(new Uint8Array(C)),M.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(C){this._bodyInit=C,C?typeof C=="string"?this._bodyText=C:r.blob&&Blob.prototype.isPrototypeOf(C)?this._bodyBlob=C:r.formData&&FormData.prototype.isPrototypeOf(C)?this._bodyFormData=C:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)?this._bodyText=C.toString():r.arrayBuffer&&r.blob&&i(C)?(this._bodyArrayBuffer=x(C.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(C)||s(C))?this._bodyArrayBuffer=x(C):this._bodyText=C=Object.prototype.toString.call(C):this._bodyText="",this.headers.get("content-type")||(typeof C=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var C=u(this);if(C)return C;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var C=u(this);if(C)return C;if(this._bodyBlob)return m(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function O(C){var M=C.toUpperCase();return _.indexOf(M)>-1?M:C}function S(C,M){M=M||{};var A=M.body;if(C instanceof S){if(C.bodyUsed)throw new TypeError("Already read");this.url=C.url,this.credentials=C.credentials,M.headers||(this.headers=new h(C.headers)),this.method=C.method,this.mode=C.mode,this.signal=C.signal,!A&&C._bodyInit!=null&&(A=C._bodyInit,C.bodyUsed=!0)}else this.url=String(C);if(this.credentials=M.credentials||this.credentials||"same-origin",(M.headers||!this.headers)&&(this.headers=new h(M.headers)),this.method=O(M.method||this.method||"GET"),this.mode=M.mode||this.mode||null,this.signal=M.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&A)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(A)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function E(C){var M=new FormData;return C.trim().split("&").forEach(function(A){if(A){var F=A.split("="),k=F.shift().replace(/\+/g," "),T=F.join("=").replace(/\+/g," ");M.append(decodeURIComponent(k),decodeURIComponent(T))}}),M}function D(C){var M=new h,A=C.replace(/\r?\n[\t ]+/g," ");return A.split(/\r?\n/).forEach(function(F){var k=F.split(":"),T=k.shift().trim();if(T){var R=k.join(":").trim();M.append(T,R)}}),M}b.call(S.prototype);function I(C,M){M||(M={}),this.type="default",this.status=M.status===void 0?200:M.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in M?M.statusText:"OK",this.headers=new h(M.headers),this.url=M.url||"",this._initBody(C)}b.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},I.error=function(){var C=new I(null,{status:0,statusText:""});return C.type="error",C};var y=[301,302,303,307,308];I.redirect=function(C,M){if(y.indexOf(M)===-1)throw new RangeError("Invalid status code");return new I(null,{status:M,headers:{location:C}})},t.DOMException=n.DOMException;try{new t.DOMException}catch{t.DOMException=function(M,A){this.message=M,this.name=A;var F=Error(M);this.stack=F.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function P(C,M){return new Promise(function(A,F){var k=new S(C,M);if(k.signal&&k.signal.aborted)return F(new t.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function R(){T.abort()}T.onload=function(){var N={status:T.status,statusText:T.statusText,headers:D(T.getAllResponseHeaders()||"")};N.url="responseURL"in T?T.responseURL:N.headers.get("X-Request-URL");var q="response"in T?T.response:T.responseText;A(new I(q,N))},T.onerror=function(){F(new TypeError("Network request failed"))},T.ontimeout=function(){F(new TypeError("Network request failed"))},T.onabort=function(){F(new t.DOMException("Aborted","AbortError"))},T.open(k.method,k.url,!0),k.credentials==="include"?T.withCredentials=!0:k.credentials==="omit"&&(T.withCredentials=!1),"responseType"in T&&r.blob&&(T.responseType="blob"),k.headers.forEach(function(N,q){T.setRequestHeader(q,N)}),k.signal&&(k.signal.addEventListener("abort",R),T.onreadystatechange=function(){T.readyState===4&&k.signal.removeEventListener("abort",R)}),T.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return P.polyfill=!0,n.fetch||(n.fetch=P,n.Headers=h,n.Request=S,n.Response=I),t.Headers=h,t.Request=S,t.Response=I,t.fetch=P,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(Up);Up.fetch.ponyfill=!0;delete Up.fetch.polyfill;var ha=Up;ii=ha.fetch;ii.default=ha.fetch;ii.fetch=ha.fetch;ii.Headers=ha.Headers;ii.Request=ha.Request;ii.Response=ha.Response;O3.exports=ii});var A3=z((hxe,E3)=>{"use strict";E3.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var D3=z(hb=>{"use strict";var dK=Object.prototype.hasOwnProperty,uK;function k3(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch{return null}}function T3(n){try{return encodeURIComponent(n)}catch{return null}}function hK(n){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},r;r=e.exec(n);){var i=k3(r[1]),o=k3(r[2]);i===null||o===null||i in t||(t[i]=o)}return t}function pK(n,e){e=e||"";var t=[],r,i;typeof e!="string"&&(e="?");for(i in n)if(dK.call(n,i)){if(r=n[i],!r&&(r===null||r===uK||isNaN(r))&&(r=""),i=T3(i),r=T3(r),i===null||r===null)continue;t.push(i+"="+r)}return t.length?e+t.join("&"):""}hb.stringify=pK;hb.parse=hK});var q3=z((fxe,L3)=>{"use strict";var z3=A3(),$p=D3(),fK=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,I3=/[\n\r\t]/g,gK=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,R3=/:\d+$/,mK=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,vK=/^[a-zA-Z]:/;function fb(n){return(n||"").toString().replace(fK,"")}var pb=[["#","hash"],["?","query"],function(e,t){return Br(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],F3={hash:1,query:1};function N3(n){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var t=e.location||{};n=n||t;var r={},i=typeof n,o;if(n.protocol==="blob:")r=new Lr(unescape(n.pathname),{});else if(i==="string"){r=new Lr(n,{});for(o in F3)delete r[o]}else if(i==="object"){for(o in n)o in F3||(r[o]=n[o]);r.slashes===void 0&&(r.slashes=gK.test(n.href))}return r}function Br(n){return n==="file:"||n==="ftp:"||n==="http:"||n==="https:"||n==="ws:"||n==="wss:"}function B3(n,e){n=fb(n),n=n.replace(I3,""),e=e||{};var t=mK.exec(n),r=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],r==="file:"?s>=2&&(a=a.slice(2)):Br(r)?a=t[4]:r?i&&(a=a.slice(2)):s>=2&&Br(e.protocol)&&(a=t[4]),{protocol:r,slashes:i||Br(r),slashesCount:s,rest:a}}function bK(n,e){if(n==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(n.split("/")),r=t.length,i=t[r-1],o=!1,s=0;r--;)t[r]==="."?t.splice(r,1):t[r]===".."?(t.splice(r,1),s++):s&&(r===0&&(o=!0),t.splice(r,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function Lr(n,e,t){if(n=fb(n),n=n.replace(I3,""),!(this instanceof Lr))return new Lr(n,e,t);var r,i,o,s,a,c,l=pb.slice(),h=typeof e,u=this,d=0;for(h!=="object"&&h!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=$p.parse),e=N3(e),i=B3(n||"",e),r=!i.protocol&&!i.slashes,u.slashes=i.slashes||r&&e.slashes,u.protocol=i.protocol||e.protocol||"",n=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||vK.test(n))||!i.slashes&&(i.protocol||i.slashesCount<2||!Br(u.protocol)))&&(l[3]=[/(.*)/,"pathname"]);d<l.length;d++){if(s=l[d],typeof s=="function"){n=s(n,u);continue}o=s[0],c=s[1],o!==o?u[c]=n:typeof o=="string"?(a=o==="@"?n.lastIndexOf(o):n.indexOf(o),~a&&(typeof s[2]=="number"?(u[c]=n.slice(0,a),n=n.slice(a+s[2])):(u[c]=n.slice(a),n=n.slice(0,a)))):(a=o.exec(n))&&(u[c]=a[1],n=n.slice(0,a.index)),u[c]=u[c]||r&&s[3]&&e[c]||"",s[4]&&(u[c]=u[c].toLowerCase())}t&&(u.query=t(u.query)),r&&e.slashes&&u.pathname.charAt(0)!=="/"&&(u.pathname!==""||e.pathname!=="")&&(u.pathname=bK(u.pathname,e.pathname)),u.pathname.charAt(0)!=="/"&&Br(u.protocol)&&(u.pathname="/"+u.pathname),z3(u.port,u.protocol)||(u.host=u.hostname,u.port=""),u.username=u.password="",u.auth&&(a=u.auth.indexOf(":"),~a?(u.username=u.auth.slice(0,a),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=u.auth.slice(a+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(u.auth)),u.auth=u.password?u.username+":"+u.password:u.username),u.origin=u.protocol!=="file:"&&Br(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString()}function xK(n,e,t){var r=this;switch(n){case"query":typeof e=="string"&&e.length&&(e=(t||$p.parse)(e)),r[n]=e;break;case"port":r[n]=e,z3(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[n]="");break;case"hostname":r[n]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[n]=e,R3.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!t;break;case"pathname":case"hash":if(e){var i=n==="pathname"?"/":"#";r[n]=e.charAt(0)!==i?i+e:e}else r[n]=e;break;case"username":case"password":r[n]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(r.username=e.slice(0,o),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(o+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<pb.length;s++){var a=pb[s];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin=r.protocol!=="file:"&&Br(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function _K(n){(!n||typeof n!="function")&&(n=$p.stringify);var e,t=this,r=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Br(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Br(t.protocol)&&!r&&t.pathname!=="/"&&(o+="@"),(r[r.length-1]===":"||R3.test(t.hostname)&&!t.port)&&(r+=":"),o+=r+t.pathname,e=typeof t.query=="object"?n(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}Lr.prototype={set:xK,toString:_K};Lr.extractProtocol=B3;Lr.location=N3;Lr.trimLeft=fb;Lr.qs=$p;L3.exports=Lr});var V3=W(()=>{});var H3=W(()=>{});var U3=W(()=>{});var G3,W3,K3=W(()=>{G3=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(G3||{}),W3=function(n){return n.ThrottlingError="ThrottlingError",n.InvalidScopeError="InvalidScopeError",n.BadRequestError="BadRequestError",n.LimitExceededError="LimitExceededError",n}(W3||{})});var $3,X3,J3=W(()=>{$3=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}($3||{}),X3=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(X3||{})});var Q3,Y3=W(()=>{Q3=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Q3||{})});var Z3=W(()=>{});var e5=W(()=>{});var t5,n5=W(()=>{t5=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(t5||{})});var r5=W(()=>{});var xb={};Yi(xb,{FileMode:()=>$3,MessageType:()=>G3,NackErrorType:()=>W3,ScopeType:()=>t5,SummaryType:()=>Q3,TreeEntry:()=>X3});var _b=W(()=>{V3();H3();U3();K3();J3();Y3();Z3();e5();n5();r5();});var i5=z(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.generateUser=pa.generateToken=void 0;var OK=Mk(),yb=(qt(),en(fc));function MK(n,e,t,r,i,o=60*60,s="1.0"){let a=i||Cb();(a.id===""||a.id===void 0)&&(a=Cb());let c=Math.round(Date.now()/1e3),h={documentId:r??"",scopes:t,tenantId:n,user:a,iat:c,exp:c+o,ver:s,jti:(0,yb.v4)()},u={utf8:e};return OK.KJUR.jws.JWS.sign(null,JSON.stringify({alg:"HS256",typ:"JWT"}),h,u)}pa.generateToken=MK;function Cb(){return{id:(0,yb.v4)(),name:(0,yb.v4)()}}pa.generateUser=Cb});var s5=z(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});Yp.InsecureTokenProvider=void 0;var fa=(_b(),en(xb)),o5=i5(),wb=class{constructor(e,t,r){this.tenantKey=e,this.user=t,this.scopes=r}fetchOrdererToken(e,t){return v(this,null,function*(){var r;return{fromCache:!0,jwt:(0,o5.generateToken)(e,this.tenantKey,(r=this.scopes)!==null&&r!==void 0?r:[fa.ScopeType.DocRead,fa.ScopeType.DocWrite,fa.ScopeType.SummaryWrite],t,this.user)}})}fetchStorageToken(e,t){return v(this,null,function*(){var r;return{fromCache:!0,jwt:(0,o5.generateToken)(e,this.tenantKey,(r=this.scopes)!==null&&r!==void 0?r:[fa.ScopeType.DocRead,fa.ScopeType.DocWrite,fa.ScopeType.SummaryWrite],t,this.user)}})}};Yp.InsecureTokenProvider=wb});var c5=z(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});Zp.MockFluidDataStoreContext=void 0;var SK=(Pe(),en(dm)),a5=(qt(),en(fc)),Pb=class{constructor(e=(0,a5.v4)(),t=!1,r=SK.DebugLogger.create("fluid:MockFluidDataStoreContext")){this.id=e,this.existing=t,this.logger=r,this.documentId=void 0,this.isLocalDataStore=!0,this.packagePath=void 0,this.options=void 0,this.clientId=(0,a5.v4)(),this.clientDetails=void 0,this.connected=!0,this.deltaManager=void 0,this.containerRuntime=void 0,this.storage=void 0,this.IFluidDataStoreRegistry=void 0,this.IFluidHandleContext=void 0,this.attachState=void 0,this.scope=void 0}on(e,t){switch(e){case"attaching":case"attached":return this;default:throw new Error("Method not implemented.")}}once(e,t){return this}off(e,t){throw new Error("Method not implemented.")}getQuorum(){}getAudience(){}submitMessage(e,t,r){throw new Error("Method not implemented.")}submitSignal(e,t){throw new Error("Method not implemented.")}bindToContext(){throw new Error("Method not implemented.")}setChannelDirty(e){throw new Error("Method not implemented.")}getAbsoluteUrl(e){return v(this,null,function*(){throw new Error("Method not implemented.")})}getCreateChildSummarizerNodeFn(e,t){throw new Error("Method not implemented.")}uploadBlob(e){return v(this,null,function*(){throw new Error("Method not implemented.")})}getInitialGCSummaryDetails(){return v(this,null,function*(){throw new Error("Method not implemented.")})}getBaseGCDetails(){return v(this,null,function*(){throw new Error("Method not implemented.")})}};Zp.MockFluidDataStoreContext=Pb});var Mb=z(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.MockDeltaManager=ma.MockDeltaQueue=void 0;var EK=fi(),l5=(Y(),en(sc)),ga=class extends EK.EventEmitter{constructor(){super(),this.queue=[],this.pauseCount=0,this.processCallback=()=>{}}get disposed(){}get paused(){return this.pauseCount!==0}get length(){return this.queue.length}get idle(){return this.queue.length===0}process(){Promise.resolve().then(()=>{for(;this.pauseCount===0&&this.length>0;){let e=this.pop();(0,l5.assert)(e!==void 0,"this is impossible due to the above length check"),this.processCallback(e)}})}push(e){this.queue.push(e),this.emit("push",e),this.process()}pop(){return this.queue.shift()}pause(){return v(this,null,function*(){this.pauseCount++})}resume(){this.pauseCount--,this.process()}peek(){return this.queue[0]}toArray(){return this.queue}dispose(){}waitTillProcessingDone(){return v(this,null,function*(){throw new Error("NYI")})}};ma.MockDeltaQueue=ga;var Ob=class extends l5.TypedEventEmitter{constructor(){super(),this.readOnlyInfo={readonly:!1},this.clientType=void 0,this.clientDetails=void 0,this._inbound=void 0,this._inboundSignal=void 0,this._outbound=void 0,this.minimumSequenceNumber=0,this.lastSequenceNumber=0,this.lastKnownSeqNumber=0,this.initialSequenceNumber=0,this.hasCheckpointSequenceNumber=!1,this._inbound=new ga,this._outbound=new ga,this._inboundSignal=new ga}get disposed(){}get IDeltaSender(){return this}get inbound(){return this._inbound}get outbound(){return this._outbound}get inboundSignal(){return this._inboundSignal}get version(){}get maxMessageSize(){return 0}get serviceConfiguration(){}get active(){return!0}close(){}submitSignal(e){}flush(){}submit(e,t,r=!1,i){return 0}dispose(){}};ma.MockDeltaManager=Ob});var d5=z(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.MockHandle=void 0;var Sb=(Vt(),en(jv)),Eb=class{constructor(e,t=`mock-handle-${Math.random().toString(36).slice(2)}`,r=`/${t}`){this.value=e,this.path=t,this.absolutePath=r,this.graphAttachState=Sb.AttachState.Detached}get IFluidHandle(){return this}get isAttached(){return this.graphAttachState===Sb.AttachState.Attached}get(){return v(this,null,function*(){return this.value})}attachGraph(){this.graphAttachState=Sb.AttachState.Attached}bind(){throw Error("MockHandle.bind() unimplemented.")}};ef.MockHandle=Eb});var zb=z(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.MockSharedObjectServices=Gt.MockObjectStorageService=Gt.MockEmptyDeltaConnection=Gt.MockFluidDataStoreRuntime=Gt.MockQuorumClients=Gt.MockContainerRuntimeFactory=Gt.MockContainerRuntime=Gt.MockDeltaConnection=void 0;var h5=fi(),af=(Y(),en(sc)),u5=(Vt(),en(jv)),AK=(Pe(),en(dm)),tf=(_b(),en(xb)),Ab=(bt(),en(Lv)),kb=(qt(),en(fc)),p5=Mb(),nf=class{constructor(e,t){this.submitFn=e,this.dirtyFn=t,this._connected=!0}get connected(){return this._connected}attach(e){this.handler=e,e.setConnectionState(this.connected)}submit(e,t){return this.submitFn(e,t)}dirty(){this.dirtyFn()}setConnectionState(e){var t;this._connected=e,(t=this.handler)===null||t===void 0||t.setConnectionState(e)}process(e,t,r){var i;(i=this.handler)===null||i===void 0||i.process(e,t,r)}reSubmit(e,t){var r;(r=this.handler)===null||r===void 0||r.reSubmit(e,t)}};Gt.MockDeltaConnection=nf;var rf=class{constructor(e,t){var r;this.dataStoreRuntime=e,this.factory=t,this.clientSequenceNumber=0,this.deltaConnections=[],this.pendingMessages=[],this.deltaManager=new p5.MockDeltaManager,this.dataStoreRuntime.deltaManager=this.deltaManager,this.dataStoreRuntime.quorum=t.quorum,this.clientId=(r=this.dataStoreRuntime.clientId)!==null&&r!==void 0?r:(0,kb.v4)(),t.quorum.addMember(this.clientId,{})}createDeltaConnection(){let e=new nf((t,r)=>this.submit(t,r),()=>this.dirty());return this.deltaConnections.push(e),e}submit(e,t){let r=this.clientSequenceNumber++,i={clientId:this.clientId,clientSequenceNumber:r,contents:e,referenceSequenceNumber:this.deltaManager.lastSequenceNumber,type:tf.MessageType.Operation};return this.factory.pushMessage(i),this.addPendingMessage(e,t,r),r}dirty(){}process(e){this.deltaManager.lastSequenceNumber=e.sequenceNumber,this.deltaManager.lastMessage=e,this.deltaManager.minimumSequenceNumber=e.minimumSequenceNumber;let[t,r]=this.processInternal(e);this.deltaConnections.forEach(i=>{i.process(e,t,r)})}addPendingMessage(e,t,r){let i={content:e,clientSequenceNumber:r,localOpMetadata:t};this.pendingMessages.push(i)}processInternal(e){let t,r=this.clientId===e.clientId;if(r){let i=this.pendingMessages.shift();(0,af.assert)(i?.clientSequenceNumber===e.clientSequenceNumber,"Unexpected client sequence number from message"),t=i.localOpMetadata}return[r,t]}};Gt.MockContainerRuntime=rf;var Tb=class{constructor(){this.sequenceNumber=0,this.minSeq=new Map,this.quorum=new Al,this.messages=[],this.runtimes=[]}get outstandingMessageCount(){return this.messages.length}getMinSeq(){let e;for(let[t,r]of this.minSeq)this.quorum.getMember(t)!==void 0&&(e=e===void 0?r:Math.min(e,r));return e??0}createContainerRuntime(e){let t=new rf(e,this);return this.runtimes.push(t),t}pushMessage(e){e.clientId&&e.referenceSequenceNumber!==void 0&&!this.minSeq.has(e.clientId)&&this.minSeq.set(e.clientId,e.referenceSequenceNumber),this.messages.push(e)}processOneMessage(){if(this.messages.length===0)throw new Error("Tried to process a message that did not exist");let e=this.messages.shift();e=JSON.parse(JSON.stringify(e)),this.minSeq.set(e.clientId,e.referenceSequenceNumber),e.sequenceNumber=++this.sequenceNumber,e.minimumSequenceNumber=this.getMinSeq();for(let t of this.runtimes)t.process(e)}processSomeMessages(e){if(e>this.messages.length)throw new Error("Tried to process more messages than exist");for(let t=0;t<e;t++)this.processOneMessage()}processAllMessages(){for(;this.messages.length>0;)this.processOneMessage()}};Gt.MockContainerRuntimeFactory=Tb;var Al=class{constructor(...e){var t;this.eventEmitter=new h5.EventEmitter,this.disposed=!1,this.members=new Map((t=e)!==null&&t!==void 0?t:[])}addMember(e,t){this.members.set(e,t),this.eventEmitter.emit("addMember",e,t)}removeMember(e){this.members.delete(e)&&this.eventEmitter.emit("removeMember",e)}getMembers(){return this.members}getMember(e){return this.getMembers().get(e)}dispose(){throw new Error("Method not implemented.")}addListener(e,t){throw new Error("Method not implemented.")}on(e,t){switch(e){case"afterOn":return this.eventEmitter.on(e,t),this;case"addMember":case"removeMember":return this.eventEmitter.on(e,t),this.eventEmitter.emit("afterOn",e),this;default:throw new Error("Method not implemented.")}}once(e,t){throw new Error("Method not implemented.")}prependListener(e,t){throw new Error("Method not implemented.")}prependOnceListener(e,t){throw new Error("Method not implemented.")}removeListener(e,t){return this.eventEmitter.removeListener(e,t),this}off(e,t){return this.eventEmitter.off(e,t),this}removeAllListeners(e){throw new Error("Method not implemented.")}setMaxListeners(e){throw new Error("Method not implemented.")}getMaxListeners(){throw new Error("Method not implemented.")}listeners(e){throw new Error("Method not implemented.")}rawListeners(e){throw new Error("Method not implemented.")}emit(e,...t){throw new Error("Method not implemented.")}eventNames(){throw new Error("Method not implemented.")}listenerCount(e){throw new Error("Method not implemented.")}};Gt.MockQuorumClients=Al;var Db=class extends h5.EventEmitter{constructor(){super(...arguments),this.documentId=void 0,this.id=(0,kb.v4)(),this.existing=void 0,this.options={},this.clientId=(0,kb.v4)(),this.path="",this.connected=!0,this.deltaManager=new p5.MockDeltaManager,this.loader=void 0,this.logger=AK.DebugLogger.create("fluid:MockFluidDataStoreRuntime"),this.quorum=new Al,this._local=!1,this._disposed=!1}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get IFluidRouter(){return this}get absolutePath(){return`/${this.id}`}get local(){return this._local}set local(e){this._local=e}get disposed(){return this._disposed}dispose(){this._disposed=!0}getChannel(e){return v(this,null,function*(){return null})}createChannel(e,t){return null}get isAttached(){return!this.local}get attachState(){return this.local?u5.AttachState.Detached:u5.AttachState.Attached}bindChannel(e){}attachGraph(){}bindToContext(){}bind(e){}getQuorum(){return this.quorum}getAudience(){return null}save(e){}close(){return v(this,null,function*(){})}uploadBlob(e){return v(this,null,function*(){return null})}getBlob(e){return v(this,null,function*(){return null})}submitMessage(e,t){return null}submitSignal(e,t){return null}process(e,t){}processSignal(e,t){}updateMinSequenceNumber(e){}setConnectionState(e,t){}resolveHandle(e){return v(this,null,function*(){return this.request(e)})}request(e){return v(this,null,function*(){return null})}addedGCOutboundReference(e,t){}summarize(e,t){return v(this,null,function*(){let r=(0,Ab.mergeStats)();return r.treeNodeCount++,{summary:{type:tf.SummaryType.Tree,tree:{}},stats:r}})}getGCData(){return v(this,null,function*(){return{gcNodes:{}}})}updateUsedRoutes(e,t){}getAttachSnapshot(){return[]}getAttachSummary(){let e=(0,Ab.mergeStats)();return e.treeNodeCount++,{summary:{type:tf.SummaryType.Tree,tree:{}},stats:e}}setAttachState(e){}waitAttached(){return v(this,null,function*(){})}requestDataStore(e){return v(this,null,function*(){return null})}reSubmit(e,t){}applyStashedOp(e){return v(this,null,function*(){})}rollback(e,t){}};Gt.MockFluidDataStoreRuntime=Db;var of=class{constructor(){this.connected=!1}attach(e){}submit(e){return(0,af.assert)(!1,"Throw submit error on mock empty delta connection"),0}dirty(){}};Gt.MockEmptyDeltaConnection=of;var sf=class{constructor(e){this.contents=e}readBlob(e){return v(this,null,function*(){return(0,af.stringToBuffer)(this.contents[e],"utf8")})}contains(e){return v(this,null,function*(){return this.contents[e]!==void 0})}list(e){return v(this,null,function*(){let t=(0,Ab.getNormalizedObjectStoragePathParts)(e).length;return Object.keys(this.contents).filter(r=>r.startsWith(e)&&r.split("/").length===t+1)})}};Gt.MockObjectStorageService=sf;var Fb=class n{constructor(e){this.deltaConnection=new of,this.objectStorage=new sf(e)}static createFromSummary(e){let t={};for(let[r,i]of Object.entries(e.tree))(0,af.assert)(i.type===tf.SummaryType.Blob,"Unexpected summary type on mock createFromSummary"),t[r]=i.content;return new n(t)}};Gt.MockSharedObjectServices=Fb});var g5=z(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.MockContainerRuntimeFactoryForReconnection=va.MockContainerRuntimeForReconnection=void 0;var kK=(qt(),en(fc)),TK=(Y(),en(sc)),f5=zb(),cf=class extends f5.MockContainerRuntime{constructor(e,t){super(e,t),this.pendingRemoteMessages=[],this._connected=!0}get connected(){return this._connected}set connected(e){if(this._connected!==e){if(this._connected=e,e){for(let t of this.pendingRemoteMessages)this.process(t);this.pendingRemoteMessages.length=0,this.clientSequenceNumber=0,this.clientId=(0,kK.v4)(),this.dataStoreRuntime.clientId=this.clientId,this.factory.quorum.addMember(this.clientId,{}),this.reSubmitMessages()}else this.factory.clearOutstandingClientMessages(this.clientId),this.factory.quorum.removeMember(this.clientId);this.deltaConnections.forEach(t=>{t.setConnectionState(this.connected)})}}process(e){this.connected?super.process(e):this.pendingRemoteMessages.push(e)}submit(e,t){return this.connected?super.submit(e,t):(this.addPendingMessage(e,t,-1),-1)}reSubmitMessages(){let e=this.pendingMessages.length;for(;e>0;){let t=this.pendingMessages.shift();(0,TK.assert)(t!==void 0,"this is impossible due to the above length check"),this.deltaConnections.forEach(r=>{r.reSubmit(t.content,t.localOpMetadata)}),e--}}};va.MockContainerRuntimeForReconnection=cf;var Ib=class extends f5.MockContainerRuntimeFactory{createContainerRuntime(e){let t=new cf(e,this);return this.runtimes.push(t),t}clearOutstandingClientMessages(e){this.messages=this.messages.filter(t=>t.clientId!==e)}};va.MockContainerRuntimeFactoryForReconnection=Ib});var v5=z(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.MockStorage=void 0;var Rb=(Y(),en(sc)),m5=(bt(),en(Lv)),Nb=class n{constructor(e){this.tree=e}static createFromSummary(e){let t=(0,m5.convertSummaryTreeToITree)(e);return new n(t)}static readBlobCore(e,t){if(e){for(let r of e.entries)if(r.path===t[0])return r.type==="Blob"?((0,Rb.assert)(t.length===1,JSON.stringify(Object.assign({},arguments))),r.value):r.type==="Tree"?n.readBlobCore(r.value,t.slice(1)):void 0;return}}readBlob(e){return v(this,null,function*(){let t=n.readBlobCore(this.tree,e.split("/"));return(0,Rb.assert)(t!==void 0,`Blob does not exist: ${e}`),(0,Rb.stringToBuffer)(t.contents,t.encoding)})}contains(e){return v(this,null,function*(){return n.readBlobCore(this.tree,e.split("/"))!==void 0})}list(e){return v(this,null,function*(){return(0,m5.listBlobsAtTreePath)(this.tree,e)})}};lf.MockStorage=Nb});var b5=z(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.shortCodeMap=void 0;df.shortCodeMap={"0x000":"nonzero isobuffer byte offset","0x001":"unexpected isobuffer byte length","0x003":"Primary to add to range < last primary!","0x004":"Secondary to add to range < last secondary!","0x005":"Target primary to retrieve < first range's primary!","0x006":"Target primary to retrieve < last range's primary!","0x007":"Target primary to update < first range's primary!","0x008":"Target primary to update < last range's primary!","0x009":"After update, target primary is not first range's primary!","0x00a":"Running timer missing handler","0x00b":"Handler executed without deferred","0x00c":"messageId is incorrect from from the local client's ACK","0x00d":"Missing message handler for message type","0x00e":"Missing message handler for message type","0x00f":"pendingMessageId is missing from the local client's operation","0x010":"Received out of order storage op when there is an unackd clear message","0x011":"pendingMessageId is missing from the local client's operation","0x012":"pendingMessageId is missing from the local client's operation","0x013":"Received out of order op when there is an unackd clear message","0x014":"pendingMessageId is missing from the local client's operation","0x015":"pendingMessageId is missing from the local client's clear operation","0x016":"apply stashed op not implemented for custom value type ops","0x017":"Trying to add invalid handle!","0x018":"Trying to insert handle into position with already valid handle!","0x019":"SharedMatrix.openUndo() supports at most a single IUndoConsumer.","0x01a":"Trying to set out-of-bounds cell!","0x01b":"Trying to set multiple out-of-bounds cells!","0x01c":"The 'localSeq' of the vector submitting an op must >= the 'localSeq' of the other vector.","0x01d":"Trying to submit message to runtime while detached!","0x01e":"Row and col collab window 'localSeq' desynchronized!","0x01f":"Row and col collab window 'collaborating' status desynchronized!","0x020":"Unknown SharedMatrix 'op' type.","0x021":"SharedMatrix message contents have unexpected type!","0x022":"SharedMatrix row and/or col handles are invalid!","0x023":"The 'localSeq' of pending write (if any) must be <= the localSeq of the currently processed op.","0x024":"Start of PermutationSegment already allocated!","0x025":"Trying to set start of PermutationSegment to invalid handle!","0x026":"Trying to split segment at out-of-bounds position!","0x027":"Trying to get handle of out-of-bounds position!","0x028":"'localSeq' for op being resubmitted must be <= the 'localSeq' of the last submitted op.","0x029":"Invalid handle at start of containing segment!","0x02a":"On vector undo, unexpected 'currentOp' type/state!","0x02b":"Must not nest calls to IRevertible.revert()","0x02c":"On cellSet(), invalid row and/or column handles!","0x02d":"Unexpected op type on range remove!","0x02e":"Unexpected op type on range annotate!","0x02f":"Unexpected op type on range insert!","0x030":"Incoming remote op sequence# <= local collabWindow's currentSequence#","0x031":"Incoming remote op minSequence# < local collabWindow's minSequence#","0x032":"localSeq greater than collab window","0x033":"Segment group undefined","0x034":"Segment group not at head of merge tree pending queue","0x035":"Segment group not at head of segment pending queue","0x036":"Segment has no pending properties","0x037":"Segment already has assigned sequence number","0x038":"Incoming op sequence# < local collabWindow's currentSequence#","0x039":"Incoming op sequence# < minSequence#","0x03a":"Number of ops in 'resetOp' must match the number of segment groups provided.","0x03b":"Number of ops in 'resetOp' must match the number of segment groups provided.","0x03c":"Reset op has 'group' delta type!","0x03d":"segmentGroup is array rather than singleton!","0x03e":"minSeq mismatch between collab window and delta manager!","0x03f":"New format should not emit catchup ops","0x040":"Child count is not within [1,7] range!","0x041":"Unexpected child ordinal length!","0x043":"On ack, unexpected segmentGroup!","0x044":"On annotate ack, missing segment property manager!","0x045":"On insert, seq number already assigned!","0x046":"On remove ack, missing removal info!","0x048":"onMinGE()","0x049":"Trying to reload from segments while collaborating!","0x04f":"minSeq of collab window > target minSeq!","0x050":"Next segment changes are undefined!","0x051":"Too many children on merge block!","0x054":"Sequence number less than minSeq!","0x055":"Sequence number is not sorted!","0x056":"Unexpected total for accumulation of all seglen adjustments!","0x057":"Negative length after length adjustment!","0x058":"Both overlapRemoveClients and clientPartials are set!","0x059":"Client view exists but flat view does not!","0x05a":"Mismatch between number of partial lengths on client and flat views!","0x05b":"Flat view exists but client view does not!","0x05c":"Trying to update more annotate props than do exist!","0x05d":"emit: mismatch in segmentsTotalLength","0x05e":"emit: mismatch in totalSegmentCount","0x05f":"Missing blob header on legacy snapshot!","0x060":"There should be only one blob with catch up ops","0x061":"Mismatch in totalLength","0x062":"Mismatch in totalSegmentCount","0x063":"Mismatch in totalLength","0x064":"Mismatch in totalSegmentCount","0x065":"On removal info preservation, segment has invalid removed sequence number!","0x066":"Corrupted preservation of segment metadata!","0x067":"Missing clientId for removal!","0x068":"On consensusOrderedCollection load, job tracking size > 0","0x069":"On consensusOrderedCollection load, data size > 0","0x06a":"Trying to submit message while detached!","0x06b":"Loading snapshot into a non-empty collection","0x06c":"Value should be undefined or non-empty","0x06d":"SharedObjects contained in ConsensusRegisterCollection can no longer be deserialized as of 0.17","0x06e":"Message's reference sequence number < op's reference sequence number!","0x06f":"data missing for non-atomic inbound update!","0x070":"sequence numbers are expected to be 0 when unattached","0x071":"Versions should naturally be ordered by sequenceNumber","0x072":"Unexpected local op when loading not finished","0x073":"Sequence message not operation","0x074":"Snapshot called when not fully loaded","0x075":"SummarySerializer should be used for serializing data during summary.","0x078":"Possible re-entrancy! Summary should not already be in progress.","0x079":"Possible re-entrancy! Summary should have been in progress.","0x07a":"Services should be there to attach delta handler","0x07b":"Unexpected op","0x07c":"Unexpected op type","0x07d":"Unexpected op","0x07e":"Unexpected op type","0x07f":"clientId undefined","0x080":"Invalid document service!","0x081":"Document service already set!","0x082":"Document storage service already set!","0x083":"User selection status does not match replay controller use status!","0x084":"On storage resolve, user selection already made!","0x085":"On storage resolve, missing storage!","0x086":"After storage resolve, user selection status still false!","0x088":"Missing button ops button!","0x089":"Stringified length of chunk contents > total starting length","0x08a":"resetting ChunkedOpProcessor that never wrote back its contents","0x08b":"Unexpected type on contents for fix of an attach!","0x08c":"innerContent for fixing op contents is undefined!","0x08d":"After sanitize, pending incomplete ops!","0x08e":"Potentially missed initial messages","0x08f":"No op handler is setup!","0x090":"No signal handler is setup!","0x091":"Retrieved ops' first sequence number has unexpected value!","0x092":"version input for reading snapshot tree is null!","0x093":"invalid version input for reading snapshot tree!","0x094":"Missing snapshot tree!","0x096":"Trying to remove valid tree IDs in removeNullTreeIds()!","0x097":"Missing param from office.com URL parameter","0x098":"OuterDocumentServiceFactoryProxy unavailable","0x099":"OuterUrlResolverProxy unavailable","0x09a":"'documentId' must be a defined, non-zero length string.","0x09d":"Connection details should contain epoch","0x09f":"No more socketIO refs to remove!","0x0a0":"Unexpected socketIO references on timeout","0x0a1":"Socket reference set unexpectedly does not point to this socket!","0x0a2":"reentrancy not supported!","0x0a4":"Unexpected blob encoding type","0x0a5":"Trying to set ops when they are already set!","0x0a8":"Docid should not contain slashes!!","0x0ad":"Snapshot entry has both a tree value and a referenced id!","0x0ae":"Tried to create rate limiter with 0 max requests!","0x0b0":"Missing document snapshot tree!","0x0b1":"Storage service not initialized","0x0b2":"Missing orderer URL!","0x0b7":"Pathname should be defined","0x0b8":"'tenantId' and 'documentId' must be defined, non-zero length strings.","0x0b9":"PathName should exist","0x0ba":"Tenant id should exist","0x0bb":"Document id should exist","0x0bc":"Runtime has no DataObject!","0x0bd":"Object runtime already has DataObject!","0x0be":"Trying to initialize from existing while initProps is set!","0x0bf":"set called recursively from the interception callback","0x0c0":"set called recursively from the interception callback","0x0c1":"Interception wrapper methods called recursively from the interception callback","0x0c2":"Interception wrapper methods called recursively from the interception callback","0x0c3":"Interception wrapper methods called recursively from the interception callback","0x0c4":"Interception wrapper methods called recursively from the interception callback","0x0c5":"Interception wrapper methods called recursively from the interception callback","0x0c6":"Interception wrapper methods called recursively from the interception callback","0x0c7":"Interception wrapper methods called recursively from the interception callback","0x0c8":"Interception wrapper methods called recursively from the interception callback","0x0c9":"Interception wrapper methods called recursively from the interception callback","0x0ca":"Trying to use legacy graph attach!","0x0cd":"Container disconnected while waiting for ops!","0x0cf":"disconnect event was not raised!","0x0d1":"Container should be attached before close","0x0d2":"resolved url should be valid Fluid url","0x0d3":"Should only be called in detached container","0x0d6":"Inbound queue should be empty when attaching","0x0d9":"Attempting to connect() a closed DeltaManager","0x0dd":"Existing context not disposed","0x0de":"Mismatch in connection state while setting","0x0df":"Missing active connection","0x0e0":"lost minBlobSize policy","0x0e2":"DeltaManager already has attached op handler!","0x0e3":"Newly set op handler is null/undefined!","0x0e4":"Lost old connection!","0x0e6":"old connection exists on new connection setup","0x0e7":"claims/connectionMode mismatch","0x0e8":"readonly perf with write connection","0x0e9":"messageBuffer is not empty on new connection","0x0eb":"Missing connection for reconnect","0x0ec":"Unexpected value for previously processed message's sequence number","0x0ed":"non-system message have to have clientId","0x0ee":"Not accounting local messages correctly","0x0ef":"client seq# not growing","0x0f0":"Incoming local client seq# > generated by this client","0x0f2":"previouslyProcessedMessage","0x0f3":"not positive","0x0f4":"Nonzero pause-count on resume()","0x0f6":"real blob ID exists","0x0f7":"aggregate blob missing","0x0f8":"blob from aggregate blob exists on its own","0x0f9":"never read summary","0x0fa":"virtual blob not found","0x0fb":"logic err with aggregator","0x0fc":"tree reuse at lower level","0x0fd":"data stores are writing incremental summaries!","0x0fe":"attachment is aggregate blob","0x0ff":"duplicate aggregate blob","0x100":"logic error","0x101":"Unexpected tree entry type on flatten!","0x102":"invalid level of concurrency","0x103":"trying to parallel run while not working","0x104":"undefined end point for parallel fetch","0x105":"unexpected end point for parallel fetch","0x107":"ending dispatch with remaining results to be sent","0x108":"ending results dispatch but knew in advance about more requests","0x109":"unexpected next chunk position","0x10a":"cannot add parallel request while not working","0x10b":"invalid parallel request range","0x10c":"invalid parallel request start point","0x10d":"invalid parallel request end point","0x10e":"should not throw result if we knew about boundary in advance","0x10f":"empty/partial chunks should not be returned by caching","0x110":"callback should retry until valid fetch before it learns new boundary","0x112":"cannot push onto queue if done","0x113":"deferred queue should be empty","0x114":"cannot pop if deferred","0x115":"queue should not be done during pop","0x116":"Missing handle on scheduler load","0x117":"Trying to get missing clientId!","0x118":"Bad client interactive check","0x119":"This agent became inactive while releasing","0x11a":"Unsuccessful registration","0x11b":"Trying to clear tasks on inactive agent","0x11c":"Detached object routing context","0x11d":"task is already running","0x11e":"client is undefined","0x11f":"requesting unknown blobs","0x120":"Undefined latency statistics (op send time)","0x121":"Undefined inner contents type!","0x122":"Message to unpack is not proper runtime message","0x124":"inconsistent readonly property/event state","0x125":"Unsafe to transition to read-only state!","0x126":"Expected createSubRequest url to include a leading slash","0x127":"dirty document event not set on replay","0x12a":"Missing blob id on metadata","0x12b":"did not get root data store","0x12d":"Container Context should already be in attaching state","0x12e":"Container Context should already be in attached state","0x12f":"Container Runtime's summarize should always return a tree","0x131":"Mismatch between new chunkId and expected chunkMap","0x132":"sending ops in detached container","0x133":"Container disconnected when trying to submit system message","0x137":"Failed to get version from storage","0x138":"Failed to get snapshot from storage","0x139":"Undefined package path","0x13a":"Data store ID contains slash","0x13b":"datastore context is already in bound state","0x13c":"undefined channel on datastore context","0x13d":"Detached runtime creation on realize()","0x13e":"Unexpected package path","0x13f":"datastore context registry is already set","0x140":"undefined channel on datastore context","0x141":"Unexpected connected state","0x142":"local store channel is not loaded","0x143":"Channel should not be undefined when running GC","0x144":"Channel should be loaded when updating used routes","0x145":"Channel should be present when data store is loaded","0x146":"Channel must exist when submitting message","0x147":"Channel must exist on submitting signal","0x148":"Detached runtime creation on runtime bind","0x149":"Undefined channel deferral","0x14a":"Undefined package path","0x14b":"Channel must exist when resubmitting ops","0x14c":"Channel must exist when rebasing ops","0x14d":"Should move from detached to attaching","0x14e":"Should move from attaching to attached","0x14f":"There should be a channel when generating attach message","0x150":"pkg should be available in local data store context","0x152":"pkg should be available in local data store","0x154":"runtime creation is already attached","0x155":"channel deferral is already set","0x156":"Unexpected factory for package path","0x157":"datastore registry already attached","0x158":"Creating store with existing ID","0x159":"The given id was not found in notBoundContexts to delete","0x15a":"Cannot find context to resolve to","0x15b":"Expected this id to already be removed from notBoundContexts","0x15c":"Cannot find deferred to resolve","0x15d":"Creating store with existing ID","0x15e":"Local object does not have matching attach message id","0x15f":"Could not find unbound context to bind","0x160":"There should be a store context for the op","0x161":"There should be a store context for the op","0x162":"There should be a store context for the op","0x163":"Missing datastore for local signal","0x165":"Summarizer cannot work if client has local changes","0x166":"BaseSnapshot should be there as detached container loaded from snapshot","0x167":"Used route does not belong to any known data store","0x168":"Expected tree in snapshot not found","0x169":"No pending message found for this remote message","0x16b":"The pending batch state indicates we are already processing a batch","0x16d":"There is no pending batch begin message","0x16e":"Batch with single message should not have batch metadata","0x16f":"Did not receive batch begin metadata","0x170":"Did not receive batch end metadata","0x171":"No pending state found for the remote message","0x172":"The connection state is not consistent with the runtime","0x173":"replayPendingStates called twice for same clientId!","0x174":"initial states should be empty before replaying pending","0x175":"Can only broadcast if summarizer starts in local state","0x176":"Can only ack/nack if summarizer is in broadcasting state","0x177":"Missing delta handler","0x178":"Missing delta handler on attach","0x179":"createChannel() with existing ID","0x17a":"Channel should be loaded when created!!","0x17b":"Channel to be binded should be in not bounded set","0x17c":"Unexpected attach (local) channel OP","0x17e":"Used route does not belong to any known context","0x17f":"Not expecting detached channels during summarize","0x180":"getAttachSummary should always return a tree","0x181":"BaseSnapshot should be there as detached container loaded from snapshot","0x182":"Data store should be attached to attach the channel.","0x183":"There should be a channel context for the op","0x184":"There should be a channel context for the op","0x185":"Channel not found","0x189":"Should always be remote because a local dds shouldn't generate ops before loading","0x18a":"Channel should be loaded to resubmit ops","0x18c":"Channel should be loaded to summarize","0x18d":"Channel should be loaded to take snapshot","0x18e":"Channel must not already be loaded when loading","0x190":".attributes blob should be present","0x192":"Channel should be there if loaded!!","0x193":"Channel should be loaded to run GC","0x194":"Remote channel must be loaded when rebasing op","0x195":"Remote channel must not be local when processing op","0x196":"Remote channel must be loaded when resubmitting op","0x197":"Remote channel must not already be loaded when loading","0x198":"Used route should always be an absolute route","0x19a":"Invalid response value for Fluid object request","0x19b":"Cannot not create response error on 200 status","0x19c":"storage service path has trailing separator","0x19d":"Handles should always have absolute paths","0x19f":"wipSummaryLogger should not be set yet in startSummary","0x1a0":"Already tracking a summary","0x1a1":"summarize should not be called when not tracking the summary","0x1a2":"wipSummaryLogger should have been set in startSummary or ctor","0x1a3":"wipSummaryLogger should have been set in startSummary or ctor","0x1a4":"Not tracking a summary","0x1a5":"Tracked summary local paths not set","0x1a6":"Not found pending summary, but this node has previously completed a summary","0x1a7":"Pending summary reference sequence number should be consistent","0x1a9":"When loading base summary, expected outstanding ops <= tracking sequence number","0x1aa":"Out of order change recorded","0x1ab":"Create SummarizerNode child already exists","0x1ac":"Cannot create child from summary if parent does not have latest summary","0x1ad":"Missing child summary tree","0x1ae":"Child summary object is not a tree","0x1af":"Outstanding ops blob missing, but base summary tree exists","0x1b0":"Base summary tree missing, but outstanding ops blob exists","0x1b1":"wip used routes should be set if tracking a summary","0x1b2":"Getting GC data should not be called when GC is disabled!","0x1b3":"GC data cannot be retrieved without getGCDataFn","0x1b4":"We should not already be tracking used routes when to track a new summary","0x1b5":"We should have been tracking used routes","0x1b6":"Create SummarizerNode child already exists","0x1b7":"Bad session state for processing quorum messages","0x1b8":"Bad session state for processing quorum messages","0x1b9":"Unexpected value for sequence number of first message in file","0x1ba":"should not return empty buckets","0x1bb":"Unexpected sequence number on first of messages to save","0x1bc":"Unexpected sequence number on last of messages to save","0x1bd":"Stopped writing at unexpected sequence number","0x1c5":"snapshot should be set before retrieving it","0x1c6":"snapshot should be set before retrieving it","0x1c7":"snapshot should be set before retrieving it as expanded string","0x1c8":"Mismatch between document sequence number and current op number","0x1c9":"Leftover documents after replay!","0x1ca":"replay-to target is <= current op in replay cycle","0x1cb":"Bad window to verify snapshot","0x1cc":"Unexpected previous snapshot op number","0x1ce":"clientId not found","0x1cf":"clientId not found","0x1d0":"sequenceNumber not found","0x1d3":"Missing client id on disconnect","0x1d5":"Invalid snapshot format version","0x1d6":"Parent summary object is not a tree","0x1d8":"Should only transition from Connecting state","0x1d9":"addRequestCore() should break into smaller chunks","0x1da":"Client id should be set if connected","0x1db":"epoch exists","0x1dc":"all entries have to have epoch","0x1dd":"no epoch","0x1de":"Not an ODSP resolved url","0x1e0":"Protocol and App summary trees should be present","0x1e2":"Caller must ensure 'isAttached()' before calling 'sendSetCellOp'.","0x1e4":"Unexpected serializable type","0x1e5":"Storage token should not be null","0x1e6":"Epoch  should be present in response","0x1e7":"caching was not performed!","0x1e8":"reentrancy","0x1e9":"Pending ops","0x1ea":"Prefetch snapshot only available for odsp!","0x1eb":"Snapshot should be prefetched!","0x1ec":"No refresh token provided.","0x1ed":"Share link should be present","0x1ef":"services must be defined","0x1f0":"Unexpected mismatch in readonly","0x1f5":"Attached state should have storage","0x1f6":"Negative client sequence number not allowed","0x1f7":"Previous client should always be defined","0x1f8":"local BlobAttach op with no pending blob","0x1fc":"summary is not a tree","0x1fe":"isolated channels subtree should exist in remote datastore snapshot","0x1ff":"isolated channels subtree should exist in local datastore snapshot","0x200":"Returned odsp snapshot is malformed. No trees!","0x201":"Returned odsp snapshot is malformed. No blobs!","0x203":"Summary handle is undefined","0x205":"attach() called more than once","0x207":"Channel should be defined","0x208":"Factory should be undefined before loading","0x209":"Factory Type should be defined","0x20a":"register for event on disposed object","0x20b":"mismatch","0x20c":"connection disposed","0x20d":"double connection listener","0x20e":"double tracked listener","0x20f":"Driver min read version should >= to server minReadVersion","0x210":"Snapshot should be created with minReadVersion or above","0x219":"1 root should be there","0x21b":"Snapshot id should be provided","0x21c":"Seq number should be provided","0x21d":"body is not string","0x21e":"improper boundary format","0x220":"socket key collision","0x221":"Root tree should contain the id","0x222":"Root tree should contain the id!!","0x223":"unexpected end of buffer","0x224":"Skip length should be positive","0x225":"Data should be there","0x226":"Should write complete data","0x227":"Data should be there","0x22b":"Should be a pair","0x22c":"reading pairs","0x231":"Number should be an integer","0x232":"Payload should not be negative","0x233":"Unexpected data at the end of buffer","0x234":"has joinOpTimer","0x235":"no joinOpTimer","0x236":"In all cases it should be already installed","0x237":"Snapshot should exist","0x238":"called only in connected state","0x239":"called only in disconnected state","0x23a":"seq#'s","0x23b":"we are not packing at the right level","0x23c":"we are not packing at the right level","0x23d":"pending is undefined","0x23e":"pending is undefined","0x23f":"pending undefined","0x240":"Binary format snapshot only for odsp driver!!","0x241":"disconnect should result in stopSequenceNumberUpdate() call","0x242":"has timer","0x243":"stopSequenceNumberUpdate should be called as result of sending any op!","0x244":"Socket is closed, but connection is not!","0x245":"tracked listener","0x246":"checking consistency of socket & _disposed flags","0x247":"Use addTrackedListener instead","0x248":"should not subscribe to forwarded events","0x24c":"Cannot call `flush()` from `orderSequentially`'s callback","0x24e":"assertion for type narrowing","0x250":"serialized container with attachment blobs must be rehydrated with detached blob storage","0x251":"creation summary has to have seq=0 && handle === undefined","0x252":"redirect table can only be set in detached container","0x253":"redirect table already exists","0x254":"unrecognized id in redirect table","0x255":"detached blob id absent in redirect table","0x256":"storage undefined in attached container","0x257":"This is not summarizing container","0x258":"connected","0x259":"Container disconnected when trying to submit system message","0x25b":"Caller is responsible for checking lock","0x25d":"We should never connect as 'read'","0x25e":"no reason to call fail if all promises have been completed","0x25f":"retryAfterSeconds","0x260":"Disposed should mean disconnected!","0x261":"Expected: off","0x262":"Old summarizer is still working!","0x263":"Expected: starting","0x264":"Expected: Not Off","0x266":"lastKnownSeqNumber should never be below last processed sequence number","0x267":"lastObservedSeqNumber should be updated first","0x268":"There can't be pending fetch that early in boot sequence!","0x269":"pending ops are not dropped","0x26a":"not closed","0x26b":"initial state","0x26c":"handler should be installed","0x26d":"wrong start","0x26e":"wrong start","0x26f":"continuous and no duplicates","0x270":"All requested ops fetched","0x272":"empty request","0x273":"Invalid document id from parsed URL","0x274":"type check","0x275":"Root tree should contain the id","0x278":"API is not supported for non-connecting or closed container","0x27b":"reentrancy may result in incorrect behavior","0x280":"Validate first op seq number","0x281":"Unreferenced if present should be true","0x282":"Headers should be present now","0x283":"Length of data len should fit in the bytes from the map","0x284":"Length of id should fit in the bytes from the map","0x285":"Start code should not undefined","0x286":"End code should not undefined","0x287":"key must exist in the map","0x288":"All properties should exist","0x289":"logic error","0x28a":"can't be disposed - Callers need to ensure that!","0x292":"Unexpected undefined result from getFileLinkCore","0x293":"initial state","0x294":"can't have op processing paused if we are processing an op","0x295":"there should be no pending batch if we have no ops","0x296":"we should never start processing incomplete batch!","0x297":"always called from resumed state","0x298":"we have something in the queue that generates this event","0x299":"non-synchronized state","0x29a":"System message in the middle of batch!","0x29b":"system op in a batch?","0x29c":"we should be processing ops when there is no active batch","0x29d":"we should be processing ops when there is no active batch","0x29e":"there can't be active batch","0x29f":"we should be processing ops when there is no active batch","0x2a0":"batch presence was validated above","0x2a1":"logic error","0x2a2":"Batch is interrupted by other client op. Should be caught by trackPending()","0x2a3":"container should be closed on any error","0x2a5":"join timer","0x2a6":"waitingForLeaveOp should imply writeConnection (we need to be ready to flush pending ops)","0x2a7":"Container is not attached","0x2a8":"Expected data store snapshot tree in base snapshot","0x2a9":"GC nodes for data store not in GC blob","0x2ac":"Connected when timeout waiting for leave from previous session fired!","0x2ad":"GC blob missing from snapshot","0x2ae":"node id should always be an absolute route","0x2af":"Child GC data should have been initialized","0x2b0":"Used route should always be an absolute route","0x2b1":"This should have be initiallized when generate GC nodes above","0x2b2":"Two entries for the same GC node with different unreferenced timestamp","0x2b3":"logic error","0x2b4":"not connected on sending ops!","0x2b5":"logic error","0x2b6":"Missing data store context","0x2b8":"Chunk should be set in map","0x2ba":"batchBegin must fire before batchEnd","0x2bb":"Instrumented token fetcher with throwOnNullToken = true should never return null","0x2bc":"Instrumented token fetcher with throwOnNullToken =true should never return null","0x2bd":"We should not see a pending FlushMode until we see a flush when processing a batch","0x2be":"LocalReferences array contains a gap","0x2bf":"both removedClientIds and removedSeq should be set or not set","0x2c0":"ID must be created before adding interval to collection","0x2c1":"Creating an interval collection that already exists?","0x2c2":"Create Version should be equal to currentReadVersion","0x2c4":"client should not be summarizer before container is created","0x2c5":"Attempting to connect() a closed Container","0x2c6":"Attempting to connect() a container that is not attached","0x2c7":"Attempting to disconnect() a closed Container","0x2c8":"outboundPushEventTime should be undefined","0x2c9":"durationNetwork should be undefined","0x2ca":"durationOutboundBatching should be undefined","0x2cb":"submitOpEventTime should be undefined","0x2cc":"OpTimeSittingInboundQueue should be undefined","0x2cd":"durationNetwork should be undefined","0x2ce":"msnTrackingTimestamp should not be undefined","0x2cf":"undefined channel on datastore context","0x2d0":"Data store should be globally visible to attach channels.","0x2d1":"Data store should be locally visible before it can become globally visible.","0x2d2":"Data store should be globally visible when its attached.","0x2d3":"Local channel must be globally visible when processing op","0x2d4":"Local channel must be globally visible when resubmitting op","0x2d5":"Invalid blob node id in unused routes.","0x2d7":"No data store with specified id","0x2d8":"Empty change event should not be emitted.","0x2da":"Unknown SharedMatrix 'op' type.","0x2db":"Applying op must generate a pending segment","0x2dc":"Cannot find code proposal","0x2dd":"Cannot find blob for a given id","0x2de":"Package path requested for unsupported node type.","0x2df":"transient references cannot be bound to segments","0x2e0":"lref not a Local Reference","0x2e1":"Support for plain value types removed.","0x2e2":"Must only wait for leave message when clientId in quorum","0x2e3":"Must have a valid protocol handler instance","0x2e4":"there should be service config for active connection","0x2e5":"Must have a base snapshot","0x2e6":"Must have a base snapshot","0x2e7":"Must serialize base snapshot blobs before getting runtime state","0x2e8":"There should be a store context for the op","0x2e9":"Must call getLocalState() after applying initial states","0x2ea":"Configuration state should be enabled","0x2eb":"Summary not supported with configuration disabled","0x2ec":"Blob must be present in blobsContents","0x2ed":"There should be a channel context for the op","0x2ee":"Channel should be loaded to rollback ops","0x2ef":"Local channel must be globally visible when rolling back op","0x2f0":"Remote channel must be loaded when rolling back op","0x2f1":"slideReferences from a segment which has not been removed and acked","0x2f2":"Ref not in the segment localRefs","0x2f3":"Ref not in the segment localRefs","0x2f4":"localRefs must be allocated","0x2f5":"op create references must be SlideOnRemove","0x2f6":"SlideOnRemove references must be op created","0x2f8":"Unexpected accept op, nothing pending","0x2f9":"Unexpected accept op, client not in expectedSignoffs","0x2fa":"Unexpected pending message received","0x2fb":"pendingMessageId does not match","0x2fc":"Invalid localOpMetadata for clear","0x2fd":"pendingMessageId does not match","0x2fe":"Invalid localOpMetadata in submit","0x2ff":"Unexpected pending message received","0x300":"localSeq greater than collab window","0x301":"Either seq or localSeq should be defined","0x302":"No segment found","0x303":"Invalid offset","0x304":"Id cannot contain slashes","0x305":"registerDependent on disposed Dependee","0x306":"invalidateDependents on disposed Dependee","0x307":"endInitialization should be called exactly once","0x308":"onDispose should be set when disposing","0x309":"Cannot unregister dependees on a disposed SimpleObservingDependent.","0x30a":"shouldClientJoinWrite should imply this is a writeConnection","0x30b":"Must have a valid protocol handler instance","0x30c":"Id cannot contain slashes","0x30d":"Id cannot contain slashes","0x30e":"Id cannot contain slashes. DataStoreContext should have validated this.","0x30f":"Channel context ID cannot contain slashes","0x310":"Channel context ID cannot contain slashes","0x311":"expected id to exist on interval","0x312":"snapshot should be parsed","0x313":'Specified user was not of type "TinyliciousUser".',"0x314":"Container properly closed","0x315":"re-entrancy","0x316":"There should be a cached promise of in-progress aliasing","0x317":"dataStoreFactory is undefined","0x318":"resolvedUrl is undefined","0x319":"No delta connection server associated with specified document ID","0x31a":"resolvedUrl is undefined","0x31b":"container1.resolvedUrl is undefined","0x31c":"rightDiv is undefined","0x31d":'options are not of type "IRouterliciousRouteOptions" as expected',"0x31e":"options.tenantId is undefined","0x320":"options.tenantId is undefined","0x322":"options.fluidHost is undefined","0x324":"options.server is undefined","0x325":"options.odspAccessToken is undefined","0x326":"lockResolver is undefined","0x327":"options.server is undefined","0x328":"options.server is undefined","0x329":"browser.umd property is undefined","0x32a":"pendingMessageId does not match","0x32b":"Invalid localOpMetadata for clear","0x32c":"pendingMessageId does not match","0x32d":"Invalid localOpMetadata in submit","0x32e":"Unexpected pending message received","0x32f":"Invalid localOpMetadata for sub directory op","0x330":"Unexpected pending message received","0x331":"Unexpected pending message received","0x332":"Unexpected pending message received","0x333":"PathShared.splice can only insert detached ranges","0x334":"Anchor must not be double freed","0x335":"ObjectForest.getRoot only valid for existing roots","0x336":"ObjectForest must only be given its own Anchors","0x337":"ObjectForest must only be given its own Cursor type","0x338":"ObjectForest must only be given its own Cursor","0x339":"Anchor must not be double freed","0x33a":"Anchor must not be double freed","0x33b":"Cursor must not be freed","0x33c":"Cursor must not be freed","0x33d":"Cursor must be current to be used","0x33e":"Cursor must be current to be used","0x33f":"Cursor must not be double freed","0x340":"Cursor must be current to be used","0x341":"Cursor must be current to be used","0x342":'Invalid usage. "blobid" should always be null',"0x343":'Invalid usage. "count" should always be 1',"0x344":"this.pendingConnection should be undefined","0x345":"this.pendingConnection is undefined when trying to cancel","0x346":"inboundQueuePausedFromInit should be true"}});var x5=z(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.validateAssertionError=void 0;var DK=b5();function FK(n,e){var t;let r=(t=DK.shortCodeMap[n.message])!==null&&t!==void 0?t:n.message;if(r!==e)throw new Error(`Unexpected assertion thrown: ${n.message} ('${r}')`);return!0}uf.validateAssertionError=FK});var _5=z(Rn=>{"use strict";var zK=Rn&&Rn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ji=Rn&&Rn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&zK(e,n,t)};Object.defineProperty(Rn,"__esModule",{value:!0});Ji(s5(),Rn);Ji(c5(),Rn);Ji(Mb(),Rn);Ji(d5(),Rn);Ji(zb(),Rn);Ji(g5(),Rn);Ji(v5(),Rn);Ji(x5(),Rn)});var Mx=20;var M5=new it("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let n=hn(sr);return()=>n.scrollStrategies.reposition({scrollThrottle:Mx})}});function S5(n){return()=>n.scrollStrategies.reposition({scrollThrottle:Mx})}var E5={provide:M5,deps:[sr],useFactory:S5};var Sx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({providers:[E5],imports:[Ul,Wn,Ho,$n,$n,yx]});let n=e;return n})();function Ex(n,e,t,r=i=>i){return n*r(.5-e*(.5-t))}function A5(n){return[-n[0],-n[1]]}function cr(n,e){return[n[0]+e[0],n[1]+e[1]]}function Xn(n,e){return[n[0]-e[0],n[1]-e[1]]}function ar(n,e){return[n[0]*e,n[1]*e]}function k5(n,e){return[n[0]/e,n[1]/e]}function Ea(n){return[n[1],-n[0]]}function Ax(n,e){return n[0]*e[0]+n[1]*e[1]}function T5(n,e){return n[0]===e[0]&&n[1]===e[1]}function D5(n){return Math.hypot(n[0],n[1])}function F5(n){return n[0]*n[0]+n[1]*n[1]}function kx(n,e){return F5(Xn(n,e))}function Fx(n){return k5(n,D5(n))}function z5(n,e){return Math.hypot(n[1]-e[1],n[0]-e[0])}function Aa(n,e,t){let r=Math.sin(t),i=Math.cos(t),o=n[0]-e[0],s=n[1]-e[1],a=o*i-s*r,c=o*r+s*i;return[a+e[0],c+e[1]]}function Cf(n,e,t){return cr(n,ar(Xn(e,n),t))}function Tx(n,e,t){return cr(n,ar(e,t))}var{min:Uo,PI:I5}=Math,Dx=.275,ka=I5+1e-4;function R5(n,e={}){let{size:t=16,smoothing:r=.5,thinning:i=.5,simulatePressure:o=!0,easing:s=N=>N,start:a={},end:c={},last:l=!1}=e,{cap:h=!0,easing:u=N=>N*(2-N)}=a,{cap:d=!0,easing:p=N=>--N*N*N+1}=c;if(n.length===0||t<=0)return[];let m=n[n.length-1].runningLength,g=a.taper===!1?0:a.taper===!0?Math.max(t,m):a.taper,x=c.taper===!1?0:c.taper===!0?Math.max(t,m):c.taper,b=Math.pow(t*r,2),_=[],O=[],S=n.slice(0,10).reduce((N,q)=>{let V=q.pressure;if(o){let G=Uo(1,q.distance/t),re=Uo(1,1-G);V=Uo(1,N+(re-N)*(G*Dx))}return(N+V)/2},n[0].pressure),E=Ex(t,i,n[n.length-1].pressure,s),D,I=n[0].vector,y=n[0].point,P=y,C=y,M=P,A=!1;for(let N=0;N<n.length;N++){let{pressure:q}=n[N],{point:V,vector:G,distance:re,runningLength:te}=n[N];if(N<n.length-1&&m-te<3)continue;if(i){if(o){let pe=Uo(1,re/t),Ee=Uo(1,1-pe);q=Uo(1,S+(Ee-S)*(pe*Dx))}E=Ex(t,i,q,s)}else E=t/2;D===void 0&&(D=E);let be=te<g?u(te/g):1,ge=m-te<x?p((m-te)/x):1;E=Math.max(.01,E*Math.min(be,ge));let rt=(N<n.length-1?n[N+1]:n[N]).vector,He=N<n.length-1?Ax(G,rt):1,Ue=Ax(G,I)<0&&!A,Je=He!==null&&He<0;if(Ue||Je){let pe=ar(Ea(I),E);for(let Ee=1/13,Oe=0;Oe<=1;Oe+=Ee)C=Aa(Xn(V,pe),V,ka*Oe),_.push(C),M=Aa(cr(V,pe),V,ka*-Oe),O.push(M);y=C,P=M,Je&&(A=!0);continue}if(A=!1,N===n.length-1){let pe=ar(Ea(G),E);_.push(Xn(V,pe)),O.push(cr(V,pe));continue}let ze=ar(Ea(Cf(rt,G,He)),E);C=Xn(V,ze),(N<=1||kx(y,C)>b)&&(_.push(C),y=C),M=cr(V,ze),(N<=1||kx(P,M)>b)&&(O.push(M),P=M),S=q,I=G}let F=n[0].point.slice(0,2),k=n.length>1?n[n.length-1].point.slice(0,2):cr(n[0].point,[1,1]),T=[],R=[];if(n.length===1){if(!(g||x)||l){let N=Tx(F,Fx(Ea(Xn(F,k))),-(D||E)),q=[];for(let V=1/13,G=V;G<=1;G+=V)q.push(Aa(N,F,ka*2*G));return q}}else{if(!(g||x&&n.length===1))if(h)for(let q=1/13,V=q;V<=1;V+=q){let G=Aa(O[0],F,ka*V);T.push(G)}else{let q=Xn(_[0],O[0]),V=ar(q,.5),G=ar(q,.51);T.push(Xn(F,V),Xn(F,G),cr(F,G),cr(F,V))}let N=Ea(A5(n[n.length-1].vector));if(x||g&&n.length===1)R.push(k);else if(d){let q=Tx(k,N,E);for(let V=1/29,G=V;G<1;G+=V)R.push(Aa(q,k,ka*3*G))}else R.push(cr(k,ar(N,E)),cr(k,ar(N,E*.99)),Xn(k,ar(N,E*.99)),Xn(k,ar(N,E)))}return _.concat(R,O.reverse(),T)}function N5(n,e={}){var t;let{streamline:r=.5,size:i=16,last:o=!1}=e;if(n.length===0)return[];let s=.15+(1-r)*.85,a=Array.isArray(n[0])?n:n.map(({x:p,y:m,pressure:g=.5})=>[p,m,g]);if(a.length===2){let p=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(Cf(a[0],p,m/4))}a.length===1&&(a=[...a,[...cr(a[0],[1,1]),...a[0].slice(2)]]);let c=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],l=!1,h=0,u=c[0],d=a.length-1;for(let p=1;p<a.length;p++){let m=o&&p===d?a[p].slice(0,2):Cf(u.point,a[p],s);if(T5(u.point,m))continue;let g=z5(m,u.point);if(h+=g,p<d&&!l){if(h<i)continue;l=!0}u={point:m,pressure:a[p][2]>=0?a[p][2]:.5,vector:Fx(Xn(u.point,m)),distance:g,runningLength:h},c.push(u)}return c[0].vector=((t=c[1])==null?void 0:t.vector)||[0,0],c}function Wl(n,e={}){return R5(N5(n,e),e)}var B5=["svgContainer"],L5=["textInput"],q5=(n,e)=>[0,0,n,e];function j5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"rect",20),j()),n&2){let t=ne();U(),me("width",t.canvasWidth*t.zoom+100*2)("height",t.canvasHeight*t.zoom+100*2)}}function V5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"path",24),j()),n&2){let t=ne().$implicit;U(),me("d",t.value)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)}}function H5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"image",25),j()),n&2){let t=ne().$implicit;U(),me("height",t.options.height)("width",t.options.width)("href",t.value,null,"xlink")("href",t.value)("stroke-width",t.options.strokeWidth)("stroke-dasharray",t.options.dasharray)("fill",t.options.fill)("stroke",t.options.strokeColor)}}function U5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"line",26),j()),n&2){let t=ne().$implicit;U(),me("x1",t.options.x1)("y1",t.options.y1)("x2",t.options.x2)("y2",t.options.y2)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)}}function G5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"rect",27),j()),n&2){let t=ne().$implicit;U(),me("x",t.options.x2)("y",t.options.y2)("rx",t.options.rx)("width",t.options.width)("height",t.options.height)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",t.options.dashoffset)("stroke-width",t.options.strokeWidth)("fill",t.options.fill)("stroke",t.options.strokeColor)}}function W5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"ellipse",28),j()),n&2){let t=ne().$implicit;U(),me("cx",t.options.cx)("cy",t.options.cy)("rx",t.options.rx)("ry",t.options.ry)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)("fill",t.options.fill)}}function K5(n,e){if(n&1&&(ce(),L(0,"g")(1,"text",29),ot(2),j()()),n&2){let t=ne().$implicit;U(),me("x",t.options.left)("y",t.options.top)("width",t.options.width)("height",t.options.height)("font-size",t.options.fontSize)("font-family",t.options.fontFamily)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)("fill",t.options.fill)("font-style",t.options.fontStyle)("font-weight",t.options.fontWeight),U(),to(" ",t.value," ")}}function $5(n,e){n&1&&(ce(),L(0,"g")(1,"text"),ot(2,"Not defined type"),j()())}function X5(n,e){if(n&1&&(ce(),ci(0),L(1,"g",21),Ae(2,V5,2,7,"g",22)(3,H5,2,8,"g",22)(4,U5,2,10,"g",22)(5,G5,2,10,"g",22)(6,W5,2,11,"g",22)(7,K5,3,16,"g",22)(8,$5,3,0,"g",23),j(),li()),n&2){let t=e.$implicit,r=ne();U(),ee("id","item_"+t.id)("ngSwitch",t.type),me("data-wb-id",t.id)("transform","translate("+t.x+","+t.y+")rotate("+t.rotation+")")("opacity",t.opacity/100),U(),ee("ngSwitchCase",r.types.BRUSH),U(),ee("ngSwitchCase",r.types.IMAGE),U(),ee("ngSwitchCase",r.types.LINE),U(),ee("ngSwitchCase",r.types.RECT),U(),ee("ngSwitchCase",r.types.ELLIPSE),U(),ee("ngSwitchCase",r.types.TEXT)}}function J5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"path",24),j()),n&2){let t=ne(2);U(),me("d",t.tempElement.value)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)}}function Q5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"image",25),j()),n&2){let t=ne(2);U(),me("height",t.tempElement.options.height)("width",t.tempElement.options.width)("href",t.tempElement.value,null,"xlink")("href",t.tempElement.value)("stroke-width",t.tempElement.options.strokeWidth)("stroke-dasharray",t.tempElement.options.dasharray)("fill",t.tempElement.options.fill)("stroke",t.tempElement.options.strokeColor)}}function Y5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"line",26),j()),n&2){let t=ne(2);U(),me("x1",t.tempElement.options.x1)("y1",t.tempElement.options.y1)("x2",t.tempElement.options.x2)("y2",t.tempElement.options.y2)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)}}function Z5(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"rect",27),j()),n&2){let t=ne(2);U(),me("x",t.tempElement.options.x2)("y",t.tempElement.options.y2)("rx",t.tempElement.options.rx)("width",t.tempElement.options.width)("height",t.tempElement.options.height)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",t.tempElement.options.dashoffset)("stroke-width",t.tempElement.options.strokeWidth)("fill",t.tempElement.options.fill)("stroke",t.tempElement.options.strokeColor)}}function eT(n,e){if(n&1&&(ce(),L(0,"g"),Z(1,"ellipse",28),j()),n&2){let t=ne(2);U(),me("cx",t.tempElement.options.cx)("cy",t.tempElement.options.cy)("rx",t.tempElement.options.rx)("ry",t.tempElement.options.ry)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)("fill",t.tempElement.options.fill)}}function tT(n,e){n&1&&(ce(),Z(0,"g"))}function nT(n,e){n&1&&(ce(),L(0,"g")(1,"text"),ot(2,"Not defined type"),j()())}function rT(n,e){if(n&1&&(ce(),L(0,"g",30),Ae(1,J5,2,7,"g",22)(2,Q5,2,8,"g",22)(3,Y5,2,10,"g",22)(4,Z5,2,10,"g",22)(5,eT,2,11,"g",22)(6,tT,1,0,"g",22)(7,nT,3,0,"g",23),j()),n&2){let t=ne();ee("ngSwitch",t.selectedTool),U(),ee("ngSwitchCase",t.tools.BRUSH),U(),ee("ngSwitchCase",t.types.IMAGE),U(),ee("ngSwitchCase",t.types.LINE),U(),ee("ngSwitchCase",t.types.RECT),U(),ee("ngSwitchCase",t.types.ELLIPSE),U(),ee("ngSwitchCase",t.types.TEXT)}}function iT(n,e){if(n&1){let t=yt();ce(),L(0,"g",31)(1,"g",32)(2,"g",33)(3,"rect",34),K("pointerdown",function(i){se(t);let o=ne();return ae(o.moveSelect(i))}),j()(),L(4,"g",33),Z(5,"circle",35)(6,"circle",36)(7,"circle",37)(8,"circle",38),L(9,"rect",39),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(10,"rect",40),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(11,"rect",41),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(12,"rect",42),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(13,"rect",43),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(14,"rect",44),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(15,"rect",45),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j(),L(16,"rect",46),K("pointerdown",function(i){se(t);let o=ne();return ae(o.resizeSelect(i))}),j()()()()}if(n&2){let t=ne();U(),Nn("display",t.rubberBox.display),me("transform","translate("+t.selectedElement.x+","+t.selectedElement.y+")rotate("+t.selectedElement.rotation+")"),U(2),me("x",t.rubberBox.x)("y",t.rubberBox.y)("width",t.rubberBox.width)("height",t.rubberBox.height),U(2),me("cx",t.rubberBox.x-4)("cy",t.rubberBox.y-4),U(),me("cx",t.rubberBox.x+t.rubberBox.width+4)("cy",t.rubberBox.y-4),U(),me("cx",t.rubberBox.x+t.rubberBox.width+4)("cy",t.rubberBox.y+t.rubberBox.height+4),U(),me("cx",t.rubberBox.x-4)("cy",t.rubberBox.y+t.rubberBox.height+4),U(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y-4),U(),me("x",t.rubberBox.x+t.rubberBox.width/2-4)("y",t.rubberBox.y-4),U(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y-4),U(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y+t.rubberBox.height/2-4),U(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y+t.rubberBox.height-4),U(),me("x",t.rubberBox.x+t.rubberBox.width/2-4)("y",t.rubberBox.y+t.rubberBox.height-4),U(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y+t.rubberBox.height-4),U(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y+t.rubberBox.height/2-4)}}function oT(n,e){if(n&1){let t=yt();L(0,"div")(1,"input",47,1),K("input",function(){se(t);let i=wr(2),o=ne();return ae(o.updateTextItem(i.value))}),j()()}if(n&2){let t=wr(2),r=ne();Nn("font-family",r.fontFamily)("font-size",r.fontSize,"px")("pointer-events","none")("width",r.canvasWidth*r.zoom,"px")("height",r.canvasHeight*r.zoom,"px")("position","absolute")("top",r.y,"px")("left",r.x,"px"),U(),Nn("width",t.value.length+"ch")("height",2*r.zoom+"ch")("top",(r.tempElement.options.top||0)*r.zoom,"px")("left",(r.tempElement.options.left||0)*r.zoom,"px")("font-size",r.tempElement.options.fontSize,"px"),ee("value",r.tempElement.value)}}var Bt=function(n){return n.BRUSH="BRUSH",n.LINE="LINE",n.RECT="RECT",n.ELLIPSE="ELLIPSE",n.IMAGE="IMAGE",n.TEXT="TEXT",n.SHAPE="SHAPE",n}(Bt||{}),Go=function(n){return n.BUTT="butt",n.SQUARE="square",n.ROUND="round",n}(Go||{}),Wo=function(n){return n.MITER="miter",n.ROUND="round",n.BEVEL="bevel",n.MITER_CLIP="miter-clip",n}(Wo||{}),_e=function(n){return n.SELECT="SELECT",n.BRUSH="BRUSH",n.IMAGE="IMAGE",n.LINE="LINE",n.RECT="RECT",n.ELLIPSE="ELLIPSE",n.TEXT="TEXT",n.ERASER="ERASER",n}(_e||{}),Pf=class{constructor(e){this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.lineCap=e.lineCap||Go.ROUND,this.lineJoin=e.lineJoin||Wo.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Of=class{constructor(e){this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.dasharray=e.dasharray||"",this.fill=e.fill||"#000000"}},Mf=class{constructor(e){this.x1=e.x1||0,this.y1=e.y1||0,this.x2=e.x2||0,this.y2=e.y2||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.lineCap=e.lineCap||Go.ROUND,this.lineJoin=e.lineJoin||Wo.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Sf=class{constructor(e){this.left=e.left||0,this.top=e.top||0,this.width=e.width||0,this.height=e.height||0,this.fontFamily=e.fontFamily||"Arial",this.fontSize=e.fontSize||14,this.fontStyle=e.fontStyle||"normal",this.fontWeight=e.fontWeight||"normal",this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.lineJoin=e.lineJoin||Wo.ROUND,this.lineCap=e.lineCap||Go.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Ef=class{constructor(e){this.cx=e.cx||0,this.cy=e.cy||0,this.rx=e.rx||0,this.ry=e.ry||0,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.lineCap=e.lineCap||Go.ROUND,this.lineJoin=e.lineJoin||Wo.ROUND}},Af=class{constructor(e){this.width=e.width||0,this.height=e.height||0,this.x1=e.x1||0,this.y1=e.y1||0,this.rx=e.rx||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},kf=class{constructor(e,t,r){switch(this.x=0,this.y=0,this.rotation=0,this.opacity=100,this.options={},this.type=e,this.value=r||"",this.id=`element_${this.type}_${Math.floor(Math.random()*1e3)}`,e){case Bt.BRUSH:this.options=new Pf(t);break;case Bt.IMAGE:this.options=new Of(t);break;case Bt.RECT:this.options=new Af(t);break;case Bt.LINE:this.options=new Mf(t);break;case Bt.ELLIPSE:this.options=new Ef(t);break;case Bt.TEXT:this.options=new Sf(t);break;default:this.options={};break}}},ro=function(n){return n.Png="png",n.Jpeg="jpeg",n.Svg="svg",n.Base64="base64",n}(ro||{}),Ta=(()=>{let e=class e{constructor(){this.eraseMethodCallSource=new nt,this.saveMethodCallSource=new nt,this.undoMethodCallSource=new nt,this.redoMethodCallSource=new nt,this.addImageMethodCallSource=new nt,this.eraseMethodCalled$=this.eraseMethodCallSource.asObservable(),this.saveMethodCalled$=this.saveMethodCallSource.asObservable(),this.undoMethodCalled$=this.undoMethodCallSource.asObservable(),this.redoMethodCalled$=this.redoMethodCallSource.asObservable(),this.addImageMethodCalled$=this.addImageMethodCallSource.asObservable()}erase(){this.eraseMethodCallSource.next()}save(r=ro.Base64,i="New board"){this.saveMethodCallSource.next({name:i,format:r})}undo(){this.undoMethodCallSource.next()}redo(){this.redoMethodCallSource.next()}addImage(r,i,o){this.addImageMethodCallSource.next({image:r,x:i,y:o})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Tt=class{static toSvgString(e){let r=new XMLSerializer().serializeToString(e);return r=r.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),r=r.replace(/NS\d+:href/g,"xlink:href"),r}static snapToGrid(e,t){let r=t;return Math.round(e/r)*r}static snapToAngle(e,t,r,i){let o=Math.PI/4,s=r-e,a=i-t,c=Math.atan2(a,s),l=Math.sqrt(s*s+a*a),h=Math.round(c/o)*o,u=e+l*Math.cos(h),d=t+l*Math.sin(h);return{x:u,y:d,a:h}}static downloadFile(e,t){let r=document.createElement("a");r.href=e,r.setAttribute("visibility","hidden"),r.download=t||"new white-board",document.body.appendChild(r),r.click(),document.body.removeChild(r)}static svgToBase64(e,t,r,i=ro.Png){return new Promise((o,s)=>{let a=document.createElement("canvas");a.width=t,a.height=r;let c=a.getContext("2d"),l=new Image;l.src=`data:image/svg+xml;base64,${btoa(e)}`,l.onload=()=>{c.drawImage(l,0,0,t,r);let h=a.toDataURL(`image/${i}`);o(h)},l.onerror=h=>{s(h)}})}static getSvgPathFromStroke(e,t=!0){let r=e.length;if(r<4)return"";let i=e[0],o=e[1],s=e[2],a=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${o[0].toFixed(2)},${o[1].toFixed(2)} ${((o[0]+s[0])/2).toFixed(2)},${((o[1]+s[1])/2).toFixed(2)} T`;for(let c=2,l=r-1;c<l;c++)i=e[c],o=e[c+1],a+=`${((i[0]+o[0])/2).toFixed(2)},${((i[1]+o[1])/2).toFixed(2)} `;return t&&(a+="Z"),a}},Tf=(()=>{let e=class e{constructor(){this.isPointing=!1,this.pointerDownSubject=new nt,this.pointerMoveSubject=new nt,this.pointerUpSubject=new nt}onPointerDown(r){this.isPointing=!0,this.pointerDownSubject.next(r)}onPointerMove(r){this.isPointing&&this.pointerMoveSubject.next(r)}onPointerUp(r){this.isPointing=!1,this.pointerUpSubject.next(r)}getPointerDown$(){return this.pointerDownSubject.asObservable()}getPointerMove$(){return this.pointerMoveSubject.asObservable()}getPointerUp$(){return this.pointerUpSubject.asObservable()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac});let n=e;return n})(),sT=(()=>{let e=class e{constructor(r,i){this.elementRef=r,this.svgService=i}onPointerDown(r){if(r.button!==0&&r.button!==1&&r.button!==5)return;this.elementRef.nativeElement.setPointerCapture(r.pointerId);let i=r;this.svgService.onPointerDown(i)}onPointerMove(r){if(r.clientX===this.lastX&&r.clientY===this.lastY)return;this.lastX=r.clientX,this.lastY=r.clientY;let i=r;this.svgService.onPointerMove(i)}onPointerUp(r){if(r.button!==0&&r.button!==1&&r.button!==2&&r.button!==5)return;this.lastX=r.clientX,this.lastY=r.clientY,this.elementRef.nativeElement.hasPointerCapture(r.pointerId)&&this.elementRef.nativeElement?.releasePointerCapture(r.pointerId);let i=r;this.svgService.onPointerUp(i)}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(Tf))},e.\u0275dir=Ye({type:e,selectors:[["","svg",""]],hostBindings:function(i,o){i&1&&K("pointerdown",function(a){return o.onPointerDown(a)})("pointermove",function(a){return o.onPointerMove(a)})("pointerup",function(a){return o.onPointerUp(a)})}});let n=e;return n})(),wf={size:1,smoothing:1,thinning:0,streamline:.9},zx=(()=>{let e=class e{set data(r){r&&this._data.next(r)}get data(){return this._data.getValue()}set selectedTool(r){this._selectedTool!==r&&(this._selectedTool===_e.TEXT&&this.tempElement?.type===Bt.TEXT&&this.finishTextInput(),this._selectedTool=r,this.toolChanged.emit(r),this.clearSelectedElement(),this.tempElement=null)}get selectedTool(){return this._selectedTool}constructor(r,i,o){this.whiteboardService=r,this._cd=i,this._svgService=o,this._data=new kl([]),this.drawingEnabled=!0,this.canvasWidth=800,this.canvasHeight=600,this.fullScreen=!0,this.center=!0,this.strokeColor="#000",this.strokeWidth=2,this.backgroundColor="#fff",this.lineJoin=Wo.ROUND,this.lineCap=Go.ROUND,this.fill="#333",this.zoom=1,this.fontFamily="sans-serif",this.fontSize=24,this.dasharray="",this.dashoffset=0,this.x=0,this.y=0,this.enableGrid=!1,this.gridSize=10,this.snapToGrid=!1,this.ready=new ie,this.dataChange=new ie,this.clear=new ie,this.undo=new ie,this.redo=new ie,this.save=new ie,this.imageAdded=new ie,this.selectElement=new ie,this.deleteElement=new ie,this.toolChanged=new ie,this._subscriptionList=[],this._initialData=[],this.undoStack=[],this.redoStack=[],this._selectedTool=_e.BRUSH,this.types=Bt,this.tools=_e,this.rubberBox={x:0,y:0,width:0,height:0,display:"none"}}ngOnInit(){this._initInputsFromOptions(this.options),this._initObservables(),this._initialData=JSON.parse(JSON.stringify(this.data))}ngOnChanges(r){r.options&&this._initInputsFromOptions(r.options.currentValue)}ngAfterViewInit(){this._resizeScreen(),this._cd.detectChanges(),this.ready.emit()}ngOnDestroy(){this._subscriptionList.forEach(r=>this._unsubscribe(r))}_initInputsFromOptions(r){r&&(r.drawingEnabled!=null&&(this.drawingEnabled=r.drawingEnabled),r.selectedTool!=null&&(this.selectedTool=r.selectedTool),r.canvasWidth!=null&&(this.canvasWidth=r.canvasWidth),r.canvasHeight!=null&&(this.canvasHeight=r.canvasHeight),r.fullScreen!=null&&(this.fullScreen=r.fullScreen),r.center!=null&&(this.center=r.center),r.strokeColor!=null&&(this.strokeColor=r.strokeColor),r.strokeWidth!=null&&(this.strokeWidth=r.strokeWidth),r.backgroundColor!=null&&(this.backgroundColor=r.backgroundColor),r.lineJoin!=null&&(this.lineJoin=r.lineJoin),r.lineCap!=null&&(this.lineCap=r.lineCap),r.fill!=null&&(this.fill=r.fill),r.zoom!=null&&(this.zoom=r.zoom),r.fontFamily!=null&&(this.fontFamily=r.fontFamily),r.fontSize!=null&&(this.fontSize=r.fontSize),r.dasharray!=null&&(this.dasharray=r.dasharray),r.dashoffset!=null&&(this.dashoffset=r.dashoffset),r.x!=null&&(this.x=r.x),r.y!=null&&(this.y=r.y),r.enableGrid!=null&&(this.enableGrid=r.enableGrid),r.gridSize!=null&&(this.gridSize=r.gridSize),r.snapToGrid!=null&&(this.snapToGrid=r.snapToGrid))}_initObservables(){this._subscriptionList.push(this._svgService.getPointerDown$().subscribe(this.handleStartEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerMove$().subscribe(this.handleDragEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerUp$().subscribe(this.handleEndEvent.bind(this))),this._subscriptionList.push(this.whiteboardService.saveMethodCalled$.subscribe(({name:r,format:i})=>this.saveDraw(r,i))),this._subscriptionList.push(this.whiteboardService.addImageMethodCalled$.subscribe(r=>this.addImage(r))),this._subscriptionList.push(this.whiteboardService.eraseMethodCalled$.subscribe(()=>this.clearDraw())),this._subscriptionList.push(this.whiteboardService.undoMethodCalled$.subscribe(()=>this.undoDraw())),this._subscriptionList.push(this.whiteboardService.redoMethodCalled$.subscribe(()=>this.redoDraw())),this._subscriptionList.push(hf(window,"resize").subscribe(()=>this._resizeScreen())),this._subscriptionList.push(this._data.pipe(Xb(1)).subscribe(r=>{this.dataChange.emit(r)}))}handleStartEvent(r){this.redoStack=[];let o={[_e.BRUSH]:this.handleStartBrush,[_e.IMAGE]:this.handleImageTool,[_e.LINE]:this.handleStartLine,[_e.RECT]:this.handleStartRect,[_e.ELLIPSE]:this.handleStartEllipse,[_e.TEXT]:this.handleTextTool,[_e.SELECT]:this.handleSelectTool,[_e.ERASER]:this.handleEraserTool}[this.selectedTool];o&&o.apply(this,[r])}handleDragEvent(r){let o={[_e.BRUSH]:this.handleDragBrush,[_e.LINE]:this.handleDragLine,[_e.RECT]:this.handleDragRect,[_e.ELLIPSE]:this.handleDragEllipse,[_e.TEXT]:this.handleTextDrag}[this.selectedTool];o&&o.apply(this,[r])}handleEndEvent(r){let o={[_e.BRUSH]:this.handleEndBrush,[_e.LINE]:this.handleEndLine,[_e.RECT]:this.handleEndRect,[_e.ELLIPSE]:this.handleEndEllipse,[_e.TEXT]:this.handleTextEnd}[this.selectedTool];o&&o.apply(this,[r])}handleStartBrush(r){let i=this._generateNewElement(Bt.BRUSH);this.tempDraw=[this._calculateXAndY([r.offsetX,r.offsetY])];let o=Wl(this.tempDraw,wf),s=Tt.getSvgPathFromStroke(o);i.value=s,i.options.strokeWidth=this.strokeWidth,this.tempElement=i}handleDragBrush(r){this.tempDraw.push(this._calculateXAndY([r.offsetX,r.offsetY]));let i=Wl(this.tempDraw,wf),o=Tt.getSvgPathFromStroke(i);this.tempElement.value=o}handleEndBrush(r){this.tempDraw.push(this._calculateXAndY([r.offsetX,r.offsetY]));let i=Wl(this.tempDraw,wf),o=Tt.getSvgPathFromStroke(i);this.tempElement.value=o,this._pushToData(this.tempElement),this._pushToUndo(),this.tempDraw=null,this.tempElement=null}handleImageTool(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),s=document.createElement("input");s.type="file",s.accept="image/*",s.onchange=a=>{let c=a.target.files;if(c){let l=new FileReader;l.onload=h=>{let u=h.target.result;this.addImage({image:u,x:i,y:o})},l.readAsDataURL(c[0])}},s.click()}handleStartLine(r){let i=this._generateNewElement(Bt.LINE),[o,s]=this._calculateXAndY([r.offsetX,r.offsetY]);this.snapToGrid&&(o=Tt.snapToGrid(o,this.gridSize),s=Tt.snapToGrid(s,this.gridSize)),i.options.x1=o,i.options.y1=s,i.options.x2=o,i.options.y2=s,this.tempElement=i}handleDragLine(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]);if(this.snapToGrid&&(i=Tt.snapToGrid(i,this.gridSize),o=Tt.snapToGrid(o,this.gridSize)),r.shiftKey){let s=this.tempElement.options.x1,a=this.tempElement.options.y1,{x:c,y:l}=Tt.snapToAngle(s,a,i,o);[i,o]=[c,l]}this.tempElement.options.x2=i,this.tempElement.options.y2=o}handleEndLine(){(this.tempElement.options.x1!=this.tempElement.options.x2||this.tempElement.options.y1!=this.tempElement.options.y2)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartRect(r){let i=this._generateNewElement(Bt.RECT),[o,s]=this._calculateXAndY([r.offsetX,r.offsetY]);this.snapToGrid&&(o=Tt.snapToGrid(o,this.gridSize),s=Tt.snapToGrid(s,this.gridSize)),i.options.x1=o,i.options.y1=s,i.options.x2=o,i.options.y2=s,i.options.width=1,i.options.height=1,this.tempElement=i}handleDragRect(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),s=this.tempElement.options.x1||0,a=this.tempElement.options.y1||0,c=Math.abs(i-s),l=Math.abs(o-a),h=null,u=null;r.shiftKey?(c=l=Math.max(c,l),h=s<i?s:s-c,u=a<o?a:a-l):(h=Math.min(s,i),u=Math.min(a,o)),r.altKey&&(c*=2,l*=2,h=s-c/2,u=a-l/2),this.snapToGrid&&(c=Tt.snapToGrid(c,this.gridSize),l=Tt.snapToGrid(l,this.gridSize),h=Tt.snapToGrid(h,this.gridSize),u=Tt.snapToGrid(u,this.gridSize)),this.tempElement.options.width=c,this.tempElement.options.height=l,this.tempElement.options.x2=h,this.tempElement.options.y2=u}handleEndRect(){(this.tempElement.options.width!=0||this.tempElement.options.height!=0)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartEllipse(r){let i=this._generateNewElement(Bt.ELLIPSE),[o,s]=this._calculateXAndY([r.offsetX,r.offsetY]);i.options.x1=o,i.options.y1=s,i.options.cx=o,i.options.cy=s,this.tempElement=i}handleDragEllipse(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),s=this.tempElement.options.x1||0,a=this.tempElement.options.y1||0,c=Math.abs(s+(i-s)/2),l=Math.abs(a+(o-a)/2),h=Math.abs(s-c),u=Math.abs(a-l);r.shiftKey&&(u=h,l=o>a?a+h:a-h),r.altKey&&(c=s,l=a,h=Math.abs(i-c),u=r.shiftKey?h:Math.abs(o-l)),this.tempElement.options.rx=h,this.tempElement.options.ry=u,this.tempElement.options.cx=c,this.tempElement.options.cy=l}handleEndEllipse(){(this.tempElement.options.rx!=0||this.tempElement.options.ry!=0)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleTextTool(r){if(this.tempElement){this.finishTextInput();return}let i=this._getTargetElement(r);if(i&&i.type===Bt.TEXT)this._removeFromData(i);else{i=this._generateNewElement(Bt.TEXT);let[o,s]=this._calculateXAndY([r.offsetX,r.offsetY]);i.options.top=s,i.options.left=o,i.options.strokeWidth=0}this.tempElement=i,this._cd.detectChanges(),setTimeout(()=>{this.textInput.nativeElement.focus()},0)}handleTextDrag(r){if(!this.tempElement)return;let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]);this.tempElement.options.top=o,this.tempElement.options.left=i}handleTextEnd(){this.tempElement&&this._pushToUndo()}handleSelectTool(r){let i=this._getMouseTarget(r);if(i){if(i.id==="selectorGroup")return;let o=i.getAttribute("data-wb-id"),s=this.data.find(a=>a.id===o);this.setSelectedElement(s)}else this.clearSelectedElement()}handleEraserTool(r){let i=this._getTargetElement(r);i&&(this.data=this.data.filter(o=>o.id!==i.id),this._pushToUndo(),this.deleteElement.emit(i))}finishTextInput(){let r=this.textInput.nativeElement.value;this.tempElement.value=r,this.tempElement.value&&(this._pushToData(this.tempElement),this._pushToUndo()),this.tempElement=null}updateTextItem(r){this.tempElement&&this.selectedTool==_e.TEXT&&(this.tempElement.value=r)}setSelectedElement(r){this.selectedTool=_e.SELECT;let i=this._getElementBbox(r);this.selectedElement=r,this.selectElement.emit(r),this._showGrips(i)}clearSelectedElement(){this.selectedElement=null,this.rubberBox.display="none",this.selectElement.emit(null)}addImage(r){let i=new Image;i.onload=()=>{let o=this.canvasHeight,s=i.width,a=i.height,c=i.width/i.height,l=a>o?o-40:a,h=l===o-40?(o-40)*c:s,u=r.x||(s-h)*(r.x||0),d=r.y||(a-l)*(r.y||0);u<0&&(u=0),d<0&&(d=0);let p=this._generateNewElement(Bt.IMAGE);p.value=r.image,p.options.width=h,p.options.height=l,p.x=u,p.y=d,this._pushToData(p),this.imageAdded.emit(),this._pushToUndo()},i.src=r.image}saveDraw(r,i){return v(this,null,function*(){let s=this.svgContainer.nativeElement.getElementById("svgcontent").cloneNode(!0),a=s.getElementById("selectorParentGroup");a&&a.remove();let c=s.getElementById("contentBackground");c&&c.removeAttribute("opacity"),s.setAttribute("x","0"),s.setAttribute("y","0");let l=new XMLSerializer().serializeToString(s),h=yield Tt.svgToBase64(l,this.canvasWidth,this.canvasHeight,i);switch(i){case ro.Base64:this.save.emit(h);break;case ro.Svg:{let u="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l)));Tt.downloadFile(u,r),this.save.emit(u);break}default:Tt.downloadFile(h,r),this.save.emit(h);break}})}clearDraw(){this.data=[],this._data.next(this.data),this._pushToUndo(),this.clear.emit()}undoDraw(){if(!this.undoStack.length)return;let r=this.undoStack.pop();this.redoStack.push(r),this.undoStack.length?this.data=JSON.parse(JSON.stringify(this.undoStack[this.undoStack.length-1])):this.data=JSON.parse(JSON.stringify(this._initialData)),this.undo.emit()}redoDraw(){if(!this.redoStack.length)return;let r=this.redoStack.pop();this.undoStack.push(JSON.parse(JSON.stringify(r))),this.data=r,this.redo.emit()}_pushToUndo(){this.undoStack.push(JSON.parse(JSON.stringify(this.data)))}_pushToData(r){this.data.push(r),this._data.next(this.data)}_removeFromData(r){let i=this.data.indexOf(r);i>-1&&(this.data.splice(i,1),this._data.next(this.data))}_generateNewElement(r){return new kf(r,{strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fill:this.fill,lineJoin:this.lineJoin,lineCap:this.lineCap,fontSize:this.fontSize,fontFamily:this.fontFamily,dasharray:this.dasharray,dashoffset:this.dashoffset})}_calculateXAndY([r,i]){return[(r-this.x)/this.zoom,(i-this.y)/this.zoom]}_resizeScreen(){let r=this.svgContainer.nativeElement;this.fullScreen&&(this.canvasWidth=r.clientWidth,this.canvasHeight=r.clientHeight),this.center&&(this.x=r.clientWidth/2-this.canvasWidth/2,this.y=r.clientHeight/2-this.canvasHeight/2)}_getElementBbox(r){let i=`item_${r.id}`;return this.svgContainer.nativeElement.getElementById(i).getBBox()}_getMouseTarget(r){if(r==null||r.target==null)return null;let i=r.target;if(i.id==="svgroot")return null;if(i.parentNode){if(i=i.parentNode.parentNode,i.id==="selectorGroup")return i;for(;!i.id.includes("item_");){if(i.id==="svgroot")return null;i=i.parentNode}}return i}_getTargetElement(r){let i=this._getMouseTarget(r);if(i){if(i.id==="selectorGroup")return null;let o=i.getAttribute("data-wb-id");return this.data.find(s=>s.id===o)}return null}_showGrips(r){this.rubberBox={x:r.x-(this.selectedElement.options.strokeWidth||0)*.5,y:r.y-(this.selectedElement.options.strokeWidth||0)*.5,width:r.width+this.selectedElement.options.strokeWidth||0,height:r.height+this.selectedElement.options.strokeWidth||0,display:"block"}}moveSelect(r){let i=!0;r.stopPropagation();let o=r.target;o.addEventListener("pointermove",s=>{i&&this.selectedElement&&(this.selectedElement.x+=s.movementX,this.selectedElement.y+=s.movementY)}),o.addEventListener("pointerup",()=>{i=!1})}resizeSelect(r){let i=!0,o=r.target;document.addEventListener("pointermove",s=>{if(!i)return;let a=o.id.split("_")[2],c=s.movementX,l=s.movementY,h=this._getElementBbox(this.selectedElement),u=h.width,d=h.height;switch(this.selectedElement.type){case Bt.ELLIPSE:this._resizeElipse(a,{x:c,y:l,width:u,height:d});break;case Bt.LINE:this._resizeLine(a,{x:c,y:l,width:u,height:d});break;default:this._resizeDefault(a,{x:c,y:l,width:u,height:d});break}this._showGrips(this._getElementBbox(this.selectedElement))}),document.addEventListener("pointerup",()=>{i=!1})}_resizeLine(r,i){switch(r){case"nw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y1+=i.y;break;case"n":this.selectedElement.options.y1+=i.y;break;case"ne":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y1+=i.y;break;case"e":this.selectedElement.options.x2+=i.x;break;case"se":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y2+=i.y;break;case"s":this.selectedElement.options.y2+=i.y;break;case"sw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y2+=i.y;break;case"w":this.selectedElement.options.x1+=i.x;break}}_resizeElipse(r,i){switch(r){case"nw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"n":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry-=i.y/2;break;case"ne":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"e":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx+=i.x/2;break;case"se":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"s":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry+=i.y/2;break;case"sw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"w":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx-=i.x/2;break}}_resizeDefault(r,i){switch(r){case"nw":this.selectedElement.x+=i.x,this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height-i.y;break;case"n":this.selectedElement.y+=i.y,this.selectedElement.options.height=i.height-i.y;break;case"ne":this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height-i.y;break;case"e":this.selectedElement.options.width=i.width+i.x;break;case"se":this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height+i.y;break;case"s":this.selectedElement.options.height=i.height+i.y;break;case"sw":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height+i.y;break;case"w":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x;break}}_unsubscribe(r){r&&r.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)(X(Ta),X(or),X(Tf))},e.\u0275cmp=fe({type:e,selectors:[["ng-whiteboard"]],viewQuery:function(i,o){if(i&1&&(Ct(B5,5),Ct(L5,5)),i&2){let s;We(s=Ke())&&(o.svgContainer=s.first),We(s=Ke())&&(o.textInput=s.first)}},inputs:{data:"data",options:"options",selectedTool:"selectedTool",drawingEnabled:"drawingEnabled",canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",fullScreen:"fullScreen",center:"center",strokeColor:"strokeColor",strokeWidth:"strokeWidth",backgroundColor:"backgroundColor",lineJoin:"lineJoin",lineCap:"lineCap",fill:"fill",zoom:"zoom",fontFamily:"fontFamily",fontSize:"fontSize",dasharray:"dasharray",dashoffset:"dashoffset",x:"x",y:"y",enableGrid:"enableGrid",gridSize:"gridSize",snapToGrid:"snapToGrid"},outputs:{ready:"ready",dataChange:"dataChange",clear:"clear",undo:"undo",redo:"redo",save:"save",imageAdded:"imageAdded",selectElement:"selectElement",deleteElement:"deleteElement",toolChanged:"toolChanged"},features:[pn([Tf]),nr],decls:19,vars:24,consts:[["svgContainer",""],["textInput",""],["id","svgroot","xlinkns","http://www.w3.org/2000/svg","svg",""],["id","canvasBackground",2,"pointer-events","none"],["id","grid-pattern"],["id","smallGrid","patternUnits","userSpaceOnUse"],["fill","none","stroke","gray","stroke-width","0.5"],["id","grid","width","100","height","100","patternUnits","userSpaceOnUse"],["width","100","height","100","fill","url(#smallGrid)"],["d","M 100 0 H 0 V 100","fill","none","stroke","gray","stroke-width","2"],["id","placeholder_defs"],["width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent",2,"pointer-events","none"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","id","svgcontent"],["id","contentBackground","opacity","0","width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent"],[2,"pointer-events","all"],[4,"ngFor","ngForOf"],["class","temp-element",3,"ngSwitch",4,"ngIf"],["id","selectorParentGroup",4,"ngIf"],[3,"font-family","font-size","pointer-events","width","height","position","top","left",4,"ngIf"],["x","-100","y","-100","fill","url(#grid)"],[1,"wb_element",3,"id","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["fill","none",1,"brush"],["preserveAspectRatio","none",2,"pointer-events","inherit"],[1,"line",2,"pointer-events","inherit"],[1,"rect"],[2,"pointer-events","inherit"],["text-anchor","start",0,"xml","space","preserve","alignment-baseline","before-edge",1,"text_element",2,"pointer-events","inherit","white-space","normal"],[1,"temp-element",3,"ngSwitch"],["id","selectorParentGroup"],["id","selectorGroup","transform","",1,"selectorGroup"],["display","inline"],["id","selectedBox","fill","none","stroke","#4F80FF","shape-rendering","crispEdges",2,"cursor","move",3,"pointerdown"],["id","selectorGrip_rotate_nw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_ne","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_se","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_sw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_resize_nw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","nw-resize",3,"pointerdown"],["id","selectorGrip_resize_n","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","n-resize",3,"pointerdown"],["id","selectorGrip_resize_ne","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","ne-resize",3,"pointerdown"],["id","selectorGrip_resize_e","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","e-resize",3,"pointerdown"],["id","selectorGrip_resize_se","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","se-resize",3,"pointerdown"],["id","selectorGrip_resize_s","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","s-resize",3,"pointerdown"],["id","selectorGrip_resize_sw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","sw-resize",3,"pointerdown"],["id","selectorGrip_resize_w","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","w-resize",3,"pointerdown"],["type","text","autofocus","",1,"text-input",3,"input","value"]],template:function(i,o){i&1&&(ce(),L(0,"svg",2,0)(2,"svg",3)(3,"defs",4)(4,"pattern",5),Z(5,"path",6),j(),L(6,"pattern",7),Z(7,"rect",8)(8,"path",9),j()(),Z(9,"defs",10)(10,"rect",11),Ae(11,j5,2,2,"g",12),j(),L(12,"svg",13),Z(13,"rect",14),L(14,"g",15),Ae(15,X5,9,11,"ng-container",16)(16,rT,8,7,"g",17)(17,iT,17,31,"g",18),j()()(),Ae(18,oT,3,27,"div",19)),i&2&&(ex("svgroot "+o.selectedTool),U(2),me("width",o.canvasWidth*o.zoom)("height",o.canvasHeight*o.zoom)("x",o.x)("y",o.y),U(2),me("width",o.gridSize)("height",o.gridSize),U(),me("d","M "+o.gridSize+" 0 H 0 V "+o.gridSize),U(5),me("fill",o.backgroundColor),U(),ee("ngIf",o.enableGrid),U(),me("width",o.canvasWidth*o.zoom)("height",o.canvasHeight*o.zoom)("viewBox",nx(21,q5,o.canvasWidth,o.canvasHeight))("x",o.x)("y",o.y),U(),me("fill",o.backgroundColor),U(2),ee("ngForOf",o.data),U(),ee("ngIf",o.tempElement),U(),ee("ngIf",o.selectedElement),U(),ee("ngIf",o.tempElement&&o.selectedTool===o.tools.TEXT))},dependencies:[qo,ya,ax,cx,lx,sT],styles:['[_nghost-%COMP%]{width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit;background-size:cover;background-position:50%;background-repeat:no-repeat;touch-action:none}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .wb_element[_ngcontent-%COMP%], [_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .selectorGroup[_ngcontent-%COMP%]{transform-box:fill-box;transform-origin:center}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif}[_nghost-%COMP%]   .svgroot.drawing[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 height%3D%2220%22 width%3D%2220%22%3E  %3Ccircle cx%3D%225%22 cy%3D%225%22 r%3D%225%22 style%3D%22fill%3A none%3B stroke%3A %235a5a5a%3B stroke-width%3A .02em%3B%22 %2F%3E%3C%2Fsvg%3E") 5 5,crosshair}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]{cursor:move}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .HAND[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]   .SELECT[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .BRUSH[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 width%3D%2224%22 height%3D%2224%22%3E%3Cpath fill%3D%22%23333%22 stroke-width%3D%221%22 stroke%3D%22%23ccc%22 d%3D%22m16.318 6.11l-3.536-3.535l1.415-1.414c.63-.63 2.073-.755 2.828 0l.707.707c.755.755.631 2.198 0 2.829L16.318 6.11zm-1.414 1.415l-9.9 9.9l-4.596 1.06l1.06-4.596l9.9-9.9l3.536 3.536z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E") 1 18,crosshair}[_nghost-%COMP%]   .IMAGE[_ngcontent-%COMP%]{cursor:copy}[_nghost-%COMP%]   .LINE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .RECT[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .ELLIPSE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .TEXT[_ngcontent-%COMP%]{cursor:text}[_nghost-%COMP%]   .ERASER[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 width%3D%2224%22 height%3D%2224%22%3E    %3Cpath fill%3D%22%23333%22 stroke-width%3D%221%22 stroke%3D%22%23ccc%22 d%3D%22M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm2.121.707a1 1 0 0 0-1.414 0L4.16 7.547l5.293 5.293l4.633-4.633a1 1 0 0 0 0-1.414l-3.879-3.879zM8.746 13.547L3.453 8.254L1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E") 0 12,crosshair}.foreign[_ngcontent-%COMP%]{text-align:left}.insideforeign[_ngcontent-%COMP%]{display:inline-block}.text-input[_ngcontent-%COMP%]{position:absolute;background:transparent;border:1px dashed #0b89f0;outline:none;height:25px;font-size:inherit;font-family:inherit;min-width:5ch;height:2ch;padding:0;pointer-events:auto;z-index:5}']});let n=e;return n})(),Ix=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({imports:[Wn]});let n=e;return n})();var jx=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(X(pf),X(mt))},e.\u0275dir=Ye({type:e});let n=e;return n})(),cT=(()=>{let e=class e extends jx{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Rl(e)))(o||e)}})(),e.\u0275dir=Ye({type:e,features:[Gn]});let n=e;return n})(),nd=new it("");var lT={provide:nd,useExisting:eo(()=>rd),multi:!0};function dT(){let n=gf()?gf().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var uT=new it(""),rd=(()=>{let e=class e extends jx{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!dT())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(X(pf),X(mt),X(uT,8))},e.\u0275dir=Ye({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&K("input",function(a){return o._handleInput(a.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(a){return o._compositionEnd(a.target.value)})},features:[pn([lT]),Gn]});let n=e;return n})();function hi(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function Vx(n){return n!=null&&typeof n.length=="number"}var If=new it(""),Rf=new it(""),hT=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,$o=class{static min(e){return pT(e)}static max(e){return fT(e)}static required(e){return gT(e)}static requiredTrue(e){return mT(e)}static email(e){return vT(e)}static minLength(e){return bT(e)}static maxLength(e){return xT(e)}static pattern(e){return _T(e)}static nullValidator(e){return Hx(e)}static compose(e){return Xx(e)}static composeAsync(e){return Jx(e)}};function pT(n){return e=>{if(hi(e.value)||hi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function fT(n){return e=>{if(hi(e.value)||hi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function gT(n){return hi(n.value)?{required:!0}:null}function mT(n){return n.value===!0?null:{required:!0}}function vT(n){return hi(n.value)||hT.test(n.value)?null:{email:!0}}function bT(n){return e=>hi(e.value)||!Vx(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function xT(n){return e=>Vx(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function _T(n){if(!n)return Hx;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(hi(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function Hx(n){return null}function Ux(n){return n!=null}function Gx(n){return ix(n)?Ub(n):n}function Wx(n){let e={};return n.forEach(t=>{e=t!=null?Nt(Nt({},e),t):e}),Object.keys(e).length===0?null:e}function Kx(n,e){return e.map(t=>t(n))}function yT(n){return!n.validate}function $x(n){return n.map(e=>yT(e)?e:t=>e.validate(t))}function Xx(n){if(!n)return null;let e=n.filter(Ux);return e.length==0?null:function(t){return Wx(Kx(t,e))}}function Nf(n){return n!=null?Xx($x(n)):null}function Jx(n){if(!n)return null;let e=n.filter(Ux);return e.length==0?null:function(t){let r=Kx(t,e).map(Gx);return Kb(r).pipe(Wb(Wx))}}function Bf(n){return n!=null?Jx($x(n)):null}function Rx(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Qx(n){return n._rawValidators}function Yx(n){return n._rawAsyncValidators}function Ff(n){return n?Array.isArray(n)?n:[n]:[]}function $l(n,e){return Array.isArray(n)?n.includes(e):n===e}function Nx(n,e){let t=Ff(e);return Ff(n).forEach(i=>{$l(t,i)||t.push(i)}),t}function Bx(n,e){return Ff(e).filter(t=>!$l(n,t))}var Xl=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Nf(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Bf(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Xo=class extends Xl{get formDirective(){return null}get path(){return null}},io=class extends Xl{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},zf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},CT={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},R$=ai(Nt({},CT),{"[class.ng-submitted]":"isSubmitted"}),Zx=(()=>{let e=class e extends zf{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(X(io,2))},e.\u0275dir=Ye({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Ie("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Gn]});let n=e;return n})();var Da="VALID",Kl="INVALID",Ko="PENDING",Fa="DISABLED";function e_(n){return(id(n)?n.validators:n)||null}function wT(n){return Array.isArray(n)?Nf(n):n||null}function t_(n,e){return(id(e)?e.asyncValidators:n)||null}function PT(n){return Array.isArray(n)?Bf(n):n||null}function id(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function OT(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Il(1e3,"");if(!r[t])throw new Il(1001,"")}function MT(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Il(1002,"")})}var Jl=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Da}get invalid(){return this.status===Kl}get pending(){return this.status==Ko}get disabled(){return this.status===Fa}get enabled(){return this.status!==Fa}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Nx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Nx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Bx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Bx(e,this._rawAsyncValidators))}hasValidator(e){return $l(this._rawValidators,e)}hasAsyncValidator(e){return $l(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ko,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Fa,this.errors=null,this._forEachChild(r=>{r.disable(ai(Nt({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ai(Nt({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Da,this._forEachChild(r=>{r.enable(ai(Nt({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ai(Nt({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Da||this.status===Ko)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fa:Da}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ko,this._hasOwnPendingAsyncValidator=!0;let t=Gx(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ie,this.statusChanges=new ie}_calculateStatus(){return this._allControlsDisabled()?Fa:this.errors?Kl:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ko)?Ko:this._anyControlsHaveStatus(Kl)?Kl:Da}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){id(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=wT(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=PT(this._rawAsyncValidators)}},Ql=class extends Jl{constructor(e,t,r){super(e_(t),t_(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){MT(this,!0,e),Object.keys(e).forEach(r=>{OT(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var od=new it("CallSetDisabledState",{providedIn:"root",factory:()=>Lf}),Lf="always";function Yl(n,e,t=Lf){qf(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),ET(n,e),kT(n,e),AT(n,e),ST(n,e)}function Zl(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),td(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function ed(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function ST(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function qf(n,e){let t=Qx(n);e.validator!==null?n.setValidators(Rx(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Yx(n);e.asyncValidator!==null?n.setAsyncValidators(Rx(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();ed(e._rawValidators,i),ed(e._rawAsyncValidators,i)}function td(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=Qx(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=Yx(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return ed(e._rawValidators,r),ed(e._rawAsyncValidators,r),t}function ET(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&n_(n,e)})}function AT(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&n_(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function n_(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function kT(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function r_(n,e){n==null,qf(n,e)}function TT(n,e){return td(n,e)}function DT(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function FT(n){return Object.getPrototypeOf(n.constructor)===cT}function i_(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function zT(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===rd?t=o:FT(o)?r=o:i=o}),i||r||t||null}function IT(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var RT={provide:Xo,useExisting:eo(()=>jf)},za=Promise.resolve(),jf=(()=>{let e=class e extends Xo{constructor(r,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ie,this.form=new Ql({},Nf(r),Bf(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){za.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),Yl(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){za.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){za.then(()=>{let i=this._findContainer(r.path),o=new Ql({});r_(o,r),i.registerControl(r.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){za.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){za.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,i_(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(X(If,10),X(Rf,10),X(od,8))},e.\u0275dir=Ye({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,o){i&1&&K("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{options:[tn.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pn([RT]),Gn]});let n=e;return n})();function Lx(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function qx(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Vf=class extends Jl{constructor(e=null,t,r){super(e_(t),t_(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),id(t)&&(t.nonNullable||t.initialValueIsDefault)&&(qx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Lx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Lx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){qx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var NT=n=>n instanceof Vf;var o_=new it(""),BT={provide:io,useExisting:eo(()=>Hf)},Hf=(()=>{let e=class e extends io{set isDisabled(r){}constructor(r,i,o,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this.update=new ie,this._ngModelWarningSent=!1,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=zT(this,o)}ngOnChanges(r){if(this._isControlChanged(r)){let i=r.form.previousValue;i&&Zl(i,this,!1),Yl(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}DT(r,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Zl(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_isControlChanged(r){return r.hasOwnProperty("form")}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(X(If,10),X(Rf,10),X(nd,10),X(o_,8),X(od,8))},e.\u0275dir=Ye({type:e,selectors:[["","formControl",""]],inputs:{form:[tn.None,"formControl","form"],isDisabled:[tn.None,"disabled","isDisabled"],model:[tn.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[pn([BT]),Gn,nr]});let n=e;return n})(),LT={provide:Xo,useExisting:eo(()=>Uf)},Uf=(()=>{let e=class e extends Xo{constructor(r,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ie,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(td(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return Yl(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){Zl(r.control||null,r,!1),IT(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,i_(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,o=this.form.get(r.path);i!==o&&(Zl(i||null,r),NT(o)&&(Yl(o,r,this.callSetDisabledState),r.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);r_(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&TT(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){qf(this.form,this),this._oldForm&&td(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(X(If,10),X(Rf,10),X(od,8))},e.\u0275dir=Ye({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,o){i&1&&K("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{form:[tn.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pn([LT]),Gn,nr]});let n=e;return n})();var qT=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({});let n=e;return n})();var s_=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:o_,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:od,useValue:r.callSetDisabledState??Lf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({imports:[qT]});let n=e;return n})();var jT=["hueSlider"],VT=["alphaSlider"];function HT(n,e){if(n&1){let t=yt();L(0,"div",10),K("newValue",function(i){se(t);let o=ne();return ae(o.onSliderChange("saturation-lightness",i))}),L(1,"div",11),Z(2,"div"),j()()}if(n&2){let t=ne();Nn("background-color",t.hueSliderColor),ee("rgX",1)("rgY",1),U(),Nn("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function UT(n,e){if(n&1&&(L(0,"div",12),Z(1,"div",13)(2,"div",14),j()),n&2){let t=ne();U(2),Nn("background-color",t.selectedColor)}}function GT(n,e){if(n&1){let t=yt();L(0,"div",15,1),K("newValue",function(i){se(t);let o=ne();return ae(o.onSliderChange("hue",i))}),L(2,"div",16)(3,"div"),Z(4,"div"),j()()()}if(n&2){let t=ne();ee("rgX",1),U(2),Nn("left",t.slider==null?null:t.slider.h,"px")}}function WT(n,e){if(n&1){let t=yt();L(0,"div",17,2),K("newValue",function(i){se(t);let o=ne();return ae(o.onSliderChange("alpha",i))}),Z(2,"div",18),L(3,"div",16)(4,"div"),Z(5,"div"),j()()()}if(n&2){let t=ne();ee("rgX",1),U(2),ee("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),U(),Nn("left",t.slider==null?null:t.slider.a,"px")}}var KT=["dialog"],$T=n=>({background:n});function XT(n,e){n&1&&Z(0,"div",12)}function JT(n,e){if(n&1){let t=yt();ci(0),L(1,"div",9)(2,"div",10),K("click",function(){let i=se(t).$implicit,o=ne(2);return ae(o.onColorClick(i))}),Ae(3,XT,1,0,"div",11),j()(),li()}if(n&2){let t=e.$implicit,r=e.index,i=ne(2);U(2),Ie("colornull",!t),ee("ngStyle",i.getBackgroundColor(t)),U(),ee("ngIf",r==i.indexSeleccionado)}}function QT(n,e){if(n&1&&Z(0,"div",18),n&2){let t=ne(3);ee("ngStyle",t.getBackgroundColor(t.color))}}function YT(n,e){if(n&1){let t=yt();L(0,"div",13),K("click",function(){se(t);let i=ne(2);return ae(i.addColor())}),Ae(1,QT,1,1,"div",14),ce(),L(2,"svg",15),Z(3,"path",16)(4,"path",17),j()()}if(n&2){let t=ne(2);U(),ee("ngIf",t.indexSeleccionado===void 0)}}function ZT(n,e){if(n&1){let t=yt();L(0,"color-picker",19),K("colorChange",function(i){se(t);let o=ne(2);return ae(o.onChangeColorPicker(i))})("onAlphaChange",function(i){se(t);let o=ne(2);return ae(o.onAlphaChange(i))}),j()}if(n&2){let t=ne(2);ee("controls",t.colorPickerControls)("color",t.hsva)}}function eD(n,e){if(n&1&&(ci(0),L(1,"div",5),Ae(2,JT,4,4,"ng-container",6)(3,YT,5,1,"div",7)(4,ZT,1,2,"color-picker",8),j(),li()),n&2){let t=ne();U(),ee("@colorsAnimation",t.colorsAnimationEffect),U(),ee("ngForOf",t.palette),U(),ee("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),U(),ee("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function tD(n,e){n&1&&Z(0,"div",12)}function nD(n,e){if(n&1){let t=yt();ci(0),L(1,"div",9)(2,"div",25),K("click",function(){let i=se(t).$implicit,o=ne(2);return ae(o.changeColor(i))}),Ae(3,tD,1,0,"div",11),j()(),li()}if(n&2){let t=e.$implicit,r=ne(2);U(2),Ie("colornull",!t),ee("ngStyle",tx(4,$T,t)),U(),ee("ngIf",r.isSelected(t))}}function rD(n,e){if(n&1){let t=yt();ci(0),L(1,"div",5)(2,"div",20)(3,"div",21),K("click",function(){se(t);let i=ne();return ae(i.onClickBack())}),ce(),L(4,"svg",22),Z(5,"path",23)(6,"path",24),j()()(),Ae(7,nD,4,6,"ng-container",6),j(),li()}if(n&2){let t=ne();U(),ee("@colorsAnimation",t.colorsAnimationEffect),U(6),ee("ngForOf",t.variants)}}function iD(n,e){if(n&1){let t=yt();ci(0),L(1,"div",26)(2,"div",27),K("click",function(){se(t);let i=ne();return ae(i.onClickBack())}),ce(),L(3,"svg",22),Z(4,"path",23)(5,"path",24),j()(),rr(),L(6,"button",28),K("click",function(){se(t);let i=ne();return ae(i.emitClose("cancel"))}),ot(7),j(),L(8,"button",28),K("click",function(){se(t);let i=ne();return ae(i.emitClose("accept"))}),ot(9),j()(),L(10,"div",29)(11,"color-picker",30),K("sliderChange",function(i){se(t);let o=ne();return ae(o.onChangeColorPicker(i))}),j()(),li()}if(n&2){let t=ne();U(7),to(" ",t.cancelLabel," "),U(2),to(" ",t.acceptLabel," "),U(2),ee("controls",t.colorPickerControls)("color",t.hsva)}}function oD(n,e){if(n&1){let t=yt();L(0,"div",31)(1,"p",32),K("click",function(){se(t);let i=ne();return ae(i.nextFormat())}),ot(2),j(),L(3,"div",33)(4,"input",34,1),K("keyup",function(){se(t);let i=wr(5),o=ne();return ae(o.changeColorManual(i.value))})("keydown.enter",function(){se(t);let i=ne();return ae(i.emitClose("accept"))}),j()()()}if(n&2){let t=ne();U(2),_a(t.colorFormats[t.format]),U(2),Nn("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),ee("placeholder",t.placeholder)("value",t.color)}}var Ia=["hex","rgba","hsla"],qr=function(n){return n[n.HEX=0]="HEX",n[n.RGBA=1]="RGBA",n[n.HSLA=2]="HSLA",n[n.CMYK=3]="CMYK",n}(qr||{}),c_=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],Pr=class{constructor(e,t,r,i){this.r=e,this.g=t,this.b=r,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},lr=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i,this.onChange=new ie(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},oo=class{constructor(e,t,r,i){this.h=e,this.s=t,this.l=r,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Jo=class{constructor(e,t,r,i,o=1){this.c=e,this.m=t,this.y=r,this.k=i,this.a=o}},Gf=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},ad=(()=>{class n{constructor(){}toFormat(t,r){var i="";if(t)switch(r){case qr.HEX:var s=this.hsvaToRgba(t);s.denormalize();var i=this.rgbaToHex(s,!0);break;case qr.HSLA:var o=this.hsva2hsla(t);o.denormalize();var i=o.toString();break;case qr.RGBA:var s=this.hsvaToRgba(t),i=s.toString();break;case qr.CMYK:var s=this.hsvaToRgba(t),a=this.rgbaToCmyk(s);break}return i}stringToFormat(t,r){var i=this.stringToHsva(t,!0);return this.toFormat(i,r)}hsva2hsla(t){let r=t.h,i=t.s,o=t.v,s=t.a;if(o===0)return new oo(r,0,0,s);if(i===0&&o===1)return new oo(r,1,1,s);{let a=o*(2-i)/2;return new oo(r,o*i/(1-Math.abs(2*a-1)),a,s)}}hsla2hsva(t){let r=Math.min(t.h,1),i=Math.min(t.s,1),o=Math.min(t.l,1),s=Math.min(t.a,1);if(o===0)return new lr(r,0,0,s);{let a=o+i*(1-Math.abs(2*o-1))/2;return new lr(r,2*(a-o)/a,a,s)}}hsvaToRgba(t){let r,i,o,s=t.h,a=t.s,c=t.v,l=t.a,h=Math.floor(s*6),u=s*6-h,d=c*(1-a),p=c*(1-u*a),m=c*(1-(1-u)*a);switch(h%6){case 0:r=c,i=m,o=d;break;case 1:r=p,i=c,o=d;break;case 2:r=d,i=c,o=m;break;case 3:r=d,i=p,o=c;break;case 4:r=m,i=d,o=c;break;case 5:r=c,i=d,o=p;break;default:r=0,i=0,o=0}return new Pr(r,i,o,l)}cmykToRgb(t){let r=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),o=(1-t.y)*(1-t.k);return new Pr(r,i,o,t.a)}rgbaToCmyk(t){let r=1-Math.max(t.r,t.g,t.b);if(r===1)return new Jo(0,0,0,1,t.a);{let i=(1-t.r-r)/(1-r),o=(1-t.g-r)/(1-r),s=(1-t.b-r)/(1-r);return new Jo(i,o,s,r,t.a)}}rgbaToHsva(t){let r,i,o=Math.min(t.r,1),s=Math.min(t.g,1),a=Math.min(t.b,1),c=Math.min(t.a,1),l=Math.max(o,s,a),h=Math.min(o,s,a),u=l,d=l-h;if(i=l===0?0:d/l,l===h)r=0;else{switch(l){case o:r=(s-a)/d+(s<a?6:0);break;case s:r=(a-o)/d+2;break;case a:r=(o-s)/d+4;break;default:r=0}r/=6}return new lr(r,i,u,c)}rgbaToHex(t,r){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new Jo(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new Jo(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new Pr(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",r=!0){let i=null;t=(t||"").toLowerCase();let o=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(s){return new Pr(parseInt(s[2],10)/255,parseInt(s[3],10)/255,parseInt(s[4],10)/255,isNaN(parseFloat(s[5]))?1:parseFloat(s[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(s){return new oo(parseInt(s[2],10)/360,parseInt(s[3],10)/100,parseInt(s[4],10)/100,isNaN(parseFloat(s[5]))?1:parseFloat(s[5]))}}];r?o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(s){return new Pr(parseInt(s[1],16)/255,parseInt(s[2],16)/255,parseInt(s[3],16)/255,parseInt(s[4]||"FF",16)/255)}}):o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(s){return new Pr(parseInt(s[1],16)/255,parseInt(s[2],16)/255,parseInt(s[3],16)/255,1)}}),o.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(s){return new Pr(parseInt(s[1]+s[1],16)/255,parseInt(s[2]+s[2],16)/255,parseInt(s[3]+s[3],16)/255,1)}});for(let s in o)if(o.hasOwnProperty(s)){let a=o[s],c=a.re.exec(t),l=c&&a.parse(c);if(l)return l instanceof Pr?i=this.rgbaToHsva(l):l instanceof oo&&(i=this.hsla2hsva(l)),i}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let r=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,o=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/;if(r.test(t))return"hex";if(i.test(t))return"rgba";if(o.test(t))return"hsla"}return"hex"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Et({token:n,factory:n.\u0275fac}),n})(),sd=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i}},Wf=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i}},sD=(()=>{class n{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new ie,this.dragStart=new ie,this.newValue=new ie,this.listenerMove=r=>this.move(r),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let r=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-r.left-window.pageXOffset}getY(t){let r=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-r.top-window.pageYOffset}setCursor(t){let r=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,o=Math.max(0,Math.min(this.getX(t),r)),s=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:o/r,v:1-s/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:s/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:o/r,rgX:this.rgX})}}return n.\u0275fac=function(t){return new(t||n)(X(mt))},n.\u0275dir=Ye({type:n,selectors:[["","slider",""]],hostBindings:function(t,r){t&1&&K("mousedown",function(o){return r.mouseDown(o)})("touchstart",function(o){return r.touchStart(o)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"}}),n})(),aD=(()=>{class n{constructor(t,r){this.service=t,this.cdr=r,this.color=new lr(0,1,1,1),this.controls="default",this.sliderChange=new ie(!1),this.onAlphaChange=new ie(!1),this.hsva=new lr(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new lr(0,1,1,1)),this.slider=new sd(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,r=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new Wf(t,220,130,r),this.update()}onSliderChange(t,r){switch(t){case"saturation-lightness":this.hsva.onColorChange(r);break;case"hue":this.hsva.onHueChange(r);break;case"alpha":this.hsva.onAlphaChange(r),this.onAlphaChange.emit(r);break;case"value":this.hsva.onValueChange(r);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),r=this.service.hsvaToRgba(new lr(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+r.r+","+r.g+","+r.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new sd(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return n.\u0275fac=function(t){return new(t||n)(X(ad),X(or))},n.\u0275cmp=fe({type:n,selectors:[["color-picker"]],viewQuery:function(t,r){if(t&1&&(Ct(jT,5),Ct(VT,5)),t&2){let i;We(i=Ke())&&(r.hueSlider=i.first),We(i=Ke())&&(r.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},features:[nr],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,r){if(t&1){let i=yt();L(0,"div",3,0),K("click",function(s){return se(i),ae(s.stopPropagation())}),Ae(2,HT,3,8,"div",4),L(3,"div",5),Ae(4,UT,3,2,"div",6),L(5,"div",7),Ae(6,GT,5,3,"div",8)(7,WT,6,4,"div",9),j()()()}t&2&&(U(2),ee("ngIf",r.controls!="only-alpha"),U(2),ee("ngIf",r.controls!="only-alpha"),U(2),ee("ngIf",r.controls!="only-alpha"),U(),ee("ngIf",r.controls!="no-alpha"))},dependencies:[ya,mf,sD],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),n})(),cD=(()=>{class n{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,r){this.service=t,this.cdr=r,this.color="#000000",this.previewColor="#000000",this.hsva=new lr(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=c_,this.variants=[],this.colorFormats=Ia,this.format=qr.HEX,this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let r;if(this.color)for(let i=0;i<t.length;i++){let o=t[i];typeof o=="string"?this.service.stringToFormat(this.color,qr.HEX)==this.service.stringToFormat(o,qr.HEX)&&(r=i):o===void 0?this.color=void 0:this.findIndexSelectedColor(o.variants)!=null&&(r=i)}return r}iniciate(t,r,i,o,s,a,c,l,h,u,d,p){if(this.colorPickerControls=d,this.triggerInstance=t,this.TriggerBBox=r,this.color=i,this.hideColorPicker=l,this.hideTextInput=c,this.acceptLabel=h,this.cancelLabel=u,a?Ia.includes(a)?(this.format=Ia.indexOf(a.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=a.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=qr.HEX):this.format=Ia.indexOf(this.service.getFormatByString(this.color)),this.previewColor=this.color,this.palette=o??c_,this.colorsAnimationEffect=s,p=="top"){let m=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+m.height+"px ))"}}setPosition(){if(this.TriggerBBox){let r=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=r.top+r.height,r.left+250>window.innerWidth?this.left=r.right<250?window.innerWidth/2-250/2:r.right-250:this.left=r.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),r=this.panelRef.nativeElement.getBoundingClientRect(),i=r.height;t.bottom+i>window.innerHeight?this.positionString=t.top<r.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(r=>r.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,r){var i=[];for(let o=0;o<r.length;o++){let s=r[o];if(typeof s=="string"){let a=this.service.stringToHsva(s);a.onAlphaChange(t),i.push(this.service.toFormat(a,this.format))}else{let a=new Gf,c=this.service.stringToHsva(s.preview);c.onAlphaChange(t),a.preview=this.service.toFormat(c,this.format),a.variants=this.ChangeAlphaOnPalette(t,s.variants),i.push(a)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color)}setColor(t){this.hsva=t,this.color=this.service.toFormat(t,this.format),this.setPreviewColor(t),this.triggerInstance.setColor(this.color)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){this.canChangeFormat&&(this.format=(this.format+1)%this.colorFormats.length,this.setColor(this.hsva),this.placeholder=this.service.toFormat(new lr(0,0,1,1),this.format))}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return n.\u0275fac=function(t){return new(t||n)(X(ad),X(or))},n.\u0275cmp=fe({type:n,selectors:[["ngx-colors-panel"]],viewQuery:function(t,r){if(t&1&&Ct(KT,5),t&2){let i;We(i=Ke())&&(r.panelRef=i.first)}},hostVars:4,hostBindings:function(t,r){t&1&&K("mousedown",function(o){return r.click(o)},!1,xa)("scroll",function(){return r.onScroll()},!1,xa)("resize",function(){return r.onResize()},!1,Jb),t&2&&Nn("top",r.top,"px")("left",r.left,"px")},decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,r){t&1&&(L(0,"div",2,0),Ae(2,eD,5,4,"ng-container",3)(3,rD,8,2,"ng-container",3)(4,iD,12,4,"ng-container",3)(5,oD,6,7,"div",4),j()),t&2&&(Zb(r.positionString),U(2),ee("ngIf",r.menu==1),U(),ee("ngIf",r.menu==2),U(),ee("ngIf",r.menu==3),U(),ee("ngIf",!r.hideTextInput))},dependencies:[qo,ya,mf,aD],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[Nl("colorsAnimation",[wa("void => slide-in",[Pa(":enter",Kn({opacity:0}),{optional:!0}),Pa(":enter",bf("10ms",[Ca(".3s ease-in",vf([Kn({opacity:0,transform:"translatex(-50%)",offset:0}),Kn({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),Kn({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),wa("void => popup",[Pa(":enter",Kn({opacity:0,transform:"scale(0)"}),{optional:!0}),Pa(":enter",bf("10ms",[Ca("500ms ease-out",vf([Kn({opacity:.5,transform:"scale(.5)",offset:.3}),Kn({opacity:1,transform:"scale(1.1)",offset:.8}),Kn({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),n})(),l_={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},d_=(()=>{class n{constructor(t,r,i){this.resolver=t,this.applicationRef=r,this.injector=i}createPanel(t,r){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(cD);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let o=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(r),Object.keys(l_).forEach(s=>{this.overlay.style[s]=l_[s]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(o),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return n.\u0275fac=function(t){return new(t||n)(pt(Yb),pt(ox),pt(Cr))},n.\u0275prov=Et({token:n,factory:n.\u0275fac}),n})(),u_=(()=>{class n{onClick(){this.openPanel()}constructor(t,r,i){this.triggerRef=t,this.panelFactory=r,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new ie,this.input=new ie,this.slider=new ie,this.close=new ie,this.open=new ie,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t){this.writeValue(t),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t){if(t!==this.color){if(this.format){let r=Ia.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,r)}this.color=t,this.change.emit(t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return n.\u0275fac=function(t){return new(t||n)(X(mt),X(d_),X(ad))},n.\u0275dir=Ye({type:n,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,r){t&1&&K("click",function(){return r.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},features:[pn([{provide:nd,useExisting:eo(()=>n),multi:!0}])]}),n})();var cd=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=kt({type:n}),n.\u0275inj=At({providers:[ad,d_],imports:[Wn]}),n})();var Ra={strokeColor:"#ff0",strokeWidth:5,fill:"#000",backgroundColor:"#fff",canvasHeight:800,canvasWidth:800,dasharray:""},h_=800,p_=800,Kf=1,f_=50,g_=50,m_=[6,12,16,25,50,75,100,150,200,300,400,600,800,1600];var dD=(n,e,t)=>{let r=`
    <svg width="60px" height="60px" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M24.5 25.98C29.4725 25.98 33.5 21.9227 33.5 16.9133C33.5 11.904 29.4725 7.84668 24.5 7.84668C19.5275 7.84668 15.5 11.904 15.5 16.9133C15.5 21.9227 19.5275 25.98 24.5 25.98Z" fill="${t}"/>
      <path d="M17.3786 29.2021C17.8814 29.0785 18.3971 29.3313 18.6254 29.7991L22.6893 32.7994C24.5 32.799 24.5 32.7995 26.3105 32.7991L30.3746 29.7991C30.6029 29.3313 31.1186 29.0785 31.6214 29.2021C37.0255 30.5301 42.5 33.238 42.5 37.3116V41.845H6.5V37.3116C6.5 33.238 11.9745 30.5301 17.3786 29.2021Z" fill="${t}"/>
      <text x="50%" y="35" fill="${t}">${e}</text>
    </svg>
  `,i=`
    <svg fill="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60" width="60px" height="60px">
      <path d="M 9 3 A 1 1 0 0 0 8 4 L 8 21 A 1 1 0 0 0 9 22 A 1 1 0 0 0 9.796875 21.601562 L 12.919922 18.119141 L 16.382812 26.117188 C 16.701812 26.855187 17.566828 27.188469 18.298828 26.855469 C 19.020828 26.527469 19.340672 25.678078 19.013672 24.955078 L 15.439453 17.039062 L 21 17 A 1 1 0 0 0 22 16 A 1 1 0 0 0 21.628906 15.222656 L 9.7832031 3.3789062 A 1 1 0 0 0 9 3 z"/>
      <text x="0" y="40" fill="${t}">${e}!</text>
    </svg>
  `;return n==="person"?r:i};function v_(n,e,t){let r=()=>{if(t){let i=t.userName;e.innerHTML="",n.getMousePresences().forEach((o,s)=>{if(s.userName!==i){let a=document.createElement("div");a.innerHTML=dD("person",s.userName,s.additionalDetails.color),a.style.position="absolute",a.style.left=`${o.x}px`,a.style.top=`${o.y}px`,e.appendChild(a)}})}};r(),n.on("mousePositionChanged",r)}function pD(n,e){}var so=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}};var Jf=(()=>{let e=class e extends _x{constructor(r,i,o,s,a,c,l,h){super(),this._elementRef=r,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=a,this._ngZone=c,this._overlayRef=l,this._focusMonitor=h,this._platform=hn(ui),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=hn(or),this.attachDomPortal=u=>{this._portalOutlet.hasAttached();let d=this._portalOutlet.attachDomPortal(u);return this._contentAttached(),d},this._document=o,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(r){this._ariaLabelledByQueue.push(r),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(r){let i=this._ariaLabelledByQueue.indexOf(r);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(r){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachComponentPortal(r);return this._contentAttached(),i}attachTemplatePortal(r){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachTemplatePortal(r);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(r,i){this._interactivityChecker.isFocusable(r)||(r.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{r.removeEventListener("blur",o),r.removeEventListener("mousedown",o),r.removeAttribute("tabindex")};r.addEventListener("blur",o),r.addEventListener("mousedown",o)})),r.focus(i)}_focusByCssSelector(r,i){let o=this._elementRef.nativeElement.querySelector(r);o&&this._forceFocus(o,i)}_trapFocus(){let r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus);break}}_restoreFocus(){let r=this._config.restoreFocus,i=null;if(typeof r=="string"?i=this._document.querySelector(r):typeof r=="boolean"?i=r?this._elementFocusedBeforeDialogWasOpened:null:r&&(i=r),this._config.restoreFocus&&i&&typeof i.focus=="function"){let o=Bl(),s=this._elementRef.nativeElement;(!o||o===this._document.body||o===s||s.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){let r=this._elementRef.nativeElement,i=Bl();return r===i||r.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=Bl()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(Vl),X(no,8),X(so),X(jl),X(Wt),X(Vo),X(Hl))},e.\u0275cmp=fe({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(i,o){if(i&1&&Ct(Ma,7),i&2){let s;We(s=Ke())&&(o._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,o){i&2&&me("id",o._config.id||null)("role",o._config.role)("aria-modal",o._config.ariaModal)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null)},standalone:!0,features:[Gn,xe],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,o){i&1&&Ae(0,pD,0,0,"ng-template",0)},dependencies:[Ma],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2});let n=e;return n})(),Na=class{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new nt,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(r=>{r.keyCode===27&&!this.disableClose&&!Ll(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{t.closeOnOverlayDetachments!==!1&&this.close()})}close(e,t){if(this.containerInstance){let r=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(e),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}},fD=new it("DialogScrollStrategy",{providedIn:"root",factory:()=>{let n=hn(sr);return()=>n.scrollStrategies.block()}}),gD=new it("DialogData"),mD=new it("DefaultDialogConfig");var vD=0,Qf=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(r,i,o,s,a,c){this._overlay=r,this._injector=i,this._defaultOptions=o,this._parentDialog=s,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new nt,this._afterOpenedAtThisLevel=new nt,this._ariaHiddenElements=new Map,this.afterAllClosed=Tl(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(zl(void 0))),this._scrollStrategy=c}open(r,i){let o=this._defaultOptions||new so;i=Nt(Nt({},o),i),i.id=i.id||`cdk-dialog-${vD++}`,i.id&&this.getDialogById(i.id);let s=this._getOverlayConfig(i),a=this._overlay.create(s),c=new Na(a,i),l=this._attachContainer(a,c,i);return c.containerInstance=l,this._attachDialogContent(r,c,l,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){$f(this.openDialogs,r=>r.close())}getDialogById(r){return this.openDialogs.find(i=>i.id===r)}ngOnDestroy(){$f(this._openDialogsAtThisLevel,r=>{r.config.closeOnDestroy===!1&&this._removeOpenDialog(r,!1)}),$f(this._openDialogsAtThisLevel,r=>r.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(r){let i=new Cx({positionStrategy:r.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:r.scrollStrategy||this._scrollStrategy(),panelClass:r.panelClass,hasBackdrop:r.hasBackdrop,direction:r.direction,minWidth:r.minWidth,minHeight:r.minHeight,maxWidth:r.maxWidth,maxHeight:r.maxHeight,width:r.width,height:r.height,disposeOnNavigation:r.closeOnNavigation});return r.backdropClass&&(i.backdropClass=r.backdropClass),i}_attachContainer(r,i,o){let s=o.injector||o.viewContainerRef?.injector,a=[{provide:so,useValue:o},{provide:Na,useValue:i},{provide:Vo,useValue:r}],c;o.container?typeof o.container=="function"?c=o.container:(c=o.container.type,a.push(...o.container.providers(o))):c=Jf;let l=new yf(c,o.viewContainerRef,Cr.create({parent:s||this._injector,providers:a}),o.componentFactoryResolver);return r.attach(l).instance}_attachDialogContent(r,i,o,s){if(r instanceof Qb){let a=this._createInjector(s,i,o,void 0),c={$implicit:s.data,dialogRef:i};s.templateContext&&(c=Nt(Nt({},c),typeof s.templateContext=="function"?s.templateContext():s.templateContext)),o.attachTemplatePortal(new xx(r,null,c,a))}else{let a=this._createInjector(s,i,o,this._injector),c=o.attachComponentPortal(new yf(r,s.viewContainerRef,a,s.componentFactoryResolver));i.componentRef=c,i.componentInstance=c.instance}}_createInjector(r,i,o,s){let a=r.injector||r.viewContainerRef?.injector,c=[{provide:gD,useValue:r.data},{provide:Na,useValue:i}];return r.providers&&(typeof r.providers=="function"?c.push(...r.providers(i,r,o)):c.push(...r.providers)),r.direction&&(!a||!a.get(Oa,null,{optional:!0}))&&c.push({provide:Oa,useValue:{value:r.direction,change:Gb()}}),Cr.create({parent:a||s,providers:c})}_removeOpenDialog(r,i){let o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,a)=>{s?a.setAttribute("aria-hidden",s):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let r=this._overlayContainer.getContainerElement();if(r.parentElement){let i=r.parentElement.children;for(let o=i.length-1;o>-1;o--){let s=i[o];s!==r&&s.nodeName!=="SCRIPT"&&s.nodeName!=="STYLE"&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}};e.\u0275fac=function(i){return new(i||e)(pt(sr),pt(Cr),pt(mD,8),pt(e,12),pt(Gl),pt(fD))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function $f(n,e){let t=n.length;for(;t--;)e(n[t])}var b_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({providers:[Qf],imports:[Ho,Sa,Ul,Sa]});let n=e;return n})();function bD(n,e){}var Ba=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}},Yf="mdc-dialog--open",x_="mdc-dialog--opening",__="mdc-dialog--closing",xD=150,_D=75,yD=(()=>{let e=class e extends Jf{constructor(r,i,o,s,a,c,l,h,u){super(r,i,o,s,a,c,l,u),this._animationMode=h,this._animationStateChanged=new ie,this._animationsEnabled=this._animationMode!=="NoopAnimations",this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?C_(this._config.enterAnimationDuration)??xD:0,this._exitAnimationDuration=this._animationsEnabled?C_(this._config.exitAnimationDuration)??_D:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(y_,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(x_,Yf)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(Yf),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(Yf),this._animationsEnabled?(this._hostElement.style.setProperty(y_,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(__)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(r){this._actionSectionCount+=r,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(x_,__)}_waitForAnimationToComplete(r,i){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,r)}_requestAnimationFrame(r){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(r):r()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(r){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:r})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(r){let i=super.attachComponentPortal(r);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(Vl),X(no,8),X(Ba),X(jl),X(Wt),X(Vo),X(Bo,8),X(Hl))},e.\u0275cmp=fe({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,o){i&2&&(Lo("id",o._config.id),me("aria-modal",o._config.ariaModal)("role",o._config.role)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null),Ie("_mat-animation-noopable",!o._animationsEnabled)("mat-mdc-dialog-container-with-actions",o._actionSectionCount>0))},standalone:!0,features:[Gn,xe],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),Ae(2,bD,0,0,"ng-template",2),j()())},dependencies:[Ma],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0;transform:scale(0.8)}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--closing .mdc-dialog__surface{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{opacity:1}.mdc-dialog--open .mdc-dialog__surface{transform:none}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{width:100%;height:100%}.mat-mdc-dialog-component-host{display:contents}.mat-mdc-dialog-container{--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition:opacity linear var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container .mdc-dialog__surface{transition:transform var(--mat-dialog-transition-duration, 0ms) 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container,.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__surface{transition:none}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-title{padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2});let n=e;return n})(),y_="--mat-dialog-transition-duration";function C_(n){return n==null?null:typeof n=="number"?n:n.endsWith("ms")?ql(n.substring(0,n.length-2)):n.endsWith("s")?ql(n.substring(0,n.length-1))*1e3:n==="0"?0:null}var ld=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(ld||{}),La=class{constructor(e,t,r){this._ref=e,this._containerInstance=r,this._afterOpened=new nt,this._beforeClosed=new nt,this._state=ld.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(Zi(i=>i.state==="opened"),Fl(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(Zi(i=>i.state==="closed"),Fl(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Dl(this.backdropClick(),this.keydownEvents().pipe(Zi(i=>i.keyCode===27&&!this.disableClose&&!Ll(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),w_(this,i.type==="keydown"?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Zi(t=>t.state==="closing"),Fl(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=ld.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=ld.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function w_(n,e,t){return n._closeInteractionType=e,n.close(t)}var CD=new it("MatMdcDialogData"),wD=new it("mat-mdc-dialog-default-options"),PD=new it("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let n=hn(sr);return()=>n.scrollStrategies.block()}});var OD=0,qa=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(r,i,o,s,a,c,l,h){this._overlay=r,this._defaultOptions=s,this._scrollStrategy=a,this._parentDialog=c,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new nt,this._afterOpenedAtThisLevel=new nt,this.dialogConfigClass=Ba,this.afterAllClosed=Tl(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(zl(void 0))),this._dialog=i.get(Qf),this._dialogRefConstructor=La,this._dialogContainerType=yD,this._dialogDataToken=CD}open(r,i){let o;i=Nt(Nt({},this._defaultOptions||new Ba),i),i.id=i.id||`mat-mdc-dialog-${OD++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();let s=this._dialog.open(r,ai(Nt({},i),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:so,useValue:i}]},templateContext:()=>({dialogRef:o}),providers:(a,c,l)=>(o=new this._dialogRefConstructor(a,i,l),o.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:l},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:o}])}));return o.componentRef=s.componentRef,o.componentInstance=s.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{let a=this.openDialogs.indexOf(o);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(r){return this.openDialogs.find(i=>i.id===r)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(r){let i=r.length;for(;i--;)r[i].close()}};e.\u0275fac=function(i){return new(i||e)(pt(sr),pt(Cr),pt(sx,8),pt(wD,8),pt(PD),pt(e,12),pt(Gl),pt(Bo,8))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var P_=(()=>{let e=class e{constructor(r,i,o){this.dialogRef=r,this._elementRef=i,this._dialog=o,this.type="button"}ngOnInit(){this.dialogRef||(this.dialogRef=S_(this._elementRef,this._dialog.openDialogs))}ngOnChanges(r){let i=r._matDialogClose||r._matDialogCloseResult;i&&(this.dialogResult=i.currentValue)}_onButtonClick(r){w_(this.dialogRef,r.screenX===0&&r.screenY===0?"keyboard":"mouse",this.dialogResult)}};e.\u0275fac=function(i){return new(i||e)(X(La,8),X(mt),X(qa))},e.\u0275dir=Ye({type:e,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(i,o){i&1&&K("click",function(a){return o._onButtonClick(a)}),i&2&&me("aria-label",o.ariaLabel||null)("type",o.type)},inputs:{ariaLabel:[tn.None,"aria-label","ariaLabel"],type:"type",dialogResult:[tn.None,"mat-dialog-close","dialogResult"],_matDialogClose:[tn.None,"matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],standalone:!0,features:[nr]});let n=e;return n})(),MD=(()=>{let e=class e{constructor(r,i,o){this._dialogRef=r,this._elementRef=i,this._dialog=o}ngOnInit(){this._dialogRef||(this._dialogRef=S_(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}};e.\u0275fac=function(i){return new(i||e)(X(La,8),X(mt),X(qa))},e.\u0275dir=Ye({type:e,standalone:!0});let n=e;return n})();var O_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ye({type:e,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0});let n=e;return n})(),M_=(()=>{let e=class e extends MD{_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Rl(e)))(o||e)}})(),e.\u0275dir=Ye({type:e,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(i,o){i&2&&Ie("mat-mdc-dialog-actions-align-start",o.align==="start")("mat-mdc-dialog-actions-align-center",o.align==="center")("mat-mdc-dialog-actions-align-end",o.align==="end")},inputs:{align:"align"},standalone:!0,features:[Gn]});let n=e;return n})();function S_(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(r=>r.id===t.id):null}var E_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({providers:[qa],imports:[b_,Ho,Sa,$n,$n]});let n=e;return n})();var Zf=class{constructor(e){this._box=e,this._destroyed=new nt,this._resizeSubject=new nt,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new Vb(t=>{let r=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),r.unsubscribe(),this._elementObservables.delete(e)}}).pipe(Zi(t=>t.some(r=>r.target===e)),$b({bufferSize:1,refCount:!0}),No(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},A_=(()=>{let e=class e{constructor(){this._observers=new Map,this._ngZone=hn(Wt),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,r]of this._observers)r.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(r,i){let o=i?.box||"content-box";return this._observers.has(o)||this._observers.set(o,new Zf(o)),this._observers.get(o).observe(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var ED=["notch"],AD=["matFormFieldNotchedOutline",""],kD=["*"],TD=["textField"],DD=["iconPrefixContainer"],FD=["textPrefixContainer"],zD=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],ID=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function RD(n,e){n&1&&Z(0,"span",17)}function ND(n,e){if(n&1&&(L(0,"label",16),ir(1,1),Ae(2,RD,1,0,"span",17),j()),n&2){let t=ne(2);ee("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),me("for",t._control.disableAutomaticLabeling?null:t._control.id),U(2),wn(2,!t.hideRequiredMarker&&t._control.required?2:-1)}}function BD(n,e){if(n&1&&Ae(0,ND,3,5,"label",16),n&2){let t=ne();wn(0,t._hasFloatingLabel()?0:-1)}}function LD(n,e){n&1&&Z(0,"div",5)}function qD(n,e){}function jD(n,e){if(n&1&&Ae(0,qD,0,0,"ng-template",11),n&2){ne(2);let t=wr(1);ee("ngTemplateOutlet",t)}}function VD(n,e){if(n&1&&(L(0,"div",7),Ae(1,jD,1,1,null,11),j()),n&2){let t=ne();ee("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),U(),wn(1,t._forceDisplayInfixLabel()?-1:1)}}function HD(n,e){n&1&&(L(0,"div",8,2),ir(2,2),j())}function UD(n,e){n&1&&(L(0,"div",9,3),ir(2,3),j())}function GD(n,e){}function WD(n,e){if(n&1&&Ae(0,GD,0,0,"ng-template",11),n&2){ne();let t=wr(1);ee("ngTemplateOutlet",t)}}function KD(n,e){n&1&&(L(0,"div",12),ir(1,4),j())}function $D(n,e){n&1&&(L(0,"div",13),ir(1,5),j())}function XD(n,e){n&1&&Z(0,"div",14)}function JD(n,e){if(n&1&&(L(0,"div",18),ir(1,6),j()),n&2){let t=ne();ee("@transitionMessages",t._subscriptAnimationState)}}function QD(n,e){if(n&1&&(L(0,"mat-hint",20),ot(1),j()),n&2){let t=ne(2);ee("id",t._hintLabelId),U(),_a(t.hintLabel)}}function YD(n,e){if(n&1&&(L(0,"div",19),Ae(1,QD,2,2,"mat-hint",20),ir(2,7),Z(3,"div",21),ir(4,8),j()),n&2){let t=ne();ee("@transitionMessages",t._subscriptAnimationState),U(),wn(1,t.hintLabel?1:-1)}}var ud=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ye({type:e,selectors:[["mat-label"]],standalone:!0});let n=e;return n})();var ZD=new it("MatError");var eF=0,hd=(()=>{let e=class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${eF++}`}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ye({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,o){i&2&&(Lo("id",o.id),me("align",null),Ie("mat-mdc-form-field-hint-end",o.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let n=e;return n})(),tF=new it("MatPrefix");var nF=new it("MatSuffix");var B_=new it("FloatingLabelParent"),k_=(()=>{let e=class e{get floating(){return this._floating}set floating(r){this._floating=r,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(r){this._monitorResize=r,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(r){this._elementRef=r,this._floating=!1,this._monitorResize=!1,this._resizeObserver=hn(A_),this._ngZone=hn(Wt),this._parent=hn(B_),this._resizeSubscription=new jb}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return rF(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};e.\u0275fac=function(i){return new(i||e)(X(mt))},e.\u0275dir=Ye({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,o){i&2&&Ie("mdc-floating-label--float-above",o.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let n=e;return n})();function rF(n){let e=n;if(e.offsetParent!==null)return e.scrollWidth;let t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);let r=t.scrollWidth;return t.remove(),r}var T_="mdc-line-ripple--active",dd="mdc-line-ripple--deactivating",D_=(()=>{let e=class e{constructor(r,i){this._elementRef=r,this._handleTransitionEnd=o=>{let s=this._elementRef.nativeElement.classList,a=s.contains(dd);o.propertyName==="opacity"&&a&&s.remove(T_,dd)},i.runOutsideAngular(()=>{r.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let r=this._elementRef.nativeElement.classList;r.remove(dd),r.add(T_)}deactivate(){this._elementRef.nativeElement.classList.add(dd)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(Wt))},e.\u0275dir=Ye({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let n=e;return n})(),F_=(()=>{let e=class e{constructor(r,i){this._elementRef=r,this._ngZone=i,this.open=!1}ngAfterViewInit(){let r=this._elementRef.nativeElement.querySelector(".mdc-floating-label");r?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(r.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>r.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(r){!this.open||!r?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${r}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(Wt))},e.\u0275cmp=fe({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,o){if(i&1&&Ct(ED,5),i&2){let s;We(s=Ke())&&(o._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,o){i&2&&Ie("mdc-notched-outline--notched",o.open)},inputs:{open:[tn.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[xe],attrs:AD,ngContentSelectors:kD,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(i,o){i&1&&(ff(),Z(0,"div",1),L(1,"div",2,0),ir(3),j(),Z(4,"div",3))},encapsulation:2,changeDetection:0});let n=e;return n})(),iF={transitionMessages:Nl("transitionMessages",[ux("enter",Kn({opacity:1,transform:"translateY(0%)"})),wa("void => enter",[Kn({opacity:0,transform:"translateY(-5px)"}),Ca("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},eg=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ye({type:e});let n=e;return n})();var tg=new it("MatFormField"),oF=new it("MAT_FORM_FIELD_DEFAULT_OPTIONS"),z_=0,I_="fill",sF="auto",R_="fixed",aF="translateY(-50%)",L_=(()=>{let e=class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(r){this._hideRequiredMarker=jo(r)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||sF}set floatLabel(r){r!==this._floatLabel&&(this._floatLabel=r,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(r){let i=this._appearance,o=r||this._defaults?.appearance||I_;this._appearance=o,this._appearance==="outline"&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||R_}set subscriptSizing(r){this._subscriptSizing=r||this._defaults?.subscriptSizing||R_}get hintLabel(){return this._hintLabel}set hintLabel(r){this._hintLabel=r,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(r){this._explicitFormFieldControl=r}constructor(r,i,o,s,a,c,l,h){this._elementRef=r,this._changeDetectorRef=i,this._ngZone=o,this._dir=s,this._platform=a,this._defaults=c,this._animationMode=l,this._hideRequiredMarker=!1,this.color="primary",this._appearance=I_,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${z_++}`,this._hintLabelId=`mat-mdc-hint-${z_++}`,this._subscriptAnimationState="",this._destroyed=new nt,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,c&&(c.appearance&&(this.appearance=c.appearance),this._hideRequiredMarker=!!c?.hideRequiredMarker,c.color&&(this.color=c.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let r=this._control;r.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${r.controlType}`),r.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),r.ngControl&&r.ngControl.valueChanges&&r.ngControl.valueChanges.pipe(No(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(r=>!r._isText),this._hasTextPrefix=!!this._prefixChildren.find(r=>r._isText),this._hasIconSuffix=!!this._suffixChildren.find(r=>!r._isText),this._hasTextSuffix=!!this._suffixChildren.find(r=>r._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Dl(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(No(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(No(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(r){let i=this._control?this._control.ngControl:null;return i&&i[r]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let r=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&r.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let i=this._hintChildren?this._hintChildren.find(s=>s.align==="start"):null,o=this._hintChildren?this._hintChildren.find(s=>s.align==="end"):null;i?r.push(i.id):this._hintLabel&&r.push(this._hintLabelId),o&&r.push(o.id)}else this._errorChildren&&r.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(r)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let r=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){r.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let i=this._iconPrefixContainer?.nativeElement,o=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,a=o?.getBoundingClientRect().width??0,c=this._dir.value==="rtl"?"-1":"1",l=`${s+a}px`,u=`calc(${c} * (${l} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;r.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${aF} translateX(${u})
    )`}_isAttachedToDom(){let r=this._elementRef.nativeElement;if(r.getRootNode){let i=r.getRootNode();return i&&i!==r}return document.documentElement.contains(r)}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(or),X(Wt),X(Oa),X(ui),X(oF,8),X(Bo,8),X(no))},e.\u0275cmp=fe({type:e,selectors:[["mat-form-field"]],contentQueries:function(i,o,s){if(i&1&&(di(s,ud,5),di(s,ud,7),di(s,eg,5),di(s,tF,5),di(s,nF,5),di(s,ZD,5),di(s,hd,5)),i&2){let a;We(a=Ke())&&(o._labelChildNonStatic=a.first),We(a=Ke())&&(o._labelChildStatic=a.first),We(a=Ke())&&(o._formFieldControl=a.first),We(a=Ke())&&(o._prefixChildren=a),We(a=Ke())&&(o._suffixChildren=a),We(a=Ke())&&(o._errorChildren=a),We(a=Ke())&&(o._hintChildren=a)}},viewQuery:function(i,o){if(i&1&&(Ct(TD,5),Ct(DD,5),Ct(FD,5),Ct(k_,5),Ct(F_,5),Ct(D_,5)),i&2){let s;We(s=Ke())&&(o._textField=s.first),We(s=Ke())&&(o._iconPrefixContainer=s.first),We(s=Ke())&&(o._textPrefixContainer=s.first),We(s=Ke())&&(o._floatingLabel=s.first),We(s=Ke())&&(o._notchedOutline=s.first),We(s=Ke())&&(o._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,o){i&2&&Ie("mat-mdc-form-field-label-always-float",o._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",o._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",o._hasIconSuffix)("mat-form-field-invalid",o._control.errorState)("mat-form-field-disabled",o._control.disabled)("mat-form-field-autofilled",o._control.autofilled)("mat-form-field-no-animations",o._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",o.appearance=="fill")("mat-form-field-appearance-outline",o.appearance=="outline")("mat-form-field-hide-placeholder",o._hasFloatingLabel()&&!o._shouldLabelFloat())("mat-focused",o._control.focused)("mat-primary",o.color!=="accent"&&o.color!=="warn")("mat-accent",o.color==="accent")("mat-warn",o.color==="warn")("ng-untouched",o._shouldForward("untouched"))("ng-touched",o._shouldForward("touched"))("ng-pristine",o._shouldForward("pristine"))("ng-dirty",o._shouldForward("dirty"))("ng-valid",o._shouldForward("valid"))("ng-invalid",o._shouldForward("invalid"))("ng-pending",o._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[pn([{provide:tg,useExisting:e},{provide:B_,useExisting:e}]),xe],ngContentSelectors:ID,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(i,o){if(i&1){let s=yt();ff(zD),Ae(0,BD,1,1,"ng-template",null,0,rx),L(2,"div",4,1),K("click",function(c){return se(s),ae(o._control.onContainerClick(c))}),Ae(4,LD,1,0,"div",5),L(5,"div",6),Ae(6,VD,2,2,"div",7)(7,HD,3,0,"div",8)(8,UD,3,0,"div",9),L(9,"div",10),Ae(10,WD,1,1,null,11),ir(11),j(),Ae(12,KD,2,0,"div",12)(13,$D,2,0,"div",13),j(),Ae(14,XD,1,0,"div",14),j(),L(15,"div",15),Ae(16,JD,2,1)(17,YD,5,2),j()}if(i&2){let s;U(2),Ie("mdc-text-field--filled",!o._hasOutline())("mdc-text-field--outlined",o._hasOutline())("mdc-text-field--no-label",!o._hasFloatingLabel())("mdc-text-field--disabled",o._control.disabled)("mdc-text-field--invalid",o._control.errorState),U(2),wn(4,!o._hasOutline()&&!o._control.disabled?4:-1),U(2),wn(6,o._hasOutline()?6:-1),U(),wn(7,o._hasIconPrefix?7:-1),U(),wn(8,o._hasTextPrefix?8:-1),U(2),wn(10,!o._hasOutline()||o._forceDisplayInfixLabel()?10:-1),U(2),wn(12,o._hasTextSuffix?12:-1),U(),wn(13,o._hasIconSuffix?13:-1),U(),wn(14,o._hasOutline()?-1:14),U(),Ie("mat-mdc-form-field-subscript-dynamic-size",o.subscriptSizing==="dynamic"),U(),wn(16,(s=o._getDisplayedMessages())==="error"?16:s==="hint"?17:-1)}},dependencies:[k_,F_,dx,D_,hd],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[iF.transitionMessages]},changeDetection:0});let n=e;return n})(),ja=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({imports:[$n,Wn,mx,$n]});let n=e;return n})();var q_=gx({passive:!0}),j_=(()=>{let e=class e{constructor(r,i){this._platform=r,this._ngZone=i,this._monitoredElements=new Map}monitor(r){if(!this._platform.isBrowser)return Hb;let i=_f(r),o=this._monitoredElements.get(i);if(o)return o.subject;let s=new nt,a="cdk-text-field-autofilled",c=l=>{l.animationName==="cdk-text-field-autofill-start"&&!i.classList.contains(a)?(i.classList.add(a),this._ngZone.run(()=>s.next({target:l.target,isAutofilled:!0}))):l.animationName==="cdk-text-field-autofill-end"&&i.classList.contains(a)&&(i.classList.remove(a),this._ngZone.run(()=>s.next({target:l.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",c,q_),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:s,unlisten:()=>{i.removeEventListener("animationstart",c,q_)}}),s}stopMonitoring(r){let i=_f(r),o=this._monitoredElements.get(i);o&&(o.unlisten(),o.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((r,i)=>this.stopMonitoring(i))}};e.\u0275fac=function(i){return new(i||e)(pt(ui),pt(Wt))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var V_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({});let n=e;return n})();var dF=new it("MAT_INPUT_VALUE_ACCESSOR"),uF=["button","checkbox","file","hidden","image","radio","range","reset","submit"],hF=0,H_=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(r){this._disabled=jo(r),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(r){this._id=r||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator($o.required)??!1}set required(r){this._required=jo(r)}get type(){return this._type}set type(r){this._type=r||"text",this._validateType(),!this._isTextarea&&xf().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(r){this._errorStateTracker.matcher=r}get value(){return this._inputValueAccessor.value}set value(r){r!==this.value&&(this._inputValueAccessor.value=r,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(r){this._readonly=jo(r)}get errorState(){return this._errorStateTracker.errorState}set errorState(r){this._errorStateTracker.errorState=r}constructor(r,i,o,s,a,c,l,h,u,d){this._elementRef=r,this._platform=i,this.ngControl=o,this._autofillMonitor=h,this._formField=d,this._uid=`mat-input-${hF++}`,this.focused=!1,this.stateChanges=new nt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(g=>xf().has(g)),this._iOSKeyupListener=g=>{let x=g.target;!x.value&&x.selectionStart===0&&x.selectionEnd===0&&(x.setSelectionRange(1,1),x.setSelectionRange(0,0))};let p=this._elementRef.nativeElement,m=p.nodeName.toLowerCase();this._inputValueAccessor=l||p,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&u.runOutsideAngular(()=>{r.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new vx(c,o,a,s,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=m==="select",this._isTextarea=m==="textarea",this._isInFormField=!!d,this._isNativeSelect&&(this.controlType=p.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(r=>{this.autofilled=r.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(r){this._elementRef.nativeElement.focus(r)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(r){r!==this.focused&&(this.focused=r,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let r=this._elementRef.nativeElement.value;this._previousNativeValue!==r&&(this._previousNativeValue=r,this.stateChanges.next())}_dirtyCheckPlaceholder(){let r=this._getPlaceholder();if(r!==this._previousPlaceholder){let i=this._elementRef.nativeElement;this._previousPlaceholder=r,r?i.setAttribute("placeholder",r):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){uF.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let r=this._elementRef.nativeElement.validity;return r&&r.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let r=this._elementRef.nativeElement,i=r.options[0];return this.focused||r.multiple||!this.empty||!!(r.selectedIndex>-1&&i&&i.label)}else return this.focused||!this.empty}setDescribedByIds(r){r.length?this._elementRef.nativeElement.setAttribute("aria-describedby",r.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let r=this._elementRef.nativeElement;return this._isNativeSelect&&(r.multiple||r.size>1)}};e.\u0275fac=function(i){return new(i||e)(X(mt),X(ui),X(io,10),X(jf,8),X(Uf,8),X(bx),X(dF,10),X(j_),X(Wt),X(tg,8))},e.\u0275dir=Ye({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(i,o){i&1&&K("focus",function(){return o._focusChanged(!0)})("blur",function(){return o._focusChanged(!1)})("input",function(){return o._onInput()}),i&2&&(Lo("id",o.id)("disabled",o.disabled)("required",o.required),me("name",o.name||null)("readonly",o.readonly&&!o._isNativeSelect||null)("aria-invalid",o.empty&&o.required?null:o.errorState)("aria-required",o.required)("id",o.id),Ie("mat-input-server",o._isServer)("mat-mdc-form-field-textarea-control",o._isInFormField&&o._isTextarea)("mat-mdc-form-field-input-control",o._isInFormField)("mdc-text-field__input",o._isInFormField)("mat-mdc-native-select-inline",o._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[tn.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[pn([{provide:eg,useExisting:e}]),nr]});let n=e;return n})(),U_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=kt({type:e}),e.\u0275inj=At({imports:[$n,ja,ja,V_,$n]});let n=e;return n})();var G_=(()=>{let e=class e{constructor(){this.nameControl=new Vf("",[$o.required])}ngOnInit(){this.nameControl.valueChanges.subscribe(r=>console.log(r))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-save-whiteboard"]],standalone:!0,features:[xe],decls:8,vars:3,consts:[["matDialogContent",""],["matInput","",3,"formControl"],["matDialogActions","",3,"disabled","mat-dialog-close"]],template:function(i,o){i&1&&(L(0,"mat-form-field",0)(1,"mat-label"),ot(2,"Name"),j(),Z(3,"input",1),L(4,"mat-hint"),ot(5," Provide a new name for the board"),j()(),L(6,"button",2),ot(7,"Save"),j()),i&2&&(U(3),ee("formControl",o.nameControl),U(3),ee("disabled",o.nameControl.invalid)("mat-dialog-close",o.nameControl.value))},dependencies:[ja,L_,ud,hd,U_,H_,wx,O_,M_,P_,s_,rd,Zx,Hf]});let n=e;return n})();var W_=(()=>{let e=class e{constructor(){this.onImageAdd=new ie}addImage(r){this.onImageAdd.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-add-image"]],outputs:{onImageAdd:"onImageAdd"},standalone:!0,features:[xe],decls:7,vars:0,consts:[[1,"menu"],["matTooltip","Add image",1,"menu_title"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#565a66","d","M4 5h13v7h2V5c0-1.103-.897-2-2-2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h8v-2H4V5z"],["fill","#565a66","d","m8 11l-3 4h11l-4-6l-3 4z"],["fill","#565a66","d","M19 14h-2v3h-3v2h3v3h2v-3h3v-2h-3z"],["type","file","accept","image/png, image/gif, image/jpeg",1,"file-input",3,"change"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"label",1),ce(),L(2,"svg",2),Z(3,"path",3)(4,"path",4)(5,"path",5),j(),rr(),L(6,"input",6),K("change",function(a){return o.addImage(a.target)}),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var K_=(()=>{let e=class e{constructor(){this.onUndo=new ie}undo(){this.onUndo.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-undo"]],outputs:{onUndo:"onUndo"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","Undo(ctrl + z)","title","Undo",1,"menu_title",3,"click"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#565a66","d","M9 10h6c1.654 0 3 1.346 3 3s-1.346 3-3 3h-3v2h3c2.757 0 5-2.243 5-5s-2.243-5-5-5H9V5L4 9l5 4v-3z"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),K("click",function(){return o.undo()}),ce(),L(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var $_=(()=>{let e=class e{constructor(){this.onNewDocument=new ie}newDocument(){this.onNewDocument.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-new-document"]],outputs:{onNewDocument:"onNewDocument"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","New document",1,"menu_title",3,"click"],["viewBox","0 0 16 16","width","20","height","20"],["fill","#565a66","d","m9.5 1.1l3.4 3.5l.1.4v2h-1V6H8V2H3v11h4v1H2.5l-.5-.5v-12l.5-.5h6.7l.3.1zM9 2v3h2.9L9 2zm4 14h-1v-3H9v-1h3V9h1v3h3v1h-3v3z"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),K("click",function(){return o.newDocument()}),ce(),L(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var X_=(()=>{let e=class e{constructor(){this.onRedo=new ie}redo(){this.onRedo.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-redo"]],outputs:{onRedo:"onRedo"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","Redo(ctrl + y)","title","Redo",1,"menu_title",3,"click"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#565a66","d","M9 18h3v-2H9c-1.654 0-3-1.346-3-3s1.346-3 3-3h6v3l5-4l-5-4v3H9c-2.757 0-5 2.243-5 5s2.243 5 5 5z"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),K("click",function(){return o.redo()}),ce(),L(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var J_=(()=>{let e=class e{constructor(){this.onSaveToDB=new ie}SaveToDB(){this.onSaveToDB.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-save-to-db"]],outputs:{onSaveToDB:"onSaveToDB"},standalone:!0,features:[xe],decls:10,vars:0,consts:[[1,"menu"],["matTooltip","Save","title","Save",1,"menu_title",3,"click"],["width","20","height","20","viewBox","0 -0.5 17 17","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",1,"si-glyph","si-glyph-file-upload"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["transform","translate(1.000000, 1.000000)","fill","#565a66"],["d","M14,8.047 L14,12.047 L2,12.047 L2,8.047 L0,8.047 L0,15 L15.969,15 L15.969,8.047 L14,8.047 Z",1,"si-glyph-fill"],["d","M7.997,0 L5,3.963 L7.016,3.984 L7.016,8.969 L8.953,8.969 L8.953,3.984 L10.953,3.984 L7.997,0 Z",1,"si-glyph-fill"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),K("click",function(){return o.SaveToDB()}),ce(),L(2,"svg",2)(3,"title"),ot(4,"1126"),j(),Z(5,"defs"),L(6,"g",3)(7,"g",4),Z(8,"path",5)(9,"path",6),j()()()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var Q_=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.SELECT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whitebord-button-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Select Tool",1,"tool_button",3,"click"],["viewBox","0 0 24 24","width","24","height","24"],["d","M17.15 20.76l-2.94 1.5-3.68-6-4.41 3V1.24l12.5 12.01-4.41 1.5 2.94 6z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.SELECT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var Y_=(()=>{let e=class e{constructor(){this.formatTypes=ro,this.onSaveAs=new ie}saveAs(r){this.onSaveAs.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-save-as-menu"]],outputs:{onSaveAs:"onSaveAs"},standalone:!0,features:[xe],decls:13,vars:0,consts:[[1,"menu"],["title","Save Board",1,"menu_title"],["viewBox","0 0 20 20","width","20","height","20"],["d","M12.984 12.656l2.625-2.578 1.406 1.406-5.016 5.016-5.016-5.016 1.406-1.406 2.625 2.578v-9.656h1.969v9.656zM18.984 12h2.016v6.984q0 0.797-0.609 1.406t-1.406 0.609h-13.969q-0.797 0-1.406-0.609t-0.609-1.406v-6.984h2.016v6.984h13.969v-6.984z","fill","#565a66"],["id","file_menu",1,"menu_list","inverted-undo"],[1,"menu_item",3,"click"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),ce(),L(2,"svg",2),Z(3,"path",3),j()(),rr(),L(4,"div",4)(5,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Png)}),ot(6,"Save as PNG"),j(),L(7,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Jpeg)}),ot(8,"Save as JPEG"),j(),L(9,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Svg)}),ot(10,"Save as SVG"),j(),L(11,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Base64)}),ot(12,"Copy Base-64"),j()()())}});let n=e;return n})();var Z_=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(_e.BRUSH)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-brush-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Brush Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24",2,"transform","scale(-1, 1)"],["d","M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.BRUSH)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ey=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.IMAGE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-image-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:4,vars:2,consts:[["matTooltip","Image Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24"],["d","M0 0h24v24H0z","fill","none"],["d","M17 7l-5 5 5 5V7zm-2 9.17L12.83 12 15 9.83 17.17 12 15 14.17zM3 3v18h18V3H3zm16 16H5V5h14v14z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2)(3,"path",3),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.IMAGE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ty=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.LINE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-line-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Line Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["d","M 3 1 L 26 24 L 24 26 L 1 3 L 3 1 Z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.LINE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ny=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.RECT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-rect-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Square/Rect Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["d","M 0 8 L 0 24 L 24 24 L 25 8 L 0 8 Z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.RECT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ry=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.ELLIPSE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-ellipse-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Ellipse/Circle Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["cx","13","cy","13","rx","13","ry","9"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"ellipse",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.ELLIPSE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var iy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.TEXT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-text-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Text Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27","height","27"],["d","M5 4v3h5.5v12h3V7H19V4z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.TEXT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var oy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.ERASER)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-eraser-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:4,vars:2,consts:[["matTooltip","Eraser Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24"],["d","M0 0h24v24H0z","fill","none"],["d","M19 13H5v-2h14v2z"]],template:function(i,o){i&1&&(L(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),L(1,"svg",1),Z(2,"path",2)(3,"path",3),j()()),i&2&&Ie("active",o.selectedTool===o.toolsEnum.ERASER)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var sy=(()=>{let e=class e{constructor(){this.onColorChange=new ie,this.onSwapColors=new ie,this.options=Ra}colorChange(r,i){this.onColorChange.emit({type:r,event:i})}swapColors(){this.onSwapColors.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-color-tool"]],outputs:{onColorChange:"onColorChange",onSwapColors:"onSwapColors"},standalone:!0,features:[xe],decls:18,vars:2,consts:[["id","color_tools"],["id","tool_switch","matTooltip","Switch stroke and fill colors [X]",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 11 11"],["d","M3.01 2A6 6 0 019 8h1.83l-2.91 2.91L5 8h2a4 4 0 00-3.99-4v1.93L.1 3.02 3.01.1V2z"],["id","tool_fill","ngx-colors-trigger","",1,"color_tool","active",3,"change"],["title","Change fill color",1,"icon_label"],[1,"color_block"],["id","fill_bg"],["id","fill_color",1,"color_block"],["xmlns","http://www.w3.org/2000/svg","width","100%"],["width","100%","height","100%","opacity","1"],["id","tool_stroke","ngx-colors-trigger","",1,"color_tool",3,"change"],["title","Change stroke color",1,"icon_label"],["id","stroke_bg"],["id","stroke_color","title","Change stroke color",1,"color_block"]],template:function(i,o){i&1&&(L(0,"div",0)(1,"div",1),K("click",function(){return o.swapColors()}),ce(),L(2,"svg",2),Z(3,"path",3),j()(),rr(),L(4,"div",4),K("change",function(a){return o.colorChange("fill",a)}),Z(5,"label",5),L(6,"div",6),Z(7,"div",7),L(8,"div",8),ce(),L(9,"svg",9),Z(10,"rect",10),j()()()(),rr(),L(11,"div",11),K("change",function(a){return o.colorChange("strokeColor",a)}),Z(12,"label",12),L(13,"div",6),Z(14,"div",13),L(15,"div",14),ce(),L(16,"svg",9),Z(17,"rect",10),j()()()()()),i&2&&(U(10),me("fill",o.options.fill),U(7),me("fill",o.options.strokeColor))},dependencies:[cd,u_],styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();function fF(n,e){if(n&1&&(L(0,"option",9),ot(1),j()),n&2){let t=e.$implicit;ee("value",t)("selected",t===100),U(),to(" ",t+"%"," ")}}var ay=(()=>{let e=class e{constructor(){this.whiteBoardZoomOptions=m_,this.onZoom=new ie}setZoom(r){this.onZoom.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-zoom-panel"]],inputs:{zoom:"zoom"},outputs:{onZoom:"onZoom"},standalone:!0,features:[xe],decls:9,vars:2,consts:[["zoomSelect",""],["id","zoom_select",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["id","zoom_panel","title","Change zoom level",1,"toolset"],["id","zoom_label",1,"select-input"],["id","zoomLabel",1,"zoom_tool","icon_label"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27"],["d","M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"],["id","zoom","type","text","readonly","readonly",3,"value"],[3,"value","selected"]],template:function(i,o){if(i&1){let s=yt();L(0,"select",1,0),K("change",function(){se(s);let c=wr(1);return ae(o.setZoom(c.value))}),Ae(2,fF,2,3,"option",2),j(),L(3,"div",3)(4,"div",4)(5,"span",5),ce(),L(6,"svg",6),Z(7,"path",7),j()(),rr(),Z(8,"input",8),j()()}i&2&&(U(2),ee("ngForOf",o.whiteBoardZoomOptions),U(6),ee("value",o.zoom*100+"%"))},dependencies:[Wn,qo]});let n=e;return n})();Y();var AP=(()=>{let e=class e extends we{constructor(r,i,o){super(),this.audience=i,this.signalManager=o,this.posMap=new Map,this.onMouseSignalFn=(s,a)=>{let c=a.userId,l=a.pos,h=this.posMap.get(c);h===void 0&&(h=new Map,this.posMap.set(c,h)),h.set(s,l),this.emit("mousePositionChanged")},this.audience.on("memberRemoved",(s,a)=>{let c=this.posMap.get(a.userId);c!==void 0&&(c.delete(s),c.size===0&&this.posMap.delete(a.userId)),this.emit("mousePositionChanged")}),this.signalManager.on("error",s=>{this.emit("error",s)}),this.signalManager.onSignal(e.mouseSignalType,(s,a,c)=>{this.onMouseSignalFn(s,c)}),window.addEventListener("mousemove",s=>{let a={x:s.clientX,y:s.clientY};if(this.prevPosition){let l=a.x>=this.prevPosition.x+this.prevPosition.x*.02||a.x<=this.prevPosition.x-this.prevPosition.x*.02,h=a.y>=this.prevPosition.y+this.prevPosition.y*.02||a.y<=this.prevPosition.y-this.prevPosition.y*.02;(l||h)&&this.sendMouseSignal(a)}else this.sendMouseSignal(a);this.prevPosition=a})}sendMouseSignal(r){this.signalManager.submitSignal(e.mouseSignalType,{userId:this.audience.getMyself()?.userId,pos:r})}getMousePresences(){let r=new Map;return this.audience.getMembers().forEach((i,o)=>{i.connections.forEach(s=>{let a=this.getMousePresenceForUser(o,s.id);a!==void 0&&r.set(i,a)})}),r}getMousePresenceForUser(r,i){return this.posMap.get(r)?.get(i)}};e.mouseSignalType="positionChanged";let n=e;return n})();function Ug(n,e){if(!n)throw new Error(typeof e=="number"?`0x${e.toString(16).padStart(3,"0")}`:e)}Y();var ac=class extends we{constructor(e,t){super(),this.container=e,this.rootDataObject=t,this.connectedHandler=()=>this.emit("connected"),this.disconnectedHandler=()=>this.emit("disconnected"),this.disposedHandler=r=>this.emit("disposed",r),this.savedHandler=()=>this.emit("saved"),this.dirtyHandler=()=>this.emit("dirty"),e.on("connected",this.connectedHandler),e.on("closed",this.disposedHandler),e.on("disconnected",this.disconnectedHandler),e.on("saved",this.savedHandler),e.on("dirty",this.dirtyHandler)}get isDirty(){return this.container.isDirty}get attachState(){return this.container.attachState}get disposed(){return this.container.closed}get connectionState(){return this.container.connectionState}get initialObjects(){return this.rootDataObject.initialObjects}attach(){return v(this,null,function*(){throw new Error("Cannot attach container. Container is not in detached state")})}connect(){return v(this,null,function*(){var e,t;(t=(e=this.container).connect)===null||t===void 0||t.call(e)})}disconnect(){return v(this,null,function*(){var e,t;(t=(e=this.container).disconnect)===null||t===void 0||t.call(e)})}create(e){return v(this,null,function*(){return this.rootDataObject.create(e)})}dispose(){this.container.close(),this.container.off("connected",this.connectedHandler),this.container.off("closed",this.disposedHandler),this.container.off("disconnected",this.disconnectedHandler),this.container.off("saved",this.savedHandler),this.container.off("dirty",this.dirtyHandler)}};var cc=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(cc||{});var bi=class{constructor(e){this.internalStorageService=e}set policies(e){this._policies=e}get policies(){var e;return(e=this._policies)!==null&&e!==void 0?e:this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.internalStorageService.getSnapshotTree(e,t)})}getVersions(e,t,r){return v(this,null,function*(){return this.internalStorageService.getVersions(e,t,r)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.internalStorageService.downloadSummary(e)})}createBlob(e){return v(this,null,function*(){return this.internalStorageService.createBlob(e)})}readBlob(e){return v(this,null,function*(){return this.internalStorageService.readBlob(e)})}};var Dd=class extends bi{constructor(e,t){super(e),this.blobs=t}get policies(){return this.internalStorageService.policies}readBlob(e){return v(this,null,function*(){let t=this.blobs.get(e);return t!==void 0?t:this.internalStorageService.readBlob(e)})}};var lo=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(lo||{});var Fd=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(Fd||{}),lc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(lc||{});var xi=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(xi||{});Y();Hr();qt();function AO(n,e,t){let r=[];for(let i of e){let o=`${n}${i.path}`;if(i.type===lc.Blob){let s=i.value,a=Bn(s.contents,s.encoding),c=ke();t.set(c,a);let l={mode:Fd[i.mode],path:o,sha:c,size:0,type:"blob",url:""};r.push(l)}else if(i.type===lc.Tree){w(i.type===lc.Tree,257);let s=i.value,a={mode:Fd[i.mode],path:o,sha:"",size:-1,type:"tree",url:""};r.push(a);let c=AO(`${o}/`,s.entries,t);r.push(...c)}}return r}function zB(n,e){return{sha:"",tree:AO("",n,e),url:""}}function tu(n,e){let t=zB(n,e);return vs(t)}var Xt=function(n){return n.genericError="genericError",n.genericNetworkError="genericNetworkError",n.authorizationError="authorizationError",n.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",n.throttlingError="throttlingError",n.offlineError="offlineError",n.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",n.writeError="writeError",n.fetchFailure="fetchFailure",n.incorrectServerResponse="incorrectServerResponse",n.fileOverwrittenInStorage="fileOverwrittenInStorage",n.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",n.locationRedirection="locationRedirection",n}(Xt||{});var Ei=function(n){return n[n.NoCaching=0]="NoCaching",n[n.Prefetch=1]="Prefetch",n}(Ei||{});var Ai=function(n){return n.summarizingClient="fluid-client-summarizer",n.createNew="createNew",n}(Ai||{});var _v=Ce(Gm());var Dc=n=>n?.type==="fluid";function vn(n){if(!Dc(n))throw new Error(`resolved is not a Fluid url. Type: ${n?.type}`)}var Ou=class n{constructor(e){this.protocolName="none:",this.protocolToDocumentFactoryMap=new Map,e.forEach(t=>{this.protocolToDocumentFactoryMap.set(t.protocolName,t)})}static create(e){if(Array.isArray(e)){let t=[];return e.forEach(r=>{let i=r;i.protocolToDocumentFactoryMap!==void 0?t.push(...i.protocolToDocumentFactoryMap.values()):t.push(r)}),t.length===1?t[0]:new n(t)}return e}createDocumentService(e,t,r){return v(this,null,function*(){vn(e);let i=(0,_v.parse)(e.url);if(i.protocol===void 0||i.protocol===null)throw new Error("No protocol provided");let o=this.protocolToDocumentFactoryMap.get(i.protocol);if(o===void 0)throw new Error("Unknown Fluid protocol");return o.createDocumentService(e,t,r)})}createContainer(e,t,r,i){return v(this,null,function*(){vn(t);let o=(0,_v.parse)(t.url);if(o.protocol===void 0||o.protocol===null)throw new Error("No protocol provided");let s=this.protocolToDocumentFactoryMap.get(o.protocol);if(s===void 0)throw new Error("Unknown Fluid protocol");return s.createContainer(e,t,r,i)})}};function mj(n,e){return v(this,null,function*(){let t;for(let r of n)if(t=yield r.resolve(Object.assign({},e)),t!==void 0)return t})}var Mu=class n{constructor(e){this.urlResolvers=e}static create(e){return Array.isArray(e)?e.length===1?e[0]:new n(e):e}resolve(e){return v(this,null,function*(){return mj(this.urlResolvers,e)})}getAbsoluteUrl(e,t){return v(this,null,function*(){throw new Error("Not implmented")})}};Pe();var yv,Gr=function(n){return n[n.Offline=0]="Offline",n[n.Online=1]="Online",n[n.Unknown=2]="Unknown",n}(Gr||{});function zc(){return typeof navigator=="object"&&navigator!==null&&typeof navigator.onLine=="boolean"?navigator.onLine?Gr.Online:Gr.Offline:Gr.Unknown}var Is=class extends Be{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=Xt.genericNetworkError}},J2="deltaStreamConnectionForbidden",Fc=class n extends Be{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=n.errorType,this.canRetry=!1}};Fc.errorType=(yv=Xt[J2])!==null&&yv!==void 0?yv:J2;var Su=class extends Be{constructor(e,t,r,i){super(e,i,new Set(["claims","tenantId"])),this.claims=t,this.tenantId=r,this.errorType=Xt.authorizationError,this.canRetry=!1}},Cv=class extends Be{constructor(e,t,r,i){super(e,i),this.errorType=t,this.canRetry=r}},Wr=class extends Cv{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}};var wv=class extends Be{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=Xt.throttlingError,this.canRetry=!0}},Q2=(n,e)=>new Wr(n,Xt.writeError,e);function Ar(n,e,t){return e.retryAfterMs!==void 0&&e.canRetry?new wv(n,e.retryAfterMs/1e3,t):new Is(n,e.canRetry,t)}var kr=n=>n?.canRetry===!0,Pv=n=>n?.retryAfterSeconds,_o=n=>n?.retryAfterSeconds!==void 0?n.retryAfterSeconds*1e3:void 0;Y();function et(n,e){return v(this,null,function*(){let t=yield n.readBlob(e),r=pi(t,"utf8");return JSON.parse(r)})}function Rs(n,e){return{type:xi.Tree,tree:{".protocol":e,".app":n}}}function Y2(n){var e;let t=n.tree.attributes,r=JSON.parse(t.content);return r.term=(e=r.term)!==null&&e!==void 0?e:1,r}function Z2(n){let e=n.tree.quorumValues;return JSON.parse(e.content)}Y();Pe();function Ic(n,e,t){var r,i;let o=Object.assign({},e),s=t.online;if(o.online=typeof s=="string"?s:Gr[zc()],typeof navigator=="object"&&navigator!==null){let a=navigator,c=(i=(r=a.connection)!==null&&r!==void 0?r:a.mozConnection)!==null&&i!==void 0?i:a.webkitConnection;c!==null&&typeof c=="object"&&(o.connectionType=c.type)}o.category=kr(t)?"generic":"error",n.sendTelemetryEvent(o,t)}function Rc(n){return new Promise(t=>{let r=t,i=n;zc()===Gr.Offline&&window?.addEventListener!==void 0&&(r=()=>{t(),window.removeEventListener("online",r)},window.addEventListener("online",r,!1),i=Math.max(n,3e4)),setTimeout(r,i)})}var Eu="1.4.0";var vj=1e4,bj=100,Ov=class{constructor(e,t,r,i,o,s){this.to=t,this.payloadSize=r,this.logger=i,this.requestCallback=o,this.responseCallback=s,this.results=new Map,this.workingState="working",this.requestsInFlight=0,this.endEvent=new Se,this.requests=0,this.latestRequested=e,this.nextToDeliver=e,this.knewTo=t!==void 0}get working(){return this.workingState==="working"}get canceled(){return this.workingState==="canceled"}cancel(){this.working&&(this.workingState="canceled",this.endEvent.resolve())}run(e){return v(this,null,function*(){w(e>0,258),w(this.working,259);let t=e;for(;t>0;)t--,this.addRequest();return this.dispatch(),this.endEvent.promise})}done(){w(this.to!==void 0,260),w(this.nextToDeliver>=this.to,261),this.working&&(this.workingState="done",this.endEvent.resolve())}fail(e){this.working&&(this.workingState="done",this.endEvent.reject(e))}dispatch(){for(;this.working;){let e=this.results.get(this.nextToDeliver);if(e===void 0)break;this.results.delete(this.nextToDeliver),w(e.length<=this.payloadSize,473),this.nextToDeliver+=e.length,this.responseCallback(e)}this.working&&(this.requestsInFlight===0?(w(this.results.size===0,263),this.done()):this.to!==void 0&&this.nextToDeliver>=this.to&&(w(!this.knewTo,264),this.done()))}getNextChunk(){if(!this.working)return;let e=this.latestRequested;if(!(this.to!==void 0&&this.to<=e))return this.latestRequested+=this.payloadSize,this.to!==void 0&&(this.latestRequested=Math.min(this.to,this.latestRequested)),w(e<this.latestRequested,265),{from:e,to:this.latestRequested}}addRequest(){let e=this.getNextChunk();e!==void 0&&this.addRequestCore(e.from,e.to).catch(this.fail.bind(this))}addRequestCore(e,t){return v(this,null,function*(){w(this.working,266);let r=e,i=t;for(this.requestsInFlight++;this.working;){let o=i-r;w(o>0,267),this.to!==void 0&&(w(r<this.to,268),w(i<=this.to,269)),this.requests++;let s=this.requestCallback(this.requests,r,i,this.to!==void 0,{});this.dispatch();let{payload:a,cancel:c,partial:l}=yield s;if(c&&this.cancel(),this.to!==void 0&&r>=this.to){w(!this.knewTo,270),a.length!==0&&this.logger.sendErrorEvent({eventName:"ParallelRequests_GotExtra",from:r,to:i,end:this.to,length:a.length});break}if(this.working){let h=r,u=a.length,d=o<=u;if(u!==0){o<u&&this.logger.sendTelemetryEvent({eventName:"ParallelRequests_Over",from:r,to:i,length:u});let p=a.splice(0,o);this.results.set(r,p),r+=p.length}else w(!l,271),w(!this.knewTo,272);if(!l&&!d){if(!this.knewTo){(this.to===void 0||this.to>r)&&(this.to=r);break}this.logger.sendPerformanceEvent({eventName:"ParallelRequests_Partial",from:h,to:i,length:u})}if(i===this.latestRequested&&(a.length!==0&&(this.results.set(r,a),r+=a.length),this.latestRequested=r,d=!0),d){let p=this.getNextChunk();if(p===void 0)break;r=p.from,i=p.to}}}this.requestsInFlight--,this.dispatch()})}},Mv=class{constructor(){this.queue=[],this.done=!1}pushValue(e){this.pushCore(Promise.resolve({done:!1,value:e}))}pushError(e){this.pushCore(Promise.reject(e)),this.done=!0}pushDone(){this.pushCore(Promise.resolve({done:!0})),this.done=!0}pushCore(e){w(!this.done,274),this.deferred?(w(this.queue.length===0,275),this.deferred.resolve(e),this.deferred=void 0):this.queue.push(e)}read(){return v(this,null,function*(){w(this.deferred===void 0,276);let e=this.queue.shift();return e!==void 0?e:(w(!this.done,277),this.deferred=new Se,this.deferred.promise)})}};function xj(n,e,t,r,i,o){return v(this,null,function*(){let s,a=0,c=[],l={partial:!1,cancel:!0,payload:[]};for(;i?.aborted!==!0;){a++;let h=Math.min(vj,bj*Math.pow(2,a)),u=de.now();try{let d=n(Object.assign(Object.assign({},e),{retry:a})),{messages:p,partialResult:m}=yield d;if(c.push(...p),p.length!==0||!t)return{payload:c,cancel:!1,partial:m};if(s===void 0)s=de.now();else if(de.now()-s>3e4)throw Ar("Failed to retrieve ops from storage (Too Many Retries)",{canRetry:!1},Object.assign({retry:a,driverVersion:Eu},e))}catch(d){let p=kr(d);s=void 0;let m=_o(d);if(Ic(r,Object.assign(Object.assign({eventName:"GetDeltas_Error"},e),{retry:a,duration:de.now()-u,retryAfter:m,reason:o}),d),!p)throw d;m!==void 0&&m>=0&&(h=m)}yield Rc(h)}return l})}function eE(n,e,t,r,i,o,s,a){let c=0,l,h=0,u=new Mv,d={fromTotal:t,toTotal:r},p=le.start(o,Object.assign(Object.assign({eventName:"GetDeltas"},d),{reason:a})),m=new Ov(t,r,i,o,(x,b,_,O,S)=>v(this,null,function*(){return c++,xj(E=>v(this,null,function*(){return n(b,_,E)}),Object.assign(Object.assign({request:x,from:b,to:_},d),S),O,o,s,a)}),x=>{l===void 0?w(x[0].sequenceNumber===t,621):w(x[0].sequenceNumber===l+1,622),l=x[x.length-1].sequenceNumber,w(l-x[0].sequenceNumber+1===x.length,623),h+=x.length,u.pushValue(x)}),g=x=>{m.cancel()};return s!==void 0&&s.addEventListener("abort",g),m.run(e).finally(()=>{s!==void 0&&s.removeEventListener("abort",g)}).then(()=>{let x={lastFetch:l,length:h,requests:c};m.canceled?p.cancel(Object.assign(Object.assign({},x),{error:"ops request cancelled by client"})):(w(r===void 0||l!==void 0&&l>=r-1,624),p.end(x)),u.pushDone()}).catch(x=>{p.cancel({lastFetch:l,length:h,requests:c},x),u.pushError(x)}),u}var tE={read:()=>v(void 0,null,function*(){return{done:!0}})};var Au=class extends bi{constructor(){super(...arguments),this.prefetchCache=new Map,this.prefetchEnabled=!0}get policies(){let e=this.internalStorageService.policies;if(e)return Object.assign(Object.assign({},e),{caching:Ei.NoCaching})}getSnapshotTree(e){return v(this,null,function*(){let t=this.internalStorageService.getSnapshotTree(e);return this.prefetchEnabled&&t.then(r=>{r!=null&&this.prefetchTree(r)}),t})}readBlob(e){return v(this,null,function*(){return this.cachedRead(e)})}stopPrefetch(){this.prefetchEnabled=!1,this.prefetchCache.clear()}cachedRead(e){return v(this,null,function*(){if(this.prefetchEnabled){let t=this.prefetchCache.get(e);if(t!==void 0)return t;let r=this.internalStorageService.readBlob(e);return this.prefetchCache.set(e,r.catch(i=>{throw kr(i)&&this.prefetchCache.delete(e),i})),r}return this.internalStorageService.readBlob(e)})}prefetchTree(e){let t=[];this.prefetchTreeCore(e,t);for(let r of t)this.cachedRead(r)}prefetchTreeCore(e,t){for(let r of Object.keys(e.blobs)){let i=e.blobs[r];r.startsWith(".")||r==="header"||r.startsWith("quorum")?i!==null&&this.cachedRead(i):r.startsWith("deltas")||i!==null&&t.push(i)}for(let r of Object.keys(e.trees))this.prefetchTreeCore(e.trees[r],t)}};Y();var Ii=class{constructor(e){this.maxRequests=e,this.tasks=[],this.release=()=>{let t=this.tasks.shift();if(t!==void 0)return t();this.maxRequests++},w(e>0,174)}get waitQueueLength(){return this.tasks.length}acquire(){return v(this,null,function*(){if(this.maxRequests>0){this.maxRequests--;return}return new Promise(e=>{this.tasks.push(e)})})}schedule(e){return v(this,null,function*(){return yield this.acquire(),e().finally(this.release)})}};Y();function Ns(n,e,t,r){return v(this,null,function*(){var i,o;let s,a=!1,c=1e3,l=0,h=de.now(),u;do try{s=yield n(r.cancel),a=!0}catch(d){if(!kr(d))throw t.sendTelemetryEvent({eventName:`${e}_cancel`,retry:l,duration:de.now()-h,fetchCallName:e},d),d;if(((i=r.cancel)===null||i===void 0?void 0:i.aborted)===!0)throw t.sendTelemetryEvent({eventName:`${e}_runWithRetryAborted`,retry:l,duration:de.now()-h,fetchCallName:e},d),new Wr("runWithRetry was Aborted",Xt.genericError,{driverVersion:Eu,fetchCallName:e});l++,u=d,c=(o=_o(d))!==null&&o!==void 0?o:Math.min(c*2,8e3),r.onRetry&&r.onRetry(c,d),yield oc(c)}while(!a);return l>0&&t.sendTelemetryEvent({eventName:`${e}_lastError`,retry:l,duration:de.now()-h,fetchCallName:e},u),s})}Y();var Sv=class{constructor(e){this.props=e,this.attachmentCounter=0,this.summaryTree={}}get summary(){var e;return{type:xi.Tree,tree:Object.assign({},this.summaryTree),unreferenced:(e=this.props)===null||e===void 0?void 0:e.unreferenced}}addBlob(e,t){this.summaryTree[e]={type:xi.Blob,content:t}}addHandle(e,t,r){this.summaryTree[e]={type:xi.Handle,handleType:t,handle:r}}addTree(e,t){this.summaryTree[e]=t}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:xi.Attachment}}};function Ev(n,e){let t=new Sv({unreferenced:n.unreferenced});for(let[r,i]of Object.entries(n.blobs)){let o=e.get(i);w(o!==void 0,733),t.addBlob(r,Kt.from(o).toString("utf-8"))}for(let[r,i]of Object.entries(n.trees)){let o=Ev(i,e);t.addTree(r,o)}return t.summary}function nE(n){if(Ri(n))return!0;switch(n.type){case lo.Propose:case lo.Reject:case lo.NoOp:return!0;default:return!1}}function Ri(n){return n.type===lo.Operation||n.type===lo.Summarize}var rE=function(n){return n.FluidDataStoreOp="component",n.Attach="attach",n.ChunkedOp="chunkedOp",n.BlobAttach="blobAttach",n.Rejoin="rejoin",n.Alias="alias",n.Operation="op",n}(rE||{});function yo(n){return!!Object.values(rE).includes(n.type)}bt();Y();Vt();Y();Pe();Vt();Pe();var xn=class extends Be{constructor(e,t,r){super(e,r,new Set(["error"])),this.error=t,this.errorType=qi.genericError}},Hu=class n extends Be{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=qi.throttlingError}static wrap(e,t,r){return bc(e,o=>new n(o,t),r)}},ye=class extends Be{constructor(e){super(e,{usageError:!0}),this.errorType="usageError"}},Uu=class extends Be{constructor(e,t){super(e,{timeoutMs:t}),this.expiryMs=t,this.errorType=qi.clientSessionExpiredError}},Jt=class extends Be{constructor(e,t){super(e,Object.assign(Object.assign({},t),{dataProcessingError:1})),this.errorType=qi.dataCorruptionError,this.canRetry=!1}},Ot=class n extends Be{constructor(e){super(e),this.errorType=qi.dataProcessingError,this.canRetry=!1}static create(e,t,r,i={}){let o=n.wrapIfUnrecognized(e,t,r);return o.addTelemetryProperties(i),o}static wrapIfUnrecognized(e,t,r){let i=Object.assign({dataProcessingError:1,dataProcessingCodepath:t},r===void 0?void 0:fr(r)),o=an(e,{props:i});if(!Ud(o))return o;let s=wi(o,a=>new n(a));return s.addTelemetryProperties(o.getTelemetryProperties()),s}},fr=n=>({messageClientId:n.clientId,messageSequenceNumber:n.sequenceNumber,messageClientSequenceNumber:n.clientSequenceNumber,messageReferenceSequenceNumber:n.referenceSequenceNumber,messageMinimumSequenceNumber:n.minimumSequenceNumber,messageTimestamp:n.timestamp});var dt=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(dt||{});var Fr=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Fr||{});var gr=Ce(qn());bt();Vs();qt();Vt();bt();var Gu=class{constructor(e,t,r){this.path=e,this.runtime=t,this.routeContext=r,this.absolutePath=ur(e,this.routeContext)}get IFluidHandleContext(){return this}attachGraph(){throw new Error("can't attach container runtime form within container!")}get isAttached(){return this.runtime.attachState!==oe.Detached}resolveHandle(e){return v(this,null,function*(){return this.runtime.resolveHandle(e)})}};var Kr=class{constructor(e){this.map=new Map;for(let t of e){if(this.map.has(t[0]))throw new ye("Duplicate entry names exist");this.map.set(t[0],t[1])}}get IFluidDataStoreRegistry(){return this}get(e){return v(this,null,function*(){if(this.map.has(e))return this.map.get(e)})}};var oA=Ce(fi());Y();Vt();bt();Pe();Y();var Qt="summarizer",Wu=(()=>{class n extends we{constructor(t,r,i,o,s){super(),this.logger=t,this.summaryCollection=r,this.clientElection=i,this.maxOpsSinceLastSummary=o,this.electionEnabled=s,this.lastReportedSeq=0,this.summaryCollection.on("default",({sequenceNumber:a})=>{var c,l,h;let u=this.electedClientId;if(u===void 0){this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(a);return}let d=this.clientElection.electionSequenceNumber;if(a-((c=this.lastSummaryAckSeqForClient)!==null&&c!==void 0?c:d)>this.maxOpsSinceLastSummary){let m=a-this.lastReportedSeq;if(m>this.maxOpsSinceLastSummary&&(this.logger.sendErrorEvent({eventName:"ElectedClientNotSummarizing",electedClientId:u,lastSummaryAckSeqForClient:this.lastSummaryAckSeqForClient,electionSequenceNumber:d,nextElectedClientId:(l=this.clientElection.peekNextElectedClient())===null||l===void 0?void 0:l.clientId,electionEnabled:this.electionEnabled}),this.lastReportedSeq=a),this.electionEnabled){let g=this.electedParentId;this.clientElection.incrementElectedClient(a),d=this.clientElection.electionSequenceNumber,a>((h=this.lastSummaryAckSeqForClient)!==null&&h!==void 0?h:d)&&m>this.maxOpsSinceLastSummary&&this.logger.sendErrorEvent({eventName:"UnexpectedElectionSequenceNumber",lastSummaryAckSeqForClient:this.lastSummaryAckSeqForClient,electionSequenceNumber:d,sequenceNumber:a,previousClientId:u,previousParentId:g,electedParentId:this.electedParentId,electedClientId:this.electedClientId,opsSinceLastReport:m,maxOpsSinceLastSummary:o})}}}),this.summaryCollection.on(dt.SummaryAck,a=>{this.lastSummaryAckSeqForClient=a.sequenceNumber}),this.clientElection.on("election",(a,c)=>{this.lastSummaryAckSeqForClient=void 0,a===void 0&&this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(c),this.emit("electedSummarizerChanged")})}get electedClientId(){var t;return(t=this.clientElection.electedClient)===null||t===void 0?void 0:t.clientId}get electedParentId(){var t;return(t=this.clientElection.electedParent)===null||t===void 0?void 0:t.clientId}serialize(){var t;let{electedClientId:r,electedParentId:i,electionSequenceNumber:o}=this.clientElection.serialize();return{electedClientId:r,electedParentId:i,electionSequenceNumber:(t=this.lastSummaryAckSeqForClient)!==null&&t!==void 0?t:o}}static isClientEligible(t){let r=t.client.details;return r===void 0?!0:n.clientDetailsPermitElection(r)}}return n.clientDetailsPermitElection=e=>e.capabilities.interactive||e.type===Qt,n})();Vt();Y();Pe();var Vv=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Vv||{});var kn=Ce(qn());bt();Vs();qt();bt();Y();var Ku=class{constructor(e,t,r,i,o){this.objectId=e,this._connected=t,this.submit=r,this.dirty=i,this.addedGCOutboundReference=o}get handler(){return w(!!this._handler,375),this._handler}get connected(){return this._connected}attach(e){w(this._handler===void 0,376),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}process(e,t,r){try{this.handler.process(e,t,r)}catch(i){throw Ot.wrapIfUnrecognized(i,"channelDeltaConnectionFailedToProcessMessage",e)}}reSubmit(e,t){this.handler.reSubmit(e,t)}rollback(e,t){if(this.handler.rollback===void 0)throw new Error("Handler doesn't support rollback");this.handler.rollback(e,t)}applyStashedOp(e){return this.handler.applyStashedOp(e)}};bt();var $u=class n{constructor(e,t,r,i){this.tree=e,this.storage=t,this.logger=r,this.extraBlobs=i,this.flattenedTree={},e!==void 0&&n.flattenTree("",e,this.flattenedTree)}static flattenTree(e,t,r){for(let i in t.trees)n.flattenTree(`${e}${i}/`,t.trees[i],r);for(let i in t.blobs)r[`${e}${i}`]=t.blobs[i]}contains(e){return v(this,null,function*(){return this.flattenedTree[e]!==void 0})}readBlob(e){return v(this,null,function*(){let t=yield this.getIdForPath(e),r=this.extraBlobs!==void 0?this.extraBlobs.get(t):void 0;if(r!==void 0)return r;let i=this.storage.readBlob(t);return i.catch(o=>this.logger.sendErrorEvent({eventName:"ChannelStorageBlobError"},o)),i})}list(e){return v(this,null,function*(){var t;let r=this.tree,i=Tu(e);for(;r!==void 0&&i.length>0;){let o=i.shift();r=r.trees[o]}if(r===void 0||i.length!==0)throw new Error("path does not exist");return Object.keys((t=r?.blobs)!==null&&t!==void 0?t:{})})}getIdForPath(e){return v(this,null,function*(){return this.flattenedTree[e]})}};var Gc=".attributes";function Wc(n,e,t,r,i,o,s,a,c){let l=new Ku(n,e,(u,d)=>t(u,d),r,i),h=new $u(a,o,s,c);return{deltaConnection:l,objectStorage:h}}function Xu(n,e=!1,t=!1,r){let i=n.getAttachSummary(e,t,r);return En(i,Gc,JSON.stringify(n.attributes)),i}function Ju(n,e=!1,t=!1,r){return v(this,null,function*(){let i=yield n.summarize(e,t,r);return En(i,Gc,JSON.stringify(n.attributes)),i})}var eA=Ce(Td());Y();var Us=class{constructor(e,t,r,i){this.id=e,this.registry=t,this.runtime=r,this.servicesGetter=i,this.globallyVisible=!1,this.pending=[],w(!this.id.includes("/"),783)}getChannel(){return v(this,null,function*(){return w(this.channel!==void 0,519),this.channel})}get isLoaded(){return this.channel!==void 0}setConnectionState(e,t){this.globallyVisible&&this.isLoaded&&this.servicesGetter().value.deltaConnection.setConnectionState(e)}processOp(e,t,r){w(this.globallyVisible,723),this.isLoaded?this.servicesGetter().value.deltaConnection.process(e,t,r):(w(t===!1,393),this.pending.push(e))}reSubmit(e,t){w(this.isLoaded,394),w(this.globallyVisible,724),this.servicesGetter().value.deltaConnection.reSubmit(e,t)}rollback(e,t){w(this.isLoaded,750),w(this.globallyVisible,751),this.servicesGetter().value.deltaConnection.rollback(e,t)}applyStashedOp(){throw new Error("no stashed ops on local channel")}summarize(e=!1,t=!1,r){return v(this,null,function*(){return w(this.isLoaded&&this.channel!==void 0,396),Ju(this.channel,e,t,r)})}getAttachSummary(e){return w(this.isLoaded&&this.channel!==void 0,397),Xu(this.channel,!0,!1,e)}makeVisible(){if(this.globallyVisible)throw new Error("Channel is already globally visible");this.isLoaded&&(w(!!this.channel,402),this.channel.connect(this.servicesGetter().value)),this.globallyVisible=!0}getGCData(e=!1){return v(this,null,function*(){return w(this.isLoaded&&this.channel!==void 0,403),this.channel.getGCData(e)})}updateUsedRoutes(e,t){}},Qu=class extends Us{constructor(e,t,r,i,o,s,a,c,l,h){super(e,t,r,()=>this.services),this.snapshotTree=h;let u=new Map,d=(0,eA.default)(this.snapshotTree);this.isSnapshotInOldFormatAndCollectBlobs(d,u)&&this.sanitizeSnapshot(d),this.services=new On(()=>Wc(this.id,i.connected,a,this.dirtyFn,l,o,s,d,u)),this.dirtyFn=()=>{c(e)}}getChannel(){return v(this,null,function*(){return this.channel===void 0&&(this.channel=yield this.loadChannel().catch(e=>{throw Ot.wrapIfUnrecognized(e,"rehydratedLocalChannelContextFailedToLoadChannel",void 0)})),this.channel})}loadChannel(){return v(this,null,function*(){w(!this.isLoaded,398),w(yield this.services.value.objectStorage.contains(".attributes"),400);let e=yield et(this.services.value.objectStorage,".attributes");if(w(this.factory===void 0,520),this.factory=this.registry.get(e.type),this.factory===void 0)throw new Error(`Channel Factory ${e.type} not registered`);let t=yield this.factory.load(this.runtime,this.id,this.services.value,e);this.channel=t;for(let r of this.pending)this.services.value.deltaConnection.process(r,!1,void 0);return this.channel})}isSnapshotInOldFormatAndCollectBlobs(e,t){let r=!1,i=e.blobsContents;Object.entries(i).forEach(([o,s])=>{t.set(o,s),e.blobs[o]!==void 0&&(r=!0)});for(let o of Object.values(e.trees))r=r||this.isSnapshotInOldFormatAndCollectBlobs(o,t);return r}sanitizeSnapshot(e){let t=new Map(Object.entries(e.blobs));for(let[r,i]of t.entries())t.get(i)===void 0&&delete e.blobs[r];for(let r of Object.values(e.trees))this.sanitizeSnapshot(r)}},Yu=class extends Us{constructor(e,t,r,i,o,s,a,c,l,h){if(super(e,t,i,()=>this.services),w(r!==void 0,521),this.factory=t.get(r),this.factory===void 0)throw new Error(`Channel Factory ${r} not registered`);this.channel=this.factory.create(i,e),this.services=new On(()=>Wc(this.id,o.connected,c,this.dirtyFn,h,s,a)),this.dirtyFn=()=>{l(e)}}};Y();Pe();var Hv=(()=>{class n{constructor(t,r,i,o,s,a,c,l,h,u,d,p,m){this.runtime=t,this.dataStoreContext=r,this.id=c,this.registry=h,this.attachMessageType=m,this.isLoaded=!1,this.pending=[],w(!this.id.includes("/"),784),this.subLogger=ue.create(this.runtime.logger,"RemoteChannelContext"),this.services=Wc(this.id,this.dataStoreContext.connected,o,()=>s(this.id),a,i,this.subLogger,l,u);let g=(x,b,_)=>v(this,null,function*(){return this.summarizeInternal(x,b,_)});this.summarizerNode=d(g,x=>v(this,null,function*(){return this.getGCDataInternal(x)}),()=>v(this,null,function*(){return p()})),this.thresholdOpsCounter=new fo(n.pendingOpsCountThreshold,this.subLogger)}getChannel(){return this.channelP===void 0&&(this.channelP=this.loadChannel()),this.channelP}setConnectionState(t,r){this.isLoaded&&this.services.deltaConnection.setConnectionState(t)}applyStashedOp(t){return w(this.isLoaded,404),this.services.deltaConnection.applyStashedOp(t)}processOp(t,r,i){this.summarizerNode.invalidate(t.sequenceNumber),this.isLoaded?this.services.deltaConnection.process(t,r,i):(w(!r,405),w(this.pending!==void 0,574),this.pending.push(t),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length))}reSubmit(t,r){w(this.isLoaded,406),this.services.deltaConnection.reSubmit(t,r)}rollback(t,r){w(this.isLoaded,752),this.services.deltaConnection.rollback(t,r)}summarize(t=!1,r=!0,i){return v(this,null,function*(){return this.summarizerNode.summarize(t,r,i)})}summarizeInternal(t,r,i){return v(this,null,function*(){let o=yield this.getChannel(),s=yield Ju(o,t,r,i);return Object.assign(Object.assign({},s),{id:this.id})})}loadChannel(){return v(this,null,function*(){w(!this.isLoaded,407);let t;(yield this.services.objectStorage.contains(Gc))&&(t=yield et(this.services.objectStorage,Gc));let r;if(t===void 0){if(this.attachMessageType===void 0)throw new Jt("channelTypeNotAvailable",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/")});if(r=this.registry.get(this.attachMessageType),r===void 0)throw new Jt("channelFactoryNotRegisteredForAttachMessageType",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:this.attachMessageType});t=r.attributes}else if(r=this.registry.get(t.type),r===void 0)throw new Jt("channelFactoryNotRegisteredForGivenType",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:t.type});t.snapshotFormatVersion!==void 0&&t.snapshotFormatVersion!==r.attributes.snapshotFormatVersion&&this.subLogger.sendTelemetryEvent({eventName:"ChannelAttributesVersionMismatch",channelType:{value:t.type,tag:Ne.PackageData},channelSnapshotVersion:{value:`${t.snapshotFormatVersion}@${t.packageVersion}`,tag:Ne.PackageData},channelCodeVersion:{value:`${r.attributes.snapshotFormatVersion}@${r.attributes.packageVersion}`,tag:Ne.PackageData}});let i=yield r.load(this.runtime,this.id,this.services,t);w(this.pending!==void 0,575);for(let o of this.pending)this.services.deltaConnection.process(o,!1,void 0);return this.thresholdOpsCounter.send("ProcessPendingOps",this.pending.length),this.channel=i,this.pending=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(this.dataStoreContext.connected),this.channel})}getGCData(t=!1){return v(this,null,function*(){return this.summarizerNode.getGCData(t)})}getGCDataInternal(t=!1){return v(this,null,function*(){return(yield this.getChannel()).getGCData(t)})}updateUsedRoutes(t,r){this.summarizerNode.updateUsedRoutes([""])}}return n.pendingOpsCountThreshold=1e3,n})();var ji=function(n){return n.Attach="attach",n.ChannelOp="op",n}(ji||{}),Po=class n extends we{constructor(e,t,r){super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this._disposed=!1,this.contexts=new Map,this.contextsDeferred=new Map,this.pendingAttach=new Map,this.deferredAttached=new Se,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.pendingHandlesToMakeVisible=new Set,w(!e.id.includes("/"),782),this.logger=ue.create(e.logger,"FluidDataStoreRuntime",{all:{dataStoreId:ke()}}),this.id=e.id,this.options=e.options,this.deltaManager=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();let i=e.baseSnapshot;this.channelsBaseGCDetails=new Lt(()=>v(this,null,function*(){var o,s,a;let c=yield(a=(s=(o=this.dataStoreContext).getBaseGCDetails)===null||s===void 0?void 0:s.call(o))!==null&&a!==void 0?a:this.dataStoreContext.getInitialGCSummaryDetails();return Lu(c)})),i?.trees!==void 0&&Object.keys(i.trees).forEach(o=>{if(o==="_search")return;let s;e.isLocalDataStore?(s=new Qu(o,this.sharedObjectRegistry,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(c,l)=>this.submitChannelOp(o,c,l),c=>this.setChannelDirty(c),(c,l)=>this.addedGCOutboundReference(c,l),i.trees[o]),e.attachState!==oe.Detached?s.makeVisible():this.localChannelContextQueue.set(o,s)):s=new Hv(this,e,e.storage,(c,l)=>this.submitChannelOp(o,c,l),c=>this.setChannelDirty(c),(c,l)=>this.addedGCOutboundReference(c,l),o,i.trees[o],this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(o,{type:kn.CreateSummarizerNodeSource.FromSummary}),()=>v(this,null,function*(){return this.getChannelBaseGCDetails(o)}));let a=new Se;a.resolve(s),this.contexts.set(o,s),this.contextsDeferred.set(o,a)}),this.attachListener(),this.bindState=r?bn.Bound:bn.NotBound,this._attachState=e.attachState,r?this.visibilityState=e.attachState===oe.Detached?kn.VisibilityState.LocallyVisible:kn.VisibilityState.GloballyVisible:this.visibilityState=kn.VisibilityState.NotVisible,r&&this.deferredAttached.resolve()}static load(e,t,r){return new n(e,t,r)}get IFluidRouter(){return this}get connected(){return this.dataStoreContext.connected}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.clientDetails}get isAttached(){return this.attachState!==oe.Detached}get attachState(){return this._attachState}get absolutePath(){return ur(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.IFluidHandleContext}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}resolveHandle(e){return v(this,null,function*(){return this.request(e)})}request(e){return v(this,null,function*(){try{let t=Sn.create(e),r=t.pathParts[0];if(r==="_channels"||r==="_custom")return this.request(t.createSubRequest(1));if(this.contextsDeferred.has(r)&&t.isLeaf(1))try{return{mimeType:"fluid/object",status:200,value:yield(yield this.contextsDeferred.get(r).promise).getChannel()}}catch(i){return this.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},i),ku(500,`Failed to get Channel: ${i}`,e)}return zt(e)}catch(t){return Ni(t)}})}getChannel(e){return v(this,null,function*(){return this.verifyNotClosed(),this.contextsDeferred.has(e)||this.contextsDeferred.set(e,new Se),yield(yield this.contextsDeferred.get(e).promise).getChannel()})}createChannel(e=ke(),t){if(e.includes("/"))throw new ye(`Id cannot contain slashes: ${e}`);this.verifyNotClosed(),w(!this.contexts.has(e),377),this.notBoundedChannelContextSet.add(e);let r=new Yu(e,this.sharedObjectRegistry,t,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(i,o)=>this.submitChannelOp(e,i,o),i=>this.setChannelDirty(i),(i,o)=>this.addedGCOutboundReference(i,o));if(this.contexts.set(e,r),this.contextsDeferred.has(e))this.contextsDeferred.get(e).resolve(r);else{let i=new Se;i.resolve(r),this.contextsDeferred.set(e,i)}return w(!!r.channel,378),r.channel}bindChannel(e){if(w(this.notBoundedChannelContextSet.has(e.id),379),this.notBoundedChannelContextSet.delete(e.id),this.isAttached){this.attachChannel(e);return}this.pendingHandlesToMakeVisible.has(e.handle)||(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}makeVisibleAndAttachGraph(){this.visibilityState===kn.VisibilityState.NotVisible&&(this.visibilityState=kn.VisibilityState.LocallyVisible,this.pendingHandlesToMakeVisible.forEach(e=>{e.attachGraph()}),this.pendingHandlesToMakeVisible.clear(),this.bindToContext())}attachGraph(){this.makeVisibleAndAttachGraph()}bindToContext(){this.bindState===bn.NotBound&&(this.bindState=bn.Binding,this.dataStoreContext.bindToContext(),this.bindState=bn.Bound)}bind(e){if(this.visibilityState!==kn.VisibilityState.NotVisible){e.attachGraph();return}this.pendingHandlesToMakeVisible.add(e)}setConnectionState(e,t){this.verifyNotClosed();for(let[,r]of this.contexts)r.setConnectionState(e,t);po(this.logger,this,e,t)}getQuorum(){return this.quorum}getAudience(){return this.audience}uploadBlob(e){return v(this,null,function*(){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e)})}process(e,t,r){this.verifyNotClosed();try{switch(e.type){case ji.Attach:{let i=e.contents,o=i.id;if(t)w(this.pendingAttach.has(o),380),this.pendingAttach.delete(o);else{w(!this.contexts.has(o),381);let s=new Map,a=tu(i.snapshot.entries,s),c=new Hv(this,this.dataStoreContext,this.dataStoreContext.storage,(l,h)=>this.submitChannelOp(o,l,h),l=>this.setChannelDirty(l),(l,h)=>this.addedGCOutboundReference(l,h),o,a,this.sharedObjectRegistry,s,this.dataStoreContext.getCreateChildSummarizerNodeFn(o,{type:kn.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:i.snapshot}),()=>v(this,null,function*(){return this.getChannelBaseGCDetails(o)}),i.type);if(this.contexts.set(o,c),this.contextsDeferred.has(o))this.contextsDeferred.get(o).resolve(c);else{let l=new Se;l.resolve(c),this.contextsDeferred.set(o,l)}}break}case ji.ChannelOp:this.processChannelOp(e,t,r);break;default:}this.emit("op",e)}catch(i){throw Ot.wrapIfUnrecognized(i,"fluidDataStoreRuntimeFailedToProcessMessage",e)}}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}getOutboundRoutes(){let e=[];for(let[t]of this.contexts)e.push(`${this.absolutePath}/${t}`);return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}getGCData(e=!1){return v(this,null,function*(){let t=new Li;return yield Promise.all(Array.from(this.contexts).filter(([r,i])=>this.isChannelAttached(r)).map(o=>v(this,[o],function*([r,i]){let s=yield i.getGCData(e);t.prefixAndAddNodes(r,s.gcNodes)}))),this.updateGCNodes(t),t.getGCData()})}updateUsedRoutes(e,t){var r;let i=qu(e);for(let[o]of i)w(this.contexts.has(o),382);for(let[o,s]of this.contexts)s.updateUsedRoutes((r=i.get(o))!==null&&r!==void 0?r:[],t)}addedGCOutboundReference(e,t){var r,i;(i=(r=this.dataStoreContext).addedGCOutboundReference)===null||i===void 0||i.call(r,e,t)}getChannelBaseGCDetails(e){return v(this,null,function*(){var t;let r=(yield this.channelsBaseGCDetails).get(e);return r===void 0?r={}:((t=r.gcData)===null||t===void 0?void 0:t.gcNodes)!==void 0&&NE(r.gcData.gcNodes,this.absolutePath),(r.usedRoutes===void 0||r.usedRoutes.length===0)&&(r.usedRoutes=[""]),r})}summarize(e=!1,t=!0,r){return v(this,null,function*(){let i=new Pt;return yield Promise.all(Array.from(this.contexts).filter(([o,s])=>{let a=this.isChannelAttached(o);return w(a,383),a}).map(a=>v(this,[a],function*([o,s]){let c=yield s.summarize(e,t,r);i.addWithStats(o,c)}))),i.getSummaryTree()})}getAttachSummary(e){this.attachGraph();let t=new Pt;for(let[r,i]of this.contexts){if(!(i instanceof Us))throw new Be("Should only be called with local channel handles");if(!this.notBoundedChannelContextSet.has(r)){let o;if(i.isLoaded){let s=i.getAttachSummary(e);w(s.summary.type===Vv.Tree,384),o={stats:s.stats,summary:s.summary}}else w(!!this.dataStoreContext.baseSnapshot,385),o=qs(this.dataStoreContext.baseSnapshot.trees[r]);t.addWithStats(r,o)}}return t.getSummaryTree()}submitMessage(e,t,r){this.submit(e,t,r)}submitSignal(e,t){return this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t)}waitAttached(){return v(this,null,function*(){return this.deferredAttached.promise})}attachChannel(e){if(this.verifyNotClosed(),e.handle.isAttached)return;e.handle.attachGraph(),w(this.isAttached,386),w(this.visibilityState===kn.VisibilityState.GloballyVisible,720);let t=Xu(e,!0,!1),r=js(t.summary),i={id:e.id,snapshot:r,type:e.attributes.type};this.pendingAttach.set(e.id,i),this.submit(ji.Attach,i),this.contexts.get(e.id).makeVisible()}submitChannelOp(e,t,r){let i={address:e,contents:t};this.submit(ji.ChannelOp,i,r)}submit(e,t,r=void 0){this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,r)}reSubmit(e,t,r){switch(this.verifyNotClosed(),e){case ji.ChannelOp:{let i=t,o=this.contexts.get(i.address);w(!!o,387),o.reSubmit(i.contents,r);break}case ji.Attach:this.submit(e,t,r);break;default:vt(e)}}rollback(e,t,r){switch(this.verifyNotClosed(),e){case ji.ChannelOp:{let i=t,o=this.contexts.get(i.address);w(!!o,749),o.rollback(i.contents,r);break}default:throw new Be(`Can't rollback ${e} message`)}}applyStashedOp(e){return v(this,null,function*(){let t=e,r=this.contexts.get(t.address);return w(!!r,388),yield r.getChannel(),r.applyStashedOp(t.contents)})}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}processChannelOp(e,t,r){this.verifyNotClosed();let i=e.contents,o=Object.assign(Object.assign({},e),{contents:i.contents}),s=this.contexts.get(i.address);return w(!!s,389),s.processOp(o,t,r),s}attachListener(){this.setMaxListeners(Number.MAX_SAFE_INTEGER),this.dataStoreContext.once("attaching",()=>{this.attachGraph(),this._attachState=oe.Attaching,w(this.visibilityState===kn.VisibilityState.LocallyVisible,721),this.visibilityState=kn.VisibilityState.GloballyVisible,this.localChannelContextQueue.forEach(e=>{e.makeVisible()}),this.localChannelContextQueue.clear(),this.deferredAttached.resolve(),this.emit("attaching")}),this.dataStoreContext.once("attached",()=>{w(this.visibilityState===kn.VisibilityState.GloballyVisible,722),this._attachState=oe.Attached,this.emit("attached")})}verifyNotClosed(){if(this._disposed)throw new Be("Runtime is closed")}},tA=(n,e=Po)=>class nA extends e{request(r){return v(this,null,function*(){let i=yield tr(nA.prototype,this,"request").call(this,r);return i.status===404?n(r,this):i})}};bt();var Yn=class{constructor(e,t,r){this.value=e,this.path=t,this.routeContext=r,this.pendingHandlesToMakeVisible=new Set,this.locallyVisible=!1,this.absolutePath=ur(t,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return this.routeContext.isAttached}get visible(){return this.isAttached||this.locallyVisible}get(){return v(this,null,function*(){return this.value})}attachGraph(){this.visible||(this.locallyVisible=!0,this.pendingHandlesToMakeVisible.forEach(e=>{e.attachGraph()}),this.pendingHandlesToMakeVisible.clear(),this.routeContext.attachGraph())}bind(e){if(this.visible){e.attachGraph();return}this.pendingHandlesToMakeVisible.add(e)}};var Zu=class extends Yn{get(){return v(this,null,function*(){throw Error("Do not try to get a summarizer object from the handle. Reference it directly.")})}attach(){}bind(e){}};Y();Pe();Y();var eh=class{constructor(e,t){this.lastOpSequenceNumber=e,this._lastAttempt=t,this._lastSuccessfulSummary=Object.assign({},t)}get lastAttempt(){return this._lastAttempt}get lastSuccessfulSummary(){return this._lastSuccessfulSummary}updateWithLastSummaryAckInfo(e){this._lastAttempt=e,this._lastSuccessfulSummary=Object.assign({},e)}recordAttempt(e){this._lastAttempt={refSequenceNumber:e??this.lastOpSequenceNumber,summaryTime:Date.now()}}markLastAttemptAsSuccessful(){this._lastSuccessfulSummary=Object.assign({},this.lastAttempt)}},th=class{constructor(e,t,r,i){this.heuristicData=e,this.configuration=t,this.trySummarize=r,this.logger=i,this.idleTimer=new fn(this.configuration.idleTime,()=>this.trySummarize("idle")),this.minOpsForLastSummaryAttempt=this.configuration.minOpsForLastSummaryAttempt}get opsSinceLastAck(){return this.heuristicData.lastOpSequenceNumber-this.heuristicData.lastSuccessfulSummary.refSequenceNumber}run(){let e=Date.now()-this.heuristicData.lastSuccessfulSummary.summaryTime,t=this.opsSinceLastAck;e>this.configuration.maxTime?(this.idleTimer.clear(),this.trySummarize("maxTime")):t>this.configuration.maxOps?(this.idleTimer.clear(),this.trySummarize("maxOps")):this.idleTimer.restart()}shouldRunLastSummary(){let e=this.opsSinceLastAck,t=this.minOpsForLastSummaryAttempt;return this.logger.sendTelemetryEvent({eventName:"ShouldRunLastSummary",opsSinceLastAck:e,minOpsForLastSummaryAttempt:t}),e>=t}dispose(){this.idleTimer.clear()}};Y();Pe();function nh(n,e,t){return v(this,null,function*(){let r=[n.then(i=>({result:"done",value:i})),e.then(({timerResult:i})=>({result:i}))];return t!==void 0&&r.push(t.waitCancelled.then(()=>({result:"cancelled"}))),Promise.race(r)})}var rA=2e4,Tj=5,iA={submitSummaryFailure:"Error while generating, uploading, or submitting summary",summaryOpWaitTimeout:"Timeout while waiting for summarize op broadcast",summaryAckWaitTimeout:"Timeout while waiting for summaryAck/summaryNack op",summaryNack:"Server rejected summary via summaryNack op",disconnect:"Summary cancelled due to summarizer or main client disconnect"},$r=class{constructor(){this.summarySubmitted=new Se,this.summaryOpBroadcasted=new Se,this.receivedSummaryAckOrNack=new Se}fail(e,t,r,i){w(!this.receivedSummaryAckOrNack.isCompleted,606);let o={success:!1,message:e,data:void 0,error:t,retryAfterSeconds:i};this.summarySubmitted.resolve(o),this.summaryOpBroadcasted.resolve(o),this.receivedSummaryAckOrNack.resolve(Object.assign(Object.assign({},o),{data:r}))}build(){return{summarySubmitted:this.summarySubmitted.promise,summaryOpBroadcasted:this.summaryOpBroadcasted.promise,receivedSummaryAckOrNack:this.receivedSummaryAckOrNack.promise}}},rh=class{constructor(e,t,r,i,o,s,a){this.pendingAckTimer=e,this.heuristicData=t,this.submitSummaryCallback=r,this.raiseSummarizingError=i,this.successfulSummaryCallback=o,this.summaryWatcher=s,this.logger=a,this.summarizeTimer=new fn(rA,()=>this.summarizeTimerHandler(rA,1))}summarize(e,t,r,i=new $r){return this.summarizeCore(e,t,i,r).catch(o=>{let s="UnexpectedSummarizeError";this.logger.sendErrorEvent(Object.assign({eventName:s},e),o),i.fail(s,o)}),i.build()}summarizeCore(e,t,r,i){return v(this,null,function*(){let{refreshLatestAck:o,fullTree:s}=t,a=ue.create(this.logger,void 0,{all:e}),c=Date.now()-this.heuristicData.lastAttempt.summaryTime,l=Date.now()-this.heuristicData.lastSuccessfulSummary.summaryTime,h={fullTree:s,timeSinceLastAttempt:c,timeSinceLastSummary:l},u=le.start(a,Object.assign({eventName:"Summarize",refreshLatestAck:o},h)),d=g=>`${g}: ${iA[g]}`,p=(g,x,b,_)=>{this.raiseSummarizingError(iA[g]);let O=Pv(x),S=i.cancelled||x?.errorType===Xt.offlineError?"generic":"error";u.cancel(Object.assign(Object.assign({},b),{reason:g,category:S,retryAfterSeconds:O}),x),r.fail(d(g),x,_,O)};this.summarizeTimer.start();let m;try{m=yield this.submitSummaryCallback({fullTree:s,refreshLatestAck:o,summaryLogger:a,cancellationToken:i});let g=m.referenceSequenceNumber,x=g-this.heuristicData.lastSuccessfulSummary.refSequenceNumber;if(h=Object.assign(Object.assign({},h),{referenceSequenceNumber:g,minimumSequenceNumber:m.minimumSequenceNumber,opsSinceLastAttempt:g-this.heuristicData.lastAttempt.refSequenceNumber,opsSinceLastSummary:x}),m.stage!=="base"&&(h=Object.assign(Object.assign(Object.assign({},h),m.summaryStats),{generateDuration:m.generateDuration}),m.stage!=="generate"&&(h=Object.assign(Object.assign({},h),{handle:m.handle,uploadDuration:m.uploadDuration}),m.stage!=="upload"&&(h=Object.assign(Object.assign({},h),{clientSequenceNumber:m.clientSequenceNumber})))),m.stage!=="submit")return p("submitSummaryFailure",m.error,h);if(!s&&!m.forcedFullTree){let{summarizedDataStoreCount:b,gcStateUpdatedDataStoreCount:_=0}=m.summaryStats;b>_+x&&a.sendErrorEvent({eventName:"IncrementalSummaryViolation",summarizedDataStoreCount:b,gcStateUpdatedDataStoreCount:_,opsSinceLastSummary:x})}u.reportEvent("generate",Object.assign({},h)),r.summarySubmitted.resolve({success:!0,data:m})}catch(g){return p("submitSummaryFailure",g)}finally{this.heuristicData.recordAttempt(m?.referenceSequenceNumber),this.summarizeTimer.clear()}try{let g=this.pendingAckTimer.start(),x=this.summaryWatcher.watchSummary(m.clientSequenceNumber),b=yield nh(x.waitBroadcast(),g,i);if(b.result==="cancelled")return p("disconnect");if(b.result!=="done")return p("summaryOpWaitTimeout");let _=b.value,O=Date.now()-this.heuristicData.lastAttempt.summaryTime;r.summaryOpBroadcasted.resolve({success:!0,data:{summarizeOp:_,broadcastDuration:O}}),this.heuristicData.lastAttempt.summarySequenceNumber=_.sequenceNumber,a.sendTelemetryEvent({eventName:"Summarize_Op",duration:O,referenceSequenceNumber:_.referenceSequenceNumber,summarySequenceNumber:_.sequenceNumber,handle:_.contents.handle});let S=yield nh(x.waitAckNack(),g,i);if(S.result==="cancelled")return p("disconnect");if(S.result!=="done")return p("summaryAckWaitTimeout");let E=S.value;this.pendingAckTimer.clear();let D=Date.now()-this.heuristicData.lastAttempt.summaryTime;if(h=Object.assign({ackWaitDuration:D,ackNackSequenceNumber:E.sequenceNumber,summarySequenceNumber:E.contents.summaryProposal.summarySequenceNumber},h),E.type===dt.SummaryAck)this.heuristicData.markLastAttemptAsSuccessful(),this.successfulSummaryCallback(),u.end(Object.assign(Object.assign({},h),{handle:E.contents.handle})),r.receivedSummaryAckOrNack.resolve({success:!0,data:{summaryAckOp:E,ackNackDuration:D}});else{w(E.type===dt.SummaryNack,628);let I=E.contents,y=I?.message,P=I?.retryAfter,C=new Be(`Received summaryNack: ${y}`,{retryAfterSeconds:P});return w(Pv(C)===P,607),p("summaryNack",C,Object.assign(Object.assign({},h),{nackRetryAfter:P}),{summaryNackOp:E,ackNackDuration:D})}}finally{this.pendingAckTimer.clear()}})}summarizeTimerHandler(e,t){if(this.logger.sendPerformanceEvent({eventName:"SummarizeTimeout",timeoutTime:e,timeoutCount:t}),t<Tj){let r=e*2;this.summarizeTimer.start(r,()=>this.summarizeTimerHandler(r,t+1))}}dispose(){this.summarizeTimer.clear()}};var Uv=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t},Dj=10*60*1e3,ih=class n{constructor(e,t,r,i,o,s,a,c,l){this.summaryWatcher=t,this.configuration=r,this.submitSummaryCallback=i,this.heuristicData=o,this.raiseSummarizingError=s,this.summaryCollection=a,this.cancellationToken=c,this.stopSummarizerCallback=l,this.stopping=!1,this._disposed=!1,this.tryWhileSummarizing=!1,this.summarizeCount=0,this.totalSuccessfulAttempts=0,this.tryGetCorrelatedLogger=d=>this.heuristicData.lastAttempt.refSequenceNumber===d?this.logger:void 0;let h={summarizeCount:()=>this.summarizeCount,summarizerSuccessfulAttempts:()=>this.totalSuccessfulAttempts};this.logger=ue.create(e,"Running",{all:h}),r.state!=="disableHeuristics"&&(w(this.configuration.state==="enabled",746),this.heuristicRunner=new th(o,this.configuration,d=>this.trySummarize(d),this.logger)),w(this.configuration.state!=="disabled",747);let u=Math.min(this.configuration.maxAckWaitTime,Dj);this.pendingAckTimer=new ic(u,()=>{this.raiseSummarizingError("Pending summary ack not received in time"),this.logger.sendErrorEvent({eventName:"SummaryAckWaitTimeout",maxAckWaitTime:u,referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber,timePending:Date.now()-this.heuristicData.lastAttempt.summaryTime})}),a.setPendingAckTimerTimeoutCallback(u,()=>{this.pendingAckTimer.hasTimer&&(this.logger.sendTelemetryEvent({eventName:"MissingSummaryAckFoundByOps",referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber}),this.pendingAckTimer.clear())}),this.generator=new rh(this.pendingAckTimer,this.heuristicData,this.submitSummaryCallback,this.raiseSummarizingError,()=>{this.totalSuccessfulAttempts++},this.summaryWatcher,this.logger)}static start(e,t,r,i,o,s,a,c,l){return v(this,null,function*(){var h;let u=new n(e,t,r,i,o,s,a,c,l);return yield u.waitStart(),(h=u.heuristicRunner)===null||h===void 0||h.run(),u})}get disposed(){return this._disposed}dispose(){var e;this.summaryWatcher.dispose(),(e=this.heuristicRunner)===null||e===void 0||e.dispose(),this.heuristicRunner=void 0,this.generator.dispose(),this.pendingAckTimer.clear(),this.disposeEnqueuedSummary(),this._disposed=!0,this.stopping=!0}handleSystemOp(e){switch(e.type){case dt.ClientLeave:case dt.ClientJoin:case dt.Propose:{this.handleOp(void 0,e);return}default:return}}handleOp(e,{sequenceNumber:t,type:r,clientId:i,contents:o}){var s;e===void 0&&(this.heuristicData.lastOpSequenceNumber=t,this.tryRunEnqueuedSummary()||(s=this.heuristicRunner)===null||s===void 0||s.run())}waitStop(e){return v(this,null,function*(){var t;this.stopping||(this.stopping=!0,this.disposeEnqueuedSummary(),e&&(!((t=this.heuristicRunner)===null||t===void 0)&&t.shouldRunLastSummary())&&this.summarizingLock===void 0&&this.trySummarizeOnce({reason:"lastSummary"},{}),yield this.summarizingLock)})}waitStart(){return v(this,null,function*(){let e=yield nh(this.summaryWatcher.waitFlushed(),this.pendingAckTimer.start());this.pendingAckTimer.clear(),this.summaryCollection.unsetPendingAckTimerTimeoutCallback(),e.result==="done"&&e.value!==void 0&&this.heuristicData.updateWithLastSummaryAckInfo({refSequenceNumber:e.value.summaryOp.referenceSequenceNumber,summaryTime:Date.now(),summarySequenceNumber:e.value.summaryOp.sequenceNumber})})}lockedRefreshSummaryAckAction(e){return v(this,null,function*(){w(this.refreshSummaryAckLock===void 0,"Refresh Summary Ack - Caller is responsible for checking lock");let t=new Se;return this.refreshSummaryAckLock=t.promise,e().finally(()=>{t.resolve(),this.refreshSummaryAckLock=void 0})})}lockedSummaryAction(e){return v(this,null,function*(){w(this.summarizingLock===void 0,603);let t=new Se;return this.summarizingLock=t.promise,this.summarizeCount++,yield this.refreshSummaryAckLock,e().finally(()=>{var r;t.resolve(),this.summarizingLock=void 0;let i=this.tryWhileSummarizing;this.tryWhileSummarizing=!1,!this.stopping&&!this.tryRunEnqueuedSummary()&&i&&((r=this.heuristicRunner)===null||r===void 0||r.run())})})}trySummarizeOnce(e,t,r=this.cancellationToken,i=new $r){return this.lockedSummaryAction(()=>v(this,null,function*(){return this.generator.summarize(e,t,r,i).receivedSummaryAckOrNack})).catch(o=>{}),i.build()}trySummarize(e,t=this.cancellationToken){if(this.summarizingLock!==void 0){this.tryWhileSummarizing=!0;return}this.lockedSummaryAction(()=>v(this,null,function*(){let r=[{refreshLatestAck:!1,fullTree:!1},{refreshLatestAck:!0,fullTree:!1},{refreshLatestAck:!0,fullTree:!1,delaySeconds:120},{refreshLatestAck:!0,fullTree:!0,delaySeconds:600}],i,o=0,s=0,a;for(let c=0;c<r.length;){if(this.cancellationToken.cancelled||++o>1&&e==="lastSummary")return;s++;let l=r[c],{delaySeconds:h=0}=l,u=Uv(l,["delaySeconds"]),d=i??h,p=Object.assign({reason:e,summaryAttempts:o,summaryAttemptsPerPhase:s,summaryAttemptPhase:c+1},u);d>0&&(this.logger.sendPerformanceEvent(Object.assign({eventName:"SummarizeAttemptDelay",duration:d,summaryNackDelay:i!==void 0},p)),yield oc(d*1e3)),yield this.refreshSummaryAckLock;let g=yield this.generator.summarize(p,u,t).receivedSummaryAckOrNack;if(g.success)return;i=g.retryAfterSeconds,(i===void 0||s>1)&&(c++,s=0),a=g}this.logger.sendErrorEvent({eventName:"FailToSummarize",reason:e,message:a?.message},a?.error),this.stopSummarizerCallback("failToSummarize")})).catch(r=>{this.logger.sendErrorEvent({eventName:"UnexpectedSummarizeError"},r)})}summarizeOnDemand(e=new $r,t){var{reason:r}=t,i=Uv(t,["reason"]);if(this.stopping)return e.fail("RunningSummarizer stopped or disposed",void 0),e.build();if(this.summarizingLock!==void 0)throw new ye("Attempted to run an already-running summarizer on demand");return this.trySummarizeOnce({reason:`onDemand/${r}`},i,this.cancellationToken,e)}enqueueSummarize(e){var{reason:t,afterSequenceNumber:r=0,override:i=!1}=e,o=Uv(e,["reason","afterSequenceNumber","override"]);let s=`enqueue;${t}`,a=!1;if(this.enqueuedSummary!==void 0){if(!i)return{alreadyEnqueued:!0};this.enqueuedSummary.resultsBuilder.fail("Aborted; overridden by another enqueue summarize attempt",void 0),this.enqueuedSummary=void 0,a=!0}this.enqueuedSummary={reason:s,afterSequenceNumber:r,options:o,resultsBuilder:new $r};let c=this.enqueuedSummary.resultsBuilder.build();return this.tryRunEnqueuedSummary(),a?Object.assign(Object.assign({},c),{alreadyEnqueued:!0,overridden:!0}):c}tryRunEnqueuedSummary(){if(this.stopping)return this.disposeEnqueuedSummary(),!1;if(this.enqueuedSummary===void 0||this.heuristicData.lastOpSequenceNumber<this.enqueuedSummary.afterSequenceNumber||this.summarizingLock!==void 0)return!1;let{reason:e,resultsBuilder:t,options:r}=this.enqueuedSummary;return this.enqueuedSummary=void 0,this.trySummarizeOnce({reason:`enqueuedSummary/${e}`},r,this.cancellationToken,t),!0}disposeEnqueuedSummary(){this.enqueuedSummary!==void 0&&(this.enqueuedSummary.resultsBuilder.fail("RunningSummarizer stopped or disposed",void 0),this.enqueuedSummary=void 0)}};var Fj="summarizingError",Kc=class n extends Be{constructor(e,t=!1){super(e),this.logged=t,this.errorType=Fj,this.canRetry=!0}static wrap(e,t=!1,r){return bc(e,o=>new n(o,t),r)}},zj=(n,e)=>new Kc(n,e),oh=class n extends oA.EventEmitter{constructor(e,t,r,i,o,s,a){super(),this.runtime=t,this.configurationGetter=r,this.internalsProvider=i,this.summaryCollection=s,this.runCoordinatorCreateFn=a,this._disposed=!1,this.starting=!1,this.stopDeferred=new Se,this.summarizeOnDemand=(...c)=>{var l;try{if(this._disposed||!((l=this.runningSummarizer)===null||l===void 0)&&l.disposed)throw new ye("Summarizer is already disposed.");if(this.runtime.summarizerClientId!==void 0&&this.runtime.summarizerClientId!==this.runtime.clientId)throw new ye("On-demand summary attempted while an elected summarizer is present");let h=new $r;return this.runningSummarizer?this.runningSummarizer.summarizeOnDemand(h,...c):(this.runCoordinatorCreateFn(this.runtime).then(d=>{this.start(this.runtime.clientId,d).then(m=>v(this,null,function*(){m.summarizeOnDemand(h,...c);let g=yield Promise.race([this.stopDeferred.promise,d.waitCancelled]);yield m.waitStop(!1),d.stop(g),this.close()})).catch(m=>{h.fail("Failed to start summarizer",m)})}).catch(d=>{h.fail("Failed to create cancellation token",d)}),h.build())}catch(h){throw Kc.wrap(h,!1,this.logger)}},this.enqueueSummarize=(...c)=>{if(this._disposed||this.runningSummarizer===void 0||this.runningSummarizer.disposed)throw new ye("Summarizer is not running or already disposed.");return this.runningSummarizer.enqueueSummarize(...c)},this.logger=ue.create(this.runtime.logger,"Summarizer"),this.innerHandle=new Zu(this,e,o)}get IFluidLoadable(){return this}get ISummarizer(){return this}get handle(){return this.innerHandle}static create(e,t){return v(this,null,function*(){let r={headers:{[lt.cache]:!1,[lt.clientDetails]:{capabilities:{interactive:!1},type:Qt},[Ai.summarizingClient]:!0,[lt.reconnect]:!1},url:t},i=yield e.resolve(r),o=yield Tr(i,{url:"_summarizer"});if(o.ISummarizer===void 0)throw new ye("Fluid object does not implement ISummarizer");return o.ISummarizer})}run(e){return v(this,null,function*(){try{return yield this.runCore(e)}catch(t){throw this.stop("summarizerException"),Kc.wrap(t,!1,this.logger)}finally{this.close()}})}stop(e){this.stopDeferred.resolve(e)}close(){this.dispose(),this.runtime.closeFn()}runCore(e){return v(this,null,function*(){let t=yield this.runCoordinatorCreateFn(this.runtime),r=Promise.race([t.waitCancelled,this.stopDeferred.promise]);if(r.then(s=>{this.logger.sendTelemetryEvent({eventName:"StoppingSummarizer",onBehalfOf:e,reason:s})}),t.cancelled)return t.waitCancelled;let i=yield this.start(e,t),o=yield r;return yield i.waitStop(!t.cancelled&&n.stopReasonCanRunLastSummary(o)),t.stop(o),o})}static stopReasonCanRunLastSummary(e){return e==="parentNotConnected"}start(e,t){return v(this,null,function*(){if(this.runningSummarizer){if(this.runningSummarizer.disposed)throw new ye("Starting a disposed summarizer");return this.runningSummarizer}if(this.starting)throw new ye("Attempting to start a summarizer that is already starting");this.starting=!0,this.logger.sendTelemetryEvent({eventName:"RunningSummarizer",onBehalfOf:e,initSummarySeqNumber:this.runtime.deltaManager.initialSequenceNumber,config:JSON.stringify(this.configurationGetter())});let r=this.runtime.clientId;if(r===void 0)throw new ye("clientId should be defined if connected.");let i=yield ih.start(this.logger,this.summaryCollection.createWatcher(r),this.configurationGetter(),(...o)=>v(this,null,function*(){return this.internalsProvider.submitSummary(...o)}),new eh(this.runtime.deltaManager.lastSequenceNumber,{refSequenceNumber:this.runtime.deltaManager.initialSequenceNumber,summaryTime:Date.now()}),o=>{this._disposed||this.logger.sendErrorEvent({eventName:"summarizingError"},zj(o,!0))},this.summaryCollection,t,o=>t.stop(o));return this.runningSummarizer=i,this.starting=!1,this.handleSummaryAcks().catch(o=>{this.logger.sendErrorEvent({eventName:"HandleSummaryAckFatalError"},o)}),this.systemOpListener=o=>i.handleSystemOp(o),this.runtime.deltaManager.inbound.on("op",this.systemOpListener),this.opListener=(o,s)=>i.handleOp(o,s),this.runtime.on("batchEnd",this.opListener),i})}dispose(){this.stop("summarizerClientDisconnected"),this._disposed=!0,this.runningSummarizer&&(this.runningSummarizer.dispose(),this.runningSummarizer=void 0),this.systemOpListener&&this.runtime.deltaManager.inbound.off("op",this.systemOpListener),this.opListener&&this.runtime.removeListener("batchEnd",this.opListener)}handleSummaryAcks(){return v(this,null,function*(){var e,t,r,i,o;let s=this.runtime.deltaManager.initialSequenceNumber,a;for(;this.runningSummarizer;){let c=(e=this.runningSummarizer.tryGetCorrelatedLogger(s))!==null&&e!==void 0?e:this.logger;try{a=void 0,a=yield this.summaryCollection.waitSummaryAck(s),s=a.summaryOp.referenceSequenceNumber;let l=a.summaryOp.contents.handle,h=a.summaryAck.contents.handle;yield this.runningSummarizer.lockedRefreshSummaryAckAction(()=>v(this,null,function*(){return this.internalsProvider.refreshLatestSummaryAck(l,h,s,c).catch(u=>v(this,null,function*(){if(gc(u)&&u.errorType===Xt.fileNotFoundOrAccessDeniedError)c.sendTelemetryEvent({eventName:"HandleSummaryAckErrorIgnored",referenceSequenceNumber:s,proposalHandle:l,ackHandle:h},u);else throw u}))}))}catch(l){c.sendErrorEvent({eventName:"HandleSummaryAckError",referenceSequenceNumber:s,handle:(r=(t=a?.summaryOp)===null||t===void 0?void 0:t.contents)===null||r===void 0?void 0:r.handle,ackHandle:(o=(i=a?.summaryAck)===null||i===void 0?void 0:i.contents)===null||o===void 0?void 0:o.handle},l)}s++}})}};Y();Pe();var Ij=5e3,Rj=4e3,Yt=function(n){return n[n.Off=0]="Off",n[n.Starting=1]="Starting",n[n.Running=2]="Running",n[n.Stopping=3]="Stopping",n}(Yt||{}),sA=(()=>{class n{constructor(t,r,i,o,s,a,{initialDelayMs:c=Ij,opsToBypassInitialDelay:l=Rj}={},h){this.clientElection=t,this.connectedState=r,this.summaryCollection=i,this.requestSummarizerFn=s,this.startThrottler=a,this.disableHeuristics=h,this.state=Yt.Off,this._disposed=!1,this.handleConnected=u=>{this.latestClientId=u,this.refreshSummarizer()},this.handleDisconnected=()=>{this.refreshSummarizer()},this.refreshSummarizer=()=>{let u=this.getShouldSummarizeState();switch(this.state){case Yt.Off:{u.shouldSummarize&&this.startSummarization();return}case Yt.Starting:return;case Yt.Running:{u.shouldSummarize===!1&&this.stop(u.stopReason);return}case Yt.Stopping:return;default:return}},this.summarizeOnDemand=(...u)=>{if(this.summarizer===void 0)throw Error("No running summarizer client");return this.summarizer.summarizeOnDemand(...u)},this.enqueueSummarize=(...u)=>{if(this.summarizer===void 0)throw Error("No running summarizer client");return this.summarizer.enqueueSummarize(...u)},this.logger=ue.create(o,"SummaryManager",{all:{clientId:()=>this.latestClientId}}),this.connectedState.on("connected",this.handleConnected),this.connectedState.on("disconnected",this.handleDisconnected),this.latestClientId=this.connectedState.clientId,this.opsToBypassInitialDelay=l,this.initialDelayMs=c}get disposed(){return this._disposed}get currentState(){return this.state}start(){this.clientElection.on("electedSummarizerChanged",this.refreshSummarizer),this.refreshSummarizer()}getShouldSummarizeState(){if(this.connectedState.clientId!==this.clientElection.electedParentId||this.state!==Yt.Running&&this.connectedState.clientId!==this.clientElection.electedClientId)return{shouldSummarize:!1,stopReason:"parentShouldNotSummarize"};if(this.connectedState.connected)if(this.disposed)w(!1,608);else return{shouldSummarize:!0};else return{shouldSummarize:!1,stopReason:"parentNotConnected"}}startSummarization(){w(this.state===Yt.Off,609),this.state=Yt.Starting,w(this.summarizer===void 0,610),this.delayBeforeCreatingSummarizer().then(t=>v(this,null,function*(){if(t&&this.getShouldSummarizeState().shouldSummarize===!1)return"early exit";w(this.state===Yt.Starting,611),this.state=Yt.Running;let r=yield this.requestSummarizerFn();this.summarizer=r;let i=this.getShouldSummarizeState();if(i.shouldSummarize===!1)return this.state=Yt.Starting,r.stop(i.stopReason),"early exit after starting summarizer";let o=this.latestClientId;return le.timedExecAsync(this.logger,{eventName:"RunningSummarizer",attempt:this.startThrottler.numAttempts},()=>v(this,null,function*(){return r.run(o,this.disableHeuristics)}))})).then(t=>{this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:t})}).catch(t=>{if(this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:"exception"},t),this.getShouldSummarizeState().shouldSummarize||this.summarizer!==void 0){let r=t?.errorType===Xt.offlineError?"generic":"error";this.logger.sendTelemetryEvent({eventName:"SummarizerException",category:r},t)}}).finally(()=>{var t;w(this.state!==Yt.Off,612),this.state=Yt.Off,(t=this.summarizer)===null||t===void 0||t.close(),this.summarizer=void 0,this.getShouldSummarizeState().shouldSummarize&&this.startSummarization()})}stop(t){var r;n.isStartingOrRunning(this.state)&&(this.state=Yt.Stopping,(r=this.summarizer)===null||r===void 0||r.stop(t))}delayBeforeCreatingSummarizer(){return v(this,null,function*(){let t=this.startThrottler.getDelay();this.logger.sendTelemetryEvent({eventName:"CreatingSummarizer",throttlerDelay:t,initialDelay:this.initialDelayMs,startThrottlerMaxDelayMs:this.startThrottler.maxDelayMs,opsSinceLastAck:this.summaryCollection.opsSinceLastAck,opsToBypassInitialDelay:this.opsToBypassInitialDelay});let r=!1;if(this.summaryCollection.opsSinceLastAck<this.opsToBypassInitialDelay&&(r=!0,t=Math.max(t,this.initialDelayMs)),t>0){let i,o,s=()=>{this.summaryCollection.opsSinceLastAck>=this.opsToBypassInitialDelay&&(clearTimeout(i),o())},a=new Promise(l=>{i=setTimeout(()=>l(),t)}),c=new Promise(l=>{o=l});this.summaryCollection.addOpListener(s),yield Promise.race([a,c]),this.summaryCollection.removeOpListener(s)}return r})}dispose(){this.clientElection.off("electedSummarizerChanged",this.refreshSummarizer),this.connectedState.off("connected",this.handleConnected),this.connectedState.off("disconnected",this.handleDisconnected),this._disposed=!0}}return n.isStartingOrRunning=e=>e===Yt.Starting||e===Yt.Running,n})();Y();Pe();var aA=(()=>{class n{constructor(t,r){this.logger=r,this.processingTimeIncrement=10,this.currentAllowedProcessingTimeForTurn=n.processingTime,this.schedulingCount=0,this.deltaManager=t,this.deltaManager.inbound.on("idle",()=>{this.inboundQueueIdle()})}batchBegin(t){this.processingStartTime||(this.processingStartTime=de.now()),this.schedulingLog===void 0&&this.schedulingCount%500===0&&(this.schedulingLog={opsRemainingToProcess:0,numberOfTurns:1,totalProcessingTime:0,numberOfBatchesProcessed:0,firstSequenceNumber:t.sequenceNumber,lastSequenceNumber:t.sequenceNumber,startTime:de.now()})}batchEnd(t){if(this.schedulingLog&&(this.schedulingLog.numberOfBatchesProcessed++,this.schedulingLog.lastSequenceNumber=t.sequenceNumber,this.schedulingLog.opsRemainingToProcess=this.deltaManager.inbound.length),this.shouldRunScheduler()){let r=de.now(),i=r-this.processingStartTime;i>this.currentAllowedProcessingTimeForTurn&&(this.deltaManager.inbound.pause(),this.currentAllowedProcessingTimeForTurn+=this.processingTimeIncrement,this.schedulingLog&&(this.schedulingLog.numberOfTurns++,this.schedulingLog.totalProcessingTime+=i),setTimeout(()=>{this.schedulingLog&&this.logger.sendTelemetryEvent({eventName:"InboundOpsPartialProcessingTime",duration:at.formatTick(i),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,opsRemainingToProcess:this.deltaManager.inbound.length,processingTime:at.formatTick(this.schedulingLog.totalProcessingTime),numberOfTurns:this.schedulingLog.numberOfTurns,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,timeToResume:at.formatTick(de.now()-r)}),this.deltaManager.inbound.resume()}),this.processingStartTime=void 0)}}inboundQueueIdle(){if(this.schedulingLog){let t=de.now();this.schedulingLog.totalProcessingTime+=t-this.processingStartTime,this.logger.sendTelemetryEvent({eventName:"InboundOpsProcessingTime",opsRemainingToProcess:this.schedulingLog.opsRemainingToProcess,numberOfTurns:this.schedulingLog.numberOfTurns,processingTime:at.formatTick(this.schedulingLog.totalProcessingTime),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,duration:at.formatTick(t-this.schedulingLog.startTime),schedulingCount:this.schedulingCount}),this.schedulingLog=void 0}this.schedulingCount++,this.processingStartTime=void 0,this.currentAllowedProcessingTimeForTurn=n.processingTime}shouldRunScheduler(){return this.deltaManager.inbound.length>0}}return n.processingTime=50,n})();Pe();Y();var Wv=5e3,Gv=class{constructor(e,t,r){this.clientId=e,this.deltaManager=t,this.pongCount=0,this.msnTrackingTimestamp=0,this.opProcessingTimes={},this.opPerfData={},this.firstConnection=!0,this.bootTime=de.now(),this.connectionStartTime=0,this.gap=0,this.logger=ue.create(r,"OpPerf"),this.deltaManager.on("pong",i=>this.recordPingTime(i)),this.deltaManager.on("submitOp",i=>this.beforeOpSubmit(i)),this.deltaManager.on("op",i=>this.afterProcessingOp(i)),this.deltaManager.on("connect",(i,o)=>{this.clientId=i.clientId,o!==void 0&&(this.connectionOpSeqNumber=this.deltaManager.lastKnownSeqNumber,this.gap=o,this.connectionStartTime=de.now(),this.gap<=0&&this.reportGettingUpToDate())}),this.deltaManager.on("disconnect",()=>{this.sequenceNumberForMsnTracking=void 0,this.clientSequenceNumberForLatencyStatistics=void 0,this.opProcessingTimes={},this.opPerfData={},this.connectionOpSeqNumber=void 0,this.firstConnection=!1,this.pongCount=0}),this.deltaManager.outbound.on("push",i=>{for(let o of i)o.type===dt.Operation&&this.clientSequenceNumberForLatencyStatistics===o.clientSequenceNumber&&(w(this.opProcessingTimes.outboundPushEventTime===void 0,712),w(this.opPerfData.durationNetwork===void 0,713),this.opProcessingTimes.outboundPushEventTime=Date.now(),w(this.opPerfData.durationOutboundBatching===void 0,714),w(this.opProcessingTimes.submitOpEventTime!==void 0,715),this.opPerfData.durationOutboundBatching=this.opProcessingTimes.outboundPushEventTime-this.opProcessingTimes.submitOpEventTime)}),this.deltaManager.inbound.on("push",i=>{this.clientId===i.clientId&&i.type===dt.Operation&&this.clientSequenceNumberForLatencyStatistics===i.clientSequenceNumber&&this.opProcessingTimes.outboundPushEventTime!==void 0&&(this.opProcessingTimes.inboundPushEventTime=Date.now(),this.opPerfData.durationNetwork=this.opProcessingTimes.inboundPushEventTime-this.opProcessingTimes.outboundPushEventTime,this.opProcessingTimes.outboundPushEventTime=void 0,this.opPerfData.lengthInboundQueue=this.deltaManager.inbound.length)}),this.deltaManager.inbound.on("idle",(i,o)=>{typeof i=="number"&&i>=100&&this.logger.sendPerformanceEvent({eventName:"GetDeltas_OpProcessing",count:i,duration:o})})}reportGettingUpToDate(){this.connectionOpSeqNumber=void 0,this.logger.sendPerformanceEvent({eventName:"ConnectionSpeed",duration:de.now()-this.connectionStartTime,ops:this.gap,timeToConnect:this.firstConnection?at.formatTick(this.connectionStartTime-this.bootTime):void 0,firstConnection:this.firstConnection})}recordPingTime(e){this.pingLatency=e,this.pongCount%100===0&&this.deltaManager.active&&this.logger.sendPerformanceEvent({eventName:"DeltaLatency",duration:e}),this.pongCount++}beforeOpSubmit(e){this.clientSequenceNumberForLatencyStatistics===void 0&&e.clientSequenceNumber%500===1&&(w(this.opProcessingTimes.outboundPushEventTime===void 0,716),w(this.opPerfData.durationNetwork===void 0,717),this.opProcessingTimes.submitOpEventTime=Date.now(),this.clientSequenceNumberForLatencyStatistics=e.clientSequenceNumber)}afterProcessingOp(e){let t=e.sequenceNumber;if(t===this.connectionOpSeqNumber&&this.reportGettingUpToDate(),this.sequenceNumberForMsnTracking===void 0&&t%1e3===0&&(this.sequenceNumberForMsnTracking=t,this.msnTrackingTimestamp=e.timestamp),this.sequenceNumberForMsnTracking!==void 0&&e.minimumSequenceNumber>=this.sequenceNumberForMsnTracking&&(w(this.msnTrackingTimestamp!==void 0,718),this.logger.sendPerformanceEvent({eventName:"MsnStatistics",sequenceNumber:t,msnDistance:t-this.sequenceNumberForMsnTracking,duration:e.timestamp-this.msnTrackingTimestamp}),this.sequenceNumberForMsnTracking=void 0),this.clientId===e.clientId&&this.clientSequenceNumberForLatencyStatistics===e.clientSequenceNumber){w(this.opProcessingTimes.submitOpEventTime!==void 0,288);let r=Date.now();this.opProcessingTimes.inboundPushEventTime!==void 0&&(this.opPerfData.durationInboundToProcessing=r-this.opProcessingTimes.inboundPushEventTime);let i=r-this.opProcessingTimes.submitOpEventTime,o=i>Wv?"error":"performance";this.logger.sendPerformanceEvent(Object.assign({eventName:"OpRoundtripTime",sequenceNumber:t,referenceSequenceNumber:e.referenceSequenceNumber,duration:i,category:o,pingLatency:this.pingLatency,msnDistance:this.deltaManager.lastSequenceNumber-this.deltaManager.minimumSequenceNumber},this.opPerfData)),this.clientSequenceNumberForLatencyStatistics=void 0,this.opPerfData={}}}};function cA(n,e,t){new Gv(n,e,t)}Y();var sh=Ce(qn());Pe();var $v=Ce(Kv());var ah=class{constructor(e,t,r){var i;this.stateHandler=e,this.pendingStates=new $v.default,this.disposeOnce=new On(()=>{this.initialStates.clear(),this.pendingStates.clear()}),this._pendingMessagesCount=0,this.isProcessingBatch=!1,this.dispose=()=>this.disposeOnce.value,this.initialStates=new $v.default((i=r?.pendingStates)!==null&&i!==void 0?i:[]),this.flushModeForNextMessage=t,this.onFlushModeUpdated(t)}get pendingMessagesCount(){return this._pendingMessagesCount}hasPendingMessages(){return this._pendingMessagesCount!==0||!this.initialStates.isEmpty()}getLocalState(){if(w(this.initialStates.isEmpty(),745),this.hasPendingMessages())return{pendingStates:this.pendingStates.toArray().map(e=>e.type==="message"?Object.assign(Object.assign({},e),{localOpMetadata:void 0}):e)}}get disposed(){return this.disposeOnce.evaluated}onSubmitMessage(e,t,r,i,o,s){let a={type:"message",messageType:e,clientSequenceNumber:t,referenceSequenceNumber:r,content:i,localOpMetadata:o,opMetadata:s};this.pendingStates.push(a),this._pendingMessagesCount++}onFlushModeUpdated(e){this.pendingStates.push({type:"flushMode",flushMode:e})}onFlush(){if(this.stateHandler.flushMode()===sh.FlushMode.Immediate)return;let e=this.pendingStates.peekBack();e?.type==="message"&&this.pendingStates.push({type:"flush"})}applyStashedOpsAt(e){return v(this,null,function*(){for(;!this.initialStates.isEmpty();){let t=this.initialStates.peekFront();if(t.type==="message"){if(e!==void 0){if(t.referenceSequenceNumber>e)break;if(t.referenceSequenceNumber<e)throw new Error("loaded from snapshot too recent to apply stashed ops")}let r=yield this.stateHandler.applyStashedOp(t.messageType,t.content);t.localOpMetadata=r}this.pendingStates.push(this.initialStates.shift())}})}processPendingLocalMessage(e){this.maybeProcessBatchBegin(e);let t=this.peekNextPendingState();if(w(t.type==="message",361),this.pendingStates.shift(),t.clientSequenceNumber!==e.clientSequenceNumber){let r=Ot.create("pending local message clientSequenceNumber mismatch","unexpectedAckReceived",e,{expectedClientSequenceNumber:t.clientSequenceNumber});this.stateHandler.close(r);return}return this._pendingMessagesCount--,this.maybeProcessBatchEnd(e),t.localOpMetadata}maybeProcessBatchBegin(e){let t,r=!1,i=this.peekNextPendingState();for(;i.type!=="message";)i.type==="flushMode"&&(t=i.flushMode),i.type==="flush"&&(r=!0),this.pendingStates.shift(),i=this.peekNextPendingState();t!==void 0&&(this.flushModeForNextMessage=t),t!==sh.FlushMode.Immediate&&(t===sh.FlushMode.TurnBased||r)&&(w(!this.isProcessingBatch&&this.pendingBatchBeginMessage===void 0,363),this.pendingBatchBeginMessage=e,this.isProcessingBatch=!0)}maybeProcessBatchEnd(e){var t,r;if(!this.isProcessingBatch)return;let i=this.peekNextPendingState();if(i.type==="message")return;w(i.type!=="flushMode",701),w(this.pendingBatchBeginMessage!==void 0,365);let o=(t=this.pendingBatchBeginMessage.metadata)===null||t===void 0?void 0:t.batch;if(this.pendingBatchBeginMessage===e)w(o===void 0,366);else{let s=(r=e.metadata)===null||r===void 0?void 0:r.batch;w(o===!0,367),w(s===!1,368)}this.pendingBatchBeginMessage=void 0,this.isProcessingBatch=!1}checkpoint(){let e=this.pendingStates.peekBack();return{rollback:()=>{try{for(;this.pendingStates.peekBack()!==e;)this.rollbackNextPendingState()}catch(t){let r=wi(t,i=>Ot.create(`RollbackError: ${i}`,"checkpointRollback",void 0));throw this.stateHandler.close(r),r}}}}peekNextPendingState(){let e=this.pendingStates.peekFront();return w(!!e,369),e}rollbackNextPendingState(){if(this.pendingStates.length===0)return;this._pendingMessagesCount--;let t=this.pendingStates.pop();switch(t.type){case"message":this.stateHandler.rollback(t.messageType,t.content,t.localOpMetadata);break;default:throw new Error(`Can't rollback state ${t.type}`)}}replayPendingStates(){w(this.stateHandler.connected(),370),w(this.clientId!==this.stateHandler.clientId(),371),this.clientId=this.stateHandler.clientId(),w(this.initialStates.isEmpty(),372);let e=this.pendingStates.length;if(e===0)return;this._pendingMessagesCount=0;let t=this.stateHandler.flushMode();for(this.stateHandler.setFlushMode(this.flushModeForNextMessage);e>0;){let r=this.pendingStates.shift();switch(r.type){case"message":this.stateHandler.reSubmit(r.messageType,r.content,r.localOpMetadata,r.opMetadata);break;case"flushMode":this.stateHandler.setFlushMode(r.flushMode);break;case"flush":this.stateHandler.flush();break;default:break}e--}this.stateHandler.setFlushMode(t)}};var $c="1.4.0";bt();Y();Vt();Pe();var ch=class{constructor(e,t,r){this.path=e,this.routeContext=t,this.get=r,this.attached=!1,this.absolutePath=ur(e,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return this.attached}attachGraph(){this.attached=!0}bind(e){throw new Error("Cannot bind to blob handle")}},Gs=(()=>{class n{constructor(t,r,i,o,s,a,c){this.routeContext=t,this.getStorage=i,this.attachBlobCallback=o,this.gcNodeUpdated=s,this.runtime=a,this.logger=c,this.blobIds=new Set,this.pendingBlobIds=new Map,this.detachedBlobIds=new Set,this.runtime.once("dispose",()=>{for(let l of this.pendingBlobIds.values())l.reject(new Error("runtime disposed while blobAttach op in flight"))}),this.load(r)}hasBlob(t){return this.blobIds.has(t)||this.detachedBlobIds.has(t)}getBlobGCNodePath(t){return`/${n.basePath}/${t}`}getBlob(t){return v(this,null,function*(){var r,i;let o=(i=(r=this.redirectTable)===null||r===void 0?void 0:r.get(t))!==null&&i!==void 0?i:t;return w(this.hasBlob(o),287),this.gcNodeUpdated(this.getBlobGCNodePath(t)),new ch(`${n.basePath}/${o}`,this.routeContext,()=>v(this,null,function*(){return le.timedExecAsync(this.logger,{eventName:"AttachmentReadBlob",id:o},()=>v(this,null,function*(){return this.getStorage().readBlob(o)}),{end:!0,cancel:"error"})}))})}createBlob(t){return v(this,null,function*(){var r,i;this.runtime.attachState===oe.Attaching&&(this.logger.sendTelemetryEvent({eventName:"CreateBlobWhileAttaching"}),yield new Promise(a=>this.runtime.once("attached",a))),!this.runtime.connected&&this.runtime.attachState===oe.Attached&&(yield new Promise(a=>this.runtime.once("connected",a)));let o=yield le.timedExecAsync(this.logger,{eventName:"createBlob"},()=>v(this,null,function*(){return this.getStorage().createBlob(t)}),{end:!0,cancel:"error"}),s=new ch(`${n.basePath}/${o.id}`,this.routeContext,()=>v(this,null,function*(){return this.getBlob(o.id).then(a=>v(this,null,function*(){return a.get()}))}));return this.runtime.attachState===oe.Detached?(this.detachedBlobIds.add(o.id),s):(this.pendingBlobIds.has(o.id)?yield(r=this.pendingBlobIds.get(o.id))===null||r===void 0?void 0:r.promise:this.blobIds.has(o.id)||(this.pendingBlobIds.set(o.id,new Se),this.attachBlobCallback(o.id),yield(i=this.pendingBlobIds.get(o.id))===null||i===void 0?void 0:i.promise),s)})}processBlobAttachOp(t,r){if(r){let i=this.pendingBlobIds.get(t);w(i!==void 0,504),i.resolve(),this.pendingBlobIds.delete(t)}this.blobIds.add(t)}static load(t,r){return v(this,null,function*(){if(!t)return{};let i,o=t.blobs[this.redirectTableBlobName];return o&&(i=yield r(o)),{ids:Object.entries(t.blobs).filter(([a,c])=>a!==this.redirectTableBlobName).map(([a,c])=>c),redirectTable:i}})}load(t){var r,i,o;if(t.ids){let s=this.runtime.attachState===oe.Detached;t.ids.map(a=>s?this.detachedBlobIds.add(a):this.blobIds.add(a))}t.redirectTable&&(this.redirectTable=new Map(t.redirectTable)),this.logger.sendTelemetryEvent({eventName:"AttachmentBlobsLoaded",count:(i=(r=t.ids)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0,redirectTable:(o=t.redirectTable)===null||o===void 0?void 0:o.length})}getGCData(t=!1){let r={gcNodes:{}};if(this.blobIds.forEach(i=>{r.gcNodes[this.getBlobGCNodePath(i)]=[]}),this.redirectTable!==void 0)for(let[i,o]of this.redirectTable)r.gcNodes[this.getBlobGCNodePath(i)]=[this.getBlobGCNodePath(o)];return r}deleteUnusedRoutes(t){var r;for(let i of t){let o=i.split("/");w(o.length===3&&o[1]===n.basePath,725);let s=o[2];if(!((r=this.redirectTable)===null||r===void 0)&&r.has(s)){this.redirectTable.delete(s);continue}this.blobIds.delete(s)}}summarize(t){let i=!!this.redirectTable||this.runtime.attachState!==oe.Detached?this.blobIds:this.detachedBlobIds,o=new Pt;return i.forEach(s=>{o.addAttachment(s)}),this.redirectTable&&this.redirectTable.size>0&&o.addBlob(n.redirectTableBlobName,JSON.stringify(Array.from(this.redirectTable.entries()))),o.getSummaryTree()}setRedirectTable(t){w(this.runtime.attachState===oe.Detached,594),w(!this.redirectTable,595);for(let[r,i]of t)w(this.detachedBlobIds.delete(r),596),this.blobIds.add(i);w(this.detachedBlobIds.size===0,597),this.redirectTable=t}}return n.basePath="_blobs",n.redirectTableBlobName=".redirectTable",n})();var Vi=Ce(qn());bt();Pe();Vt();Y();qt();Vs();Y();Pe();var lh=class{constructor(e){this.notBoundContexts=new Set,this._contexts=new Map,this.deferredContexts=new Map,this.disposeOnce=new On(()=>{for(let[t,r]of this.deferredContexts)r.promise.then(i=>{i.dispose()}).catch(i=>{this._logger.sendErrorEvent({eventName:"FluidDataStoreContextDisposeError",fluidDataStoreId:t},i)})}),this.dispose=()=>this.disposeOnce.value,this._logger=ue.create(e)}[Symbol.iterator](){return this._contexts.entries()}get size(){return this._contexts.size}get disposed(){return this.disposeOnce.evaluated}notBoundLength(){return this.notBoundContexts.size}isNotBound(e){return this.notBoundContexts.has(e)}has(e){return this._contexts.has(e)}get(e){return this._contexts.get(e)}delete(e){return this.deferredContexts.delete(e),this.notBoundContexts.delete(e),this._contexts.delete(e)}getUnbound(e){if(!(this._contexts.get(e)===void 0||!this.notBoundContexts.has(e)))return this._contexts.get(e)}addUnbound(e){let t=e.id;w(!this._contexts.has(t),344),this._contexts.set(t,e),this.notBoundContexts.add(t),this.ensureDeferred(t)}getBoundOrRemoted(e,t){return v(this,null,function*(){let r=this.ensureDeferred(e);if(!(!t&&!r.isCompleted))return r.promise})}ensureDeferred(e){let t=this.deferredContexts.get(e);if(t)return t;let r=new Se;return this.deferredContexts.set(e,r),r}bind(e){let t=this.notBoundContexts.delete(e);w(t,345),this.resolveDeferred(e)}resolveDeferred(e){let t=this._contexts.get(e);w(!!t,346),w(!this.notBoundContexts.has(e),347);let r=this.deferredContexts.get(e);w(!!r,348),r.resolve(t)}addBoundOrRemoted(e){let t=e.id;w(!this._contexts.has(t),349),this._contexts.set(t,e),this.ensureDeferred(t),this.resolveDeferred(t)}};Vt();Y();Hr();var Ks=Ce(qn());bt();Pe();Y();var gA=Ce(qn());Y();Vs();var pA=Ce(qn());bt();Pe();var Lj=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t},qj=1,zr="gc",fA="__gc",jj="Fluid.GarbageCollection.RunGC",Vj="Fluid.GarbageCollection.RunSweep",Hj="Fluid.GarbageCollection.GCTestMode",Uj="Fluid.GarbageCollection.WriteDataAtRoot",Gj="Fluid.GarbageCollection.RunSessionExpiry",Wj="Fluid.GarbageCollection.DisableSessionExpiry",Kj="Fluid.GarbageCollection.TrackGCState",$j="Fluid.GarbageCollection.DisableSweepLog",Qv=1*24*60*60*1e3,Xj=7*Qv,Jj=30*Qv,Zt={DataStore:"DataStore",SubDataStore:"SubDataStore",Blob:"Blob",Other:"Other"},jn={Active:"Active",Inactive:"Inactive",SweepReady:"SweepReady"},dh=class{constructor(e,t,r,i){this.unreferencedTimestampMs=e,this.inactiveTimeoutMs=t,this.sweepTimeoutMs=r,this._state=jn.Active,i!==void 0&&this.updateTracking(i)}get state(){return this._state}updateTracking(e){let t=e-this.unreferencedTimestampMs;if(this.sweepTimeoutMs!==void 0&&t>=this.sweepTimeoutMs){this._state=jn.SweepReady,this.clearTimers();return}if(t>=this.inactiveTimeoutMs){this._state=jn.Inactive,this.clearTimers(),this.sweepTimeoutMs!==void 0&&hh(this.sweepTimeoutMs-t,()=>{this._state=jn.SweepReady},i=>{this.sweepTimer=i});return}let r=this.inactiveTimeoutMs-t;if(this.inactiveTimer===void 0){let i=()=>{this._state=jn.Inactive,this.sweepTimeoutMs!==void 0&&hh(this.sweepTimeoutMs-this.inactiveTimeoutMs,()=>{this._state=jn.SweepReady},o=>{this.sweepTimer=o})};this.inactiveTimer=new fn(r,()=>i())}this.inactiveTimer.restart(r)}clearTimers(){var e;(e=this.inactiveTimer)===null||e===void 0||e.clear(),this.sweepTimer!==void 0&&clearTimeout(this.sweepTimer)}stopTracking(){this.clearTimers(),this._state=jn.Active}},uh=class n{constructor(e){var t,r,i,o,s,a,c;this._writeDataAtRoot=!0,this.initialStateNeedsReset=!1,this.currentGCVersion=qj,this.newReferencesSinceLastRun=new Map,this.unreferencedNodesState=new Map,this.loggedUnreferencedEvents=new Set,this.pendingEventsQueue=[],this.completedRuns=0,this.runtime=e.runtime,this.isSummarizerClient=e.isSummarizerClient,this.gcOptions=e.gcOptions,this.getNodePackagePath=e.getNodePackagePath,this.getLastSummaryTimestampMs=e.getLastSummaryTimestampMs;let l=e.baseSnapshot,h=e.metadata,u=e.readAndParseBlob;this.mc=Mn(ue.create(e.baseLogger,"GarbageCollector",{all:{completedGCRuns:()=>this.completedRuns}}));let d;if(e.existing)d=Jv(h),this.gcEnabled=d>0,this.sweepEnabled=(t=h?.sweepEnabled)!==null&&t!==void 0?t:!1,this.sessionExpiryTimeoutMs=h?.sessionExpiryTimeoutMs;else{if(this.gcOptions.sweepAllowed&&this.gcOptions.gcAllowed===!1)throw new ye("GC sweep phase cannot be enabled without enabling GC mark phase");this.gcEnabled=this.gcOptions.gcAllowed!==!1,this.sweepEnabled=this.gcOptions.sweepAllowed===!0,this.mc.config.getBoolean(Gj)&&this.gcEnabled&&(this.sessionExpiryTimeoutMs=Jj)}if(this.sessionExpiryTimeoutMs!==void 0&&this.mc.config.getBoolean(Wj)!==!0){let g=this.mc.config.getNumber("Fluid.GarbageCollection.TestOverride.SessionExpiryMs"),x=g??this.sessionExpiryTimeoutMs;hh(x,()=>{this.runtime.closeFn(new Uu("Client session expired.",x))},b=>{this.sessionExpiryTimer=b}),e.snapshotCacheExpiryMs!==void 0&&(this.sweepTimeoutMs=this.sessionExpiryTimeoutMs+e.snapshotCacheExpiryMs+Qv)}if(this.latestSummaryGCVersion=d??this.currentGCVersion,this.shouldRunGC=(r=this.mc.config.getBoolean(jj))!==null&&r!==void 0?r:this.gcEnabled&&!this.gcOptions.disableGC,this.shouldRunSweep=this.shouldRunGC&&this.sweepTimeoutMs!==void 0&&((i=this.mc.config.getBoolean(Vj))!==null&&i!==void 0?i:this.sweepEnabled),this.trackGCState=this.mc.config.getBoolean(Kj)===!0,this.inactiveTimeoutMs=(s=(o=this.mc.config.getNumber("Fluid.GarbageCollection.TestOverride.InactiveTimeoutMs"))!==null&&o!==void 0?o:this.gcOptions.inactiveTimeoutMs)!==null&&s!==void 0?s:Xj,this.sweepTimeoutMs!==void 0&&this.inactiveTimeoutMs>this.sweepTimeoutMs)throw new ye("inactive timeout should not be greated than the sweep timeout");if(this.testMode=(a=this.mc.config.getBoolean(Hj))!==null&&a!==void 0?a:this.gcOptions.runGCInTestMode===!0,this._writeDataAtRoot=(c=this.mc.config.getBoolean(Uj))!==null&&c!==void 0?c:!0,this._writeDataAtRoot){let g=l?.trees[zr]!==void 0;this.initialStateNeedsReset=g!==this.shouldRunGC}let p=new Lt(()=>v(this,null,function*(){var g;if(l===void 0)return;let x=l.trees[zr];if(x!==void 0){this._writeDataAtRoot=!0;let O=yield hA(x,u);return this.trackGCState&&(this.latestSerializedSummaryState=JSON.stringify(Xv(O))),O}let b={gcNodes:{"/":{outboundRoutes:[]}}},_=ph(l,h);w(_!==void 0,680);for(let[O,S]of Object.entries(_.trees)){let E=S.blobs[pA.gcBlobKey];if(E===void 0)continue;let D=yield u(E);if(((g=D.gcData)===null||g===void 0?void 0:g.gcNodes)===void 0)continue;let I=`/${O}`;(yield u(S.blobs[Xr])).isRootDataStore&&b.gcNodes["/"].outboundRoutes.push(I);for(let[P,C]of Object.entries(D.gcData.gcNodes)){let M=P==="/"?I:`${I}${P}`;b.gcNodes[M]={outboundRoutes:Array.from(C)}}w(b.gcNodes[I]!==void 0,681),b.gcNodes[I].unreferencedTimestampMs=D.unrefTimestamp}return Object.keys(b.gcNodes).length===1?void 0:b}));this.initializeBaseStateP=new Lt(()=>v(this,null,function*(){let g=this.runtime.getCurrentReferenceTimestampMs(),x=yield p;if(x===void 0)return;let b={};for(let[_,O]of Object.entries(x.gcNodes))O.unreferencedTimestampMs!==void 0&&this.unreferencedNodesState.set(_,new dh(O.unreferencedTimestampMs,this.inactiveTimeoutMs,this.sweepTimeoutMs,g)),b[_]=Array.from(O.outboundRoutes);this.previousGCDataFromLastRun={gcNodes:b}})),this.baseGCDetailsP=new Lt(()=>v(this,null,function*(){let g=yield p;if(g===void 0)return new Map;let x={};for(let[O,S]of Object.entries(g.gcNodes))x[O]=Array.from(S.outboundRoutes);let b=Bu(x,["/"]).referencedNodeIds,_=Lu({gcData:{gcNodes:x},usedRoutes:b});for(let[O,S]of Object.entries(g.gcNodes))if(S.unreferencedTimestampMs!==void 0){let E=_.get(O.slice(1));E!==void 0&&(E.unrefTimestamp=S.unreferencedTimestampMs)}return _}));let m=JSON.stringify(Object.assign({gcEnabled:this.gcEnabled,sweepEnabled:this.sweepEnabled,runGC:this.shouldRunGC,runSweep:this.shouldRunSweep,writeAtRoot:this._writeDataAtRoot,testMode:this.testMode,sessionExpiry:this.sessionExpiryTimeoutMs,inactiveTimeout:this.inactiveTimeoutMs,existing:e.existing,trackGCState:this.trackGCState},this.gcOptions));this.isSummarizerClient&&this.mc.logger.sendTelemetryEvent({eventName:"GarbageCollectorLoaded",gcConfigs:m}),this.shouldRunGC&&this.initializeBaseStateP.catch(g=>{let x=Ot.wrapIfUnrecognized(g,"FailedToInitializeGC");throw x.addTelemetryProperties({gcConfigs:m}),x})}static create(e){return new n(e)}get summaryStateNeedsReset(){return this.initialStateNeedsReset||this.shouldRunGC&&this.latestSummaryGCVersion!==this.currentGCVersion}get writeDataAtRoot(){return this._writeDataAtRoot}collectGarbage(e){return v(this,null,function*(){let{fullGC:t=this.gcOptions.runFullGC===!0||this.summaryStateNeedsReset}=e,r=e.logger?ue.create(e.logger,void 0,{all:{completedGCRuns:()=>this.completedRuns}}):this.mc.logger;return le.timedExecAsync(r,{eventName:"GarbageCollection"},i=>v(this,null,function*(){yield this.runPreGCSteps();let o=yield this.runtime.getGCData(t),s=Bu(o.gcNodes,["/"]),a=yield this.runPostGCSteps(o,s,r);return i.end(Object.assign({},a)),this.completedRuns++,a}),{end:!0,cancel:"error"})})}runPreGCSteps(){return v(this,null,function*(){yield this.initializeBaseStateP,yield this.runtime.updateStateBeforeGC()})}runPostGCSteps(e,t,r){return v(this,null,function*(){let i=this.generateStats(t);this.updateStateSinceLastRun(e,r);let o=this.runtime.getCurrentReferenceTimestampMs();return this.updateCurrentState(e,t,o),this.runtime.updateUsedRoutes(t.referencedNodeIds,o),this.logSweepEvents(r,o),this.testMode&&this.runtime.deleteUnusedRoutes(t.deletedNodeIds),yield this.logUnreferencedEvents(r),i})}summarize(e,t,r){var i;if(!this.shouldRunGC||this.previousGCDataFromLastRun===void 0)return;let o={gcNodes:{}};for(let[c,l]of Object.entries(this.previousGCDataFromLastRun.gcNodes))o.gcNodes[c]={outboundRoutes:l,unreferencedTimestampMs:(i=this.unreferencedNodesState.get(c))===null||i===void 0?void 0:i.unreferencedTimestampMs};let s=JSON.stringify(Xv(o));if(this.trackGCState&&(this.pendingSerializedSummaryState=s,this.latestSerializedSummaryState!==void 0&&this.latestSerializedSummaryState===s&&!e&&t)){let c=pr();return c.handleNodeCount++,{summary:{type:Fr.Handle,handle:`/${zr}`,handleType:Fr.Tree},stats:c}}let a=new Pt;return a.addBlob(`${fA}_root`,s),a.getSummaryTree()}getMetadata(){return{gcFeature:this.gcEnabled?this.currentGCVersion:0,sessionExpiryTimeoutMs:this.sessionExpiryTimeoutMs,sweepEnabled:this.sweepEnabled}}getBaseGCDetails(){return v(this,null,function*(){return this.baseGCDetailsP})}latestSummaryStateRefreshed(e,t){return v(this,null,function*(){if(!this.shouldRunGC||!e.latestSummaryUpdated)return;if(e.wasSummaryTracked){this.latestSummaryGCVersion=this.currentGCVersion,this.initialStateNeedsReset=!1,this.trackGCState&&(this.latestSerializedSummaryState=this.pendingSerializedSummaryState,this.pendingSerializedSummaryState=void 0);return}let r=e.snapshot,i=r.blobs[Xc];if(i){let s=yield t(i);this.latestSummaryGCVersion=Jv(s)}let o=r.trees[zr];if(o!==void 0&&this.trackGCState){let s=yield hA(o,t);this.latestSerializedSummaryState=JSON.stringify(Xv(s))}else this.latestSerializedSummaryState=void 0;this.pendingSerializedSummaryState=void 0})}nodeUpdated(e,t,r,i,o){if(!this.shouldRunGC)return;let s=this.unreferencedNodesState.get(e);s&&s.state!==jn.Active&&this.inactiveNodeUsed(t,e,s,void 0,i,r,o)}addedOutboundReference(e,t){var r;if(!this.shouldRunGC)return;let i=(r=this.newReferencesSinceLastRun.get(e))!==null&&r!==void 0?r:[];i.push(t),this.newReferencesSinceLastRun.set(e,i);let o=this.unreferencedNodesState.get(t);o&&o.state!==jn.Active&&this.inactiveNodeUsed("Revived",t,o,e)}dispose(){this.sessionExpiryTimer!==void 0&&(clearTimeout(this.sessionExpiryTimer),this.sessionExpiryTimer=void 0)}updateCurrentState(e,t,r){this.previousGCDataFromLastRun=wo(e),this.newReferencesSinceLastRun.clear();for(let i of t.referencedNodeIds){let o=this.unreferencedNodesState.get(i);o!==void 0&&(o.stopTracking(),this.unreferencedNodesState.delete(i))}if(r!==void 0)for(let i of t.deletedNodeIds){let o=this.unreferencedNodesState.get(i);o===void 0?this.unreferencedNodesState.set(i,new dh(r,this.inactiveTimeoutMs,this.sweepTimeoutMs,r)):o.updateTracking(r)}}updateStateSinceLastRun(e,t){if(this.previousGCDataFromLastRun===void 0)return;let r=this.findMissingExplicitReferences(e,this.previousGCDataFromLastRun,this.newReferencesSinceLastRun);if(this.writeDataAtRoot&&r.length>0&&r.forEach(s=>{let a={eventName:"gcUnknownOutboundReferences",gcNodeId:s[0],gcRoutes:JSON.stringify(s[1])};t.sendPerformanceEvent(a)}),this.newReferencesSinceLastRun.size===0)return;let i=LE(this.previousGCDataFromLastRun,e);this.newReferencesSinceLastRun.forEach((s,a)=>{i.gcNodes[a]===void 0?i.gcNodes[a]=s:i.gcNodes[a].push(...s)});let o=Bu(i.gcNodes,["/"]);for(let s of o.referencedNodeIds){let a=this.unreferencedNodesState.get(s);a!==void 0&&(a.stopTracking(),this.unreferencedNodesState.delete(s))}}findMissingExplicitReferences(e,t,r){w(t!==void 0,695);let i=Object.entries(e.gcNodes),o=[];return i.forEach(([s,a])=>{var c,l;let h=(c=t.gcNodes[s])!==null&&c!==void 0?c:[],u=(l=r.get(s))!==null&&l!==void 0?l:[],d=[];a.forEach(p=>{let m=this.runtime.getNodeType(p)===Zt.Blob||this.runtime.getNodeType(p)===Zt.DataStore,g=!s.startsWith(p);m&&g&&!h.includes(p)&&!u.includes(p)&&d.push(p)}),d.length>0&&o.push([s,d])}),o}generateStats(e){let t={nodeCount:0,dataStoreCount:0,attachmentBlobCount:0,unrefNodeCount:0,unrefDataStoreCount:0,unrefAttachmentBlobCount:0,updatedNodeCount:0,updatedDataStoreCount:0,updatedAttachmentBlobCount:0},r=(i,o)=>{t.nodeCount++;let s=this.previousGCDataFromLastRun===void 0||this.unreferencedNodesState.has(i)===o;s&&t.updatedNodeCount++,o||t.unrefNodeCount++,this.runtime.getNodeType(i)===Zt.DataStore&&(t.dataStoreCount++,s&&t.updatedDataStoreCount++,o||t.unrefDataStoreCount++),this.runtime.getNodeType(i)===Zt.Blob&&(t.attachmentBlobCount++,s&&t.updatedAttachmentBlobCount++,o||t.unrefAttachmentBlobCount++)};for(let i of e.referencedNodeIds)r(i,!0);for(let i of e.deletedNodeIds)r(i,!1);return t}logSweepEvents(e,t){this.mc.config.getBoolean($j)===!0||t===void 0||this.sweepTimeoutMs===void 0||this.unreferencedNodesState.forEach((r,i)=>{if(r.state!==jn.SweepReady)return;let o=this.runtime.getNodeType(i);if(o!==Zt.DataStore&&o!==Zt.Blob)return;let s=`Deleted-${i}`;this.loggedUnreferencedEvents.has(s)||(this.loggedUnreferencedEvents.add(s),e.sendTelemetryEvent({eventName:"GCObjectDeleted",id:i,type:o,age:t-r.unreferencedTimestampMs,timeout:this.sweepTimeoutMs,completedGCRuns:this.completedRuns,lastSummaryTime:this.getLastSummaryTimestampMs()}))})}inactiveNodeUsed(e,t,r,i,o,s=this.runtime.getCurrentReferenceTimestampMs(),a){if(s===void 0||r.state===jn.Active||!this.isSummarizerClient&&e!=="Loaded")return;let c=this.runtime.getNodeType(t);if(c!==Zt.DataStore&&c!==Zt.Blob)return;let l=r.state,h=`${l}-${t}-${e}`;if(this.loggedUnreferencedEvents.has(h))return;this.loggedUnreferencedEvents.add(h);let u={id:t,type:c,unrefTime:r.unreferencedTimestampMs,age:s-r.unreferencedTimestampMs,timeout:r.state===jn.Inactive?this.inactiveTimeoutMs:this.sweepTimeoutMs,completedGCRuns:this.completedRuns,lastSummaryTime:this.getLastSummaryTimestampMs(),externalRequest:a?.[Ir.externalRequest],viaHandle:a?.[Ir.viaHandle],fromId:i};this.isSummarizerClient?this.pendingEventsQueue.push(Object.assign(Object.assign({},u),{usageType:e,state:l})):this.mc.logger.sendErrorEvent(Object.assign(Object.assign({},u),{eventName:`${l}Object_${e}`,pkg:o?{value:o.join("/"),tag:Ne.CodeArtifact}:void 0}))}logUnreferencedEvents(e){return v(this,null,function*(){for(let t of this.pendingEventsQueue){let{usageType:r,state:i}=t,o=Lj(t,["usageType","state"]),s=this.unreferencedNodesState.get(t.id),a=s===void 0||s.state===jn.Active;if(r==="Revived"===a){let c=yield this.getNodePackagePath(t.id),l=t.fromId?yield this.getNodePackagePath(t.fromId):void 0;e.sendErrorEvent(Object.assign(Object.assign({},o),{eventName:`${i}Object_${r}`,pkg:c?{value:c.join("/"),tag:Ne.CodeArtifact}:void 0,fromPkg:l?{value:l.join("/"),tag:Ne.CodeArtifact}:void 0}))}}this.pendingEventsQueue=[]})}};function hA(n,e){return v(this,null,function*(){let t={gcNodes:{}};for(let r of Object.keys(n.blobs)){if(!r.startsWith(fA))continue;let i=n.blobs[r];if(i===void 0)continue;let o=yield e(i);w(o!==void 0,685),t=BE(t,o)}return t})}function Xv(n){let e=Object.entries(n.gcNodes);e.sort(([r],[i])=>r.localeCompare(i));let t={gcNodes:{}};for(let[r,i]of e)i.outboundRoutes.sort(),t.gcNodes[r]=i;return t}function hh(n,e,t){let i;if(n>2147483647){let o=n-2147483647;i=setTimeout(()=>hh(o,e,t),2147483647)}else i=setTimeout(()=>e(),n);t(i)}function Yv(n){return n.summaryFormatVersion?n.summaryFormatVersion:n.snapshotFormatVersion==="0.1"?1:0}function Zv(n){return!!n.summaryFormatVersion&&!n.disableIsolatedChannels}var mA=n=>n===void 0?void 0:{clientId:n.clientId,clientSequenceNumber:n.clientSequenceNumber,minimumSequenceNumber:n.minimumSequenceNumber,referenceSequenceNumber:n.referenceSequenceNumber,sequenceNumber:n.sequenceNumber,timestamp:n.timestamp,type:n.type};var e0=".aliases",Xc=".metadata",t0=".chunks",n0=".electedSummarizer",fh=".blobs";function vA(n){return!!n&&!n.disableIsolatedChannels}function Jv(n){var e;return n&&(e=n.gcFeature)!==null&&e!==void 0?e:0}var Qj=".protocol",bA=[Qj,".logTail",".serviceProtocol",fh,zr],Xr=".component";function Ws(n){n.summary={type:Fr.Tree,tree:{[gA.channelsTreeName]:n.summary}},n.stats.treeNodeCount++}function xA(n,e){return v(this,null,function*(){let t=yield et(n,e.blobs[Xr]),r=Yv(t);return w(r>0,469),t})}function r0(n,e,t){let r=JSON.stringify(n);return t?{pkg:r,snapshotFormatVersion:"0.1",isRootDataStore:e}:{pkg:r,summaryFormatVersion:2,isRootDataStore:e}}function _A(n,e,t){let r=r0(n,e,t);return new ms(Xr,JSON.stringify(r))}var yA=(()=>{class n extends we{constructor(t,r,i,o,s){super(),this.existing=r,this.bindState=i,this.isLocalDataStore=o,this.makeLocallyVisibleFn=s,this._disposed=!1,this.detachedRuntimeCreation=!1,this.loaded=!1,this.pending=[],this._isInMemoryRoot=!1,this._containerRuntime=t.runtime,this.id=t.id,this.storage=t.storage,this.scope=t.scope,this.writeGCDataAtRoot=t.writeGCDataAtRoot,this.disableIsolatedChannels=t.disableIsolatedChannels,this.pkg=t.pkg,w(!this.id.includes("/"),314),this._attachState=this.containerRuntime.attachState!==oe.Detached&&this.existing?this.containerRuntime.attachState:oe.Detached,this.bindToContext=()=>{w(this.bindState===bn.NotBound,315),this.bindState=bn.Binding,w(this.channel!==void 0,316),this.makeLocallyVisible(),this.bindState=bn.Bound};let a=(c,l,h)=>v(this,null,function*(){return this.summarizeInternal(c,l,h)});this.summarizerNode=t.createSummarizerNodeFn(a,c=>v(this,null,function*(){return this.getGCDataInternal(c)}),()=>v(this,null,function*(){return this.getBaseGCDetails()})),this.subLogger=ue.create(this.logger,"FluidDataStoreContext"),this.thresholdOpsCounter=new fo(n.pendingOpsCountThreshold,this.subLogger)}get packagePath(){return w(this.pkg!==void 0,313),this.pkg}get options(){return this._containerRuntime.options}get clientId(){return this._containerRuntime.clientId}get clientDetails(){return this._containerRuntime.clientDetails}get logger(){return this._containerRuntime.logger}get deltaManager(){return this._containerRuntime.deltaManager}get connected(){return this._containerRuntime.connected}get IFluidHandleContext(){return this._containerRuntime.IFluidHandleContext}get containerRuntime(){return this._containerRuntime}get isLoaded(){return this.loaded}get baseSnapshot(){return this._baseSnapshot}get disposed(){return this._disposed}get attachState(){return this._attachState}get IFluidDataStoreRegistry(){return this.registry}isRoot(){return v(this,null,function*(){return this.isInMemoryRoot()||(yield this.getInitialSnapshotDetails()).isRootDataStore})}isInMemoryRoot(){return this._isInMemoryRoot}dispose(){this._disposed||(this._disposed=!0,this.channelDeferred&&this.channelDeferred.promise.then(t=>{t.dispose()}).catch(t=>{}))}rejectDeferredRealize(t,r){throw new Be(t,{packageName:{value:r,tag:Ne.PackageData}})}realize(){return v(this,null,function*(){return w(!this.detachedRuntimeCreation,317),this.channelDeferred||(this.channelDeferred=new Se,this.realizeCore(this.existing).catch(t=>{var r;let i=Ot.wrapIfUnrecognized(t,"realizeFluidDataStoreContext");i.addTelemetryProperties({fluidDataStoreId:{value:this.id,tag:"PackageData"}}),(r=this.channelDeferred)===null||r===void 0||r.reject(i),this.logger.sendErrorEvent({eventName:"RealizeError"},i)})),this.channelDeferred.promise})}factoryFromPackagePath(t){return v(this,null,function*(){w(this.pkg===t,318),t===void 0&&this.rejectDeferredRealize("packages is undefined");let r,i=this._containerRuntime.IFluidDataStoreRegistry,o;for(let a of t)i||this.rejectDeferredRealize("No registry for package",o),o=a,r=yield i.get(a),r||this.rejectDeferredRealize("Registry does not contain entry for the package",a),i=r.IFluidDataStoreRegistry;let s=r?.IFluidDataStoreFactory;return s===void 0&&this.rejectDeferredRealize("Can't find factory for package",o),{factory:s,registry:i}})}realizeCore(t){return v(this,null,function*(){let r=yield this.getInitialSnapshotDetails();this._baseSnapshot=r.snapshot;let i=r.pkg,{factory:o,registry:s}=yield this.factoryFromPackagePath(i);w(this.registry===void 0,319),this.registry=s;let a=yield o.instantiateDataStore(this,t);w(a!==void 0,320),this.bindRuntime(a)})}setConnectionState(t,r){this.verifyNotClosed(),this.loaded&&(w(this.connected===t,321),this.channel.setConnectionState(t,r))}process(t,r,i){var o;this.verifyNotClosed();let s=t.contents,a=Object.assign(Object.assign({},t),{type:s.type,contents:s.content});if(this.summarizerNode.recordChange(a),this.loaded)return(o=this.channel)===null||o===void 0?void 0:o.process(a,r,i);w(!r,322),w(this.pending!==void 0,573),this.pending.push(a),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length)}processSignal(t,r){var i;this.verifyNotClosed(),this.loaded&&((i=this.channel)===null||i===void 0||i.processSignal(t,r))}getQuorum(){return this._containerRuntime.getQuorum()}getAudience(){return this._containerRuntime.getAudience()}summarize(t=!1,r=!0,i){return v(this,null,function*(){return this.summarizerNode.summarize(t,r,i)})}summarizeInternal(t,r,i){return v(this,null,function*(){yield this.realize();let o=yield this.channel.summarize(t,r,i),s;this.disableIsolatedChannels||(Ws(o),s=[Ks.channelsTreeName]);let{pkg:a}=yield this.getInitialSnapshotDetails(),c=yield this.isRoot(),l=r0(a,c,this.disableIsolatedChannels);return En(o,Xr,JSON.stringify(l)),this.writeGCDataAtRoot||En(o,Ks.gcBlobKey,JSON.stringify(this.summarizerNode.getGCSummaryDetails())),this.summarizerNode.isReferenced()||(o.summary.unreferenced=!0,o.stats.unreferencedBlobSize=o.stats.totalBlobSize),Object.assign(Object.assign({},o),{id:this.id,pathPartsForChildren:s})})}getGCData(t=!1){return v(this,null,function*(){return this.summarizerNode.getGCData(t)})}getGCDataInternal(t=!1){return v(this,null,function*(){return yield this.realize(),w(this.channel!==void 0,323),this.channel.getGCData(t)})}updateUsedRoutes(t,r){this.summarizerNode.updateUsedRoutes(t,r),this.lastUsedState={usedRoutes:t,gcTimestamp:r},this.loaded&&this.updateChannelUsedRoutes()}addedGCOutboundReference(t,r){this._containerRuntime.addedGCOutboundReference(t,r)}updateChannelUsedRoutes(){if(w(this.loaded,324),w(this.channel!==void 0,325),this.lastUsedState===void 0)return;let t=this.lastUsedState.usedRoutes.filter(r=>r!=="/"&&r!=="");this.channel.updateUsedRoutes(t,this.lastUsedState.gcTimestamp)}request(t){return v(this,null,function*(){return(yield this.realize()).request(t)})}submitMessage(t,r,i){this.verifyNotClosed(),w(!!this.channel,326);let o={content:r,type:t};this._containerRuntime.submitDataStoreOp(this.id,o,i)}setChannelDirty(t){this.verifyNotClosed();let r=this.deltaManager.lastSequenceNumber;this.summarizerNode.invalidate(r);let i=this.summarizerNode.getChild(t);i&&i.invalidate(r)}submitSignal(t,r){return this.verifyNotClosed(),w(!!this.channel,327),this._containerRuntime.submitDataStoreSignal(this.id,t,r)}makeLocallyVisible(){w(this.channel!==void 0,719),this.makeLocallyVisibleFn()}bindRuntime(t){var r;if(this.channel)throw new Error("Runtime already bound");try{w(!this.detachedRuntimeCreation,328),w(this.channelDeferred!==void 0,329),w(this.pkg!==void 0,330);let i=this.pending;for(let o of i)t.process(o,!1,void 0);this.thresholdOpsCounter.send("ProcessPendingOps",i.length),this.pending=void 0,this.loaded=!0,this.channel=t,Object.freeze(this.pkg),this.updateChannelUsedRoutes(),this.channelDeferred.resolve(this.channel)}catch(i){(r=this.channelDeferred)===null||r===void 0||r.reject(i),this.logger.sendErrorEvent({eventName:"BindRuntimeError",fluidDataStoreId:{value:this.id,tag:"PackageData"}},i)}}getAbsoluteUrl(t){return v(this,null,function*(){if(this.attachState===oe.Attached)return this._containerRuntime.getAbsoluteUrl(t)})}setInMemoryRoot(){this._isInMemoryRoot=!0}reSubmit(t,r){w(!!this.channel,331);let i=t;this.channel.reSubmit(i.type,i.content,r)}rollback(t,r){if(!this.channel)throw new Error("Channel must exist when rolling back ops");if(!this.channel.rollback)throw new Error("Channel doesn't support rollback");let i=t;this.channel.rollback(i.type,i.content,r)}applyStashedOp(t){return v(this,null,function*(){this.channel||(yield this.realize()),w(!!this.channel,332);let r=t;return this.channel.applyStashedOp(r.content)})}verifyNotClosed(){if(this._disposed)throw new Error("Context is closed")}getCreateChildSummarizerNodeFn(t,r){return(i,o,s)=>this.summarizerNode.createChild(i,t,r,{throwOnFailure:!0},o,s)}uploadBlob(t){return v(this,null,function*(){return this.containerRuntime.uploadBlob(t)})}}return n.pendingOpsCountThreshold=1e3,n})(),Jc=class extends yA{constructor(e){super(e,!0,bn.Bound,!1,()=>{throw new Error("Already attached")}),this.initialSnapshotDetailsP=new Lt(()=>v(this,null,function*(){var t,r;let i,o=!0;if(typeof this.initSnapshotValue=="string"){let a=(yield this.storage.getVersions(this.initSnapshotValue,1))[0];i=(t=yield this.storage.getSnapshotTree(a))!==null&&t!==void 0?t:void 0}else i=this.initSnapshotValue;let s=a=>v(this,null,function*(){return et(this.storage,a)});if(i){let a=yield this.summarizerNode.loadBaseSummary(i,s);i=a.baseSummary,this.pending=a.outstandingOps.concat(this.pending)}if(i&&i.blobs[Xr]!==void 0){let a=yield s(i.blobs[Xr]),c;Yv(a)<1?a.pkg.startsWith('["')&&a.pkg.endsWith('"]')?c=JSON.parse(a.pkg):c=[a.pkg]:c=JSON.parse(a.pkg),this.pkg=c,o=(r=a.isRootDataStore)!==null&&r!==void 0?r:!0,Zv(a)&&(i=i.trees[Ks.channelsTreeName],w(i!==void 0,510))}return{pkg:this.pkg,isRootDataStore:o,snapshot:i}})),this.initSnapshotValue=e.snapshotTree,this.baseGCDetailsP=new Lt(()=>v(this,null,function*(){var t;return(t=yield e.getBaseGCDetails())!==null&&t!==void 0?t:{}}))}getInitialSnapshotDetails(){return v(this,null,function*(){return this.initialSnapshotDetailsP})}getInitialGCSummaryDetails(){return v(this,null,function*(){return this.getBaseGCDetails()})}getBaseGCDetails(){return v(this,null,function*(){return this.baseGCDetailsP})}generateAttachMessage(){throw new Error("Cannot attach remote store")}},gh=class extends yA{constructor(e){super(e,e.snapshotTree!==void 0,e.snapshotTree?bn.Bound:bn.NotBound,!0,e.makeLocallyVisibleFn),this.snapshotTree=e.snapshotTree,e.isRootDataStore===!0&&this.setInMemoryRoot(),this.createProps=e.createProps,this.attachListeners()}attachListeners(){this.once("attaching",()=>{w(this.attachState===oe.Detached,333),this._attachState=oe.Attaching}),this.once("attached",()=>{w(this.attachState===oe.Attaching,334),this._attachState=oe.Attached})}generateAttachMessage(){w(this.channel!==void 0,335),w(this.pkg!==void 0,336);let e=this.channel.getAttachSummary();this.disableIsolatedChannels||Ws(e);let t=r0(this.pkg,this.isInMemoryRoot(),this.disableIsolatedChannels);En(e,Xr,JSON.stringify(t));let r=js(e.summary);return{id:this.id,snapshot:r,type:this.pkg[this.pkg.length-1]}}getInitialSnapshotDetails(){return v(this,null,function*(){var e;let t=this.snapshotTree,r,i=!1;return t!==void 0&&(r=yield xA(this.storage,t),Zv(r)&&(t=t.trees[Ks.channelsTreeName],w(t!==void 0,511)),this.pkg===void 0&&(this.pkg=JSON.parse(r.pkg),(!((e=r.isRootDataStore)!==null&&e!==void 0)||e)&&(i=!0,this.setInMemoryRoot()))),w(this.pkg!==void 0,338),{pkg:this.pkg,isRootDataStore:i,snapshot:t}})}getInitialGCSummaryDetails(){return v(this,null,function*(){return{}})}getBaseGCDetails(){return v(this,null,function*(){return{}})}},Qc=class extends gh{constructor(e){super(e)}},mh=class n extends gh{constructor(e){super(e),this.detachedRuntimeCreation=!0}attachRuntime(e,t){return v(this,null,function*(){w(this.detachedRuntimeCreation,340),w(this.channelDeferred===void 0,341);let r=e.IFluidDataStoreFactory,i=yield this.factoryFromPackagePath(this.pkg);w(i.factory===r,342),w(this.registry===void 0,343),this.registry=i.registry,this.detachedRuntimeCreation=!1,this.channelDeferred=new Se,tr(n.prototype,this,"bindRuntime").call(this,t),(yield this.isRoot())&&(t.makeVisibleAndAttachGraph!==void 0?t.makeVisibleAndAttachGraph():t.bindToContext())})}getInitialSnapshotDetails(){return v(this,null,function*(){if(this.detachedRuntimeCreation)throw new Error("Detached Fluid Data Store context can't be realized! Please attach runtime first!");return tr(n.prototype,this,"getInitialSnapshotDetails").call(this)})}};Y();Vt();Pe();var vh=n=>typeof n?.internalId=="string"&&typeof n?.alias=="string",bh=(n,e,t,r,i)=>new i0(n,e,t,r,i),Jr=function(n){return n.Aliased="Aliased",n.Aliasing="Aliasing",n.None="None",n}(Jr||{}),i0=class{constructor(e,t,r,i,o){this.fluidDataStoreChannel=e,this.internalId=t,this.runtime=r,this.datastores=i,this.logger=o,this.aliasState=Jr.None}trySetAlias(e){return v(this,null,function*(){if(e.includes("/"))throw new ye(`The alias cannot contain slashes: '${e}'`);switch(this.aliasState){case Jr.Aliasing:return w(this.aliasResult!==void 0,790),yield this.aliasResult,this.alias===e?"Success":"AlreadyAliased";case Jr.Aliased:return this.alias===e?"Success":"AlreadyAliased";case Jr.None:break;default:vt(this.aliasState)}return this.aliasState=Jr.Aliasing,this.aliasResult=this.trySetAliasInternal(e),this.aliasResult})}trySetAliasInternal(e){return v(this,null,function*(){let t={internalId:this.internalId,alias:e};if(this.fluidDataStoreChannel.makeVisibleAndAttachGraph!==void 0?this.fluidDataStoreChannel.makeVisibleAndAttachGraph():this.fluidDataStoreChannel.bindToContext(),this.runtime.attachState===oe.Detached){let i=this.datastores.processAliasMessageCore(t);return this.aliasState=Jr.Aliased,i?"Success":"Conflict"}return(yield this.ackBasedPromise(i=>{this.runtime.submitDataStoreAliasOp(t,i)}).then(i=>(this.aliasState=Jr.Aliased,i&&(this.alias=e),i)).catch(i=>(this.logger.sendErrorEvent({eventName:"AliasingException",alias:{value:e,tag:Ne.UserData},internalId:{value:this.internalId,tag:Ne.PackageData}},i),this.aliasState=Jr.None,!1)))?"Success":"Conflict"})}request(e){return v(this,null,function*(){return this.fluidDataStoreChannel.request(e)})}get IFluidRouter(){return this.fluidDataStoreChannel}ackBasedPromise(e){return v(this,null,function*(){let t;return new Promise((r,i)=>{if(t=()=>i(new Error("ContainerRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed){t();return}this.runtime.on("dispose",t),e(r,i)}).finally(()=>{this.runtime.off("dispose",t)})})}};var xh=class{constructor(e,t,r,i,o,s,a,c,l,h,u=new lh(s)){this.baseSnapshot=e,this.runtime=t,this.submitAttachFn=r,this.getCreateChildSummarizerNodeFn=i,this.deleteChildSummarizerNodeFn=o,this.gcNodeUpdated=c,this.aliasMap=l,this.writeGCDataAtRoot=h,this.contexts=u,this.pendingAttach=new Map,this.attachOpFiredForDataStore=new Set,this.disposeOnce=new On(()=>this.contexts.dispose()),this.dataStoresSinceLastGC=[],this.dispose=()=>this.disposeOnce.value,this.logger=ue.create(s),this.containerRuntimeHandle=new Yn(this.runtime,"/",this.runtime.IFluidHandleContext);let d=new Lt(()=>v(this,null,function*(){return a()})),p=x=>v(this,null,function*(){return(yield d).get(x)}),m=new Map;if(e)for(let[x,b]of Object.entries(e.trees))m.set(x,b);let g=0;for(let[x,b]of m){let _;if(b.unreferenced&&g++,this.runtime.attachState!==oe.Detached)_=new Jc({id:x,snapshotTree:b,getBaseGCDetails:()=>v(this,null,function*(){return p(x)}),runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(x,{type:Vi.CreateSummarizerNodeSource.FromSummary}),writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels});else{if(typeof b!="object")throw new Be("Snapshot should be there to load from!!");let O=b;_=new Qc({id:x,pkg:void 0,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(x,{type:Vi.CreateSummarizerNodeSource.FromSummary}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(x),snapshotTree:O,isRootDataStore:void 0,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels})}this.contexts.addBoundOrRemoted(_)}this.containerLoadStats={containerLoadDataStoreCount:m.size,referencedDataStoreCount:m.size-g}}aliases(){return this.aliasMap}processAttachMessage(e,t){var r,i;let o=e.contents;if(this.dataStoresSinceLastGC.push(o.id),t){w(this.pendingAttach.has(o.id),350),(r=this.contexts.get(o.id))===null||r===void 0||r.emit("attached"),this.pendingAttach.delete(o.id);return}if(this.alreadyProcessed(o.id))throw new Jt("Duplicate DataStore created with existing id",Object.assign(Object.assign({},fr(e)),{dataStoreId:{value:o.id,tag:Ne.PackageData}}));let s=new Map,a;o.snapshot&&(a=tu(o.snapshot.entries,s));let c=[o.type],l=new Jc({id:o.id,snapshotTree:a,getBaseGCDetails:()=>v(this,null,function*(){return{}}),runtime:this.runtime,storage:new Dd(this.runtime.storage,s),scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(o.id,{type:Vi.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:(i=o.snapshot)!==null&&i!==void 0?i:{entries:[_A(c,!0,this.runtime.disableIsolatedChannels)]}}),writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels,pkg:c});this.contexts.addBoundOrRemoted(l)}processAliasMessage(e,t,r){let i=e.contents;if(!vh(i))throw new Jt("malformedDataStoreAliasMessage",Object.assign({},fr(e)));let o=t,s=this.processAliasMessageCore(i);r&&o(s)}processAliasMessageCore(e){if(this.alreadyProcessed(e.alias))return!1;let t=this.contexts.get(e.internalId);if(t===void 0)return this.logger.sendErrorEvent({eventName:"AliasFluidDataStoreNotFound",fluidDataStoreId:e.internalId}),!1;let r=new Yn(t,e.internalId,this.runtime.IFluidHandleContext);return this.runtime.addedGCOutboundReference(this.containerRuntimeHandle,r),this.aliasMap.set(e.alias,t.id),t.setInMemoryRoot(),!0}alreadyProcessed(e){return this.aliasMap.get(e)!==void 0||this.contexts.get(e)!==void 0}makeDataStoreLocallyVisible(e){let t=this.contexts.getUnbound(e);if(w(!!t,351),this.runtime.attachState!==oe.Detached){t.emit("attaching");let r=t.generateAttachMessage();this.pendingAttach.set(e,r),this.submitAttachFn(r),this.attachOpFiredForDataStore.add(e)}this.contexts.bind(e)}createDetachedDataStoreCore(e,t,r=ke()){w(!r.includes("/"),780);let i=new mh({id:r,pkg:e,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(r,{type:Vi.CreateSummarizerNodeSource.Local}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(r),snapshotTree:void 0,isRootDataStore:t,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels});return this.contexts.addUnbound(i),i}_createFluidDataStoreContext(e,t,r,i){w(!t.includes("/"),781);let o=new Qc({id:t,pkg:e,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(t,{type:Vi.CreateSummarizerNodeSource.Local}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(t),snapshotTree:void 0,isRootDataStore:r,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels,createProps:i});return this.contexts.addUnbound(o),o}get disposed(){return this.disposeOnce.evaluated}resubmitDataStoreOp(e,t){let r=e,i=this.contexts.get(r.address);w(!!i,352),i.reSubmit(r.contents,t)}rollbackDataStoreOp(e,t){let r=e,i=this.contexts.get(r.address);w(!!i,744),i.rollback(r.contents,t)}applyStashedOp(e){return v(this,null,function*(){let t=e,r=this.contexts.get(t.address);return w(!!r,353),r.applyStashedOp(t.contents)})}applyStashedAttachOp(e){return v(this,null,function*(){this.pendingAttach.set(e.id,e),this.processAttachMessage({contents:e},!1)})}processFluidDataStoreOp(e,t,r){let i=e.contents,o=Object.assign(Object.assign({},e),{contents:i.contents}),s=this.contexts.get(i.address);w(!!s,354),s.process(o,t,r),this.gcNodeUpdated(`/${i.address}`,e.timestamp,s.isLoaded?s.packagePath:void 0)}getDataStore(e,t){return v(this,null,function*(){let r=yield this.contexts.getBoundOrRemoted(e,t);if(r===void 0){let i={url:e};throw Bi(zt(i),i)}return r})}processSignal(e,t,r){let i=this.contexts.get(e);if(!i){w(!r,355),this.logger.sendTelemetryEvent({eventName:"SignalFluidDataStoreNotFound",fluidDataStoreId:{value:e,tag:Ne.PackageData}});return}i.processSignal(t,r)}setConnectionState(e,t){for(let[r,i]of this.contexts)try{i.setConnectionState(e,t)}catch(o){this.logger.sendErrorEvent({eventName:"SetConnectionStateError",clientId:t,fluidDataStore:r},o)}}setAttachState(e){let t;e===oe.Attaching?t="attaching":t="attached";for(let[,r]of this.contexts)this.contexts.isNotBound(r.id)||r.emit(t)}get size(){return this.contexts.size}summarize(e,t,r){return v(this,null,function*(){let i=new Pt;return yield Promise.all(Array.from(this.contexts).filter(([o,s])=>(w(s.attachState!==oe.Attaching,357),s.attachState===oe.Attached)).map(a=>v(this,[a],function*([o,s]){let c=yield s.summarize(e,t,r);i.addWithStats(o,c)}))),i.getSummaryTree()})}createSummary(e){let t=new Pt,r;do{let i=t.summary.tree;r=this.contexts.notBoundLength(),Array.from(this.contexts).filter(([o,s])=>!(this.contexts.isNotBound(o)||i[o]||this.attachOpFiredForDataStore.has(o))).map(([o,s])=>{let a;if(s.isLoaded){let c=s.generateAttachMessage().snapshot;a=Ls(c,!0)}else w(!!this.baseSnapshot,358),a=qs(this.baseSnapshot.trees[o]);t.addWithStats(o,a)})}while(r!==this.contexts.notBoundLength());return t.getSummaryTree()}updateStateBeforeGC(){return v(this,null,function*(){for(let e of this.dataStoresSinceLastGC){let t=this.contexts.get(e);if(w(t!==void 0,694),yield t.isRoot()){let r=new Yn(t,e,this.runtime.IFluidHandleContext);this.runtime.addedGCOutboundReference(this.containerRuntimeHandle,r)}}this.dataStoresSinceLastGC=[]})}getGCData(e=!1){return v(this,null,function*(){let t=new Li;return yield Promise.all(Array.from(this.contexts).filter(([r,i])=>i.attachState===oe.Attached).map(o=>v(this,[o],function*([r,i]){let s=yield i.getGCData(e);t.prefixAndAddNodes(r,s.gcNodes)}))),t.addNode("/",yield this.getOutboundRoutes()),t.getGCData()})}updateUsedRoutes(e,t){var r;let i=qu(e);for(let[o]of i)w(this.contexts.has(o),359);for(let[o,s]of this.contexts)s.updateUsedRoutes((r=i.get(o))!==null&&r!==void 0?r:[],t)}deleteUnusedRoutes(e){for(let t of e){let r=t.split("/");if(r.length>2)continue;let i=r[1];w(this.contexts.has(i),727),this.contexts.delete(i),this.deleteChildSummarizerNodeFn(i)}}getOutboundRoutes(){return v(this,null,function*(){let e=[];for(let[t,r]of this.contexts)(yield r.isRoot())&&e.push(`/${t}`);return e})}getDataStorePackagePath(e){return v(this,null,function*(){var t;let r=this.contexts.get(e.split("/")[1]);return(t=yield r?.getInitialSnapshotDetails())===null||t===void 0?void 0:t.pkg})}getGCNodeType(e){let t=e.split("/");if(this.contexts.has(t[1]))return t.length===2?Zt.DataStore:Zt.SubDataStore}};function ph(n,e){if(n)if(vA(e)){let t=n.trees[Vi.channelsTreeName];return w(!!t,360),t}else{let t={};for(let[r,i]of Object.entries(n.trees))bA.includes(r)||(t[r]=i);return Object.assign(Object.assign({},n),{trees:t})}}Y();var Hi=function(n){return n[n.Local=0]="Local",n[n.Broadcast=1]="Broadcast",n[n.Acked=2]="Acked",n[n.Nacked=-1]="Nacked",n}(Hi||{}),_h=class n{constructor(e,t){this.clientId=e,this.clientSequenceNumber=t,this.state=Hi.Local,this.defSummaryOp=new Se,this.defSummaryAck=new Se}static createLocal(e,t){return new n(e,t)}static createFromOp(e){let t=new n(e.clientId,e.clientSequenceNumber);return t.broadcast(e),t}get summaryOp(){return this._summaryOp}get summaryAckNack(){return this._summaryAckNack}hasBeenAcked(){return this.state===Hi.Acked}broadcast(e){return w(this.state===Hi.Local,373),this._summaryOp=e,this.defSummaryOp.resolve(),this.state=Hi.Broadcast,!0}ackNack(e){return w(this.state===Hi.Broadcast,374),this._summaryAckNack=e,this.defSummaryAck.resolve(),this.state=e.type===dt.SummaryAck?Hi.Acked:Hi.Nacked,!0}waitBroadcast(){return v(this,null,function*(){return yield this.defSummaryOp.promise,this._summaryOp})}waitAckNack(){return v(this,null,function*(){return yield this.defSummaryAck.promise,this._summaryAckNack})}},o0=class{constructor(e,t){this.clientId=e,this.summaryCollection=t,this.localSummaries=new Map,this._disposed=!1}get disposed(){return this._disposed}watchSummary(e){let t=this.localSummaries.get(e);return t||(t=_h.createLocal(this.clientId,e),this.localSummaries.set(t.clientSequenceNumber,t)),t}waitFlushed(){return this.summaryCollection.waitFlushed()}tryGetSummary(e){return this.localSummaries.get(e)}setSummary(e){this.localSummaries.set(e.clientSequenceNumber,e)}dispose(){this.summaryCollection.removeWatcher(this.clientId),this._disposed=!0}},yh=class extends we{constructor(e,t){super(),this.deltaManager=e,this.logger=t,this.summaryWatchers=new Map,this.pendingSummaries=new Map,this.refreshWaitNextAck=new Se,this.deltaManager.on("op",r=>this.handleOp(r))}get latestAck(){return this.lastAck}emit(e,...t){return super.emit(e,...t)}get opsSinceLastAck(){var e,t;return this.deltaManager.lastSequenceNumber-((t=(e=this.lastAck)===null||e===void 0?void 0:e.summaryAck.sequenceNumber)!==null&&t!==void 0?t:this.deltaManager.initialSequenceNumber)}addOpListener(e){this.deltaManager.on("op",e)}removeOpListener(e){this.deltaManager.off("op",e)}createWatcher(e){let t=new o0(e,this);return this.summaryWatchers.set(e,t),t}removeWatcher(e){this.summaryWatchers.delete(e)}setPendingAckTimerTimeoutCallback(e,t){this.maxAckWaitTime=e,this.pendingAckTimerTimeoutCallback=t}unsetPendingAckTimerTimeoutCallback(){this.maxAckWaitTime=void 0,this.pendingAckTimerTimeoutCallback=void 0}waitFlushed(){return v(this,null,function*(){for(;this.pendingSummaries.size>0;){let e=Array.from(this.pendingSummaries,([,t])=>t.waitAckNack());yield Promise.all(e)}return this.lastAck})}waitSummaryAck(e){return v(this,null,function*(){for(;!this.lastAck||this.lastAck.summaryOp.referenceSequenceNumber<e;)yield this.refreshWaitNextAck.promise;return this.lastAck})}handleOp(e){var t;switch(e.type){case dt.Summarize:{this.handleSummaryOp(e);return}case dt.SummaryAck:{this.handleSummaryAck(e);return}case dt.SummaryNack:{this.handleSummaryNack(e);return}default:{let r=e.timestamp;this.lastSummaryTimestamp!==void 0&&this.maxAckWaitTime!==void 0&&r-this.lastSummaryTimestamp>=this.maxAckWaitTime&&((t=this.pendingAckTimerTimeoutCallback)===null||t===void 0||t.call(this)),this.emit("default",e);return}}}handleSummaryOp(e){let t,r=this.summaryWatchers.get(e.clientId);r&&(t=r.tryGetSummary(e.clientSequenceNumber),t&&t.broadcast(e)),t||(t=_h.createFromOp(e),r&&r.setSummary(t)),this.pendingSummaries.set(e.sequenceNumber,t),this.lastSummaryTimestamp=e.timestamp,this.emit(dt.Summarize,e)}handleSummaryAck(e){let t=e.contents.summaryProposal.summarySequenceNumber,r=this.pendingSummaries.get(t);if(!r||r.summaryOp===void 0){t>=this.deltaManager.initialSequenceNumber&&this.logger.sendErrorEvent({eventName:"SummaryAckWithoutOp",sequenceNumber:e.sequenceNumber,summarySequenceNumber:t,initialSequenceNumber:this.deltaManager.initialSequenceNumber});return}r.ackNack(e),this.pendingSummaries.delete(t),(!this.lastAck||t>this.lastAck.summaryAck.contents.summaryProposal.summarySequenceNumber)&&(this.lastAck={summaryOp:r.summaryOp,summaryAck:e},this.refreshWaitNextAck.resolve(),this.refreshWaitNextAck=new Se,this.emit(dt.SummaryAck,e))}handleSummaryNack(e){let t=e.contents.summaryProposal.summarySequenceNumber,r=this.pendingSummaries.get(t);r&&(r.ackNack(e),this.pendingSummaries.delete(t),this.emit(dt.SummaryNack,e))}};Y();Pe();var Ch=class extends we{constructor(e,t,r){super(),this.clientMap=new Map,this.rootNode={sequenceNumber:-1,olderClient:void 0,youngerClient:void 0},this._youngestClient=this.rootNode,this.logger=ue.create(e,"OrderedClientCollection");let i=r.getMembers();for(let[o,s]of i)this.addClient(o,s);r.on("addMember",(o,s)=>{let a=this.addClient(o,s);this.emit("addClient",a,t.lastSequenceNumber)}),r.on("removeMember",o=>{let s=t.lastSequenceNumber,a=this.removeClient(o);a===void 0?this.logger.sendErrorEvent({eventName:"ClientNotFound",clientId:o,sequenceNumber:s}):this.emit("removeClient",a,s)})}get count(){return this.clientMap.size}get oldestClient(){return this.rootNode.youngerClient}addClient(e,t){w(t.sequenceNumber>-1,502);let r=this._youngestClient;for(;r.sequenceNumber>t.sequenceNumber;)w(r.olderClient!==void 0,503),r=r.olderClient;let i={clientId:e,sequenceNumber:t.sequenceNumber,client:Object.assign({},t.client),olderClient:r,youngerClient:r.youngerClient};return i.olderClient.youngerClient=i,i.youngerClient===void 0?this._youngestClient=i:i.youngerClient.olderClient=i,this.clientMap.set(e,i),i}removeClient(e){let t=this.clientMap.get(e);if(t!==void 0)return t.olderClient.youngerClient=t.youngerClient,t.youngerClient===void 0?this._youngestClient=t.olderClient:t.youngerClient.olderClient=t.olderClient,this.clientMap.delete(e),t}getAllClients(){let e=[],t=this.rootNode;for(;t.youngerClient!==void 0;)e.push(t.youngerClient),t=t.youngerClient;return e}},wh=class extends we{constructor(e,t,r,i){super(),this.orderedClientCollection=t,this.isEligibleFn=i,this._eligibleCount=0;let o,s;for(let a of t.getAllClients())this.addClient(a,0),typeof r!="number"&&(a.clientId===r.electedClientId&&(o=a,r.electedParentId===void 0&&a.client.details.type!==Qt&&(s=a)),a.clientId===r.electedParentId&&(s=a));t.on("addClient",(a,c)=>this.addClient(a,c)),t.on("removeClient",(a,c)=>this.removeClient(a,c)),typeof r=="number"?this._electionSequenceNumber=r:(o?.clientId!==r.electedClientId?e.sendErrorEvent({eventName:"InitialElectedClientNotFound",electionSequenceNumber:r.electionSequenceNumber,expectedClientId:r.electedClientId,electedClientId:o?.clientId,clientCount:t.count}):o!==void 0&&!i(o)&&(o=s=this.findFirstEligibleParent(s),e.sendErrorEvent({eventName:"InitialElectedClientIneligible",electionSequenceNumber:r.electionSequenceNumber,expectedClientId:r.electedClientId,electedClientId:o?.clientId})),this._electedParent=s,this._electedClient=o,this._electionSequenceNumber=r.electionSequenceNumber)}get eligibleCount(){return this._eligibleCount}get electionSequenceNumber(){return this._electionSequenceNumber}get electedClient(){return this._electedClient}get electedParent(){return this._electedParent}tryElectingClient(e,t){let r=!1,i=e?.client.details.type===Qt,o=this._electedClient;this._electedClient!==e&&(this._electionSequenceNumber=t,this._electedClient=e,r=!0),this._electedParent!==e&&!i&&(this._electedParent=e,r=!0),r&&this.emit("election",e,t,o)}tryElectingParent(e,t){this._electedParent!==e&&(this._electedParent=e,this.emit("election",this._electedClient,t,this._electedClient))}findFirstEligibleParent(e){let t=e;for(;t!==void 0&&(!this.isEligibleFn(t)||t.client.details.type===Qt);)t=t.youngerClient;return t}addClient(e,t){var r;if(this.isEligibleFn(e)){this._eligibleCount++;let i=e.client.details.type===Qt,o=((r=this._electedClient)===null||r===void 0?void 0:r.client.details.type)===Qt;this._electedClient===void 0||!o&&i?this.tryElectingClient(e,t):this._electedParent===void 0&&!i&&this.tryElectingParent(e,t)}}removeClient(e,t){var r,i,o,s,a;if(this.isEligibleFn(e)){if(this._eligibleCount--,this._electedClient===e)if(this._electedParent!==e){if(this._electedClient.client.details.type!==Qt)throw new ye("Elected client should be a summarizer client 1");this.tryElectingClient(this._electedParent,t)}else{let c=(i=this.findFirstEligibleParent((r=this._electedParent)===null||r===void 0?void 0:r.youngerClient))!==null&&i!==void 0?i:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this.tryElectingClient(c,t)}else if(this._electedParent===e){if(((o=this._electedClient)===null||o===void 0?void 0:o.client.details.type)!==Qt)throw new ye("Elected client should be a summarizer client 2");let c=(a=this.findFirstEligibleParent((s=this._electedParent)===null||s===void 0?void 0:s.youngerClient))!==null&&a!==void 0?a:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this.tryElectingParent(c,t)}}}getAllEligibleClients(){return this.orderedClientCollection.getAllClients().filter(this.isEligibleFn)}incrementElectedClient(e){var t,r;let i=(r=this.findFirstEligibleParent((t=this._electedParent)===null||t===void 0?void 0:t.youngerClient))!==null&&r!==void 0?r:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this._electedClient===void 0||this._electedClient===this._electedParent?this.tryElectingClient(i,e):this.tryElectingParent(i,e)}resetElectedClient(e){let t=this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this._electedClient===void 0||this._electedClient===this._electedParent?this.tryElectingClient(t,e):this.tryElectingParent(t,e)}peekNextElectedClient(){var e,t;return(t=this.findFirstEligibleParent((e=this._electedParent)===null||e===void 0?void 0:e.youngerClient))!==null&&t!==void 0?t:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient)}serialize(){var e,t;return{electionSequenceNumber:this.electionSequenceNumber,electedClientId:(e=this.electedClient)===null||e===void 0?void 0:e.clientId,electedParentId:(t=this.electedParent)===null||t===void 0?void 0:t.clientId}}};var Ph=class{constructor(e,t,r){this.delayWindowMs=e,this.maxDelayMs=t,this.delayFn=r,this.startTimes=[]}get numAttempts(){return this.startTimes.length}getAttempts(){return[...this.startTimes]}get latestAttemptTime(){return this.startTimes.length>0?this.startTimes[this.startTimes.length-1]:void 0}getDelay(){let e=Date.now(),t=this.latestAttemptTime;if(t!==void 0){let i=t-e;i>0&&(this.startTimes=this.startTimes.map(o=>o-i))}this.startTimes=this.startTimes.filter(i=>e-i<this.delayWindowMs);let r=Math.min(this.delayFn(this.startTimes.length),this.maxDelayMs);return this.startTimes.push(e),this.startTimes=this.startTimes.map(i=>i+r),r===this.maxDelayMs&&this.startTimes.shift(),r}},CA=({multiplier:n=2,coefficient:e=1,offset:t=0,initialDelay:r=void 0}={})=>i=>Math.max(0,i<=0&&r!==void 0?r:e*Math.pow(n,i)+t);Y();var iue={cancelled:!1,waitCancelled:new Promise(()=>{})},Oh=class n{constructor(e){this.runtime=e,this._cancelled=!1,this.stopDeferred=new Se}get cancelled(){return this._cancelled||w(this.runtime.deltaManager.active,605),this._cancelled}get waitCancelled(){return this.stopDeferred.promise}static create(e){return v(this,null,function*(){let t=new n(e);return yield t.waitStart(),t})}waitStart(){return v(this,null,function*(){if(this.runtime.disposed){this.stop("summarizerClientDisconnected");return}if(this.runtime.once("dispose",()=>this.stop("summarizerClientDisconnected")),!this.runtime.connected){let e=new Promise(t=>this.runtime.once("connected",t));yield Promise.race([e,this.waitCancelled])}this.runtime.once("disconnected",()=>this.stop("summarizerClientDisconnected"))})}stop(e){this._cancelled||(this._cancelled=!0,this.stopDeferred.resolve(e))}};Y();Pe();var s0=class{constructor(e,t,r,i,o=()=>de.now()){this.batchEventEmitter=e,this.trackedBatchCount=0,this.logger=ue.create(t,"Batching"),this.batchEventEmitter.on("batchBegin",s=>{this.startBatchSequenceNumber=s.sequenceNumber,this.batchProcessingStartTimeStamp=o(),this.trackedBatchCount++}),this.batchEventEmitter.on("batchEnd",(s,a)=>{w(this.startBatchSequenceNumber!==void 0&&this.batchProcessingStartTimeStamp!==void 0,698);let c=a.sequenceNumber-this.startBatchSequenceNumber+1;c>=r&&this.logger.sendErrorEvent({eventName:"LengthTooBig",length:c,threshold:r,batchEndSequenceNumber:a.sequenceNumber,duration:o()-this.batchProcessingStartTimeStamp,batchError:s!==void 0}),this.trackedBatchCount%i===0&&this.logger.sendPerformanceEvent({eventName:"Length",length:c,samplingRate:i,batchEndSequenceNumber:a.sequenceNumber,duration:o()-this.batchProcessingStartTimeStamp}),this.startBatchSequenceNumber=void 0,this.batchProcessingStartTimeStamp=void 0})}},wA=(n,e,t=1e3,r=1e3)=>new s0(n,e,t,r);Y();var $s=class{constructor(e,t){this.storageGetter=e,this.blobs=t}static serializeTree(e,t){return v(this,null,function*(){let r={};return yield this.serializeTreeCore(e,r,t),r})}static serializeTreeCore(e,t,r){return v(this,null,function*(){let i=[];for(let o of Object.values(e.trees))i.push(this.serializeTreeCore(o,t,r));for(let o of Object.values(e.blobs)){let s=yield r.readBlob(o);t[o]=pi(s,"utf8")}return Promise.all(i)})}static serializeTreeWithBlobContents(e){let t={};return this.serializeTreeWithBlobContentsCore(e,t),t}static serializeTreeWithBlobContentsCore(e,t){for(let r of Object.values(e.trees))this.serializeTreeWithBlobContentsCore(r,t);for(let r of Object.values(e.blobs)){let i=e.blobsContents[r];w(!!i,748),t[r]=pi(i,"utf8")}}get storage(){return this._storage?this._storage:(this._storage=this.storageGetter(),this._storage)}get repositoryUrl(){return this.storage.repositoryUrl}readBlob(e){return v(this,null,function*(){return this.blobs[e]!==void 0?Bn(this.blobs[e],"utf8"):this.storage.readBlob(e)})}getSnapshotTree(e){return v(this,null,function*(){return this.storage.getSnapshotTree(e)})}getVersions(e,t){return v(this,null,function*(){return this.storage.getVersions(e,t)})}createBlob(e){return v(this,null,function*(){return this.storage.createBlob(e)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.storage.uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.storage.downloadSummary(e)})}};var Mh=class n{constructor(e,t){this.messageSize=new Map,this._nonSystemOpCount=0,this._opsSizeAccumulator=0,!t&&(e.inbound.on("push",r=>{var i;let o=typeof r.contents=="string"?r.contents:(i=JSON.stringify(r.contents))!==null&&i!==void 0?i:"",s=n.messageHasData(r)?r.data:"";this.messageSize[n.messageId(r)]=o.length+s.length}),e.on("op",r=>{var i;this._nonSystemOpCount+=Ri(r)?1:0;let o=n.messageId(r);this._opsSizeAccumulator+=(i=this.messageSize[o])!==null&&i!==void 0?i:0,this.messageSize.delete(o)}))}get nonSystemOpCount(){return this._nonSystemOpCount}get opsSizeAccumulator(){return this._opsSizeAccumulator}static messageId(e){return e.sequenceNumber}static messageHasData(e){return e.data!==void 0}reset(){this._nonSystemOpCount=0,this._opsSizeAccumulator=0}};var Xe=function(n){return n.FluidDataStoreOp="component",n.Attach="attach",n.ChunkedOp="chunkedOp",n.BlobAttach="blobAttach",n.Rejoin="rejoin",n.Alias="alias",n}(Xe||{}),PA={state:"enabled",idleTime:5e3*3,maxTime:5e3*12,maxOps:100,minOpsForLastSummaryAttempt:10,maxAckWaitTime:6*10*1e3,maxOpsSinceLastSummary:7e3,initialSummarizerDelayMs:5e3,summarizerClientElection:!1},Ir=function(n){return n.wait="wait",n.externalRequest="externalRequest",n.viaHandle="viaHandle",n}(Ir||{}),Yj="Fluid.ContainerRuntime.UseDataStoreAliasing",Zj="Fluid.ContainerRuntime.MaxConsecutiveReconnects",eV="Fluid.ContainerRuntime.MaxOpSizeInBytes",tV=768e3,nV="Fluid.ContainerRuntime.DisableOpTracking",rV=gr.FlushMode.TurnBased;function OA(n){if(n.type===dt.Operation){if(n.contents.address!==void 0&&n.contents.type===void 0)n.type=Xe.FluidDataStoreOp;else{let e=n.contents;w(e.type!==void 0,289),n.type=e.type,n.contents=e.contents}w(yo(n),290)}return n}var a0=class{constructor(e,t){this.deltaManager=e,this.logger=t,this.localPaused=!1,this.timePaused=0,this.batchCount=0,this.deltaManager.on("prepareSend",i=>{if(i.length===0)return;let o=i[0].metadata;if(!o?.batch)return;if(i.length===1){delete o.batch;return}let s=i[i.length-1];s.metadata=Object.assign(Object.assign({},s.metadata),{batch:!1})}),this.deltaManager.inbound.on("push",i=>{this.trackPending(i)}),w(!this.localPaused,659);let r=this.deltaManager.inbound.toArray();for(let i of r)this.trackPending(i);this.deltaManager.on("op",i=>this.afterOpProcessing(i.sequenceNumber))}afterOpProcessing(e){if(w(!this.localPaused,660),this.deltaManager.inbound.length===0){w(this.pauseSequenceNumber===void 0,661);return}this.pauseSequenceNumber!==void 0&&(w(e<this.pauseSequenceNumber,662),e+1===this.pauseSequenceNumber&&this.pauseQueue())}pauseQueue(){w(!this.localPaused,663),this.localPaused=!0,this.timePaused=de.now(),this.deltaManager.inbound.pause()}resumeQueue(e,t){let r=t.sequenceNumber,i=this.localPaused?de.now()-this.timePaused:void 0;this.batchCount++,this.batchCount%1e3===1&&this.logger.sendTelemetryEvent({eventName:"BatchStats",sequenceNumber:r,length:r-e+1,msnDistance:r-t.minimumSequenceNumber,duration:i,batchCount:this.batchCount,interrupted:this.localPaused}),this.localPaused&&(this.localPaused=!1,i!==void 0&&i>Wv&&this.logger.sendErrorEvent({eventName:"MaxBatchWaitTimeExceeded",duration:i,sequenceNumber:r,length:r-e}),this.deltaManager.inbound.resume())}trackPending(e){w(this.deltaManager.inbound.length!==0,664),w(this.currentBatchClientId===void 0==(this.pauseSequenceNumber===void 0),665);let t=e.metadata,r=t?.batch;if(!yo(e)){w(this.currentBatchClientId===void 0,666),w(r===void 0,667),w(!this.localPaused,668);return}if(this.currentBatchClientId===void 0&&r===void 0){w(!this.localPaused,669);return}if((this.currentBatchClientId!==void 0||r===!1)&&this.currentBatchClientId!==e.clientId)throw new Jt("OpBatchIncomplete",Object.assign({runtimeVersion:$c,batchClientId:this.currentBatchClientId},fr(e)));r?(w(this.currentBatchClientId===void 0,670),w(!this.localPaused,671),this.pauseSequenceNumber=e.sequenceNumber,this.currentBatchClientId=e.clientId,this.deltaManager.inbound.length===1&&this.pauseQueue()):r===!1?(w(this.pauseSequenceNumber!==void 0,672),this.resumeQueue(this.pauseSequenceNumber,e),this.pauseSequenceNumber=void 0,this.currentBatchClientId=void 0):w(this.currentBatchClientId!==void 0,673)}},Sh=class{constructor(e,t,r){this.deltaManager=e,this.emitter=t,this.logger=r,this.hitError=!1,this.deltaScheduler=new aA(this.deltaManager,ue.create(this.logger,"DeltaScheduler")),new a0(e,r)}beforeOpProcessing(e){var t;this.batchClientId!==e.clientId&&(w(this.batchClientId===void 0,674),this.emitter.emit("batchBegin",e),this.deltaScheduler.batchBegin(e),((t=e?.metadata)===null||t===void 0?void 0:t.batch)?this.batchClientId=e.clientId:this.batchClientId=void 0)}afterOpProcessing(e,t){var r;if(w(!this.hitError,675),e){this.hitError=!0,this.batchClientId=void 0,this.emitter.emit("batchEnd",e,t),this.deltaScheduler.batchEnd(t);return}let i=(r=t?.metadata)===null||r===void 0?void 0:r.batch;if(this.batchClientId===void 0||i===!1){this.batchClientId=void 0,this.emitter.emit("batchEnd",void 0,t),this.deltaScheduler.batchEnd(t);return}}},c0="_scheduler";function iV(){try{if(typeof navigator=="object"&&navigator!==null)return{deviceMemory:navigator.deviceMemory,hardwareConcurrency:navigator.hardwareConcurrency}}catch{}return{}}var Yc=class n extends we{constructor(e,t,r,i,o,s,a,c,l,h,u,d,p,m){var g,x,b,_,O,S,E,D,I;m===void 0&&(m=Object.assign(Object.assign({},PA),(g=a.summaryOptions)===null||g===void 0?void 0:g.summaryConfigOverrides)),super(),this.context=e,this.registry=t,this.runtimeOptions=a,this.containerScope=c,this.logger=l,this._storage=d,this.requestHandler=p,this.summaryConfiguration=m,this.defaultMaxConsecutiveReconnects=15,this._orderSequentiallyCalls=0,this.needsFlush=!1,this.flushTrigger=!1,this.savedOps=[],this.consecutiveReconnects=0,this._disposed=!1,this.emitDirtyDocumentEvent=!0,this.defaultTelemetrySignalSampleCount=100,this._perfSignalData={signalsLost:0,signalSequenceNumber:0,signalTimestamp:0,trackingSignalSequenceNumber:void 0},this.summarizeOnDemand=(...A)=>{if(this.clientDetails.type===Qt)return this.summarizer.summarizeOnDemand(...A);if(this.summaryManager!==void 0)return this.summaryManager.summarizeOnDemand(...A);throw new ye(`Can't summarize, disableSummaries: ${this.summariesDisabled}`)},this.enqueueSummarize=(...A)=>{if(this.clientDetails.type===Qt)return this.summarizer.enqueueSummarize(...A);if(this.summaryManager!==void 0)return this.summaryManager.enqueueSummarize(...A);throw new ye(`Can't summarize, disableSummaries: ${this.summariesDisabled}`)},this.messageAtLastSummary=r?.message,this.disableIsolatedChannels=(x=this.runtimeOptions.summaryOptions.disableIsolatedChannels)!==null&&x!==void 0?x:!1,this._connected=this.context.connected,this.chunkMap=new Map(o),this.handleContext=new Gu("",this),this.mc=Mn(ue.create(this.logger,"ContainerRuntime")),this.summariesDisabled=this.isSummariesDisabled(),this.heuristicsDisabled=this.isHeuristicsDisabled(),this.summarizerClientElectionEnabled=this.isSummarizerClientElectionEnabled(),this.maxOpsSinceLastSummary=this.getMaxOpsSinceLastSummary(),this.initialSummarizerDelayMs=this.getInitialSummarizerDelayMs(),this._aliasingEnabled=((b=this.mc.config.getBoolean(Yj))!==null&&b!==void 0?b:!1)||((_=a.useDataStoreAliasing)!==null&&_!==void 0?_:!1),this._maxOpSizeInBytes=(O=this.mc.config.getNumber(eV))!==null&&O!==void 0?O:tV,this.maxConsecutiveReconnects=(S=this.mc.config.getNumber(Zj))!==null&&S!==void 0?S:this.defaultMaxConsecutiveReconnects,this._flushMode=a.flushMode;let y=e.pendingLocalState,P=(E=y?.baseSnapshot)!==null&&E!==void 0?E:e.baseSnapshot;this.garbageCollector=uh.create({runtime:this,gcOptions:this.runtimeOptions.gcOptions,baseSnapshot:P,baseLogger:this.mc.logger,existing:h,metadata:r,isSummarizerClient:this.context.clientDetails.type===Qt,getNodePackagePath:A=>v(this,null,function*(){return this.getGCNodePackagePath(A)}),getLastSummaryTimestampMs:()=>{var A;return(A=this.messageAtLastSummary)===null||A===void 0?void 0:A.timestamp},readAndParseBlob:A=>v(this,null,function*(){return et(this.storage,A)})});let C=this.deltaManager.initialSequenceNumber;if(this.summarizerNode=ju(ue.create(this.logger,"SummarizerNode"),(A,F,k)=>v(this,null,function*(){return this.summarizeInternal(A,F,k)}),C,P?C:void 0,{canReuseHandle:!1,throwOnFailure:!0,gcDisabled:!this.garbageCollector.shouldRunGC}),P&&this.summarizerNode.loadBaseSummaryWithoutDifferential(P),this.dataStores=new xh(ph(P,r),this,A=>this.submit(Xe.Attach,A),(A,F)=>(k,T,R)=>this.summarizerNode.createChild(k,A,F,void 0,T,R),A=>this.summarizerNode.deleteChild(A),this.mc.logger,()=>v(this,null,function*(){return this.garbageCollector.getBaseGCDetails()}),(A,F,k)=>this.garbageCollector.nodeUpdated(A,"Changed",F,k),new Map(s),this.garbageCollector.writeDataAtRoot),this.blobManager=new Gs(this.handleContext,u,()=>this.storage,A=>this.submit(Xe.BlobAttach,void 0,void 0,{blobId:A}),A=>this.garbageCollector.nodeUpdated(A,"Loaded"),this,this.logger),this.scheduleManager=new Sh(e.deltaManager,this,ue.create(this.logger,"ScheduleManager")),this.deltaSender=this.deltaManager,this.pendingStateManager=new ah({applyStashedOp:this.applyStashedOp.bind(this),clientId:()=>this.clientId,close:this.closeFn,connected:()=>this.connected,flush:this.flush.bind(this),flushMode:()=>this.flushMode,reSubmit:this.reSubmit.bind(this),rollback:this.rollback.bind(this),setFlushMode:A=>this.setFlushMode(A)},this._flushMode,y?.pending),this.context.quorum.on("removeMember",A=>{this.clearPartialChunks(A)}),this.summaryCollection=new yh(this.deltaManager,this.logger),this.dirtyContainer=this.context.attachState!==oe.Attached||this.pendingStateManager.hasPendingMessages(),this.context.updateDirtyContainerState(this.dirtyContainer),this.summariesDisabled)this.mc.logger.sendTelemetryEvent({eventName:"SummariesDisabled"});else{let A=ue.create(this.logger,"OrderedClientElection"),F=new Ch(A,this.context.deltaManager,this.context.quorum),k=new wh(A,F,i??this.context.deltaManager.lastSequenceNumber,Wu.isClientEligible);if(this.summarizerClientElection=new Wu(A,this.summaryCollection,k,this.maxOpsSinceLastSummary,this.summarizerClientElectionEnabled),this.context.clientDetails.type===Qt)this._summarizer=new oh("/_summarizer",this,()=>this.summaryConfiguration,this,this.handleContext,this.summaryCollection,T=>v(this,null,function*(){return Oh.create(T)}));else if(Wu.clientDetailsPermitElection(this.context.clientDetails)){let T=()=>{this.summaryCollection.opsSinceLastAck>this.maxOpsSinceLastSummary&&(this.logger.sendErrorEvent({eventName:"SummaryStatus:Behind"}),this.summaryCollection.once(dt.SummaryAck,()=>{this.logger.sendTelemetryEvent({eventName:"SummaryStatus:CaughtUp"}),this.summaryCollection.on("default",T)}),this.summaryCollection.off("default",T))};this.summaryCollection.on("default",T),this.summaryManager=new sA(this.summarizerClientElection,this,this.summaryCollection,this.logger,this.formRequestSummarizerFn(this.context.loader),new Ph(60*1e3,30*1e3,CA({coefficient:20,initialDelay:0})),{initialDelayMs:this.initialSummarizerDelayMs},this.heuristicsDisabled),this.summaryManager.start()}}this.deltaManager.on("readonly",A=>{w(A===this.deltaManager.readOnlyInfo.readonly,292),w(!A||!this.connected,293),this.replayPendingStates()}),l.sendTelemetryEvent(Object.assign({eventName:"DeviceSpec"},iV()));let M;h?(this.createContainerMetadata={createContainerRuntimeVersion:r?.createContainerRuntimeVersion,createContainerTimestamp:r?.createContainerTimestamp},M=(I=(D=r?.summaryNumber)!==null&&D!==void 0?D:r?.summaryCount)!==null&&I!==void 0?I:0):(this.createContainerMetadata={createContainerRuntimeVersion:$c,createContainerTimestamp:Date.now()},M=0),this.nextSummaryNumber=M+1,this.logger.sendTelemetryEvent(Object.assign(Object.assign(Object.assign({eventName:"ContainerLoadStats"},this.createContainerMetadata),this.dataStores.containerLoadStats),{summaryNumber:M,summaryFormatVersion:r?.summaryFormatVersion,disableIsolatedChannels:r?.disableIsolatedChannels,gcVersion:r?.gcFeature})),cA(this.context.clientId,this.deltaManager,this.logger),wA(this,this.logger),this.opTracker=new Mh(this.deltaManager,this.mc.config.getBoolean(nV)===!0)}get IContainerRuntime(){return this}get IFluidRouter(){return this}static load(a,c,l){return v(this,arguments,function*(e,t,r,i={},o=e.scope,s){var h,u,d;let p=e,m=(h=p.taggedLogger)!==null&&h!==void 0?h:new xc(p.logger),g=ue.create(m,void 0,{all:{runtimeVersion:$c}}),{summaryOptions:x={},gcOptions:b={},loadSequenceNumberVerification:_="close",useDataStoreAliasing:O=!1,flushMode:S=rV,enableOfflineLoad:E=!1}=i,D=e.pendingLocalState,I=(u=D?.baseSnapshot)!==null&&u!==void 0?u:e.baseSnapshot,y=D?new $s(()=>e.storage,D.snapshotBlobs):e.storage,P=new Kr(t),C=V=>v(this,null,function*(){let G=I?.blobs[V];if(I&&G)return w(y!==void 0,501),et(y,G)}),[M,A,F,k]=yield Promise.all([C(t0),C(Xc),C(n0),C(e0)]),T=s===!0||e.existing===!0,R=yield Gs.load(I?.trees[fh],V=>v(this,null,function*(){return w(y!==void 0,598),et(y,V)})),N=(d=A?.message)===null||d===void 0?void 0:d.sequenceNumber;if(!D&&N!==void 0){let V=e.deltaManager.initialSequenceNumber;if(_!=="bypass"&&N!==V){let G=new Jt("Summary metadata mismatch",{runtimeVersion:$c,runtimeSequenceNumber:N,protocolSequenceNumber:V});_==="log"?g.sendErrorEvent({eventName:"SequenceNumberMismatch"},G):e.closeFn(G)}}let q=new n(e,P,A,F,M??[],k??[],{summaryOptions:x,gcOptions:b,loadSequenceNumberVerification:_,useDataStoreAliasing:O,flushMode:S,enableOfflineLoad:E},o,g,T,R,y,r);return D&&(yield q.processSavedOps(D),D.savedOps=[]),yield q.getSnapshotBlobs(),q})}get options(){return this.context.options}get clientId(){return this.context.clientId}get clientDetails(){return this.context.clientDetails}get deltaManager(){return this.context.deltaManager}get storage(){return this._storage}get reSubmitFn(){return this.reSubmit}get closeFn(){return this.context.closeFn}get flushMode(){return this._flushMode}get scope(){return this.containerScope}get IFluidDataStoreRegistry(){return this.registry}get attachState(){return this.context.attachState}get IFluidHandleContext(){return this.handleContext}get connected(){return this._connected}get summarizerClientId(){var e;return(e=this.summarizerClientElection)===null||e===void 0?void 0:e.electedClientId}get disposed(){return this._disposed}get summarizer(){return w(this._summarizer!==void 0,599),this._summarizer}isSummariesDisabled(){return this.runtimeOptions.summaryOptions.disableSummaries===!0?!0:this.summaryConfiguration.state==="disabled"}isHeuristicsDisabled(){var e;return((e=this.runtimeOptions.summaryOptions.summarizerOptions)===null||e===void 0?void 0:e.disableHeuristics)===!0?!0:this.summaryConfiguration.state==="disableHeuristics"}isSummarizerClientElectionEnabled(){var e;return this.mc.config.getBoolean("Fluid.ContainerRuntime.summarizerClientElection")?(e=this.mc.config.getBoolean("Fluid.ContainerRuntime.summarizerClientElection"))!==null&&e!==void 0?e:!0:this.runtimeOptions.summaryOptions.summarizerClientElection===!0?!0:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.summarizerClientElection===!0:!1}getMaxOpsSinceLastSummary(){return this.runtimeOptions.summaryOptions.maxOpsSinceLastSummary!==void 0?this.runtimeOptions.summaryOptions.maxOpsSinceLastSummary:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.maxOpsSinceLastSummary:0}getInitialSummarizerDelayMs(){return this.runtimeOptions.summaryOptions.initialSummarizerDelayMs!==void 0?this.runtimeOptions.summaryOptions.initialSummarizerDelayMs:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.initialSummarizerDelayMs:0}dispose(e){var t;this._disposed||(this._disposed=!0,this.logger.sendTelemetryEvent({eventName:"ContainerRuntimeDisposed",isDirty:this.isDirty,lastSequenceNumber:this.deltaManager.lastSequenceNumber,attachState:this.attachState},e),this.summaryManager!==void 0&&this.summaryManager.dispose(),this.garbageCollector.dispose(),(t=this._summarizer)===null||t===void 0||t.dispose(),this.dataStores.dispose(),this.pendingStateManager.dispose(),this.emit("dispose"),this.removeAllListeners())}get IFluidTokenProvider(){var e;if(!((e=this.options)===null||e===void 0)&&e.intelligence)return{intelligence:this.options.intelligence}}request(e){return v(this,null,function*(){try{let t=Sn.create(e);return t.pathParts[0]==="_summarizer"&&t.pathParts.length===1?this._summarizer!==void 0?{status:200,mimeType:"fluid/object",value:this.summarizer}:zt(e):this.requestHandler!==void 0?this.requestHandler(t,this):zt(e)}catch(t){return Ni(t)}})}resolveHandle(e){return v(this,null,function*(){try{let t=Sn.create(e),r=t.pathParts[0];if(r==="_channels")return this.resolveHandle(t.createSubRequest(1));if(r===Gs.basePath&&t.isLeaf(2)){let i=yield this.blobManager.getBlob(t.pathParts[1]);return i?{status:200,mimeType:"fluid/object",value:i.get()}:zt(e)}else if(t.pathParts.length>0){let i=yield this.getDataStoreFromRequest(r,e),o=t.createSubRequest(1);return w(o.url.startsWith("/"),294),i.IFluidRouter.request(o)}return zt(e)}catch(t){return Ni(t)}})}internalId(e){var t;return(t=this.dataStores.aliases().get(e))!==null&&t!==void 0?t:e}getDataStoreFromRequest(e,t){return v(this,null,function*(){var r,i,o;let s=typeof((r=t.headers)===null||r===void 0?void 0:r[Ir.wait])=="boolean"?(i=t.headers)===null||i===void 0?void 0:i[Ir.wait]:!0,a=this.internalId(e),c=yield this.dataStores.getDataStore(a,s);if(!((o=t.headers)===null||o===void 0)&&o[Ir.externalRequest]&&this.garbageCollector.shouldRunGC){let u=(yield c.getBaseGCDetails()).usedRoutes;if(!(u===void 0||u.includes("")||u.includes("/")))throw Bi(zt(t),t)}let l=yield c.realize(),h=RE(t.url.split("?")[0]);return this.garbageCollector.nodeUpdated(`/${h}`,"Loaded",void 0,c.packagePath,t?.headers),l})}addMetadataToSummary(e){var t;let r=Object.assign(Object.assign(Object.assign(Object.assign({},this.createContainerMetadata),{summaryCount:this.nextSummaryNumber,summaryNumber:this.nextSummaryNumber++,summaryFormatVersion:1,disableIsolatedChannels:this.disableIsolatedChannels||void 0}),this.garbageCollector.getMetadata()),{message:(t=mA(this.deltaManager.lastMessage))!==null&&t!==void 0?t:this.messageAtLastSummary});En(e,Xc,JSON.stringify(r))}addContainerStateToSummary(e,t,r,i){var o;if(this.addMetadataToSummary(e),this.chunkMap.size>0){let c=JSON.stringify([...this.chunkMap]);En(e,t0,c)}let s=this.dataStores.aliases();if(s.size>0&&En(e,e0,JSON.stringify([...s])),this.summarizerClientElection){let c=JSON.stringify((o=this.summarizerClientElection)===null||o===void 0?void 0:o.serialize());En(e,n0,c)}let a=this.blobManager.summarize();if(Object.keys(a.summary.tree).length>0&&Tv(e,fh,a),this.garbageCollector.writeDataAtRoot){let c=this.garbageCollector.summarize(t,r,i);c!==void 0&&Dv(e,zr,c)}}shouldContinueReconnecting(){return this.maxConsecutiveReconnects<=0?!0:this.pendingStateManager.hasPendingMessages()?(this.consecutiveReconnects===Math.floor(this.maxConsecutiveReconnects/2)&&this.mc.logger.sendTelemetryEvent({eventName:"ReconnectsWithNoProgress",attempts:this.consecutiveReconnects,pendingMessages:this.pendingStateManager.pendingMessagesCount}),this.consecutiveReconnects<this.maxConsecutiveReconnects):(this.resetReconnectCount(),!0)}resetReconnectCount(){this.consecutiveReconnects=0}replayPendingStates(){if(!this.canSendOps())return;let e=this.dirtyContainer;this.dirtyContainer=!1,w(this.emitDirtyDocumentEvent,295),this.emitDirtyDocumentEvent=!1;let t;try{this.pendingStateManager.replayPendingStates()}finally{t=this.dirtyContainer,this.dirtyContainer=e,this.emitDirtyDocumentEvent=!0}this.updateDocumentDirtyState(t)}applyStashedOp(e,t){return v(this,null,function*(){switch(e){case Xe.FluidDataStoreOp:return this.dataStores.applyStashedOp(t);case Xe.Attach:return this.dataStores.applyStashedAttachOp(t);case Xe.Alias:case Xe.BlobAttach:return;case Xe.ChunkedOp:throw new Error("chunkedOp not expected here");case Xe.Rejoin:throw new Error("rejoin not expected here");default:vt(e,`Unknown ContainerMessageType: ${e}`)}})}setConnectionState(e,t){this.verifyNotClosed();let r=this._connected!==e,i=r&&e;if(this._connected=e,e||(this._perfSignalData.signalsLost=0,this._perfSignalData.signalTimestamp=0,this._perfSignalData.trackingSignalSequenceNumber=void 0),i&&(this.consecutiveReconnects++,!this.shouldContinueReconnecting())){this.closeFn(Ot.create("Runtime detected too many reconnects with no progress syncing local ops","setConnectionState",void 0,{dataLoss:1,attempts:this.consecutiveReconnects,pendingMessages:this.pendingStateManager.pendingMessagesCount}));return}r&&this.replayPendingStates(),this.dataStores.setConnectionState(e,t),po(this.mc.logger,this,e,t)}process(e,t){var r,i;if(this.verifyNotClosed(),!yo(e))return;((r=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&r!==void 0?r:this.runtimeOptions.enableOfflineLoad)&&this.savedOps.push(e);let o=Object.assign({},e);this.scheduleManager.beforeOpProcessing(o);try{o=OA(o),o=this.processRemoteChunkedMessage(o);let s;switch(t&&o.type!==Xe.ChunkedOp&&(s=this.pendingStateManager.processPendingLocalMessage(o)),this.pendingStateManager.hasPendingMessages()||this.updateDocumentDirtyState(!1),o.type){case Xe.Attach:this.dataStores.processAttachMessage(o,t);break;case Xe.Alias:this.processAliasMessage(o,s,t);break;case Xe.FluidDataStoreOp:this.dataStores.processFluidDataStoreOp(o,t,s);break;case Xe.BlobAttach:w((i=o?.metadata)===null||i===void 0?void 0:i.blobId,298),this.blobManager.processBlobAttachOp(o.metadata.blobId,t);break;default:}this.emit("op",o),this.scheduleManager.afterOpProcessing(void 0,o),t&&this.resetReconnectCount()}catch(s){throw this.scheduleManager.afterOpProcessing(s,o),s}}processAliasMessage(e,t,r){this.dataStores.processAliasMessage(e,t,r)}sendSignalTelemetryEvent(e){let t=Date.now()-this._perfSignalData.signalTimestamp;this.logger.sendPerformanceEvent({eventName:"SignalLatency",duration:t,signalsLost:this._perfSignalData.signalsLost}),this._perfSignalData.signalsLost=0,this._perfSignalData.signalTimestamp=0}processSignal(e,t){let r=e.content,i={clientId:e.clientId,content:r.contents.content,type:r.contents.type};if(e.clientId===this.clientId&&this.connected&&(this._perfSignalData.trackingSignalSequenceNumber!==void 0&&r.clientSignalSequenceNumber>this._perfSignalData.trackingSignalSequenceNumber?(this._perfSignalData.signalsLost++,this._perfSignalData.trackingSignalSequenceNumber=void 0,this.logger.sendErrorEvent({eventName:"SignalLost",type:r.contents.type,signalsLost:this._perfSignalData.signalsLost,trackingSequenceNumber:this._perfSignalData.trackingSignalSequenceNumber,clientSignalSequenceNumber:r.clientSignalSequenceNumber})):r.clientSignalSequenceNumber===this._perfSignalData.trackingSignalSequenceNumber&&(this.sendSignalTelemetryEvent(r.clientSignalSequenceNumber),this._perfSignalData.trackingSignalSequenceNumber=void 0)),r.address===void 0){this.emit("signal",i,t);return}this.dataStores.processSignal(r.address,i,t)}getRootDataStore(e,t=!0){return v(this,null,function*(){let r=this.internalId(e),i=yield this.dataStores.getDataStore(r,t);return w(yield i.isRoot(),299),i.realize()})}setFlushMode(e){e!==this._flushMode&&(this.mc.logger.sendTelemetryEvent({eventName:"FlushMode Updated",old:this._flushMode,new:e}),e===gr.FlushMode.Immediate&&this.flush(),this._flushMode=e,this.pendingStateManager.onFlushModeUpdated(e))}flush(){if(w(this._orderSequentiallyCalls===0,588),!!this.deltaSender&&(this.pendingStateManager.onFlush(),!!this.needsFlush&&(this.needsFlush=!1,!!this.canSendOps())))return this.deltaSender.flush()}orderSequentially(e){if(this.flushMode===gr.FlushMode.TurnBased){this.trackOrderSequentiallyCalls(e);return}let t=this.flushMode;this.setFlushMode(gr.FlushMode.TurnBased);try{this.trackOrderSequentiallyCalls(e),this.flush()}finally{this.setFlushMode(t)}}trackOrderSequentiallyCalls(e){let t;this.mc.config.getBoolean("Fluid.ContainerRuntime.EnableRollback")&&(t=this.pendingStateManager.checkpoint());try{this._orderSequentiallyCalls++,e()}catch(r){throw t?t.rollback():this.closeFn(new xn("orderSequentially callback exception",r)),r}finally{this._orderSequentiallyCalls--}}createDataStore(e){return v(this,null,function*(){let t=ke();return bh(yield this._createDataStore(e,!1,t),t,this,this.dataStores,this.mc.logger)})}createRootDataStoreLegacy(e,t){return v(this,null,function*(){let r=yield this._createDataStore(e,!0,t);return r.makeVisibleAndAttachGraph!==void 0?r.makeVisibleAndAttachGraph():r.bindToContext(),r})}createRootDataStore(e,t){return v(this,null,function*(){if(t.includes("/"))throw new ye(`Id cannot contain slashes: '${t}'`);return this._aliasingEnabled===!0?this.createAndAliasDataStore(e,t):this.createRootDataStoreLegacy(e,t)})}createAndAliasDataStore(e,t,r){return v(this,null,function*(){let i=ke(),o=yield this._createDataStore(e,!1,i,r),s=bh(o,i,this,this.dataStores,this.mc.logger),a=yield s.trySetAlias(t);if(a!=="Success")throw new xn("dataStoreAliasFailure",void 0,{alias:{value:t,tag:Ne.UserData},internalId:{value:i,tag:Ne.PackageData},aliasResult:a});return s})}createDetachedRootDataStore(e,t){if(t.includes("/"))throw new ye(`Id cannot contain slashes: '${t}'`);return this.dataStores.createDetachedDataStoreCore(e,!0,t)}createDetachedDataStore(e){return this.dataStores.createDetachedDataStoreCore(e,!1)}_createDataStoreWithPropsLegacy(o,s){return v(this,arguments,function*(e,t,r=ke(),i=!1){let a=yield this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],r,i,t).realize();return i&&(a.makeVisibleAndAttachGraph!==void 0?a.makeVisibleAndAttachGraph():a.bindToContext(),this.logger.sendTelemetryEvent({eventName:"Root datastore with props",hasProps:t!==void 0})),bh(a,r,this,this.dataStores,this.mc.logger)})}_createDataStoreWithProps(o,s){return v(this,arguments,function*(e,t,r=ke(),i=!1){return this._aliasingEnabled===!0&&i?this.createAndAliasDataStore(e,r,t):this._createDataStoreWithPropsLegacy(e,t,r,i)})}_createDataStore(o,s){return v(this,arguments,function*(e,t,r=ke(),i){return this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],r,t,i).realize()})}canSendOps(){return this.connected&&!this.deltaManager.readOnlyInfo.readonly}getQuorum(){return this.context.quorum}getAudience(){return this.context.audience}get isDirty(){return this.dirtyContainer}isContainerMessageDirtyable(e,t){if(e===Xe.Attach){if(t.id===c0)return!1}else if(e===Xe.FluidDataStoreOp&&t.address===c0)return!1;return!0}createNewSignalEnvelope(e,t,r){let i=++this._perfSignalData.signalSequenceNumber,o={address:e,clientSignalSequenceNumber:i,contents:{type:t,content:r}};return i%this.defaultTelemetrySignalSampleCount===1&&this._perfSignalData.trackingSignalSequenceNumber===void 0&&(this._perfSignalData.signalTimestamp=Date.now(),this._perfSignalData.trackingSignalSequenceNumber=i),o}submitSignal(e,t){this.verifyNotClosed();let r=this.createNewSignalEnvelope(void 0,e,t);return this.context.submitSignalFn(r)}submitDataStoreSignal(e,t,r){let i=this.createNewSignalEnvelope(e,t,r);return this.context.submitSignalFn(i)}setAttachState(e){e===oe.Attaching?w(this.attachState===oe.Attaching,301):(w(this.attachState===oe.Attached,302),this.emit("attached")),e===oe.Attached&&!this.pendingStateManager.hasPendingMessages()&&this.updateDocumentDirtyState(!1),this.dataStores.setAttachState(e)}createSummary(e,t){e&&this.blobManager.setRedirectTable(e);let r=this.dataStores.createSummary(t);return this.disableIsolatedChannels||Ws(r),this.addContainerStateToSummary(r,!0,!1,t),r.summary}getAbsoluteUrl(e){return v(this,null,function*(){if(this.context.getAbsoluteUrl===void 0)throw new Error("Driver does not implement getAbsoluteUrl");if(this.attachState===oe.Attached)return this.context.getAbsoluteUrl(e)})}summarizeInternal(e,t,r){return v(this,null,function*(){let i=yield this.dataStores.summarize(e,t,r),o;return this.disableIsolatedChannels||(Ws(i),o=[gr.channelsTreeName]),this.addContainerStateToSummary(i,e,t,r),Object.assign(Object.assign({},i),{id:"",pathPartsForChildren:o})})}summarize(e){return v(this,null,function*(){this.verifyNotClosed();let{fullTree:t=!1,trackState:r=!0,summaryLogger:i=this.mc.logger,runGC:o=this.garbageCollector.shouldRunGC,runSweep:s,fullGC:a}=e,c;o&&(c=yield this.collectGarbage({logger:i,runSweep:s,fullGC:a}));let l=new Lc,{stats:h,summary:u}=yield this.summarizerNode.summarize(t,r,l);return this.logger.sendTelemetryEvent({eventName:"SummarizeTelemetry",details:l.serialize()}),w(u.type===Fr.Tree,303),{stats:h,summary:u,gcStats:c}})}updateStateBeforeGC(){return v(this,null,function*(){return this.dataStores.updateStateBeforeGC()})}getGCData(e){return v(this,null,function*(){let t=new Li,r=yield this.dataStores.getGCData(e);t.addNodes(r.gcNodes);let i=this.blobManager.getGCData(e);return t.addNodes(i.gcNodes),t.getGCData()})}updateUsedRoutes(e,t){this.summarizerNode.updateUsedRoutes([""]);let r=[];for(let i of e)i.split("/")[1]!==Gs.basePath&&r.push(i);return this.dataStores.updateUsedRoutes(r,t)}deleteUnusedRoutes(e){let t=[],r=[];for(let i of e)this.isBlobPath(i)?t.push(i):r.push(i);this.blobManager.deleteUnusedRoutes(t),this.dataStores.deleteUnusedRoutes(r)}getCurrentReferenceTimestampMs(){var e,t,r;return(t=(e=this.deltaManager.lastMessage)===null||e===void 0?void 0:e.timestamp)!==null&&t!==void 0?t:(r=this.messageAtLastSummary)===null||r===void 0?void 0:r.timestamp}getNodeType(e){var t;return this.isBlobPath(e)?Zt.Blob:(t=this.dataStores.getGCNodeType(e))!==null&&t!==void 0?t:Zt.Other}getGCNodePackagePath(e){return v(this,null,function*(){switch(this.getNodeType(e)){case Zt.Blob:return["_blobs"];case Zt.DataStore:case Zt.SubDataStore:return this.dataStores.getDataStorePackagePath(e);default:w(!1,734)}})}isBlobPath(e){let t=e.split("/");return!(t.length<2||t[1]!==Gs.basePath)}collectGarbage(e){return v(this,null,function*(){return this.garbageCollector.collectGarbage(e)})}addedGCOutboundReference(e,t){this.garbageCollector.addedOutboundReference(e.absolutePath,t.absolutePath)}submitSummary(e){return v(this,null,function*(){var t,r,i;let{fullTree:o,refreshLatestAck:s,summaryLogger:a}=e,c=this.nextSummaryNumber,l=ue.create(a,void 0,{all:{summaryNumber:c}}),h;if(s){let u=yield this.refreshLatestSummaryAckFromServer(ue.create(l,void 0,{all:{safeSummary:!0}})),d=u.latestSnapshotRefSeq;h=u.latestSnapshotVersionId,d>this.deltaManager.lastSequenceNumber&&(yield le.timedExecAsync(l,{eventName:"WaitingForSeq",lastSequenceNumber:this.deltaManager.lastSequenceNumber,targetSequenceNumber:d,lastKnownSeqNumber:this.deltaManager.lastKnownSeqNumber},()=>v(this,null,function*(){return oV(this.deltaManager,d)}),{start:!0,end:!0,cancel:"error"}))}try{yield this.deltaManager.inbound.pause();let u=this.deltaManager.lastSequenceNumber,d=this.deltaManager.minimumSequenceNumber,p=`Summary @${u}:${this.deltaManager.minimumSequenceNumber}`;u!==((t=this.deltaManager.lastMessage)===null||t===void 0?void 0:t.sequenceNumber)&&l.sendErrorEvent({eventName:"LastSequenceMismatch",error:p}),this.summarizerNode.startSummary(u,l);let m=()=>e.cancellationToken.cancelled?{continue:!1,error:"disconnected"}:(w(this.connected,600),this.deltaManager.lastSequenceNumber!==u?{continue:!1,error:`lastSequenceNumber changed before uploading to storage. ${this.deltaManager.lastSequenceNumber} !== ${u}`}:{continue:!0}),g=m();if(!g.continue)return{stage:"base",referenceSequenceNumber:u,minimumSequenceNumber:d,error:g.error};let x=ls.start(),b,_=this.garbageCollector.summaryStateNeedsReset;try{b=yield this.summarize({fullTree:o||_,trackState:!0,summaryLogger:l,runGC:this.garbageCollector.shouldRunGC})}catch(q){return{stage:"base",referenceSequenceNumber:u,minimumSequenceNumber:d,error:q}}let{summary:O,stats:S}=b;this.messageAtLastSummary=this.deltaManager.lastMessage;let E=this.disableIsolatedChannels?O:O.tree[gr.channelsTreeName];w(E.type===Fr.Tree,508);let D=Object.values(E.tree).filter(q=>q.type===Fr.Handle).length,I=O.tree[zr]?qc(O.tree[zr]):void 0,y=Object.assign({dataStoreCount:this.dataStores.size,summarizedDataStoreCount:this.dataStores.size-D,gcStateUpdatedDataStoreCount:(r=b.gcStats)===null||r===void 0?void 0:r.updatedDataStoreCount,gcBlobNodeCount:I?.blobNodeCount,gcTotalBlobsSize:I?.totalBlobSize,opsSizesSinceLastSummary:this.opTracker.opsSizeAccumulator,nonSystemOpsSinceLastSummary:this.opTracker.nonSystemOpCount,summaryNumber:c},S),P={referenceSequenceNumber:u,minimumSequenceNumber:d,summaryTree:O,summaryStats:y,generateDuration:x.trace().duration,forcedFullTree:_};if(g=m(),!g.continue)return Object.assign(Object.assign({stage:"generate"},P),{error:g.error});let C=this.summaryCollection.latestAck,M;C?.summaryAck.contents.handle!==h&&h!==void 0?M={proposalHandle:void 0,ackHandle:h,referenceSequenceNumber:u}:C===void 0?M={proposalHandle:void 0,ackHandle:(i=this.context.getLoadedFromVersion())===null||i===void 0?void 0:i.id,referenceSequenceNumber:u}:M={proposalHandle:C.summaryOp.contents.handle,ackHandle:C.summaryAck.contents.handle,referenceSequenceNumber:u};let A;try{A=yield this.storage.uploadSummaryWithContext(b.summary,M)}catch(q){return Object.assign(Object.assign({stage:"generate"},P),{error:q})}let F=M.ackHandle,k={handle:A,head:F,message:p,parents:F?[F]:[]},T=Object.assign(Object.assign({},P),{handle:A,uploadDuration:x.trace().duration});if(g=m(),!g.continue)return Object.assign(Object.assign({stage:"upload"},T),{error:g.error});let R;try{R=this.submitSystemMessage(dt.Summarize,k)}catch(q){return Object.assign(Object.assign({stage:"upload"},T),{error:q})}let N=Object.assign(Object.assign({stage:"submit"},T),{clientSequenceNumber:R,submitOpDuration:x.trace().duration});return this.summarizerNode.completeSummary(A),this.opTracker.reset(),N}finally{this.summarizerNode.clearSummary(),this.deltaManager.inbound.resume()}})}processRemoteChunkedMessage(e){if(e.type!==Xe.ChunkedOp)return e;let t=e.clientId,r=e.contents;if(this.addChunk(t,r),r.chunkId===r.totalChunks){let i=Object.assign({},e),o=this.chunkMap.get(t).join("");return i.contents=JSON.parse(o),i.type=r.originalType,this.clearPartialChunks(t),i}return e}addChunk(e,t){let r=this.chunkMap.get(e);r===void 0&&(r=[],this.chunkMap.set(e,r)),w(t.chunkId===r.length+1,305),r.push(t.contents)}clearPartialChunks(e){this.chunkMap.has(e)&&this.chunkMap.delete(e)}updateDocumentDirtyState(e){this.dirtyContainer!==e&&(this.dirtyContainer=e,this.emitDirtyDocumentEvent&&(this.emit(e?"dirty":"saved"),this.context.updateDirtyContainerState(e)))}submitDataStoreOp(e,t,r=void 0){let i={address:e,contents:t};this.submit(Xe.FluidDataStoreOp,i,r)}submitDataStoreAliasOp(e,t){if(!vh(e))throw new ye("malformedDataStoreAliasMessage");this.submit(Xe.Alias,e,t)}uploadBlob(e){return v(this,null,function*(){return this.verifyNotClosed(),this.blobManager.createBlob(e)})}submit(e,t,r=void 0,i=void 0){this.verifyNotClosed(),w(this.attachState!==oe.Detached,306);let o=-1,s=i;if(this.canSendOps()){let a=JSON.stringify(t),c=this.context.deltaManager.maxMessageSize;this.flushMode===gr.FlushMode.TurnBased&&!this.needsFlush&&(s=Object.assign(Object.assign({},i),{batch:!0}),this.needsFlush=!0,this.flushTrigger||Promise.resolve().then(()=>{this.flushTrigger=!1,this.flush()})),o=this.submitMaybeChunkedMessages(e,t,a,c,this._flushMode===gr.FlushMode.TurnBased,s)}this.pendingStateManager.onSubmitMessage(e,o,this.deltaManager.lastSequenceNumber,t,r,s),this.isContainerMessageDirtyable(e,t)&&this.updateDocumentDirtyState(!0)}submitMaybeChunkedMessages(e,t,r,i,o,s=void 0){return this._maxOpSizeInBytes>=0?!r||r.length<=this._maxOpSizeInBytes?this.submitRuntimeMessage(e,t,o,s):(this.closeFn(new xn("OpTooLarge",void 0,{length:{value:r.length,tag:Ne.PackageData},limit:{value:this._maxOpSizeInBytes,tag:Ne.PackageData}})),-1):!r||r.length<=i?this.submitRuntimeMessage(e,t,o,s):this.submitChunkedMessage(e,r,i)}submitChunkedMessage(e,t,r){let i=t.length,o=Math.floor((i-1)/r)+1,s=0,a=0;for(let c=1;c<=o;c=c+1){let l={chunkId:c,contents:t.substr(s,r),originalType:e,totalChunks:o};s+=r,a=this.submitRuntimeMessage(Xe.ChunkedOp,l,!1)}return a}submitSystemMessage(e,t){this.verifyNotClosed(),w(this.connected,307);let r=this.flushMode===gr.FlushMode.TurnBased&&this.needsFlush;return r&&this.mc.logger.sendErrorEvent({eventName:"submitSystemMessageError",type:e}),this.context.submitFn(e,t,r)}submitRuntimeMessage(e,t,r,i){this.verifyNotClosed(),w(this.connected,601);let o={type:e,contents:t};return this.context.submitFn(dt.Operation,o,r,i)}verifyNotClosed(){if(this._disposed)throw new Error("Runtime is closed")}reSubmit(e,t,r,i){switch(e){case Xe.FluidDataStoreOp:this.dataStores.resubmitDataStoreOp(t,r);break;case Xe.Attach:case Xe.Alias:this.submit(e,t,r);break;case Xe.ChunkedOp:throw new Error("chunkedOp not expected here");case Xe.BlobAttach:this.submit(e,t,r,i);break;case Xe.Rejoin:this.submit(e,t);break;default:vt(e,`Unknown ContainerMessageType: ${e}`)}}rollback(e,t,r){switch(e){case Xe.FluidDataStoreOp:this.dataStores.rollbackDataStoreOp(t,r);break;default:throw new Error(`Can't rollback ${e}`)}}refreshLatestSummaryAck(e,t,r,i){return v(this,null,function*(){let o=c=>v(this,null,function*(){return et(this.storage,c)}),{snapshotTree:s}=yield this.fetchSnapshotFromStorage(t,i,{eventName:"RefreshLatestSummaryGetSnapshot",ackHandle:t,summaryRefSeq:r,fetchLatest:!1}),a=yield this.summarizerNode.refreshLatestSummary(e,r,()=>v(this,null,function*(){return s}),o,i);yield this.garbageCollector.latestSummaryStateRefreshed(a,o)})}refreshLatestSummaryAckFromServer(e){return v(this,null,function*(){let{snapshotTree:t,versionId:r}=yield this.fetchSnapshotFromStorage(null,e,{eventName:"RefreshLatestSummaryGetSnapshot",fetchLatest:!0}),i=a=>v(this,null,function*(){return et(this.storage,a)}),o=yield Bv(t,i),s=yield this.summarizerNode.refreshLatestSummary(void 0,o,()=>v(this,null,function*(){return t}),i,e);return yield this.garbageCollector.latestSummaryStateRefreshed(s,i),{latestSnapshotRefSeq:o,latestSnapshotVersionId:r}})}fetchSnapshotFromStorage(e,t,r){return v(this,null,function*(){return le.timedExecAsync(t,r,i=>v(this,null,function*(){let o={},s=ls.start(),a=yield this.storage.getVersions(e,1);w(!!a&&!!a[0],311),o.getVersionDuration=s.trace().duration;let c=yield this.storage.getSnapshotTree(a[0]);return w(!!c,312),o.getSnapshotDuration=s.trace().duration,i.end(o),{snapshotTree:c,versionId:a[0].id}}))})}notifyAttaching(e){var t;((t=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&t!==void 0?t:this.runtimeOptions.enableOfflineLoad)&&(this.baseSnapshotBlobs=$s.serializeTreeWithBlobContents(e))}getSnapshotBlobs(){return v(this,null,function*(){var e;!((e=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&e!==void 0?e:this.runtimeOptions.enableOfflineLoad)||this.attachState!==oe.Attached||this.context.pendingLocalState||(w(!!this.context.baseSnapshot,741),this.baseSnapshotBlobs=yield $s.serializeTree(this.context.baseSnapshot,this.storage))})}getPendingLocalState(){var e;if(!((e=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&e!==void 0?e:this.runtimeOptions.enableOfflineLoad))throw new ye("can't get state when offline load disabled");let t=this.context.pendingLocalState;return t?{pending:this.pendingStateManager.getLocalState(),snapshotBlobs:t.snapshotBlobs,baseSnapshot:t.baseSnapshot,savedOps:this.savedOps}:(w(!!this.context.baseSnapshot,742),w(!!this.baseSnapshotBlobs,743),{pending:this.pendingStateManager.getLocalState(),snapshotBlobs:this.baseSnapshotBlobs,baseSnapshot:this.context.baseSnapshot,savedOps:this.savedOps})}formRequestSummarizerFn(e){return()=>v(this,null,function*(){let t={headers:{[lt.cache]:!1,[lt.clientDetails]:{capabilities:{interactive:!1},type:Qt},[Ai.summarizingClient]:!0,[lt.reconnect]:!1},url:"/_summarizer"},i=(yield Tr(e,t)).ISummarizer;if(!i)throw new ye("Fluid object does not implement ISummarizer");return i})}processSavedOps(e){return v(this,null,function*(){for(let t of e.savedOps)this.process(t,!1),yield this.pendingStateManager.applyStashedOpsAt(t.sequenceNumber);yield this.pendingStateManager.applyStashedOpsAt()})}},oV=(n,e)=>v(void 0,null,function*(){return new Promise((t,r)=>{n.on("closed",r);let i=o=>{o.sequenceNumber>=e&&(t(),n.off("op",i))};n.on("op",i)})});bt();var Eh=class{constructor(e,t){this.absolutePath=e,this.routeContext=t,this.isAttached=!0,w(e.startsWith("/"),413)}get IFluidRouter(){return this}get IFluidHandleContext(){return this}get IFluidHandle(){return this}get(){return v(this,null,function*(){if(this.objectP===void 0){let e={url:this.absolutePath,headers:{[Ir.viaHandle]:!0}};this.objectP=this.routeContext.resolveHandle(e).then(t=>{if(t.mimeType==="fluid/object")return t.value;throw Bi(t,e)})}return this.objectP})}attachGraph(){}bind(e){e.attachGraph()}request(e){return v(this,null,function*(){try{let r=(yield this.get()).IFluidRouter;return r!==void 0?r.request(e):zt(e)}catch(t){return Ni(t)}})}};var sV=n=>n?.type==="__fluid_handle__",Xs=class{constructor(e,t){for(this.context=e,this.handleParsedCb=t,this.encodeValue=(r,i)=>{let o=r?.IFluidHandle;return o!==void 0?this.serializeHandle(o,i):r},this.decodeValue=r=>{if(sV(r)){let i=r.url.startsWith("/")?r.url:ur(r.url,this.context),o=new Eh(i,this.root);return this.handleParsedCb(o),o}else return r},this.root=this.context;this.root.routeContext!==void 0;)this.root=this.root.routeContext}get IFluidSerializer(){return this}encode(e,t){return e&&typeof e=="object"?this.recursivelyReplace(e,this.encodeValue,t):e}decode(e){return e&&typeof e=="object"?this.recursivelyReplace(e,this.decodeValue):e}stringify(e,t){return JSON.stringify(e,(r,i)=>this.encodeValue(i,t))}parse(e){return JSON.parse(e,(t,r)=>this.decodeValue(r))}recursivelyReplace(e,t,r){let i=t(e,r);if(i!==e)return i;let o;for(let s of Object.keys(e)){let a=e[s];if(a&&typeof a=="object"){let c=this.recursivelyReplace(a,t,r);c!==a&&(o=o??(Array.isArray(e)?[...e]:Object.assign({},e)),o[s]=c)}}return o??e}serializeHandle(e,t){return t.bind(e),{type:"__fluid_handle__",url:e.absolutePath}}};qt();Y();Vt();var Js=Ce(qn());Pe();var Ah=class extends Yn{get isAttached(){return this.value.isAttached()}constructor(e,t,r){super(e,t,r)}attachGraph(){this.value.bindToContext(),super.attachGraph()}};var kh=class extends Xs{constructor(){super(...arguments),this.serializedRoutes=new Set}getSerializedRoutes(){return Array.from(this.serializedRoutes)}serializeHandle(e,t){return this.serializedRoutes.add(e.absolutePath),super.serializeHandle(e,t)}};var l0=class extends Vr{constructor(e,t,r){super((i,o)=>this.eventListenerErrorHandler(i,o)),this.id=e,this.runtime=t,this.attributes=r,this._connected=!1,this._isBoundToContext=!1,w(!e.includes("/"),772),this.handle=new Ah(this,e,t.IFluidHandleContext),this.logger=ue.create(t.logger,void 0,{all:{sharedObjectId:ke(),ddsType:{value:this.attributes.type,tag:Ne.CodeArtifact}}}),this.mc=Mn(this.logger),[this.opProcessingHelper,this.callbacksHelper]=this.setUpSampledTelemetryHelpers(),this.attachListeners()}get IFluidLoadable(){return this}get connected(){return this._connected}setUpSampledTelemetryHelpers(){var e,t;w(this.mc!==void 0&&this.logger!==void 0,"this.mc and/or this.logger has not been set");let r=new gs({eventName:"ddsOpProcessing",category:"performance"},this.logger,(e=this.mc.config.getNumber("Fluid.SharedObject.OpProcessingTelemetrySampling"))!==null&&e!==void 0?e:100,!0,new Map([["local",{localOp:!0}],["remote",{localOp:!1}]])),i=new gs({eventName:"ddsEventCallbacks",category:"performance"},this.logger,(t=this.mc.config.getNumber("Fluid.SharedObject.DdsCallbacksTelemetrySampling"))!==null&&t!==void 0?t:100,!0);return this.runtime.once("dispose",()=>{this.callbacksHelper.dispose(),this.opProcessingHelper.dispose()}),[r,i]}closeWithError(e){this.closeError===void 0&&(this.closeError=e)}verifyNotClosed(){if(this.closeError!==void 0)throw this.closeError}eventListenerErrorHandler(e,t){let r=Ot.wrapIfUnrecognized(t,"SharedObjectEventListenerException");throw r.addTelemetryProperties({emittedEventName:String(e)}),this.closeWithError(r),r}attachListeners(){this.isAttached()||this.runtime.once("attaching",()=>{this.didAttach()})}load(e){return v(this,null,function*(){this.runtime.attachState!==oe.Detached&&(this.services=e),yield this.loadCore(e.objectStorage),this.runtime.attachState!==oe.Detached&&this.attachDeltaHandler()})}initializeLocal(){this.initializeLocalCore()}bindToContext(){this._isBoundToContext||(this._isBoundToContext=!0,this.runtime.bindChannel(this))}connect(e){this.services=e,this.attachDeltaHandler()}isAttached(){return this.services!==void 0&&this.runtime.attachState!==oe.Detached}handleDecoded(e){var t,r,i;this.isAttached()&&((i=(t=this.services)===null||t===void 0?void 0:(r=t.deltaConnection).addedGCOutboundReference)===null||i===void 0||i.call(r,this.handle,e))}initializeLocalCore(){}didAttach(){}submitLocalMessage(e,t=void 0){this.verifyNotClosed(),this.isAttached()&&this.services.deltaConnection.submit(e,t)}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}newAckBasedPromise(e){return v(this,null,function*(){let t;return new Promise((r,i)=>{if(t=()=>i(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed){t();return}this.runtime.on("dispose",t),e(r,i)}).finally(()=>{this.runtime.off("dispose",t)})})}attachDeltaHandler(){w(this.services!==void 0,122),this._isBoundToContext=!0,this.didAttach(),this.services.deltaConnection.attach({process:(e,t,r)=>{this.process(e,t,r)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t)=>{this.reSubmit(e,t)},applyStashedOp:e=>this.applyStashedOp(e),rollback:(e,t)=>{this.rollback(e,t)}}),this.setConnectionState(this.services.deltaConnection.connected)}setConnectionState(e){this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,r){this.verifyNotClosed(),this.emitInternal("pre-op",e,t,this),this.opProcessingHelper.measure(()=>{this.processCore(e,t,r)},t?"local":"remote"),this.emitInternal("op",e,t,this)}reSubmit(e,t){this.reSubmitCore(e,t)}rollback(e,t){throw new Error("rollback not supported")}emit(e,...t){return this.callbacksHelper.measure(()=>super.emit(e,...t))}emitInternal(e,...t){return super.emit(e,...t)}},Qs=class extends l0{constructor(e,t,r,i){super(e,t,r),this.telemetryContextPrefix=i,this._isGCing=!1,this._serializer=new Xs(this.runtime.channelsRoutingContext,o=>this.handleDecoded(o))}get serializer(){return w(!this._isGCing,117),this._serializer}getAttachSummary(e=!1,t=!1,r){let i=this.summarizeCore(this.serializer,r);return this.incrementTelemetryMetric(Js.blobCountPropertyName,i.stats.blobNodeCount,r),this.incrementTelemetryMetric(Js.totalBlobSizePropertyName,i.stats.totalBlobSize,r),i}summarize(e=!1,t=!1,r){return v(this,null,function*(){let i=this.summarizeCore(this.serializer,r);return this.incrementTelemetryMetric(Js.blobCountPropertyName,i.stats.blobNodeCount,r),this.incrementTelemetryMetric(Js.totalBlobSizePropertyName,i.stats.totalBlobSize,r),i})}getGCData(e=!1){w(!this._isGCing,120),this._isGCing=!0;let t;try{let r=new kh(this.runtime.channelsRoutingContext,i=>this.handleDecoded(i));this.processGCDataCore(r),t={gcNodes:{"/":r.getSerializedRoutes()}},w(this._isGCing,121)}finally{this._isGCing=!1}return t}processGCDataCore(e){this.summarizeCore(e)}incrementTelemetryMetric(e,t,r){var i;let o=(i=r?.get(this.telemetryContextPrefix,e))!==null&&i!==void 0?i:0;r?.set(this.telemetryContextPrefix,e,o+t)}};function MA(n,e,t){return n!==void 0?e.stringify(n,t):n}function SA(n,e){return n!==void 0?e.parse(JSON.stringify(n)):n}var Ht=function(n){return n[n.Shared=0]="Shared",n[n.Plain=1]="Plain",n}(Ht||{});bt();Y();function Zc(n,e,t){let r=n.makeSerialized(e,t);return{type:r.type,value:r.value&&JSON.parse(r.value)}}var Th=class{constructor(e){this.value=e}get type(){return Ht[Ht.Plain]}makeSerialized(e,t){let r=MA(this.value,e,t);return{type:this.type,value:r}}},Ys=class{constructor(e){this.serializer=e}fromSerializable(e){if(e.type===Ht[Ht.Shared]){e.type=Ht[Ht.Plain];let r={type:"__fluid_handle__",url:e.value};e.value=r}let t=SA(e.value,this.serializer);return new Th(t)}fromInMemory(e){return new Th(e)}};function d0(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="add"||n.type==="edit")}function EA(n){return n!==void 0&&n.type==="clear"&&typeof n.pendingMessageId=="number"}function aV(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="add"||n.type==="edit"||n.type==="clear")}var Dh=class{constructor(e,t,r,i,o){this.serializer=e,this.handle=t,this.submitMessage=r,this.isAttached=i,this.eventEmitter=o,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localValueMaker=new Ys(e),this.messageHandlers=this.getMessageHandlers()}get size(){return this.data.size}keys(){return this.data.keys()}entries(){let e=this.data.entries();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:[r.value[0],r.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){let e=this.data.values();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:r.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach((t,r,i)=>{e(t.value,r,i)})}get(e){let t=this.data.get(e);return t===void 0?void 0:t.value}has(e){return this.data.has(e)}set(e,t){if(e==null)throw new Error("Undefined and null keys are not supported");let r=this.localValueMaker.fromInMemory(t),i=Zc(r,this.serializer,this.handle),o=this.setCore(e,r,!0);if(!this.isAttached())return;let s={key:e,type:"set",value:i};this.submitMapKeyMessage(s,o)}delete(e){let t=this.deleteCore(e,!0);if(!this.isAttached())return t!==void 0;let r={key:e,type:"delete"};return this.submitMapKeyMessage(r,t),t!==void 0}clear(){let e=this.isAttached()?new Map(this.data):void 0;if(this.clearCore(!0),!this.isAttached())return;let t={type:"clear"};this.submitMapClearMessage(t,e)}getSerializedStorage(e){let t={};return this.data.forEach((r,i)=>{t[i]=r.makeSerialized(e,this.handle)}),t}getSerializableStorage(e){let t={};return this.data.forEach((r,i)=>{t[i]=Zc(r,e,this.handle)}),t}serialize(e){return JSON.stringify(this.getSerializableStorage(e))}populateFromSerializable(e){for(let[t,r]of Object.entries(e)){let i={key:t,value:this.makeLocal(t,r)};this.data.set(i.key,i.value)}}populate(e){this.populateFromSerializable(JSON.parse(e))}trySubmitMessage(e,t){let r=this.messageHandlers.get(e.type);return r===void 0?!1:(r.submit(e,t),!0)}tryGetStashedOpLocalMetadata(e){let t=this.messageHandlers.get(e.type);if(t===void 0)throw new Error("no apply stashed op handler");return t.getStashedOpLocalMetadata(e)}tryProcessMessage(e,t,r){let i=this.messageHandlers.get(e.type);return i===void 0?!1:(i.process(e,t,r),!0)}rollback(e,t){if(!aV(t))throw new Error("Invalid localOpMetadata");if(e.type==="clear"&&t.type==="clear"){if(t.previousMap===void 0)throw new Error("Cannot rollback without previous map");t.previousMap.forEach((i,o)=>{this.setCore(o,i,!0)});let r=this.pendingClearMessageIds.pop();if(r===void 0||r!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if(e.type==="delete"||e.type==="set"){if(t.type==="add")this.deleteCore(e.key,!0);else if(t.type==="edit"&&t.previousValue!==void 0)this.setCore(e.key,t.previousValue,!0);else throw new Error("Cannot rollback without previous value");let r=this.pendingKeys.get(e.key),i=r?.pop();if(!r||i!==t.pendingMessageId)throw new Error("Rollback op does not match last pending");r.length===0&&this.pendingKeys.delete(e.key)}else throw new Error("Unsupported op for rollback")}setCore(e,t,r){let i=this.data.get(e),o=i?.value;return this.data.set(e,t),this.eventEmitter.emit("valueChanged",{key:e,previousValue:o},r,this.eventEmitter),i}clearCore(e){this.data.clear(),this.eventEmitter.emit("clear",e,this.eventEmitter)}deleteCore(e,t){let r=this.data.get(e),i=r?.value;return this.data.delete(e)&&this.eventEmitter.emit("valueChanged",{key:e,previousValue:i},t,this.eventEmitter),r}clearExceptPendingKeys(){let e=new Map;this.pendingKeys.forEach((t,r)=>{e.set(r,this.data.get(r))}),this.clearCore(!1),e.forEach((t,r)=>{this.setCore(r,t,!0)})}makeLocal(e,t){if(t.type===Ht[Ht.Plain]||t.type===Ht[Ht.Shared])return this.localValueMaker.fromSerializable(t);throw new Error("Unknown local value type")}needProcessKeyOperation(e,t,r){if(this.pendingClearMessageIds.length>0)return t&&w(r!==void 0&&d0(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],19),!1;if(this.pendingKeys.get(e.key)!==void 0){if(t){w(r!==void 0&&d0(r),20);let o=this.pendingKeys.get(e.key);w(o!==void 0&&o[0]===r.pendingMessageId,762),o.shift(),o.length===0&&this.pendingKeys.delete(e.key)}return!1}return!t}getMessageHandlers(){let e=new Map;return e.set("clear",{process:(t,r,i)=>{if(r){w(EA(i),21);let o=this.pendingClearMessageIds.shift();w(o===i.pendingMessageId,763);return}if(this.pendingKeys.size!==0){this.clearExceptPendingKeys();return}this.clearCore(r)},submit:(t,r)=>{w(EA(r),764);let i=this.pendingClearMessageIds.shift();w(i===r.pendingMessageId,765),this.submitMapClearMessage(t,r.previousMap)},getStashedOpLocalMetadata:t=>({type:"clear",pendingMessageId:this.getMapClearMessageId()})}),e.set("delete",{process:(t,r,i)=>{this.needProcessKeyOperation(t,r,i)&&this.deleteCore(t.key,r)},submit:(t,r)=>{this.resubmitMapKeyMessage(t,r)},getStashedOpLocalMetadata:t=>({type:"edit",pendingMessageId:this.getMapKeyMessageId(t)})}),e.set("set",{process:(t,r,i)=>{if(!this.needProcessKeyOperation(t,r,i))return;let o=this.makeLocal(t.key,t.value);this.setCore(t.key,o,r)},submit:(t,r)=>{this.resubmitMapKeyMessage(t,r)},getStashedOpLocalMetadata:t=>({type:"edit",pendingMessageId:this.getMapKeyMessageId(t)})}),e}getMapClearMessageId(){let e=++this.pendingMessageId;return this.pendingClearMessageIds.push(e),e}submitMapClearMessage(e,t){let r={type:"clear",pendingMessageId:this.getMapClearMessageId(),previousMap:t};this.submitMessage(e,r)}getMapKeyMessageId(e){let t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return r!==void 0?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitMapKeyMessage(e,t){let r=this.getMapKeyMessageId(e),i=t?{type:"edit",pendingMessageId:r,previousValue:t}:{type:"add",pendingMessageId:r};this.submitMessage(e,i)}resubmitMapKeyMessage(e,t){w(d0(t),766);let r=this.pendingKeys.get(e.key);w(r!==void 0&&r[0]===t.pendingMessageId,767),r.shift(),r.length===0&&this.pendingKeys.delete(e.key);let i=this.getMapKeyMessageId(e),o=t.type==="edit"?{type:"edit",pendingMessageId:i,previousValue:t.previousValue}:{type:"add",pendingMessageId:i};this.submitMessage(e,o)}};var Fh="1.4.0";var AA,kA="header",mr=class n{get type(){return n.Type}get attributes(){return n.Attributes}load(e,t,r,i){return v(this,null,function*(){let o=new Ui(t,e,i);return yield o.load(r),o})}create(e,t){let r=new Ui(t,e,n.Attributes);return r.initializeLocal(),r}};mr.Type="https://graph.microsoft.com/types/map";mr.Attributes={type:mr.Type,snapshotFormatVersion:"0.2",packageVersion:Fh};var Ui=class extends Qs{constructor(e,t,r){super(e,t,r,"fluid_map_"),this[AA]="SharedMap",this.kernel=new Dh(this.serializer,this.handle,(i,o)=>this.submitLocalMessage(i,o),()=>this.isAttached(),this)}static create(e,t){return e.createChannel(t,mr.Type)}static getFactory(){return new mr}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[(AA=Symbol.toStringTag,Symbol.iterator)](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}summarizeCore(e,t){let r=0,i=0,o={},s=[],a=new Pt,c=this.kernel.getSerializedStorage(e),l=8*1024,h=16*1024;for(let d of Object.keys(c)){let p=c[d];if(p.value&&p.value.length>=l){let m=`blob${i}`;i++,s.push(m);let g={[d]:{type:p.type,value:JSON.parse(p.value)}};a.addBlob(m,JSON.stringify(g))}else{if(r+=p.type.length+21,p.value&&(r+=p.value.length),r>h){let m=`blob${i}`;i++,s.push(m),a.addBlob(m,JSON.stringify(o)),o={},r=0}o[d]={type:p.type,value:p.value===void 0?void 0:JSON.parse(p.value)}}}let u={blobs:s,content:o};return a.addBlob(kA,JSON.stringify(u)),a.getSummaryTree()}loadCore(e){return v(this,null,function*(){let t=yield et(e,kA),r=t;Array.isArray(r.blobs)?(this.kernel.populateFromSerializable(r.content),yield Promise.all(r.blobs.map(i=>v(this,null,function*(){let o=yield et(e,i);this.kernel.populateFromSerializable(o)})))):this.kernel.populateFromSerializable(t)})}onDisconnect(){}reSubmitCore(e,t){this.kernel.trySubmitMessage(e,t)}applyStashedOp(e){return this.kernel.tryProcessMessage(e,!1,void 0),this.kernel.tryGetStashedOpLocalMetadata(e)}processCore(e,t,r){e.type===cc.Operation&&this.kernel.tryProcessMessage(e.contents,t,r)}rollback(e,t){this.kernel.rollback(e,t)}};Y();bt();var LA=Ce(FA());var zA,IA,Tn=LA.posix,RA="header",Qr=class n{get type(){return n.Type}get attributes(){return n.Attributes}load(e,t,r,i){return v(this,null,function*(){let o=new Gi(t,e,i);return yield o.load(r),o})}create(e,t){let r=new Gi(t,e,n.Attributes);return r.initializeLocal(),r}};Qr.Type="https://graph.microsoft.com/types/directory";Qr.Attributes={type:Qr.Type,snapshotFormatVersion:"0.1",packageVersion:Fh};var Gi=class extends Qs{constructor(e,t,r){super(e,t,r,"fluid_directory_"),this[zA]="SharedDirectory",this.root=new zh(this,this.runtime,this.serializer,Tn.sep),this.messageHandlers=new Map,this.localValueMaker=new Ys(this.serializer),this.setMessageHandlers(),this.root.on("containedValueChanged",(i,o)=>{this.emit("containedValueChanged",i,o,this)}),this.root.on("subDirectoryCreated",(i,o)=>{this.emit("subDirectoryCreated",i,o,this)}),this.root.on("subDirectoryDeleted",(i,o)=>{this.emit("subDirectoryDeleted",i,o,this)})}static create(e,t){return e.createChannel(t,Qr.Type)}static getFactory(){return new Qr}get absolutePath(){return this.root.absolutePath}get(e){return this.root.get(e)}set(e,t){return this.root.set(e,t),this}dispose(e){this.root.dispose(e)}get disposed(){return this.root.disposed}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[(zA=Symbol.toStringTag,Symbol.iterator)](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}countSubDirectory(){return this.root.countSubDirectory()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){let t=this.makeAbsolute(e);if(t===Tn.sep)return this.root;let r=this.root,i=t.substr(1).split(Tn.sep);for(let o of i)if(r=r.getSubDirectory(o),!r)return;return r}summarizeCore(e,t){return this.serializeDirectory(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}onDisconnect(){}reSubmitCore(e,t){let r=e,i=this.messageHandlers.get(r.type);w(i!==void 0,13),i.submit(r,t)}loadCore(e){return v(this,null,function*(){let t=yield et(e,RA),r=t;Array.isArray(r.blobs)?(this.populate(r.content),yield Promise.all(r.blobs.map(i=>v(this,null,function*(){let o=yield et(e,i);this.populate(o)})))):this.populate(t)})}populate(e){let t=[];for(t.push([this.root,e]);t.length>0;){let[r,i]=t.pop();if(i.subdirectories)for(let[o,s]of Object.entries(i.subdirectories)){let a=r.getSubDirectory(o);a||(a=new zh(this,this.runtime,this.serializer,Tn.join(r.absolutePath,o)),r.populateSubDirectory(o,a)),t.push([a,s])}if(i.storage)for(let[o,s]of Object.entries(i.storage)){let a=this.makeLocal(o,r.absolutePath,s);r.populateStorage(o,a)}}}processCore(e,t,r){if(e.type===cc.Operation){let i=e.contents,o=this.messageHandlers.get(i.type);w(o!==void 0,14),o.process(i,t,r)}}rollback(e,t){let r=e,i=this.getWorkingDirectory(r.path);i&&i.rollback(r,t)}makeAbsolute(e){return Tn.resolve(Tn.sep,e)}makeLocal(e,t,r){return w(r.type===Ht[Ht.Plain]||r.type===Ht[Ht.Shared],484),this.localValueMaker.fromSerializable(r)}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processClearMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitClearMessage(e,t)}}),this.messageHandlers.set("delete",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processDeleteMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("set",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);if(i){let o=t?void 0:this.makeLocal(e.key,e.path,e.value);i.processSetMessage(e,o,t,r)}},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processCreateSubDirectoryMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processDeleteSubDirectoryMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}})}applyStashedOp(){throw new Error("not implemented")}serializeDirectory(e,t,r){let o=new Pt,s=0,a=[],c=[],l={};for(c.push([e,l]);c.length>0;){let[u,d]=c.pop();for(let[p,m]of u.getSerializedStorage(t)){d.storage||(d.storage={});let g={type:m.type,value:m.value&&JSON.parse(m.value)};if(m.value&&m.value.length>=8192){let x={},b=x;if(u.absolutePath!==Tn.sep)for(let O of u.absolutePath.substr(1).split(Tn.sep)){let S={};b.subdirectories={[O]:S},b=S}b.storage={[p]:g};let _=`blob${s}`;s++,a.push(_),o.addBlob(_,JSON.stringify(x))}else d.storage[p]=g}for(let[p,m]of u.subdirectories()){d.subdirectories||(d.subdirectories={});let g={};d.subdirectories[p]=g,c.push([m,g])}}let h={blobs:a,content:l};return o.addBlob(RA,JSON.stringify(h)),o.getSummaryTree()}};function u0(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&n.type==="edit"}function NA(n){return n!==void 0&&n.type==="clear"&&typeof n.pendingMessageId=="number"&&typeof n.previousStorage=="object"}function BA(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="createSubDir"&&typeof n.previouslyExisted=="boolean"||n.type==="deleteSubDir")}function lV(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="edit"||n.type==="deleteSubDir"||n.type==="clear"&&typeof n.previousStorage=="object"||n.type==="createSubDir"&&typeof n.previouslyExisted=="boolean")}var zh=class n extends we{constructor(e,t,r,i){super(),this.directory=e,this.runtime=t,this.serializer=r,this.absolutePath=i,this._deleted=!1,this[IA]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingSubDirectories=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[]}dispose(e){this._deleted=!0,this.emit("disposed",this)}undispose(){this._deleted=!1}get disposed(){return this._deleted}throwIfDisposed(){if(this._deleted)throw new ye("Cannot access Disposed subDirectory")}has(e){return this.throwIfDisposed(),this._storage.has(e)}get(e){var t;return this.throwIfDisposed(),(t=this._storage.get(e))===null||t===void 0?void 0:t.value}set(e,t){if(this.throwIfDisposed(),e==null)throw new Error("Undefined and null keys are not supported");let r=this.directory.localValueMaker.fromInMemory(t),i=Zc(r,this.serializer,this.directory.handle),o=this.setCore(e,r,!0);if(!this.directory.isAttached())return this;let s={key:e,path:this.absolutePath,type:"set",value:i};return this.submitKeyMessage(s,o),this}countSubDirectory(){return this._subdirectories.size}createSubDirectory(e){if(this.throwIfDisposed(),e==null)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(Tn.sep))throw new Error(`SubDirectory name may not contain ${Tn.sep}`);let t=this.createSubDirectoryCore(e,!0),r=this._subdirectories.get(e);if(!this.directory.isAttached())return r;let i={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};return this.submitCreateSubDirectoryMessage(i,!t),r}getSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.get(e)}hasSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.has(e)}deleteSubDirectory(e){this.throwIfDisposed();let t=this.deleteSubDirectoryCore(e,!0);if(!this.directory.isAttached())return t!==void 0;let r={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};return this.submitDeleteSubDirectoryMessage(r,t),t!==void 0}subdirectories(){return this.throwIfDisposed(),this._subdirectories.entries()}getWorkingDirectory(e){return this.throwIfDisposed(),this.directory.getWorkingDirectory(this.makeAbsolute(e))}delete(e){this.throwIfDisposed();let t=this.deleteCore(e,!0);if(!this.directory.isAttached())return t!==void 0;let r={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(r,t),t!==void 0}clear(){if(this.throwIfDisposed(),!this.directory.isAttached()){this.clearCore(!0);return}let e=new Map(this._storage);this.clearCore(!0);let t={path:this.absolutePath,type:"clear"};this.submitClearMessage(t,e)}forEach(e){this.throwIfDisposed(),this._storage.forEach((t,r,i)=>{e(t.value,r,i)})}get size(){return this.throwIfDisposed(),this._storage.size}entries(){this.throwIfDisposed();let e=this._storage.entries();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:[r.value[0],r.value[1].value],done:!1}},[Symbol.iterator](){return this}}}keys(){return this.throwIfDisposed(),this._storage.keys()}values(){this.throwIfDisposed();let e=this._storage.values();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:r.value.value,done:!1}},[Symbol.iterator](){return this}}}[(IA=Symbol.toStringTag,Symbol.iterator)](){return this.throwIfDisposed(),this.entries()}processClearMessage(e,t,r){if(this.throwIfDisposed(),t){w(NA(r),15);let i=this.pendingClearMessageIds.shift();w(i===r.pendingMessageId,810);return}this.clearExceptPendingKeys()}processDeleteMessage(e,t,r){this.throwIfDisposed(),this.needProcessStorageOperation(e,t,r)&&this.deleteCore(e.key,t)}processSetMessage(e,t,r,i){this.throwIfDisposed(),this.needProcessStorageOperation(e,r,i)&&this.setCore(e.key,t,r)}processCreateSubDirectoryMessage(e,t,r){this.throwIfDisposed(),this.needProcessSubDirectoryOperation(e,t,r)&&this.createSubDirectoryCore(e.subdirName,t)}processDeleteSubDirectoryMessage(e,t,r){this.throwIfDisposed(),this.needProcessSubDirectoryOperation(e,t,r)&&this.deleteSubDirectoryCore(e.subdirName,t)}submitClearMessage(e,t){this.throwIfDisposed();let r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);let i={type:"clear",pendingMessageId:r,previousStorage:t};this.directory.submitDirectoryMessage(e,i)}resubmitClearMessage(e,t){w(NA(t),811);let r=this.pendingClearMessageIds.shift();w(r===t.pendingMessageId,812),this.submitClearMessage(e,t.previousStorage)}getKeyMessageId(e){let t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return r!==void 0?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitKeyMessage(e,t){this.throwIfDisposed();let i={type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t};this.directory.submitDirectoryMessage(e,i)}resubmitKeyMessage(e,t){w(u0(t),813);let r=this.pendingKeys.get(e.key);w(r!==void 0&&r[0]===t.pendingMessageId,814),r.shift(),r.length===0&&this.pendingKeys.delete(e.key),this.submitKeyMessage(e,t.previousValue)}getSubDirMessageId(e){let t=++this.pendingMessageId,r=this.pendingSubDirectories.get(e.subdirName);return r!==void 0?r.push(t):this.pendingSubDirectories.set(e.subdirName,[t]),t}submitCreateSubDirectoryMessage(e,t){this.throwIfDisposed();let i={type:"createSubDir",pendingMessageId:this.getSubDirMessageId(e),previouslyExisted:t};this.directory.submitDirectoryMessage(e,i)}submitDeleteSubDirectoryMessage(e,t){this.throwIfDisposed();let i={type:"deleteSubDir",pendingMessageId:this.getSubDirMessageId(e),subDirectory:t};this.directory.submitDirectoryMessage(e,i)}resubmitSubDirectoryMessage(e,t){w(BA(t),815);let r=this.pendingSubDirectories.get(e.subdirName);w(r!==void 0&&r[0]===t.pendingMessageId,816),r.shift(),r.length===0&&this.pendingSubDirectories.delete(e.subdirName),t.type==="createSubDir"?this.submitCreateSubDirectoryMessage(e,t.previouslyExisted):this.submitDeleteSubDirectoryMessage(e,t.subDirectory)}*getSerializedStorage(e){this.throwIfDisposed();for(let[t,r]of this._storage){let i=r.makeSerialized(e,this.directory.handle);yield[t,i]}}populateStorage(e,t){this.throwIfDisposed(),this._storage.set(e,t)}populateSubDirectory(e,t){this.throwIfDisposed(),this._subdirectories.set(e,t)}getLocalValue(e){return this.throwIfDisposed(),this._storage.get(e)}rollbackPendingMessageId(e,t,r){let i=e.get(t),o=i?.pop();if(!i||o!==r)throw new Error("Rollback op does not match last pending");i.length===0&&e.delete(t)}rollback(e,t){if(!lV(t))throw new Error("Invalid localOpMetadata");if(e.type==="clear"&&t.type==="clear"){t.previousStorage.forEach((i,o)=>{this.setCore(o,i,!0)});let r=this.pendingClearMessageIds.pop();if(r===void 0||r!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if((e.type==="delete"||e.type==="set")&&t.type==="edit")t.previousValue===void 0?this.deleteCore(e.key,!0):this.setCore(e.key,t.previousValue,!0),this.rollbackPendingMessageId(this.pendingKeys,e.key,t.pendingMessageId);else if(e.type==="createSubDirectory"&&t.type==="createSubDir")t.previouslyExisted||this.deleteSubDirectoryCore(e.subdirName,!0),this.rollbackPendingMessageId(this.pendingSubDirectories,e.subdirName,t.pendingMessageId);else if(e.type==="deleteSubDirectory"&&t.type==="deleteSubDir")t.subDirectory!==void 0&&(this.undeleteSubDirectoryTree(t.subDirectory),this._subdirectories.set(e.subdirName,t.subDirectory),this.emit("subDirectoryCreated",e.subdirName,!0,this)),this.rollbackPendingMessageId(this.pendingSubDirectories,e.subdirName,t.pendingMessageId);else throw new Error("Unsupported op for rollback")}makeAbsolute(e){return Tn.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,r){if(this.pendingClearMessageIds.length>0)return t&&w(r!==void 0&&u0(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],16),!1;if(this.pendingKeys.get(e.key)!==void 0){if(t){w(r!==void 0&&u0(r),17);let o=this.pendingKeys.get(e.key);w(o!==void 0&&o[0]===r.pendingMessageId,817),o.shift(),o.length===0&&this.pendingKeys.delete(e.key)}return!1}return!t}needProcessSubDirectoryOperation(e,t,r){if(this.pendingSubDirectories.get(e.subdirName)!==void 0){if(t){w(BA(r),18);let o=this.pendingSubDirectories.get(e.subdirName);w(o!==void 0&&o[0]===r.pendingMessageId,818),o.shift(),o.length===0&&this.pendingSubDirectories.delete(e.subdirName)}return!1}return!t}clearExceptPendingKeys(){let e=new Map;this.pendingKeys.forEach((t,r,i)=>{e.set(r,this._storage.get(r))}),this.clearCore(!1),e.forEach((t,r,i)=>{this.setCore(r,t,!0)})}clearCore(e){this._storage.clear(),this.directory.emit("clear",e,this.directory)}deleteCore(e,t){let r=this._storage.get(e),i=r?.value;if(this._storage.delete(e)){let s={key:e,path:this.absolutePath,previousValue:i};this.directory.emit("valueChanged",s,t,this.directory);let a={key:e,previousValue:i};this.emit("containedValueChanged",a,t,this)}return r}setCore(e,t,r){let i=this._storage.get(e),o=i?.value;this._storage.set(e,t);let s={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",s,r,this.directory);let a={key:e,previousValue:o};return this.emit("containedValueChanged",a,r,this),i}createSubDirectoryCore(e,t){if(!this._subdirectories.has(e)){let r=Tn.join(this.absolutePath,e),i=new n(this.directory,this.runtime,this.serializer,r);return this.registerEventsOnSubDirectory(i,e),this._subdirectories.set(e,i),this.emit("subDirectoryCreated",e,t,this),!0}return!1}registerEventsOnSubDirectory(e,t){e.on("subDirectoryCreated",(r,i)=>{this.emit("subDirectoryCreated",Tn.join(t,r),i,this)}),e.on("subDirectoryDeleted",(r,i)=>{this.emit("subDirectoryDeleted",Tn.join(t,r),i,this)})}deleteSubDirectoryCore(e,t){let r=this._subdirectories.get(e);return r!==void 0&&(this._subdirectories.delete(e),this.disposeSubDirectoryTree(r),this.emit("subDirectoryDeleted",e,t,this)),r}disposeSubDirectoryTree(e){if(!e)return;let t=e.subdirectories();for(let[r,i]of t)this.disposeSubDirectoryTree(i);typeof e.dispose=="function"&&e.dispose()}undeleteSubDirectoryTree(e){for(let[t,r]of this._subdirectories.entries())this.undeleteSubDirectoryTree(r);e.undispose()}};var h0="IFluidDependencySynthesizer";var ea=class n{constructor(...e){this.providers=new Map,this.parents=e.filter(t=>t!==void 0)}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${e} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){let r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,h0,{get:()=>this}),r}has(e,t){return this.providers.has(e)?!0:t!==!0?this.parents.some(r=>r.has(e)):!1}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(let t of this.parents){if(t instanceof n)return t.getProvider(e);{let r=t;if(r?.getProvider!==void 0)return r.getProvider(e)}}}}generateRequired(e,t){if(t!==void 0)for(let r of Object.keys(t)){let i=this.resolveProvider(r);if(i===void 0)throw new Error(`Object attempted to be created without registered required provider ${r}`);Object.defineProperty(e,r,i)}}generateOptional(e,t){var r;if(t!==void 0)for(let i of Object.keys(t)){let o=(r=this.resolveProvider(i))!==null&&r!==void 0?r:{get:()=>v(this,null,function*(){})};Object.defineProperty(e,i,o)}}resolveProvider(e){let t=this.providers.get(e);if(t===void 0){for(let r of this.parents){let i={[e]:e},o=r.synthesize(i,{}),s=Object.getOwnPropertyDescriptor(o,e);if(s!==void 0)return s}return}return typeof t=="function"?{get(){if(t&&typeof t=="function")return Promise.resolve(this[h0]).then(r=>v(this,null,function*(){return t(r)})).then(r=>r?.[e])}}:{get(){if(t)return Promise.resolve(t).then(r=>{if(r)return r[e]})}}}};bt();Y();Y();var p0=class{constructor(e,t){this.absolutePath=e,this.runtime=t,this.isAttached=!0}get IFluidHandle(){return this}attachGraph(){w(!1,202)}get(){return v(this,null,function*(){let e=yield this.runtime.IFluidHandleContext.resolveHandle({url:this.absolutePath});if(e.status===200&&e.mimeType==="fluid/object")return e.value;throw new Error(`Failed to resolve container path ${this.absolutePath}`)})}bind(e){throw new Error("Cannot bind to LegacyUriHandle")}};function qA(n,e){return new p0(n,e)}bt();var f0=class{constructor(){this.handlers=[]}pushHandler(...e){e!==void 0&&this.handlers.push(...e)}handleRequest(e,t){return v(this,null,function*(){let r=Sn.create(e);for(let i of this.handlers){let o=yield i(r,t);if(o!==void 0)return o}return zt(e)})}};function jA(...n){let e=new f0;return e.pushHandler(...n),(t,r)=>v(this,null,function*(){return e.handleRequest(t,r)})}var VA="_services";bt();var HA=n=>(e,t)=>v(void 0,null,function*(){let r=Sn.create(e);if(r.pathParts.length===0)return t.IFluidHandleContext.resolveHandle({url:`/${n}${r.query}`,headers:e.headers})});function UA(n,e){return e.url===""||e.url==="/"||e.url.startsWith("/?")?{mimeType:"fluid/object",status:200,value:n}:zt(e)}var Oo=class extends gi{constructor(e){super(),this._disposed=!1,this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps,w(this.runtime._dataObject===void 0,189),this.runtime._dataObject=this,this.innerHandle=new Yn(this,"",this.runtime.objectsRoutingContext),this.runtime.once("dispose",()=>{this._disposed=!0,this.dispose()})}get disposed(){return this._disposed}get id(){return this.runtime.id}get IFluidRouter(){return this}get IFluidLoadable(){return this}get IFluidHandle(){return this.innerHandle}get handle(){return this.innerHandle}static getDataObject(e){return v(this,null,function*(){let t=e._dataObject;return w(t!==void 0,188),yield t.finishInitialization(!0),t})}request(e){return v(this,null,function*(){return UA(this,e)})}finishInitialization(e){return v(this,null,function*(){return this.initializeP!==void 0?this.initializeP:(this.initializeP=this.initializeInternal(e),this.initializeP)})}initializeInternal(e){return v(this,null,function*(){var t;yield this.preInitialize(),e?(w(this.initProps===void 0,190),yield this.initializingFromExisting()):yield this.initializingFirstTime((t=this.context.createProps)!==null&&t!==void 0?t:this.initProps),yield this.hasInitialized()})}getFluidObjectFromDirectory(e,t,r){return v(this,null,function*(){let i=r?r(e,t):t.get(e),o=i?.IFluidHandle;if(o)return o.get()})}getService(e){return v(this,null,function*(){return qA(`/${VA}/${e}`,this.context.containerRuntime).get()})}preInitialize(){return v(this,null,function*(){})}initializingFirstTime(e){return v(this,null,function*(){})}initializingFromExisting(){return v(this,null,function*(){})}hasInitialized(){return v(this,null,function*(){})}dispose(){super.dispose()}};var Mo=class n extends Oo{constructor(){super(...arguments),this.rootDirectoryId="root"}request(e){return v(this,null,function*(){let t=Sn.create(e);if(t.pathParts[0]==="bigBlobs"){let i=this.root.get(t.pathParts.join("/"));return i===void 0?zt(t):{mimeType:"fluid/object",status:200,value:i}}else return tr(n.prototype,this,"request").call(this,t)})}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}initializeInternal(e){return v(this,null,function*(){e?(this.internalRoot=yield this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===mr.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=Gi.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),yield tr(n.prototype,this,"initializeInternal").call(this,e)})}getUninitializedErrorString(e){return`${e} must be initialized before being accessed.`}};function GA(n,e,t,r,i,o,s){return v(this,null,function*(){let a=i;a=tA((p,m)=>v(this,null,function*(){return(yield Oo.getDataObject(m)).request(p)}),a);let c=new a(e,t,o),l=e.scope,u=new ea(l.IFluidDependencySynthesizer).synthesize(r,{}),d=new n({runtime:c,context:e,providers:u,initProps:s});return o||(yield d.finishInitialization(o)),{instance:d,runtime:c}})}var Ih=class{constructor(e,t,r,i,o,s=Po){if(this.type=e,this.ctor=t,this.optionalProviders=i,this.runtimeClass=s,this.type==="")throw new Error("undefined type member");o!==void 0&&(this.registry=new Kr(o)),this.sharedObjectRegistry=new Map(r.map(a=>[a.type,a]))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}instantiateDataStore(e,t){return v(this,null,function*(){let{runtime:r}=yield GA(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,t);return r})}createChildInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t)})}createPeerInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t)})}createInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e,[this.type],t)})}createRootInstance(e,t,r){return v(this,null,function*(){let i=t.createDetachedRootDataStore([this.type],e);return this.createInstanceCore(i,r)})}createNonRootInstanceCore(e,t,r){return v(this,null,function*(){let i=e.createDetachedDataStore(t);return this.createInstanceCore(i,r)})}createInstanceCore(e,t){return v(this,null,function*(){let{instance:r,runtime:i}=yield GA(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,!1,t);return yield e.attachRuntime(this,i),r})}};var ta=class extends Ih{constructor(e,t,r=[],i,o,s=Po){let a=[...r];r.find(c=>c.type===Qr.Type)||a.push(Gi.getFactory()),r.find(c=>c.type===mr.Type)||a.push(Ui.getFactory()),super(e,t,a,i,o,s)}};var $A=Ce(KA());bt();var Nh=class extends Nc{constructor(e,t,r=[],i){super(),this.registryEntries=e,this.dependencyContainer=t,this.requestHandlers=r,this.runtimeOptions=i,this.registry=new Kr(e)}get IFluidDataStoreRegistry(){return this.registry}instantiateFirstTime(e){return v(this,null,function*(){yield this.containerInitializingFirstTime(e),yield this.containerHasInitialized(e)})}instantiateFromExisting(e){return v(this,null,function*(){yield this.containerHasInitialized(e)})}preInitialize(e,t){return v(this,null,function*(){let r=e.scope,i=new ea(this.dependencyContainer,r.IFluidDependencySynthesizer);r.IFluidDependencySynthesizer=i;let o=yield Yc.load(e,this.registryEntries,jA(...this.requestHandlers),this.runtimeOptions,r,t);return i.register($A.IContainerRuntime,o),o})}containerInitializingFirstTime(e){return v(this,null,function*(){})}containerHasInitialized(e){return v(this,null,function*(){})}};var QA=Ce(qn());bt();var g0=n=>n?.factory!==void 0,m0=n=>n?.getFactory!==void 0,XA=n=>{var e;let t=new Set,r=new Set,i=s=>{if(m0(s))r.add(s.getFactory());else if(g0(s))t.add([s.factory.type,Promise.resolve(s.factory)]);else throw new Error("Entry is neither a DataObject or a SharedObject")};if(new Set([...Object.values(n.initialObjects),...(e=n.dynamicObjectTypes)!==null&&e!==void 0?e:[]]).forEach(i),t.size===0&&r.size===0)throw new Error("Container cannot be initialized without any DataTypes");return[Array.from(t),Array.from(r)]};var v0=class extends Mo{constructor(){super(...arguments),this.initialObjectsDirKey="initial-objects-key",this._initialObjects={}}get initialObjectsDir(){let e=this.root.getSubDirectory(this.initialObjectsDirKey);if(e===void 0)throw new Error("InitialObjects sub-directory was not initialized");return e}initializingFirstTime(e){return v(this,null,function*(){this.root.createSubDirectory(this.initialObjectsDirKey);let t=[];Object.entries(e.initialObjects).forEach(([r,i])=>{let o=()=>v(this,null,function*(){let s=yield this.create(i);this.initialObjectsDir.set(r,s.handle)});t.push(o())}),yield Promise.all(t)})}hasInitialized(){return v(this,null,function*(){let e=[];for(let[t,r]of Array.from(this.initialObjectsDir.entries())){let i=()=>v(this,null,function*(){let o=yield r.get();Object.assign(this._initialObjects,{[t]:o})});e.push(i())}yield Promise.all(e)})}get initialObjects(){if(Object.keys(this._initialObjects).length===0)throw new Error("Initial Objects were not correctly initialized");return this._initialObjects}create(e){return v(this,null,function*(){if(g0(e))return this.createDataObject(e);if(m0(e))return this.createSharedObject(e);throw new Error("Could not create new Fluid object because an unknown object was passed")})}createDataObject(e){return v(this,null,function*(){let t=e.factory,r=[...this.context.packagePath,t.type],i=yield this.context.containerRuntime.createDataStore(r);return Tr(i,"/")})}createSharedObject(e){let t=e.getFactory();return this.runtime.createChannel(void 0,t.type)}},JA="rootDOId",Bh=class extends Nh{constructor(e){let[t,r]=XA(e),i=new ta("rootDO",v0,r,{},t);super([i.registryEntry],void 0,[HA(JA)],{flushMode:QA.FlushMode.Immediate}),this.rootDataObjectFactory=i,this.initialObjects=e.initialObjects}containerInitializingFirstTime(e){return v(this,null,function*(){yield this.rootDataObjectFactory.createRootInstance(JA,e,{initialObjects:this.initialObjects})})}};Y();var Lh=class extends we{constructor(e){super(),this.container=e,this.lastMembers=new Map,this.audience=e.audience,this.getMembers(),this.audience.on("addMember",(t,r)=>{if(this.shouldIncludeAsMember(r)){let i=this.getMember(t);this.emit("memberAdded",t,i),this.emit("membersChanged")}}),this.audience.on("removeMember",t=>{this.lastMembers.has(t)&&(this.emit("memberRemoved",t,this.lastMembers.get(t)),this.emit("membersChanged"))}),this.container.on("connected",()=>this.emit("membersChanged"))}getMembers(){let e=new Map,t=new Map;return this.audience.getMembers().forEach((r,i)=>{if(this.shouldIncludeAsMember(r)){let o=r.user.id,s=e.get(o);s===void 0&&(s=this.createServiceMember(r),e.set(o,s)),s.connections.push({id:i,mode:r.mode}),t.set(i,s)}}),this.lastMembers=t,e}getMyself(){let e=this.container.clientId;if(e!==void 0)return this.getMember(e)}getMember(e){let t=this.audience.getMember(e);if(t===void 0)return;let i=this.getMembers().get(t?.user.id);if(i===void 0)throw Error(`Attempted to fetch client ${e} that is not part of the current member list`);return i}shouldIncludeAsMember(e){return e.details.capabilities.interactive}};var qh=class extends Lh{createServiceMember(e){let t=e.user;return Ug(t?.name!==void 0,'Provided user was not an "AzureUser".'),{userId:e.user.id,userName:t.name,connections:[],additionalDetails:t.additionalDetails}}};Vt();var Re=function(n){return n[n.Disconnected=0]="Disconnected",n[n.EstablishingConnection=3]="EstablishingConnection",n[n.Connecting=1]="Connecting",n[n.CatchingUp=1]="CatchingUp",n[n.Connected=2]="Connected",n}(Re||{});var nk=Ce(V4());qt();Y();Vt();Hr();var _n=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(_n||{});var Dn=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Dn||{});var jh=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(jh||{});Pe();var H4=Ce(fi());var Vh=class extends H4.EventEmitter{constructor(){super(...arguments),this.members=new Map}on(e,t){return super.on(e,t)}addMember(e,t){this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){let t=this.members.get(e);return t!==void 0?(this.members.delete(e),this.emit("removeMember",e,t),!0):!1}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}clear(){let e=this.members.keys();for(let t of e)this.removeMember(t)}};Y();Vt();Pe();var AH="Code package does not implement IRuntimeFactory",Hh=class n{constructor(e,t,r,i,o,s,a,c,l,h,u,d,p,m,g){this.container=e,this.scope=t,this.codeLoader=r,this._codeDetails=i,this._baseSnapshot=o,this.deltaManager=s,this.loader=c,this.submitFn=l,this.submitSignalFn=h,this.closeFn=u,this.version=d,this.updateDirtyContainerState=p,this.existing=m,this.pendingLocalState=g,this._disposed=!1,this._quorum=a,this.taggedLogger=e.subLogger,this._fluidModuleP=new Lt(()=>v(this,null,function*(){return this.loadCodeModule(i)})),this.attachListener()}static createOrLoad(e,t,r,i,o,s,a,c,l,h,u,d,p,m,g){return v(this,null,function*(){let x=new n(e,t,r,i,o,s,a,c,l,h,u,d,p,m,g);return yield x.instantiateRuntime(m),x})}get clientId(){return this.container.clientId}get id(){let e=this.container.resolvedUrl;return Dc(e)?e.id:""}get clientDetails(){return this.container.clientDetails}get connected(){return this.container.connected}get canSummarize(){return"summarize"in this.runtime}get serviceConfiguration(){return this.container.serviceConfiguration}get audience(){return this.container.audience}get options(){return this.container.options}get baseSnapshot(){return this._baseSnapshot}get storage(){return this.container.storage}get runtime(){if(this._runtime===void 0)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get disposed(){return this._disposed}get codeDetails(){return this._codeDetails}get quorum(){return this._quorum}getSpecifiedCodeDetails(){var e;return(e=this._quorum.get("code"))!==null&&e!==void 0?e:this._quorum.get("code2")}dispose(e){this._disposed||(this._disposed=!0,this.runtime.dispose(e),this._quorum.dispose(),this.deltaManager.dispose())}getLoadedFromVersion(){return this.container.loadedFromVersion}get attachState(){return this.container.attachState}createSummary(e){return this.runtime.createSummary(e)}setConnectionState(e,t){let r=this.runtime;w(e===this.connected,222),r.setConnectionState(e,t)}process(e,t,r){this.runtime.process(e,t,r)}processSignal(e,t){this.runtime.processSignal(e,t)}request(e){return v(this,null,function*(){return this.runtime.request(e)})}getAbsoluteUrl(e){return v(this,null,function*(){return this.container.getAbsoluteUrl(e)})}getPendingLocalState(){return this.runtime.getPendingLocalState()}satisfies(e){return v(this,null,function*(){var t;let r=[],i=this.codeLoader;i.IFluidCodeDetailsComparer!==void 0&&r.push(i.IFluidCodeDetailsComparer);let o=yield this._fluidModuleP,s=(t=o.module)===null||t===void 0?void 0:t.fluidExport;if(s?.IFluidCodeDetailsComparer!==void 0&&r.push(s.IFluidCodeDetailsComparer),r.length===0)return!1;for(let a of r)if((yield a.satisfies(o.details,e))===!1)return!1;return!0})}notifyAttaching(e){var t,r;this._baseSnapshot=e,(r=(t=this.runtime).notifyAttaching)===null||r===void 0||r.call(t,e),this.runtime.setAttachState(oe.Attaching)}getRuntimeFactory(){return v(this,null,function*(){var e;let t=(e=(yield this._fluidModuleP).module)===null||e===void 0?void 0:e.fluidExport,r=t?.IRuntimeFactory;if(r===void 0)throw new Error(AH);return r})}instantiateRuntime(e){return v(this,null,function*(){let t=yield this.getRuntimeFactory();this._runtime=yield t.instantiateRuntime(this,e)})}attachListener(){this.container.once("attached",()=>{this.runtime.setAttachState(oe.Attached)})}loadCodeModule(e){return v(this,null,function*(){let t=yield le.timedExecAsync(this.taggedLogger,{eventName:"CodeLoad"},()=>v(this,null,function*(){return this.codeLoader.load(e)}));if("module"in t){let{module:r,details:i}=t;return{module:r,details:i??e}}else return this.taggedLogger.sendTelemetryEvent({eventName:"LegacyCodeLoader"}),t})}};Vt();var ln=function(n){return n.Never="Never",n.Disabled="Disabled",n.Enabled="Enabled",n}(ln||{}),U4=n=>{let e;return n&&"name"in n?e=n:Hs(n?.package)?e=n?.package.name:e=n?.package,{name:e}};var C0=Ce(y0());qt();Y();Pe();Y();var W4=Ce(Kv());var Eo=class extends we{constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new W4.default,this.pauseCount=1}get disposed(){return this.isDisposed}get paused(){return this.pauseCount!==0}get length(){return this.q.length}get idle(){return this.processingPromise===void 0&&this.q.length===0}waitTillProcessingDone(){return v(this,null,function*(){var e;return(e=this.processingPromise)!==null&&e!==void 0?e:{count:0,duration:0}})}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(t){this.emit("error",t)}}pause(){return v(this,null,function*(){this.pauseCount++,yield this.waitTillProcessingDone()})}resume(){w(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&this.processingPromise===void 0&&(this.processingPromise=Promise.resolve().then(()=>{w(this.processingPromise!==void 0,"reentrancy?");let e=this.processDeltas();return w(this.processingPromise!==void 0,"reentrancy?"),this.processingPromise=void 0,e}).catch(e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0})),w(this.processingPromise!==void 0,"processDeltas() should run async"))}anythingToProcess(){return this.q.length!==0&&!this.paused&&this.error===void 0}processDeltas(){let e=de.now(),t=0;for(;this.anythingToProcess();){let i=this.q.shift();t++,this.worker(i),this.emit("op",i)}let r=de.now()-e;return this.q.length===0&&this.emit("idle",t,r),{count:t,duration:r}}};var Gh=class extends we{constructor(e,t,r,i){super(),this.serviceProvider=e,this.logger=t,this._active=r,this.pending=[],this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.baseTerm=0,this.opsSize=0,this.initSequenceNumber=0,this.closed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new C0.default,this.deltaStorageDelayId=ke(),this.deltaStreamDelayId=ke(),this.messageBuffer=[];let o={incomingOpHandler:(s,a)=>{try{this.enqueueMessages(s,a)}catch(c){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},c),this.close(an(c))}},signalHandler:s=>this._inboundSignal.push(s),reconnectionDelayHandler:(s,a)=>this.emitDelayInfo(this.deltaStreamDelayId,s,a),closeHandler:s=>this.close(s),disconnectHandler:s=>this.disconnectHandler(s),connectHandler:s=>this.connectHandler(s),pongHandler:s=>this.emit("pong",s),readonlyChangeHandler:s=>am(this,this.logger,"readonly",s)};this.connectionManager=i(o),this._inbound=new Eo(s=>{this.processInboundMessage(s)}),this._inbound.on("error",s=>{this.close(Ot.wrapIfUnrecognized(s,"deltaManagerInboundErrorHandler",this.lastMessage))}),this._inboundSignal=new Eo(s=>{if(this.handler===void 0)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({clientId:s.clientId,content:JSON.parse(s.content)})}),this._inboundSignal.on("error",s=>{this.close(an(s))})}get active(){return this._active()}get disposed(){return this.closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get referenceTerm(){return this.baseTerm}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return w(this.connectionManager.connected,223),this._checkpointSequenceNumber!==void 0}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t,r=!1,i){let o={contents:JSON.stringify(t),metadata:i,referenceSequenceNumber:this.lastProcessedSequenceNumber,type:e};r||this.flush();let s=this.connectionManager.prepareMessageToSend(o);return s===void 0?-1:(this.opsSize+=s.contents.length,this.messageBuffer.push(s),this.emit("submitOp",s),r||this.flush(),s.clientSequenceNumber)}submitSignal(e){return this.connectionManager.submitSignal(e)}flush(){this.messageBuffer.length!==0&&(this.emit("prepareSend",this.messageBuffer),this.connectionManager.sendMessages(this.messageBuffer),this.messageBuffer=[])}get connectionProps(){return Object.assign({sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0},this.connectionManager.connectionProps)}logConnectionIssue(e){var t;w(this.connectionManager.connected,568);let r=this.pending.sort((i,o)=>i.sequenceNumber-o.sequenceNumber);this.logger.sendErrorEvent(Object.assign(Object.assign(Object.assign(Object.assign({},e),{fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber}),this.connectionManager.connectionVerboseProps),{pendingOps:this.pending.length,pendingFirst:(t=r[0])===null||t===void 0?void 0:t.sequenceNumber,haveHandler:this.handler!==void 0,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused}))}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);let t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;let r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,r!==void 0&&this.updateLatestKnownOpSeqNumber(r),w(this.messageBuffer.length===0,233),this.opsSize=0,this.emit("connect",e,r!==void 0?this.lastObservedSeqNumber-this.lastSequenceNumber:void 0),r!==void 0?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):e.mode==="read"&&this.fetchMissingDeltas("AfterReadConnection")}dispose(){throw new Error("Not implemented.")}attachOpHandler(e,t,r,i,o="none"){return v(this,null,function*(){if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=t,this.baseTerm=r,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=t,this.lastObservedSeqNumber=t,w(this.handler===void 0,226),this.handler=i,w(!!this.handler,227),w(this.fetchReason===void 0,616),!this.closed){if(this._inbound.resume(),this._inboundSignal.resume(),o!=="none"){let s=o==="cached";yield this.fetchMissingDeltasCore(`DocumentOpen_${o}`,s),s&&this.fetchMissingDeltas("PostDocumentOpen")}w(this.fetchReason!==void 0||this.pending.length===0,617)}})}connect(e){var t;let r=(t=e.fetchOpsFromStorage)!==null&&t!==void 0?t:!0;lm(this.handler!==void 0||!r,this.logger,"CantFetchWithoutBaseline"),r&&this.fetchMissingDeltas(e.reason),this.connectionManager.connect(e.mode)}getDeltas(e,t,r,i,o){return v(this,null,function*(){let s=this.serviceProvider();if(s===void 0)throw new Error("Delta manager is not attached");this.deltaStorage===void 0&&(this.deltaStorage=yield s.connectToDeltaStorage());let a;if(t!==void 0){let u=t-1;if(this.lastQueuedSequenceNumber>=u){this.logger.sendPerformanceEvent(Object.assign({reason:r,eventName:"ExtraStorageCall",early:!0,from:e,to:t},this.connectionManager.connectionVerboseProps));return}a=d=>d.sequenceNumber>=u}else a=u=>u.sequenceNumber>=this.lastObservedSeqNumber;let c=new C0.default,l=!1,h=u=>{w(u.sequenceNumber===this.lastQueuedSequenceNumber,570),!l&&a(u)&&(c.abort(),this._inbound.off("push",h))};try{this._inbound.on("push",h),w(this.closeAbortController.signal.onabort===null,488),this.closeAbortController.signal.onabort=()=>c.abort();let u=this.deltaStorage.fetchMessages(e,t,c.signal,o,r);for(;;){let d=yield u.read();if(d.done)break;try{l=!0,i(d.value)}finally{l=!1}}}finally{this.closeAbortController.signal.onabort=null,this._inbound.off("push",h),w(!l,649)}})}close(e){this.closed||(this.closed=!0,this.connectionManager.dispose(e),this.closeAbortController.abort(),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[],this.emit("closed",e),this.removeAllListeners())}refreshDelayInfo(e){this.throttlingIdSet.delete(e),this.throttlingIdSet.size===0&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e)}emitDelayInfo(e,t,r){let i=Date.now();if(this.throttlingIdSet.add(e),t>0&&i+t>this.timeTillThrottling){this.timeTillThrottling=i+t;let o=Hu.wrap(r,t/1e3,this.logger);this.emit("throttled",o)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t,r=!1){var i,o;if(this.handler===void 0){this.pending=this.pending.concat(e);return}if(w(this.pending.length===0||this.fetchReason!==void 0,489),e.length===0)return;let s=e[0].sequenceNumber,a=e[e.length-1].sequenceNumber;if(a>this.lastQueuedSequenceNumber){let l=s-1,h=l-this.lastQueuedSequenceNumber,u,d=0,p=0;for(let g of e)g.sequenceNumber===l?d++:g.sequenceNumber!==l+1&&(p++,u===void 0&&(u=l+1)),l=g.sequenceNumber;let m;d!==0||p!==0&&!r||h>0&&this.fetchReason===void 0?m="enqueueMessages":this.fetchReason!==void 0&&this.fetchReason!==t&&s<=this.lastQueuedSequenceNumber+1&&a>this.lastQueuedSequenceNumber&&(m="enqueueMessagesExtraFetch"),m!==void 0&&this.logger.sendPerformanceEvent(Object.assign({eventName:m,reason:t,previousReason:this.prevEnqueueMessagesReason,from:s,to:a+1,length:e.length,fetchReason:this.fetchReason,duplicate:d>0?d:void 0,initialGap:h!==0?h:void 0,gap:p>0?p:void 0,firstMissing:u,dmInitialSeqNumber:this.initialSequenceNumber},this.connectionManager.connectionVerboseProps))}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);let c=(i=this.previouslyProcessedMessage)===null||i===void 0?void 0:i.sequenceNumber;w(c===void 0||c===this.lastQueuedSequenceNumber,236);for(let l of e)if(l.sequenceNumber<=this.lastQueuedSequenceNumber){if(((o=this.previouslyProcessedMessage)===null||o===void 0?void 0:o.sequenceNumber)===l.sequenceNumber){let h=this.comparableMessagePayload(this.previouslyProcessedMessage),u=this.comparableMessagePayload(l);if(h!==u){let d=new Wr("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",Xt.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:l.sequenceNumber,message1:h,message2:u,driverVersion:void 0});this.close(d)}}}else l.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(l),this.fetchMissingDeltas(t,l.sequenceNumber)):(this.lastQueuedSequenceNumber=l.sequenceNumber,this.previouslyProcessedMessage=l,this._inbound.push(l));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){let t=Date.now();if(this.lastProcessedMessage=e,w(e.clientId!==void 0||!nE(e),237),typeof e.contents=="string"&&e.contents!==""&&e.type!==_n.ClientLeave&&(e.contents=JSON.parse(e.contents)),this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw new Jt("Found a lower minimumSequenceNumber (msn) than previously recorded",Object.assign(Object.assign({},fr(e)),{clientId:this.connectionManager.clientId}));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Jt("Found a non-Sequential sequenceNumber",Object.assign(Object.assign({},fr(e)),{clientId:this.connectionManager.clientId}));if(this.lastProcessedSequenceNumber=e.sequenceNumber,w(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),e.term===void 0&&(e.term=1),this.baseTerm=e.term,this.handler===void 0)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e);let r=Date.now();this.emit("op",e,r-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch(r=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},r)})}fetchMissingDeltasCore(e,t,r){return v(this,null,function*(){var i;if(this.fetchReason===void 0){if(this.closed){this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});return}if(this.handler===void 0){w(this.lastQueuedSequenceNumber===0,619);return}try{let o=this.lastQueuedSequenceNumber+1,s=(i=this.previouslyProcessedMessage)===null||i===void 0?void 0:i.sequenceNumber;s!==void 0&&(w(s===this.lastQueuedSequenceNumber,242),w(o>1,243),o--);let a=`${e}_fetch`;this.fetchReason=a,yield this.getDeltas(o,r,a,c=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(c,a)},t)}catch(o){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},o),this.close(an(o))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}}})}processPendingOps(e){if(this.closed)return;w(this.handler!==void 0,620);let t=this.pending.sort((r,i)=>r.sequenceNumber-i.sequenceNumber);this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),this.fetchReason===void 0&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}};Y();var el=class extends gi{constructor(e){super(e),this.queue=e}get paused(){return this.queue.paused}get length(){return this.queue.length}get idle(){return this.queue.idle}peek(){return this.queue.peek()}toArray(){return this.queue.toArray()}systemPause(){return v(this,null,function*(){return this.pause()})}pause(){return v(this,null,function*(){return this.queue.pause()})}systemResume(){return v(this,null,function*(){return this.resume()})}resume(){return v(this,null,function*(){this.queue.resume()})}waitTillProcessingDone(){return v(this,null,function*(){return this.queue.waitTillProcessingDone()})}},Wh=class extends gi{constructor(e){super(e),this.deltaManager=e,this.inbound=new el(e.inbound),this.outbound=new el(e.outbound),this.inboundSignal=new el(e.inboundSignal)}get IDeltaSender(){return this}get minimumSequenceNumber(){return this.deltaManager.minimumSequenceNumber}get lastSequenceNumber(){return this.deltaManager.lastSequenceNumber}get lastMessage(){return this.deltaManager.lastMessage}get lastKnownSeqNumber(){return this.deltaManager.lastKnownSeqNumber}get initialSequenceNumber(){return this.deltaManager.initialSequenceNumber}get hasCheckpointSequenceNumber(){return this.deltaManager.hasCheckpointSequenceNumber}get clientDetails(){return this.deltaManager.clientDetails}get version(){return this.deltaManager.version}get maxMessageSize(){return this.deltaManager.maxMessageSize}get serviceConfiguration(){return this.deltaManager.serviceConfiguration}get active(){return this.deltaManager.active}get readOnlyInfo(){return this.deltaManager.readOnlyInfo}dispose(){this.inbound.dispose(),this.outbound.dispose(),this.inboundSignal.dispose(),super.dispose()}submitSignal(e){return this.deltaManager.submitSignal(e)}flush(){return this.deltaManager.flush()}};qt();Vt();Pe();var K4=Ce(Gm());qt();Y();Pe();function Kh(n){var e;let t=(0,K4.parse)(n,!0);if(typeof t.pathname!="string")throw new Be("Failed to parse pathname");let r=(e=t.search)!==null&&e!==void 0?e:"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return o?.length===3?{id:o[1],path:o[2],query:r,version:t.query.version}:void 0}function $4(n){let e={blobs:{},blobsContents:{},trees:{},id:ke(),unreferenced:n.unreferenced},t=Object.keys(n.tree);for(let r of t){let i=n.tree[r];switch(i.type){case Dn.Tree:{e.trees[r]=$4(i);break}case Dn.Attachment:e.blobs[r]=i.id;break;case Dn.Blob:{let o=ke();e.blobs[r]=o;let s=typeof i.content=="string"?Bn(i.content,"utf8"):Hg(i.content);e.blobsContents[o]=s;break}case Dn.Handle:throw new Be("No handles should be there in summary in detached container!!");default:vt(i,`Unknown tree type ${i.type}`)}}return e}function TH(n,e){let t={type:Dn.Tree,tree:Object.assign({},e.tree)};return t.tree[".protocol"]=n,$4(t)}var $h=n=>{let e=n.tree[".protocol"],t=n.tree[".app"];return w(e!==void 0&&t!==void 0,480),TH(e,t)};function w0(n){return".protocol"in n.trees?n.trees[".protocol"]:n}var Xh="1.4.0";function X4(n){return n.headers===void 0?!0:n.headers[lt.cache]!==!1}var nl=class{constructor(e,t){this.container=e,this.loader=t}get IFluidRouter(){return this}resolve(e){return v(this,null,function*(){var t,r,i,o,s;if(e.url.startsWith("/")){if(X4(e))return this.container;{let a=this.container.resolvedUrl;return vn(a),yield tl.load(this.loader,{canReconnect:(t=e.headers)===null||t===void 0?void 0:t[lt.reconnect],clientDetailsOverride:(r=e.headers)===null||r===void 0?void 0:r[lt.clientDetails],resolvedUrl:Object.assign({},a),version:(o=(i=e.headers)===null||i===void 0?void 0:i[lt.version])!==null&&o!==void 0?o:void 0,loadMode:(s=e.headers)===null||s===void 0?void 0:s[lt.loadMode]})}}if(this.loader===void 0)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)})}request(e){return v(this,null,function*(){return e.url.startsWith("/")?(yield this.resolve(e)).request(e):this.loader===void 0?{status:404,value:"Cannot request external containers",mimeType:"plain/text"}:this.loader.request(e)})}};function DH(n){let e=Object.create(n),t=new Map;return e.resolve=r=>v(this,null,function*(){return X4(r)?(t.has(r.url)||t.set(r.url,n.resolve(r)),t.get(r.url)):n.resolve(r)}),e}var rl=class{constructor(e){var t,r;this.containers=new Map;let i=Object.assign({},e.scope);((t=e.options)===null||t===void 0?void 0:t.provideScopeLoader)!==!1&&(i.ILoader=this);let o={loaderId:ke(),loaderVersion:Xh},s=ho(yc.mixinDebugLogger("fluid:telemetry",e.logger,{all:o}),dc.value,e.configProvider);this.services={urlResolver:DH(Mu.create(e.urlResolver)),documentServiceFactory:Ou.create(e.documentServiceFactory),codeLoader:e.codeLoader,options:(r=e.options)!==null&&r!==void 0?r:{},scope:i,subLogger:s.logger,detachedBlobStorage:e.detachedBlobStorage},this.mc=Mn(ue.create(this.services.subLogger,"Loader"))}get IFluidRouter(){return this}createDetachedContainer(e){return v(this,null,function*(){let t=yield tl.createDetached(this,e);return this.cachingEnabled&&t.once("attached",()=>{vn(t.resolvedUrl);let r=Kh(t.resolvedUrl.url);r!==void 0&&this.addToContainerCache(r.id,Promise.resolve(t))}),t})}rehydrateDetachedContainerFromSnapshot(e){return v(this,null,function*(){return tl.rehydrateDetachedFromSnapshot(this,e)})}resolve(e,t){return v(this,null,function*(){let r=t===void 0?"Resolve":"ResolveWithPendingState";return le.timedExecAsync(this.mc.logger,{eventName:r},()=>v(this,null,function*(){return(yield this.resolveCore(e,t!==void 0?JSON.parse(t):void 0)).container}))})}request(e){return v(this,null,function*(){return le.timedExecAsync(this.mc.logger,{eventName:"Request"},()=>v(this,null,function*(){let t=yield this.resolveCore(e);return t.container.request(Object.assign(Object.assign({},e),{url:`${t.parsed.path}${t.parsed.query}`}))}))})}getKeyForContainerCache(e,t){var r;return((r=e.headers)===null||r===void 0?void 0:r[lt.version])!==void 0?`${t.id}@${e.headers[lt.version]}`:t.id}addToContainerCache(e,t){this.containers.set(e,t),t.then(r=>{r.closed?this.containers.delete(e):r.once("closed",()=>{this.containers.delete(e)})}).catch(r=>{})}resolveCore(e,t){return v(this,null,function*(){let r=yield this.services.urlResolver.resolve(e);vn(r);let i=Kh(r.url);if(i===void 0)throw new Error(`Invalid URL ${r.url}`);if(t!==void 0){let l=Kh(t.url);if(l?.id!==i.id||l?.path.replace(/\/$/,"")!==i.path.replace(/\/$/,"")){let h=`URL ${r.url} does not match pending state URL ${t.url}`;throw new Error(h)}}let{canCache:o,fromSequenceNumber:s}=this.parseHeader(i,e),a=t!==void 0?!1:o,c;if(a){let l=this.getKeyForContainerCache(e,i),h=yield this.containers.get(l);if(h!==void 0)c=h;else{let u=this.loadContainer(e,r);this.addToContainerCache(l,u),c=yield u}}else c=yield this.loadContainer(e,r,t);return c.deltaManager.lastSequenceNumber<=s&&(yield new Promise((l,h)=>{function u(d){d.sequenceNumber>s&&(l(),c.removeListener("op",u))}c.on("op",u)})),{container:c,parsed:i}})}get cachingEnabled(){return this.services.options.cache!==!1}canCacheForRequest(e){return this.cachingEnabled&&e[lt.cache]!==!1}parseHeader(e,t){var r,i;let o=-1;t.headers=(r=t.headers)!==null&&r!==void 0?r:{};let s=t.headers[lt.sequenceNumber];return s!==void 0&&(o=s),t.headers[lt.version]=(i=e.version)!==null&&i!==void 0?i:t.headers[lt.version],{canCache:this.canCacheForRequest(t.headers),fromSequenceNumber:o}}loadContainer(e,t,r){return v(this,null,function*(){var i,o,s,a,c;return tl.load(this,{canReconnect:(i=e.headers)===null||i===void 0?void 0:i[lt.reconnect],clientDetailsOverride:(o=e.headers)===null||o===void 0?void 0:o[lt.clientDetails],resolvedUrl:t,version:(a=(s=e.headers)===null||s===void 0?void 0:s[lt.version])!==null&&a!==void 0?a:void 0,loadMode:(c=e.headers)===null||c===void 0?void 0:c[lt.loadMode]},r)})}};Y();Pe();var FH=45e3,Jh=class{constructor(e,t,r){var i;this.handler=e,this.logger=t,this._clientId=r,this._connectionState=Re.Disconnected,this.prevClientLeftTimer=new fn((i=this.handler.maxClientLeaveWaitTime)!==null&&i!==void 0?i:3e5,()=>{w(!this.connected,684),this.applyForConnectedState("timeout")}),this.joinOpTimer=new fn(FH,()=>{var o;if(this.connectionState!==Re.CatchingUp)return;let s=this.handler.quorumClients(),a={quorumInitialized:s!==void 0,hasPendingClientId:this.pendingClientId!==void 0,inQuorum:s?.getMember((o=this.pendingClientId)!==null&&o!==void 0?o:"")!==void 0,waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("NoJoinOp",a)})}get connectionState(){return this._connectionState}get connected(){return this.connectionState===Re.Connected}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}startJoinOpTimer(){w(!this.joinOpTimer.hasTimer,564),this.joinOpTimer.start()}stopJoinOpTimer(){w(this.joinOpTimer.hasTimer,565),this.joinOpTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){w(!this.joinOpTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinOpTimer.hasTimer?this.stopJoinOpTimer():this.handler.logConnectionIssue("ReceivedJoinOp"),this.waitingForLeaveOp&&(this.waitEvent=le.start(this.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){var t,r;let i=this.handler.quorumClients();w(i!==void 0,566),w(this.waitingForLeaveOp===!1||this.clientId!==void 0&&i.getMember(this.clientId)!==void 0,738),this.pendingClientId!==this.clientId&&this.pendingClientId!==void 0&&i.getMember(this.pendingClientId)!==void 0&&!this.waitingForLeaveOp?((t=this.waitEvent)===null||t===void 0||t.end({source:e}),this.setConnectionState(Re.Connected)):this.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:e==="timeout"?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,inQuorum:i?.getMember((r=this.pendingClientId)!==null&&r!==void 0?r:"")!==void 0})})}receivedRemoveMemberEvent(e){this.clientId===e&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.joinOpTimer.hasTimer&&this.stopJoinOpTimer(),this.setConnectionState(Re.Disconnected,e)}receivedConnectEvent(e,t){let r=this._connectionState;this._connectionState=Re.CatchingUp;let i=e==="write";w(i||!this.handler.shouldClientJoinWrite(),778),w(i||!this.waitingForLeaveOp,678);let o=this.handler.quorumClients();this._pendingClientId=t.clientId,this.handler.logConnectionStateChangeTelemetry(Re.CatchingUp,r),i&&o?.getMember(this._pendingClientId)===void 0?this.startJoinOpTimer():this.waitingForLeaveOp||this.setConnectionState(Re.Connected)}setConnectionState(e,t){if(this.connectionState===e){this.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});return}let r=this._connectionState;this._connectionState=e;let i=this.handler.quorumClients(),o;this._clientId!==void 0&&(o=i?.getMember(this._clientId)),e===Re.Connected?(w(r===Re.CatchingUp,472),o!==void 0&&(o.shouldHaveLeft=!0),this._clientId=this.pendingClientId):e===Re.Disconnected&&(this._pendingClientId=void 0,o!==void 0&&this.handler.shouldClientJoinWrite()&&this.prevClientLeftTimer.hasTimer===!1?this.prevClientLeftTimer.restart():this.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({inQuorum:o!==void 0,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.logConnectionStateChangeTelemetry(this._connectionState,r,t),this.handler.connectionStateChanged()}initProtocol(e){e.quorum.on("addMember",(t,r)=>{this.receivedAddMemberEvent(t)}),e.quorum.on("removeMember",t=>{this.receivedRemoveMemberEvent(t)}),this.clientId!==void 0&&e.quorum.getMember(this.clientId)!==void 0&&this.prevClientLeftTimer.restart()}};Y();var Qh=class{constructor(e,t){this.internalStorageService=e,this.logger=t,this._disposed=!1}get policies(){return this.internalStorageService.policies}get disposed(){return this._disposed}dispose(){this._disposed=!0}get repositoryUrl(){return this.internalStorageService.repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.getSnapshotTree(e,t)}),"storage_getSnapshotTree")})}readBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.readBlob(e)}),"storage_readBlob")})}getVersions(e,t,r){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.getVersions(e,t,r)}),"storage_getVersions")})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return w(t.referenceSequenceNumber===0==(t.ackHandle===void 0),593),t.referenceSequenceNumber!==0?this.internalStorageService.uploadSummaryWithContext(e,t):this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(e,t)}),"storage_uploadSummaryWithContext")})}downloadSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.downloadSummary(e)}),"storage_downloadSummary")})}createBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.createBlob(e)}),"storage_createBlob")})}checkStorageDisposed(){if(this._disposed)throw new xn("Storage Service is disposed. Cannot retry",{canRetry:!1})}runWithRetry(e,t){return v(this,null,function*(){return Ns(e,t,this.logger,{onRetry:()=>this.checkStorageDisposed()})})}};var Yh=class{constructor(e,t){this.internalStorageService=e,this.generateProtocolTree=t,this.getSnapshotTree=this.internalStorageService.getSnapshotTree.bind(this.internalStorageService),this.getVersions=this.internalStorageService.getVersions.bind(this.internalStorageService),this.createBlob=this.internalStorageService.createBlob.bind(this.internalStorageService),this.readBlob=this.internalStorageService.readBlob.bind(this.internalStorageService),this.downloadSummary=this.internalStorageService.downloadSummary.bind(this.internalStorageService),this.dispose=this.internalStorageService.dispose.bind(this.internalStorageService)}get policies(){return this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}get disposed(){return this.internalStorageService.disposed}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(Rs(e,this.generateProtocolTree()),t)})}};var Zh=class{constructor(e){this.storageGetter=e,this.blobContents={}}loadSnapshotForRehydratingContainer(e){this.getBlobContents(e)}getBlobContents(e){for(let[t,r]of Object.entries(e.blobsContents))this.blobContents[t]=r;for(let[t,r]of Object.entries(e.trees))this.getBlobContents(r)}get policies(){try{return this.storageGetter().policies}catch{}}get repositoryUrl(){return this.storageGetter().repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.storageGetter().getSnapshotTree(e,t)})}readBlob(e){return v(this,null,function*(){let t=this.blobContents[e];return t!==void 0?t:this.storageGetter().readBlob(e)})}getVersions(e,t,r){return v(this,null,function*(){return this.storageGetter().getVersions(e,t,r)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.storageGetter().uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.storageGetter().downloadSummary(e)})}createBlob(e){return v(this,null,function*(){return this.storageGetter().createBlob(e)})}},ep=class{constructor(e,t){this.blobStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}createBlob(e){return v(this,null,function*(){return this.blobStorage.createBlob(e)})}readBlob(e){return v(this,null,function*(){return this.blobStorage.readBlob(e)})}get policies(){return this.notCalled()}get repositoryUrl(){return this.notCalled()}notCalled(){try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendErrorEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}};Y();var tp=class extends gi{constructor(e){super(e),super.setMaxListeners(50),this.propose=ao(this,e.propose.bind(e)),this.has=ao(this,e.has.bind(e)),this.get=ao(this,e.get.bind(e)),this.getMembers=ao(this,e.getMembers.bind(e)),this.getMember=ao(this,e.getMember.bind(e))}};function J4(n){let t=new Map(n).get("code");return w(t!==void 0,732),t?.value}function P0(n){return[["code",{key:"code",value:n,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]]}Y();var zH=2e3,IH=50,np=class{constructor(e,t=zH,r=IH){this.submit=e,this.NoopCountFrequency=r,this.opsCountSinceNoop=0,t!==1/0&&(this.timer=new fn(t,()=>{this.opsCountSinceNoop!==0&&this.submitNoop(!1)}))}scheduleSequenceNumberUpdate(e,t){if(t){this.submitNoop(!0);return}if(Ri(e)){if(this.opsCountSinceNoop++,this.opsCountSinceNoop>=this.NoopCountFrequency){this.submitNoop(!1);return}this.timer!==void 0&&(this.opsCountSinceNoop===1&&this.timer.restart(),w(this.timer.hasTimer,578))}}submitNoop(e){this.submit(_n.NoOp,e?"":null),w(this.opsCountSinceNoop===0,579)}stopSequenceNumberUpdate(){this.opsCountSinceNoop=0}};var Y4=Ce(y0());Y();Pe();var RH=8e3,NH=1e3,BH=16*1024,Q4={fatalConnectError:!0};function LH(n){let e=`Nack (${n.type}): ${n.message}`,t=n.code!==403,r=n.retryAfter!==void 0?n.retryAfter*1e3:void 0;return Ar(e,{canRetry:t,retryAfterMs:r},{statusCode:n.code,driverVersion:void 0})}var il=class extends we{constructor(){super(...arguments),this.clientId="storage-only client",this.claims={scopes:[jh.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[],this.serviceConfiguration={maxMessageSize:0,blockSize:0,summary:void 0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map(t=>({operation:t,content:{message:"Cannot submit with storage-only connection",code:403}})))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}},rp=class n{constructor(e,t,r,i,o){this.serviceProvider=e,this.client=t,this.logger=i,this.props=o,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.trailingNoopCount=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this.closed=!1,this.opHandler=(s,a)=>{let c=Array.isArray(a)?a:[a];this.props.incomingOpHandler(c,"opHandler")},this.nackHandler=(s,a)=>{let c=a[0];if(this._readonlyPermissions===!0){this.props.closeHandler(Q2("writeOnReadOnlyDocument",{driverVersion:void 0}));return}let l=LH(c.content);if(!l.canRetry){this.props.closeHandler(l);return}this.reconnectOnError("write",l)},this.disconnectHandlerInternal=s=>{this.reconnectOnError(this.defaultReconnectionMode,s)},this.errorHandler=s=>{this.reconnectOnError(this.defaultReconnectionMode,s)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=r?ln.Enabled:ln.Never,this._outbound=new Eo(s=>{if(this.connection===void 0)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(s)}),this._outbound.on("error",s=>{this.props.closeHandler(an(s))})}get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){var e,t;return(t=(e=this.connection)===null||e===void 0?void 0:e.mode)!==null&&t!==void 0?t:"read"}get connected(){return this.connection!==void 0}get clientId(){var e;return(e=this.connection)===null||e===void 0?void 0:e.clientId}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){var e,t,r;return(r=(t=(e=this.connection)===null||e===void 0?void 0:e.serviceConfiguration)===null||t===void 0?void 0:t.maxMessageSize)!==null&&r!==void 0?r:BH}get version(){if(this.connection===void 0)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){var e;return(e=this.connection)===null||e===void 0?void 0:e.serviceConfiguration}get scopes(){var e;return(e=this.connection)===null||e===void 0?void 0:e.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return this.connection!==void 0?this._connectionProps:Object.assign(Object.assign({},this._connectionProps),{sentOps:this.clientSequenceNumber})}shouldJoinWrite(){return this.clientSequenceNumberObserved<this.clientSequenceNumber-this.trailingNoopCount}get readonly(){return this._forceReadonly?!0:this._readonlyPermissions}get readOnlyInfo(){let e=this.connection!==void 0&&this.connection instanceof il;return e||this._forceReadonly||this._readonlyPermissions===!0?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e){return{claims:e.claims,clientId:e.clientId,existing:e.existing,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version}}dispose(e){if(this.closed)return;this.closed=!0,this.pendingConnection=void 0,this._reconnectMode=ln.Never,this._outbound.clear();let t=e!==void 0?`Closing DeltaManager (${e.message})`:"Closing DeltaManager";this.disconnectFromDeltaStream(t),this.set_readonlyPermissions(!0)}setAutoReconnect(e){w(e!==ln.Never&&this._reconnectMode!==ln.Never,632),this._reconnectMode=e,e!==ln.Enabled&&this.disconnectFromDeltaStream("setAutoReconnect")}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});let t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===ln.Never)throw new ye("API is not supported for non-connecting or closed container");let r=!1;this.readonly===!0&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),r=this.disconnectFromDeltaStream("Force readonly")),this.props.readonlyChangeHandler(this.readonly),r&&this.triggerConnect("read")}}set_readonlyPermissions(e){let t=this.readonly;this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly)}connect(e){this.connectCore(e).catch(t=>{let r=an(t,{props:Q4});this.props.closeHandler(r)})}connectCore(e){return v(this,null,function*(){var t,r;if(w(!this.closed,618),this.connection!==void 0)return;let i;this.pendingConnection!==void 0&&(i=this.pendingConnection.connectionMode,this.cancelConnection(),w(this.pendingConnection===void 0,836));let o=(t=e??i)!==null&&t!==void 0?t:this.defaultReconnectionMode;this.shouldJoinWrite()&&(o="write");let s=this.serviceProvider();w(s!==void 0,679);let a;if(((r=s.policies)===null||r===void 0?void 0:r.storageOnly)===!0){a=new il,this.setupNewSuccessfulConnection(a,"read"),w(this.pendingConnection===void 0,691);return}let c=NH,l=0,h=de.now(),u,d=new Y4.default,p=d.signal;for(this.pendingConnection={abort:()=>{d.abort()},connectionMode:o};a===void 0;){if(this.closed)throw new Error("Attempting to connect a closed DeltaManager");if(p.aborted===!0){this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:at.formatTick(de.now()-h),connectionEstablished:!1});return}l++;try{this.client.mode=o,a=yield s.connectToDeltaStream(Object.assign(Object.assign({},this.client),{mode:o})),a.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),a=void 0)}catch(m){if(typeof m=="object"&&m!==null&&m?.errorType===Fc.errorType){a=new il,o="read";break}if(!kr(m)){let x=an(m,{props:Q4});throw this.props.closeHandler(x),x}Ic(this.logger,{attempts:l,delay:c,eventName:"DeltaConnectionFailureToConnect",duration:at.formatTick(de.now()-h)},m),u=m;let g=_o(m);c=g??Math.min(c*2,RH),g!==void 0&&this.props.reconnectionDelayHandler(g,m),yield Rc(c)}}if(l>1&&Ic(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:l,duration:at.formatTick(de.now()-h)},u),p.aborted===!0){a.dispose(),this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:at.formatTick(de.now()-h),connectionEstablished:!0});return}this.setupNewSuccessfulConnection(a,o)})}triggerConnect(e){w(this.connection===void 0,569),this.reconnectMode===ln.Enabled&&this.connect(e)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,this.connection===void 0)return this.pendingConnection!==void 0?(this.cancelConnection(),!0):!1;w(this.pendingConnection===void 0,635);let t=this.connection;return this.connection=void 0,t.off("op",this.opHandler),t.off("signal",this.props.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),this.props.disconnectHandler(e),t.dispose(),this._connectionVerboseProps={},!0}cancelConnection(){w(this.pendingConnection!==void 0,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived"})}setupNewSuccessfulConnection(e,t){w(this.connection===void 0,230),w(!e.disposed,650),this.pendingConnection=void 0,this.connection=e;let r=!e.claims.scopes.includes(jh.DocWrite);if(w(t==="read"||r===(this.connectionMode==="read"),231),w(!r||this.connectionMode==="read",232),this.set_readonlyPermissions(r),this.closed){this.disconnectFromDeltaStream("ConnectionManager already closed");return}this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.props.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);let i=e.initialMessages.sort((c,l)=>c.sequenceNumber-l.sequenceNumber),o=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},e.relayServiceAgent!==void 0&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let s=-1;if(i.length!==0&&(this._connectionVerboseProps.connectionInitialOpsFrom=i[0].sequenceNumber,s=i[i.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=s+1,(o===void 0||o<s)&&(o=s)),this.props.incomingOpHandler(i,this.connectFirstConnection?"InitialOps":"ReconnectOps"),e.initialSignals!==void 0)for(let c of e.initialSignals)this.props.signalHandler(c);let a=n.detailsFromConnection(e);a.checkpointSequenceNumber=o,this.props.connectHandler(a),this.connectFirstConnection=!1}reconnectOnError(e,t){this.reconnect(e,t.message,t).catch(this.props.closeHandler)}reconnect(e,t,r){return v(this,null,function*(){if(w(this.connection!==void 0,235),this.disconnectFromDeltaStream(t),r!==void 0&&!r.canRetry&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},r),this.reconnectMode===ln.Never&&this.props.closeHandler(),this.closed||this.reconnectMode!==ln.Enabled)return;let i=_o(r);r!==void 0&&i!==void 0&&(this.props.reconnectionDelayHandler(i,r),yield Rc(i)),this.triggerConnect(e)})}prepareMessageToSend(e){var t,r;if(this.readonly===!0){w(this.readOnlyInfo.readonly===!0,496);let i=new xn("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly});this.props.closeHandler(i);return}return w(!!this.connection,228),this.lastSubmittedClientId!==((t=this.connection)===null||t===void 0?void 0:t.clientId)&&(this.lastSubmittedClientId=(r=this.connection)===null||r===void 0?void 0:r.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),e.type===_n.NoOp?this.trailingNoopCount++:this.trailingNoopCount=0,Object.assign(Object.assign({},e),{clientSequenceNumber:++this.clientSequenceNumber})}submitSignal(e){this.connection!==void 0?this.connection.submitSignal(e):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}sendMessages(e){if(w(this.connected,692),this.connectionMode==="read"){this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then(()=>v(this,null,function*(){this.pendingReconnect&&(yield this.reconnect("write","Switch to write"))})).catch(()=>{}));return}w(!this.pendingReconnect,693),this._outbound.push(e)}beforeProcessingIncomingOp(e){if(w(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),this.lastSubmittedClientId!==void 0&&this.lastSubmittedClientId===e.clientId){let t=e.clientSequenceNumber;w(this.clientSequenceNumberObserved<t,239),w(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}e.type===_n.ClientLeave&&JSON.parse(e.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read","Switch to read").catch(i=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},i)}))}};var qH=0,Z4="dirty",O0="saved";var jH=n=>{var e;return(e=n.get("code"))!==null&&e!==void 0?e:n.get("code2")};function ek(n,e,t){return v(this,null,function*(){let r=le.start(n,{eventName:e}),i=yield t();r.duration>1e3&&r.end(i)})}var tk="summarizer",tl=(()=>{class n extends Vr{constructor(t,r){var i,o;super((u,d)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:typeof u=="string"?u:void 0},d)}),this.loader=t,this._canReconnect=!0,this._lifecycleState="loading",this._attachState=oe.Detached,this.inboundQueuePausedFromInit=!0,this.firstConnection=!0,this.connectionTransitionTimes=[],this.messageCountAfterDisconnection=0,this.attachStarted=!1,this._dirtyContainer=!1,this.setAutoReconnectTime=de.now(),this._audience=new Vh,this.clientDetailsOverride=r.clientDetailsOverride,this._resolvedUrl=r.resolvedUrl,r.canReconnect!==void 0&&(this._canReconnect=r.canReconnect);let s=this.client.details.type,c=`${this.client.details.capabilities.interactive?"interactive":"noninteractive"}${s!==void 0&&s!==""?`/${s}`:""}`;this.subLogger=ue.create(t.services.subLogger,void 0,{all:{clientType:c,containerId:ke(),docId:()=>{var u,d;return(d=(u=this._resolvedUrl)===null||u===void 0?void 0:u.id)!==null&&d!==void 0?d:void 0},containerAttachState:()=>this._attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>Re[this.connectionState],serializedContainer:r.serializedContainerState!==void 0},error:{dmInitialSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.initialSequenceNumber},dmLastProcessedSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.lastSequenceNumber},dmLastKnownSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.lastKnownSeqNumber},containerLoadedFromVersionId:()=>{var u;return(u=this.loadedFromVersion)===null||u===void 0?void 0:u.id},containerLoadedFromVersionDate:()=>{var u;return(u=this.loadedFromVersion)===null||u===void 0?void 0:u.date},dmLastMsqSeqNumber:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.sequenceNumber},dmLastMsqSeqTimestamp:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.timestamp},dmLastMsqSeqClientId:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.clientId},connectionStateDuration:()=>de.now()-this.connectionTransitionTimes[this.connectionState]}}),this.mc=Mn(ue.create(this.subLogger,"Container"));let l=(i=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree"))!==null&&i!==void 0?i:this.loader.services.options.summarizeProtocolTree;this.options=Object.assign(Object.assign({},this.loader.services.options),{summarizeProtocolTree:l}),this.connectionStateHandler=new Jh({quorumClients:()=>{var u;return(u=this._protocolHandler)===null||u===void 0?void 0:u.quorum},logConnectionStateChangeTelemetry:(u,d,p)=>this.logConnectionStateChangeTelemetry(u,d,p),shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:this.loader.services.options.maxClientLeaveWaitTime,logConnectionIssue:(u,d)=>{this._deltaManager.logConnectionIssue(Object.assign({eventName:u,duration:de.now()-this.connectionTransitionTimes[Re.CatchingUp]},d===void 0?{}:{details:JSON.stringify(d)}))},connectionStateChanged:()=>{this._lifecycleState==="loaded"&&this.propagateConnectionState()}},this.mc.logger,(o=r.serializedContainerState)===null||o===void 0?void 0:o.clientId),this.on(O0,()=>{this.connectionStateHandler.containerSaved()}),this._deltaManager=this.createDeltaManager(),this._storage=new Zh(()=>{if(this.attachState!==oe.Attached){if(this.loader.services.detachedBlobStorage!==void 0)return new ep(this.loader.services.detachedBlobStorage,this.mc.logger);throw this.mc.logger.sendErrorEvent({eventName:"NoRealStorageInDetachedContainer"}),new Error("Real storage calls not allowed in Unattached container")}return this.storageService}),typeof document=="object"&&document!==null&&typeof document.addEventListener=="function"&&document.addEventListener!==null&&(this.lastVisible=document.hidden?de.now():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=de.now():setTimeout(()=>{this.lastVisible=void 0},0)},document.addEventListener("visibilitychange",this.visibilityEventHandler)),this.on("newListener",(u,d)=>{Promise.resolve().then(()=>{switch(u){case Z4:this._dirtyContainer&&d();break;case O0:this._dirtyContainer||d();break;case Wd:this.connected&&d(this.clientId);break;case Kd:this.connected||d();break;default:}}).catch(p=>{this.mc.logger.sendErrorEvent({eventName:"RaiseConnectedEventError"},p)})})}static load(t,r,i){return v(this,null,function*(){let o=new n(t,{clientDetailsOverride:r.clientDetailsOverride,resolvedUrl:r.resolvedUrl,canReconnect:r.canReconnect,serializedContainerState:i});return le.timedExecAsync(o.mc.logger,{eventName:"Load"},s=>v(this,null,function*(){return new Promise((a,c)=>{var l,h;let u=r.version,d={opsBeforeReturn:"cached"},p=i?Object.assign(Object.assign({},(l=r.loadMode)!==null&&l!==void 0?l:d),{opsBeforeReturn:void 0}):(h=r.loadMode)!==null&&h!==void 0?h:d,m=g=>{c(g??new xn("Container closed without error during load"))};o.on("closed",m),o.load(u,p,i).finally(()=>{o.removeListener("closed",m)}).then(g=>{s.end(Object.assign(Object.assign({},g),r.loadMode)),a(o)},g=>{let x=an(g);o.close(x),m(x)})})}),{start:!0,end:!0,cancel:"generic"})})}static createDetached(t,r){return v(this,null,function*(){let i=new n(t,{});return le.timedExecAsync(i.mc.logger,{eventName:"CreateDetached"},o=>v(this,null,function*(){return yield i.createDetached(r),i}),{start:!0,end:!0,cancel:"generic"})})}static rehydrateDetachedFromSnapshot(t,r){return v(this,null,function*(){let i=new n(t,{});return le.timedExecAsync(i.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},o=>v(this,null,function*(){let s=JSON.parse(r);return yield i.rehydrateDetachedFromSnapshot(s),i}),{start:!0,end:!0,cancel:"generic"})})}setLoaded(){this._lifecycleState==="loading"&&(this.propagateConnectionState(),this._lifecycleState="loaded")}get closed(){return this._lifecycleState==="closing"||this._lifecycleState==="closed"}get storage(){return this._storage}get storageService(){if(this._storageService===void 0)throw new Error("Attempted to access storageService before it was defined");return this._storageService}get context(){if(this._context===void 0)throw new xn("Attempted to access context before it was defined");return this._context}get protocolHandler(){if(this._protocolHandler===void 0)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get IFluidRouter(){return this}get resolvedUrl(){return this._resolvedUrl}get loadedFromVersion(){return this._loadedFromVersion}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get closeSignal(){return this._deltaManager.closeAbortController.signal}forceReadonly(t){this._deltaManager.connectionManager.forceReadonly(t)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connected}get serviceConfiguration(){return this._deltaManager.serviceConfiguration}get clientId(){return this.connectionStateHandler.clientId}get scopes(){return this._deltaManager.connectionManager.scopes}get clientDetails(){return this._deltaManager.clientDetails}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){var t;return(t=this._context)===null||t===void 0?void 0:t.codeDetails}get audience(){return this._audience}get isDirty(){return this._dirtyContainer}get serviceFactory(){return this.loader.services.documentServiceFactory}get urlResolver(){return this.loader.services.urlResolver}get scope(){return this.loader.services.scope}get codeLoader(){return this.loader.services.codeLoader}getQuorum(){return this.protocolHandler.quorum}close(t){this._deltaManager.close(t),w(this.connectionState===Re.Disconnected,207),w(this._lifecycleState==="closed",788)}closeCore(t){var r,i,o,s;w(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:t===void 0?"generic":"error"},t),this._lifecycleState="closing",(r=this._protocolHandler)===null||r===void 0||r.close(),this.connectionStateHandler.dispose(),(i=this._context)===null||i===void 0||i.dispose(t!==void 0?new Error(t.message):void 0),(o=this._storageService)===null||o===void 0||o.dispose(),(s=this.service)===null||s===void 0||s.dispose(t)}catch(a){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},a)}this.emit("closed",t),this.removeAllListeners(),this.visibilityEventHandler!==void 0&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed"}}closeAndGetPendingLocalState(){w(this.attachState===oe.Attached,209),w(this.resolvedUrl!==void 0&&this.resolvedUrl.type==="fluid",210),w(!!this._protocolHandler,739),w(this._protocolHandler.attributes.term!==void 0,779);let t={pendingRuntimeState:this.context.getPendingLocalState(),url:this.resolvedUrl.url,protocol:this.protocolHandler.getProtocolState(),term:this._protocolHandler.attributes.term,clientId:this.clientId};return this.close(),JSON.stringify(t)}get attachState(){return this._attachState}serialize(){w(this.attachState===oe.Detached,211);let t=this.context.createSummary(),r=this.captureProtocolSummary(),i=Rs(t,r);return this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0&&(i.tree[".hasAttachmentBlobs"]={type:Dn.Blob,content:"true"}),JSON.stringify(i)}attach(t){return v(this,null,function*(){yield le.timedExecAsync(this.mc.logger,{eventName:"Attach"},()=>v(this,null,function*(){if(this._lifecycleState!=="loaded")throw new ye(`The Container is not in a valid state for attach [${this._lifecycleState}]`);w(this._attachState===oe.Detached&&!this.attachStarted,517),this.attachStarted=!0;let r=this.loader.services.detachedBlobStorage!==void 0&&this.loader.services.detachedBlobStorage.size>0;try{w(this.deltaManager.inbound.length===0,214);let i;if(!r){let a=this.context.createSummary(),c=this.captureProtocolSummary();i=Rs(a,c),this._attachState=oe.Attaching,this.context.notifyAttaching($h(i))}let o=yield this.urlResolver.resolve(t);vn(o),this.service===void 0&&(w(this.client.details.type!==tk,708),this.service=yield Ns(()=>v(this,null,function*(){return this.serviceFactory.createContainer(i,o,this.subLogger,!1)}),"containerAttach",this.mc.logger,{cancel:this.closeSignal}));let s=this.service.resolvedUrl;if(vn(s),this._resolvedUrl=s,yield this.connectStorageService(),r){w(!!this.loader.services.detachedBlobStorage,590);let a=new Map;for(;a.size<this.loader.services.detachedBlobStorage.size;){let h=this.loader.services.detachedBlobStorage.getBlobIds().filter(u=>!a.has(u));for(let u of h){let d=yield this.loader.services.detachedBlobStorage.readBlob(u),p=yield this.storageService.createBlob(d);a.set(u,p.id)}}let c=this.context.createSummary(a),l=this.captureProtocolSummary();i=Rs(c,l),this._attachState=oe.Attaching,this.context.notifyAttaching($h(i)),yield this.storageService.uploadSummaryWithContext(i,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0})}this._attachState=oe.Attached,this.emit("attached"),this.propagateConnectionState(),this.closed||this.resumeInternal({fetchOpsFromStorage:!1,reason:"createDetached"})}catch(i){let o=an(i),s=this.resolvedUrl;throw Dc(s)&&o.addTelemetryProperties({resolvedUrl:s.url}),this.close(o),o}}),{start:!0,end:!0,cancel:"generic"})})}request(t){return v(this,null,function*(){return le.timedExecAsync(this.mc.logger,{eventName:"Request"},()=>v(this,null,function*(){return this.context.request(t)}),{end:!0,cancel:"error"})})}setAutoReconnectInternal(t){if(this._deltaManager.connectionManager.reconnectMode===t)return;let i=de.now(),o=i-this.setAutoReconnectTime;this.setAutoReconnectTime=i,this.mc.logger.sendTelemetryEvent({eventName:t===ln.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:Re[this.connectionState],duration:o}),this._deltaManager.connectionManager.setAutoReconnect(t)}connect(){if(this.closed)throw new ye("The Container is closed and cannot be connected");if(this._attachState!==oe.Attached)throw new ye("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:"DocumentConnect",fetchOpsFromStorage:!1})}connectInternal(t){w(!this.closed,709),w(this._attachState===oe.Attached,710),this.resumeInternal(t);let r=ln.Enabled;this.setAutoReconnectInternal(r)}disconnect(){if(this.closed)throw new ye("The Container is closed and cannot be disconnected");this.disconnectInternal()}disconnectInternal(){w(!this.closed,711);let t=ln.Disabled;this.setAutoReconnectInternal(t)}resumeInternal(t){w(!this.closed,217),this.inboundQueuePausedFromInit&&(this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(t)}getAbsoluteUrl(t){return v(this,null,function*(){var r;if(this.resolvedUrl!==void 0)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,t,U4((r=this._context)===null||r===void 0?void 0:r.codeDetails))})}proposeCodeDetails(t){return v(this,null,function*(){if(!Vu(t))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){let r=yield this.codeLoader.IFluidCodeDetailsComparer.compare(t,this.getCodeDetailsFromQuorum());if(r!==void 0&&r<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",t).then(()=>!0).catch(()=>!1)})}processCodeProposal(){return v(this,null,function*(){let t=this.getCodeDetailsFromQuorum();if(yield Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]),(yield this.context.satisfies(t))===!0){this.deltaManager.inbound.resume(),this.deltaManager.inboundSignal.resume();return}this.close(new xn("Existing context does not satisfy incoming proposal"))})}getVersion(t){return v(this,null,function*(){return(yield this.storageService.getVersions(t,1))[0]})}recordConnectStartTime(){this.connectionTransitionTimes[Re.Disconnected]===void 0&&(this.connectionTransitionTimes[Re.Disconnected]=de.now())}connectToDeltaStream(t){this.recordConnectStartTime(),(!this._canReconnect||!this.client.details.capabilities.interactive)&&(t.mode="write"),this._deltaManager.connect(t)}load(t,r,i){return v(this,null,function*(){if(this._resolvedUrl===void 0)throw new Error("Attempting to load without a resolved url");this.service=yield this.serviceFactory.createDocumentService(this._resolvedUrl,this.subLogger,this.client.details.type===tk);let o={reason:"DocumentOpen",mode:"write",fetchOpsFromStorage:!1};r.deltaConnection===void 0&&this.connectToDeltaStream(o),i?this.connectStorageService().catch(u=>this.close(u)):yield this.connectStorageService(),this._attachState=oe.Attached;let{snapshot:s,versionId:a}=i===void 0?yield this.fetchSnapshotTree(t):{snapshot:void 0,versionId:void 0};w(s!==void 0||i!==void 0,567);let c=i===void 0?yield this.getDocumentAttributes(this.storageService,s):{sequenceNumber:i.protocol.sequenceNumber,minimumSequenceNumber:i.protocol.minimumSequenceNumber,term:i.term},l;switch(r.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(c,r.deltaConnection!=="none"?"all":"none");break;case"cached":l=this.attachDeltaManagerOpHandler(c,"cached");break;case"all":l=this.attachDeltaManagerOpHandler(c,"all");break;default:vt(r.opsBeforeReturn)}this._protocolHandler=i===void 0?yield this.initializeProtocolStateFromSnapshot(c,this.storageService,s):yield this.initializeProtocolState(c,i.protocol.members,i.protocol.proposals,i.protocol.values);let h=this.getCodeDetailsFromQuorum();if(yield this.instantiateContext(!0,h,s,i?.pendingRuntimeState),!this.closed)switch(l!==void 0&&(this._deltaManager.inbound.resume(),yield ek(this.mc.logger,"WaitOps",()=>v(this,null,function*(){return yield l,{}})),yield ek(this.mc.logger,"WaitOpProcessing",()=>v(this,null,function*(){return this._deltaManager.inbound.waitTillProcessingDone()})),this._deltaManager.inbound.pause()),r.deltaConnection){case void 0:case"delayed":w(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:vt(r.deltaConnection)}if(this.closed)throw new Error("Container was closed while load()");return this.setLoaded(),{sequenceNumber:c.sequenceNumber,version:a,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}})}createDetached(t){return v(this,null,function*(){let r={sequenceNumber:qH,term:1,minimumSequenceNumber:0};yield this.attachDeltaManagerOpHandler(r);let i=P0(t);this._protocolHandler=yield this.initializeProtocolState(r,[],[],i),yield this.instantiateContextDetached(!1),this.setLoaded()})}rehydrateDetachedFromSnapshot(t){return v(this,null,function*(){t.tree[".hasAttachmentBlobs"]!==void 0&&(w(!!this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0,592),delete t.tree[".hasAttachmentBlobs"]);let r=$h(t);this._storage.loadSnapshotForRehydratingContainer(r);let i=yield this.getDocumentAttributes(this._storage,r);yield this.attachDeltaManagerOpHandler(i);let o=w0(r),s=yield et(this._storage,o.blobs.quorumValues),a=J4(s);this._protocolHandler=yield this.initializeProtocolState(i,[],[],a!==void 0?P0(a):[]),yield this.instantiateContextDetached(!0,r),this.setLoaded()})}connectStorageService(){return v(this,null,function*(){var t,r;if(this._storageService!==void 0)return;w(this.service!==void 0,495);let i=yield this.service.connectToStorage();this._storageService=new Qh(i,this.mc.logger),this.options.summarizeProtocolTree===!0&&(this.mc.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this._storageService=new Yh(this._storageService,()=>this.captureProtocolSummary())),w(((t=i.policies)===null||t===void 0?void 0:t.minBlobSize)===((r=this.storageService.policies)===null||r===void 0?void 0:r.minBlobSize),224)})}getDocumentAttributes(t,r){return v(this,null,function*(){if(r===void 0)return{minimumSequenceNumber:0,sequenceNumber:0,term:1};let i=".protocol"in r.trees?r.trees[".protocol"].blobs.attributes:r.blobs[".attributes"],o=yield et(t,i);return o.term===void 0&&(o.term=1),o})}initializeProtocolStateFromSnapshot(t,r,i){return v(this,null,function*(){let o=[],s=[],a=[];if(i!==void 0){let l=w0(i);[o,s,a]=yield Promise.all([et(r,l.blobs.quorumMembers),et(r,l.blobs.quorumProposals),et(r,l.blobs.quorumValues)])}return yield this.initializeProtocolState(t,o,s,a)})}initializeProtocolState(t,r,i,o){return v(this,null,function*(){let s=new eu(t.minimumSequenceNumber,t.sequenceNumber,t.term,r,i,o,(c,l)=>this.submitMessage(_n.Propose,{key:c,value:l})),a=ue.create(this.subLogger,"ProtocolHandler");return s.quorum.on("error",c=>{a.sendErrorEvent(c)}),this.connectionStateHandler.initProtocol(s),s.quorum.on("addProposal",c=>{(c.key==="code"||c.key==="code2")&&this.emit("codeDetailsProposed",c.value,c)}),s.quorum.on("approveProposal",(c,l,h)=>{(l==="code"||l==="code2")&&(Vu(h)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch(u=>{throw this.close(an(u)),u}))}),s})}captureProtocolSummary(){let t=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:Dn.Blob},quorumMembers:{content:JSON.stringify(t.members),type:Dn.Blob},quorumProposals:{content:JSON.stringify(t.proposals),type:Dn.Blob},quorumValues:{content:JSON.stringify(t.values),type:Dn.Blob}},type:Dn.Tree}}getCodeDetailsFromQuorum(){let t=this.protocolHandler.quorum;return jH(t)}get client(){var t;let r=((t=this.options)===null||t===void 0?void 0:t.client)!==void 0?this.options.client:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}};return this.clientDetailsOverride!==void 0&&(0,nk.default)(r.details,this.clientDetailsOverride),r.details.environment=[r.details.environment,` loaderVersion:${Xh}`].join(";"),r}activeConnection(){return this.connectionState===Re.Connected&&this.connectionMode==="write"}createDeltaManager(){let t=()=>this.service,r=new Gh(t,ue.create(this.subLogger,"DeltaManager"),()=>this.activeConnection(),i=>new rp(t,this.client,this._canReconnect,ue.create(this.subLogger,"ConnectionManager"),i));return r.inbound.pause(),r.inboundSignal.pause(),r.on("connect",(i,o)=>{var s;this._audience.clear();for(let a of(s=i.initialClients)!==null&&s!==void 0?s:[])this._audience.addMember(a.clientId,a.client);this.connectionStateHandler.receivedConnectEvent(this.connectionMode,i)}),r.on("disconnect",i=>{var o;(o=this.collabWindowTracker)===null||o===void 0||o.stopSequenceNumberUpdate(),this.connectionStateHandler.receivedDisconnectEvent(i)}),r.on("throttled",i=>{let o=i;o.logged!==!0&&this.logContainerError(o),this.emit("warning",o)}),r.on("readonly",i=>{this.emit("readonly",i)}),r.on("closed",i=>{this.closeCore(i)}),r}attachDeltaManagerOpHandler(t,r){return v(this,null,function*(){var i;return this._deltaManager.attachOpHandler(t.minimumSequenceNumber,t.sequenceNumber,(i=t.term)!==null&&i!==void 0?i:1,{process:o=>this.processRemoteMessage(o),processSignal:o=>{this.processSignal(o)}},r)})}logConnectionStateChangeTelemetry(t,r,i){var o;let s=de.now();this.connectionTransitionTimes[t]=s;let a=s-this.connectionTransitionTimes[r],c,l,h,u,d;t===Re.Disconnected?h=this._deltaManager.connectionManager.reconnectMode:(t===Re.Connected?(c=s-this.connectionTransitionTimes[Re.Disconnected],c=at.formatTick(c)):(u=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&(d=u-this.deltaManager.lastSequenceNumber)),this.firstConnection?l="InitialConnect":l="AutoReconnect"),this.mc.logger.sendPerformanceEvent(Object.assign({eventName:`ConnectionStateChange_${Re[t]}`,from:Re[r],duration:a,durationFromDisconnected:c,reason:i,connectionInitiationReason:l,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.clientId,autoReconnect:h,opsBehind:d,online:Gr[zc()],lastVisible:this.lastVisible!==void 0?de.now()-this.lastVisible:void 0,checkpointSequenceNumber:u,quorumSize:(o=this._protocolHandler)===null||o===void 0?void 0:o.quorum.getMembers().size},this._deltaManager.connectionProps)),t===Re.Connected&&(this.firstConnection=!1)}propagateConnectionState(){var t;let r=this.connectionState===Re.Connected&&!this.firstConnection&&this.connectionMode==="write";r&&(this.messageCountAfterDisconnection=0);let i=this.connectionState===Re.Connected;((t=this._context)===null||t===void 0?void 0:t.disposed)===!1&&this.context.setConnectionState(i,this.clientId),this.protocolHandler.setConnectionState(i,this.clientId),po(this.mc.logger,this,i,this.clientId),r&&this.mc.logger.sendTelemetryEvent({eventName:"OpsSentOnReconnect",count:this.messageCountAfterDisconnection})}submitContainerMessage(t,r,i,o){switch(t){case _n.Operation:case _n.RemoteHelp:break;case _n.Summarize:{let a=r;a.details===void 0&&(a.details={}),a.details.includesProtocolTree=this.options.summarizeProtocolTree===!0;break}default:return this.close(new xn("invalidContainerSubmitOpType",void 0,{messageType:t})),-1}return this.submitMessage(t,r,i,o)}submitMessage(t,r,i,o){var s;return this.connectionState!==Re.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:t}),-1):(this.messageCountAfterDisconnection+=1,(s=this.collabWindowTracker)===null||s===void 0||s.stopSequenceNumberUpdate(),this._deltaManager.submit(t,r,i,o))}processRemoteMessage(t){let r=this.clientId===t.clientId,i={immediateNoOp:!1};try{i=this.protocolHandler.processMessage(t,r)}catch(o){this.close(wi(o,s=>new Jt(s,fr(t))))}return yo(t)&&!Ri(t)&&this.mc.logger.sendTelemetryEvent({eventName:"UnpackedRuntimeMessage",type:t.type}),(Ri(t)||yo(t))&&this.context.process(t,r,void 0),this.activeConnection()&&(this.collabWindowTracker===void 0&&(w(this.serviceConfiguration!==void 0,740),this.collabWindowTracker=new np((o,s)=>{w(this.activeConnection(),577),this.submitMessage(o,s)},this.serviceConfiguration.noopTimeFrequency,this.serviceConfiguration.noopCountFrequency)),this.collabWindowTracker.scheduleSequenceNumberUpdate(t,i.immediateNoOp===!0)),this.emit("op",t),i}submitSignal(t){this._deltaManager.submitSignal(JSON.stringify(t))}processSignal(t){if(t.clientId===null){let r=t.content;if(r.type===_n.ClientJoin){let i=r.content;this._audience.addMember(i.clientId,i.client)}else if(r.type===_n.ClientLeave){let i=r.content;this._audience.removeMember(i)}}else{let r=this.clientId===t.clientId;this.context.processSignal(t,r)}}fetchSnapshotTree(t){return v(this,null,function*(){var r;let i=yield this.getVersion(t??null);i===void 0&&t!==void 0&&this.mc.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:t}),this._loadedFromVersion=i;let o=(r=yield this.storageService.getSnapshotTree(i))!==null&&r!==void 0?r:void 0;return o===void 0&&i!==void 0&&this.mc.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:i.id}),{snapshot:o,versionId:i?.id}})}instantiateContextDetached(t,r){return v(this,null,function*(){let i=this.getCodeDetailsFromQuorum();if(i===void 0)throw new Error("pkg should be provided in create flow!!");yield this.instantiateContext(t,i,r)})}instantiateContext(t,r,i,o){return v(this,null,function*(){var s;w(((s=this._context)===null||s===void 0?void 0:s.disposed)!==!1,221);let a=new nl(this,this.loader);this._context=yield Hh.createOrLoad(this,this.scope,this.codeLoader,r,i,new Wh(this._deltaManager),new tp(this.protocolHandler.quorum),a,(c,l,h,u)=>this.submitContainerMessage(c,l,h,u),c=>this.submitSignal(c),c=>this.close(c),n.version,c=>this.updateDirtyContainerState(c),t,o),this.emit("contextChanged",r)})}updateDirtyContainerState(t){this._dirtyContainer!==t&&(this._dirtyContainer=t,this.emit(t?Z4:O0))}logContainerError(t){this.mc.logger.sendErrorEvent({eventName:"ContainerWarning"},t)}}return n.version="^0.1.0",n})();var ol=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(ol||{});Y();Pe();var VH=2e3,ip=class{constructor(e,t,r,i){this.tenantId=e,this.id=t,this.deltaStorageService=r,this.documentStorageService=i,this.logtailSha=this.documentStorageService.logTailSha}fetchMessages(e,t,r,i,o){return i?tE:eE(this.getCore.bind(this),1,e,t,VH,new Ga,r,o)}getCore(e,t){return v(this,null,function*(){let r=this.logtailSha?yield et(this.documentStorageService,this.logtailSha):[];if(this.logtailSha=void 0,r.length>0){let i=r.filter(o=>o.sequenceNumber>=e);if(i.length>0)return{messages:i,partialResult:!0}}return this.deltaStorageService.get(this.tenantId,this.id,e,t)})}},op=class{constructor(e,t,r,i=()=>v(this,null,function*(){return this.restWrapper}),o=()=>this.url){this.url=e,this.restWrapper=t,this.logger=r,this.getRestWrapper=i,this.getDeltaStorageUrl=o}get(e,t,r,i){return v(this,null,function*(){return{messages:yield le.timedExecAsync(this.logger,{eventName:"getDeltas",from:r,to:i},s=>v(this,null,function*(){let a=yield this.getRestWrapper(),c=this.getDeltaStorageUrl(),l=yield a.get(c,{from:r-1,to:i});return s.end({count:l.length}),l})),partialResult:!1}})}};Y();var $i=class extends Error{constructor(e,t,r,i,o){super(t),this.code=e,this.canRetry=r,this.isFatal=i,this.retryAfterMs=o,this.name="NetworkError",this.retryAfter=o!==void 0?o/1e3:void 0}get details(){return this.canRetry===void 0&&this.isFatal===void 0&&this.retryAfterMs===void 0?this.message:{message:this.message,canRetry:this.canRetry,isFatal:this.isFatal,retryAfter:this.retryAfter,retryAfterMs:this.retryAfterMs}}toJSON(){return{code:this.code,message:this.message,canRetry:this.canRetry,isFatal:this.isFatal,retryAfterMs:this.retryAfterMs,retryAfter:this.retryAfter}}};function xp(n,e){var t;let r,i,o,s;switch(e&&typeof e=="object"?(r=(t=e.message)!==null&&t!==void 0?t:"Unknown Error",i=e.canRetry,o=e.isFatal,s=e.retryAfter):e&&typeof e=="string"?r=e:r="Unknown Error",n){case 401:case 403:case 404:return new $i(n,r,!1,!1);case 413:case 422:return new $i(n,r,i??!1,o??!1,i?s:void 0);case 429:return new $i(n,r,!0,!1,s);case 500:return new $i(n,r,i??!0,o??!1,i?s:void 0);case 502:case 503:case 504:return new $i(n,r,!0,!1,s);default:return new $i(n,r,!1,!0)}}var _p="x-correlation-id";Y();Hr();var H0=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(H0||{}),To=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(To||{});var Hn=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Hn||{});var Ak=Ce(Gg());var Sk="@fluidframework/server-services-client",Ek="0.1036.5002";var ti=(0,Ak.debug)("fluid:services-client");ti(`Package: ${Sk} - Version: ${Ek}`);var ul=class{constructor(e){this.historian=e,this.blobCache=new Map,this.commitCache=new Map,this.treeCache=new Map,this.refCache=new Map}getHeader(e,t){return v(this,null,function*(){let r=yield this.historian.getHeader(t);for(let i of r.blobs)this.blobCache.set(i.sha,i);return vs(r.tree)})}getFullTree(e){return v(this,null,function*(){return this.historian.getFullTree(e)})}getCommit(e){return v(this,null,function*(){return this.commitCache.has(e)?(ti(`Cache hit on ${e}`),this.commitCache.get(e)):this.historian.getCommit(e)})}getCommits(e,t){return v(this,null,function*(){let r=e;if(this.refCache.has(e)&&(ti(`Commit cache hit on ${e}`),r=this.refCache.get(e),this.refCache.delete(e),!r))return[];if(this.commitCache.has(r)){let i=this.commitCache.get(r);return[{commit:{author:i.author,committer:i.committer,message:i.message,tree:i.tree,url:i.url},parents:i.parents,sha:i.sha,url:i.url}]}return this.historian.getCommits(r,t)})}getTree(e,t=!0){return v(this,null,function*(){return this.treeCache.has(e)?(ti(`Tree cache hit on ${e}`),this.treeCache.get(e)):this.historian.getTree(e,t)})}getBlob(e){return v(this,null,function*(){return this.blobCache.has(e)?(ti(`Blob cache hit on ${e}`),this.blobCache.get(e)):this.historian.getBlob(e)})}getRawUrl(e){return`${this.historian.endpoint}/git/blobs/raw/${e}`}getContent(e,t){return v(this,null,function*(){return this.historian.getContent(t,e)})}createBlob(e,t){return v(this,null,function*(){let r={content:e,encoding:t};return this.historian.createBlob(r)})}createGitTree(e){return v(this,null,function*(){return this.historian.createTree(e)})}createTree(e){return v(this,null,function*(){return this.createTreeCore(e,0)})}createCommit(e){return v(this,null,function*(){return this.historian.createCommit(e)})}createSummary(e){return v(this,null,function*(){return this.historian.createSummary(e)})}deleteSummary(e){return v(this,null,function*(){return this.historian.deleteSummary(e)})}getSummary(e){return v(this,null,function*(){return this.historian.getSummary(e)})}getRef(e){return v(this,null,function*(){return this.historian.getRef(`heads/${e}`).catch(t=>{if(t===400||t===404)return null;throw t})})}createRef(e,t){return v(this,null,function*(){let r={ref:`refs/heads/${e}`,sha:t,config:{enabled:!0}};return this.historian.createRef(r)})}upsertRef(e,t){return v(this,null,function*(){let r={force:!0,sha:t,config:{enabled:!0}};return this.historian.updateRef(`heads/${e}`,r)})}addRef(e,t){this.refCache.set(e,t)}addCommit(e){this.commitCache.set(e.sha,e)}addTree(e){this.treeCache.set(e.sha,e)}addBlob(e){this.blobCache.set(e.sha,e)}write(e,t,r,i){return v(this,null,function*(){let o=yield this.createTree(t),s={author:{date:new Date().toISOString(),email:"kurtb@microsoft.com",name:"Kurt Berglund"},message:i,parents:r,tree:o.sha},a=yield this.historian.createCommit(s);return(yield this.getRef(e))?yield this.upsertRef(e,a.sha):yield this.createRef(e,a.sha),a})}createTreeCore(e,t){return v(this,null,function*(){if(e.id)return this.getTree(e.id);let r=[];for(let c of e.entries)switch(To[c.type]){case To.Blob:{let l=c.value;c.mode===H0.Symlink&&(l.contents=this.translateSymlink(l.contents,t));let h=this.createBlob(l.contents,l.encoding);r.push(h);break}case To.Tree:{let l=c.value,h=this.createTreeCore(l,t+1);r.push(h);break}default:throw new Error("Unknown entry type")}let i=yield Promise.all(r),o=[];w(i.length===e.entries.length,"File entries length is not correct");for(let c=0;c<e.entries.length;c++){let l=e.entries[c].type===To.Tree?"tree":e.entries[c].type===To.Blob?"blob":"commit";o.push({mode:e.entries[c].mode,path:e.entries[c].path,sha:i[c].sha,type:l})}let s={tree:o};return this.historian.createTree(s)})}translateSymlink(e,t){let r="";for(let i=0;i<=t;i++)r+="../";return`${r}${e}`}};Y();var Nk=Ce(zk()),Bk=Ce(G0()),Lk=Ce(X2());qt();var fl=class{constructor(e,t={},r=1e3*1024*1024,i=1e3*1024*1024){this.baseurl=e,this.defaultQueryString=t,this.maxBodyLength=r,this.maxContentLength=i}get(e,t,r){return v(this,null,function*(){let i={baseURL:this.baseurl,headers:r,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"GET",url:`${e}${this.generateQueryString(t)}`};return this.request(i,200)})}post(e,t,r,i){return v(this,null,function*(){let o={baseURL:this.baseurl,data:t,headers:i,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"POST",url:`${e}${this.generateQueryString(r)}`};return this.request(o,201)})}delete(e,t,r){return v(this,null,function*(){let i={baseURL:this.baseurl,headers:r,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"DELETE",url:`${e}${this.generateQueryString(t)}`};return this.request(i,204)})}patch(e,t,r,i){return v(this,null,function*(){let o={baseURL:this.baseurl,data:t,headers:i,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"PATCH",url:`${e}${this.generateQueryString(r)}`};return this.request(o,200)})}generateQueryString(e){if(this.defaultQueryString||e){let t=Object.assign(Object.assign({},this.defaultQueryString),e),r=Nk.stringify(t);if(r!=="")return`?${r}`}return""}},yp=class extends fl{constructor(e,t={},r=1e3*1024*1024,i=1e3*1024*1024,o={},s=Lk.default,a,c,l){super(e,t,r,i),this.defaultHeaders=o,this.axios=s,this.refreshDefaultQueryString=a,this.refreshDefaultHeaders=c,this.getCorrelationId=l}request(e,t,r=!0){return v(this,null,function*(){var i,o;let s=Object.assign({},e);return s.headers=this.generateHeaders(s.headers,(o=(i=this.getCorrelationId)===null||i===void 0?void 0:i.call(this))!==null&&o!==void 0?o:ke()),new Promise((a,c)=>{this.axios.request(s).then(l=>{a(l.data)}).catch(l=>{var h,u,d,p,m,g,x,b,_,O,S,E,D,I;if(((h=l?.response)===null||h===void 0?void 0:h.status)===t&&a((u=l?.response)===null||u===void 0?void 0:u.data),l?.config?ti(`[${l.config.method}] request to [${(d=l.config.baseURL)!==null&&d!==void 0?d:""}${(p=l.config.url)!==null&&p!==void 0?p:""}] failed with [${(m=l.response)===null||m===void 0?void 0:m.status}] [${(0,Bk.default)((g=l.response)===null||g===void 0?void 0:g.data,void 0,2)}]`):ti(`request to ${s.url} failed ${l?l.message:""}`),((x=l?.response)===null||x===void 0?void 0:x.status)===429&&((_=(b=l?.response)===null||b===void 0?void 0:b.data)===null||_===void 0?void 0:_.retryAfter)>0&&r)setTimeout(()=>{this.request(s,t).then(a).catch(c)},l.response.data.retryAfter*1e3);else if(((O=l?.response)===null||O===void 0?void 0:O.status)===401&&r&&this.refreshOnAuthError()){let y=Object.assign({},e);y.headers=this.generateHeaders(y.headers,s.headers[_p]),this.request(y,t,!1).then(a).catch(c)}else if(l?.response)c(xp((S=l?.response)===null||S===void 0?void 0:S.status,(E=l?.response)===null||E===void 0?void 0:E.data));else if(l?.request)c(xp(502,`Network Error: ${(D=l?.message)!==null&&D!==void 0?D:"undefined"}`));else{let y={canRetry:!1,isFatal:!1,message:(I=l?.message)!==null&&I!==void 0?I:"Unknown Error"};c(xp(500,y))}})})})}generateHeaders(e,t){let r=e??{};return this.defaultHeaders&&(r=Object.assign(Object.assign({},this.defaultHeaders),e)),r[_p]?r:Object.assign({[_p]:t},r)}refreshOnAuthError(){return this.refreshDefaultQueryString===void 0&&this.refreshDefaultHeaders===void 0?!1:(this.refreshDefaultHeaders!==void 0&&(this.defaultHeaders=this.refreshDefaultHeaders()),this.refreshDefaultQueryString!==void 0&&(this.defaultQueryString=this.refreshDefaultQueryString()),!0)}};function NW(n,e){for(let t of e)if(n.endsWith(t))return!0;return!1}var qk=n=>`Basic ${Ha(`${n.user}:${n.password}`)}`,gl=class{constructor(e,t,r,i){this.endpoint=e,this.historianApi=t,this.restWrapper=i,this.defaultQueryString={},r&&this.historianApi?(this.defaultQueryString.disableCache=r,this.cacheBust=!1):this.cacheBust=r,this.restWrapper===void 0&&(this.restWrapper=new yp(this.endpoint))}getHeader(e){return v(this,null,function*(){return this.historianApi?this.restWrapper.get(`/headers/${encodeURIComponent(e)}`,this.getQueryString()):this.getHeaderDirect(e)})}getFullTree(e){return v(this,null,function*(){return this.restWrapper.get(`/tree/${encodeURIComponent(e)}`,this.getQueryString())})}getBlob(e){return v(this,null,function*(){return this.restWrapper.get(`/git/blobs/${encodeURIComponent(e)}`,this.getQueryString())})}createBlob(e){return v(this,null,function*(){return this.restWrapper.post("/git/blobs",e,this.getQueryString())})}getContent(e,t){return v(this,null,function*(){return this.restWrapper.get(`/contents/${e}`,this.getQueryString({ref:t}))})}getCommits(e,t){return v(this,null,function*(){return this.restWrapper.get("/commits",this.getQueryString({count:t,sha:e})).catch(r=>r===400||r===404?[]:Promise.reject(r))})}getCommit(e){return v(this,null,function*(){return this.restWrapper.get(`/git/commits/${encodeURIComponent(e)}`,this.getQueryString())})}createCommit(e){return v(this,null,function*(){return this.restWrapper.post("/git/commits",e,this.getQueryString())})}getRefs(){return v(this,null,function*(){return this.restWrapper.get("/git/refs",this.getQueryString())})}getRef(e){return v(this,null,function*(){return this.restWrapper.get(`/git/refs/${e}`,this.getQueryString())})}createRef(e){return v(this,null,function*(){return this.restWrapper.post("/git/refs",e,this.getQueryString())})}updateRef(e,t){return v(this,null,function*(){return this.restWrapper.patch(`/git/refs/${e}`,t,this.getQueryString())})}deleteRef(e){return v(this,null,function*(){yield this.restWrapper.delete(`/git/refs/${e}`,this.getQueryString())})}createTag(e){return v(this,null,function*(){return this.restWrapper.post("/git/tags",e,this.getQueryString())})}getTag(e){return v(this,null,function*(){return this.restWrapper.get(`/git/tags/${e}`,this.getQueryString())})}createTree(e){return v(this,null,function*(){return this.restWrapper.post("/git/trees",e,this.getQueryString())})}getTree(e,t){return v(this,null,function*(){return this.restWrapper.get(`/git/trees/${encodeURIComponent(e)}`,this.getQueryString({recursive:t?1:0}))})}createSummary(e){return v(this,null,function*(){return this.restWrapper.post("/git/summaries",e,this.getQueryString())})}deleteSummary(e){return v(this,null,function*(){let t={"Soft-Delete":e};return this.restWrapper.delete("/git/summaries",this.getQueryString(),t)})}getSummary(e){return v(this,null,function*(){return this.restWrapper.get(`/git/summaries/${e}`,this.getQueryString())})}getHeaderDirect(e){return v(this,null,function*(){let t=yield this.getTree(e,!0),r=[".attributes",".blobs",".messages","header"],i=[];for(let s of t.tree)if(s.type==="blob"&&NW(s.path,r)){let a=this.getBlob(s.sha);i.push(a)}return{blobs:yield Promise.all(i),tree:t}})}getQueryString(e){return this.cacheBust?Object.assign(Object.assign({cacheBust:Date.now()},this.defaultQueryString),e):Object.assign(Object.assign({},this.defaultQueryString),e)}};var Cp=function(n){return n.Method="method",n.Header="header",n.Body="body",n}(Cp||{}),BW=(n,e)=>`${n}: ${e}`,wp=class{translate(e){var t,r;let i=Object.assign({},e),o=new URLSearchParams;if(o.append(Cp.Method,(t=i.method)!==null&&t!==void 0?t:"GET"),i.headers)for(let[s,a]of Object.entries(i.headers)){let c=BW(s,a);o.append(Cp.Header,c)}if(i.data&&["post","put","patch"].includes((r=i.method)===null||r===void 0?void 0:r.toLowerCase())){let s=JSON.stringify(i.data);o.append(Cp.Body,s)}return i.data=o.toString(),i.method="POST",i.headers={"Content-Type":"application/x-www-form-urlencoded;restless"},i}};Y();Hr();var W0=(...n)=>n.map(e=>e.replace(/^\//,"").replace(/\/$/,"")).filter(e=>!!e).join("/");function K0(n,e,t="",r=""){let i={type:"tree",entries:[]},o=Object.keys(e.tree);for(let s of o){let a=e.tree[s],c,l,h,u=W0(t===""?r:t,s);switch(a.type){case Hn.Tree:{l=K0(n,a,u,r),h=a.unreferenced||void 0;break}case Hn.Blob:{typeof a.content=="string"?l={type:"blob",content:a.content,encoding:"utf-8"}:l={type:"blob",content:Pn(a.content,"base64"),encoding:"base64"};break}case Hn.Handle:{if(a.embedded)c=a.handle;else{if(!n)throw Error("Parent summary does not exist to reference by handle.");c=W0(n,r,a.handle)}break}case Hn.Attachment:{c=a.id;break}default:vt(a,`Unknown type: ${a.type}`)}let d={path:encodeURIComponent(s),type:Jd(a)},p;if(l)w(c===void 0,173),p=Object.assign({value:l,unreferenced:h},d);else if(c)p=Object.assign(Object.assign({},d),{id:c});else throw new Error(`Invalid tree entry for ${a.type}`);i.entries.push(p)}return i}function LW(n,e){let t={},r={id:n.id,blobs:{},trees:{}};t[""]=r;for(let i of n.entries){let o=i.path.replace(new RegExp(`^${e}/`),""),s=o.lastIndexOf("/"),a=o.slice(0,Math.max(0,s)),c=o.slice(s+1),l=t[a];if(i.type==="tree"){let h={blobs:{},trees:{},unreferenced:i.unreferenced};l.trees[decodeURIComponent(c)]=h,t[o]=h}else if(i.type==="blob")l.blobs[decodeURIComponent(c)]=i.id;else throw new Error("Unknown entry type!!")}return r}function $0(n,e=".app"){var t;let r=new Map;n.blobs&&n.blobs.forEach(a=>{var c;r.set(a.id,Bn(a.content,(c=a.encoding)!==null&&c!==void 0?c:"utf-8"))});let i=(t=n.trees)===null||t===void 0?void 0:t[0],o=i?.sequenceNumber,s=LW(i,e);return{blobs:r,snapshotTree:s,sequenceNumber:o}}Y();Hr();var Pp=class{constructor(e,t,r){this.manager=e,this.blobsShaCache=t,this.getPreviousFullSnapshot=r}writeSummaryTree(e,t,r,i){return v(this,null,function*(){let o=yield this.getPreviousFullSnapshot(t);return this.writeSummaryTreeCore(e,o??void 0)})}writeSummaryTreeCore(e,t){return v(this,null,function*(){let r=yield Promise.all(Object.keys(e.tree).map(o=>v(this,null,function*(){let s=e.tree[o],a=yield this.writeSummaryTreeObject(s,t);return{mode:wO(s),path:encodeURIComponent(o),sha:a,type:Jd(s)}})));return(yield this.manager.createGitTree({tree:r})).sha})}writeSummaryTreeObject(e,t){return v(this,null,function*(){switch(e.type){case Hn.Blob:return this.writeSummaryBlob(e.content);case Hn.Handle:{if(t===void 0)throw Error("Parent summary does not exist to reference by handle.");return this.getIdFromPath(e.handleType,e.handle,t)}case Hn.Tree:return this.writeSummaryTreeCore(e,t);case Hn.Attachment:return e.id;default:vt(e,`Unknown type: ${e.type}`)}})}writeSummaryBlob(e){return v(this,null,function*(){let{parsedContent:t,encoding:r}=typeof e=="string"?{parsedContent:e,encoding:"utf-8"}:{parsedContent:Pn(e,"base64"),encoding:"base64"},i=yield ig(Kt.from(t,r));if(!this.blobsShaCache.has(i)){this.blobsShaCache.set(i,"");let o=yield this.manager.createBlob(t,r);w(i===o.sha,182)}return i})}getIdFromPath(e,t,r){let i=t.split("/").map(o=>decodeURIComponent(o));return i[0]===""&&i.shift(),i.length===0?r.id:this.getIdFromPathCore(e,i,r)}getIdFromPathCore(e,t,r){var i;w(t.length>0,179);let o=t[0];if(t.length===1)switch(e){case Hn.Blob:{let s=r.blobs[o];return w(!!s,180),s}case Hn.Tree:{let s=(i=r.trees[o])===null||i===void 0?void 0:i.id;return w(!!s,181),s}default:throw Error(`Unexpected handle summary object type: "${e}".`)}return this.getIdFromPathCore(e,t.slice(1),r.trees[o])}};var Op=class{constructor(e){this.manager=e}writeSummaryTree(e,t,r,i){return v(this,null,function*(){let o=yield this.writeSummaryTreeCore(t,e,r,i??0);if(!o)throw new Error("Failed to write summary tree");return o})}writeSummaryTreeCore(e,t,r,i){return v(this,null,function*(){let s={entries:K0(e,t,"",r==="channel"?".app":"").entries,message:void 0,sequenceNumber:i,type:r};return this.manager.createSummary(s).then(a=>a.id)})}};var br=Object.create(null);br.open="0";br.close="1";br.ping="2";br.pong="3";br.message="4";br.upgrade="5";br.noop="6";var ml=Object.create(null);Object.keys(br).forEach(n=>{ml[br[n]]=n});var vl={type:"error",data:"parser error"};var Hk=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Uk=typeof ArrayBuffer=="function",Gk=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,bl=({type:n,data:e},t,r)=>Hk&&e instanceof Blob?t?r(e):jk(e,r):Uk&&(e instanceof ArrayBuffer||Gk(e))?t?r(e):jk(new Blob([e]),r):r(br[n]+(e||"")),jk=(n,e)=>{let t=new FileReader;return t.onload=function(){let r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)};function Vk(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}var X0;function Wk(n,e){if(Hk&&n.data instanceof Blob)return n.data.arrayBuffer().then(Vk).then(e);if(Uk&&(n.data instanceof ArrayBuffer||Gk(n.data)))return e(Vk(n.data));bl(n,!1,t=>{X0||(X0=new TextEncoder),e(X0.encode(t))})}var Kk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xl=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Kk.length;n++)xl[Kk.charCodeAt(n)]=n;var $k=n=>{let e=n.length*.75,t=n.length,r,i=0,o,s,a,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);let l=new ArrayBuffer(e),h=new Uint8Array(l);for(r=0;r<t;r+=4)o=xl[n.charCodeAt(r)],s=xl[n.charCodeAt(r+1)],a=xl[n.charCodeAt(r+2)],c=xl[n.charCodeAt(r+3)],h[i++]=o<<2|s>>4,h[i++]=(s&15)<<4|a>>2,h[i++]=(a&3)<<6|c&63;return l};var qW=typeof ArrayBuffer=="function",_l=(n,e)=>{if(typeof n!="string")return{type:"message",data:Xk(n,e)};let t=n.charAt(0);return t==="b"?{type:"message",data:jW(n.substring(1),e)}:ml[t]?n.length>1?{type:ml[t],data:n.substring(1)}:{type:ml[t]}:vl},jW=(n,e)=>{if(qW){let t=$k(n);return Xk(t,e)}else return{base64:!0,data:n}},Xk=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}};var Jk="",Qk=(n,e)=>{let t=n.length,r=new Array(t),i=0;n.forEach((o,s)=>{bl(o,!1,a=>{r[s]=a,++i===t&&e(r.join(Jk))})})},Yk=(n,e)=>{let t=n.split(Jk),r=[];for(let i=0;i<t.length;i++){let o=_l(t[i],e);if(r.push(o),o.type==="error")break}return r};function Zk(){return new TransformStream({transform(n,e){Wk(n,t=>{let r=t.length,i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);let o=new DataView(i.buffer);o.setUint8(0,126),o.setUint16(1,r)}else{i=new Uint8Array(9);let o=new DataView(i.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(r))}n.data&&typeof n.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}var J0;function Mp(n){return n.reduce((e,t)=>e+t.length,0)}function Sp(n,e){if(n[0].length===e)return n.shift();let t=new Uint8Array(e),r=0;for(let i=0;i<e;i++)t[i]=n[0][r++],r===n[0].length&&(n.shift(),r=0);return n.length&&r<n[0].length&&(n[0]=n[0].slice(r)),t}function e3(n,e){J0||(J0=new TextDecoder);let t=[],r=0,i=-1,o=!1;return new TransformStream({transform(s,a){for(t.push(s);;){if(r===0){if(Mp(t)<1)break;let c=Sp(t,1);o=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(Mp(t)<2)break;let c=Sp(t,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Mp(t)<8)break;let c=Sp(t,8),l=new DataView(c.buffer,c.byteOffset,c.length),h=l.getUint32(0);if(h>Math.pow(2,21)-1){a.enqueue(vl);break}i=h*Math.pow(2,32)+l.getUint32(4),r=3}else{if(Mp(t)<i)break;let c=Sp(t,i);a.enqueue(_l(o?c:J0.decode(c),e)),r=0}if(i===0||i>n){a.enqueue(vl);break}}}})}var Q0=4;function ut(n){if(n)return VW(n)}function VW(n){for(var e in ut.prototype)n[e]=ut.prototype[e];return n}ut.prototype.on=ut.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};ut.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};ut.prototype.off=ut.prototype.removeListener=ut.prototype.removeAllListeners=ut.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};ut.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};ut.prototype.emitReserved=ut.prototype.emit;ut.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};ut.prototype.hasListeners=function(n){return!!this.listeners(n).length};var un=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Ep(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}var HW=un.setTimeout,UW=un.clearTimeout;function ni(n,e){e.useNativeTimers?(n.setTimeoutFn=HW.bind(un),n.clearTimeoutFn=UW.bind(un)):(n.setTimeoutFn=un.setTimeout.bind(un),n.clearTimeoutFn=un.clearTimeout.bind(un))}var GW=1.33;function t3(n){return typeof n=="string"?WW(n):Math.ceil((n.byteLength||n.size)*GW)}function WW(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function n3(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function r3(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let o=t[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}var Ap=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},ri=class extends ut{constructor(e){super(),this.writable=!1,ni(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new Ap(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=_l(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=n3(e);return t.length?"?"+t:""}};var a3="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Y0=64,KW={},i3=0,kp=0,o3;function s3(n){let e="";do e=a3[n%Y0]+e,n=Math.floor(n/Y0);while(n>0);return e}function Tp(){let n=s3(+new Date);return n!==o3?(i3=0,o3=n):n+"."+s3(i3++)}for(;kp<Y0;kp++)KW[a3[kp]]=kp;var c3=!1;try{c3=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var l3=c3;function Z0(n){let e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||l3))return new XMLHttpRequest}catch{}if(!e)try{return new un[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function $W(){}var XW=function(){return new Z0({xdomain:!1}).responseType!=null}(),Fp=class extends ri{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let r=location.protocol==="https:",i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}let t=e&&e.forceBase64;this.supportsBinary=XW&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Yk(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Qk(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Tp()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Dp(this.uri(),e)}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,o)=>{this.onError("xhr post error",i,o)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}},Dp=(()=>{class n extends ut{constructor(t,r){super(),ni(this,r),this.opts=r,this.method=r.method||"GET",this.uri=t,this.data=r.data!==void 0?r.data:null,this.create()}create(){var t;let r=Ep(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;let i=this.xhr=new Z0(r);try{i.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.opts.extraHeaders[o])}}catch{}if(this.method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this.opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{var o;i.readyState===3&&((o=this.opts.cookieJar)===null||o===void 0||o.parseCookies(i)),i.readyState===4&&(i.status===200||i.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof i.status=="number"?i.status:0)},0))},i.send(this.data)}catch(o){this.setTimeoutFn(()=>{this.onError(o)},0);return}typeof document<"u"&&(this.index=n.requestsCount++,n.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=$W,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete n.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return n.requestsCount=0,n.requests={},n})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",d3);else if(typeof addEventListener=="function"){let n="onpagehide"in un?"pagehide":"unload";addEventListener(n,d3,!1)}}function d3(){for(let n in Dp.requests)Dp.requests.hasOwnProperty(n)&&Dp.requests[n].abort()}var Do=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),yl=un.WebSocket||un.MozWebSocket,zp=!0,u3="arraybuffer";var h3=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Ip=class extends ri{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,r=h3?{}:Ep(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=zp&&!h3?t?new yl(e,t):new yl(e):new yl(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;bl(r,this.supportsBinary,o=>{let s={};zp||(r.options&&(s.compress=r.options.compress),this.opts.perMessageDeflate&&(typeof o=="string"?Buffer.byteLength(o):o.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{zp?this.ws.send(o):this.ws.send(o,s)}catch{}i&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Tp()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!yl}};var Rp=class extends ri{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t=e3(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),i=Zk();i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();let o=()=>{r.read().then(({done:a,value:c})=>{a||(this.onPacket(c),o())}).catch(a=>{})};o();let s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this.writer.write(s).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;this.writer.write(r).then(()=>{i&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}};var eb={websocket:Ip,webtransport:Rp,polling:Fp};var JW=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,QW=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function la(n){if(n.length>2e3)throw"URI too long";let e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=JW.exec(n||""),o={},s=14;for(;s--;)o[QW[s]]=i[s]||"";return t!=-1&&r!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=YW(o,o.path),o.queryKey=ZW(o,o.query),o}function YW(n,e){let t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function ZW(n,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,o){i&&(t[i]=o)}),t}var Np=(()=>{class n extends ut{constructor(t,r={}){super(),this.binaryType=u3,this.writeBuffer=[],t&&typeof t=="object"&&(r=t,t=null),t?(t=la(t),r.hostname=t.host,r.secure=t.protocol==="https"||t.protocol==="wss",r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=la(r.host).host),ni(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=r3(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let r=Object.assign({},this.opts.query);r.EIO=Q0,r.transport=t,this.id&&(r.sid=this.id);let i=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new eb[t](i)}open(){let t;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(t){let r=this.createTransport(t),i=!1;n.priorWebsocketSuccess=!1;let o=()=>{i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{let p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function s(){i||(i=!0,u(),r.close(),r=null)}let a=d=>{let p=new Error("probe error: "+d);p.transport=r.name,s(),this.emitReserved("upgradeError",p)};function c(){a("transport closed")}function l(){a("socket closed")}function h(d){r&&d.name!==r.name&&s()}let u=()=>{r.removeListener("open",o),r.removeListener("error",a),r.removeListener("close",c),this.off("close",l),this.off("upgrading",h)};r.once("open",o),r.once("error",a),r.once("close",c),this.once("close",l),this.once("upgrading",h),this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||r.open()},200):r.open()}onOpen(){if(this.readyState="open",n.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let t=0,r=this.upgrades.length;for(;t<r;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=t.data,this.onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let i=0;i<this.writeBuffer.length;i++){let o=this.writeBuffer[i].data;if(o&&(r+=t3(o)),i>0&&r>this.maxPayload)return this.writeBuffer.slice(0,i);r+=2}return this.writeBuffer}write(t,r,i){return this.sendPacket("message",t,r,i),this}send(t,r,i){return this.sendPacket("message",t,r,i),this}sendPacket(t,r,i,o){if(typeof r=="function"&&(o=r,r=void 0),typeof i=="function"&&(o=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:t,data:r,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),o&&this.once("flush",o),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(t){n.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let r=[],i=0,o=t.length;for(;i<o;i++)~this.transports.indexOf(t[i])&&r.push(t[i]);return r}}return n.protocol=Q0,n})();var v0e=Np.protocol;function p3(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=la(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let o=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(t&&t.port===r.port?"":":"+r.port),r}var sb={};Yi(sb,{Decoder:()=>ib,Encoder:()=>rb,PacketType:()=>Fe,protocol:()=>b3});var eK=typeof ArrayBuffer=="function",tK=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,f3=Object.prototype.toString,nK=typeof Blob=="function"||typeof Blob<"u"&&f3.call(Blob)==="[object BlobConstructor]",rK=typeof File=="function"||typeof File<"u"&&f3.call(File)==="[object FileConstructor]";function wl(n){return eK&&(n instanceof ArrayBuffer||tK(n))||nK&&n instanceof Blob||rK&&n instanceof File}function Cl(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(Cl(n[t]))return!0;return!1}if(wl(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Cl(n.toJSON(),!0);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&Cl(n[t]))return!0;return!1}function g3(n){let e=[],t=n.data,r=n;return r.data=tb(t,e),r.attachments=e.length,{packet:r,buffers:e}}function tb(n,e){if(!n)return n;if(wl(n)){let t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){let t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=tb(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){let t={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=tb(n[r],e));return t}return n}function m3(n,e){return n.data=nb(n.data,e),delete n.attachments,n}function nb(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=nb(n[t],e);else if(typeof n=="object")for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=nb(n[t],e));return n}var iK=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],b3=5,Fe=function(n){return n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK",n}(Fe||{}),rb=class{constructor(e){this.replacer=e}encode(e){return(e.type===Fe.EVENT||e.type===Fe.ACK)&&Cl(e)?this.encodeAsBinary({type:e.type===Fe.EVENT?Fe.BINARY_EVENT:Fe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Fe.BINARY_EVENT||e.type===Fe.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=g3(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}};function v3(n){return Object.prototype.toString.call(n)==="[object Object]"}var ib=class n extends ut{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let r=t.type===Fe.BINARY_EVENT;r||t.type===Fe.BINARY_ACK?(t.type=r?Fe.EVENT:Fe.ACK,this.reconstructor=new ob(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(wl(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(Fe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Fe.BINARY_EVENT||r.type===Fe.BINARY_ACK){let o=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let s=e.substring(o,t);if(s!=Number(s)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(s)}if(e.charAt(t+1)==="/"){let o=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(o,t)}else r.nsp="/";let i=e.charAt(t+1);if(i!==""&&Number(i)==i){let o=t+1;for(;++t;){let s=e.charAt(t);if(s==null||Number(s)!=s){--t;break}if(t===e.length)break}r.id=Number(e.substring(o,t+1))}if(e.charAt(++t)){let o=this.tryParse(e.substr(t));if(n.isPayloadValid(r.type,o))r.data=o;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Fe.CONNECT:return v3(t);case Fe.DISCONNECT:return t===void 0;case Fe.CONNECT_ERROR:return typeof t=="string"||v3(t);case Fe.EVENT:case Fe.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&iK.indexOf(t[0])===-1);case Fe.ACK:case Fe.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},ob=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=m3(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Un(n,e,t){return n.on(e,t),function(){n.off(e,t)}}var oK=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),da=class extends ut{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Un(e,"open",this.onopen.bind(this)),Un(e,"packet",this.onpacket.bind(this)),Un(e,"error",this.onerror.bind(this)),Un(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(oK.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let r={type:Fe.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let s=this.ids++,a=t.pop();this._registerAckCallback(s,a),r.id=s}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;let i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},i),s=(...a)=>{this.io.clearTimeoutFn(o),t.apply(this,a)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...t){return new Promise((r,i)=>{let o=(s,a)=>s?i(s):r(a);o.withError=!0,t.push(o),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...o)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...o)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Fe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){let r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Fe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Fe.EVENT:case Fe.BINARY_EVENT:this.onevent(e);break;case Fe.ACK:case Fe.BINARY_ACK:this.onack(e);break;case Fe.DISCONNECT:this.ondisconnect();break;case Fe.CONNECT_ERROR:this.destroy();let r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...i){r||(r=!0,t.packet({type:Fe.ACK,id:e,data:i}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}};function Fo(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Fo.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Fo.prototype.reset=function(){this.attempts=0};Fo.prototype.setMin=function(n){this.ms=n};Fo.prototype.setMax=function(n){this.max=n};Fo.prototype.setJitter=function(n){this.jitter=n};var ua=class extends ut{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,ni(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Fo({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||sb;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Np(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let i=Un(t,"open",function(){r.onopen(),e&&e()}),o=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},s=Un(t,"error",o);if(this._timeout!==!1){let a=this._timeout,c=this.setTimeoutFn(()=>{i(),o(new Error("timeout")),t.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Un(e,"ping",this.onping.bind(this)),Un(e,"data",this.ondata.bind(this)),Un(e,"error",this.onerror.bind(this)),Un(e,"close",this.onclose.bind(this)),Un(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Do(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new da(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t)if(this.nsps[r].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var Pl={};function Ol(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};let t=p3(n,e.path||"/socket.io"),r=t.source,i=t.id,o=t.path,s=Pl[i]&&o in Pl[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||s,c;return a?c=new ua(r,e):(Pl[i]||(Pl[i]=new ua(r,e)),c=Pl[i]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(Ol,{Manager:ua,Socket:da,io:Ol,connect:Ol});Pe();Y();Pe();var xr=class{constructor(){this.cache=new Map}get(e){return v(this,null,function*(){return this.cache.get(e)})}put(e,t){return v(this,null,function*(){this.cache.set(e,t)})}};var x3="latest",Bp=class{constructor(e,t,r,i={},o,s=new xr,a=new xr,c,l=h=>v(this,null,function*(){return h&&this.noCacheGitManager!==void 0?this.noCacheGitManager:this.manager})){this.id=e,this.manager=t,this.logger=r,this.policies=i,this.driverPolicies=o,this.blobCache=s,this.snapshotTreeCache=a,this.noCacheGitManager=c,this.getStorageManager=l,this.firstVersionsCall=!0}get repositoryUrl(){return""}getSummaryUploadManager(){return v(this,null,function*(){let e=yield this.getStorageManager();return new Op(e)})}getVersions(e,t){return v(this,null,function*(){var r;if(e!==this.id&&e!==null)return[{id:e,treeId:void 0}];if(this.firstVersionsCall&&t===1){this.firstVersionsCall=!1;let{id:s,snapshotTree:a}=!((r=this.driverPolicies)===null||r===void 0)&&r.enableDiscovery?yield this.fetchAndCacheSnapshotTree(x3,!0):yield this.fetchAndCacheSnapshotTree(x3,!1);return[{id:s,treeId:a.id}]}let i=e||this.id;return(yield le.timedExecAsync(this.logger,{eventName:"getVersions",versionId:i,count:t},()=>v(this,null,function*(){return(yield this.getStorageManager()).getCommits(i,t)}))).map(s=>({date:s.commit.author.date,id:s.sha,treeId:s.commit.tree.sha}))})}getSnapshotTree(e){return v(this,null,function*(){let t=e;if(!t){let r=yield this.getVersions(this.id,1);if(r.length===0)return null;t=r[0]}return(yield this.fetchAndCacheSnapshotTree(t.id)).snapshotTree})}readBlob(e){return v(this,null,function*(){let t=yield this.blobCache.get(this.getCacheKey(e));if(t!==void 0)return t;let r=yield le.timedExecAsync(this.logger,{eventName:"readBlob",blobId:e},o=>v(this,null,function*(){let a=yield(yield this.getStorageManager()).getBlob(e);return o.end({size:a.size}),a})),i=Bn(r.content,r.encoding);return yield this.blobCache.put(this.getCacheKey(r.sha),i),i})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return yield le.timedExecAsync(this.logger,{eventName:"uploadSummaryWithContext"},()=>v(this,null,function*(){var i;return(yield this.getSummaryUploadManager()).writeSummaryTree(e,(i=t.ackHandle)!==null&&i!==void 0?i:"","channel")}))})}downloadSummary(e){return v(this,null,function*(){let t=yield le.timedExecAsync(this.logger,{eventName:"getWholeFlatSummary",treeId:e.handle},o=>v(this,null,function*(){var s;let c=yield(yield this.getStorageManager()).getSummary(e.handle);return o.end({size:(s=c.trees[0])===null||s===void 0?void 0:s.entries.length}),c})),{blobs:r,snapshotTree:i}=$0(t,"");return Ev(i,r)})}createBlob(e){return v(this,null,function*(){let t=new Uint8Array(e);return le.timedExecAsync(this.logger,{eventName:"createBlob",size:t.length},r=>v(this,null,function*(){let o=yield(yield this.getStorageManager()).createBlob(Pn(t,"base64"),"base64").then(s=>({id:s.sha,url:s.url}));return r.end({blobId:o.id}),o}))})}fetchAndCacheSnapshotTree(e,t){return v(this,null,function*(){let r=yield this.snapshotTreeCache.get(this.getCacheKey(e));if(r!==void 0)return{id:r.id,snapshotTree:r.snapshotTree};let i=yield le.timedExecAsync(this.logger,{eventName:"getWholeFlatSummary",treeId:e},h=>v(this,null,function*(){var u;let p=yield(yield this.getStorageManager(t)).getSummary(e);return h.end({size:(u=p.trees[0])===null||u===void 0?void 0:u.entries.length}),p})),o=$0(i),s=i.id,a=o.snapshotTree.id;w(a!==void 0,629);let c={id:s,snapshotTree:o.snapshotTree},l=[this.snapshotTreeCache.put(this.getCacheKey(a),c),this.initBlobCache(o.blobs)];return a!==e&&l.push(this.snapshotTreeCache.put(this.getCacheKey(e),c)),yield Promise.all(l),c})}initBlobCache(e){return v(this,null,function*(){let t=[];e.forEach((r,i)=>{let o=this.getCacheKey(i);t.push(this.blobCache.put(o,r))}),yield Promise.all(t)})}getCacheKey(e){return`${this.id}:${e}`}};Y();Hr();Pe();var Lp=class{constructor(e,t){this.internalGitManager=e,this.logger=t}getHeader(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getHeader(e,t)}),"gitManager_getHeader")})}getFullTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getFullTree(e)}),"gitManager_getFullTree")})}getCommit(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getCommit(e)}),"gitManager_getCommit")})}getCommits(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getCommits(e,t)}),"gitManager_getCommits")})}getTree(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getTree(e,t)}),"gitManager_getTree")})}getBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getBlob(e)}),"gitManager_getBlob")})}getRawUrl(e){return this.internalGitManager.getRawUrl(e)}getContent(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getContent(e,t)}),"gitManager_getContent")})}createBlob(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createBlob(e,t)}),"gitManager_createBlob")})}createGitTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createGitTree(e)}),"gitManager_createGitTree")})}createTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createTree(e)}),"gitManager_createTree")})}createCommit(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createCommit(e)}),"gitManager_createCommit")})}getRef(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getRef(e)}),"gitManager_getRef")})}createRef(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createRef(e,t)}),"gitManager_createRef")})}upsertRef(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.upsertRef(e,t)}),"gitManager_upsertRef")})}write(e,t,r,i){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.write(e,t,r,i)}),"gitManager_write")})}createSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createSummary(e)}),"gitManager_createSummary")})}deleteSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.deleteSummary(e)}),"gitManager_deleteSummary")})}getSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getSummary(e)}),"gitManager_getSummary")})}runWithRetry(e,t){return v(this,null,function*(){return Ns(e,t,this.logger,{})})}};var sK=typeof window>"u",qp=class{constructor(e,t,r,i={},o,s,a,c=()=>v(this,null,function*(){return this.manager})){this.id=e,this.manager=t,this.logger=r,this.policies=i,this.getStorageManager=c,this.blobsShaCache=new Map,(o?.enableRestLess===!0||sK)&&(this.blobCache=s??new xr,this.snapshotTreeCache=a??new xr)}get repositoryUrl(){return""}getSummaryUploadManager(){return v(this,null,function*(){let e=yield this.getStorageManager();return new Pp(new Lp(e,this.logger),this.blobsShaCache,this.getPreviousFullSnapshot.bind(this))})}getVersions(e,t){return v(this,null,function*(){let r=e||this.id;return(yield le.timedExecAsync(this.logger,{eventName:"getVersions",versionId:r,count:t},()=>v(this,null,function*(){return(yield this.getStorageManager()).getCommits(r,t)}))).map(o=>({date:o.commit.author.date,id:o.sha,treeId:o.commit.tree.sha}))})}getSnapshotTree(e){return v(this,null,function*(){var t,r;let i=e;if(!i){let c=yield this.getVersions(this.id,1);if(c.length===0)return null;i=c[0]}let o=yield(t=this.snapshotTreeCache)===null||t===void 0?void 0:t.get(this.getCacheKey(i.treeId));if(o)return o.snapshotTree;let s=yield le.timedExecAsync(this.logger,{eventName:"getSnapshotTree",treeId:i.treeId},c=>v(this,null,function*(){let h=yield(yield this.getStorageManager()).getTree(i.treeId);return c.end({size:h.tree.length}),h})),a=vs(s,this.blobsShaCache,!0);return yield(r=this.snapshotTreeCache)===null||r===void 0?void 0:r.put(this.getCacheKey(a.id),{id:i.id,snapshotTree:a}),a})}readBlob(e){return v(this,null,function*(){var t,r;let i=yield(t=this.blobCache)===null||t===void 0?void 0:t.get(this.getCacheKey(e));if(i)return i;let o=yield le.timedExecAsync(this.logger,{eventName:"readBlob",blobId:e},a=>v(this,null,function*(){let l=yield(yield this.getStorageManager()).getBlob(e);return a.end({size:l.size}),l}));this.blobsShaCache.set(o.sha,"");let s=Bn(o.content,o.encoding);return yield(r=this.blobCache)===null||r===void 0?void 0:r.put(this.getCacheKey(o.sha),s),s})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return yield le.timedExecAsync(this.logger,{eventName:"uploadSummaryWithContext"},()=>v(this,null,function*(){var i;return(yield this.getSummaryUploadManager()).writeSummaryTree(e,(i=t.ackHandle)!==null&&i!==void 0?i:"","channel")}))})}downloadSummary(e){return v(this,null,function*(){throw new Error("NOT IMPLEMENTED!")})}createBlob(e){return v(this,null,function*(){let t=new Uint8Array(e);return le.timedExecAsync(this.logger,{eventName:"createBlob",size:t.length},r=>v(this,null,function*(){let o=yield(yield this.getStorageManager()).createBlob(Pn(t,"base64"),"base64").then(s=>({id:s.sha,url:s.url}));return r.end({blobId:o.id}),o}))})}getPreviousFullSnapshot(e){return v(this,null,function*(){return e?this.getVersions(e,1).then(t=>v(this,null,function*(){return this.blobsShaCache.clear(),this.getSnapshotTree(t[0])})):void 0})}getCacheKey(e){return`${this.id}:${e}`}};var jp=class n extends bi{constructor(e,t,r,i={},o,s,a,c,l){super(n.loadInternalDocumentStorageService(e,t,r,i,o,s,a,c,l)),this.id=e,this.manager=t,this.noCacheGitManager=c,this._logTailSha=void 0}get logTailSha(){return this._logTailSha}static loadInternalDocumentStorageService(e,t,r,i,o,s,a,c,l){let h=o?.enableWholeSummaryUpload?new Bp(e,t,r,i,o,s,a,c,l):new qp(e,t,r,i,o,s,a,l);return!o?.enableWholeSummaryUpload&&i.caching===Ei.Prefetch?new Au(h):h}getSnapshotTree(e){return v(this,null,function*(){let t=yield this.internalStorageService.getSnapshotTree(e);return t!==null&&(this._logTailSha=".logTail"in t.trees?t.trees[".logTail"].blobs.logTail:void 0),t})}};Y();var ab=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(ab||{});Pe();var cb="1.4.0";var _3=(()=>{class n extends Vr{constructor(t,r,i,o=!1){super((s,a)=>{i.sendErrorEvent({eventName:"DeltaConnection:EventException",name:s},a)}),this.socket=t,this.documentId=r,this.enableLongPollingDowngrades=o,this.queuedMessages=[],this.queuedSignals=[],this.earlyOpHandlerAttached=!1,this.connectionListeners=new Map,this.trackedListeners=new Map,this._disposed=!1,this.earlyOpHandler=(s,a)=>{this.queuedMessages.push(...a)},this.earlySignalHandler=s=>{this.queuedSignals.push(s)},this.mc=Mn(ue.create(i,"DeltaConnection")),this.on("newListener",(s,a)=>{if(w(!this.disposed,522),n.eventsAlwaysForwarded.includes(s)){w(this.trackedListeners.has(s),581);return}if(!n.eventsToForward.includes(s))throw new Error(`DocumentDeltaConnection: Registering for unknown event: ${s}`);w(this.listeners(s).length!==0===this.trackedListeners.has(s),523),this.trackedListeners.has(s)||this.addTrackedListener(s,(...c)=>{this.emit(s,...c)})})}get hasDetails(){return!!this._details}get disposed(){return w(this._disposed||this.socket.connected,580),this._disposed}get logger(){return this.mc.logger}get details(){if(!this._details)throw new Error("Internal error: calling method before _details is initialized!");return this._details}get clientId(){return this.details.clientId}get mode(){return this.details.mode}get claims(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.serviceConfiguration.maxMessageSize}get version(){return this.details.version}get serviceConfiguration(){return this.details.serviceConfiguration}checkNotClosed(){w(!this.disposed,524)}get initialMessages(){return this.checkNotClosed(),w(this.earlyOpHandlerAttached,142),w(this.listeners("op").length!==0,143),this.removeEarlyOpHandler(),this.queuedMessages.length>0&&(this.details.initialMessages.push(...this.queuedMessages),this.details.initialMessages.sort((t,r)=>t.sequenceNumber-r.sequenceNumber),this.queuedMessages.length=0),this.details.initialMessages}get initialSignals(){return this.checkNotClosed(),w(this.listeners("signal").length!==0,144),this.removeEarlySignalHandler(),this.queuedSignals.length>0&&(this.details.initialSignals.push(...this.queuedSignals),this.queuedSignals.length=0),this.details.initialSignals}get initialClients(){return this.checkNotClosed(),this.details.initialClients}emitMessages(t,r){this.disposed||this.socket.emit(t,this.clientId,r)}submitCore(t,r){this.emitMessages(t,[r])}submit(t){this.checkNotClosed(),this.submitCore("submitOp",t)}submitSignal(t){this.checkNotClosed(),this.submitCore("submitSignal",[t])}dispose(){this.disposeCore(!1,Ar("Client closing delta connection",{canRetry:!0},{driverVersion:cb}))}disposeCore(t,r){this._disposed||(this._disposed=!0,this.removeTrackedListeners(),this.disconnect(t,r))}disconnect(t,r){this.socket.disconnect()}initialize(t,r){return v(this,null,function*(){this.socket.on("op",this.earlyOpHandler),this.socket.on("signal",this.earlySignalHandler),this.earlyOpHandlerAttached=!0;let i=0,o=()=>this.socket.io.reconnection(),s=()=>o()?this.socket.io.reconnectionAttempts():0,a=()=>s()+1;this._details=yield new Promise((c,l)=>{let h=(u,d)=>{this.disposeCore(u,d),l(d)};this.addConnectionListener("connect_error",u=>{var d;i++;let p=!1;try{let m=u?.description;m&&typeof m=="object"&&(u.type==="TransportError"&&(p=!0),m.target=void 0)}catch{}p&&this.enableLongPollingDowngrades&&((d=this.socket.io.opts.transports)===null||d===void 0?void 0:d[0])!=="polling"&&(this.socket.io.opts.transports=["polling","websocket"],o()||(this.socket.io.reconnection(!0),this.socket.io.reconnectionAttempts(1))),!(o()&&i<a())&&h(!0,this.createErrorObject("connect_error",u))}),this.addConnectionListener("connect_timeout",()=>{h(!0,this.createErrorObject("connect_timeout"))}),this.addConnectionListener("connect_document_success",u=>{if(t.nonce!==void 0&&u.nonce!==void 0&&u.nonce!==t.nonce)return;let d=t.mode,p=u.mode;if(u.claims.scopes.includes(ab.DocWrite)){if(p!==d){h(!1,this.createErrorObject("connect_document_success","Connected in a different mode than was requested",!1));return}}else if(p==="write"){h(!1,this.createErrorObject("connect_document_success","Connected in write mode without write permissions",!1));return}this.checkpointSequenceNumber=u.checkpointSequenceNumber,this.removeConnectionListeners(),c(u)}),this.addTrackedListener("disconnect",u=>{let d=this.createErrorObject("disconnect",u);this.emit("disconnect",d),h(!0,d)}),this.addTrackedListener("error",u=>{let d=this.createErrorObject("error",u,u!=="Invalid namespace");this.emit("error",d),h(!0,d)}),this.addConnectionListener("connect_document_error",u=>{t.nonce!==void 0&&u.nonce!==void 0&&u.nonce!==t.nonce||h(!1,this.createErrorObject("connect_document_error",u))}),this.socket.emit("connect_document",t),this.socketConnectionTimeout=setTimeout(()=>{h(!1,this.createErrorObject("orderingServiceHandshakeTimeout"))},r+2e3)}),w(!this.disposed,582)})}removeEarlyOpHandler(){this.socket.removeListener("op",this.earlyOpHandler),this.earlyOpHandlerAttached=!1}removeEarlySignalHandler(){this.socket.removeListener("signal",this.earlySignalHandler)}addConnectionListener(t,r){w(!n.eventsAlwaysForwarded.includes(t),583),w(!n.eventsToForward.includes(t),584),this.socket.on(t,r),w(!this.connectionListeners.has(t),525),this.connectionListeners.set(t,r)}addTrackedListener(t,r){this.socket.on(t,r),w(!this.trackedListeners.has(t),526),this.trackedListeners.set(t,r)}removeTrackedListeners(){for(let[t,r]of this.trackedListeners.entries())this.socket.off(t,r);this.removeConnectionListeners(),this.removeEarlyOpHandler(),this.removeEarlySignalHandler(),this.trackedListeners.clear()}removeConnectionListeners(){this.socketConnectionTimeout!==void 0&&clearTimeout(this.socketConnectionTimeout);for(let[t,r]of this.connectionListeners.entries())this.socket.off(t,r);this.connectionListeners.clear()}createErrorObject(t,r,i=!0){let o;return r?.type==="TransportError"?o=`${r?.message!==void 0?`${r.message}: `:""}${JSON.stringify(r,rm())}`:o=dg(r).message,Ar(`socket.io (${t}): ${o}`,{canRetry:i},{driverVersion:cb})}}return n.eventsToForward=["nack","op","signal","pong"],n.eventsAlwaysForwarded=["disconnect","error"],n})();var Xi="1.4.0";var y3=function(n){return n.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",n}(y3||{});function C3(n,e,t){let r={statusCode:e,driverVersion:Xi};switch(e){case void 0:return new Is(n,n.startsWith("NetworkError"),r);case 401:case 403:return new Su(n,void 0,void 0,r);case 404:let i=y3.fileNotFoundOrAccessDeniedError;return new Wr(n,i,r);case 429:return Ar(n,{canRetry:!0,retryAfterMs:t},r);case 500:case 502:return new Is(n,!0,r);default:return Ar(n,{canRetry:t!==void 0,retryAfterMs:t},r)}}function lb(n,e,t){throw C3(n,e,t)}function w3(n,e){let t=`R11s socket error (${e}): ${n.message}`;return C3(t,n.code,n.retryAfterMs)}var aK=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"],Vp=class n extends _3{static create(e,t,r,i,o,s,a,c=2e4){return v(this,null,function*(){let l=i(s,{query:{documentId:t,tenantId:e},reconnection:!1,transports:["websocket"],timeout:c}),h={client:o,id:t,mode:o.mode,tenantId:e,token:r,versions:aK,relayUserAgent:[o.details.environment,` driverVersion:${Xi}`].join(";")},u=!0,d=new n(l,t,a,u);return yield d.initialize(h,c),d})}createErrorObject(e,t,r=!0){return r&&Number.isInteger(t?.code)&&typeof t?.message=="string"?w3(t,e):super.createErrorObject(e,t,r)}};var Hp=class{get repositoryUrl(){throw new Error("Invalid operation")}getSnapshotTree(e){return v(this,null,function*(){return e?Promise.reject(new Error("Invalid operation")):null})}getVersions(e,t){return v(this,null,function*(){return[]})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return Promise.reject(new Error("Invalid operation"))})}downloadSummary(e){return v(this,null,function*(){return Promise.reject(new Error("Invalid operation"))})}createBlob(e){return v(this,null,function*(){return Promise.reject(new Error("Null blob storage can not create blob"))})}readBlob(e){return v(this,null,function*(){return Promise.reject(new Error("Null blob storage can not read blob"))})}};Y();Pe();var S3=Ce(M3()),db=Ce(G0());qt();var cK=n=>{var e,t;let r=n.baseURL!==void 0?`${n.baseURL}${(e=n.url)!==null&&e!==void 0?e:""}`:(t=n.url)!==null&&t!==void 0?t:"",i={method:n.method,headers:n.headers,body:n.data};return[r,i]},Gp=class extends fl{constructor(e,t,r,i,o,s={}){super(o,s),this.rateLimiter=t,this.getAuthorizationHeader=r,this.useRestLess=i,this.restLess=new wp}load(){return v(this,null,function*(){this.authorizationHeader=yield this.getAuthorizationHeader()})}request(e,t,r=!0){return v(this,null,function*(){var i;let o=Object.assign(Object.assign({},e),{headers:this.generateHeaders(e.headers)}),s=this.useRestLess?this.restLess.translate(o):o,a=cK(s),c=yield this.rateLimiter.schedule(()=>v(this,null,function*(){return(0,S3.default)(...a).catch(u=>v(this,null,function*(){let d=["TypeError","FetchError"].includes(u?.name);lb(d?`NetworkError: ${u.message}`:(0,db.default)(u))}))})),l=!((i=c.headers.get("content-type"))===null||i===void 0)&&i.includes("application/json")?yield c.json():yield c.text();if(c.ok||c.status===t)return l;if(c.status===401&&r)return this.authorizationHeader=yield this.getAuthorizationHeader(!0),this.request(o,t,!1);if(c.status===429&&l?.retryAfter>0)return new Promise((u,d)=>setTimeout(()=>{this.request(o,t).then(u).catch(d)},l.retryAfter*1e3));let h=l!==void 0?typeof l=="string"?l:(0,db.default)(l):c.statusText;lb(`R11s fetch error: ${h}`,c.status,l?.retryAfter)})}generateHeaders(e){let t=e?.["x-correlation-id"]||ke();return Object.assign(Object.assign({},e),{"x-correlation-id":t,"x-driver-version":Xi,Authorization:this.authorizationHeader})}},Wp=class n extends Gp{constructor(e,t,r,i,o,s={}){super(e,t,r,i,o,s)}static load(e,t,r,i,o,s,a){return v(this,null,function*(){let c={token:`${Ha(e)}`},l=u=>v(this,null,function*(){return le.timedExecAsync(i,{eventName:"FetchStorageToken",docId:t},()=>v(this,null,function*(){let p={password:(yield r.fetchStorageToken(e,t,u)).jwt,user:e};return qk(p)}))}),h=new n(i,o,l,s,a,c);try{yield h.load()}catch(u){i.sendErrorEvent({eventName:"R11sRestWrapperLoadFailure"},u),yield h.load()}return h})}},zo=class n extends Gp{constructor(e,t,r,i,o,s={}){super(e,t,r,i,o,s)}static load(e,t,r,i,o,s,a){return v(this,null,function*(){let c=h=>v(this,null,function*(){return le.timedExecAsync(i,{eventName:"FetchOrdererToken",docId:t},()=>v(this,null,function*(){return`Basic ${(yield r.fetchOrdererToken(e,t,h)).jwt}`}))}),l=new n(i,o,c,s,a);try{yield l.load()}catch(h){i.sendErrorEvent({eventName:"R11sRestWrapperLoadFailure"},h),yield l.load()}return l})}};var lK=5*6e4,Kp=class{constructor(e,t,r,i,o,s,a,c,l,h,u,d){this._resolvedUrl=e,this.ordererUrl=t,this.deltaStorageUrl=r,this.storageUrl=i,this.logger=o,this.tokenProvider=s,this.tenantId=a,this.documentId=c,this.driverPolicies=l,this.blobCache=h,this.snapshotTreeCache=u,this.discoverFluidResolvedUrl=d,this.lastDiscoveredAt=Date.now()}get resolvedUrl(){return this._resolvedUrl}dispose(){}connectToStorage(){return v(this,null,function*(){if(this.documentStorageService!==void 0)return this.documentStorageService;if(this.storageUrl===void 0)return new Hp;let e=o=>v(this,null,function*(){let s=this.shouldUpdateDiscoveredSessionInfo();if(s&&(yield this.refreshDiscovery()),!this.storageManager||!this.noCacheStorageManager||s){let a=new Ii(this.driverPolicies.maxConcurrentStorageRequests),c=yield Wp.load(this.tenantId,this.documentId,this.tokenProvider,this.logger,a,this.driverPolicies.enableRestLess,this.storageUrl),l=new gl(this.storageUrl,!0,!1,c);this.storageManager=new ul(l);let h=new gl(this.storageUrl,!0,!0,c);this.noCacheStorageManager=new ul(h)}return o?this.noCacheStorageManager:this.storageManager}),t=yield e(),r=yield e(!0),i={caching:this.driverPolicies.enablePrefetch?Ei.Prefetch:Ei.NoCaching,minBlobSize:this.driverPolicies.aggregateBlobsSmallerThanBytes};return this.documentStorageService=new jp(this.documentId,t,this.logger,i,this.driverPolicies,this.blobCache,this.snapshotTreeCache,r,e),this.documentStorageService})}connectToDeltaStorage(){return v(this,null,function*(){yield this.connectToStorage(),w(!!this.documentStorageService,177);let e=()=>v(this,null,function*(){let i=this.shouldUpdateDiscoveredSessionInfo();if(i&&(yield this.refreshDiscovery()),!this.ordererRestWrapper||i){let o=new Ii(this.driverPolicies.maxConcurrentOrdererRequests);this.ordererRestWrapper=yield zo.load(this.tenantId,this.documentId,this.tokenProvider,this.logger,o,this.driverPolicies.enableRestLess)}return this.ordererRestWrapper}),t=yield e(),r=new op(this.deltaStorageUrl,t,this.logger,e,()=>this.deltaStorageUrl);return new ip(this.tenantId,this.documentId,r,this.documentStorageService)})}connectToDeltaStream(e){return v(this,null,function*(){let t=r=>v(this,null,function*(){this.shouldUpdateDiscoveredSessionInfo()&&(yield this.refreshDiscovery());let i=yield le.timedExecAsync(this.logger,{eventName:"GetDeltaStreamToken",docId:this.documentId,details:JSON.stringify({refreshToken:r})},()=>v(this,null,function*(){return this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId,r)}));return le.timedExecAsync(this.logger,{eventName:"ConnectToDeltaStream",docId:this.documentId},()=>v(this,null,function*(){return Vp.create(this.tenantId,this.documentId,i.jwt,Ol,e,this.ordererUrl,this.logger)}))});try{return yield t()}catch(r){if(r?.statusCode===401)return t(!0);throw r}})}refreshDiscovery(){return v(this,null,function*(){return this.discoverP||(this.discoverP=le.timedExecAsync(this.logger,{eventName:"RefreshDiscovery"},()=>v(this,null,function*(){return this.refreshDiscoveryCore()}))),this.discoverP})}refreshDiscoveryCore(){return v(this,null,function*(){let e=yield this.discoverFluidResolvedUrl();this._resolvedUrl=e,this.storageUrl=e.endpoints.storageUrl,this.ordererUrl=e.endpoints.ordererUrl,this.deltaStorageUrl=e.endpoints.deltaStorageUrl})}shouldUpdateDiscoveredSessionInfo(){if(!this.driverPolicies.enableDiscovery)return!1;let t=Date.now()-this.lastDiscoveredAt>lK;return t&&(this.lastDiscoveredAt=Date.now(),this.discoverP=void 0,this.refreshDiscovery().catch(()=>{this.lastDiscoveredAt=0})),t}};Y();Pe();Y();var Ml=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Ml||{});function ub(n){let e=Object.keys(n.tree);for(let t of e){let r=n.tree[t];switch(r.type){case Ml.Tree:{n.tree[t]=ub(r);break}case Ml.Blob:{r.content=typeof r.content=="string"?r.content:Pn(r.content,"utf8");break}case Ml.Handle:throw new Error("No handle should be present for first summary!!");default:throw new Error(`Unknown tree type ${r.type}`)}}return n}var Io=Ce(q3());var Sl=n=>new Io.default(n,!0),gb=(n,e)=>n.split("/").slice(0,-1).concat([e]).join("/"),mb=(n,e)=>{if(e){let t=new Io.default(e.ordererUrl),r=new Io.default(n.endpoints.deltaStorageUrl);r.set("host",t.host);let i=new Io.default(e.historianUrl),o=new Io.default(n.endpoints.storageUrl);o.set("host",i.host);let s=Sl(n.url);return{endpoints:{deltaStorageUrl:r.toString(),ordererUrl:e.ordererUrl,storageUrl:o.toString()},id:n.id,tokens:n.tokens,type:n.type,url:new Io.default(`fluid://${t.host}${s.pathname}`).toString()}}else return n};var yK={enablePrefetch:!0,maxConcurrentStorageRequests:100,maxConcurrentOrdererRequests:100,aggregateBlobsSmallerThanBytes:void 0,enableDiscovery:!1,enableWholeSummaryUpload:!1,enableRestLess:!0},Xp=class{constructor(e,t={}){this.tokenProvider=e,this.protocolName="fluid:",this.blobCache=new xr,this.snapshotTreeCache=new xr,this.driverPolicies=Object.assign(Object.assign({},yK),t)}createContainer(e,t,r,i){return v(this,null,function*(){if(vn(t),e===void 0)throw new Error("Empty file summary creation isn't supported in this driver.");w(!!t.endpoints.ordererUrl,178);let o=Sl(t.url);if(!o.pathname)throw new Error("Parsed url should contain tenant and doc Id!!");let[,s]=o.pathname.split("/"),a=e.tree[".protocol"],c=e.tree[".app"];if(!(a&&c))throw new Error("Protocol and App Summary required in the full summary");let l=Y2(a),h=Z2(a),u=ue.create(r,"RouterliciousDriver"),d=new Ii(this.driverPolicies.maxConcurrentOrdererRequests),p=yield zo.load(s,void 0,this.tokenProvider,u,d,this.driverPolicies.enableRestLess,t.endpoints.ordererUrl),m=yield le.timedExecAsync(u,{eventName:"CreateNew",details:JSON.stringify({enableDiscovery:this.driverPolicies.enableDiscovery,sequenceNumber:l.sequenceNumber})},S=>v(this,null,function*(){let E=yield p.post(`/documents/${s}`,{summary:ub(c),sequenceNumber:l.sequenceNumber,values:h,enableDiscovery:this.driverPolicies.enableDiscovery,generateToken:this.tokenProvider.documentPostCreateCallback!==void 0});return S.end({docId:typeof E=="string"?E:E.id}),E})),g,x,b;typeof m=="string"?g=m:(g=m.id,x=m.token,b=this.driverPolicies.enableDiscovery?m.session:void 0),o=Sl(t.url);try{yield le.timedExecAsync(u,{eventName:"DocPostCreateCallback",docId:g},()=>v(this,null,function*(){if(x&&this.tokenProvider.documentPostCreateCallback!==void 0)return this.tokenProvider.documentPostCreateCallback(g,x)}))}catch(S){throw new vb(S)}o.set("pathname",gb(o.pathname,g));let _=t.endpoints.deltaStorageUrl;if(!_)throw new Error(`All endpoints urls must be provided. [deltaStorageUrl:${_}]`);let O=new URL(_);return O.pathname=gb(O.pathname,g),this.createDocumentService(Object.assign(Object.assign({},t),{url:o.toString(),id:g,endpoints:Object.assign(Object.assign({},t.endpoints),{deltaStorageUrl:O.toString()})}),r,i,b)})}createDocumentService(e,t,r,i){return v(this,null,function*(){vn(e);let o=Sl(e.url),[,s,a]=o.pathname.split("/");if(!a||!s)throw new Error(`Couldn't parse documentId and/or tenantId. [documentId:${a}][tenantId:${s}]`);let c=ue.create(t,"RouterliciousDriver",{all:{driverVersion:Xi}}),l=()=>v(this,null,function*(){if(!this.driverPolicies.enableDiscovery)return e;let m=new Ii(this.driverPolicies.maxConcurrentOrdererRequests),g=yield zo.load(s,a,this.tokenProvider,c,m,this.driverPolicies.enableRestLess,e.endpoints.ordererUrl),x=yield le.timedExecAsync(c,{eventName:"DiscoverSession",docId:a},()=>v(this,null,function*(){return g.get(`/documents/${s}/session/${a}`)}));return mb(e,x)}),h=i!==void 0?mb(e,i):yield l(),u=h.endpoints.storageUrl,d=h.endpoints.ordererUrl,p=h.endpoints.deltaStorageUrl;if(!d||!p)throw new Error(`All endpoints urls must be provided. [ordererUrl:${d}][deltaStorageUrl:${p}]`);return new Kp(h,d,p,u,c,this.tokenProvider,s,a,this.driverPolicies,this.blobCache,this.snapshotTreeCache,l)})}},vb=class extends Error{constructor(e){super(e.message),this.innerError=e,this.name="DocumentPostCreateError"}get stack(){return this.innerError.stack}};bt();var Jp=class{constructor(){}resolve(e){return v(this,null,function*(){let{ordererUrl:t,storageUrl:r,tenantId:i,containerId:o}=CK(e.url);if(e.headers&&e.headers[Ai.createNew]===!0)return{endpoints:{deltaStorageUrl:`${t}/deltas/${i}/new`,ordererUrl:t,storageUrl:`${r}/repos/${i}`},id:"",tokens:{},type:"fluid",url:`${t}/${i}/new`};if(o===void 0)throw new Error("Azure URL did not contain containerId");let s=`${t}/${i}/${o}`;return{endpoints:{deltaStorageUrl:`${t}/deltas/${i}/${o}`,ordererUrl:t,storageUrl:`${r}/repos/${i}`},id:o,tokens:{},type:"fluid",url:s}})}getAbsoluteUrl(e,t){return v(this,null,function*(){if(e.type!=="fluid")throw new Error("Invalid Resolved Url");return`${e.url}/${t}`})}};function CK(n){let e=new URL(n),t=e.origin,r=e.searchParams,i=r.get("storage");if(i===null)throw new Error("Azure URL did not contain a storage URL");let o=r.get("tenantId");if(o===null)throw new Error("Azure URL did not contain a tenant ID");let s=decodeURIComponent(i),a=decodeURIComponent(o),c=r.get("containerId"),l=c!==null?decodeURIComponent(c):void 0;return{ordererUrl:t,storageUrl:s,tenantId:a,containerId:l}}var j3=(n,e)=>{let t=new URL(n);return t.searchParams.append("storage",encodeURIComponent(n)),t.searchParams.append("tenantId",encodeURIComponent(e)),{url:t.href,headers:{[Ai.createNew]:!0}}};function bb(n){return n.type==="remote"}var wK="local",Qp=n=>bb(n)?n.tenantId:wK,PK=5,El=class{constructor(e){this.props=e,e.connection.endpoint=e.connection.endpoint.replace(/\/$/,""),this.urlResolver=new Jp;let t=bb(this.props.connection);this.documentServiceFactory=new Xp(this.props.connection.tokenProvider,{enableWholeSummaryUpload:t,enableDiscovery:t})}createContainer(e){return v(this,null,function*(){let r=yield this.createLoader(e).createDetachedContainer({package:"no-dynamic-package",config:{}}),i=yield this.createFluidContainer(r,this.props.connection),o=this.getContainerServices(r);return{container:i,services:o}})}copyContainer(e,t,r){return v(this,null,function*(){var i;let o=this.createLoader(t),s=new URL(this.props.connection.endpoint);s.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),s.searchParams.append("tenantId",encodeURIComponent(Qp(this.props.connection))),s.searchParams.append("containerId",encodeURIComponent(e));let a=yield o.resolve({url:s.href});if(a.resolvedUrl===void 0)throw new Error("Source container cannot resolve URL.");let l=yield(yield this.documentServiceFactory.createDocumentService(a.resolvedUrl)).connectToStorage(),h={type:ol.Handle,handleType:ol.Tree,handle:(i=r?.id)!==null&&i!==void 0?i:"latest"},u=yield l.downloadSummary(h),d=yield o.rehydrateDetachedContainerFromSnapshot(JSON.stringify(u)),p=yield this.createFluidContainer(d,this.props.connection),m=this.getContainerServices(d);return{container:p,services:m}})}getContainer(e,t){return v(this,null,function*(){let r=this.createLoader(t),i=new URL(this.props.connection.endpoint);i.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),i.searchParams.append("tenantId",encodeURIComponent(Qp(this.props.connection))),i.searchParams.append("containerId",encodeURIComponent(e));let o=yield r.resolve({url:i.href}),s=yield Tr(o,"/"),a=new ac(o,s),c=this.getContainerServices(o);return{container:a,services:c}})}getContainerVersions(e,t){return v(this,null,function*(){var r;let i=new URL(this.props.connection.endpoint);i.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),i.searchParams.append("tenantId",encodeURIComponent(Qp(this.props.connection))),i.searchParams.append("containerId",encodeURIComponent(e));let o=yield this.urlResolver.resolve({url:i.href});if(!o)throw new Error("Unable to resolved URL");return(yield(yield(yield this.documentServiceFactory.createDocumentService(o)).connectToStorage()).getVersions(null,(r=t?.maxCount)!==null&&r!==void 0?r:PK)).map(l=>({id:l.id,date:l.date}))})}getContainerServices(e){return{audience:new qh(e)}}createLoader(e){let t=new Bh(e),i={load:()=>v(this,null,function*(){return{module:{fluidExport:t},details:{package:"no-dynamic-package",config:{}}}})},o={details:{capabilities:{interactive:!0}},permission:[],scopes:[],user:{id:""},mode:"write"};return new rl({urlResolver:this.urlResolver,documentServiceFactory:this.documentServiceFactory,codeLoader:i,logger:this.props.logger,options:{client:o}})}createFluidContainer(e,t){return v(this,null,function*(){let r=j3(t.endpoint,Qp(t)),i=yield Tr(e,"/"),o=()=>v(this,null,function*(){if(e.attachState!==oe.Detached)throw new Error("Cannot attach container. Container is not in detached state");yield e.attach(r);let a=e.resolvedUrl;return vn(a),a.id}),s=new ac(e,i);return s.attach=o,s})}};var Lb=Ce(_5());var y5=Ce(fi());Y();var Bb=class extends we{constructor(e,t){super(),this.signaler=e,this.emitter=new y5.EventEmitter,this.emitter.on("error",r=>{this.emit("error",r)}),this.managerId=t?`#${t}`:void 0,this.signaler.on("signal",(r,i)=>{let o=r.clientId;this.signaler.connected&&o!==null&&this.emitter.emit(r.type,o,i,r.content)})}getManagerSignalName(e){return this.managerId?`${e}${this.managerId}`:e}onSignal(e,t){let r=this.getManagerSignalName(e);return this.emitter.on(r,t),this}offSignal(e,t){let r=this.getManagerSignalName(e);return this.emitter.off(r,t),this}submitSignal(e,t){let r=this.getManagerSignalName(e);this.signaler.connected&&this.signaler.submitSignal(r,t)}},Ro=class extends Mo{get manager(){return w(this._manager!==void 0,587),this._manager}static get Name(){return"@fluid-example/signal-manager"}hasInitialized(){return v(this,null,function*(){this._manager=new Bb(this.runtime),this.manager.on("error",e=>{this.emit("error",e)})})}onSignal(e,t){return this.manager.onSignal(e,t),this}offSignal(e,t){return this.manager.offSignal(e,t),this}submitSignal(e,t){this.manager.submitSignal(e,t)}};Ro.factory=new ta(Ro.Name,Ro,[],{});qt();var C5=(()=>{let e=class e{constructor(){this.userConfig={id:ke(),name:localStorage.getItem("userName")??this.getRandomName(),additionalDetails:{color:this.getRandomColor()}},this.remoteConnectionConfig={tenantId:process.env.NG_APP_TENANT_ID,type:"remote",tokenProvider:new Lb.InsecureTokenProvider(process.env.NG_APP_PRIMARY_KEY,this.userConfig),endpoint:process.env.NG_APP_ENDPOINT_URL},this.localConnectionConfig={type:"local",tokenProvider:new Lb.InsecureTokenProvider("",this.userConfig),endpoint:"http://localhost:7070"},this.useAzure=process.env.NG_APP_USE_AZURE,this.connectionConfig={connection:this.useAzure==="true"?this.remoteConnectionConfig:this.localConnectionConfig}}getFluidData(){return v(this,null,function*(){let r,i,o="",s={initialObjects:{map:Ui,signaler:Ro}},a=new El(this.connectionConfig);return!location.hash?({container:r,services:i}=yield a.createContainer(s),o=yield r.attach(),location.hash=o):(o=location.hash.substring(1),{container:r,services:i}=yield a.getContainer(o,s)),r.connectionState!==Re.Connected&&(yield new Promise(l=>{r.once("connected",()=>{l()})})),{container:r,services:i,sharedMap:r.initialObjects.map,signaler:r.initialObjects.signaler}})}getRandomName(){let r=["Alice","Bob","Charlie","David","Eve","Frank","George","Hannah","Irene","Jack","Karen","Linda","Molly","Nancy","Olivia","Peter","Quelle","Richard","Susan","Tina","Ursula","Vicky","Wendy","Xavier","Yvonne","Zoe"];return r[Math.floor(Math.random()*r.length)]}getRandomColor(){let r=["red","green","blue","orange","purple","brown","chocolate","coral","cyan","darkblue","darkgreen","darkred","darkyellow","darkorange","darkpurple","darkpink","darkbrown","darkchocolate","darkcoral","darkcyan","cornflowerblue"];return r[Math.floor(Math.random()*r.length)]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var w5=(()=>{let e=class e{constructor(r){this.fluidContainerService=r,this.behaviorSubject$=new kl({elementToBeDrawn:[]}),this.elementToBeDrawn=[],this.behaviorSubjectObservable$=this.behaviorSubject$.asObservable()}initFluid(){return v(this,null,function*(){this.whiteBoardSharedMap||(this.fluidData=yield this.fluidContainerService.getFluidData(),this.whiteBoardSharedMap=this.fluidData.sharedMap,this.syncWhiteboardData(),this.mouseTracker=new AP(this.fluidData.container,this.fluidData.services.audience,this.fluidData.container.initialObjects.signaler))})}updatewhiteBoardSharedMap(r){this.whiteBoardSharedMap&&this.whiteBoardSharedMap.set("elementToBeDrawn",r)}syncWhiteboardData(){this.whiteBoardSharedMap&&(this.syncSharedMap=()=>{this.elementToBeDrawn=this.whiteBoardSharedMap.get("elementToBeDrawn")??[],this.behaviorSubject$.next({elementToBeDrawn:this.elementToBeDrawn})},this.syncSharedMap(),this.whiteBoardSharedMap.on("valueChanged",this.syncSharedMap))}};e.\u0275fac=function(i){return new(i||e)(pt(C5))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var NK=["workarea"],BK=["whiteboard"],LK=["mouseTrackerDiv"],lye=(()=>{let e=class e{constructor(r,i,o,s,a){this._whiteboardService=r,this.fluidService=i,this.sharedService=o,this.dialog=s,this.toaster=a,this.selectedTool=_e.BRUSH,this.selectedElement=null,this.options=Ra,this.zoom=Kf,this.outerWidth=h_,this.outerHeight=p_,this.x=f_,this.y=g_,this.mouseTrackerDiv={}}handleDeleteKeyboardEvent(r){r.key==="Delete"||r.key==="Backspace"?this.deleteSelectedElement():r.getModifierState&&r.getModifierState("Control")&&(r.key==="z"?this.undoSelectedElement():r.key==="y"&&this.redoSelectedElement())}ngOnInit(){this.initializeFluidService(),this.auth=this.sharedService.getAuth(),this.fireStore=this.sharedService.getFirestore()}toolSelectionChanged(r){this.selectedTool=r}zoomWheel(r){let i=r;if(i.altKey||i.ctrlKey){r.preventDefault();let o=this.zoom*100;this.setZoom(Math.trunc(o-i.deltaY/100*(i.altKey?10:5)))}}setZoom(r){let i=this.zoom,o=+r/100;o<.001&&(o=.1);let s={w:this.options.canvasWidth,h:this.options.canvasHeight},a=null;a!=null&&window.cancelAnimationFrame(a);let c=Date.now(),l=500,h=o-i,u=()=>{let p=(Date.now()-c)/l;p=Math.pow(p-1,3)+1,this.zoom=i+h*p,this.updateSize(s.w,s.h),p<1&&p>-.9?a=requestAnimationFrame(u):(this.zoom=o,this.updateSize(s.w,s.h))};u()}dataChanged(){this.fluidService.updatewhiteBoardSharedMap(this.whiteboard.data)}newDocument(){this._whiteboardService.erase()}saveAs(r){this._whiteboardService.save(r)}addImage(r){if(r){let i=r.files;if(i){let o=new FileReader;o.onload=s=>{let a=s.target.result;this._whiteboardService.addImage(a)},o.readAsDataURL(i[0])}}}undo(){this._whiteboardService.undo()}redo(){this._whiteboardService.redo()}colorChange(r,i){this.selectedElement?this.selectedElement.options[r]=i:(this.options[r]=i,this.options=this.options,this.updateOptions())}swapColors(){[this.options.fill,this.options.strokeColor]=[this.options.strokeColor,this.options.fill],this.updateOptions()}setSelectedElement(r){this.selectedElement=r}onSave(r){let i=navigator.clipboard;i&&i.writeText(r)}SaveToDB(){this.dialog.open(G_).afterClosed().subscribe(i=>{i&&this.saveToFirestore(i)})}saveToFirestore(r){px(fx(this.fireStore,"boards"),{user:this.auth?.currentUser?.email,board:this.whiteboard.data,name:r,id:crypto.randomUUID()}).then(i=>{this.toaster.success("Board saved successfully","Success")})}deleteSelectedElement(){let r=this.whiteboard.data.findIndex(i=>i.id===this.selectedElement?.id);r>-1&&this.whiteboard.data.splice(r,1)}undoSelectedElement(){this._whiteboardService.undo()}redoSelectedElement(){this._whiteboardService.redo()}updateSize(r,i){this.options.canvasWidth=r,this.options.canvasHeight=i;let o=this.zoom,s=this.outerWidth,a=this.outerHeight,c=s/2-r*o/2,l=a/2-i*o/2;setTimeout(()=>{this.x=c,this.y=l},0)}updateOptions(){this.options=Object.assign({},this.options)}initializeFluidService(){return v(this,null,function*(){yield this.fluidService.initFluid(),this.myself=yield this.fluidService.fluidData?.services.audience.getMyself(),this.fluidService.behaviorSubjectObservable$.subscribe(r=>{this.triggeredFromBehaviouSubject=!0,this.whiteboard.data=r.elementToBeDrawn}),v_(this.fluidService.mouseTracker,this.mouseTrackerDiv.nativeElement,this.myself)})}};e.\u0275fac=function(i){return new(i||e)(X(Ta),X(w5),X(Px),X(qa),X(hx))},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-component"]],viewQuery:function(i,o){if(i&1&&(Ct(NK,5),Ct(BK,5),Ct(LK,7)),i&2){let s;We(s=Ke())&&(o.workarea=s.first),We(s=Ke())&&(o.whiteboard=s.first),We(s=Ke())&&(o.mouseTrackerDiv=s.first)}},hostBindings:function(i,o){i&1&&K("keyup",function(a){return o.handleDeleteKeyboardEvent(a)},!1,xa)},standalone:!0,features:[pn([Ta]),xe],decls:33,vars:20,consts:[["workarea",""],["whiteboard",""],["mouseTrackerDiv",""],[1,"whiteboard-container"],[1,"editor"],["id","rulers"],["id","ruler_corner"],["id","ruler_x"],["id","ruler_y"],["id","workarea",1,"select",2,"overflow","scroll",3,"mousewheel"],["id","svgcanvas"],[3,"selectElement","save","toolChanged","undo","redo","click","drag","drop","selectedTool","options","strokeWidth","zoom","canvasHeight","canvasWidth","center","fullScreen","strokeColor","fill","backgroundColor"],["id","menu_bar",1,"active"],[3,"onNewDocument"],[3,"onSaveAs"],[3,"onImageAdd"],[3,"onUndo"],[3,"onRedo"],[3,"onSaveToDB"],["id","tools_left",1,"tools_panel"],[3,"onToolSelectionChanged","selectedTool"],[3,"onColorChange","onSwapColors"],["id","tools_bottom",1,"tools_panel"],[3,"onZoom","zoom"]],template:function(i,o){if(i&1){let s=yt();L(0,"div",3)(1,"div",4)(2,"div",5),Z(3,"div",6)(4,"div",7)(5,"div",8),j(),L(6,"div",9,0),K("mousewheel",function(c){return se(s),ae(o.zoomWheel(c))}),L(8,"div",10)(9,"ng-whiteboard",11,1),K("selectElement",function(c){return se(s),ae(o.setSelectedElement(c))})("save",function(c){return se(s),ae(o.onSave(c))})("toolChanged",function(c){return se(s),ae(o.selectedTool=c)})("selectElement",function(){return se(s),ae(o.dataChanged())})("undo",function(){return se(s),ae(o.dataChanged())})("redo",function(){return se(s),ae(o.dataChanged())})("click",function(){return se(s),ae(o.dataChanged())})("drag",function(){return se(s),ae(o.dataChanged())})("drop",function(){return se(s),ae(o.dataChanged())})("drag",function(){return se(s),ae(o.dataChanged())}),j()()(),L(11,"div",12)(12,"app-whiteboard-new-document",13),K("onNewDocument",function(){return se(s),ae(o.newDocument())}),j(),L(13,"app-whiteboard-save-as-menu",14),K("onSaveAs",function(c){return se(s),ae(o.saveAs(c))}),j(),L(14,"app-whiteboard-add-image",15),K("onImageAdd",function(c){return se(s),ae(o.addImage(c))}),j(),L(15,"app-whiteboard-undo",16),K("onUndo",function(){return se(s),ae(o.undo())}),j(),L(16,"app-whiteboard-redo",17),K("onRedo",function(){return se(s),ae(o.redo())}),j(),L(17,"app-whiteboard-save-to-db",18),K("onSaveToDB",function(){return se(s),ae(o.SaveToDB())}),j()(),L(18,"div",19)(19,"app-whitebord-button-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(20,"app-whiteboard-brush-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(21,"app-whiteboard-image-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(22,"app-whiteboard-line-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(23,"app-whiteboard-rect-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(24,"app-whiteboard-ellipse-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(25,"app-whiteboard-text-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(26,"app-whiteboard-eraser-tool",20),K("onToolSelectionChanged",function(c){return se(s),ae(o.toolSelectionChanged(c))}),j(),L(27,"app-whiteboard-color-tool",21),K("onColorChange",function(c){return se(s),ae(o.colorChange(c.type,c.event))})("onSwapColors",function(){return se(s),ae(o.swapColors())}),j(),ot(28,"\xA0 "),j(),L(29,"div",22)(30,"app-whiteboard-zoom-panel",23),K("onZoom",function(c){return se(s),ae(o.setZoom(c))}),j()()()(),Z(31,"div",null,2)}i&2&&(U(9),ee("selectedTool",o.selectedTool)("options",o.options)("strokeWidth",o.options.strokeWidth)("zoom",o.zoom)("canvasHeight",o.options.canvasHeight)("canvasWidth",o.options.canvasWidth)("center",!0)("fullScreen",!1)("strokeColor",o.options.strokeColor)("fill",o.options.fill)("backgroundColor",o.options.backgroundColor),U(10),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(),ee("selectedTool",o.selectedTool),U(4),ee("zoom",o.zoom))},dependencies:[Wn,Ix,zx,Sx,cd,E_,Y_,W_,K_,$_,X_,J_,Q_,Z_,ey,ty,ny,ry,iy,oy,sy,ay],styles:[`@charset "UTF-8";.editor{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}::selection{background:#000;color:#fff}::-moz-selection{background:#000;color:#fff}.editor{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}::-webkit-scrollbar-track{border-radius:10px;background:transparent}::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}::-webkit-scrollbar-corner{background:transparent}input[type=submit],input[type=button],button{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit]:hover,input[type=button]:hover,button:hover{background:var(--accent9)}input[type=submit]:active,input[type=button]:active,button:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit]:focus,input[type=button]:focus,button:focus{outline:none}button.cancel,input.Cancel,input.cancel,input.jGraduate_Cancel{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel{display:block}#tool_bold span,#tool_italic span{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix:before,.clearfix:after{content:"";display:table}.clearfix:after{clear:both}#color_canvas_tools,#fill_bg,#stroke_bg{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools{display:block}#stroke_style_label{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool .caret{top:60%}.draginputs{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging .draginput{pointer-events:none}.dragging .draginput.active{pointer-events:all;box-shadow:none}.draginput:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput:hover span,.draginput.active span{color:var(--z15)}.draginput:hover input,.draginput.active input{color:var(--accent8)}.draginput.active,.draginput.active:hover{background-color:var(--z0)}.draginput.active:hover{transition:none}.draginput .caret{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput label{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput label#resolution_label,.draginput label#seg_type_label{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput label#seg_type_label{margin-top:40px}.draginput label#seg_type_label .caret{top:66%}.draginput label#resolution_label .pull{position:relative;left:-15px}.draginput label#resolution_label span{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput input{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput input::selection{background:var(--accent9)}.draginput.text-input input,.draginput.text-input input:hover,.draginput.text-input input:active{cursor:text}.draginput.text-input input{text-align:left;text-indent:var(--x2)}.draginput.textcontent input{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent input,.draginput.textcontent input:hover,.draginput.textcontent input:active{cursor:text}.draginput input,.draginput input:hover,.draginput input:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput input[type=checkbox],.draginput input[type=checkbox]:hover,.draginput input[type=checkbox]:active{cursor:pointer}.draginput input:invalid{color:var(--a7)}.draginput span{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput select{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput:hover .draginput_cursor{border-color:var(--accent6)}.draginput_cursor{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput input[readonly=readonly]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput input:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput input:focus+span{z-index:10;color:var(--z15)}.draginput .push_bottom{bottom:0;position:absolute}.draginput .angle{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging .draginput .angle{background-color:var(--z1)}.draginput:hover .angle{background:var(--z4)}.draginput .angle-cursor{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar .menu:hover .menu_list{display:block}.menu{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu .menu_title:hover{background:var(--z2)}.menu_list .separator{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active .menu.open .menu_title{background:var(--z15);color:var(--z1)}.menu .menu_list{display:none;position:absolute}.menu_list .menu_item{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list .menu_item.tool_button{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list .menu_item.push_button_pressed:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list .menu_item:hover,.menu_list .menu_item.push_button_pressed:hover{background:var(--accent15);color:#000}.menu_list .menu_item.disabled:hover,.menu_list .menu_item.push_button_pressed.disabled:hover{background:transparent;color:var(--z3)}.menu_list .menu_item.push_button_pressed{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list .menu_item span{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list .menu_item:not(.disabled):hover span{background:var(--accent13)}.menu-right button:hover svg{fill:var(--z12)}.menu-right svg{fill:var(--z5)}#logo svg{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo svg path:last-child{fill:var(--z13)}#logo:hover svg{fill:var(--z9)}#logo svg path:last-child{fill:var(--z15)}#rulers>div{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers #ruler_corner{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x>div,#ruler_y>div{overflow:hidden}#stroke_color:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch svg{fill:var(--z6)}#tool_switch:hover svg{fill:var(--z15)}.color_block{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block svg{width:22px;height:22px}#tool_stroke .color_block>div{position:absolute;bottom:0;right:0}#color_tools{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools{width:auto;height:auto}#tool_fill{position:absolute;top:0;left:0;z-index:1}#tool_stroke{top:14px;left:14px}#tool_fill,#tool_stroke,#tool_canvas{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas .color_block{width:58px;height:38px}#tool_canvas .color_block svg{width:auto;height:auto}#shape_cats>div{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas{background-color:var(--z2);display:block;width:100%;height:100%}#workarea{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button:hover{transform:scale(1)}.tool_button:hover svg{fill:var(--z13)}.tool_button.active{transform:scale(1.4)}.tool_button svg{vertical-align:center;fill:var(--z5)}.tool_button.active svg{fill:var(--accent8)}.tool_button.active svg{fill:var(--accent7)}.tool_button.disabled svg{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect svg{position:relative;top:-1px;left:1px}#tool_ellipse svg{position:relative;top:2px;left:1px}.select-input{margin:var(--x2) 0;position:relative}.select-input:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input select{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input select:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel{display:none}.context_panel h4{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel label{display:block;color:var(--z13);white-space:nowrap}#align_tools{display:none}.align_buttons{margin-bottom:var(--x2)}.align_button,.align_button *{transition:var(--transition)}.align_button:hover,.align_button:hover *{transition:none}.align_button{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button:hover{background-color:var(--z0);border-color:var(--z3)}.align_button svg{fill:var(--z10)}.align_button:hover svg{fill:var(--z15);transition:none}.align_button:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons .push_button{display:block;float:left}#tool_bold,#tool_italic{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold{right:0}#tool_italic{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold:hover,#tool_italic:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled,#tool_italic.disabled{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active,#tool_italic.active{color:#50a0ff}#preview_font{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font+.caret{right:var(--x2)}.draginput:hover #preview_font:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel,#zoom_select{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label:after{content:""}#zoom_select{opacity:0;z-index:100}#zoom_select:hover+div{opacity:1}#zoom_label{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel .caret{margin-top:-5px}#zoom_label img,#zoom_label svg{width:var(--x4);height:var(--x4)}#zoomLabel{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel svg{fill:var(--z10);position:relative;top:2px}#zoom_label input{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label select{-webkit-appearance:none;position:absolute;inset:0}#zoom_label span{top:0;left:0}
`],encapsulation:3});let n=e;return n})();export{lye as a};
