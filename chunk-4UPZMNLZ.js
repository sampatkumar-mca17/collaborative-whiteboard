import{a as Fx,b as Kl}from"./chunk-CBYG2KFU.js";import{$ as ws,B as yg,C as xx,G as _x,I as ui,J as Cg,K as yx,L as ql,M as Ll,N as jo,O as jl,P as wg,Q as Cx,V as Vl,W as Hl,Z as Ul,_ as wx,aa as Br,ba as Px,ca as Ox,ga as Pg,ha as Mx,i as gx,ia as Sx,ja as Ps,k as fx,ka as Os,na as Ex,o as vx,oa as Gl,pa as Vo,qa as hi,ra as Wl,sa as Ax,ta as kx,ua as Dx,y as bx,z as _g}from"./chunk-HGITZB6Y.js";import{a as Tx}from"./chunk-TIWCUDTS.js";import{$ as Ut,$a as ex,A as Jb,Aa as ie,Ab as j,Ac as dx,B as pg,Bb as Z,Bc as ux,C as Dl,Cb as ci,Cc as hx,D as eo,Db as li,Dc as vg,Ec as px,Fb as yt,Ga as bs,Gb as Bo,Gc as Wn,Ib as K,J as Fl,Jb as ne,Kb as fg,Lb as rr,Mb as di,Nb as Ct,Ob as Xe,Oc as Bl,Pb as Je,Pc as _s,Qb as _r,Rb as it,Rc as Kn,S as Qb,Sb as Rl,Sc as mx,T as Yb,Tb as no,Tc as bg,U as Tl,Ub as gn,Uc as ys,Va as Zb,Vb as xe,Vc as Cs,W as No,Wa as xs,Wb as Nl,Wc as xg,Xb as ix,Y as zl,Ya as H,Z as to,Za as X,_ as Et,_b as ox,a as Ub,ba as ft,bb as tx,c as Gb,cc as ax,da as ht,db as gg,ea as Nn,f as tt,fb as en,fc as sx,g as Al,hc as yr,ia as pn,ja as fe,jb as Gn,k as Wb,ka as Gt,la as nt,nc as mg,ob as we,p as Kb,pb as me,q as $b,qa as tr,qb as ee,qc as qo,ra as ae,rb as tn,sa as se,sb as Re,ta as ce,tb as nx,u as Xb,ua as nr,ub as rx,va as Il,vb as nn,vc as cx,xa as xr,xc as lx,yc as Lo,z as kl,za as _t,zb as q,zc as ro}from"./chunk-JPNHJXW6.js";import{a as Ht,b as si,d as W,e as z,f as Zi,g as Ce,h as Zt,i as er,j as v}from"./chunk-SO6VPFYA.js";function w(n,e){if(!n)throw new Error(typeof e=="number"?`0x${e.toString(16).padStart(3,"0")}`:e)}var js=W(()=>{});function Pn(n,e){switch(e){case"base64":return fd.fromByteArray(n);case"utf8":case"utf-8":case void 0:return new TextDecoder().decode(n);default:throw new Error("invalid/unsupported encoding")}}function of(n){let e=n;return n instanceof ArrayBuffer||typeof e=="object"&&e!==null&&typeof e.byteLength=="number"&&typeof e.slice=="function"&&e.byteOffset===void 0&&e.buffer===void 0}var fd,Bn,gi,Wt,af=W(()=>{fd=Ce(Tx());js();Bn=(n,e)=>Wt.from(n,e).buffer,gi=(n,e)=>Wt.from(n).toString(e);Wt=class n extends Uint8Array{toString(e){return Pn(this,e)}static from(e,t,r){if(typeof e=="string")return n.fromString(e,t);if(e!==null&&typeof e=="object"&&of(e.buffer))return w(e.byteOffset===0,0),w(e.byteLength===e.buffer.byteLength,1),n.fromArrayBuffer(e.buffer,t,r);if(of(e))return n.fromArrayBuffer(e,t,r);throw new TypeError}static fromArrayBuffer(e,t,r){let i=t??0,o=r??e.byteLength-i;if(i<0||i>e.byteLength||o<0||o+i>e.byteLength)throw new RangeError;return new n(e,i,o)}static fromString(e,t){switch(t){case"base64":{let r=this.sanitizeBase64(e),i=fd.toByteArray(r);return new n(i.buffer)}case"utf8":case"utf-8":case void 0:{let r=new TextEncoder().encode(e);return new n(r.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0&&(t+=["","===","==","="][t.length%4]),t}}});function yT(n,e){return v(this,null,function*(){let t=yield crypto.subtle.digest(e,n);return new Uint8Array(t)})}function CT(n,e){switch(e){case"hex":return Array.prototype.map.call(n,r=>r.toString(16).padStart(2,"0")).join("");case"base64":return gy.fromByteArray(n)}}function fy(n,e="SHA-1",t="hex"){return v(this,null,function*(){if(crypto.subtle===void 0)return import("./chunk-KRUCD4QG.js").then(i=>v(this,null,function*(){return i.hashFile(n,e,t)}));let r=yield yT(n,e);return CT(r,t)})}function sf(n){return v(this,null,function*(){let t=`blob ${n.byteLength.toString()}\0`,r=Wt.from(t+n.toString());return fy(r)})}var gy,my=W(()=>{gy=Ce(Tx());af();});var de,vy=W(()=>{de=window.performance});var md=W(()=>{af();my();vy();});var cf,Vs,wT,by=W(()=>{md();cf=n=>Wt.from(n,"base64").toString("utf-8"),Vs=n=>Wt.from(n,"utf8").toString("base64"),wT=(n,e)=>{switch(e){case"utf8":case"utf-8":return n;default:return Wt.from(n,e).toString()}}});var lf,xy=W(()=>{lf=class{constructor(e,t=100){this.process=e,this.maxBatchSize=t,this.pendingWork=new Map}add(e,t){this.pendingWork.has(e)||this.pendingWork.set(e,[]),this.pendingWork.get(e).push(t),this.pendingWork.get(e).length>=this.maxBatchSize?(this.pendingTimer!==void 0&&clearTimeout(this.pendingTimer),this.pendingTimer=void 0,this.startWork()):this.pendingTimer===void 0&&(this.pendingTimer=setTimeout(()=>{this.pendingTimer=void 0,this.startWork()},0))}drain(){this.startWork()}startWork(){let e=this.pendingWork;this.pendingWork=new Map;for(let[t,r]of e)this.process(t,r)}}});function so(n,e){return(...t)=>{if(n.disposed)throw new Error("Already disposed");return e(...t)}}var _y=W(()=>{});var fi=z((kY,df)=>{"use strict";var Jo=typeof Reflect=="object"?Reflect:null,yy=Jo&&typeof Jo.apply=="function"?Jo.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},vd;Jo&&typeof Jo.ownKeys=="function"?vd=Jo.ownKeys:Object.getOwnPropertySymbols?vd=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:vd=function(e){return Object.getOwnPropertyNames(e)};function PT(n){console&&console.warn&&console.warn(n)}var wy=Number.isNaN||function(e){return e!==e};function Ye(){Ye.init.call(this)}df.exports=Ye;df.exports.once=ET;Ye.EventEmitter=Ye;Ye.prototype._events=void 0;Ye.prototype._eventsCount=0;Ye.prototype._maxListeners=void 0;var Cy=10;function bd(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Ye,"defaultMaxListeners",{enumerable:!0,get:function(){return Cy},set:function(n){if(typeof n!="number"||n<0||wy(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Cy=n}});Ye.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ye.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||wy(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Py(n){return n._maxListeners===void 0?Ye.defaultMaxListeners:n._maxListeners}Ye.prototype.getMaxListeners=function(){return Py(this)};Ye.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")yy(c,this,t);else for(var l=c.length,h=Ay(c,l),r=0;r<l;++r)yy(h[r],this,t);return!0};function Oy(n,e,t,r){var i,o,a;if(bd(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),a=o[e]),a===void 0)a=o[e]=t,++n._eventsCount;else if(typeof a=="function"?a=o[e]=r?[t,a]:[a,t]:r?a.unshift(t):a.push(t),i=Py(n),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=n,s.type=e,s.count=a.length,PT(s)}return n}Ye.prototype.addListener=function(e,t){return Oy(this,e,t,!1)};Ye.prototype.on=Ye.prototype.addListener;Ye.prototype.prependListener=function(e,t){return Oy(this,e,t,!0)};function OT(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function My(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=OT.bind(r);return i.listener=t,r.wrapFn=i,i}Ye.prototype.once=function(e,t){return bd(t),this.on(e,My(this,e,t)),this};Ye.prototype.prependOnceListener=function(e,t){return bd(t),this.prependListener(e,My(this,e,t)),this};Ye.prototype.removeListener=function(e,t){var r,i,o,a,s;if(bd(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():MT(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||t)}return this};Ye.prototype.off=Ye.prototype.removeListener;Ye.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Sy(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?ST(i):Ay(i,i.length)}Ye.prototype.listeners=function(e){return Sy(this,e,!0)};Ye.prototype.rawListeners=function(e){return Sy(this,e,!1)};Ye.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):Ey.call(n,e)};Ye.prototype.listenerCount=Ey;function Ey(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ye.prototype.eventNames=function(){return this._eventsCount>0?vd(this._events):[]};function Ay(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function MT(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function ST(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function ET(n,e){return new Promise(function(t,r){function i(a){n.removeListener(e,o),r(a)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}ky(n,e,o,{once:!0}),e!=="error"&&AT(n,i,{once:!0})})}function AT(n,e,t){typeof n.on=="function"&&ky(n,"error",e,t)}function ky(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}});var Dy,Pe,uf=W(()=>{Dy=Ce(fi());Pe=class extends Dy.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}});var mi,Fy=W(()=>{uf();mi=(()=>{class n extends Pe{constructor(t){if(super(),this.isDisposed=!1,this.forwardingEvents=new Map,t!==void 0){let r=o=>this.unforwardEvent(t,o),i=o=>this.forwardEvent(t,o);this.on(n.removeListenerEvent,r),this.on(n.newListenerEvent,i)}}static isEmitterEvent(t){return t===n.newListenerEvent||t===n.removeListenerEvent}get disposed(){return this.isDisposed}dispose(){this.isDisposed=!0;for(let t of this.forwardingEvents.values())for(let r of t.values())try{r()}catch{}this.removeAllListeners(),this.forwardingEvents.clear()}forwardEvent(t,...r){for(let i of r)if(t!==void 0&&i!==void 0&&!n.isEmitterEvent(i)){let o=this.forwardingEvents.get(i);if(o===void 0&&(o=new Map,this.forwardingEvents.set(i,o)),!o.has(t)){let a=(...s)=>this.emit(i,...s);o.set(t,()=>t.off(i,a)),t.on(i,a)}}}unforwardEvent(t,...r){for(let i of r)if(i!==void 0&&!n.isEmitterEvent(i)){let o=this.forwardingEvents.get(i);if(o?.has(t)&&this.listenerCount(i)===0){let a=o.get(t);a!==void 0&&a(),o.delete(t),o.size===0&&this.forwardingEvents.delete(i)}}}}return n.newListenerEvent="newListener",n.removeListenerEvent="removeListener",n})()});var kT,hf,Ty=W(()=>{kT={compare:(n,e)=>n-e,min:Number.MIN_VALUE},hf=class{constructor(e){this.comp=e,this.L=[{value:e.min,position:0}]}peek(){return this.L[1]}get(){this.swap(1,this.count());let e=this.L.pop();return this.fixdown(1),e.value}add(e){let t={value:e,position:this.L.length};return this.L.push(t),this.fixup(this.count()),t}update(e){let t=e.position;this.isGreaterThanParent(t)?this.fixup(t):this.fixdown(t)}remove(e){let t=e.position;this.swap(e.position,this.L.length-1),this.L.splice(this.L.length-1),t!==this.L.length&&this.update(this.L[t])}count(){return this.L.length-1}fixup(e){let t=e;for(;this.isGreaterThanParent(t);){let r=t>>1;this.swap(t,r),t=r}}isGreaterThanParent(e){return e>1&&this.comp.compare(this.L[e>>1].value,this.L[e].value)>0}fixdown(e){let t=e;for(;t<<1<=this.count();){let r=t<<1;if(r<this.count()&&this.comp.compare(this.L[r].value,this.L[r+1].value)>0&&r++,this.comp.compare(this.L[t].value,this.L[r].value)<=0)break;this.swap(t,r),t=r}}swap(e,t){let r=this.L[e];this.L[e]=this.L[t],this.L[e].position=e,this.L[t]=r,this.L[t].position=t}}});function pf(n){let e=o=>o!==null&&!Array.isArray(o)&&typeof o=="object",t=(o,a)=>{let s=o.split(`
`);return s.shift(),a!==void 0&&s.unshift(a),s.join(`
`)},i={message:typeof n?.message=="string"?n.message:String(n)};if(e(n)){let{errorType:o,stack:a,name:s}=n;if(typeof o=="string"&&(i.errorType=o),typeof a=="string"){let c=typeof s=="string"?s:void 0;i.stack=t(a,c)}}return i}var Hs,Us,zy=W(()=>{Hs=class{send(e){}},Us=class{send(e){}sendTelemetryEvent(e,t){}sendErrorEvent(e,t){}sendPerformanceEvent(e,t){}}});var gf,ff,Iy=W(()=>{gf=class{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){this.expiry.policy!=="indefinite"&&this.gcTimeouts.set(e,setTimeout(()=>{this.cleanup(e),this.cancel(e)},this.expiry.durationMs))}cancel(e){let t=this.gcTimeouts.get(e);t!==void 0&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){this.expiry.policy==="sliding"&&(this.cancel(e),this.schedule(e))}},ff=class{constructor({expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}={}){this.cache=new Map,this.removeOnError=t,this.gc=new gf(e,r=>this.remove(r))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}addOrGet(e,t){return v(this,null,function*(){let r=this.get(e);return r===void 0&&(r=v(this,null,function*(){return t()}),this.cache.set(e,r),r.catch(o=>{this.removeOnError(o)&&this.remove(e)}),this.gc.schedule(e)),r})}add(e,t){let r=this.has(e);return this.addOrGet(e,t).catch(()=>{}),!r}addValueOrGet(e,t){return v(this,null,function*(){return this.addOrGet(e,()=>v(this,null,function*(){return t}))})}addValue(e,t){return this.add(e,()=>v(this,null,function*(){return t}))}}});var Ee,Rt,mf=W(()=>{Ee=class{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){this.res!==void 0&&(this.completed=!0,this.res(e))}reject(e){this.rej!==void 0&&(this.completed=!0,this.rej(e))}},Rt=class{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}then(r,i){return v(this,arguments,function*(e,t){return this.getPromise().then(...arguments)})}catch(t){return v(this,arguments,function*(e){return this.getPromise().catch(...arguments)})}finally(t){return v(this,arguments,function*(e){return this.getPromise().finally(...arguments)})}getPromise(){return v(this,null,function*(){return this.result===void 0&&(this.result=this.execute()),this.result})}}});var Ny=z((LY,Ry)=>{function DT(){this.__data__=[],this.size=0}Ry.exports=DT});var Gs=z((jY,By)=>{function FT(n,e){return n===e||n!==n&&e!==e}By.exports=FT});var Ws=z((VY,qy)=>{var TT=Gs();function zT(n,e){for(var t=n.length;t--;)if(TT(n[t][0],e))return t;return-1}qy.exports=zT});var jy=z((HY,Ly)=>{var IT=Ws(),RT=Array.prototype,NT=RT.splice;function BT(n){var e=this.__data__,t=IT(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():NT.call(e,t,1),--this.size,!0}Ly.exports=BT});var Hy=z((UY,Vy)=>{var qT=Ws();function LT(n){var e=this.__data__,t=qT(e,n);return t<0?void 0:e[t][1]}Vy.exports=LT});var Gy=z((GY,Uy)=>{var jT=Ws();function VT(n){return jT(this.__data__,n)>-1}Uy.exports=VT});var Ky=z((WY,Wy)=>{var HT=Ws();function UT(n,e){var t=this.__data__,r=HT(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}Wy.exports=UT});var Ks=z((KY,$y)=>{var GT=Ny(),WT=jy(),KT=Hy(),$T=Gy(),XT=Ky();function Qo(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Qo.prototype.clear=GT;Qo.prototype.delete=WT;Qo.prototype.get=KT;Qo.prototype.has=$T;Qo.prototype.set=XT;$y.exports=Qo});var Jy=z(($Y,Xy)=>{var JT=Ks();function QT(){this.__data__=new JT,this.size=0}Xy.exports=QT});var Yy=z((XY,Qy)=>{function YT(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}Qy.exports=YT});var e1=z((JY,Zy)=>{function ZT(n){return this.__data__.get(n)}Zy.exports=ZT});var n1=z((QY,t1)=>{function e6(n){return this.__data__.has(n)}t1.exports=e6});var vf=z((YY,r1)=>{var t6=typeof global=="object"&&global&&global.Object===Object&&global;r1.exports=t6});var sr=z((ZY,i1)=>{var n6=vf(),r6=typeof self=="object"&&self&&self.Object===Object&&self,i6=n6||r6||Function("return this")();i1.exports=i6});var xd=z((eZ,o1)=>{var o6=sr(),a6=o6.Symbol;o1.exports=a6});var l1=z((tZ,c1)=>{var a1=xd(),s1=Object.prototype,s6=s1.hasOwnProperty,c6=s1.toString,$s=a1?a1.toStringTag:void 0;function l6(n){var e=s6.call(n,$s),t=n[$s];try{n[$s]=void 0;var r=!0}catch{}var i=c6.call(n);return r&&(e?n[$s]=t:delete n[$s]),i}c1.exports=l6});var u1=z((nZ,d1)=>{var d6=Object.prototype,u6=d6.toString;function h6(n){return u6.call(n)}d1.exports=h6});var Yo=z((rZ,g1)=>{var h1=xd(),p6=l1(),g6=u1(),f6="[object Null]",m6="[object Undefined]",p1=h1?h1.toStringTag:void 0;function v6(n){return n==null?n===void 0?m6:f6:p1&&p1 in Object(n)?p6(n):g6(n)}g1.exports=v6});var jr=z((iZ,f1)=>{function b6(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}f1.exports=b6});var _d=z((oZ,m1)=>{var x6=Yo(),_6=jr(),y6="[object AsyncFunction]",C6="[object Function]",w6="[object GeneratorFunction]",P6="[object Proxy]";function O6(n){if(!_6(n))return!1;var e=x6(n);return e==C6||e==w6||e==y6||e==P6}m1.exports=O6});var b1=z((aZ,v1)=>{var M6=sr(),S6=M6["__core-js_shared__"];v1.exports=S6});var y1=z((sZ,_1)=>{var bf=b1(),x1=function(){var n=/[^.]+$/.exec(bf&&bf.keys&&bf.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function E6(n){return!!x1&&x1 in n}_1.exports=E6});var xf=z((cZ,C1)=>{var A6=Function.prototype,k6=A6.toString;function D6(n){if(n!=null){try{return k6.call(n)}catch{}try{return n+""}catch{}}return""}C1.exports=D6});var P1=z((lZ,w1)=>{var F6=_d(),T6=y1(),z6=jr(),I6=xf(),R6=/[\\^$.*+?()[\]{}|]/g,N6=/^\[object .+?Constructor\]$/,B6=Function.prototype,q6=Object.prototype,L6=B6.toString,j6=q6.hasOwnProperty,V6=RegExp("^"+L6.call(j6).replace(R6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function H6(n){if(!z6(n)||T6(n))return!1;var e=F6(n)?V6:N6;return e.test(I6(n))}w1.exports=H6});var M1=z((dZ,O1)=>{function U6(n,e){return n?.[e]}O1.exports=U6});var vi=z((uZ,S1)=>{var G6=P1(),W6=M1();function K6(n,e){var t=W6(n,e);return G6(t)?t:void 0}S1.exports=K6});var yd=z((hZ,E1)=>{var $6=vi(),X6=sr(),J6=$6(X6,"Map");E1.exports=J6});var Xs=z((pZ,A1)=>{var Q6=vi(),Y6=Q6(Object,"create");A1.exports=Y6});var F1=z((gZ,D1)=>{var k1=Xs();function Z6(){this.__data__=k1?k1(null):{},this.size=0}D1.exports=Z6});var z1=z((fZ,T1)=>{function ez(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}T1.exports=ez});var R1=z((mZ,I1)=>{var tz=Xs(),nz="__lodash_hash_undefined__",rz=Object.prototype,iz=rz.hasOwnProperty;function oz(n){var e=this.__data__;if(tz){var t=e[n];return t===nz?void 0:t}return iz.call(e,n)?e[n]:void 0}I1.exports=oz});var B1=z((vZ,N1)=>{var az=Xs(),sz=Object.prototype,cz=sz.hasOwnProperty;function lz(n){var e=this.__data__;return az?e[n]!==void 0:cz.call(e,n)}N1.exports=lz});var L1=z((bZ,q1)=>{var dz=Xs(),uz="__lodash_hash_undefined__";function hz(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=dz&&e===void 0?uz:e,this}q1.exports=hz});var V1=z((xZ,j1)=>{var pz=F1(),gz=z1(),fz=R1(),mz=B1(),vz=L1();function Zo(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Zo.prototype.clear=pz;Zo.prototype.delete=gz;Zo.prototype.get=fz;Zo.prototype.has=mz;Zo.prototype.set=vz;j1.exports=Zo});var G1=z((_Z,U1)=>{var H1=V1(),bz=Ks(),xz=yd();function _z(){this.size=0,this.__data__={hash:new H1,map:new(xz||bz),string:new H1}}U1.exports=_z});var K1=z((yZ,W1)=>{function yz(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}W1.exports=yz});var Js=z((CZ,$1)=>{var Cz=K1();function wz(n,e){var t=n.__data__;return Cz(e)?t[typeof e=="string"?"string":"hash"]:t.map}$1.exports=wz});var J1=z((wZ,X1)=>{var Pz=Js();function Oz(n){var e=Pz(this,n).delete(n);return this.size-=e?1:0,e}X1.exports=Oz});var Y1=z((PZ,Q1)=>{var Mz=Js();function Sz(n){return Mz(this,n).get(n)}Q1.exports=Sz});var eC=z((OZ,Z1)=>{var Ez=Js();function Az(n){return Ez(this,n).has(n)}Z1.exports=Az});var nC=z((MZ,tC)=>{var kz=Js();function Dz(n,e){var t=kz(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}tC.exports=Dz});var iC=z((SZ,rC)=>{var Fz=G1(),Tz=J1(),zz=Y1(),Iz=eC(),Rz=nC();function ea(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}ea.prototype.clear=Fz;ea.prototype.delete=Tz;ea.prototype.get=zz;ea.prototype.has=Iz;ea.prototype.set=Rz;rC.exports=ea});var aC=z((EZ,oC)=>{var Nz=Ks(),Bz=yd(),qz=iC(),Lz=200;function jz(n,e){var t=this.__data__;if(t instanceof Nz){var r=t.__data__;if(!Bz||r.length<Lz-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new qz(r)}return t.set(n,e),this.size=t.size,this}oC.exports=jz});var _f=z((AZ,sC)=>{var Vz=Ks(),Hz=Jy(),Uz=Yy(),Gz=e1(),Wz=n1(),Kz=aC();function ta(n){var e=this.__data__=new Vz(n);this.size=e.size}ta.prototype.clear=Hz;ta.prototype.delete=Uz;ta.prototype.get=Gz;ta.prototype.has=Wz;ta.prototype.set=Kz;sC.exports=ta});var lC=z((kZ,cC)=>{function $z(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}cC.exports=$z});var yf=z((DZ,dC)=>{var Xz=vi(),Jz=function(){try{var n=Xz(Object,"defineProperty");return n({},"",{}),n}catch{}}();dC.exports=Jz});var Cd=z((FZ,hC)=>{var uC=yf();function Qz(n,e,t){e=="__proto__"&&uC?uC(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}hC.exports=Qz});var Cf=z((TZ,pC)=>{var Yz=Cd(),Zz=Gs(),eI=Object.prototype,tI=eI.hasOwnProperty;function nI(n,e,t){var r=n[e];(!(tI.call(n,e)&&Zz(r,t))||t===void 0&&!(e in n))&&Yz(n,e,t)}pC.exports=nI});var na=z((zZ,gC)=>{var rI=Cf(),iI=Cd();function oI(n,e,t,r){var i=!t;t||(t={});for(var o=-1,a=e.length;++o<a;){var s=e[o],c=r?r(t[s],n[s],s,t,n):void 0;c===void 0&&(c=n[s]),i?iI(t,s,c):rI(t,s,c)}return t}gC.exports=oI});var mC=z((IZ,fC)=>{function aI(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}fC.exports=aI});var bi=z((RZ,vC)=>{function sI(n){return n!=null&&typeof n=="object"}vC.exports=sI});var xC=z((NZ,bC)=>{var cI=Yo(),lI=bi(),dI="[object Arguments]";function uI(n){return lI(n)&&cI(n)==dI}bC.exports=uI});var wf=z((BZ,CC)=>{var _C=xC(),hI=bi(),yC=Object.prototype,pI=yC.hasOwnProperty,gI=yC.propertyIsEnumerable,fI=_C(function(){return arguments}())?_C:function(n){return hI(n)&&pI.call(n,"callee")&&!gI.call(n,"callee")};CC.exports=fI});var Qs=z((qZ,wC)=>{var mI=Array.isArray;wC.exports=mI});var OC=z((LZ,PC)=>{function vI(){return!1}PC.exports=vI});var wd=z((Ys,ra)=>{var bI=sr(),xI=OC(),EC=typeof Ys=="object"&&Ys&&!Ys.nodeType&&Ys,MC=EC&&typeof ra=="object"&&ra&&!ra.nodeType&&ra,_I=MC&&MC.exports===EC,SC=_I?bI.Buffer:void 0,yI=SC?SC.isBuffer:void 0,CI=yI||xI;ra.exports=CI});var Pf=z((jZ,AC)=>{var wI=9007199254740991,PI=/^(?:0|[1-9]\d*)$/;function OI(n,e){var t=typeof n;return e=e??wI,!!e&&(t=="number"||t!="symbol"&&PI.test(n))&&n>-1&&n%1==0&&n<e}AC.exports=OI});var Of=z((VZ,kC)=>{var MI=9007199254740991;function SI(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=MI}kC.exports=SI});var FC=z((HZ,DC)=>{var EI=Yo(),AI=Of(),kI=bi(),DI="[object Arguments]",FI="[object Array]",TI="[object Boolean]",zI="[object Date]",II="[object Error]",RI="[object Function]",NI="[object Map]",BI="[object Number]",qI="[object Object]",LI="[object RegExp]",jI="[object Set]",VI="[object String]",HI="[object WeakMap]",UI="[object ArrayBuffer]",GI="[object DataView]",WI="[object Float32Array]",KI="[object Float64Array]",$I="[object Int8Array]",XI="[object Int16Array]",JI="[object Int32Array]",QI="[object Uint8Array]",YI="[object Uint8ClampedArray]",ZI="[object Uint16Array]",e8="[object Uint32Array]",pt={};pt[WI]=pt[KI]=pt[$I]=pt[XI]=pt[JI]=pt[QI]=pt[YI]=pt[ZI]=pt[e8]=!0;pt[DI]=pt[FI]=pt[UI]=pt[TI]=pt[GI]=pt[zI]=pt[II]=pt[RI]=pt[NI]=pt[BI]=pt[qI]=pt[LI]=pt[jI]=pt[VI]=pt[HI]=!1;function t8(n){return kI(n)&&AI(n.length)&&!!pt[EI(n)]}DC.exports=t8});var Pd=z((UZ,TC)=>{function n8(n){return function(e){return n(e)}}TC.exports=n8});var Od=z((Zs,ia)=>{var r8=vf(),zC=typeof Zs=="object"&&Zs&&!Zs.nodeType&&Zs,ec=zC&&typeof ia=="object"&&ia&&!ia.nodeType&&ia,i8=ec&&ec.exports===zC,Mf=i8&&r8.process,o8=function(){try{var n=ec&&ec.require&&ec.require("util").types;return n||Mf&&Mf.binding&&Mf.binding("util")}catch{}}();ia.exports=o8});var Sf=z((GZ,NC)=>{var a8=FC(),s8=Pd(),IC=Od(),RC=IC&&IC.isTypedArray,c8=RC?s8(RC):a8;NC.exports=c8});var Ef=z((WZ,BC)=>{var l8=mC(),d8=wf(),u8=Qs(),h8=wd(),p8=Pf(),g8=Sf(),f8=Object.prototype,m8=f8.hasOwnProperty;function v8(n,e){var t=u8(n),r=!t&&d8(n),i=!t&&!r&&h8(n),o=!t&&!r&&!i&&g8(n),a=t||r||i||o,s=a?l8(n.length,String):[],c=s.length;for(var l in n)(e||m8.call(n,l))&&!(a&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||p8(l,c)))&&s.push(l);return s}BC.exports=v8});var Md=z((KZ,qC)=>{var b8=Object.prototype;function x8(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||b8;return n===t}qC.exports=x8});var Af=z(($Z,LC)=>{function _8(n,e){return function(t){return n(e(t))}}LC.exports=_8});var VC=z((XZ,jC)=>{var y8=Af(),C8=y8(Object.keys,Object);jC.exports=C8});var UC=z((JZ,HC)=>{var w8=Md(),P8=VC(),O8=Object.prototype,M8=O8.hasOwnProperty;function S8(n){if(!w8(n))return P8(n);var e=[];for(var t in Object(n))M8.call(n,t)&&t!="constructor"&&e.push(t);return e}HC.exports=S8});var tc=z((QZ,GC)=>{var E8=_d(),A8=Of();function k8(n){return n!=null&&A8(n.length)&&!E8(n)}GC.exports=k8});var Sd=z((YZ,WC)=>{var D8=Ef(),F8=UC(),T8=tc();function z8(n){return T8(n)?D8(n):F8(n)}WC.exports=z8});var $C=z((ZZ,KC)=>{var I8=na(),R8=Sd();function N8(n,e){return n&&I8(e,R8(e),n)}KC.exports=N8});var JC=z((eee,XC)=>{function B8(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}XC.exports=B8});var YC=z((tee,QC)=>{var q8=jr(),L8=Md(),j8=JC(),V8=Object.prototype,H8=V8.hasOwnProperty;function U8(n){if(!q8(n))return j8(n);var e=L8(n),t=[];for(var r in n)r=="constructor"&&(e||!H8.call(n,r))||t.push(r);return t}QC.exports=U8});var oa=z((nee,ZC)=>{var G8=Ef(),W8=YC(),K8=tc();function $8(n){return K8(n)?G8(n,!0):W8(n)}ZC.exports=$8});var tw=z((ree,ew)=>{var X8=na(),J8=oa();function Q8(n,e){return n&&X8(e,J8(e),n)}ew.exports=Q8});var kf=z((nc,aa)=>{var Y8=sr(),ow=typeof nc=="object"&&nc&&!nc.nodeType&&nc,nw=ow&&typeof aa=="object"&&aa&&!aa.nodeType&&aa,Z8=nw&&nw.exports===ow,rw=Z8?Y8.Buffer:void 0,iw=rw?rw.allocUnsafe:void 0;function eR(n,e){if(e)return n.slice();var t=n.length,r=iw?iw(t):new n.constructor(t);return n.copy(r),r}aa.exports=eR});var Df=z((iee,aw)=>{function tR(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}aw.exports=tR});var cw=z((oee,sw)=>{function nR(n,e){for(var t=-1,r=n==null?0:n.length,i=0,o=[];++t<r;){var a=n[t];e(a,t,n)&&(o[i++]=a)}return o}sw.exports=nR});var Ff=z((aee,lw)=>{function rR(){return[]}lw.exports=rR});var Ed=z((see,uw)=>{var iR=cw(),oR=Ff(),aR=Object.prototype,sR=aR.propertyIsEnumerable,dw=Object.getOwnPropertySymbols,cR=dw?function(n){return n==null?[]:(n=Object(n),iR(dw(n),function(e){return sR.call(n,e)}))}:oR;uw.exports=cR});var pw=z((cee,hw)=>{var lR=na(),dR=Ed();function uR(n,e){return lR(n,dR(n),e)}hw.exports=uR});var Tf=z((lee,gw)=>{function hR(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}gw.exports=hR});var Ad=z((dee,fw)=>{var pR=Af(),gR=pR(Object.getPrototypeOf,Object);fw.exports=gR});var zf=z((uee,mw)=>{var fR=Tf(),mR=Ad(),vR=Ed(),bR=Ff(),xR=Object.getOwnPropertySymbols,_R=xR?function(n){for(var e=[];n;)fR(e,vR(n)),n=mR(n);return e}:bR;mw.exports=_R});var bw=z((hee,vw)=>{var yR=na(),CR=zf();function wR(n,e){return yR(n,CR(n),e)}vw.exports=wR});var If=z((pee,xw)=>{var PR=Tf(),OR=Qs();function MR(n,e,t){var r=e(n);return OR(n)?r:PR(r,t(n))}xw.exports=MR});var yw=z((gee,_w)=>{var SR=If(),ER=Ed(),AR=Sd();function kR(n){return SR(n,AR,ER)}_w.exports=kR});var ww=z((fee,Cw)=>{var DR=If(),FR=zf(),TR=oa();function zR(n){return DR(n,TR,FR)}Cw.exports=zR});var Ow=z((mee,Pw)=>{var IR=vi(),RR=sr(),NR=IR(RR,"DataView");Pw.exports=NR});var Sw=z((vee,Mw)=>{var BR=vi(),qR=sr(),LR=BR(qR,"Promise");Mw.exports=LR});var Aw=z((bee,Ew)=>{var jR=vi(),VR=sr(),HR=jR(VR,"Set");Ew.exports=HR});var Dw=z((xee,kw)=>{var UR=vi(),GR=sr(),WR=UR(GR,"WeakMap");kw.exports=WR});var kd=z((_ee,Bw)=>{var Rf=Ow(),Nf=yd(),Bf=Sw(),qf=Aw(),Lf=Dw(),Nw=Yo(),sa=xf(),Fw="[object Map]",KR="[object Object]",Tw="[object Promise]",zw="[object Set]",Iw="[object WeakMap]",Rw="[object DataView]",$R=sa(Rf),XR=sa(Nf),JR=sa(Bf),QR=sa(qf),YR=sa(Lf),co=Nw;(Rf&&co(new Rf(new ArrayBuffer(1)))!=Rw||Nf&&co(new Nf)!=Fw||Bf&&co(Bf.resolve())!=Tw||qf&&co(new qf)!=zw||Lf&&co(new Lf)!=Iw)&&(co=function(n){var e=Nw(n),t=e==KR?n.constructor:void 0,r=t?sa(t):"";if(r)switch(r){case $R:return Rw;case XR:return Fw;case JR:return Tw;case QR:return zw;case YR:return Iw}return e});Bw.exports=co});var Lw=z((yee,qw)=>{var ZR=Object.prototype,eN=ZR.hasOwnProperty;function tN(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&eN.call(n,"index")&&(t.index=n.index,t.input=n.input),t}qw.exports=tN});var Vw=z((Cee,jw)=>{var nN=sr(),rN=nN.Uint8Array;jw.exports=rN});var Dd=z((wee,Uw)=>{var Hw=Vw();function iN(n){var e=new n.constructor(n.byteLength);return new Hw(e).set(new Hw(n)),e}Uw.exports=iN});var Ww=z((Pee,Gw)=>{var oN=Dd();function aN(n,e){var t=e?oN(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}Gw.exports=aN});var $w=z((Oee,Kw)=>{var sN=/\w*$/;function cN(n){var e=new n.constructor(n.source,sN.exec(n));return e.lastIndex=n.lastIndex,e}Kw.exports=cN});var Zw=z((Mee,Yw)=>{var Xw=xd(),Jw=Xw?Xw.prototype:void 0,Qw=Jw?Jw.valueOf:void 0;function lN(n){return Qw?Object(Qw.call(n)):{}}Yw.exports=lN});var jf=z((See,eP)=>{var dN=Dd();function uN(n,e){var t=e?dN(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}eP.exports=uN});var nP=z((Eee,tP)=>{var hN=Dd(),pN=Ww(),gN=$w(),fN=Zw(),mN=jf(),vN="[object Boolean]",bN="[object Date]",xN="[object Map]",_N="[object Number]",yN="[object RegExp]",CN="[object Set]",wN="[object String]",PN="[object Symbol]",ON="[object ArrayBuffer]",MN="[object DataView]",SN="[object Float32Array]",EN="[object Float64Array]",AN="[object Int8Array]",kN="[object Int16Array]",DN="[object Int32Array]",FN="[object Uint8Array]",TN="[object Uint8ClampedArray]",zN="[object Uint16Array]",IN="[object Uint32Array]";function RN(n,e,t){var r=n.constructor;switch(e){case ON:return hN(n);case vN:case bN:return new r(+n);case MN:return pN(n,t);case SN:case EN:case AN:case kN:case DN:case FN:case TN:case zN:case IN:return mN(n,t);case xN:return new r;case _N:case wN:return new r(n);case yN:return gN(n);case CN:return new r;case PN:return fN(n)}}tP.exports=RN});var oP=z((Aee,iP)=>{var NN=jr(),rP=Object.create,BN=function(){function n(){}return function(e){if(!NN(e))return{};if(rP)return rP(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();iP.exports=BN});var Vf=z((kee,aP)=>{var qN=oP(),LN=Ad(),jN=Md();function VN(n){return typeof n.constructor=="function"&&!jN(n)?qN(LN(n)):{}}aP.exports=VN});var cP=z((Dee,sP)=>{var HN=kd(),UN=bi(),GN="[object Map]";function WN(n){return UN(n)&&HN(n)==GN}sP.exports=WN});var hP=z((Fee,uP)=>{var KN=cP(),$N=Pd(),lP=Od(),dP=lP&&lP.isMap,XN=dP?$N(dP):KN;uP.exports=XN});var gP=z((Tee,pP)=>{var JN=kd(),QN=bi(),YN="[object Set]";function ZN(n){return QN(n)&&JN(n)==YN}pP.exports=ZN});var bP=z((zee,vP)=>{var e7=gP(),t7=Pd(),fP=Od(),mP=fP&&fP.isSet,n7=mP?t7(mP):e7;vP.exports=n7});var wP=z((Iee,CP)=>{var r7=_f(),i7=lC(),o7=Cf(),a7=$C(),s7=tw(),c7=kf(),l7=Df(),d7=pw(),u7=bw(),h7=yw(),p7=ww(),g7=kd(),f7=Lw(),m7=nP(),v7=Vf(),b7=Qs(),x7=wd(),_7=hP(),y7=jr(),C7=bP(),w7=Sd(),P7=oa(),O7=1,M7=2,S7=4,xP="[object Arguments]",E7="[object Array]",A7="[object Boolean]",k7="[object Date]",D7="[object Error]",_P="[object Function]",F7="[object GeneratorFunction]",T7="[object Map]",z7="[object Number]",yP="[object Object]",I7="[object RegExp]",R7="[object Set]",N7="[object String]",B7="[object Symbol]",q7="[object WeakMap]",L7="[object ArrayBuffer]",j7="[object DataView]",V7="[object Float32Array]",H7="[object Float64Array]",U7="[object Int8Array]",G7="[object Int16Array]",W7="[object Int32Array]",K7="[object Uint8Array]",$7="[object Uint8ClampedArray]",X7="[object Uint16Array]",J7="[object Uint32Array]",ot={};ot[xP]=ot[E7]=ot[L7]=ot[j7]=ot[A7]=ot[k7]=ot[V7]=ot[H7]=ot[U7]=ot[G7]=ot[W7]=ot[T7]=ot[z7]=ot[yP]=ot[I7]=ot[R7]=ot[N7]=ot[B7]=ot[K7]=ot[$7]=ot[X7]=ot[J7]=!0;ot[D7]=ot[_P]=ot[q7]=!1;function Fd(n,e,t,r,i,o){var a,s=e&O7,c=e&M7,l=e&S7;if(t&&(a=i?t(n,r,i,o):t(n)),a!==void 0)return a;if(!y7(n))return n;var h=b7(n);if(h){if(a=f7(n),!s)return l7(n,a)}else{var u=g7(n),d=u==_P||u==F7;if(x7(n))return c7(n,s);if(u==yP||u==xP||d&&!i){if(a=c||d?{}:v7(n),!s)return c?u7(n,s7(a,n)):d7(n,a7(a,n))}else{if(!ot[u])return i?n:{};a=m7(n,u,s)}}o||(o=new r7);var p=o.get(n);if(p)return p;o.set(n,a),C7(n)?n.forEach(function(x){a.add(Fd(x,e,t,x,n,o))}):_7(n)&&n.forEach(function(x,b){a.set(b,Fd(x,e,t,b,n,o))});var m=l?c?p7:h7:c?P7:w7,f=h?void 0:m(n);return i7(f||n,function(x,b){f&&(b=x,x=n[b]),o7(a,b,Fd(x,e,t,b,n,o))}),a}CP.exports=Fd});var Td=z((Ree,PP)=>{var Q7=wP(),Y7=1,Z7=4;function eB(n){return Q7(n,Y7|Z7)}PP.exports=eB});var Hf,Uf,OP=W(()=>{Hf=Ce(Td());js();Uf=class{constructor(e,t){typeof e=="number"?(this.ranges=[{length:0,primary:e,secondary:t}],this.lastPrimary=e,this.lastSecondary=t):(this.ranges=(0,Hf.default)(e.ranges),this.lastPrimary=e.lastPrimary,this.lastSecondary=e.lastSecondary)}get base(){return this.ranges[0].primary}get primaryHead(){return this.lastPrimary}get secondaryHead(){return this.lastSecondary}serialize(){return{lastPrimary:this.lastPrimary,lastSecondary:this.lastSecondary,ranges:(0,Hf.default)(this.ranges)}}add(e,t){w(e>=this.lastPrimary,3),this.lastSecondary!==void 0&&w(t>=this.lastSecondary,4),this.lastPrimary=e,this.lastSecondary=t;let r=this.ranges[this.ranges.length-1],i=r.primary+r.length,o=r.secondary+r.length;t!==o&&(e===i?r.length===0?r.secondary=t:(r.length--,this.ranges.push({length:0,primary:e,secondary:t})):i+1===e&&o+1===t?r.length++:this.ranges.push({length:0,primary:e,secondary:t}))}get(e){w(e>=this.ranges[0].primary,5);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);w(e>=this.ranges[t-1].primary,6);let r=this.ranges[t-1];return Math.min(e-r.primary,r.length)+r.secondary}updateBase(e){w(e>=this.ranges[0].primary,7);let t=1;for(;t<this.ranges.length&&!(e<this.ranges[t].primary);t++);w(e>=this.ranges[t-1].primary,8);let r=this.ranges[t-1],i=e-r.primary;r.secondary=r.secondary+Math.min(i,r.length),r.length=Math.max(r.length-i,0),r.primary=e,this.ranges=t-1>0?this.ranges.slice(t-1):this.ranges,w(e===this.ranges[0].primary,9)}}});var Gf,MP=W(()=>{Gf=class{constructor(e){this.windowMSec=e,this.requestMap=new Map}filter(e,t){let r=[],i=Date.now();for(let o of t){let a=`${e}/${o}`;if(!this.requestMap.has(a))this.requestMap.set(a,i),r.push(o);else{if(this.requestMap.get(a)+this.windowMSec>i)continue;this.requestMap.set(a,i),r.push(o)}}return r}}});function tB(n){let e;try{e=JSON.parse(n)}catch{}return e}var SP=W(()=>{});var fn,rc,EP=W(()=>{js();mf();fn=class{constructor(e,t,r=()=>Date.now()){this.defaultTimeout=e,this.defaultHandler=t,this.getCurrentTick=r}get hasTimer(){return!!this.runningState}start(e=this.defaultTimeout,t=this.defaultHandler){this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){var r,i;if(!this.runningState)this.start(e,t);else{let o=e??this.runningState.intendedDuration,a=(i=t??((r=this.runningState.restart)===null||r===void 0?void 0:r.handler))!==null&&i!==void 0?i:this.runningState.handler,s=this.calculateRemainingTime(this.runningState);o<s?this.start(o,a):o===s?(this.runningState.handler=a,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:a}}}startCore(e,t,r){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:setTimeout(()=>this.handler(),e)}}handler(){w(!!this.runningState,10);let e=this.runningState.restart;if(e!==void 0){let t=this.calculateRemainingTime(e);this.startCore(t,()=>e.handler(),e.duration)}else{let t=this.runningState.handler;this.clear(),t()}}calculateRemainingTime(e){let t=this.getCurrentTick()-e.startTick;return e.duration-t}},rc=class{constructor(e,t){this.timer=new fn(e,()=>this.wrapHandler(t))}get hasTimer(){return this.timer.hasTimer}start(e,t){return v(this,null,function*(){return this.clear(),this.deferred=new Ee,this.timer.start(e,t?()=>this.wrapHandler(t):void 0),this.deferred.promise})}clear(){this.timer.clear(),this.deferred&&(this.deferred.resolve({timerResult:"cancel"}),this.deferred=void 0)}wrapHandler(e){e(),w(!!this.deferred,11),this.deferred.resolve({timerResult:"timeout"}),this.deferred=void 0}}});var ca,AP=W(()=>{md();ca=class n{constructor(e){this.startTick=e,this.lastTick=e}static start(){let e=de.now();return new n(e)}trace(){let e=de.now(),t={totalTimeElapsed:e-this.startTick,duration:e-this.lastTick,tick:e};return this.lastTick=e,t}}});function mt(n,e="Unreachable Case"){throw new Error(e)}var kP=W(()=>{});var On,DP=W(()=>{On=class{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}});var FP=W(()=>{});var ic,TP=W(()=>{ic=n=>v(void 0,null,function*(){return new Promise(e=>setTimeout(()=>e(),n))})});function Wf(n){return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}var zP=W(()=>{});var oc={};Zi(oc,{BaseTelemetryNullLogger:()=>Hs,BatchManager:()=>lf,Deferred:()=>Ee,EventForwarder:()=>mi,Heap:()=>hf,IsoBuffer:()=>Wt,Lazy:()=>On,LazyPromise:()=>Rt,NumberComparer:()=>kT,PromiseCache:()=>ff,PromiseTimer:()=>rc,RangeTracker:()=>Uf,RateLimiter:()=>Gf,TelemetryNullLogger:()=>Us,Timer:()=>fn,Trace:()=>ca,TypedEventEmitter:()=>Pe,Uint8ArrayToArrayBuffer:()=>Wf,Uint8ArrayToString:()=>Pn,assert:()=>w,bufferToString:()=>gi,delay:()=>ic,doIfNotDisposed:()=>so,extractLogSafeErrorProperties:()=>pf,fromBase64ToUtf8:()=>cf,fromUtf8ToBase64:()=>Vs,gitHashFile:()=>sf,hashFile:()=>fy,isArrayBuffer:()=>of,performance:()=>de,safelyParseJSON:()=>tB,stringToBuffer:()=>Bn,toUtf8:()=>wT,unreachableCase:()=>mt});var Y=W(()=>{js();md();by();xy();_y();Fy();Ty();zy();Iy();mf();OP();MP();SP();EP();AP();uf();kP();DP();FP();TP();zP();});var NP=z((Nte,RP)=>{var la=1e3,da=la*60,ua=da*60,uo=ua*24,nB=uo*7,rB=uo*365.25;RP.exports=function(n,e){e=e||{};var t=typeof n;if(t==="string"&&n.length>0)return iB(n);if(t==="number"&&isFinite(n))return e.long?aB(n):oB(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function iB(n){if(n=String(n),!(n.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*rB;case"weeks":case"week":case"w":return t*nB;case"days":case"day":case"d":return t*uo;case"hours":case"hour":case"hrs":case"hr":case"h":return t*ua;case"minutes":case"minute":case"mins":case"min":case"m":return t*da;case"seconds":case"second":case"secs":case"sec":case"s":return t*la;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function oB(n){var e=Math.abs(n);return e>=uo?Math.round(n/uo)+"d":e>=ua?Math.round(n/ua)+"h":e>=da?Math.round(n/da)+"m":e>=la?Math.round(n/la)+"s":n+"ms"}function aB(n){var e=Math.abs(n);return e>=uo?Rd(n,e,uo,"day"):e>=ua?Rd(n,e,ua,"hour"):e>=da?Rd(n,e,da,"minute"):e>=la?Rd(n,e,la,"second"):n+" ms"}function Rd(n,e,t,r){var i=e>=t*1.5;return Math.round(n/t)+" "+r+(i?"s":"")}});var qP=z((Bte,BP)=>{function sB(n){t.debug=t,t.default=t,t.coerce=c,t.disable=o,t.enable=i,t.enabled=a,t.humanize=NP(),t.destroy=l,Object.keys(n).forEach(h=>{t[h]=n[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let u=0;for(let d=0;d<h.length;d++)u=(u<<5)-u+h.charCodeAt(d),u|=0;return t.colors[Math.abs(u)%t.colors.length]}t.selectColor=e;function t(h){let u,d=null,p,m;function f(...x){if(!f.enabled)return;let b=f,_=Number(new Date),O=_-(u||_);b.diff=O,b.prev=u,b.curr=_,u=_,x[0]=t.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let S=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(F,I)=>{if(F==="%%")return"%";S++;let y=t.formatters[I];if(typeof y=="function"){let P=x[S];F=y.call(b,P),x.splice(S,1),S--}return F}),t.formatArgs.call(b,x),(b.log||t.log).apply(b,x)}return f.namespace=h,f.useColors=t.useColors(),f.color=t.selectColor(h),f.extend=r,f.destroy=t.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==t.namespaces&&(p=t.namespaces,m=t.enabled(h)),m),set:x=>{d=x}}),typeof t.init=="function"&&t.init(f),f}function r(h,u){let d=t(this.namespace+(typeof u>"u"?":":u)+h);return d.log=this.log,d}function i(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let u,d=(typeof h=="string"?h:"").split(/[\s,]+/),p=d.length;for(u=0;u<p;u++)d[u]&&(h=d[u].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function o(){let h=[...t.names.map(s),...t.skips.map(s).map(u=>"-"+u)].join(",");return t.enable(""),h}function a(h){if(h[h.length-1]==="*")return!0;let u,d;for(u=0,d=t.skips.length;u<d;u++)if(t.skips[u].test(h))return!1;for(u=0,d=t.names.length;u<d;u++)if(t.names[u].test(h))return!0;return!1}function s(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}BP.exports=sB});var $f=z((qn,Nd)=>{qn.formatArgs=lB;qn.save=dB;qn.load=uB;qn.useColors=cB;qn.storage=hB();qn.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();qn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function cB(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function lB(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+Nd.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;n.splice(1,0,e,"color: inherit");let t=0,r=0;n[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(r=t))}),n.splice(r,0,e)}qn.log=console.debug||console.log||(()=>{});function dB(n){try{n?qn.storage.setItem("debug",n):qn.storage.removeItem("debug")}catch{}}function uB(){let n;try{n=qn.storage.getItem("debug")}catch{}return!n&&typeof process<"u"&&"env"in process&&(n=process.env.DEBUG),n}function hB(){try{return localStorage}catch{}}Nd.exports=qP()(qn);var{formatters:pB}=Nd.exports;pB.j=function(n){try{return JSON.stringify(n)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});function LP(n){switch(n){case"boolean":case"number":case"string":return!0;default:return!1}}function jP(n){let e=n,t;if(typeof n=="string")try{e=JSON.parse(n),t={raw:n,string:n}}catch{}if(e===void 0)return t;let r=typeof e;if(LP(r))return Object.assign(Object.assign({},t),{raw:n,[r]:e});if(Array.isArray(e)){let i=typeof e[0];if(!LP(i))return t;for(let o of e)if(typeof o!==i)return t;return Object.assign(Object.assign({},t),{raw:n,[`${i}[]`]:e})}return t}function Bd(n){let e=n;return VP(e?.config)&&e?.logger!==void 0}function Mn(n){return Bd(n)?n:ho(n,lc.value)}function ho(n,...e){if(Bd(n))throw new Error("Logger is already a monitoring context");let t=n;return t.config=new ha(...e),t.logger=n,t}function VP(n){let e=n;return typeof e?.getRawConfig=="function"}var lc,gB,fB,mB,ha,Xf=W(()=>{Y();lc=new On(()=>fB(mB())),gB={getRawConfig:()=>{}},fB=n=>n!=null?new ha({getRawConfig:e=>{var t,r;try{return(r=jP((t=n.getItem(e))!==null&&t!==void 0?t:void 0))===null||r===void 0?void 0:r.raw}catch{}}}):gB;mB=()=>{try{return sessionStorage!==null?sessionStorage:void 0}catch{return}},ha=class n{constructor(...e){this.configCache=new Map,this.orderedBaseProviders=[];let t=new Set,r=[...e];for(;r.length>0;){let i=r.shift();i!==void 0&&VP(i)&&!t.has(i)&&(t.add(i),i instanceof n?r.push(...i.orderedBaseProviders):this.orderedBaseProviders.push(i))}}getBoolean(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.boolean}getNumber(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.number}getString(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.string}getBooleanArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["boolean[]"]}getNumberArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["number[]"]}getStringArray(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t["string[]"]}getRawConfig(e){var t;return(t=this.getCacheEntry(e))===null||t===void 0?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(let t of this.orderedBaseProviders){let r=jP(t?.getRawConfig(e));if(r!==void 0)return this.configCache.set(e,r),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}});function dc(){if(!qd&&(qd=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!qd))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qd(vB)}var qd,vB,Jf=W(()=>{vB=new Uint8Array(16)});var HP,UP=W(()=>{HP=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function bB(n){return typeof n=="string"&&HP.test(n)}var yi,uc=W(()=>{UP();yi=bB});function xB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Kt[n[e+0]]+Kt[n[e+1]]+Kt[n[e+2]]+Kt[n[e+3]]+"-"+Kt[n[e+4]]+Kt[n[e+5]]+"-"+Kt[n[e+6]]+Kt[n[e+7]]+"-"+Kt[n[e+8]]+Kt[n[e+9]]+"-"+Kt[n[e+10]]+Kt[n[e+11]]+Kt[n[e+12]]+Kt[n[e+13]]+Kt[n[e+14]]+Kt[n[e+15]]).toLowerCase();if(!yi(t))throw TypeError("Stringified UUID is invalid");return t}var Kt,Ld,Ci,hc=W(()=>{uc();Kt=[];for(Ld=0;Ld<256;++Ld)Kt.push((Ld+256).toString(16).substr(1));Ci=xB});function _B(n,e,t){var r=e&&t||0,i=e||new Array(16);n=n||{};var o=n.node||GP,a=n.clockseq!==void 0?n.clockseq:Qf;if(o==null||a==null){var s=n.random||(n.rng||dc)();o==null&&(o=GP=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),a==null&&(a=Qf=(s[6]<<8|s[7])&16383)}var c=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:Zf+1,h=c-Yf+(l-Zf)/1e4;if(h<0&&n.clockseq===void 0&&(a=a+1&16383),(h<0||c>Yf)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Yf=c,Zf=l,Qf=a,c+=122192928e5;var u=((c&268435455)*1e4+l)%4294967296;i[r++]=u>>>24&255,i[r++]=u>>>16&255,i[r++]=u>>>8&255,i[r++]=u&255;var d=c/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=d&255,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=a>>>8|128,i[r++]=a&255;for(var p=0;p<6;++p)i[r+p]=o[p];return e||Ci(i)}var GP,Qf,Yf,Zf,WP,KP=W(()=>{Jf();hc();Yf=0,Zf=0;WP=_B});function yB(n){if(!yi(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var jd,em=W(()=>{uc();jd=yB});function CB(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}function Vd(n,e,t){function r(i,o,a,s){if(typeof i=="string"&&(i=CB(i)),typeof o=="string"&&(o=jd(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,a){s=s||0;for(var l=0;l<16;++l)a[s+l]=c[l];return a}return Ci(c)}try{r.name=n}catch{}return r.DNS=wB,r.URL=PB,r}var wB,PB,tm=W(()=>{hc();em();wB="6ba7b810-9dad-11d1-80b4-00c04fd430c8",PB="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});function OB(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return MB(SB(EB(n),n.length*8))}function MB(n){for(var e=[],t=n.length*32,r="0123456789abcdef",i=0;i<t;i+=8){var o=n[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);e.push(a)}return e}function $P(n){return(n+64>>>9<<4)+14+1}function SB(n,e){n[e>>5]|=128<<e%32,n[$P(e)-1]=e;for(var t=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<n.length;a+=16){var s=t,c=r,l=i,h=o;t=rn(t,r,i,o,n[a],7,-680876936),o=rn(o,t,r,i,n[a+1],12,-389564586),i=rn(i,o,t,r,n[a+2],17,606105819),r=rn(r,i,o,t,n[a+3],22,-1044525330),t=rn(t,r,i,o,n[a+4],7,-176418897),o=rn(o,t,r,i,n[a+5],12,1200080426),i=rn(i,o,t,r,n[a+6],17,-1473231341),r=rn(r,i,o,t,n[a+7],22,-45705983),t=rn(t,r,i,o,n[a+8],7,1770035416),o=rn(o,t,r,i,n[a+9],12,-1958414417),i=rn(i,o,t,r,n[a+10],17,-42063),r=rn(r,i,o,t,n[a+11],22,-1990404162),t=rn(t,r,i,o,n[a+12],7,1804603682),o=rn(o,t,r,i,n[a+13],12,-40341101),i=rn(i,o,t,r,n[a+14],17,-1502002290),r=rn(r,i,o,t,n[a+15],22,1236535329),t=on(t,r,i,o,n[a+1],5,-165796510),o=on(o,t,r,i,n[a+6],9,-1069501632),i=on(i,o,t,r,n[a+11],14,643717713),r=on(r,i,o,t,n[a],20,-373897302),t=on(t,r,i,o,n[a+5],5,-701558691),o=on(o,t,r,i,n[a+10],9,38016083),i=on(i,o,t,r,n[a+15],14,-660478335),r=on(r,i,o,t,n[a+4],20,-405537848),t=on(t,r,i,o,n[a+9],5,568446438),o=on(o,t,r,i,n[a+14],9,-1019803690),i=on(i,o,t,r,n[a+3],14,-187363961),r=on(r,i,o,t,n[a+8],20,1163531501),t=on(t,r,i,o,n[a+13],5,-1444681467),o=on(o,t,r,i,n[a+2],9,-51403784),i=on(i,o,t,r,n[a+7],14,1735328473),r=on(r,i,o,t,n[a+12],20,-1926607734),t=an(t,r,i,o,n[a+5],4,-378558),o=an(o,t,r,i,n[a+8],11,-2022574463),i=an(i,o,t,r,n[a+11],16,1839030562),r=an(r,i,o,t,n[a+14],23,-35309556),t=an(t,r,i,o,n[a+1],4,-1530992060),o=an(o,t,r,i,n[a+4],11,1272893353),i=an(i,o,t,r,n[a+7],16,-155497632),r=an(r,i,o,t,n[a+10],23,-1094730640),t=an(t,r,i,o,n[a+13],4,681279174),o=an(o,t,r,i,n[a],11,-358537222),i=an(i,o,t,r,n[a+3],16,-722521979),r=an(r,i,o,t,n[a+6],23,76029189),t=an(t,r,i,o,n[a+9],4,-640364487),o=an(o,t,r,i,n[a+12],11,-421815835),i=an(i,o,t,r,n[a+15],16,530742520),r=an(r,i,o,t,n[a+2],23,-995338651),t=sn(t,r,i,o,n[a],6,-198630844),o=sn(o,t,r,i,n[a+7],10,1126891415),i=sn(i,o,t,r,n[a+14],15,-1416354905),r=sn(r,i,o,t,n[a+5],21,-57434055),t=sn(t,r,i,o,n[a+12],6,1700485571),o=sn(o,t,r,i,n[a+3],10,-1894986606),i=sn(i,o,t,r,n[a+10],15,-1051523),r=sn(r,i,o,t,n[a+1],21,-2054922799),t=sn(t,r,i,o,n[a+8],6,1873313359),o=sn(o,t,r,i,n[a+15],10,-30611744),i=sn(i,o,t,r,n[a+6],15,-1560198380),r=sn(r,i,o,t,n[a+13],21,1309151649),t=sn(t,r,i,o,n[a+4],6,-145523070),o=sn(o,t,r,i,n[a+11],10,-1120210379),i=sn(i,o,t,r,n[a+2],15,718787259),r=sn(r,i,o,t,n[a+9],21,-343485551),t=wi(t,s),r=wi(r,c),i=wi(i,l),o=wi(o,h)}return[t,r,i,o]}function EB(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array($P(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function wi(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function AB(n,e){return n<<e|n>>>32-e}function Hd(n,e,t,r,i,o){return wi(AB(wi(wi(e,n),wi(r,o)),i),t)}function rn(n,e,t,r,i,o,a){return Hd(e&t|~e&r,n,e,i,o,a)}function on(n,e,t,r,i,o,a){return Hd(e&r|t&~r,n,e,i,o,a)}function an(n,e,t,r,i,o,a){return Hd(e^t^r,n,e,i,o,a)}function sn(n,e,t,r,i,o,a){return Hd(t^(e|~r),n,e,i,o,a)}var XP,JP=W(()=>{XP=OB});var kB,QP,YP=W(()=>{tm();JP();kB=Vd("v3",48,XP),QP=kB});function DB(n,e,t){n=n||{};var r=n.random||(n.rng||dc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=r[i];return e}return Ci(r)}var ke,ZP=W(()=>{Jf();hc();ke=DB});function FB(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function nm(n,e){return n<<e|n>>>32-e}function TB(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var i=0;i<r.length;++i)n.push(r.charCodeAt(i))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var o=n.length/4+2,a=Math.ceil(o/16),s=new Array(a),c=0;c<a;++c){for(var l=new Uint32Array(16),h=0;h<16;++h)l[h]=n[c*64+h*4]<<24|n[c*64+h*4+1]<<16|n[c*64+h*4+2]<<8|n[c*64+h*4+3];s[c]=l}s[a-1][14]=(n.length-1)*8/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=(n.length-1)*8&4294967295;for(var u=0;u<a;++u){for(var d=new Uint32Array(80),p=0;p<16;++p)d[p]=s[u][p];for(var m=16;m<80;++m)d[m]=nm(d[m-3]^d[m-8]^d[m-14]^d[m-16],1);for(var f=t[0],x=t[1],b=t[2],_=t[3],O=t[4],S=0;S<80;++S){var E=Math.floor(S/20),F=nm(f,5)+FB(E,x,b,_)+O+e[E]+d[S]>>>0;O=_,_=b,b=nm(x,30)>>>0,x=f,f=F}t[0]=t[0]+f>>>0,t[1]=t[1]+x>>>0,t[2]=t[2]+b>>>0,t[3]=t[3]+_>>>0,t[4]=t[4]+O>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var eO,tO=W(()=>{eO=TB});var zB,nO,rO=W(()=>{tm();tO();zB=Vd("v5",80,eO),nO=zB});var iO,oO=W(()=>{iO="00000000-0000-0000-0000-000000000000"});function IB(n){if(!yi(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}var aO,sO=W(()=>{uc();aO=IB});var pc={};Zi(pc,{NIL:()=>iO,parse:()=>jd,stringify:()=>Ci,v1:()=>WP,v3:()=>QP,v4:()=>ke,v5:()=>nO,validate:()=>yi,version:()=>aO});var Nt=W(()=>{KP();YP();ZP();rO();oO();sO();uc();hc();em()});function gc(n){return typeof n?.errorType=="string"&&typeof n?.message=="string"&&Ud(n)&&cO(n)}function Gd(n){return typeof n?.errorType=="string"&&typeof n?.message=="string"&&cO(n)}var cO,Ud,rm=W(()=>{cO=n=>typeof n?.getTelemetryProperties=="function"&&typeof n?.addTelemetryProperties=="function",Ud=n=>typeof n?.errorInstanceId=="string"});function fc(n,e){let t=(o,a)=>{if(!e)return o;let s=o.split(`
`);return s.shift(),a!==void 0&&s.unshift(a),s.join(`
`)},i={message:typeof n?.message=="string"?n.message:String(n)};if(RB(n)){let{errorType:o,stack:a,name:s}=n;if(typeof o=="string"&&(i.errorType=o),typeof a=="string"){let c=typeof s=="string"?s:void 0;i.stack=t(a,c)}}return i}function NB(n,e){for(let t of Object.keys(e))n[t]===void 0&&(n[t]=e[t])}function BB(n){let e=n;e.errorInstanceId===void 0&&(e.errorInstanceId=ke())}function cn(n,e={}){var t;if(Gd(n)&&BB(n),gc(n))return n.addTelemetryProperties((t=e.props)!==null&&t!==void 0?t:{}),n;let{message:r,stack:i}=fc(n,!1),o=new uO({message:r,stack:i});if(typeof n=="object"&&n!==null){let{canRetry:s,retryAfterSeconds:c}=n;Object.assign(cn,{canRetry:s,retryAfterSeconds:c})}typeof n!="object"&&o.addTelemetryProperties({typeofError:typeof n});let a=mc(n)?n.getTelemetryProperties():{};return o.addTelemetryProperties(Object.assign(Object.assign(Object.assign({},a),e.props),{untrustedOrigin:1})),o}function pa(){let n=new Error("<<generated stack>>");if(im===void 0&&(im=n.stack!==void 0),im)return n;try{throw n}catch(e){return e}}function om(){return pa().stack}function Pi(n,e){let{message:t,stack:r}=fc(n,!1),i=e(t);return r!==void 0&&lO(i,r),Wd(n)&&i.addTelemetryProperties({untrustedOrigin:1}),Ud(n)&&(i.overwriteErrorInstanceId(n.errorInstanceId),i.addTelemetryProperties({innerErrorInstanceId:n.errorInstanceId})),mc(n)&&i.addTelemetryProperties(n.getTelemetryProperties()),i}function vc(n,e,t){let r=Pi(n,e),i=r.errorInstanceId,o=i;return t.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:i,wrappedByErrorInstanceId:o},n),r}function lO(n,e){try{Object.assign(n,{stack:e})}catch{n.addTelemetryProperties({stack2:e})}}function Wd(n){return!Gd(n)||n.getTelemetryProperties().untrustedOrigin===1&&n.errorType===uO.normalizedErrorType}function dO(n){return typeof n?.value!="object"&&typeof n?.tag=="string"}function qB(n,e){let t={};for(let r of Object.keys(n)){if(e.has(r))continue;let i=n[r];switch(typeof i){case"string":case"number":case"boolean":case"undefined":t[r]=i;break;default:{dO(i)?t[r]=i:t[r]="REDACTED (arbitrary object)";break}}}return t}var RB,mc,im,am,Be,uO,sm=W(()=>{Nt();rm();RB=n=>n!==null&&!Array.isArray(n)&&typeof n=="object";mc=n=>typeof n?.getTelemetryProperties=="function";am=()=>{let n=new WeakSet;return(e,t)=>{if(typeof t=="object"&&t!==null){if(n.has(t))return"<removed/circular>";n.add(t)}return t}},Be=class extends Error{constructor(e,t,r=new Set){super(e),this.omitPropsFromLogging=r,this._errorInstanceId=ke(),this.fluidErrorCode="-",r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}addTelemetryProperties(e){NB(this,e)}getTelemetryProperties(){let e=qB(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}},uO=(()=>{class n extends Be{constructor(t){super(t.message),this.errorType=n.normalizedErrorType,t.stack!==void 0&&lO(this,t.stack)}}return n.normalizedErrorType="genericError",n})()});var Ne,at,bc,ue,xc,le,cm,Kd=W(()=>{Y();Xf();sm();Ne=function(n){return n.PackageData="PackageData",n.CodeArtifact="CodeArtifact",n.UserData="UserData",n}(Ne||{}),at=(()=>{class n{constructor(t,r){this.namespace=t,this.properties=r}static formatTick(t){return Math.floor(t)}static numberFromString(t){if(t==null)return;let r=Number(t);return Number.isNaN(r)?t:r}static sanitizePkgName(t){return t.replace("@","").replace("/","-")}static prepareErrorObject(t,r,i){let{message:o,errorType:a,stack:s}=fc(r,!0);if(t.stack=s,t.error=o,t.errorType=a,mc(r)){let c=r.getTelemetryProperties();for(let l of Object.keys(c))t[l]===void 0&&(t[l]=c[l])}t.stack===void 0&&i&&(t.stack=om())}sendTelemetryEvent(t,r){var i;this.sendTelemetryEventCore(Object.assign(Object.assign({},t),{category:(i=t.category)!==null&&i!==void 0?i:"generic"}),r)}sendTelemetryEventCore(t,r){let i=Object.assign({},t);r!==void 0&&n.prepareErrorObject(i,r,!1),typeof i.duration=="number"&&(i.duration=n.formatTick(i.duration)),this.send(i)}sendErrorEvent(t,r){this.sendTelemetryEventCore(Object.assign(Object.assign({error:t.eventName},t),{category:"error"}),r)}sendPerformanceEvent(t,r){var i;let o=Object.assign(Object.assign({},t),{category:(i=t.category)!==null&&i!==void 0?i:"performance"});this.sendTelemetryEventCore(o,r)}prepareEvent(t){let r=t.category==="error"||t.error!==void 0,i=Object.assign({},t);if(this.namespace!==void 0&&(i.eventName=`${this.namespace}${n.eventNamespaceSeparator}${i.eventName}`),this.properties){let o=[];o.push(this.properties.all),r&&o.push(this.properties.error);for(let a of o)if(a!==void 0)for(let s of Object.keys(a)){if(t[s]!==void 0)continue;let c=a[s],l=typeof c=="function"?c():c;l!==void 0&&(i[s]=l)}}return i}}return n.eventNamespaceSeparator=":",n})(),bc=class{constructor(e){this.logger=e}send(e){let t={category:e.category,eventName:e.eventName};for(let r of Object.keys(e)){let i=e[r],{value:o,tag:a}=typeof i=="object"?i:{value:i,tag:void 0};switch(a){case void 0:t[r]=o;break;case Ne.PackageData:t[r]=o;break;case Ne.UserData:t[r]="REDACTED (UserData)";break;default:t[r]="REDACTED (unknown tag)";break}}this.logger.send(t)}},ue=class n extends at{constructor(e,t,r){super(t,r),this.baseLogger=e,Bd(e)&&ho(this,new ha(e.config))}static create(e,t,r){if(e instanceof n){let i={};for(let a of[e.properties,r])a!==void 0&&(a.all!==void 0&&(i.all=Object.assign(Object.assign({},i.all),a.all)),a.error!==void 0&&(i.error=Object.assign(Object.assign({},i.error),a.error)));let o=e.namespace===void 0?t:t===void 0?e.namespace:`${e.namespace}${at.eventNamespaceSeparator}${t}`;return new n(e.baseLogger,o,i)}return new n(e||new Hs,t,r)}send(e){this.baseLogger.send(this.prepareEvent(e))}},xc=class extends at{constructor(e,t){super(e,t),this.loggers=[]}addLogger(e){e!=null&&this.loggers.push(e)}send(e){let t=this.prepareEvent(e);this.loggers.forEach(r=>{r.send(t)})}},le=class n{constructor(e,t,r={end:!0,cancel:"generic"}){this.logger=e,this.markers=r,this.startTime=de.now(),this.event=Object.assign({},t),this.markers.start&&this.reportEvent("start"),typeof window=="object"&&window!=null&&window.performance&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}static start(e,t,r){return new n(e,t,r)}static timedExec(e,t,r,i){let o=n.start(e,t,i);try{let a=r(o);return o.autoEnd(),a}catch(a){throw o.cancel(void 0,a),a}}static timedExecAsync(e,t,r,i){return v(this,null,function*(){let o=n.start(e,t,i);try{let a=yield r(o);return o.autoEnd(),a}catch(a){throw o.cancel(void 0,a),a}})}get duration(){return de.now()-this.startTime}reportProgress(e,t="update"){this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(this.startMark&&this.event){let e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){this.markers.cancel!==void 0&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;let i=Object.assign(Object.assign({},this.event),t);i.eventName=`${i.eventName}_${e}`,e!=="start"&&(i.duration=this.duration),this.logger.sendPerformanceEvent(i,r)}},cm=class{send(e){}sendTelemetryEvent(e,t){}sendErrorEvent(e,t){this.reportError("errorEvent in UT logger!",e,t)}sendPerformanceEvent(e,t){}logGenericError(e,t){this.reportError("genericError in UT logger!",{eventName:e},t)}logException(e,t){this.reportError("exception in UT logger!",e,t)}debugAssert(e,t){this.reportError("debugAssert in UT logger!")}shipAssert(e,t){this.reportError("shipAssert in UT logger!")}reportError(e,t,r){let i=new Error(e);throw i.error=i,i.event=t,console.error(e),console.error(i),i}}});var lm,_c,hO=W(()=>{Y();lm=Ce($f());Kd();_c=class n extends at{constructor(e,t,r){super(void 0,r),this.debug=e,this.debugErr=t}static create(e,t){let r=(0,lm.debug)(e),i=(0,lm.debug)(e);return i.log=console.error.bind(console),i.enabled=!0,new n(r,i,t)}static mixinDebugLogger(e,t,r){if(!t)return n.create(e,r);let i=new xc(void 0,r);return i.addLogger(n.create(e,this.tryGetBaseLoggerProps(t))),i.addLogger(ue.create(t,e)),i}static tryGetBaseLoggerProps(e){if(e instanceof at)return e.properties}send(e){let t=this.prepareEvent(e),r=t.category==="error",i=r?this.debugErr:this.debug,o=e.eventName.lastIndexOf(at.eventNamespaceSeparator),a=e.eventName.substring(o+1);o>0&&(i=i.extend(e.eventName.substring(0,o))),t.eventName=void 0;let s="";s=`tick=${at.formatTick(de.now())}`;let c=t.stack?t.stack:"";t.stack=void 0;let l;try{l=JSON.stringify(t)}catch{t.error=void 0,l=JSON.stringify(t)}l==="{}"&&(l=""),r&&(i.enabled=!0),i(`${a} ${l} ${s} ${c}`)}}});var Vr,pO=W(()=>{Y();Vr=class extends Pe{constructor(e){super(),this.errorHandler=e}emit(e,...t){try{return super.emit(e,...t)}catch(r){return this.errorHandler(e,r),!0}}}});function dm(n,e,t,...r){try{n.emit(t,...r)}catch(i){e.sendErrorEvent({eventName:"RaiseEventError",event:t},i)}}function po(n,e,t,r){try{t?e.emit($d,r):e.emit(Xd)}catch(i){n.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}var $d,Xd,gO=W(()=>{$d="connected",Xd="disconnected"});var um,fO=W(()=>{Kd();um=class n extends at{constructor(){super(),this.events=[]}clear(){this.events=[]}send(e){this.events.push(e)}matchEvents(e){let t=this.getMatchedEventsCount(e);return e.length-t===0}assertMatch(e,t){let r=this.events;if(!this.matchEvents(e))throw new Error(`${t}
expected:
${JSON.stringify(e)}

actual:
${JSON.stringify(r)}`)}matchAnyEvent(e){return this.getMatchedEventsCount(e)>0}assertMatchAny(e,t){let r=this.events;if(!this.matchAnyEvent(e))throw new Error(`${t}
expected:
${JSON.stringify(e)}

actual:
${JSON.stringify(r)}`)}getMatchedEventsCount(e){let t=0;return this.events.forEach(r=>{t<e.length&&n.eventsMatch(r,e[t])&&++t}),this.events=[],t}static eventsMatch(e,t){let r=Object.assign(Object.assign({},e),t);return JSON.stringify(r)===JSON.stringify(e)}}});var go,mO=W(()=>{go=class{constructor(e,t,r=e){this.threshold=e,this.logger=t,this.thresholdMultiple=r}send(e,t){t<this.threshold||this.logger.sendPerformanceEvent({eventName:e,value:t})}sendIfMultiple(e,t){t===this.thresholdMultiple&&(this.logger.sendPerformanceEvent({eventName:e,value:t}),this.thresholdMultiple=this.thresholdMultiple*2)}}});function hm(n,e,t){if(n)return!0;let r=typeof t=="string"?{eventName:t,category:"error"}:Object.assign({category:"error"},t);return e.send(r),!1}var vO=W(()=>{});var ga,bO=W(()=>{Y();ga=class{constructor(e,t,r,i=!1,o=new Map){this.eventBase=e,this.logger=t,this.sampleThreshold=r,this.includeAggregateMetrics=i,this.perBucketProperties=o,this.disposed=!1,this.measurementsMap=new Map}measure(e,t=""){var r,i,o;let a=de.now(),s=e(),c=de.now()-a,l=this.measurementsMap.get(t);return l===void 0&&(l={count:0,duration:-1},this.measurementsMap.set(t,l)),l.count++,l.duration=c,this.includeAggregateMetrics&&(l.totalDuration=((r=l.totalDuration)!==null&&r!==void 0?r:0)+c,l.minDuration=Math.min((i=l.minDuration)!==null&&i!==void 0?i:c,c),l.maxDuration=Math.max((o=l.maxDuration)!==null&&o!==void 0?o:0,c)),l.count>=this.sampleThreshold&&this.flushBucket(t),s}flushBucket(e){let t=this.measurementsMap.get(e);if(t!==void 0&&t.count!==0){let r=this.perBucketProperties.get(e),i=Object.assign(Object.assign(Object.assign({},this.eventBase),r),t);this.logger.sendPerformanceEvent(i),this.measurementsMap.delete(e)}}dispose(e){this.measurementsMap.forEach((t,r)=>this.flushBucket(r))}}});var pm={};Zi(pm,{ChildLogger:()=>ue,DebugLogger:()=>_c,EventEmitterWithErrorHandling:()=>Vr,LoggingError:()=>Be,MockLogger:()=>um,MultiSinkLogger:()=>xc,PerformanceEvent:()=>le,SampledTelemetryHelper:()=>ga,TaggedLoggerAdapter:()=>bc,TelemetryDataTag:()=>Ne,TelemetryLogger:()=>at,TelemetryUTLogger:()=>cm,ThresholdCounter:()=>go,connectedEventName:()=>$d,disconnectedEventName:()=>Xd,extractLogSafeErrorProperties:()=>fc,generateErrorWithStack:()=>pa,generateStack:()=>om,getCircularReplacer:()=>am,hasErrorInstanceId:()=>Ud,isExternalError:()=>Wd,isFluidError:()=>gc,isILoggingError:()=>mc,isTaggedTelemetryPropertyValue:()=>dO,isValidLegacyError:()=>Gd,logIfFalse:()=>hm,loggerToMonitoringContext:()=>Mn,mixinMonitoringContext:()=>ho,normalizeError:()=>cn,raiseConnectedEvent:()=>po,safeRaiseEvent:()=>dm,sessionStorageConfigProvider:()=>lc,wrapError:()=>Pi,wrapErrorAndLog:()=>vc});var Oe=W(()=>{hO();sm();pO();gO();rm();Kd();fO();mO();vO();bO();Xf();});var xO=W(()=>{});var _O=W(()=>{});var yO=W(()=>{});var Oi,CO=W(()=>{Oi=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(Oi||{})});var fo,yc,wO=W(()=>{fo=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(fo||{}),yc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(yc||{})});var wr,PO=W(()=>{wr=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(wr||{})});var OO=W(()=>{});var MO=W(()=>{});var SO=W(()=>{});var EO=W(()=>{});var gm=W(()=>{xO();_O();yO();CO();wO();PO();OO();MO();SO();EO();});function AO(n){let e=n.type===wr.Handle?n.handleType:n.type;switch(e){case wr.Blob:case wr.Attachment:return fo.File;case wr.Tree:return fo.Directory;default:mt(e,`Unknown type: ${e}`)}}function Yd(n){let e=n.type===wr.Handle?n.handleType:n.type;switch(e){case wr.Blob:case wr.Attachment:return"blob";case wr.Tree:return"tree";default:mt(e,`Unknown type: ${e}`)}}function ma(n,e=new Map,t=!1){let r={},i={id:n.sha,blobs:{},trees:{}};r[""]=i;for(let o of n.tree){let a=t?o.path.replace(/^\.app\//,""):o.path,s=a.lastIndexOf("/"),c=a.slice(0,Math.max(0,s)),l=a.slice(s+1),h=r[c];if(o.type==="tree"){let u={id:o.sha,blobs:{},commits:{},trees:{}};h.trees[decodeURIComponent(l)]=u,r[a]=u}else if(o.type==="blob")h.blobs[decodeURIComponent(l)]=o.sha,e.set(o.sha,`/${a}`);else throw new Error("Unknown entry type!!")}return i}var fa,Jd,Qd,kO=W(()=>{gm();Y();fa=class{constructor(e,t,r="utf-8"){this.path=e,this.mode=fo.File,this.type=yc.Blob,this.value={contents:t,encoding:r}}},Jd=class{constructor(e,t){this.path=e,this.value=t,this.mode=fo.Directory,this.type=yc.Tree}},Qd=class{constructor(e,t){this.path=e,this.id=t,this.mode=fo.File,this.type=yc.Attachment,this.value={id:t}}}});var DO,Zd,eu,fm,mm,tu,vm=W(()=>{DO=Ce(fi()),Zd=Ce(Td());Y();eu=class{constructor(e,t,r,i){this.sequenceNumber=e,this.key=t,this.value=r,this.local=i}},fm=class extends Pe{constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}get disposed(){return this.isDisposed}snapshot(){var e;return(e=this.snapshotCache)!==null&&e!==void 0||(this.snapshotCache=(0,Zd.default)(Array.from(this.members))),this.snapshotCache}addMember(e,t){w(!this.members.has(e),462),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){w(this.members.has(e),463),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}},mm=class extends Pe{constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new DO.EventEmitter,this.proposals=new Map(e.proposals.map(([,r])=>[r.sequenceNumber,new eu(r.sequenceNumber,r.key,r.value,!1)])),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}get disposed(){return this.isDisposed}snapshot(){var e,t;return(e=this.proposalsSnapshotCache)!==null&&e!==void 0||(this.proposalsSnapshotCache=Array.from(this.proposals).map(([r,i])=>[r,{sequenceNumber:r,key:i.key,value:i.value},[]])),(t=this.valuesSnapshotCache)!==null&&t!==void 0||(this.valuesSnapshotCache=(0,Zd.default)(Array.from(this.values))),{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){var t;return(t=this.values.get(e))===null||t===void 0?void 0:t.value}getApprovalData(e){let t=this.values.get(e);return t?(0,Zd.default)(t):void 0}propose(e,t){return v(this,null,function*(){let r=this.sendProposal(e,t);if(r<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise((i,o)=>{let a,s=(d,p)=>{d===r&&(a=p,this.stateEvents.off("localProposalSequenced",s),this.stateEvents.off("disconnected",l),this.stateEvents.on("localProposalApproved",c))},c=d=>{d===a&&(i(),u())},l=()=>{a===void 0&&this.stateEvents.once("connected",()=>{a===void 0&&(o(new Error("Client disconnected without successfully sending proposal")),u())})},h=()=>{o(new Error("QuorumProposals was disposed")),u()},u=()=>{this.stateEvents.off("localProposalSequenced",s),this.stateEvents.off("localProposalApproved",c),this.stateEvents.off("disconnected",l),this.stateEvents.off("disposed",h)};this.stateEvents.on("localProposalSequenced",s),this.stateEvents.on("disconnected",l),this.stateEvents.on("disposed",h)})})}addProposal(e,t,r,i,o){w(!this.proposals.has(r),464);let a=new eu(r,e,t,i);this.proposals.set(r,a),this.emit("addProposal",a),i&&this.stateEvents.emit("localProposalSequenced",o,r),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){let t=e.minimumSequenceNumber,r=[];for(let[i,o]of this.proposals)i<=t&&r.push(o);r.sort((i,o)=>i.sequenceNumber-o.sequenceNumber);for(let i of r){let o={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:i.key,sequenceNumber:i.sequenceNumber,value:i.value};this.values.set(o.key,o),this.valuesSnapshotCache=void 0,this.emit("approveProposal",o.sequenceNumber,o.key,o.value,o.approvalSequenceNumber),this.proposals.delete(i.sequenceNumber),this.proposalsSnapshotCache=void 0,i.local&&this.stateEvents.emit("localProposalApproved",i.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}},tu=class extends Pe{constructor(e,t,r,i){super(),this.isDisposed=!1,this.quorumClients=new fm(e),this.quorumClients.on("addMember",(o,a)=>{this.emit("addMember",o,a)}),this.quorumClients.on("removeMember",o=>{this.emit("removeMember",o)}),this.quorumProposals=new mm({proposals:t,values:r},i),this.quorumProposals.on("addProposal",o=>{this.emit("addProposal",o)}),this.quorumProposals.on("approveProposal",(o,a,s,c)=>{this.emit("approveProposal",o,a,s,c)})}get disposed(){return this.isDisposed}close(){this.removeAllListeners()}snapshot(){let e=this.quorumClients.snapshot(),{proposals:t,values:r}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:r}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}getApprovalData(e){return this.quorumProposals.getApprovalData(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}propose(e,t){return v(this,null,function*(){return this.quorumProposals.propose(e,t)})}addProposal(e,t,r,i,o){return this.quorumProposals.addProposal(e,t,r,i,o)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}});var bm,nu,FO=W(()=>{gm();vm();bm=class{constructor(e,t,r,i,o,a,s){this.minimumSequenceNumber=e,this.sequenceNumber=t,this.term=r??1,this._quorum=new tu(i,o,a,s)}get quorum(){return this._quorum}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber,term:this.term}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let r=!1;switch(e.type){case Oi.ClientJoin:let i=e,o=JSON.parse(i.data),a={client:o.detail,sequenceNumber:i.sequenceNumber};this._quorum.addMember(o.clientId,a);break;case Oi.ClientLeave:let c=JSON.parse(e.data);this._quorum.removeMember(c);break;case Oi.Propose:let l=e.contents;this._quorum.addProposal(l.key,l.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0;break;case Oi.Reject:throw new Error("Quorum rejection is removed.");default:}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}getProtocolState(){return Object.assign({sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber},this._quorum.snapshot())}},nu=class extends bm{processMessage(e,t){let r=this._quorum.getMember(e.clientId);if(e.clientId!=null){if(r===void 0&&e.type!==Oi.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(r?.shouldHaveLeft===!0&&e.type!==Oi.NoOp)throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}}});var TO=W(()=>{});var zO=W(()=>{});var Hr=W(()=>{kO();FO();vm();TO();zO();});var RO=z((va,ba)=>{(function(n){var e=typeof va=="object"&&va&&!va.nodeType&&va,t=typeof ba=="object"&&ba&&!ba.nodeType&&ba,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(n=r);var i,o=2147483647,a=36,s=1,c=26,l=38,h=700,u=72,d=128,p="-",m=/^xn--/,f=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=a-s,O=Math.floor,S=String.fromCharCode,E;function F(L){throw new RangeError(b[L])}function I(L,V){for(var G=L.length,re=[];G--;)re[G]=V(L[G]);return re}function y(L,V){var G=L.split("@"),re="";G.length>1&&(re=G[0]+"@",L=G[1]),L=L.replace(x,".");var te=L.split("."),be=I(te,V).join(".");return re+be}function P(L){for(var V=[],G=0,re=L.length,te,be;G<re;)te=L.charCodeAt(G++),te>=55296&&te<=56319&&G<re?(be=L.charCodeAt(G++),(be&64512)==56320?V.push(((te&1023)<<10)+(be&1023)+65536):(V.push(te),G--)):V.push(te);return V}function C(L){return I(L,function(V){var G="";return V>65535&&(V-=65536,G+=S(V>>>10&1023|55296),V=56320|V&1023),G+=S(V),G}).join("")}function M(L){return L-48<10?L-22:L-65<26?L-65:L-97<26?L-97:a}function A(L,V){return L+22+75*(L<26)-((V!=0)<<5)}function T(L,V,G){var re=0;for(L=G?O(L/h):L>>1,L+=O(L/V);L>_*c>>1;re+=a)L=O(L/_);return O(re+(_+1)*L/(L+l))}function k(L){var V=[],G=L.length,re,te=0,be=d,ge=u,rt,He,Ue,Ke,ze,pe,Ae,Me,Ge;for(rt=L.lastIndexOf(p),rt<0&&(rt=0),He=0;He<rt;++He)L.charCodeAt(He)>=128&&F("not-basic"),V.push(L.charCodeAt(He));for(Ue=rt>0?rt+1:0;Ue<G;){for(Ke=te,ze=1,pe=a;Ue>=G&&F("invalid-input"),Ae=M(L.charCodeAt(Ue++)),(Ae>=a||Ae>O((o-te)/ze))&&F("overflow"),te+=Ae*ze,Me=pe<=ge?s:pe>=ge+c?c:pe-ge,!(Ae<Me);pe+=a)Ge=a-Me,ze>O(o/Ge)&&F("overflow"),ze*=Ge;re=V.length+1,ge=T(te-Ke,re,Ke==0),O(te/re)>o-be&&F("overflow"),be+=O(te/re),te%=re,V.splice(te++,0,be)}return C(V)}function D(L){var V,G,re,te,be,ge,rt,He,Ue,Ke,ze,pe=[],Ae,Me,Ge,St;for(L=P(L),Ae=L.length,V=d,G=0,be=u,ge=0;ge<Ae;++ge)ze=L[ge],ze<128&&pe.push(S(ze));for(re=te=pe.length,te&&pe.push(p);re<Ae;){for(rt=o,ge=0;ge<Ae;++ge)ze=L[ge],ze>=V&&ze<rt&&(rt=ze);for(Me=re+1,rt-V>O((o-G)/Me)&&F("overflow"),G+=(rt-V)*Me,V=rt,ge=0;ge<Ae;++ge)if(ze=L[ge],ze<V&&++G>o&&F("overflow"),ze==V){for(He=G,Ue=a;Ke=Ue<=be?s:Ue>=be+c?c:Ue-be,!(He<Ke);Ue+=a)St=He-Ke,Ge=a-Ke,pe.push(S(A(Ke+St%Ge,0))),He=O(St/Ge);pe.push(S(A(He,0))),be=T(G,Me,re==te),G=0,++re}++G,++V}return pe.join("")}function R(L){return y(L,function(V){return m.test(V)?k(V.slice(4).toLowerCase()):V})}function N(L){return y(L,function(V){return f.test(V)?"xn--"+D(V):V})}if(i={version:"1.4.1",ucs2:{decode:P,encode:C},decode:k,encode:D,toASCII:N,toUnicode:R},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return i});else if(e&&t)if(ba.exports==e)t.exports=i;else for(E in i)i.hasOwnProperty(E)&&(e[E]=i[E]);else n.punycode=i})(va)});var BO=z((qre,NO)=>{"use strict";NO.exports=Error});var LO=z((Lre,qO)=>{"use strict";qO.exports=EvalError});var VO=z((jre,jO)=>{"use strict";jO.exports=RangeError});var UO=z((Vre,HO)=>{"use strict";HO.exports=ReferenceError});var xm=z((Hre,GO)=>{"use strict";GO.exports=SyntaxError});var xa=z((Ure,WO)=>{"use strict";WO.exports=TypeError});var $O=z((Gre,KO)=>{"use strict";KO.exports=URIError});var JO=z((Wre,XO)=>{"use strict";XO.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==i||a.enumerable!==!0)return!1}return!0}});var ZO=z((Kre,YO)=>{"use strict";var QO=typeof Symbol<"u"&&Symbol,jB=JO();YO.exports=function(){return typeof QO!="function"||typeof Symbol!="function"||typeof QO("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:jB()}});var tM=z(($re,eM)=>{"use strict";var _m={__proto__:null,foo:{}},VB=Object;eM.exports=function(){return{__proto__:_m}.foo===_m.foo&&!(_m instanceof VB)}});var iM=z((Xre,rM)=>{"use strict";var HB="Function.prototype.bind called on incompatible ",UB=Object.prototype.toString,GB=Math.max,WB="[object Function]",nM=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r},KB=function(e,t){for(var r=[],i=t||0,o=0;i<e.length;i+=1,o+=1)r[o]=e[i];return r},$B=function(n,e){for(var t="",r=0;r<n.length;r+=1)t+=n[r],r+1<n.length&&(t+=e);return t};rM.exports=function(e){var t=this;if(typeof t!="function"||UB.apply(t)!==WB)throw new TypeError(HB+t);for(var r=KB(arguments,1),i,o=function(){if(this instanceof i){var h=t.apply(this,nM(r,arguments));return Object(h)===h?h:this}return t.apply(e,nM(r,arguments))},a=GB(0,t.length-r.length),s=[],c=0;c<a;c++)s[c]="$"+c;if(i=Function("binder","return function ("+$B(s,",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var l=function(){};l.prototype=t.prototype,i.prototype=new l,l.prototype=null}return i}});var iu=z((Jre,oM)=>{"use strict";var XB=iM();oM.exports=Function.prototype.bind||XB});var sM=z((Qre,aM)=>{"use strict";var JB=Function.prototype.call,QB=Object.prototype.hasOwnProperty,YB=iu();aM.exports=YB.call(JB,QB)});var bo=z((Yre,hM)=>{"use strict";var De,ZB=BO(),e9=LO(),t9=VO(),n9=UO(),wa=xm(),Ca=xa(),r9=$O(),uM=Function,ym=function(n){try{return uM('"use strict"; return ('+n+").constructor;")()}catch{}},mo=Object.getOwnPropertyDescriptor;if(mo)try{mo({},"")}catch{mo=null}var Cm=function(){throw new Ca},i9=mo?function(){try{return arguments.callee,Cm}catch{try{return mo(arguments,"callee").get}catch{return Cm}}}():Cm,_a=ZO()(),o9=tM()(),Bt=Object.getPrototypeOf||(o9?function(n){return n.__proto__}:null),ya={},a9=typeof Uint8Array>"u"||!Bt?De:Bt(Uint8Array),vo={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?De:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?De:ArrayBuffer,"%ArrayIteratorPrototype%":_a&&Bt?Bt([][Symbol.iterator]()):De,"%AsyncFromSyncIteratorPrototype%":De,"%AsyncFunction%":ya,"%AsyncGenerator%":ya,"%AsyncGeneratorFunction%":ya,"%AsyncIteratorPrototype%":ya,"%Atomics%":typeof Atomics>"u"?De:Atomics,"%BigInt%":typeof BigInt>"u"?De:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?De:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?De:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?De:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":ZB,"%eval%":eval,"%EvalError%":e9,"%Float32Array%":typeof Float32Array>"u"?De:Float32Array,"%Float64Array%":typeof Float64Array>"u"?De:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?De:FinalizationRegistry,"%Function%":uM,"%GeneratorFunction%":ya,"%Int8Array%":typeof Int8Array>"u"?De:Int8Array,"%Int16Array%":typeof Int16Array>"u"?De:Int16Array,"%Int32Array%":typeof Int32Array>"u"?De:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":_a&&Bt?Bt(Bt([][Symbol.iterator]())):De,"%JSON%":typeof JSON=="object"?JSON:De,"%Map%":typeof Map>"u"?De:Map,"%MapIteratorPrototype%":typeof Map>"u"||!_a||!Bt?De:Bt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?De:Promise,"%Proxy%":typeof Proxy>"u"?De:Proxy,"%RangeError%":t9,"%ReferenceError%":n9,"%Reflect%":typeof Reflect>"u"?De:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?De:Set,"%SetIteratorPrototype%":typeof Set>"u"||!_a||!Bt?De:Bt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?De:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":_a&&Bt?Bt(""[Symbol.iterator]()):De,"%Symbol%":_a?Symbol:De,"%SyntaxError%":wa,"%ThrowTypeError%":i9,"%TypedArray%":a9,"%TypeError%":Ca,"%Uint8Array%":typeof Uint8Array>"u"?De:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?De:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?De:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?De:Uint32Array,"%URIError%":r9,"%WeakMap%":typeof WeakMap>"u"?De:WeakMap,"%WeakRef%":typeof WeakRef>"u"?De:WeakRef,"%WeakSet%":typeof WeakSet>"u"?De:WeakSet};if(Bt)try{null.error}catch(n){cM=Bt(Bt(n)),vo["%Error.prototype%"]=cM}var cM,s9=function n(e){var t;if(e==="%AsyncFunction%")t=ym("async function () {}");else if(e==="%GeneratorFunction%")t=ym("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=ym("async function* () {}");else if(e==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=n("%AsyncGenerator%");i&&Bt&&(t=Bt(i.prototype))}return vo[e]=t,t},lM={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Cc=iu(),ou=sM(),c9=Cc.call(Function.call,Array.prototype.concat),l9=Cc.call(Function.apply,Array.prototype.splice),dM=Cc.call(Function.call,String.prototype.replace),au=Cc.call(Function.call,String.prototype.slice),d9=Cc.call(Function.call,RegExp.prototype.exec),u9=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,h9=/\\(\\)?/g,p9=function(e){var t=au(e,0,1),r=au(e,-1);if(t==="%"&&r!=="%")throw new wa("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new wa("invalid intrinsic syntax, expected opening `%`");var i=[];return dM(e,u9,function(o,a,s,c){i[i.length]=s?dM(c,h9,"$1"):a||o}),i},g9=function(e,t){var r=e,i;if(ou(lM,r)&&(i=lM[r],r="%"+i[0]+"%"),ou(vo,r)){var o=vo[r];if(o===ya&&(o=s9(r)),typeof o>"u"&&!t)throw new Ca("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:o}}throw new wa("intrinsic "+e+" does not exist!")};hM.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new Ca("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Ca('"allowMissing" argument must be a boolean');if(d9(/^%?[^%]*%?$/,e)===null)throw new wa("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=p9(e),i=r.length>0?r[0]:"",o=g9("%"+i+"%",t),a=o.name,s=o.value,c=!1,l=o.alias;l&&(i=l[0],l9(r,c9([0,1],l)));for(var h=1,u=!0;h<r.length;h+=1){var d=r[h],p=au(d,0,1),m=au(d,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new wa("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(c=!0),i+="."+d,a="%"+i+"%",ou(vo,a))s=vo[a];else if(s!=null){if(!(d in s)){if(!t)throw new Ca("base intrinsic for "+e+" exists, but the property is not available.");return}if(mo&&h+1>=r.length){var f=mo(s,d);u=!!f,u&&"get"in f&&!("originalValue"in f.get)?s=f.get:s=s[d]}else u=ou(s,d),s=s[d];u&&!c&&(vo[a]=s)}}return s}});var cu=z((Zre,pM)=>{"use strict";var f9=bo(),su=f9("%Object.defineProperty%",!0)||!1;if(su)try{su({},"a",{value:1})}catch{su=!1}pM.exports=su});var wm=z((eie,gM)=>{"use strict";var m9=bo(),lu=m9("%Object.getOwnPropertyDescriptor%",!0);if(lu)try{lu([],"length")}catch{lu=null}gM.exports=lu});var bM=z((tie,vM)=>{"use strict";var fM=cu(),v9=xm(),Pa=xa(),mM=wm();vM.exports=function(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new Pa("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Pa("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Pa("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Pa("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Pa("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Pa("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,c=!!mM&&mM(e,t);if(fM)fM(e,t,{configurable:a===null&&c?c.configurable:!a,enumerable:i===null&&c?c.enumerable:!i,value:r,writable:o===null&&c?c.writable:!o});else if(s||!i&&!o&&!a)e[t]=r;else throw new v9("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var yM=z((nie,_M)=>{"use strict";var Pm=cu(),xM=function(){return!!Pm};xM.hasArrayLengthDefineBug=function(){if(!Pm)return null;try{return Pm([],"length",{value:1}).length!==1}catch{return!0}};_M.exports=xM});var MM=z((rie,OM)=>{"use strict";var b9=bo(),CM=bM(),x9=yM()(),wM=wm(),PM=xa(),_9=b9("%Math.floor%");OM.exports=function(e,t){if(typeof e!="function")throw new PM("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||_9(t)!==t)throw new PM("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,o=!0;if("length"in e&&wM){var a=wM(e,"length");a&&!a.configurable&&(i=!1),a&&!a.writable&&(o=!1)}return(i||o||!r)&&(x9?CM(e,"length",t,!0,!0):CM(e,"length",t)),e}});var FM=z((iie,du)=>{"use strict";var Om=iu(),uu=bo(),y9=MM(),C9=xa(),AM=uu("%Function.prototype.apply%"),kM=uu("%Function.prototype.call%"),DM=uu("%Reflect.apply%",!0)||Om.call(kM,AM),SM=cu(),w9=uu("%Math.max%");du.exports=function(e){if(typeof e!="function")throw new C9("a function is required");var t=DM(Om,kM,arguments);return y9(t,1+w9(0,e.length-(arguments.length-1)),!0)};var EM=function(){return DM(Om,AM,arguments)};SM?SM(du.exports,"apply",{value:EM}):du.exports.apply=EM});var RM=z((oie,IM)=>{"use strict";var TM=bo(),zM=FM(),P9=zM(TM("String.prototype.indexOf"));IM.exports=function(e,t){var r=TM(e,!!t);return typeof r=="function"&&P9(e,".prototype.")>-1?zM(r):r}});var NM=z(()=>{});var rS=z((cie,nS)=>{var Im=typeof Map=="function"&&Map.prototype,Mm=Object.getOwnPropertyDescriptor&&Im?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,pu=Im&&Mm&&typeof Mm.get=="function"?Mm.get:null,BM=Im&&Map.prototype.forEach,Rm=typeof Set=="function"&&Set.prototype,Sm=Object.getOwnPropertyDescriptor&&Rm?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,gu=Rm&&Sm&&typeof Sm.get=="function"?Sm.get:null,qM=Rm&&Set.prototype.forEach,O9=typeof WeakMap=="function"&&WeakMap.prototype,Pc=O9?WeakMap.prototype.has:null,M9=typeof WeakSet=="function"&&WeakSet.prototype,Oc=M9?WeakSet.prototype.has:null,S9=typeof WeakRef=="function"&&WeakRef.prototype,LM=S9?WeakRef.prototype.deref:null,E9=Boolean.prototype.valueOf,A9=Object.prototype.toString,k9=Function.prototype.toString,D9=String.prototype.match,Nm=String.prototype.slice,Si=String.prototype.replace,F9=String.prototype.toUpperCase,jM=String.prototype.toLowerCase,JM=RegExp.prototype.test,VM=Array.prototype.concat,Pr=Array.prototype.join,T9=Array.prototype.slice,HM=Math.floor,km=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Em=Object.getOwnPropertySymbols,Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ln=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Oa||!0)?Symbol.toStringTag:null,QM=Object.prototype.propertyIsEnumerable,UM=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function GM(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||JM.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var r=n<0?-HM(-n):HM(n);if(r!==n){var i=String(r),o=Nm.call(e,i.length+1);return Si.call(i,t,"$&_")+"."+Si.call(Si.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Si.call(e,t,"$&_")}var Fm=NM(),WM=Fm.custom,KM=ZM(WM)?WM:null;nS.exports=function n(e,t,r,i){var o=t||{};if(Mi(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Mi(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Mi(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Mi(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Mi(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return tS(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return s?GM(e,c):c}if(typeof e=="bigint"){var l=String(e)+"n";return s?GM(e,l):l}var h=typeof o.depth>"u"?5:o.depth;if(typeof r>"u"&&(r=0),r>=h&&h>0&&typeof e=="object")return Tm(e)?"[Array]":"[Object]";var u=Q9(o,r);if(typeof i>"u")i=[];else if(eS(i,e)>=0)return"[Circular]";function d(T,k,D){if(k&&(i=T9.call(i),i.push(k)),D){var R={depth:o.depth};return Mi(o,"quoteStyle")&&(R.quoteStyle=o.quoteStyle),n(T,R,r+1,i)}return n(T,o,r+1,i)}if(typeof e=="function"&&!$M(e)){var p=V9(e),m=hu(e,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+Pr.call(m,", ")+" }":"")}if(ZM(e)){var f=Oa?Si.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Dm.call(e);return typeof e=="object"&&!Oa?wc(f):f}if($9(e)){for(var x="<"+jM.call(String(e.nodeName)),b=e.attributes||[],_=0;_<b.length;_++)x+=" "+b[_].name+"="+YM(z9(b[_].value),"double",o);return x+=">",e.childNodes&&e.childNodes.length&&(x+="..."),x+="</"+jM.call(String(e.nodeName))+">",x}if(Tm(e)){if(e.length===0)return"[]";var O=hu(e,d);return u&&!J9(O)?"["+zm(O,u)+"]":"[ "+Pr.call(O,", ")+" ]"}if(R9(e)){var S=hu(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!QM.call(e,"cause")?"{ ["+String(e)+"] "+Pr.call(VM.call("[cause]: "+d(e.cause),S),", ")+" }":S.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Pr.call(S,", ")+" }"}if(typeof e=="object"&&a){if(KM&&typeof e[KM]=="function"&&Fm)return Fm(e,{depth:h-r});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(H9(e)){var E=[];return BM&&BM.call(e,function(T,k){E.push(d(k,e,!0)+" => "+d(T,e))}),XM("Map",pu.call(e),E,u)}if(W9(e)){var F=[];return qM&&qM.call(e,function(T){F.push(d(T,e))}),XM("Set",gu.call(e),F,u)}if(U9(e))return Am("WeakMap");if(K9(e))return Am("WeakSet");if(G9(e))return Am("WeakRef");if(B9(e))return wc(d(Number(e)));if(L9(e))return wc(d(km.call(e)));if(q9(e))return wc(E9.call(e));if(N9(e))return wc(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===global)return"{ [object globalThis] }";if(!I9(e)&&!$M(e)){var I=hu(e,d),y=UM?UM(e)===Object.prototype:e instanceof Object||e.constructor===Object,P=e instanceof Object?"":"null prototype",C=!y&&ln&&Object(e)===e&&ln in e?Nm.call(Ei(e),8,-1):P?"Object":"",M=y||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",A=M+(C||P?"["+Pr.call(VM.call([],C||[],P||[]),": ")+"] ":"");return I.length===0?A+"{}":u?A+"{"+zm(I,u)+"}":A+"{ "+Pr.call(I,", ")+" }"}return String(e)};function YM(n,e,t){var r=(t.quoteStyle||e)==="double"?'"':"'";return r+n+r}function z9(n){return Si.call(String(n),/"/g,"&quot;")}function Tm(n){return Ei(n)==="[object Array]"&&(!ln||!(typeof n=="object"&&ln in n))}function I9(n){return Ei(n)==="[object Date]"&&(!ln||!(typeof n=="object"&&ln in n))}function $M(n){return Ei(n)==="[object RegExp]"&&(!ln||!(typeof n=="object"&&ln in n))}function R9(n){return Ei(n)==="[object Error]"&&(!ln||!(typeof n=="object"&&ln in n))}function N9(n){return Ei(n)==="[object String]"&&(!ln||!(typeof n=="object"&&ln in n))}function B9(n){return Ei(n)==="[object Number]"&&(!ln||!(typeof n=="object"&&ln in n))}function q9(n){return Ei(n)==="[object Boolean]"&&(!ln||!(typeof n=="object"&&ln in n))}function ZM(n){if(Oa)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!Dm)return!1;try{return Dm.call(n),!0}catch{}return!1}function L9(n){if(!n||typeof n!="object"||!km)return!1;try{return km.call(n),!0}catch{}return!1}var j9=Object.prototype.hasOwnProperty||function(n){return n in this};function Mi(n,e){return j9.call(n,e)}function Ei(n){return A9.call(n)}function V9(n){if(n.name)return n.name;var e=D9.call(k9.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function eS(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1}function H9(n){if(!pu||!n||typeof n!="object")return!1;try{pu.call(n);try{gu.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function U9(n){if(!Pc||!n||typeof n!="object")return!1;try{Pc.call(n,Pc);try{Oc.call(n,Oc)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function G9(n){if(!LM||!n||typeof n!="object")return!1;try{return LM.call(n),!0}catch{}return!1}function W9(n){if(!gu||!n||typeof n!="object")return!1;try{gu.call(n);try{pu.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function K9(n){if(!Oc||!n||typeof n!="object")return!1;try{Oc.call(n,Oc);try{Pc.call(n,Pc)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function $9(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function tS(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,r="... "+t+" more character"+(t>1?"s":"");return tS(Nm.call(n,0,e.maxStringLength),e)+r}var i=Si.call(Si.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,X9);return YM(i,"single",e)}function X9(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+F9.call(e.toString(16))}function wc(n){return"Object("+n+")"}function Am(n){return n+" { ? }"}function XM(n,e,t,r){var i=r?zm(t,r):Pr.call(t,", ");return n+" ("+e+") {"+i+"}"}function J9(n){for(var e=0;e<n.length;e++)if(eS(n[e],`
`)>=0)return!1;return!0}function Q9(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Pr.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Pr.call(Array(e+1),t)}}function zm(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Pr.call(n,","+t)+`
`+e.prev}function hu(n,e){var t=Tm(n),r=[];if(t){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=Mi(n,i)?e(n[i],n):""}var o=typeof Em=="function"?Em(n):[],a;if(Oa){a={};for(var s=0;s<o.length;s++)a["$"+o[s]]=o[s]}for(var c in n)Mi(n,c)&&(t&&String(Number(c))===c&&c<n.length||Oa&&a["$"+c]instanceof Symbol||(JM.call(/[^\w$]/,c)?r.push(e(c,n)+": "+e(n[c],n)):r.push(c+": "+e(n[c],n))));if(typeof Em=="function")for(var l=0;l<o.length;l++)QM.call(n,o[l])&&r.push("["+e(o[l])+"]: "+e(n[o[l]],n));return r}});var aS=z((lie,oS)=>{"use strict";var iS=bo(),Ma=RM(),Y9=rS(),Z9=xa(),fu=iS("%WeakMap%",!0),mu=iS("%Map%",!0),eq=Ma("WeakMap.prototype.get",!0),tq=Ma("WeakMap.prototype.set",!0),nq=Ma("WeakMap.prototype.has",!0),rq=Ma("Map.prototype.get",!0),iq=Ma("Map.prototype.set",!0),oq=Ma("Map.prototype.has",!0),Bm=function(n,e){for(var t=n,r;(r=t.next)!==null;t=r)if(r.key===e)return t.next=r.next,r.next=n.next,n.next=r,r},aq=function(n,e){var t=Bm(n,e);return t&&t.value},sq=function(n,e,t){var r=Bm(n,e);r?r.value=t:n.next={key:e,next:n.next,value:t}},cq=function(n,e){return!!Bm(n,e)};oS.exports=function(){var e,t,r,i={assert:function(o){if(!i.has(o))throw new Z9("Side channel does not contain "+Y9(o))},get:function(o){if(fu&&o&&(typeof o=="object"||typeof o=="function")){if(e)return eq(e,o)}else if(mu){if(t)return rq(t,o)}else if(r)return aq(r,o)},has:function(o){if(fu&&o&&(typeof o=="object"||typeof o=="function")){if(e)return nq(e,o)}else if(mu){if(t)return oq(t,o)}else if(r)return cq(r,o);return!1},set:function(o,a){fu&&o&&(typeof o=="object"||typeof o=="function")?(e||(e=new fu),tq(e,o,a)):mu?(t||(t=new mu),iq(t,o,a)):(r||(r={key:{},next:null}),sq(r,o,a))}};return i}});var vu=z((die,sS)=>{"use strict";var lq=String.prototype.replace,dq=/%20/g,qm={RFC1738:"RFC1738",RFC3986:"RFC3986"};sS.exports={default:qm.RFC3986,formatters:{RFC1738:function(n){return lq.call(n,dq,"+")},RFC3986:function(n){return String(n)}},RFC1738:qm.RFC1738,RFC3986:qm.RFC3986}});var Vm=z((uie,lS)=>{"use strict";var uq=vu(),Lm=Object.prototype.hasOwnProperty,xo=Array.isArray,Or=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),hq=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(xo(r)){for(var i=[],o=0;o<r.length;++o)typeof r[o]<"u"&&i.push(r[o]);t.obj[t.prop]=i}}},cS=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},pq=function n(e,t,r){if(!t)return e;if(typeof t!="object"){if(xo(e))e.push(t);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Lm.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var i=e;return xo(e)&&!xo(t)&&(i=cS(e,r)),xo(e)&&xo(t)?(t.forEach(function(o,a){if(Lm.call(e,a)){var s=e[a];s&&typeof s=="object"&&o&&typeof o=="object"?e[a]=n(s,o,r):e.push(o)}else e[a]=o}),e):Object.keys(t).reduce(function(o,a){var s=t[a];return Lm.call(o,a)?o[a]=n(o[a],s,r):o[a]=s,o},i)},gq=function(e,t){return Object.keys(t).reduce(function(r,i){return r[i]=t[i],r},e)},fq=function(n,e,t){var r=n.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},jm=1024,mq=function(e,t,r,i,o){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),r==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var s="",c=0;c<a.length;c+=jm){for(var l=a.length>=jm?a.slice(c,c+jm):a,h=[],u=0;u<l.length;++u){var d=l.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||o===uq.RFC1738&&(d===40||d===41)){h[h.length]=l.charAt(u);continue}if(d<128){h[h.length]=Or[d];continue}if(d<2048){h[h.length]=Or[192|d>>6]+Or[128|d&63];continue}if(d<55296||d>=57344){h[h.length]=Or[224|d>>12]+Or[128|d>>6&63]+Or[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|l.charCodeAt(u)&1023),h[h.length]=Or[240|d>>18]+Or[128|d>>12&63]+Or[128|d>>6&63]+Or[128|d&63]}s+=h.join("")}return s},vq=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var o=t[i],a=o.obj[o.prop],s=Object.keys(a),c=0;c<s.length;++c){var l=s[c],h=a[l];typeof h=="object"&&h!==null&&r.indexOf(h)===-1&&(t.push({obj:a,prop:l}),r.push(h))}return hq(t),e},bq=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},xq=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},_q=function(e,t){return[].concat(e,t)},yq=function(e,t){if(xo(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)};lS.exports={arrayToObject:cS,assign:gq,combine:_q,compact:vq,decode:fq,encode:mq,isBuffer:xq,isRegExp:bq,maybeMap:yq,merge:pq}});var fS=z((hie,gS)=>{"use strict";var uS=aS(),bu=Vm(),Mc=vu(),Cq=Object.prototype.hasOwnProperty,hS={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Mr=Array.isArray,wq=Array.prototype.push,pS=function(n,e){wq.apply(n,Mr(e)?e:[e])},Pq=Date.prototype.toISOString,dS=Mc.default,kt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:bu.encode,encodeValuesOnly:!1,format:dS,formatter:Mc.formatters[dS],indices:!1,serializeDate:function(e){return Pq.call(e)},skipNulls:!1,strictNullHandling:!1},Oq=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Hm={},Mq=function n(e,t,r,i,o,a,s,c,l,h,u,d,p,m,f,x,b,_){for(var O=e,S=_,E=0,F=!1;(S=S.get(Hm))!==void 0&&!F;){var I=S.get(e);if(E+=1,typeof I<"u"){if(I===E)throw new RangeError("Cyclic object value");F=!0}typeof S.get(Hm)>"u"&&(E=0)}if(typeof h=="function"?O=h(t,O):O instanceof Date?O=p(O):r==="comma"&&Mr(O)&&(O=bu.maybeMap(O,function(G){return G instanceof Date?p(G):G})),O===null){if(a)return l&&!x?l(t,kt.encoder,b,"key",m):t;O=""}if(Oq(O)||bu.isBuffer(O)){if(l){var y=x?t:l(t,kt.encoder,b,"key",m);return[f(y)+"="+f(l(O,kt.encoder,b,"value",m))]}return[f(t)+"="+f(String(O))]}var P=[];if(typeof O>"u")return P;var C;if(r==="comma"&&Mr(O))x&&l&&(O=bu.maybeMap(O,l)),C=[{value:O.length>0?O.join(",")||null:void 0}];else if(Mr(h))C=h;else{var M=Object.keys(O);C=u?M.sort(u):M}var A=c?t.replace(/\./g,"%2E"):t,T=i&&Mr(O)&&O.length===1?A+"[]":A;if(o&&Mr(O)&&O.length===0)return T+"[]";for(var k=0;k<C.length;++k){var D=C[k],R=typeof D=="object"&&typeof D.value<"u"?D.value:O[D];if(!(s&&R===null)){var N=d&&c?D.replace(/\./g,"%2E"):D,L=Mr(O)?typeof r=="function"?r(T,N):T:T+(d?"."+N:"["+N+"]");_.set(e,E);var V=uS();V.set(Hm,_),pS(P,n(R,L,r,i,o,a,s,c,r==="comma"&&x&&Mr(O)?null:l,h,u,d,p,m,f,x,b,V))}}return P},Sq=function(e){if(!e)return kt;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||kt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=Mc.default;if(typeof e.format<"u"){if(!Cq.call(Mc.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=Mc.formatters[r],o=kt.filter;(typeof e.filter=="function"||Mr(e.filter))&&(o=e.filter);var a;if(e.arrayFormat in hS?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=kt.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:kt.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:kt.addQueryPrefix,allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:kt.allowEmptyArrays,arrayFormat:a,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:kt.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?kt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:kt.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:kt.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:kt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:kt.encodeValuesOnly,filter:o,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:kt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:kt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:kt.strictNullHandling}};gS.exports=function(n,e){var t=n,r=Sq(e),i,o;typeof r.filter=="function"?(o=r.filter,t=o("",t)):Mr(r.filter)&&(o=r.filter,i=o);var a=[];if(typeof t!="object"||t===null)return"";var s=hS[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;i||(i=Object.keys(t)),r.sort&&i.sort(r.sort);for(var l=uS(),h=0;h<i.length;++h){var u=i[h];r.skipNulls&&t[u]===null||pS(a,Mq(t[u],u,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}var d=a.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""}});var bS=z((pie,vS)=>{"use strict";var Sa=Vm(),Um=Object.prototype.hasOwnProperty,Eq=Array.isArray,wt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Sa.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Aq=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},mS=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},kq="utf8=%26%2310003%3B",Dq="utf8=%E2%9C%93",Fq=function(e,t){var r={__proto__:null},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,a=i.split(t.delimiter,o),s=-1,c,l=t.charset;if(t.charsetSentinel)for(c=0;c<a.length;++c)a[c].indexOf("utf8=")===0&&(a[c]===Dq?l="utf-8":a[c]===kq&&(l="iso-8859-1"),s=c,c=a.length);for(c=0;c<a.length;++c)if(c!==s){var h=a[c],u=h.indexOf("]="),d=u===-1?h.indexOf("="):u+1,p,m;d===-1?(p=t.decoder(h,wt.decoder,l,"key"),m=t.strictNullHandling?null:""):(p=t.decoder(h.slice(0,d),wt.decoder,l,"key"),m=Sa.maybeMap(mS(h.slice(d+1),t),function(x){return t.decoder(x,wt.decoder,l,"value")})),m&&t.interpretNumericEntities&&l==="iso-8859-1"&&(m=Aq(m)),h.indexOf("[]=")>-1&&(m=Eq(m)?[m]:m);var f=Um.call(r,p);f&&t.duplicates==="combine"?r[p]=Sa.combine(r[p],m):(!f||t.duplicates==="last")&&(r[p]=m)}return r},Tq=function(n,e,t,r){for(var i=r?e:mS(e,t),o=n.length-1;o>=0;--o){var a,s=n[o];if(s==="[]"&&t.parseArrays)a=t.allowEmptyArrays&&i===""?[]:[].concat(i);else{a=t.plainObjects?Object.create(null):{};var c=s.charAt(0)==="["&&s.charAt(s.length-1)==="]"?s.slice(1,-1):s,l=t.decodeDotInKeys?c.replace(/%2E/g,"."):c,h=parseInt(l,10);!t.parseArrays&&l===""?a={0:i}:!isNaN(h)&&s!==l&&String(h)===l&&h>=0&&t.parseArrays&&h<=t.arrayLimit?(a=[],a[h]=i):l!=="__proto__"&&(a[l]=i)}i=a}return i},zq=function(e,t,r,i){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,c=r.depth>0&&a.exec(o),l=c?o.slice(0,c.index):o,h=[];if(l){if(!r.plainObjects&&Um.call(Object.prototype,l)&&!r.allowPrototypes)return;h.push(l)}for(var u=0;r.depth>0&&(c=s.exec(o))!==null&&u<r.depth;){if(u+=1,!r.plainObjects&&Um.call(Object.prototype,c[1].slice(1,-1))&&!r.allowPrototypes)return;h.push(c[1])}return c&&h.push("["+o.slice(c.index)+"]"),Tq(h,t,r,i)}},Iq=function(e){if(!e)return wt;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?wt.charset:e.charset,r=typeof e.duplicates>"u"?wt.duplicates:e.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:wt.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:wt.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:wt.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:wt.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:wt.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:wt.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:wt.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:wt.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:wt.decoder,delimiter:typeof e.delimiter=="string"||Sa.isRegExp(e.delimiter)?e.delimiter:wt.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:wt.depth,duplicates:r,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:wt.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:wt.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:wt.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:wt.strictNullHandling}};vS.exports=function(n,e){var t=Iq(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var r=typeof n=="string"?Fq(n,t):n,i=t.plainObjects?Object.create(null):{},o=Object.keys(r),a=0;a<o.length;++a){var s=o[a],c=zq(s,r[s],t,typeof n=="string");i=Sa.merge(i,c,t)}return t.allowSparse===!0?i:Sa.compact(i)}});var _S=z((gie,xS)=>{"use strict";var Rq=fS(),Nq=bS(),Bq=vu();xS.exports={formats:Bq,parse:Nq,stringify:Rq}});var $m=z(Aa=>{"use strict";var qq=RO();function Xn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Lq=/^([a-z0-9.+-]+:)/i,jq=/:[0-9]*$/,Vq=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Hq=["<",">",'"',"`"," ","\r",`
`,"	"],Uq=["{","}","|","\\","^","`"].concat(Hq),Gm=["'"].concat(Uq),yS=["%","/","?",";","#"].concat(Gm),CS=["/","?","#"],Gq=255,wS=/^[+a-z0-9A-Z_-]{0,63}$/,Wq=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Kq={javascript:!0,"javascript:":!0},Wm={javascript:!0,"javascript:":!0},Ea={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Km=_S();function Sc(n,e,t){if(n&&typeof n=="object"&&n instanceof Xn)return n;var r=new Xn;return r.parse(n,e,t),r}Xn.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var r=n.indexOf("?"),i=r!==-1&&r<n.indexOf("#")?"?":"#",o=n.split(i),a=/\\/g;o[0]=o[0].replace(a,"/"),n=o.join(i);var s=n;if(s=s.trim(),!t&&n.split("#").length===1){var c=Vq.exec(s);if(c)return this.path=s,this.href=s,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=Km.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=Lq.exec(s);if(l){l=l[0];var h=l.toLowerCase();this.protocol=h,s=s.substr(l.length)}if(t||l||s.match(/^\/\/[^@/]+@[^@/]+/)){var u=s.substr(0,2)==="//";u&&!(l&&Wm[l])&&(s=s.substr(2),this.slashes=!0)}if(!Wm[l]&&(u||l&&!Ea[l])){for(var d=-1,p=0;p<CS.length;p++){var m=s.indexOf(CS[p]);m!==-1&&(d===-1||m<d)&&(d=m)}var f,x;d===-1?x=s.lastIndexOf("@"):x=s.lastIndexOf("@",d),x!==-1&&(f=s.slice(0,x),s=s.slice(x+1),this.auth=decodeURIComponent(f)),d=-1;for(var p=0;p<yS.length;p++){var m=s.indexOf(yS[p]);m!==-1&&(d===-1||m<d)&&(d=m)}d===-1&&(d=s.length),this.host=s.slice(0,d),s=s.slice(d),this.parseHost(),this.hostname=this.hostname||"";var b=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!b)for(var _=this.hostname.split(/\./),p=0,O=_.length;p<O;p++){var S=_[p];if(S&&!S.match(wS)){for(var E="",F=0,I=S.length;F<I;F++)S.charCodeAt(F)>127?E+="x":E+=S[F];if(!E.match(wS)){var y=_.slice(0,p),P=_.slice(p+1),C=S.match(Wq);C&&(y.push(C[1]),P.unshift(C[2])),P.length&&(s="/"+P.join(".")+s),this.hostname=y.join(".");break}}}this.hostname.length>Gq?this.hostname="":this.hostname=this.hostname.toLowerCase(),b||(this.hostname=qq.toASCII(this.hostname));var M=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+M,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),s[0]!=="/"&&(s="/"+s))}if(!Kq[h])for(var p=0,O=Gm.length;p<O;p++){var T=Gm[p];if(s.indexOf(T)!==-1){var k=encodeURIComponent(T);k===T&&(k=escape(T)),s=s.split(T).join(k)}}var D=s.indexOf("#");D!==-1&&(this.hash=s.substr(D),s=s.slice(0,D));var R=s.indexOf("?");if(R!==-1?(this.search=s.substr(R),this.query=s.substr(R+1),e&&(this.query=Km.parse(this.query)),s=s.slice(0,R)):e&&(this.search="",this.query={}),s&&(this.pathname=s),Ea[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",N=this.search||"";this.path=M+N}return this.href=this.format(),this};function $q(n){return typeof n=="string"&&(n=Sc(n)),n instanceof Xn?n.format():Xn.prototype.format.call(n)}Xn.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=n+this.host:this.hostname&&(i=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=Km.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Ea[e])&&i!==!1?(i="//"+(i||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),a&&a.charAt(0)!=="?"&&(a="?"+a),t=t.replace(/[?#]/g,function(s){return encodeURIComponent(s)}),a=a.replace("#","%23"),e+i+t+a+r};function Xq(n,e){return Sc(n,!1,!0).resolve(e)}Xn.prototype.resolve=function(n){return this.resolveObject(Sc(n,!1,!0)).format()};function Jq(n,e){return n?Sc(n,!1,!0).resolveObject(e):e}Xn.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Xn;e.parse(n,!1,!0),n=e}for(var t=new Xn,r=Object.keys(this),i=0;i<r.length;i++){var o=r[i];t[o]=this[o]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var a=Object.keys(n),s=0;s<a.length;s++){var c=a[s];c!=="protocol"&&(t[c]=n[c])}return Ea[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!Ea[n.protocol]){for(var l=Object.keys(n),h=0;h<l.length;h++){var u=l[h];t[u]=n[u]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!Wm[n.protocol]){for(var O=(n.pathname||"").split("/");O.length&&!(n.host=O.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),O[0]!==""&&O.unshift(""),O.length<2&&O.unshift(""),t.pathname=O.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var d=t.pathname||"",p=t.search||"";t.path=d+p}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var m=t.pathname&&t.pathname.charAt(0)==="/",f=n.host||n.pathname&&n.pathname.charAt(0)==="/",x=f||m||t.host&&n.pathname,b=x,_=t.pathname&&t.pathname.split("/")||[],O=n.pathname&&n.pathname.split("/")||[],S=t.protocol&&!Ea[t.protocol];if(S&&(t.hostname="",t.port=null,t.host&&(_[0]===""?_[0]=t.host:_.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(O[0]===""?O[0]=n.host:O.unshift(n.host)),n.host=null),x=x&&(O[0]===""||_[0]==="")),f)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,_=O;else if(O.length)_||(_=[]),_.pop(),_=_.concat(O),t.search=n.search,t.query=n.query;else if(n.search!=null){if(S){t.host=_.shift(),t.hostname=t.host;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!_.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var F=_.slice(-1)[0],I=(t.host||n.host||_.length>1)&&(F==="."||F==="..")||F==="",y=0,P=_.length;P>=0;P--)F=_[P],F==="."?_.splice(P,1):F===".."?(_.splice(P,1),y++):y&&(_.splice(P,1),y--);if(!x&&!b)for(;y--;y)_.unshift("..");x&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),I&&_.join("/").substr(-1)!=="/"&&_.push("");var C=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(S){t.hostname=C?"":_.length?_.shift():"",t.host=t.hostname;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return x=x||t.host&&_.length,x&&!C&&_.unshift(""),_.length>0?t.pathname=_.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Xn.prototype.parseHost=function(){var n=this.host,e=jq.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};Aa.parse=Sc;Aa.resolve=Xq;Aa.resolveObject=Jq;Aa.format=$q;Aa.Url=Xn});var Xm=z((xie,PS)=>{"use strict";PS.exports=function(e,t){return function(){return e.apply(t,arguments)}}});var Mt=z((_ie,ES)=>{"use strict";var Qq=Xm(),Ym=Object.prototype.toString,Zm=function(n){return function(e){var t=Ym.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())}}(Object.create(null));function Di(n){return n=n.toLowerCase(),function(t){return Zm(t)===n}}function _u(n){return Array.isArray(n)}function Jm(n){return typeof n>"u"}function Yq(n){return n!==null&&!Jm(n)&&n.constructor!==null&&!Jm(n.constructor)&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}var OS=Di("ArrayBuffer");function Zq(n){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&OS(n.buffer),e}function eL(n){return typeof n=="string"}function MS(n){return typeof n=="number"}function SS(n){return n!==null&&typeof n=="object"}function xu(n){if(Zm(n)!=="object")return!1;var e=Object.getPrototypeOf(n);return e===null||e===Object.prototype}function tL(n){return n&&Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}var nL=Di("Date"),rL=Di("File"),iL=Di("Blob"),oL=Di("FileList");function ev(n){return Ym.call(n)==="[object Function]"}function aL(n){return SS(n)&&ev(n.pipe)}function sL(n){var e="[object FormData]";return n&&(typeof FormData=="function"&&n instanceof FormData||Ym.call(n)===e||ev(n.toString)&&n.toString()===e)}var cL=Di("URLSearchParams");function lL(n){return n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function dL(){var n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"}function tv(n,e){if(!(n===null||typeof n>"u"))if(typeof n!="object"&&(n=[n]),_u(n))for(var t=0,r=n.length;t<r;t++)e.call(null,n[t],t,n);else for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.call(null,n[i],i,n)}function Qm(){var n={};function e(i,o){xu(n[o])&&xu(i)?n[o]=Qm(n[o],i):xu(i)?n[o]=Qm({},i):_u(i)?n[o]=i.slice():n[o]=i}for(var t=0,r=arguments.length;t<r;t++)tv(arguments[t],e);return n}function uL(n,e,t){return tv(e,function(i,o){t&&typeof i=="function"?n[o]=Qq(i,t):n[o]=i}),n}function hL(n){return n.charCodeAt(0)===65279&&(n=n.slice(1)),n}function pL(n,e,t,r){n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,t&&Object.assign(n.prototype,t)}function gL(n,e,t,r){var i,o,a,s={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),o=i.length;o-- >0;)a=i[o],(!r||r(a,n,e))&&!s[a]&&(e[a]=n[a],s[a]=!0);n=t!==!1&&Object.getPrototypeOf(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e}function fL(n,e,t){n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return r!==-1&&r===t}function mL(n){if(!n)return null;if(_u(n))return n;var e=n.length;if(!MS(e))return null;for(var t=new Array(e);e-- >0;)t[e]=n[e];return t}var vL=function(n){return function(e){return n&&e instanceof n}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array));function bL(n,e){for(var t=n&&n[Symbol.iterator],r=t.call(n),i;(i=r.next())&&!i.done;){var o=i.value;e.call(n,o[0],o[1])}}function xL(n,e){for(var t,r=[];(t=n.exec(e))!==null;)r.push(t);return r}var _L=Di("HTMLFormElement"),yL=function(e){return function(t,r){return e.call(t,r)}}(Object.prototype.hasOwnProperty);ES.exports={isArray:_u,isArrayBuffer:OS,isBuffer:Yq,isFormData:sL,isArrayBufferView:Zq,isString:eL,isNumber:MS,isObject:SS,isPlainObject:xu,isEmptyObject:tL,isUndefined:Jm,isDate:nL,isFile:rL,isBlob:iL,isFunction:ev,isStream:aL,isURLSearchParams:cL,isStandardBrowserEnv:dL,forEach:tv,merge:Qm,extend:uL,trim:lL,stripBOM:hL,inherits:pL,toFlatObject:gL,kindOf:Zm,kindOfTest:Di,endsWith:fL,toArray:mL,isTypedArray:vL,isFileList:oL,forEachEntry:bL,matchAll:xL,isHTMLForm:_L,hasOwnProperty:yL}});var Fi=z((yie,FS)=>{"use strict";var AS=Mt();function ka(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i)}AS.inherits(ka,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var kS=ka.prototype,DS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(n){DS[n]={value:n}});Object.defineProperties(ka,DS);Object.defineProperty(kS,"isAxiosError",{value:!0});ka.from=function(n,e,t,r,i,o){var a=Object.create(kS);return AS.toFlatObject(n,a,function(c){return c!==Error.prototype}),ka.call(a,n.message,e,t,r,i),a.cause=n,a.name=n.name,o&&Object.assign(a,o),a};FS.exports=ka});var zS=z((Cie,TS)=>{TS.exports=typeof self=="object"?self.FormData:window.FormData});var RS=z((wie,IS)=>{IS.exports=zS()});var Ec=z((Pie,qS)=>{"use strict";var st=Mt(),CL=Fi(),wL=RS();function nv(n){return st.isPlainObject(n)||st.isArray(n)}function BS(n){return st.endsWith(n,"[]")?n.slice(0,-2):n}function NS(n,e,t){return n?n.concat(e).map(function(i,o){return i=BS(i),!t&&o?"["+i+"]":i}).join(t?".":""):e}function PL(n){return st.isArray(n)&&!n.some(nv)}var OL=st.toFlatObject(st,{},null,function(e){return/^is[A-Z]/.test(e)});function ML(n){return n&&st.isFunction(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator]}function SL(n,e,t){if(!st.isObject(n))throw new TypeError("target must be an object");e=e||new(wL||FormData),t=st.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,x){return!st.isUndefined(x[f])});var r=t.metaTokens,i=t.visitor||h,o=t.dots,a=t.indexes,s=t.Blob||typeof Blob<"u"&&Blob,c=s&&ML(e);if(!st.isFunction(i))throw new TypeError("visitor must be a function");function l(m){if(m===null)return"";if(st.isDate(m))return m.toISOString();if(!c&&st.isBlob(m))throw new CL("Blob is not supported. Use a Buffer instead.");return st.isArrayBuffer(m)||st.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function h(m,f,x){var b=m;if(m&&!x&&typeof m=="object"){if(st.endsWith(f,"{}"))f=r?f:f.slice(0,-2),m=JSON.stringify(m);else if(st.isArray(m)&&PL(m)||st.isFileList(m)||st.endsWith(f,"[]")&&(b=st.toArray(m)))return f=BS(f),b.forEach(function(O,S){!st.isUndefined(O)&&e.append(a===!0?NS([f],S,o):a===null?f:f+"[]",l(O))}),!1}return nv(m)?!0:(e.append(NS(x,f,o),l(m)),!1)}var u=[],d=Object.assign(OL,{defaultVisitor:h,convertValue:l,isVisitable:nv});function p(m,f){if(!st.isUndefined(m)){if(u.indexOf(m)!==-1)throw Error("Circular reference detected in "+f.join("."));u.push(m),st.forEach(m,function(b,_){var O=!st.isUndefined(b)&&i.call(e,b,st.isString(_)?_.trim():_,f,d);O===!0&&p(b,f?f.concat(_):[_])}),u.pop()}}if(!st.isObject(n))throw new TypeError("data must be an object");return p(n),e}qS.exports=SL});var rv=z((Oie,HS)=>{"use strict";var EL=Ec();function LS(n){var e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'\(\)~]|%20|%00/g,function(r){return e[r]})}function jS(n,e){this._pairs=[],n&&EL(n,this,e)}var VS=jS.prototype;VS.append=function(e,t){this._pairs.push([e,t])};VS.toString=function(e){var t=e?function(r){return e.call(this,r,LS)}:LS;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};HS.exports=jS});var iv=z((Mie,US)=>{"use strict";var AL=Mt(),kL=rv();function DL(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}US.exports=function(e,t,r){if(!t)return e;var i=e.indexOf("#");i!==-1&&(e=e.slice(0,i));var o=r&&r.encode||DL,a=r&&r.serialize,s;return a?s=a(t,r):s=AL.isURLSearchParams(t)?t.toString():new kL(t,r).toString(o),s&&(e+=(e.indexOf("?")===-1?"?":"&")+s),e}});var WS=z((Sie,GS)=>{"use strict";var FL=Mt();function Ac(){this.handlers=[]}Ac.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};Ac.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};Ac.prototype.clear=function(){this.handlers&&(this.handlers=[])};Ac.prototype.forEach=function(e){FL.forEach(this.handlers,function(r){r!==null&&e(r)})};GS.exports=Ac});var ov=z((Eie,KS)=>{"use strict";var TL=Mt();KS.exports=function(e,t){TL.forEach(e,function(i,o){o!==t&&o.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[o])})}});var av=z((Aie,$S)=>{"use strict";$S.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}});var JS=z((kie,XS)=>{"use strict";var zL=rv();XS.exports=typeof URLSearchParams<"u"?URLSearchParams:zL});var YS=z((Die,QS)=>{"use strict";QS.exports=FormData});var e2=z((Fie,ZS)=>{"use strict";ZS.exports={isBrowser:!0,classes:{URLSearchParams:JS(),FormData:YS(),Blob},protocols:["http","https","file","blob","url","data"]}});var yu=z((Tie,t2)=>{"use strict";t2.exports=e2()});var i2=z((zie,r2)=>{"use strict";var IL=Mt(),RL=Ec(),n2=yu();r2.exports=function(e,t){return RL(e,new n2.classes.URLSearchParams,Object.assign({visitor:function(r,i,o,a){return n2.isNode&&IL.isBuffer(r)?(this.append(i,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}});var sv=z((Iie,o2)=>{"use strict";var Ti=Mt();function NL(n){return Ti.matchAll(/\w+|\[(\w*)]/g,n).map(function(e){return e[0]==="[]"?"":e[1]||e[0]})}function BL(n){var e={},t=Object.keys(n),r,i=t.length,o;for(r=0;r<i;r++)o=t[r],e[o]=n[o];return e}function qL(n){function e(r,i,o,a){var s=r[a++],c=Number.isFinite(+s),l=a>=r.length;if(s=!s&&Ti.isArray(o)?o.length:s,l)return Ti.hasOwnProperty(o,s)?o[s]=[o[s],i]:o[s]=i,!c;(!o[s]||!Ti.isObject(o[s]))&&(o[s]=[]);var h=e(r,i,o[s],a);return h&&Ti.isArray(o[s])&&(o[s]=BL(o[s])),!c}if(Ti.isFormData(n)&&Ti.isFunction(n.entries)){var t={};return Ti.forEachEntry(n,function(r,i){e(NL(r),i,t,0)}),t}return null}o2.exports=qL});var s2=z((Rie,a2)=>{"use strict";var cv=Fi();a2.exports=function(e,t,r){var i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new cv("Request failed with status code "+r.status,[cv.ERR_BAD_REQUEST,cv.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}});var l2=z((Nie,c2)=>{"use strict";var Cu=Mt();c2.exports=Cu.isStandardBrowserEnv()?function(){return{write:function(t,r,i,o,a,s){var c=[];c.push(t+"="+encodeURIComponent(r)),Cu.isNumber(i)&&c.push("expires="+new Date(i).toGMTString()),Cu.isString(o)&&c.push("path="+o),Cu.isString(a)&&c.push("domain="+a),s===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(t){var r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var u2=z((Bie,d2)=>{"use strict";d2.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}});var p2=z((qie,h2)=>{"use strict";h2.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}});var lv=z((Lie,g2)=>{"use strict";var LL=u2(),jL=p2();g2.exports=function(e,t){return e&&!LL(t)?jL(e,t):t}});var m2=z((jie,f2)=>{"use strict";var dv=Mt(),VL=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];f2.exports=function(e){var t={},r,i,o;return e&&dv.forEach(e.split(`
`),function(s){if(o=s.indexOf(":"),r=dv.trim(s.slice(0,o)).toLowerCase(),i=dv.trim(s.slice(o+1)),r){if(t[r]&&VL.indexOf(r)>=0)return;r==="set-cookie"?t[r]=(t[r]?t[r]:[]).concat([i]):t[r]=t[r]?t[r]+", "+i:i}}),t}});var x2=z((Vie,b2)=>{"use strict";var v2=Mt();b2.exports=v2.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),r;function i(o){var a=o;return e&&(t.setAttribute("href",a),a=t.href),t.setAttribute("href",a),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=i(window.location.href),function(a){var s=v2.isString(a)?i(a):a;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}()});var kc=z((Hie,y2)=>{"use strict";var uv=Fi(),HL=Mt();function _2(n,e,t){uv.call(this,n??"canceled",uv.ERR_CANCELED,e,t),this.name="CanceledError"}HL.inherits(_2,uv,{__CANCEL__:!0});y2.exports=_2});var w2=z((Uie,C2)=>{"use strict";C2.exports=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}});var hv=z((Gie,P2)=>{"use strict";var Da=Mt(),UL=s2(),GL=l2(),WL=iv(),KL=lv(),$L=m2(),XL=x2(),JL=av(),Ur=Fi(),QL=kc(),YL=w2(),ZL=yu();P2.exports=function(e){return new Promise(function(r,i){var o=e.data,a=e.headers,s=e.responseType,c=e.withXSRFToken,l;function h(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}Da.isFormData(o)&&Da.isStandardBrowserEnv()&&delete a["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";a.Authorization="Basic "+btoa(d+":"+p)}var m=KL(e.baseURL,e.url);u.open(e.method.toUpperCase(),WL(m,e.params,e.paramsSerializer),!0),u.timeout=e.timeout;function f(){if(u){var _="getAllResponseHeaders"in u?$L(u.getAllResponseHeaders()):null,O=!s||s==="text"||s==="json"?u.responseText:u.response,S={data:O,status:u.status,statusText:u.statusText,headers:_,config:e,request:u};UL(function(F){r(F),h()},function(F){i(F),h()},S),u=null}}if("onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(f)},u.onabort=function(){u&&(i(new Ur("Request aborted",Ur.ECONNABORTED,e,u)),u=null)},u.onerror=function(){i(new Ur("Network Error",Ur.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){var O=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",S=e.transitional||JL;e.timeoutErrorMessage&&(O=e.timeoutErrorMessage),i(new Ur(O,S.clarifyTimeoutError?Ur.ETIMEDOUT:Ur.ECONNABORTED,e,u)),u=null},Da.isStandardBrowserEnv()&&(c&&Da.isFunction(c)&&(c=c(e)),c||c!==!1&&XL(m))){var x=e.xsrfHeaderName&&e.xsrfCookieName&&GL.read(e.xsrfCookieName);x&&(a[e.xsrfHeaderName]=x)}"setRequestHeader"in u&&Da.forEach(a,function(O,S){typeof o>"u"&&S.toLowerCase()==="content-type"?delete a[S]:u.setRequestHeader(S,O)}),Da.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),s&&s!=="json"&&(u.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&u.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(l=function(_){u&&(i(!_||_.type?new QL(null,e,u):_),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l))),!o&&o!==!1&&o!==0&&o!==""&&(o=null);var b=YL(m);if(b&&ZL.protocols.indexOf(b)===-1){i(new Ur("Unsupported protocol "+b+":",Ur.ERR_BAD_REQUEST,e));return}u.send(o)})}});var Pu=z((Wie,A2)=>{"use strict";var Dt=Mt(),O2=ov(),M2=Fi(),ej=av(),tj=Ec(),nj=i2(),S2=yu(),rj=sv(),ij={"Content-Type":"application/x-www-form-urlencoded"};function E2(n,e){!Dt.isUndefined(n)&&Dt.isUndefined(n["Content-Type"])&&(n["Content-Type"]=e)}function oj(){var n;return typeof XMLHttpRequest<"u"?n=hv():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(n=hv()),n}function aj(n,e,t){if(Dt.isString(n))try{return(e||JSON.parse)(n),Dt.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}var wu={transitional:ej,adapter:oj(),transformRequest:[function(e,t){O2(t,"Accept"),O2(t,"Content-Type");var r=t&&t["Content-Type"]||"",i=r.indexOf("application/json")>-1,o=Dt.isObject(e);o&&Dt.isHTMLForm(e)&&(e=new FormData(e));var a=Dt.isFormData(e);if(a)return i?JSON.stringify(rj(e)):e;if(Dt.isArrayBuffer(e)||Dt.isBuffer(e)||Dt.isStream(e)||Dt.isFile(e)||Dt.isBlob(e))return e;if(Dt.isArrayBufferView(e))return e.buffer;if(Dt.isURLSearchParams(e))return E2(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var s;if(o){if(r.indexOf("application/x-www-form-urlencoded")!==-1)return nj(e,this.formSerializer).toString();if((s=Dt.isFileList(e))||r.indexOf("multipart/form-data")>-1){var c=this.env&&this.env.FormData;return tj(s?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||i?(E2(t,"application/json"),aj(e)):e}],transformResponse:[function(e){var t=this.transitional||wu.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(e&&Dt.isString(e)&&(r&&!this.responseType||i)){var o=t&&t.silentJSONParsing,a=!o&&i;try{return JSON.parse(e)}catch(s){if(a)throw s.name==="SyntaxError"?M2.from(s,M2.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:S2.classes.FormData,Blob:S2.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Dt.forEach(["delete","get","head"],function(e){wu.headers[e]={}});Dt.forEach(["post","put","patch"],function(e){wu.headers[e]=Dt.merge(ij)});A2.exports=wu});var D2=z((Kie,k2)=>{"use strict";var sj=Mt(),cj=Pu();k2.exports=function(e,t,r,i){var o=this||cj;return sj.forEach(i,function(s){e=s.call(o,e,t,r)}),e}});var pv=z(($ie,F2)=>{"use strict";F2.exports=function(e){return!!(e&&e.__CANCEL__)}});var R2=z((Xie,I2)=>{"use strict";var T2=Mt(),gv=D2(),lj=pv(),dj=Pu(),uj=kc(),z2=ov();function fv(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new uj}I2.exports=function(e){fv(e),e.headers=e.headers||{},e.data=gv.call(e,e.data,e.headers,null,e.transformRequest),z2(e.headers,"Accept"),z2(e.headers,"Content-Type"),e.headers=T2.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),T2.forEach(["delete","get","head","post","put","patch","common"],function(i){delete e.headers[i]});var t=e.adapter||dj.adapter;return t(e).then(function(i){return fv(e),i.data=gv.call(e,i.data,i.headers,i.status,e.transformResponse),i},function(i){return lj(i)||(fv(e),i&&i.response&&(i.response.data=gv.call(e,i.response.data,i.response.headers,i.response.status,e.transformResponse))),Promise.reject(i)})}});var mv=z((Jie,N2)=>{"use strict";var mn=Mt();N2.exports=function(e,t){t=t||{};var r={};function i(h,u){return mn.isPlainObject(h)&&mn.isPlainObject(u)?mn.merge(h,u):mn.isEmptyObject(u)?mn.merge({},h):mn.isPlainObject(u)?mn.merge({},u):mn.isArray(u)?u.slice():u}function o(h){if(mn.isUndefined(t[h])){if(!mn.isUndefined(e[h]))return i(void 0,e[h])}else return i(e[h],t[h])}function a(h){if(!mn.isUndefined(t[h]))return i(void 0,t[h])}function s(h){if(mn.isUndefined(t[h])){if(!mn.isUndefined(e[h]))return i(void 0,e[h])}else return i(void 0,t[h])}function c(h){if(h in t)return i(e[h],t[h]);if(h in e)return i(void 0,e[h])}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c};return mn.forEach(Object.keys(e).concat(Object.keys(t)),function(u){var d=l[u]||o,p=d(u);mn.isUndefined(p)&&d!==c||(r[u]=p)}),r}});var vv=z((Qie,B2)=>{B2.exports={version:"0.28.1"}});var j2=z((Yie,L2)=>{"use strict";var hj=vv().version,zi=Fi(),bv={};["object","boolean","number","function","string","symbol"].forEach(function(n,e){bv[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});var q2={};bv.transitional=function(e,t,r){function i(o,a){return"[Axios v"+hj+"] Transitional option '"+o+"'"+a+(r?". "+r:"")}return function(o,a,s){if(e===!1)throw new zi(i(a," has been removed"+(t?" in "+t:"")),zi.ERR_DEPRECATED);return t&&!q2[a]&&(q2[a]=!0,console.warn(i(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,a,s):!0}};function pj(n,e,t){if(typeof n!="object")throw new zi("options must be an object",zi.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(n),i=r.length;i-- >0;){var o=r[i],a=e[o];if(a){var s=n[o],c=s===void 0||a(s,o,n);if(c!==!0)throw new zi("option "+o+" must be "+c,zi.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new zi("Unknown option "+o,zi.ERR_BAD_OPTION)}}L2.exports={assertOptions:pj,validators:bv}});var G2=z((Zie,U2)=>{"use strict";var _v=Mt(),gj=iv(),V2=WS(),H2=R2(),Ou=mv(),fj=lv(),xv=j2(),Ii=xv.validators;function Fa(n){this.defaults=n,this.interceptors={request:new V2,response:new V2}}Fa.prototype.request=function(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ou(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;r!==void 0&&xv.assertOptions(r,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean)},!1);var i=t.paramsSerializer;i!==void 0&&xv.assertOptions(i,{encode:Ii.function,serialize:Ii.function},!0),_v.isFunction(i)&&(t.paramsSerializer={serialize:i});var o=[],a=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(a=a&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});var s=[];this.interceptors.response.forEach(function(m){s.push(m.fulfilled,m.rejected)});var c;if(!a){var l=[H2,void 0];for(Array.prototype.unshift.apply(l,o),l=l.concat(s),c=Promise.resolve(t);l.length;)c=c.then(l.shift(),l.shift());return c}for(var h=t;o.length;){var u=o.shift(),d=o.shift();try{h=u(h)}catch(p){d(p);break}}try{c=H2(h)}catch(p){return Promise.reject(p)}for(;s.length;)c=c.then(s.shift(),s.shift());return c};Fa.prototype.getUri=function(e){e=Ou(this.defaults,e);var t=fj(e.baseURL,e.url);return gj(t,e.params,e.paramsSerializer)};_v.forEach(["delete","get","head","options"],function(e){Fa.prototype[e]=function(t,r){return this.request(Ou(r||{},{method:e,url:t,data:(r||{}).data}))}});_v.forEach(["post","put","patch"],function(e){function t(r){return function(o,a,s){return this.request(Ou(s||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}Fa.prototype[e]=t(),Fa.prototype[e+"Form"]=t(!0)});U2.exports=Fa});var K2=z((eoe,W2)=>{"use strict";var mj=kc();function Ta(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(i){e=i});var t=this;this.promise.then(function(r){if(t._listeners){for(var i=t._listeners.length;i-- >0;)t._listeners[i](r);t._listeners=null}}),this.promise.then=function(r){var i,o=new Promise(function(a){t.subscribe(a),i=a}).then(r);return o.cancel=function(){t.unsubscribe(i)},o},n(function(i,o,a){t.reason||(t.reason=new mj(i,o,a),e(t.reason))})}Ta.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Ta.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};Ta.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}};Ta.source=function(){var e,t=new Ta(function(i){e=i});return{token:t,cancel:e}};W2.exports=Ta});var X2=z((toe,$2)=>{"use strict";$2.exports=function(e){return function(r){return e.apply(null,r)}}});var Q2=z((noe,J2)=>{"use strict";var vj=Mt();J2.exports=function(e){return vj.isObject(e)&&e.isAxiosError===!0}});var Z2=z((roe,Cv)=>{"use strict";var yv=Mt(),bj=Xm(),Mu=G2(),xj=mv(),_j=Pu(),yj=sv();function Y2(n){var e=new Mu(n),t=bj(Mu.prototype.request,e);return yv.extend(t,Mu.prototype,e),yv.extend(t,e),t.create=function(i){return Y2(xj(n,i))},t}var vn=Y2(_j);vn.Axios=Mu;vn.CanceledError=kc();vn.CancelToken=K2();vn.isCancel=pv();vn.VERSION=vv().version;vn.toFormData=Ec();vn.AxiosError=Fi();vn.Cancel=vn.CanceledError;vn.all=function(e){return Promise.all(e)};vn.spread=X2();vn.isAxiosError=Q2();vn.formToJSON=function(n){return yj(yv.isHTMLForm(n)?new FormData(n):n)};Cv.exports=vn;Cv.exports.default=vn});var tE=z((ioe,eE)=>{eE.exports=Z2()});function cr(n,e){if(n==="")return e===void 0?"":e.absolutePath;{let t=n.startsWith("/")?n.slice(1):n;return t=t.endsWith("/")?t.slice(0,-1):t,e===void 0?`/${t}`:`${e.absolutePath==="/"?"":e.absolutePath}/${t}`}}var dE=W(()=>{});function Bi(n){if(n!==null&&typeof n=="object"&&n.errorFromRequestFluidObject===!0){let r=n;return{mimeType:"text/plain",status:r.code,value:r.message,get stack(){return r.stack}}}let t=pa();return{mimeType:"text/plain",status:500,value:`${n}`,get stack(){var r;return(r=n?.stack)!==null&&r!==void 0?r:t.stack}}}function qi(n,e){let t=n.value,r=pa();return{errorFromRequestFluidObject:!0,message:t,name:"Error",code:n.status,get stack(){var o;return(o=n.stack)!==null&&o!==void 0?o:r.stack}}}function Ar(n,e){return v(this,null,function*(){let t=typeof e=="string"?{url:e}:e,r=yield n.request(t);if(r.status!==200||r.mimeType!=="fluid/object")throw qi(r,t);return w(r.value,410),r.value})}function Fu(n,e,t){var r;w(n!==200,411);let i=(r=t.url)===null||r===void 0?void 0:r.split("?")[0],o=pa();return{mimeType:"text/plain",status:n,value:i===void 0?e:`${e}: ${i}`,get stack(){return o.stack}}}function Mj(n,e){return{type:n,get IFluidDataStoreFactory(){return this},get IFluidDataStoreRegistry(){return this},instantiateDataStore:(t,r)=>v(this,null,function*(){return(yield e).instantiateDataStore(t,r)}),get:t=>v(this,null,function*(){var r;return(r=(yield e).IFluidDataStoreRegistry)===null||r===void 0?void 0:r.get(t)})}}var Ft,uE=W(()=>{Y();Oe();Ft=n=>Fu(404,"not found",n)});var Fv,hE=W(()=>{Y();Fv=class{constructor(e,t){this.storage=e,this.path=t,w(!t.endsWith("/"),412)}readBlob(e){return v(this,null,function*(){return this.storage.readBlob(`${this.path}/${e}`)})}contains(e){return v(this,null,function*(){return this.storage.contains(`${this.path}/${e}`)})}list(e){return v(this,null,function*(){return this.storage.list(`${this.path}/${e}`)})}}});function Tu(n){let e=n;return e.startsWith("/")&&(e=e.substr(1)),e.endsWith("/")&&(e=e.substr(0,e.length-1)),e.length>0?e.split("/"):[]}function Sj(n,e){return v(this,null,function*(){let t=Tu(e),r=n;for(;r?.entries!==void 0&&t.length>0;){let i=t.shift(),o=r.entries.find(a=>a.type==="Tree"&&a.path===i);o?.type==="Tree"?r=o.value:r=void 0}if(r?.entries===void 0||t.length!==0)throw new Error("path does not exist");return r.entries.filter(i=>i.type==="Blob").map(i=>i.path)})}var pE=W(()=>{});var Sn,gE=W(()=>{Sn=class n{constructor(e){this.request=e;let t=this.request.url.indexOf("?");t>=0?this.query=this.request.url.substring(t):this.query=""}static getPathParts(e){let t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((r,i)=>(i!==void 0&&i.length>0&&r.push(decodeURIComponent(i)),r),[])}static create(e){return e instanceof n?e:new n(e)}get url(){return this.request.url}get headers(){return this.request.headers}get pathParts(){return this.requestPathParts===void 0&&(this.requestPathParts=n.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return this.query===""&&this.pathParts.length===e}createSubRequest(e){let t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};let r=`/${this.pathParts.slice(e).join("/")}`;return{url:this.query===""?r:`${r}/${this.query}`,headers:this.headers}}}});var Rc,fE=W(()=>{Rc=class{get IRuntimeFactory(){return this}instantiateRuntime(e,t){return v(this,null,function*(){let r=t===void 0?e.existing===!0:t,i=yield this.preInitialize(e,r);return r?yield this.instantiateFromExisting(i):yield this.instantiateFirstTime(i),yield this.hasInitialized(i),i})}instantiateFirstTime(e){return v(this,null,function*(){})}instantiateFromExisting(e){return v(this,null,function*(){})}hasInitialized(e){return v(this,null,function*(){})}}});var mE=z(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.IFluidDataStoreFactory=void 0;zu.IFluidDataStoreFactory="IFluidDataStoreFactory"});var vE=z(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.IFluidDataStoreRegistry=void 0;Iu.IFluidDataStoreRegistry="IFluidDataStoreRegistry"});var bE=z(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.VisibilityState=Co.FlushMode=void 0;var Ej;(function(n){n[n.Immediate=0]="Immediate",n[n.TurnBased=1]="TurnBased"})(Ej=Co.FlushMode||(Co.FlushMode={}));Co.VisibilityState={NotVisible:"NotVisible",LocallyVisible:"LocallyVisible",GloballyVisible:"GloballyVisible"}});var xE=z(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.gcBlobKey=void 0;Ru.gcBlobKey="gc"});var yE=z(_E=>{"use strict";Object.defineProperty(_E,"__esModule",{value:!0})});var CE=z(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.totalBlobSizePropertyName=lr.blobCountPropertyName=lr.channelsTreeName=lr.CreateSummarizerNodeSource=void 0;var Aj;(function(n){n[n.FromSummary=0]="FromSummary",n[n.FromAttach=1]="FromAttach",n[n.Local=2]="Local"})(Aj=lr.CreateSummarizerNodeSource||(lr.CreateSummarizerNodeSource={}));lr.channelsTreeName=".channels";lr.blobCountPropertyName="BlobCount";lr.totalBlobSizePropertyName="TotalBlobSize"});var Ln=z(Jn=>{"use strict";var kj=Jn&&Jn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Na=Jn&&Jn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&kj(e,n,t)};Object.defineProperty(Jn,"__esModule",{value:!0});Na(mE(),Jn);Na(vE(),Jn);Na(bE(),Jn);Na(xE(),Jn);Na(yE(),Jn);Na(CE(),Jn)});var wE=W(()=>{});var PE=W(()=>{});var OE=W(()=>{});var ME=W(()=>{});var Nc,SE=W(()=>{Nc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(Nc||{})});var bt,EE=W(()=>{bt=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(bt||{})});var AE=W(()=>{});var kE=W(()=>{});var DE=W(()=>{});var FE=W(()=>{});var Nu=W(()=>{wE();PE();OE();ME();SE();EE();AE();kE();DE();FE();});function dr(...n){let e={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0,unreferencedBlobSize:0};for(let t of n)e.treeNodeCount+=t.treeNodeCount,e.blobNodeCount+=t.blobNodeCount,e.handleNodeCount+=t.handleNodeCount,e.totalBlobSize+=t.totalBlobSize,e.unreferencedBlobSize+=t.unreferencedBlobSize;return e}function TE(n){let e=n.length;for(let t=n.length-1;t>=0;t--){let r=n.charCodeAt(t);r>127&&r<=2047?e++:r>2047&&r<=65535&&(e+=2),r>=56320&&r<=57343&&t--}return e}function Tv(n){return typeof n=="string"?TE(n):n.byteLength}function zE(n,e){switch(n.type){case bt.Tree:{e.treeNodeCount++;for(let t of Object.values(n.tree))zE(t,e);return}case bt.Handle:{e.handleNodeCount++;return}case bt.Blob:{e.blobNodeCount++,e.totalBlobSize+=Tv(n.content);return}default:return}}function qc(n){let e=dr();return zE(n,e),e}function En(n,e,t){let r={type:bt.Blob,content:t};n.summary.tree[e]=r,n.stats.blobNodeCount++,n.stats.totalBlobSize+=Tv(t)}function zv(n,e,t){n.summary.tree[e]=t.summary,n.stats=dr(n.stats,t.stats)}function Iv(n,e,t){n.summary.tree[e]=t.summary,n.stats=dr(n.stats,t.stats)}function IE(n,e=!1){let t=new Pt;for(let i of n.entries)switch(i.type){case Nc.Blob:{let o=i.value,a;o.encoding==="base64"?a=Wt.from(o.contents,"base64"):a=o.contents,t.addBlob(i.path,a);break}case Nc.Tree:{let o=Ba(i.value,e);t.addWithStats(i.path,o);break}case Nc.Attachment:{let o=i.value.id;t.addAttachment(o);break}default:throw new Error("Unexpected TreeEntry type")}let r=t.getSummaryTree();return r.summary.unreferenced=n.unreferenced,r}function Ba(n,e=!1){if(n.id&&!e){let t=dr();return t.handleNodeCount++,{summary:{handle:n.id,handleType:bt.Tree,type:bt.Handle},stats:t}}else return IE(n,e)}function qa(n){let e=new Pt;for(let[r,i]of Object.entries(n.blobs)){let o;if(n.blobsContents!==void 0){let a=n.blobsContents[i];a!==void 0&&(o=gi(a,"utf-8"))}else n.blobs[i]!==void 0&&(o=cf(n.blobs[i]));o!==void 0&&e.addBlob(r,o)}for(let[r,i]of Object.entries(n.trees)){let o=qa(i);e.addWithStats(r,o)}let t=e.getSummaryTree();return t.summary.unreferenced=n.unreferenced,t}function La(n){let e=[];for(let[t,r]of Object.entries(n.tree))switch(r.type){case bt.Blob:{let i,o="utf-8";typeof r.content=="string"?i=r.content:(i=Pn(r.content,"base64"),o="base64"),e.push(new fa(t,i,o));break}case bt.Tree:{e.push(new Jd(t,La(r)));break}case bt.Attachment:{e.push(new Qd(t,r.id));break}case bt.Handle:throw new Error("Should not have Handle type in summary tree");default:mt(r,"Unexpected summary tree type")}return{entries:e,unreferenced:n.unreferenced}}var Pt,Bc,Bu=W(()=>{Y();Hr();Nu();Pt=class{constructor(){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=dr(),this.summaryStats.treeNodeCount++}get summary(){return{type:bt.Tree,tree:Object.assign({},this.summaryTree)}}get stats(){return Object.assign({},this.summaryStats)}addBlob(e,t){En({summary:{type:bt.Tree,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,r){this.summaryTree[e]={type:bt.Handle,handleType:t,handle:r},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=dr(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:bt.Attachment}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}};Bc=class{constructor(){this.telemetry=new Map}set(e,t,r){this.telemetry.set(`${e}${t}`,r)}get(e,t){return this.telemetry.get(`${e}${t}`)}serialize(){let e={};return this.telemetry.forEach((t,r)=>{e[r]=t}),JSON.stringify(e)}}});function Rv(n,e){let t=n,r=[],i=[];for(let o=0;;o++){o>RE&&e.sendTelemetryEvent({eventName:"DecodeSummaryMaxDepth",maxDecodeDepth:RE});let a=t.blobs[NE],s=t.trees[Lc];if(a===void 0&&s===void 0){let c;return{baseSummary:t,pathParts:r,getOutstandingOps(l){return v(this,null,function*(){let h=[];for(let u of i){let d=yield l(u);if(h.length>0&&d.length>0){let p=h[h.length-1].sequenceNumber,m=d[0].sequenceNumber;if(m<=p)for(e.sendTelemetryEvent({eventName:"DuplicateOutstandingOps",message:`newEarliestSeq <= latestSeq in decodeSummary: ${m} <= ${p}`});d.length>0&&d[0].sequenceNumber<=p;)d.shift()}h=h.concat(d)}return h})}}}w(!!a,431),w(s!==void 0,432),t=s,r.push(Lc),i.unshift(a)}}function BE(n,e){let t=An.create(Lc),r=new Pt;if(r.addBlob(NE,JSON.stringify(e)),n.fromSummary){let o=n.summaryNode;o.additionalPath!==void 0&&(t=t.concat(o.additionalPath)),r.addHandle(Lc,bt.Tree,o.fullPath.path)}else r.addWithStats(Lc,n.initialSummary);let i=r.getSummaryTree();return Object.assign(Object.assign({},i),{additionalPath:t})}function qu(n){let e=n.trees[jc.channelsTreeName];return e!==void 0?{childrenTree:e,childrenPathPart:jc.channelsTreeName}:{childrenTree:n,childrenPathPart:void 0}}function qE(n){let e=n.tree[jc.channelsTreeName];return e!==void 0?{childrenTree:e,childrenPathPart:jc.channelsTreeName}:{childrenTree:n,childrenPathPart:void 0}}var jc,Lc,NE,RE,An,kr,Nv=W(()=>{Y();Nu();jc=Ce(Ln());Bu();Lc="_baseSummary",NE="_outstandingOps",RE=100,An=class n{constructor(e){this.path=e}static create(e){return new n(encodeURIComponent(e))}static createAndConcat(e){var t;let r=n.create((t=e[0])!==null&&t!==void 0?t:"");for(let i=1;i<e.length;i++)r=r.concat(n.create(e[i]));return r}toString(){return this.path}concat(e){return new n(`${this.path}/${e.path}`)}},kr=class n{constructor(e){this.summary=e}static createForRoot(e){return new n({referenceSequenceNumber:e,basePath:void 0,localPath:An.create("")})}get referenceSequenceNumber(){return this.summary.referenceSequenceNumber}get basePath(){return this.summary.basePath}get localPath(){return this.summary.localPath}get additionalPath(){return this.summary.additionalPath}set additionalPath(e){this.summary.additionalPath=e}get fullPath(){var e,t;return(t=(e=this.basePath)===null||e===void 0?void 0:e.concat(this.localPath))!==null&&t!==void 0?t:this.localPath}get fullPathForChildren(){return this.additionalPath!==void 0?this.fullPath.concat(this.additionalPath):this.fullPath}createForChild(e){return new n({referenceSequenceNumber:this.referenceSequenceNumber,basePath:this.fullPathForChildren,localPath:An.create(e)})}}});var Vc,Hc,LE,Bv=W(()=>{Vc=Ce(Ln());Nu();Y();Bu();Nv();Hc=class n{constructor(e,t,r,i,o,a,s){var c;this.defaultLogger=e,this.summarizeInternalFn=t,this._changeSequenceNumber=i,this._latestSummary=o,this.initialSummary=a,this.wipSummaryLogger=s,this.children=new Map,this.pendingSummaries=new Map,this.outstandingOps=[],this.wipSkipRecursion=!1,this.canReuseHandle=(c=r.canReuseHandle)!==null&&c!==void 0?c:!0,this.throwOnError=!0,this.trackingSequenceNumber=this._changeSequenceNumber}get referenceSequenceNumber(){var e,t;return(t=(e=this._latestSummary)===null||e===void 0?void 0:e.referenceSequenceNumber)!==null&&t!==void 0?t:0}startSummary(e,t){w(this.wipSummaryLogger===void 0,415),w(this.wipReferenceSequenceNumber===void 0,416),this.wipSummaryLogger=t;for(let r of this.children.values())r.startSummary(e,this.wipSummaryLogger);this.wipReferenceSequenceNumber=e}summarize(e,t=!0,r){return v(this,null,function*(){if(w(this.isTrackingInProgress(),417),w(this.wipSummaryLogger!==void 0,418),this.canReuseHandle&&!e&&!this.hasChanged()){let i=this._latestSummary;if(i!==void 0){this.wipLocalPaths={localPath:i.localPath,additionalPath:i.additionalPath},this.wipSkipRecursion=!0;let o=dr();return o.handleNodeCount++,{summary:{type:bt.Handle,handle:i.fullPath.path,handleType:bt.Tree},stats:o}}}try{let i=yield this.summarizeInternalFn(e,!0,r);return this.wipLocalPaths={localPath:An.create(i.id)},i.pathPartsForChildren!==void 0&&(this.wipLocalPaths.additionalPath=An.createAndConcat(i.pathPartsForChildren)),{summary:i.summary,stats:i.stats}}catch(i){if(this.throwOnError||this.trackingSequenceNumber<this._changeSequenceNumber)throw i;let o=this._latestSummary,a=this.initialSummary,s,c;if(o!==void 0)s={fromSummary:!0,summaryNode:o},c=o.localPath;else if(a?.summary!==void 0)s={fromSummary:!1,initialSummary:a.summary},c=An.create(a.id);else throw i;this.wipSummaryLogger.sendErrorEvent({eventName:"SummarizingWithBasePlusOps"},i);let l=BE(s,this.outstandingOps);return this.wipLocalPaths={localPath:c,additionalPath:l.additionalPath},this.wipSkipRecursion=!0,{summary:l.summary,stats:l.stats}}})}completeSummary(e){this.completeSummaryCore(e,void 0,!1)}completeSummaryCore(e,t,r){w(this.wipSummaryLogger!==void 0,419),w(this.wipReferenceSequenceNumber!==void 0,420);let i=this.wipLocalPaths;if(r){let s=this._latestSummary;if(s!==void 0)i={localPath:s.localPath,additionalPath:s.additionalPath};else{this.clearSummary();return}}w(!!i,421);let o=new kr(Object.assign(Object.assign({},i),{referenceSequenceNumber:this.wipReferenceSequenceNumber,basePath:t})),a=o.fullPathForChildren;for(let s of this.children.values())s.completeSummaryCore(e,a,this.wipSkipRecursion||r);this.pendingSummaries.set(e,o),this.clearSummary()}clearSummary(){this.wipReferenceSequenceNumber=void 0,this.wipLocalPaths=void 0,this.wipSkipRecursion=!1,this.wipSummaryLogger=void 0;for(let e of this.children.values())e.clearSummary()}refreshLatestSummary(e,t,r,i,o){return v(this,null,function*(){if(e!==void 0){let s=this.pendingSummaries.get(e);if(s!==void 0)return this.refreshLatestSummaryFromPending(e,s.referenceSequenceNumber),{latestSummaryUpdated:!0,wasSummaryTracked:!0}}if(this.referenceSequenceNumber>=t)return{latestSummaryUpdated:!1};let a=yield r();return yield this.refreshLatestSummaryFromSnapshot(t,a,void 0,An.create(""),o,i),{latestSummaryUpdated:!0,wasSummaryTracked:!1,snapshot:a}})}refreshLatestSummaryFromPending(e,t){let r=this.pendingSummaries.get(e);if(r===void 0){w(this._latestSummary===void 0,422);return}else w(t===r.referenceSequenceNumber,423),this.pendingSummaries.delete(e);this.refreshLatestSummaryCore(t),this._latestSummary=r;for(let i of this.children.values())i.refreshLatestSummaryFromPending(e,t)}refreshLatestSummaryFromSnapshot(e,t,r,i,o,a){return v(this,null,function*(){if(this.referenceSequenceNumber>=e)return;this.refreshLatestSummaryCore(e);let{baseSummary:s,pathParts:c}=Rv(t,o);this._latestSummary=new kr({referenceSequenceNumber:e,basePath:r,localPath:i});let{childrenTree:l,childrenPathPart:h}=qu(s);h!==void 0&&c.push(h),c.length>0&&(this._latestSummary.additionalPath=An.createAndConcat(c));let u=this._latestSummary.fullPathForChildren;yield Promise.all(Array.from(this.children).filter(([d])=>l.trees[d]!==void 0).map(m=>v(this,[m],function*([d,p]){return p.refreshLatestSummaryFromSnapshot(e,l.trees[d],u,An.create(d),o,a)})))})}refreshLatestSummaryCore(e){for(let[t,r]of this.pendingSummaries)r.referenceSequenceNumber<e&&this.pendingSummaries.delete(t);for(;this.outstandingOps.length>0&&this.outstandingOps[0].sequenceNumber<=e;)this.outstandingOps.shift()}loadBaseSummaryWithoutDifferential(e){let{childrenPathPart:t}=qu(e);t!==void 0&&this._latestSummary!==void 0&&(this._latestSummary.additionalPath=An.create(t))}loadBaseSummary(e,t){return v(this,null,function*(){let r=Rv(e,this.defaultLogger),i=yield r.getOutstandingOps(t),{childrenPathPart:o}=qu(r.baseSummary);if(o!==void 0&&r.pathParts.push(o),r.pathParts.length>0&&this._latestSummary!==void 0&&(this._latestSummary.additionalPath=An.createAndConcat(r.pathParts)),i.length>0){let a=i[i.length-1].sequenceNumber;w(a<=this.trackingSequenceNumber,425)}return{baseSummary:r.baseSummary,outstandingOps:i}})}recordChange(e){let t=this.outstandingOps[this.outstandingOps.length-1];t!==void 0&&w(t.sequenceNumber<e.sequenceNumber,426),this.invalidate(e.sequenceNumber),this.trackingSequenceNumber=e.sequenceNumber,this.outstandingOps.push(e)}invalidate(e){e>this._changeSequenceNumber&&(this._changeSequenceNumber=e)}hasChanged(){return this._changeSequenceNumber>this.referenceSequenceNumber}get latestSummary(){return this._latestSummary}createChild(e,t,r,i={}){w(!this.children.has(t),427);let o=this.getCreateDetailsForChild(t,r),a=new n(this.defaultLogger,e,i,o.changeSequenceNumber,o.latestSummary,o.initialSummary,this.wipSummaryLogger);return this.maybeUpdateChildState(a),this.children.set(t,a),a}getChild(e){return this.children.get(e)}getCreateDetailsForChild(e,t){var r;let i,o,a,s=this._latestSummary;switch(t.type){case Vc.CreateSummarizerNodeSource.FromAttach:{if(s!==void 0&&t.sequenceNumber<=s.referenceSequenceNumber)o=s.createForChild(e);else{let c=Ba(t.snapshot);i={sequenceNumber:t.sequenceNumber,id:e,summary:c}}a=t.sequenceNumber;break}case Vc.CreateSummarizerNodeSource.FromSummary:this.initialSummary===void 0&&w(!!s,428);case Vc.CreateSummarizerNodeSource.Local:{let c=this.initialSummary;if(c!==void 0){let l;if(c.summary!==void 0){let{childrenTree:u}=qE(c.summary.summary);w(u.type===bt.Tree,470),l=u.tree[e]}t.type===Vc.CreateSummarizerNodeSource.FromSummary&&w(!!l,429);let h;l!==void 0&&(w(l.type===bt.Tree,430),h={summary:l,stats:qc(l)}),i={sequenceNumber:c.sequenceNumber,id:e,summary:h}}o=s?.createForChild(e),a=(r=s?.referenceSequenceNumber)!==null&&r!==void 0?r:-1;break}default:{let c=t.type;mt(t,`Unexpected CreateSummarizerNodeSource: ${c}`)}}return{initialSummary:i,latestSummary:o,changeSequenceNumber:a}}maybeUpdateChildState(e){if(this.isTrackingInProgress()&&(e.wipReferenceSequenceNumber=this.wipReferenceSequenceNumber),e._latestSummary!==void 0)for(let[t,r]of this.pendingSummaries.entries()){let i=new kr({referenceSequenceNumber:r.referenceSequenceNumber,basePath:e._latestSummary.basePath,localPath:e._latestSummary.localPath});e.addPendingSummary(t,i)}}addPendingSummary(e,t){this.pendingSummaries.set(e,t)}isTrackingInProgress(){return this.wipReferenceSequenceNumber!==void 0}},LE=(n,e,t,r,i={})=>new Hc(n,e,i,t,r===void 0?void 0:kr.createForRoot(r))});function Lu(n,e){let t=new Set,r=[...e];for(let a of r){if(t.has(a))continue;t.add(a);let s=n[a];s!==void 0&&r.push(...s)}let i=[],o=[];for(let a of Object.keys(n))t.has(a)?i.push(a):o.push(a);return{referencedNodeIds:i,deletedNodeIds:o}}var jE=W(()=>{});function VE(n){return n.replace(/^\/+|\/+$/g,"")}function Dj(n){return n.replace(/^\/+/g,"")}function Fj(n){return n.replace(/\/+$/g,"")}function wo(n){let e={};for(let[t,r]of Object.entries(n.gcNodes))e[t]=Array.from(r);return{gcNodes:e}}function ju(n){let e=new Map;if(n.gcData===void 0)return e;let t=n.gcData.gcNodes;delete t["/"];for(let[i,o]of Object.entries(t)){w(i.startsWith("/"),686);let a=i.split("/")[1],s=i.slice(a.length+1);s===""&&(s="/");let c=e.get(a);c===void 0&&(c={gcData:{gcNodes:{}},usedRoutes:[]}),w(c.gcData!==void 0,687),c.gcData.gcNodes[s]=[...new Set(o)],e.set(a,c)}if(n.usedRoutes===void 0)return e;let r=n.usedRoutes.filter(i=>i!==""&&i!=="/");for(let i of r){w(i.startsWith("/"),688);let o=i.split("/")[1],a=i.slice(o.length+1),s=e.get(o);w(s?.usedRoutes!==void 0,689),s.usedRoutes.push(a),e.set(o,s)}return e}function Vu(n){let e=n.filter(r=>r!==""&&r!=="/"),t=new Map;for(let r of e){w(r.startsWith("/"),408);let i=r.split("/")[1],o=r.slice(i.length+1),a=t.get(i);a!==void 0?a.push(o):t.set(i,[o])}return t}function HE(n,e){let t=Object.entries(n);for(let[r,i]of t){let o=new Set(i);o.delete(e),n[r]=[...o]}}function UE(n,e){var t;let r={};for(let[i,o]of Object.entries(n.gcNodes))r[i]={outboundRoutes:Array.from(o.outboundRoutes),unreferencedTimestampMs:o.unreferencedTimestampMs};for(let[i,o]of Object.entries(e.gcNodes)){let a=r[i];a===void 0?a={outboundRoutes:Array.from(o.outboundRoutes),unreferencedTimestampMs:o.unreferencedTimestampMs}:(o.unreferencedTimestampMs!==void 0&&a.unreferencedTimestampMs!==void 0&&w(o.unreferencedTimestampMs===a.unreferencedTimestampMs,690),a={outboundRoutes:[...new Set([...o.outboundRoutes,...a.outboundRoutes])],unreferencedTimestampMs:(t=o.unreferencedTimestampMs)!==null&&t!==void 0?t:a.unreferencedTimestampMs}),r[i]=a}return{gcNodes:r}}function GE(n,e){let t=wo(n);for(let[r,i]of Object.entries(e.gcNodes))if(t.gcNodes[r]===void 0)t.gcNodes[r]=Array.from(i);else{let o=[...i,...t.gcNodes[r]];t.gcNodes[r]=[...new Set(o)]}return t}var Li,WE=W(()=>{Y();Li=class{constructor(){this.gcNodesSet={}}get gcNodes(){let e={};for(let[t,r]of Object.entries(this.gcNodesSet))e[t]=[...r];return e}addNode(e,t){this.gcNodesSet[e]=new Set(t)}prefixAndAddNodes(e,t){for(let[r,i]of Object.entries(t)){let o=Dj(r);o=`/${e}/${o}`,o=Fj(o),this.gcNodesSet[o]=new Set(i)}}addNodes(e){for(let[t,r]of Object.entries(e))this.gcNodesSet[t]=new Set(r)}addRouteToAllNodes(e){for(let t of Object.values(this.gcNodesSet))t.add(e)}getGCData(){return{gcNodes:this.gcNodes}}}});var KE=W(()=>{});var ja=W(()=>{jE();WE();KE();});var $E,qv,Lv,Hu,XE=W(()=>{Y();ja();$E=Ce(Ln());Bv();Nv();qv=class extends kr{constructor(e,t){super(t),this.serializedUsedRoutes=e}},Lv=class n extends Hc{constructor(e,t,r,i,o,a,s,c,l){super(e,(h,u,d)=>v(this,null,function*(){return t(h,!0,d)}),r,i,o,a,s),this.summarizeFn=t,this.getGCDataFn=c,this.baseGCDetailsLoaded=!1,this.usedRoutes=[""],this.gcDisabled=r.gcDisabled===!0,this.baseGCDetailsP=new Rt(()=>v(this,null,function*(){var h;return(h=yield l?.())!==null&&h!==void 0?h:{usedRoutes:[]}}))}getGCSummaryDetails(){return this.getBaseGCDetails()}getBaseGCDetails(){return{gcData:this.gcData,usedRoutes:this.usedRoutes,unrefTimestamp:this.unreferencedTimestampMs}}loadBaseGCDetails(){return v(this,null,function*(){var e;let t=yield this.baseGCDetailsP;this.baseGCDetailsLoaded||(this.baseGCDetailsLoaded=!0,t.gcData!==void 0&&(this.gcData=wo(t.gcData)),this.referenceUsedRoutes=(e=t.usedRoutes)===null||e===void 0?void 0:e.sort(),this.unreferencedTimestampMs=t.unrefTimestamp)})}summarize(e,t=!0,r){return v(this,null,function*(){return!this.gcDisabled&&this.isTrackingInProgress()&&w(this.wipSerializedUsedRoutes!==void 0,433),t?er(n.prototype,this,"summarize").call(this,e,!0,r):this.summarizeFn(e,t,r)})}getGCData(e=!1){return v(this,null,function*(){if(w(!this.gcDisabled,434),w(this.getGCDataFn!==void 0,435),yield this.loadBaseGCDetails(),!e&&!this.hasDataChanged()&&this.gcData!==void 0)return wo(this.gcData);let t=yield this.getGCDataFn(e);return this.gcData=wo(t),t})}startSummary(e,t){this.gcDisabled||w(this.wipSerializedUsedRoutes===void 0,436),super.startSummary(e,t)}completeSummaryCore(e,t,r){let i;if(this.gcDisabled||(i=this.wipSerializedUsedRoutes,w(i!==void 0,437)),super.completeSummaryCore(e,t,r),!this.gcDisabled){let o=this.pendingSummaries.get(e);if(o!==void 0){let a=new qv(i,o);this.pendingSummaries.set(e,a)}}}clearSummary(){this.wipSerializedUsedRoutes=void 0,super.clearSummary()}refreshLatestSummaryFromPending(e,t){if(!this.gcDisabled){let r=this.pendingSummaries.get(e);r!==void 0&&(this.referenceUsedRoutes=JSON.parse(r.serializedUsedRoutes))}return super.refreshLatestSummaryFromPending(e,t)}refreshLatestSummaryFromSnapshot(e,t,r,i,o,a){return v(this,null,function*(){if(!this.gcDisabled){let s=t.blobs[$E.gcBlobKey];if(s!==void 0){let c=yield a(s);if(this.referenceSequenceNumber>=e)return;this.referenceUsedRoutes=c.usedRoutes}}return er(n.prototype,this,"refreshLatestSummaryFromSnapshot").call(this,e,t,r,i,o,a)})}createChild(e,t,r,i={},o,a){var s;w(!this.children.has(t),438);let c=this.getCreateDetailsForChild(t,r),l=new n(this.defaultLogger,e,Object.assign(Object.assign({},i),{gcDisabled:(s=i.gcDisabled)!==null&&s!==void 0?s:this.gcDisabled}),c.changeSequenceNumber,c.latestSummary,c.initialSummary,this.wipSummaryLogger,o,a);return this.maybeUpdateChildState(l),this.children.set(t,l),l}deleteChild(e){this.children.delete(e)}getChild(e){return this.children.get(e)}isReferenced(){return this.usedRoutes.includes("")||this.usedRoutes.includes("/")}updateUsedRoutes(e,t){if(this.usedRoutes=e.sort(),!this.gcDisabled&&this.isTrackingInProgress()&&(this.wipSerializedUsedRoutes=JSON.stringify(this.usedRoutes)),this.isReferenced()){this.unreferencedTimestampMs=void 0;return}this.unreferencedTimestampMs===void 0&&(this.unreferencedTimestampMs=t)}hasChanged(){return this.hasDataChanged()||this.hasUsedStateChanged()}hasDataChanged(){return super.hasChanged()}hasUsedStateChanged(){return this.gcDisabled?!1:this.referenceUsedRoutes===void 0||JSON.stringify(this.usedRoutes)!==JSON.stringify(this.referenceUsedRoutes)}},Hu=(n,e,t,r,i={},o,a)=>new Lv(n,e,i,t,r===void 0?void 0:kr.createForRoot(r),void 0,void 0,o,a)});var JE=W(()=>{Bv();XE();});function jv(n,e){return v(this,null,function*(){let t=n.trees[".protocol"].blobs.attributes;return(yield e(t)).sequenceNumber})}var QE=W(()=>{});var Vv={};Zi(Vv,{ObjectStoragePartition:()=>Fv,RequestParser:()=>Sn,RuntimeFactoryHelper:()=>Rc,SummaryTreeBuilder:()=>Pt,TelemetryContext:()=>Bc,addBlobToSummary:()=>En,addSummarizeResultToSummary:()=>Iv,addTreeToSummary:()=>zv,calculateStats:()=>qc,convertSnapshotTreeToSummaryTree:()=>qa,convertSummaryTreeToITree:()=>La,convertToSummaryTree:()=>Ba,convertToSummaryTreeWithStats:()=>IE,create404Response:()=>Ft,createDataStoreFactory:()=>Mj,createResponseError:()=>Fu,createRootSummarizerNode:()=>LE,createRootSummarizerNodeWithGC:()=>Hu,exceptionToResponse:()=>Bi,generateHandleContextPath:()=>cr,getBlobSize:()=>Tv,getNormalizedObjectStoragePathParts:()=>Tu,listBlobsAtTreePath:()=>Sj,mergeStats:()=>dr,requestFluidObject:()=>Ar,responseToException:()=>qi,seqFromTree:()=>jv,utf8ByteLength:()=>TE});var vt=W(()=>{dE();uE();hE();pE();gE();fE();JE();Bu();QE();});var YE=W(()=>{});var Va,Uu,Tj,Hv=W(()=>{Va=n=>typeof n=="object"&&typeof n?.name=="string"&&typeof n?.fluid=="object",Uu=n=>{let e=n;return typeof e=="object"&&(typeof e?.package=="string"||Va(e?.package))&&(e?.config===void 0||typeof e?.config=="object")},Tj="IFluidCodeDetailsComparer"});var zj,ZE=W(()=>{Hv();zj=n=>{var e,t,r,i,o,a;return Va(n)&&typeof((r=(t=(e=n?.fluid)===null||e===void 0?void 0:e.browser)===null||t===void 0?void 0:t.umd)===null||r===void 0?void 0:r.library)=="string"&&Array.isArray((a=(o=(i=n?.fluid)===null||i===void 0?void 0:i.browser)===null||o===void 0?void 0:o.umd)===null||a===void 0?void 0:a.files)}});var eA=W(()=>{});var ji,tA=W(()=>{ji=function(n){return n.genericError="genericError",n.throttlingError="throttlingError",n.dataCorruptionError="dataCorruptionError",n.dataProcessingError="dataProcessingError",n.usageError="usageError",n.clientSessionExpiredError="clientSessionExpiredError",n}(ji||{})});var ct,nA=W(()=>{ct=function(n){return n.cache="fluid-cache",n.clientDetails="fluid-client-details",n.loadMode="loadMode",n.reconnect="fluid-reconnect",n.sequenceNumber="fluid-sequence-number",n.version="version",n}(ct||{})});var rA=W(()=>{});var oe,xn,Ij,iA=W(()=>{oe=function(n){return n.Detached="Detached",n.Attaching="Attaching",n.Attached="Attached",n}(oe||{}),xn=function(n){return n.NotBound="NotBound",n.Binding="Binding",n.Bound="Bound",n}(xn||{}),Ij="IRuntimeFactory"});var Rj,oA=W(()=>{Rj="IFluidTokenProvider"});var Uv={};Zi(Uv,{AttachState:()=>oe,BindState:()=>xn,ContainerErrorType:()=>ji,IFluidCodeDetailsComparer:()=>Tj,IFluidTokenProvider:()=>Rj,IRuntimeFactory:()=>Ij,LoaderHeader:()=>ct,isFluidBrowserPackage:()=>zj,isFluidCodeDetails:()=>Uu,isFluidPackage:()=>Va});var qt=W(()=>{YE();ZE();eA();tA();nA();rA();Hv();iA();oA();});var Jv=z((Ele,vA)=>{"use strict";function je(n){if(this._capacity=mA(n),this._length=0,this._front=0,fA(n)){for(var e=n.length,t=0;t<e;++t)this[t]=n[t];this._length=e}}je.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,i=this._capacity,o=0;o<e;++o)t[o]=this[r+o&i-1];return t};je.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var i=this._capacity;if(r+t>i){for(var a=0;a<t;++a){this._checkCapacity(r+1);var o=this._front+r&this._capacity-1;this[o]=arguments[a],r++,this._length=r}return r}else{for(var o=this._front,a=0;a<t;++a)this[o+r&i-1]=arguments[a],o++;return this._length=r+t,r+t}}if(t===0)return r;this._checkCapacity(r+1);var a=this._front+r&this._capacity-1;return this[a]=e,this._length=r+1,r+1};je.prototype.pop=function(){var e=this._length;if(e!==0){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}};je.prototype.shift=function(){var e=this._length;if(e!==0){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}};je.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){var a=this._capacity;if(t+r>a){for(var s=r-1;s>=0;s--){this._checkCapacity(t+1);var a=this._capacity,i=(this._front-1&a-1^a)-a;this[i]=arguments[s],t++,this._length=t,this._front=i}return t}else{for(var o=this._front,s=r-1;s>=0;s--){var i=(o-1&a-1^a)-a;this[i]=arguments[s],o=i}return this._front=o,this._length=t+r,t+r}}if(r===0)return t;this._checkCapacity(t+1);var a=this._capacity,s=(this._front-1&a-1^a)-a;return this[s]=e,this._length=t+1,this._front=s,t+1};je.prototype.peekBack=function(){var e=this._length;if(e!==0){var t=this._front+e-1&this._capacity-1;return this[t]}};je.prototype.peekFront=function(){if(this._length!==0)return this[this._front]};je.prototype.get=function(e){var t=e;if(t===(t|0)){var r=this._length;if(t<0&&(t=t+r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}};je.prototype.isEmpty=function(){return this._length===0};je.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,i=0;i<e;++i)this[t+i&r-1]=void 0;this._length=0,this._front=0};je.prototype.toString=function(){return this.toArray().toString()};je.prototype.valueOf=je.prototype.toString;je.prototype.removeFront=je.prototype.shift;je.prototype.removeBack=je.prototype.pop;je.prototype.insertFront=je.prototype.unshift;je.prototype.insertBack=je.prototype.push;je.prototype.enqueue=je.prototype.push;je.prototype.dequeue=je.prototype.shift;je.prototype.toJSON=je.prototype.toArray;Object.defineProperty(je.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}});je.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(mA(this._capacity*1.5+16))};je.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,i=this._length;if(r+i>t){var o=r+i&t-1;Hj(this,0,this,t,o)}};var fA=Array.isArray;function Hj(n,e,t,r,i){for(var o=0;o<i;++o)t[o+r]=n[o+e],n[o+e]=void 0}function Uj(n){return n=n>>>0,n=n-1,n=n|n>>1,n=n|n>>2,n=n|n>>4,n=n|n>>8,n=n|n>>16,n+1}function mA(n){if(typeof n!="number")if(fA(n))n=n.length;else return 16;return Uj(Math.min(Math.max(16,n),1073741824))}vA.exports=je});var qA=z((Dhe,BA)=>{"use strict";function zr(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}function NA(n,e){for(var t="",r=0,i=-1,o=0,a,s=0;s<=n.length;++s){if(s<n.length)a=n.charCodeAt(s);else{if(a===47)break;a=47}if(a===47){if(!(i===s-1||o===1))if(i!==s-1&&o===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var c=t.lastIndexOf("/");if(c!==t.length-1){c===-1?(t="",r=0):(t=t.slice(0,c),r=t.length-1-t.lastIndexOf("/")),i=s,o=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=s,o=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+n.slice(i+1,s):t=n.slice(i+1,s),r=s-i-1;i=s,o=0}else a===46&&o!==-1?++o:o=-1}return t}function gV(n,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+n+r:r}var Ya={resolve:function(){for(var e="",t=!1,r,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(r===void 0&&(r=process.cwd()),o=r),zr(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=NA(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(zr(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=NA(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return zr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];zr(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":Ya.normalize(e)},relative:function(e,t){if(zr(e),zr(t),e===t||(e=Ya.resolve(e),t=Ya.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var i=e.length,o=i-r,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var s=t.length,c=s-a,l=o<c?o:c,h=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(t.charCodeAt(a+u)===47)return t.slice(a+u+1);if(u===0)return t.slice(a+u)}else o>l&&(e.charCodeAt(r+u)===47?h=u:u===0&&(h=0));break}var d=e.charCodeAt(r+u),p=t.charCodeAt(a+u);if(d!==p)break;d===47&&(h=u)}var m="";for(u=r+h+1;u<=i;++u)(u===i||e.charCodeAt(u)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(a+h):(a+=h,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(zr(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,i=-1,o=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!o){i=a;break}}else o=!1;return i===-1?r?"/":".":r&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');zr(e);var r=0,i=-1,o=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,c=-1;for(a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){r=a+1;break}}else c===-1&&(o=!1,c=a+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=a):(s=-1,i=c))}return r===i?i=c:i===-1&&(i=e.length),e.slice(r,i)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){r=a+1;break}}else i===-1&&(o=!1,i=a+1);return i===-1?"":e.slice(r,i)}},extname:function(e){zr(e);for(var t=-1,r=0,i=-1,o=!0,a=0,s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!o){r=s+1;break}continue}i===-1&&(o=!1,i=s+1),c===46?t===-1?t=s:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||i===-1||a===0||a===1&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return gV("/",e)},parse:function(e){zr(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),i=r===47,o;i?(t.root="/",o=1):o=0;for(var a=-1,s=0,c=-1,l=!0,h=e.length-1,u=0;h>=o;--h){if(r=e.charCodeAt(h),r===47){if(!l){s=h+1;break}continue}c===-1&&(l=!1,c=h+1),r===46?a===-1?a=h:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||c===-1||u===0||u===1&&a===c-1&&a===s+1?c!==-1&&(s===0&&i?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(s,c)):(s===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,c)):(t.name=e.slice(s,a),t.base=e.slice(s,c)),t.ext=e.slice(a,c)),s>0?t.dir=e.slice(0,s-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Ya.posix=Ya;BA.exports=Ya});var YA=z(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.IContainerRuntime=void 0;Bh.IContainerRuntime="IContainerRuntime"});var ZA=z(So=>{"use strict";var mV=So&&So.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),vV=So&&So.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&mV(e,n,t)};Object.defineProperty(So,"__esModule",{value:!0});vV(YA(),So)});var y0=z(($pe,i4)=>{var bV=Cd(),xV=Gs();function _V(n,e,t){(t!==void 0&&!xV(n[e],t)||t===void 0&&!(e in n))&&bV(n,e,t)}i4.exports=_V});var a4=z((Xpe,o4)=>{function yV(n){return function(e,t,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var c=a[n?s:++i];if(t(o[c],c,o)===!1)break}return e}}o4.exports=yV});var c4=z((Jpe,s4)=>{var CV=a4(),wV=CV();s4.exports=wV});var d4=z((Qpe,l4)=>{var PV=tc(),OV=bi();function MV(n){return OV(n)&&PV(n)}l4.exports=MV});var p4=z((Ype,h4)=>{var SV=Yo(),EV=Ad(),AV=bi(),kV="[object Object]",DV=Function.prototype,FV=Object.prototype,u4=DV.toString,TV=FV.hasOwnProperty,zV=u4.call(Object);function IV(n){if(!AV(n)||SV(n)!=kV)return!1;var e=EV(n);if(e===null)return!0;var t=TV.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&u4.call(t)==zV}h4.exports=IV});var C0=z((Zpe,g4)=>{function RV(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}g4.exports=RV});var m4=z((ege,f4)=>{var NV=na(),BV=oa();function qV(n){return NV(n,BV(n))}f4.exports=qV});var C4=z((tge,y4)=>{var v4=y0(),LV=kf(),jV=jf(),VV=Df(),HV=Vf(),b4=wf(),x4=Qs(),UV=d4(),GV=wd(),WV=_d(),KV=jr(),$V=p4(),XV=Sf(),_4=C0(),JV=m4();function QV(n,e,t,r,i,o,a){var s=_4(n,t),c=_4(e,t),l=a.get(c);if(l){v4(n,t,l);return}var h=o?o(s,c,t+"",n,e,a):void 0,u=h===void 0;if(u){var d=x4(c),p=!d&&GV(c),m=!d&&!p&&XV(c);h=c,d||p||m?x4(s)?h=s:UV(s)?h=VV(s):p?(u=!1,h=LV(c,!0)):m?(u=!1,h=jV(c,!0)):h=[]:$V(c)||b4(c)?(h=s,b4(s)?h=JV(s):(!KV(s)||WV(s))&&(h=HV(c))):u=!1}u&&(a.set(c,h),i(h,c,r,o,a),a.delete(c)),v4(n,t,h)}y4.exports=QV});var O4=z((nge,P4)=>{var YV=_f(),ZV=y0(),eH=c4(),tH=C4(),nH=jr(),rH=oa(),iH=C0();function w4(n,e,t,r,i){n!==e&&eH(e,function(o,a){if(i||(i=new YV),nH(o))tH(n,e,a,t,w4,r,i);else{var s=r?r(iH(n,a),o,a+"",n,e,i):void 0;s===void 0&&(s=o),ZV(n,a,s)}},rH)}P4.exports=w4});var w0=z((rge,M4)=>{function oH(n){return n}M4.exports=oH});var E4=z((ige,S4)=>{function aH(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}S4.exports=aH});var D4=z((oge,k4)=>{var sH=E4(),A4=Math.max;function cH(n,e,t){return e=A4(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,o=A4(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=r[i];return s[e]=t(a),sH(n,this,s)}}k4.exports=cH});var T4=z((age,F4)=>{function lH(n){return function(){return n}}F4.exports=lH});var R4=z((sge,I4)=>{var dH=T4(),z4=yf(),uH=w0(),hH=z4?function(n,e){return z4(n,"toString",{configurable:!0,enumerable:!1,value:dH(e),writable:!0})}:uH;I4.exports=hH});var B4=z((cge,N4)=>{var pH=800,gH=16,fH=Date.now;function mH(n){var e=0,t=0;return function(){var r=fH(),i=gH-(r-t);if(t=r,i>0){if(++e>=pH)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}N4.exports=mH});var L4=z((lge,q4)=>{var vH=R4(),bH=B4(),xH=bH(vH);q4.exports=xH});var V4=z((dge,j4)=>{var _H=w0(),yH=D4(),CH=L4();function wH(n,e){return CH(yH(n,e,_H),n+"")}j4.exports=wH});var U4=z((uge,H4)=>{var PH=Gs(),OH=tc(),MH=Pf(),SH=jr();function EH(n,e,t){if(!SH(t))return!1;var r=typeof e;return(r=="number"?OH(t)&&MH(e,t.length):r=="string"&&e in t)?PH(t[e],n):!1}H4.exports=EH});var W4=z((hge,G4)=>{var AH=V4(),kH=U4();function DH(n){return AH(function(e,t){var r=-1,i=t.length,o=i>1?t[i-1]:void 0,a=i>2?t[2]:void 0;for(o=n.length>3&&typeof o=="function"?(i--,o):void 0,a&&kH(t[0],t[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var s=t[r];s&&n(e,s,r,o)}return e})}G4.exports=DH});var $4=z((pge,K4)=>{var FH=O4(),TH=W4(),zH=TH(function(n,e,t){FH(n,e,t)});K4.exports=zH});var P0=z((Mge,Wh)=>{"use strict";var{AbortController:Q4,AbortSignal:RH}=typeof self<"u"?self:typeof window<"u"?window:void 0;Wh.exports=Q4;Wh.exports.AbortSignal=RH;Wh.exports.default=Q4});var Fk=z(J=>{var ol={};ol.userAgent=!1;var ts={},XH="11.1.0",JH="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var Q=Q||function(n,e){var t={},r=t.lib={},i=r.Base=function(){function p(){}return{extend:function(m){p.prototype=this;var f=new p;return m&&f.mixIn(m),f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var f in m)m.hasOwnProperty(f)&&(this[f]=m[f]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=i.extend({init:function(p,m){p=this.words=p||[],m!=e?this.sigBytes=m:this.sigBytes=p.length*4},toString:function(p){return(p||s).stringify(this)},concat:function(p){var m=this.words,f=p.words,x=this.sigBytes,b=p.sigBytes;if(this.clamp(),x%4)for(var _=0;_<b;_++){var O=f[_>>>2]>>>24-_%4*8&255;m[x+_>>>2]|=O<<24-(x+_)%4*8}else for(var _=0;_<b;_+=4)m[x+_>>>2]=f[_>>>2];return this.sigBytes+=b,this},clamp:function(){var p=this.words,m=this.sigBytes;p[m>>>2]&=4294967295<<32-m%4*8,p.length=n.ceil(m/4)},clone:function(){var p=i.clone.call(this);return p.words=this.words.slice(0),p},random:function(p){for(var m=[],f=0;f<p;f+=4)m.push(n.random()*4294967296|0);return new o.init(m,p)}}),a=t.enc={},s=a.Hex={stringify:function(p){for(var m=p.words,f=p.sigBytes,x=[],b=0;b<f;b++){var _=m[b>>>2]>>>24-b%4*8&255;x.push((_>>>4).toString(16)),x.push((_&15).toString(16))}return x.join("")},parse:function(p){for(var m=p.length,f=[],x=0;x<m;x+=2)f[x>>>3]|=parseInt(p.substr(x,2),16)<<24-x%8*4;return new o.init(f,m/2)}},c=a.Latin1={stringify:function(p){for(var m=p.words,f=p.sigBytes,x=[],b=0;b<f;b++){var _=m[b>>>2]>>>24-b%4*8&255;x.push(String.fromCharCode(_))}return x.join("")},parse:function(p){for(var m=p.length,f=[],x=0;x<m;x++)f[x>>>2]|=(p.charCodeAt(x)&255)<<24-x%4*8;return new o.init(f,m)}},l=a.Utf8={stringify:function(p){try{return decodeURIComponent(escape(c.stringify(p)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(p){return c.parse(unescape(encodeURIComponent(p)))}},h=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(p){typeof p=="string"&&(p=l.parse(p)),this._data.concat(p),this._nDataBytes+=p.sigBytes},_process:function(p){var m=this._data,f=m.words,x=m.sigBytes,b=this.blockSize,_=b*4,O=x/_;p?O=n.ceil(O):O=n.max((O|0)-this._minBufferSize,0);var S=O*b,E=n.min(S*4,x);if(S){for(var F=0;F<S;F+=b)this._doProcessBlock(f,F);var I=f.splice(0,S);m.sigBytes-=E}return new o.init(I,E)},clone:function(){var p=i.clone.call(this);return p._data=this._data.clone(),p},_minBufferSize:0}),u=r.Hasher=h.extend({cfg:i.extend(),init:function(p){this.cfg=this.cfg.extend(p),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(p){return this._append(p),this._process(),this},finalize:function(p){p&&this._append(p);var m=this._doFinalize();return m},blockSize:512/32,_createHelper:function(p){return function(m,f){return new p.init(f).finalize(m)}},_createHmacHelper:function(p){return function(m,f){return new d.HMAC.init(p,f).finalize(m)}}}),d=t.algo={};return t}(Math);(function(n){var i=Q,e=i.lib,t=e.Base,r=e.WordArray,i=i.x64={};i.Word=t.extend({init:function(o,a){this.high=o,this.low=a}}),i.WordArray=t.extend({init:function(o,a){o=this.words=o||[],this.sigBytes=a!=n?a:8*o.length},toX32:function(){for(var o=this.words,a=o.length,s=[],c=0;c<a;c++){var l=o[c];s.push(l.high),s.push(l.low)}return r.create(s,this.sigBytes)},clone:function(){for(var o=t.clone.call(this),a=o.words=this.words.slice(0),s=a.length,c=0;c<s;c++)a[c]=a[c].clone();return o}})})();Q.lib.Cipher||function(n){var p=Q,e=p.lib,t=e.Base,r=e.WordArray,i=e.BufferedBlockAlgorithm,o=p.enc.Base64,a=p.algo.EvpKDF,s=e.Cipher=i.extend({cfg:t.extend(),createEncryptor:function(f,x){return this.create(this._ENC_XFORM_MODE,f,x)},createDecryptor:function(f,x){return this.create(this._DEC_XFORM_MODE,f,x)},init:function(f,x,b){this.cfg=this.cfg.extend(b),this._xformMode=f,this._key=x,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(f){return this._append(f),this._process()},finalize:function(f){return f&&this._append(f),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(f){return{encrypt:function(x,b,_){return(typeof b=="string"?m:d).encrypt(f,x,b,_)},decrypt:function(x,b,_){return(typeof b=="string"?m:d).decrypt(f,x,b,_)}}}});e.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=p.mode={},c=function(f,x,b){var _=this._iv;_?this._iv=n:_=this._prevBlock;for(var O=0;O<b;O++)f[x+O]^=_[O]},l=(e.BlockCipherMode=t.extend({createEncryptor:function(f,x){return this.Encryptor.create(f,x)},createDecryptor:function(f,x){return this.Decryptor.create(f,x)},init:function(f,x){this._cipher=f,this._iv=x}})).extend();l.Encryptor=l.extend({processBlock:function(f,x){var b=this._cipher,_=b.blockSize;c.call(this,f,x,_),b.encryptBlock(f,x),this._prevBlock=f.slice(x,x+_)}}),l.Decryptor=l.extend({processBlock:function(f,x){var b=this._cipher,_=b.blockSize,O=f.slice(x,x+_);b.decryptBlock(f,x),c.call(this,f,x,_),this._prevBlock=O}}),u=u.CBC=l,l=(p.pad={}).Pkcs7={pad:function(f,x){for(var b=4*x,b=b-f.sigBytes%b,_=b<<24|b<<16|b<<8|b,O=[],S=0;S<b;S+=4)O.push(_);b=r.create(O,b),f.concat(b)},unpad:function(f){f.sigBytes-=f.words[f.sigBytes-1>>>2]&255}},e.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var x=this.cfg,f=x.iv,x=x.mode;if(this._xformMode==this._ENC_XFORM_MODE)var b=x.createEncryptor;else b=x.createDecryptor,this._minBufferSize=1;this._mode=b.call(x,this,f&&f.words)},_doProcessBlock:function(f,x){this._mode.processBlock(f,x)},_doFinalize:function(){var f=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){f.pad(this._data,this.blockSize);var x=this._process(!0)}else x=this._process(!0),f.unpad(x);return x},blockSize:4});var h=e.CipherParams=t.extend({init:function(f){this.mixIn(f)},toString:function(f){return(f||this.formatter).stringify(this)}}),u=(p.format={}).OpenSSL={stringify:function(f){var x=f.ciphertext;return f=f.salt,(f?r.create([1398893684,1701076831]).concat(f).concat(x):x).toString(o)},parse:function(f){f=o.parse(f);var x=f.words;if(x[0]==1398893684&&x[1]==1701076831){var b=r.create(x.slice(2,4));x.splice(0,4),f.sigBytes-=16}return h.create({ciphertext:f,salt:b})}},d=e.SerializableCipher=t.extend({cfg:t.extend({format:u}),encrypt:function(f,x,b,_){_=this.cfg.extend(_);var O=f.createEncryptor(b,_);return x=O.finalize(x),O=O.cfg,h.create({ciphertext:x,key:b,iv:O.iv,algorithm:f,mode:O.mode,padding:O.padding,blockSize:f.blockSize,formatter:_.format})},decrypt:function(f,x,b,_){return _=this.cfg.extend(_),x=this._parse(x,_.format),f.createDecryptor(b,_).finalize(x.ciphertext)},_parse:function(f,x){return typeof f=="string"?x.parse(f,this):f}}),p=(p.kdf={}).OpenSSL={execute:function(f,x,b,_){return _||(_=r.random(8)),f=a.create({keySize:x+b}).compute(f,_),b=r.create(f.words.slice(x),4*b),f.sigBytes=4*x,h.create({key:f,iv:b,salt:_})}},m=e.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:p}),encrypt:function(f,x,b,_){return _=this.cfg.extend(_),b=_.kdf.execute(b,f.keySize,f.ivSize),_.iv=b.iv,f=d.encrypt.call(this,f,x,b.key,_),f.mixIn(b),f},decrypt:function(f,x,b,_){return _=this.cfg.extend(_),x=this._parse(x,_.format),b=_.kdf.execute(b,f.keySize,f.ivSize,x.salt),_.iv=b.iv,d.decrypt.call(this,f,x,b.key,_)}})}();(function(){for(var n=Q,e=n.lib.BlockCipher,F=n.algo,t=[],r=[],i=[],o=[],a=[],s=[],c=[],l=[],h=[],u=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;for(var m=0,f=0,p=0;256>p;p++){var x=f^f<<1^f<<2^f<<3^f<<4,x=x>>>8^x&255^99;t[m]=x,r[x]=m;var b=d[m],_=d[b],O=d[_],S=257*d[x]^16843008*x;i[m]=S<<24|S>>>8,o[m]=S<<16|S>>>16,a[m]=S<<8|S>>>24,s[m]=S,S=16843009*O^65537*_^257*b^16843008*m,c[x]=S<<24|S>>>8,l[x]=S<<16|S>>>16,h[x]=S<<8|S>>>24,u[x]=S,m?(m=b^d[d[d[O^b]]],f^=d[d[f]]):m=f=1}var E=[0,1,2,4,8,16,32,64,128,27,54],F=F.AES=e.extend({_doReset:function(){for(var P=this._key,I=P.words,y=P.sigBytes/4,P=4*((this._nRounds=y+6)+1),C=this._keySchedule=[],M=0;M<P;M++)if(M<y)C[M]=I[M];else{var A=C[M-1];M%y?6<y&&M%y==4&&(A=t[A>>>24]<<24|t[A>>>16&255]<<16|t[A>>>8&255]<<8|t[A&255]):(A=A<<8|A>>>24,A=t[A>>>24]<<24|t[A>>>16&255]<<16|t[A>>>8&255]<<8|t[A&255],A^=E[M/y|0]<<24),C[M]=C[M-y]^A}for(I=this._invKeySchedule=[],y=0;y<P;y++)M=P-y,A=y%4?C[M]:C[M-4],I[y]=4>y||4>=M?A:c[t[A>>>24]]^l[t[A>>>16&255]]^h[t[A>>>8&255]]^u[t[A&255]]},encryptBlock:function(I,y){this._doCryptBlock(I,y,this._keySchedule,i,o,a,s,t)},decryptBlock:function(I,y){var P=I[y+1];I[y+1]=I[y+3],I[y+3]=P,this._doCryptBlock(I,y,this._invKeySchedule,c,l,h,u,r),P=I[y+1],I[y+1]=I[y+3],I[y+3]=P},_doCryptBlock:function(I,y,P,C,M,A,T,k){for(var D=this._nRounds,te=I[y]^P[0],be=I[y+1]^P[1],ge=I[y+2]^P[2],re=I[y+3]^P[3],R=4,N=1;N<D;N++)var L=C[te>>>24]^M[be>>>16&255]^A[ge>>>8&255]^T[re&255]^P[R++],V=C[be>>>24]^M[ge>>>16&255]^A[re>>>8&255]^T[te&255]^P[R++],G=C[ge>>>24]^M[re>>>16&255]^A[te>>>8&255]^T[be&255]^P[R++],re=C[re>>>24]^M[te>>>16&255]^A[be>>>8&255]^T[ge&255]^P[R++],te=L,be=V,ge=G;L=(k[te>>>24]<<24|k[be>>>16&255]<<16|k[ge>>>8&255]<<8|k[re&255])^P[R++],V=(k[be>>>24]<<24|k[ge>>>16&255]<<16|k[re>>>8&255]<<8|k[te&255])^P[R++],G=(k[ge>>>24]<<24|k[re>>>16&255]<<16|k[te>>>8&255]<<8|k[be&255])^P[R++],re=(k[re>>>24]<<24|k[te>>>16&255]<<16|k[be>>>8&255]<<8|k[ge&255])^P[R++],I[y]=L,I[y+1]=V,I[y+2]=G,I[y+3]=re},keySize:8});n.AES=e._createHelper(F)})();(function(){function n(d,p){var m=(this._lBlock>>>d^this._rBlock)&p;this._rBlock^=m,this._lBlock^=m<<d}function e(d,p){var m=(this._rBlock>>>d^this._lBlock)&p;this._lBlock^=m,this._rBlock^=m<<d}var t=Q,i=t.lib,r=i.WordArray,i=i.BlockCipher,o=t.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=o.DES=i.extend({_doReset:function(){for(var d=this._key.words,p=[],m=0;56>m;m++){var f=a[m]-1;p[m]=d[f>>>5]>>>31-f%32&1}for(d=this._subKeys=[],f=0;16>f;f++){for(var x=d[f]=[],b=c[f],m=0;24>m;m++)x[m/6|0]|=p[(s[m]-1+b)%28]<<31-m%6,x[4+(m/6|0)]|=p[28+(s[m+24]-1+b)%28]<<31-m%6;for(x[0]=x[0]<<1|x[0]>>>31,m=1;7>m;m++)x[m]>>>=4*(m-1)+3;x[7]=x[7]<<5|x[7]>>>27}for(p=this._invSubKeys=[],m=0;16>m;m++)p[m]=d[15-m]},encryptBlock:function(d,p){this._doCryptBlock(d,p,this._subKeys)},decryptBlock:function(d,p){this._doCryptBlock(d,p,this._invSubKeys)},_doCryptBlock:function(d,p,m){this._lBlock=d[p],this._rBlock=d[p+1],n.call(this,4,252645135),n.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),n.call(this,1,1431655765);for(var f=0;16>f;f++){for(var x=m[f],b=this._lBlock,_=this._rBlock,O=0,S=0;8>S;S++)O|=l[S][((_^x[S])&h[S])>>>0];this._lBlock=_,this._rBlock=b^O}m=this._lBlock,this._lBlock=this._rBlock,this._rBlock=m,n.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),n.call(this,16,65535),n.call(this,4,252645135),d[p]=this._lBlock,d[p+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});t.DES=i._createHelper(u),o=o.TripleDES=i.extend({_doReset:function(){var d=this._key.words;this._des1=u.createEncryptor(r.create(d.slice(0,2))),this._des2=u.createEncryptor(r.create(d.slice(2,4))),this._des3=u.createEncryptor(r.create(d.slice(4,6)))},encryptBlock:function(d,p){this._des1.encryptBlock(d,p),this._des2.decryptBlock(d,p),this._des3.encryptBlock(d,p)},decryptBlock:function(d,p){this._des3.decryptBlock(d,p),this._des2.encryptBlock(d,p),this._des1.decryptBlock(d,p)},keySize:6,ivSize:2,blockSize:2}),t.TripleDES=i._createHelper(o)})();(function(){var n=Q,e=n.lib.WordArray;n.enc.Base64={stringify:function(t){var r=t.words,i=t.sigBytes,o=this._map;t.clamp(),t=[];for(var a=0;a<i;a+=3)for(var s=(r[a>>>2]>>>24-8*(a%4)&255)<<16|(r[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|r[a+2>>>2]>>>24-8*((a+2)%4)&255,c=0;4>c&&a+.75*c<i;c++)t.push(o.charAt(s>>>6*(3-c)&63));if(r=o.charAt(64))for(;t.length%4;)t.push(r);return t.join("")},parse:function(t){var r=t.length,i=this._map,o=i.charAt(64);o&&(o=t.indexOf(o),o!=-1&&(r=o));for(var o=[],a=0,s=0;s<r;s++)if(s%4){var c=i.indexOf(t.charAt(s-1))<<2*(s%4),l=i.indexOf(t.charAt(s))>>>6-2*(s%4);o[a>>>2]|=(c|l)<<24-8*(a%4),a++}return e.create(o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(n){function e(u,d,p,m,f,x,b){return u=u+(d&p|~d&m)+f+b,(u<<x|u>>>32-x)+d}function t(u,d,p,m,f,x,b){return u=u+(d&m|p&~m)+f+b,(u<<x|u>>>32-x)+d}function r(u,d,p,m,f,x,b){return u=u+(d^p^m)+f+b,(u<<x|u>>>32-x)+d}function i(u,d,p,m,f,x,b){return u=u+(p^(d|~m))+f+b,(u<<x|u>>>32-x)+d}for(var o=Q,c=o.lib,a=c.WordArray,s=c.Hasher,c=o.algo,l=[],h=0;64>h;h++)l[h]=4294967296*n.abs(n.sin(h+1))|0;c=c.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(u,d){for(var p=0;16>p;p++){var m=d+p,f=u[m];u[m]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var p=this._hash.words,m=u[d+0],f=u[d+1],x=u[d+2],b=u[d+3],_=u[d+4],O=u[d+5],S=u[d+6],E=u[d+7],F=u[d+8],I=u[d+9],y=u[d+10],P=u[d+11],C=u[d+12],M=u[d+13],A=u[d+14],T=u[d+15],k=p[0],N=p[1],R=p[2],D=p[3],k=e(k,N,R,D,m,7,l[0]),D=e(D,k,N,R,f,12,l[1]),R=e(R,D,k,N,x,17,l[2]),N=e(N,R,D,k,b,22,l[3]),k=e(k,N,R,D,_,7,l[4]),D=e(D,k,N,R,O,12,l[5]),R=e(R,D,k,N,S,17,l[6]),N=e(N,R,D,k,E,22,l[7]),k=e(k,N,R,D,F,7,l[8]),D=e(D,k,N,R,I,12,l[9]),R=e(R,D,k,N,y,17,l[10]),N=e(N,R,D,k,P,22,l[11]),k=e(k,N,R,D,C,7,l[12]),D=e(D,k,N,R,M,12,l[13]),R=e(R,D,k,N,A,17,l[14]),N=e(N,R,D,k,T,22,l[15]),k=t(k,N,R,D,f,5,l[16]),D=t(D,k,N,R,S,9,l[17]),R=t(R,D,k,N,P,14,l[18]),N=t(N,R,D,k,m,20,l[19]),k=t(k,N,R,D,O,5,l[20]),D=t(D,k,N,R,y,9,l[21]),R=t(R,D,k,N,T,14,l[22]),N=t(N,R,D,k,_,20,l[23]),k=t(k,N,R,D,I,5,l[24]),D=t(D,k,N,R,A,9,l[25]),R=t(R,D,k,N,b,14,l[26]),N=t(N,R,D,k,F,20,l[27]),k=t(k,N,R,D,M,5,l[28]),D=t(D,k,N,R,x,9,l[29]),R=t(R,D,k,N,E,14,l[30]),N=t(N,R,D,k,C,20,l[31]),k=r(k,N,R,D,O,4,l[32]),D=r(D,k,N,R,F,11,l[33]),R=r(R,D,k,N,P,16,l[34]),N=r(N,R,D,k,A,23,l[35]),k=r(k,N,R,D,f,4,l[36]),D=r(D,k,N,R,_,11,l[37]),R=r(R,D,k,N,E,16,l[38]),N=r(N,R,D,k,y,23,l[39]),k=r(k,N,R,D,M,4,l[40]),D=r(D,k,N,R,m,11,l[41]),R=r(R,D,k,N,b,16,l[42]),N=r(N,R,D,k,S,23,l[43]),k=r(k,N,R,D,I,4,l[44]),D=r(D,k,N,R,C,11,l[45]),R=r(R,D,k,N,T,16,l[46]),N=r(N,R,D,k,x,23,l[47]),k=i(k,N,R,D,m,6,l[48]),D=i(D,k,N,R,E,10,l[49]),R=i(R,D,k,N,A,15,l[50]),N=i(N,R,D,k,O,21,l[51]),k=i(k,N,R,D,C,6,l[52]),D=i(D,k,N,R,b,10,l[53]),R=i(R,D,k,N,y,15,l[54]),N=i(N,R,D,k,f,21,l[55]),k=i(k,N,R,D,F,6,l[56]),D=i(D,k,N,R,T,10,l[57]),R=i(R,D,k,N,S,15,l[58]),N=i(N,R,D,k,M,21,l[59]),k=i(k,N,R,D,_,6,l[60]),D=i(D,k,N,R,P,10,l[61]),R=i(R,D,k,N,x,15,l[62]),N=i(N,R,D,k,I,21,l[63]);p[0]=p[0]+k|0,p[1]=p[1]+N|0,p[2]=p[2]+R|0,p[3]=p[3]+D|0},_doFinalize:function(){var u=this._data,d=u.words,p=8*this._nDataBytes,m=8*u.sigBytes;d[m>>>5]|=128<<24-m%32;var f=n.floor(p/4294967296);for(d[(m+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,d[(m+64>>>9<<4)+14]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,u.sigBytes=4*(d.length+1),this._process(),u=this._hash,d=u.words,p=0;4>p;p++)m=d[p],d[p]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360;return u},clone:function(){var u=s.clone.call(this);return u._hash=this._hash.clone(),u}}),o.MD5=s._createHelper(c),o.HmacMD5=s._createHmacHelper(c)})(Math);(function(){var n=Q,i=n.lib,e=i.WordArray,t=i.Hasher,r=[],i=n.algo.SHA1=t.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(o,a){for(var s=this._hash.words,c=s[0],l=s[1],h=s[2],u=s[3],d=s[4],p=0;80>p;p++){if(16>p)r[p]=o[a+p]|0;else{var m=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=m<<1|m>>>31}m=(c<<5|c>>>27)+d+r[p],m=20>p?m+((l&h|~l&u)+1518500249):40>p?m+((l^h^u)+1859775393):60>p?m+((l&h|l&u|h&u)-1894007588):m+((l^h^u)-899497514),d=u,u=h,h=l<<30|l>>>2,l=c,c=m}s[0]=s[0]+c|0,s[1]=s[1]+l|0,s[2]=s[2]+h|0,s[3]=s[3]+u|0,s[4]=s[4]+d|0},_doFinalize:function(){var o=this._data,a=o.words,s=8*this._nDataBytes,c=8*o.sigBytes;return a[c>>>5]|=128<<24-c%32,a[(c+64>>>9<<4)+14]=Math.floor(s/4294967296),a[(c+64>>>9<<4)+15]=s,o.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var o=t.clone.call(this);return o._hash=this._hash.clone(),o}});n.SHA1=t._createHelper(i),n.HmacSHA1=t._createHmacHelper(i)})();(function(n){for(var e=Q,p=e.lib,t=p.WordArray,r=p.Hasher,p=e.algo,i=[],o=[],a=function(f){return 4294967296*(f-(f|0))|0},s=2,c=0;64>c;){var l;e:{l=s;for(var h=n.sqrt(l),u=2;u<=h;u++)if(!(l%u)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=a(n.pow(s,.5))),o[c]=a(n.pow(s,1/3)),c++),s++}var d=[],p=p.SHA256=r.extend({_doReset:function(){this._hash=new t.init(i.slice(0))},_doProcessBlock:function(m,f){for(var x=this._hash.words,b=x[0],_=x[1],O=x[2],S=x[3],E=x[4],F=x[5],I=x[6],y=x[7],P=0;64>P;P++){if(16>P)d[P]=m[f+P]|0;else{var C=d[P-15],M=d[P-2];d[P]=((C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3)+d[P-7]+((M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10)+d[P-16]}C=y+((E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25))+(E&F^~E&I)+o[P]+d[P],M=((b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22))+(b&_^b&O^_&O),y=I,I=F,F=E,E=S+C|0,S=O,O=_,_=b,b=C+M|0}x[0]=x[0]+b|0,x[1]=x[1]+_|0,x[2]=x[2]+O|0,x[3]=x[3]+S|0,x[4]=x[4]+E|0,x[5]=x[5]+F|0,x[6]=x[6]+I|0,x[7]=x[7]+y|0},_doFinalize:function(){var m=this._data,f=m.words,x=8*this._nDataBytes,b=8*m.sigBytes;return f[b>>>5]|=128<<24-b%32,f[(b+64>>>9<<4)+14]=n.floor(x/4294967296),f[(b+64>>>9<<4)+15]=x,m.sigBytes=4*f.length,this._process(),this._hash},clone:function(){var m=r.clone.call(this);return m._hash=this._hash.clone(),m}});e.SHA256=r._createHelper(p),e.HmacSHA256=r._createHmacHelper(p)})(Math);(function(){var n=Q,e=n.lib.WordArray,r=n.algo,t=r.SHA256,r=r.SHA224=t.extend({_doReset:function(){this._hash=new e.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=t._doFinalize.call(this);return i.sigBytes-=4,i}});n.SHA224=t._createHelper(r),n.HmacSHA224=t._createHmacHelper(r)})();(function(){function n(){return r.create.apply(r,arguments)}for(var e=Q,t=e.lib.Hasher,o=e.x64,r=o.Word,i=o.WordArray,o=e.algo,a=[n(1116352408,3609767458),n(1899447441,602891725),n(3049323471,3964484399),n(3921009573,2173295548),n(961987163,4081628472),n(1508970993,3053834265),n(2453635748,2937671579),n(2870763221,3664609560),n(3624381080,2734883394),n(310598401,1164996542),n(607225278,1323610764),n(1426881987,3590304994),n(1925078388,4068182383),n(2162078206,991336113),n(2614888103,633803317),n(3248222580,3479774868),n(3835390401,2666613458),n(4022224774,944711139),n(264347078,2341262773),n(604807628,2007800933),n(770255983,1495990901),n(1249150122,1856431235),n(1555081692,3175218132),n(1996064986,2198950837),n(2554220882,3999719339),n(2821834349,766784016),n(2952996808,2566594879),n(3210313671,3203337956),n(3336571891,1034457026),n(3584528711,2466948901),n(113926993,3758326383),n(338241895,168717936),n(666307205,1188179964),n(773529912,1546045734),n(1294757372,1522805485),n(1396182291,2643833823),n(1695183700,2343527390),n(1986661051,1014477480),n(2177026350,1206759142),n(2456956037,344077627),n(2730485921,1290863460),n(2820302411,3158454273),n(3259730800,3505952657),n(3345764771,106217008),n(3516065817,3606008344),n(3600352804,1432725776),n(4094571909,1467031594),n(275423344,851169720),n(430227734,3100823752),n(506948616,1363258195),n(659060556,3750685593),n(883997877,3785050280),n(958139571,3318307427),n(1322822218,3812723403),n(1537002063,2003034995),n(1747873779,3602036899),n(1955562222,1575990012),n(2024104815,1125592928),n(2227730452,2716904306),n(2361852424,442776044),n(2428436474,593698344),n(2756734187,3733110249),n(3204031479,2999351573),n(3329325298,3815920427),n(3391569614,3928383900),n(3515267271,566280711),n(3940187606,3454069534),n(4118630271,4000239992),n(116418474,1914138554),n(174292421,2731055270),n(289380356,3203993006),n(460393269,320620315),n(685471733,587496836),n(852142971,1086792851),n(1017036298,365543100),n(1126000580,2618297676),n(1288033470,3409855158),n(1501505948,4234509866),n(1607167915,987167468),n(1816402316,1246189591)],s=[],c=0;80>c;c++)s[c]=n();o=o.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(l,h){for(var _=this._hash.words,u=_[0],d=_[1],p=_[2],m=_[3],f=_[4],x=_[5],b=_[6],_=_[7],O=u.high,S=u.low,E=d.high,F=d.low,I=p.high,y=p.low,P=m.high,C=m.low,M=f.high,A=f.low,T=x.high,k=x.low,D=b.high,R=b.low,N=_.high,L=_.low,V=O,G=S,re=E,te=F,be=I,ge=y,rt=P,He=C,Ue=M,Ke=A,ze=T,pe=k,Ae=D,Me=R,Ge=N,St=L,$e=0;80>$e;$e++){var ai=s[$e];if(16>$e)var wn=ai.high=l[h+2*$e]|0,Le=ai.low=l[h+2*$e+1]|0;else{var wn=s[$e-15],Le=wn.high,vr=wn.low,wn=(Le>>>1|vr<<31)^(Le>>>8|vr<<24)^Le>>>7,vr=(vr>>>1|Le<<31)^(vr>>>8|Le<<24)^(vr>>>7|Le<<25),Yi=s[$e-2],Le=Yi.high,ut=Yi.low,Yi=(Le>>>19|ut<<13)^(Le<<3|ut>>>29)^Le>>>6,ut=(ut>>>19|Le<<13)^(ut<<3|Le>>>29)^(ut>>>6|Le<<26),Le=s[$e-7],vs=Le.high,oi=s[$e-16],br=oi.high,oi=oi.low,Le=vr+Le.low,wn=wn+vs+(Le>>>0<vr>>>0?1:0),Le=Le+ut,wn=wn+Yi+(Le>>>0<ut>>>0?1:0),Le=Le+oi,wn=wn+br+(Le>>>0<oi>>>0?1:0);ai.high=wn,ai.low=Le}var vs=Ue&ze^~Ue&Ae,oi=Ke&pe^~Ke&Me,ai=V&re^V&be^re&be,k5=G&te^G&ge^te&ge,vr=(V>>>28|G<<4)^(V<<30|G>>>2)^(V<<25|G>>>7),Yi=(G>>>28|V<<4)^(G<<30|V>>>2)^(G<<25|V>>>7),ut=a[$e],D5=ut.high,Hb=ut.low,ut=St+((Ke>>>14|Ue<<18)^(Ke>>>18|Ue<<14)^(Ke<<23|Ue>>>9)),br=Ge+((Ue>>>14|Ke<<18)^(Ue>>>18|Ke<<14)^(Ue<<23|Ke>>>9))+(ut>>>0<St>>>0?1:0),ut=ut+oi,br=br+vs+(ut>>>0<oi>>>0?1:0),ut=ut+Hb,br=br+D5+(ut>>>0<Hb>>>0?1:0),ut=ut+Le,br=br+wn+(ut>>>0<Le>>>0?1:0),Le=Yi+k5,ai=vr+ai+(Le>>>0<Yi>>>0?1:0),Ge=Ae,St=Me,Ae=ze,Me=pe,ze=Ue,pe=Ke,Ke=He+ut|0,Ue=rt+br+(Ke>>>0<He>>>0?1:0)|0,rt=be,He=ge,be=re,ge=te,re=V,te=G,G=ut+Le|0,V=br+ai+(G>>>0<ut>>>0?1:0)|0}S=u.low=S+G,u.high=O+V+(S>>>0<G>>>0?1:0),F=d.low=F+te,d.high=E+re+(F>>>0<te>>>0?1:0),y=p.low=y+ge,p.high=I+be+(y>>>0<ge>>>0?1:0),C=m.low=C+He,m.high=P+rt+(C>>>0<He>>>0?1:0),A=f.low=A+Ke,f.high=M+Ue+(A>>>0<Ke>>>0?1:0),k=x.low=k+pe,x.high=T+ze+(k>>>0<pe>>>0?1:0),R=b.low=R+Me,b.high=D+Ae+(R>>>0<Me>>>0?1:0),L=_.low=L+St,_.high=N+Ge+(L>>>0<St>>>0?1:0)},_doFinalize:function(){var l=this._data,h=l.words,u=8*this._nDataBytes,d=8*l.sigBytes;return h[d>>>5]|=128<<24-d%32,h[(d+128>>>10<<5)+30]=Math.floor(u/4294967296),h[(d+128>>>10<<5)+31]=u,l.sigBytes=4*h.length,this._process(),this._hash.toX32()},clone:function(){var l=t.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:32}),e.SHA512=t._createHelper(o),e.HmacSHA512=t._createHmacHelper(o)})();(function(){var n=Q,i=n.x64,e=i.Word,t=i.WordArray,i=n.algo,r=i.SHA512,i=i.SHA384=r.extend({_doReset:function(){this._hash=new t.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var o=r._doFinalize.call(this);return o.sigBytes-=16,o}});n.SHA384=r._createHelper(i),n.HmacSHA384=r._createHmacHelper(i)})();(function(){var n=Q,l=n.lib,e=l.WordArray,t=l.Hasher,l=n.algo,r=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),s=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),l=l.RIPEMD160=t.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,u){for(var d=0;16>d;d++){var p=u+d,m=h[p];h[p]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var p=this._hash.words,m=s.words,f=c.words,x=r.words,b=i.words,_=o.words,O=a.words,S,E,F,I,y,P,C,M,A,T;P=S=p[0],C=E=p[1],M=F=p[2],A=I=p[3],T=y=p[4];for(var k,d=0;80>d;d+=1)k=S+h[u+x[d]]|0,k=16>d?k+((E^F^I)+m[0]):32>d?k+((E&F|~E&I)+m[1]):48>d?k+(((E|~F)^I)+m[2]):64>d?k+((E&I|F&~I)+m[3]):k+((E^(F|~I))+m[4]),k|=0,k=k<<_[d]|k>>>32-_[d],k=k+y|0,S=y,y=I,I=F<<10|F>>>22,F=E,E=k,k=P+h[u+b[d]]|0,k=16>d?k+((C^(M|~A))+f[0]):32>d?k+((C&A|M&~A)+f[1]):48>d?k+(((C|~M)^A)+f[2]):64>d?k+((C&M|~C&A)+f[3]):k+((C^M^A)+f[4]),k|=0,k=k<<O[d]|k>>>32-O[d],k=k+T|0,P=T,T=A,A=M<<10|M>>>22,M=C,C=k;k=p[1]+F+A|0,p[1]=p[2]+I+T|0,p[2]=p[3]+y+P|0,p[3]=p[4]+S+C|0,p[4]=p[0]+E+M|0,p[0]=k},_doFinalize:function(){var h=this._data,u=h.words,d=8*this._nDataBytes,p=8*h.sigBytes;for(u[p>>>5]|=128<<24-p%32,u[(p+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,h.sigBytes=4*(u.length+1),this._process(),h=this._hash,u=h.words,d=0;5>d;d++)p=u[d],u[d]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360;return h},clone:function(){var h=t.clone.call(this);return h._hash=this._hash.clone(),h}});n.RIPEMD160=t._createHelper(l),n.HmacRIPEMD160=t._createHmacHelper(l)})(Math);(function(){var n=Q,e=n.enc.Utf8;n.algo.HMAC=n.lib.Base.extend({init:function(t,r){t=this._hasher=new t.init,typeof r=="string"&&(r=e.parse(r));var i=t.blockSize,o=4*i;r.sigBytes>o&&(r=t.finalize(r)),r.clamp();for(var a=this._oKey=r.clone(),s=this._iKey=r.clone(),c=a.words,l=s.words,h=0;h<i;h++)c[h]^=1549556828,l[h]^=909522486;a.sigBytes=s.sigBytes=o,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var r=this._hasher;return t=r.finalize(t),r.reset(),r.finalize(this._oKey.clone().concat(t))}})})();(function(){var n=Q,r=n.lib,e=r.Base,t=r.WordArray,r=n.algo,i=r.HMAC,o=r.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:r.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,s){for(var m=this.cfg,c=i.create(m.hasher,a),l=t.create(),h=t.create([1]),u=l.words,d=h.words,p=m.keySize,m=m.iterations;u.length<p;){var f=c.update(s).finalize(h);c.reset();for(var x=f.words,b=x.length,_=f,O=1;O<m;O++){_=c.finalize(_),c.reset();for(var S=_.words,E=0;E<b;E++)x[E]^=S[E]}l.concat(f),d[0]++}return l.sigBytes=4*p,l}});n.PBKDF2=function(a,s,c){return o.create(c).compute(a,s)}})();var ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F0="=";function Zr(n){var e,t,r="";for(e=0;e+3<=n.length;e+=3)t=parseInt(n.substring(e,e+3),16),r+=ns.charAt(t>>6)+ns.charAt(t&63);if(e+1==n.length?(t=parseInt(n.substring(e,e+1),16),r+=ns.charAt(t<<2)):e+2==n.length&&(t=parseInt(n.substring(e,e+2),16),r+=ns.charAt(t>>2)+ns.charAt((t&3)<<4)),F0)for(;(r.length&3)>0;)r+=F0;return r}function is(n){var e="",t,r=0,i,o;for(t=0;t<n.length&&n.charAt(t)!=F0;++t)o=ns.indexOf(n.charAt(t)),!(o<0)&&(r==0?(e+=Yr(o>>2),i=o&3,r=1):r==1?(e+=Yr(i<<2|o>>4),i=o&15,r=2):r==2?(e+=Yr(i),e+=Yr(o>>2),i=o&3,r=3):(e+=Yr(i<<2|o>>4),e+=Yr(o&15),r=0));return r==1&&(e+=Yr(i<<2)),e}function hk(n){var e=is(n),t,r=new Array;for(t=0;2*t<e.length;++t)r[t]=parseInt(e.substring(2*t,2*t+2),16);return r}var $i,QH=0xdeadbeefcafe,lk=(QH&16777215)==15715070;function B(n,e,t){n!=null&&(typeof n=="number"?this.fromNumber(n,e,t):e==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,e))}function Fe(){return new B(null)}function YH(n,e,t,r,i,o){for(;--o>=0;){var a=e*this[n++]+t[r]+i;i=Math.floor(a/67108864),t[r++]=a&67108863}return i}function ZH(n,e,t,r,i,o){for(var a=e&32767,s=e>>15;--o>=0;){var c=this[n]&32767,l=this[n++]>>15,h=s*c+l*a;c=a*c+((h&32767)<<15)+t[r]+(i&1073741823),i=(c>>>30)+(h>>>15)+s*l+(i>>>30),t[r++]=c&1073741823}return i}function eU(n,e,t,r,i,o){for(var a=e&16383,s=e>>14;--o>=0;){var c=this[n]&16383,l=this[n++]>>14,h=s*c+l*a;c=a*c+((h&16383)<<14)+t[r]+i,i=(c>>28)+(h>>14)+s*l,t[r++]=c&268435455}return i}lk&&ol.appName=="Microsoft Internet Explorer"?(B.prototype.am=ZH,$i=30):lk&&ol.appName!="Netscape"?(B.prototype.am=YH,$i=26):(B.prototype.am=eU,$i=28);B.prototype.DB=$i;B.prototype.DM=(1<<$i)-1;B.prototype.DV=1<<$i;var N0=52;B.prototype.FV=Math.pow(2,N0);B.prototype.F1=N0-$i;B.prototype.F2=2*$i-N0;var tU="0123456789abcdefghijklmnopqrstuvwxyz",hp=new Array,os,Zn;os=48;for(Zn=0;Zn<=9;++Zn)hp[os++]=Zn;os=97;for(Zn=10;Zn<36;++Zn)hp[os++]=Zn;os=65;for(Zn=10;Zn<36;++Zn)hp[os++]=Zn;function Yr(n){return tU.charAt(n)}function pk(n,e){var t=hp[n.charCodeAt(e)];return t??-1}function nU(n){for(var e=this.t-1;e>=0;--e)n[e]=this[e];n.t=this.t,n.s=this.s}function rU(n){this.t=1,this.s=n<0?-1:0,n>0?this[0]=n:n<-1?this[0]=n+this.DV:this.t=0}function Ki(n){var e=Fe();return e.fromInt(n),e}function iU(n,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(n,e);return}this.t=0,this.s=0;for(var r=n.length,i=!1,o=0;--r>=0;){var a=t==8?n[r]&255:pk(n,r);if(a<0){n.charAt(r)=="-"&&(i=!0);continue}i=!1,o==0?this[this.t++]=a:o+t>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=t,o>=this.DB&&(o-=this.DB)}t==8&&n[0]&128&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&B.ZERO.subTo(this,this)}function oU(){for(var n=this.s&this.DM;this.t>0&&this[this.t-1]==n;)--this.t}function aU(n){if(this.s<0)return"-"+this.negate().toString(n);var e;if(n==16)e=4;else if(n==8)e=3;else if(n==2)e=1;else if(n==32)e=5;else if(n==4)e=2;else return this.toRadix(n);var t=(1<<e)-1,r,i=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(r=this[a]>>s)>0&&(i=!0,o=Yr(r));a>=0;)s<e?(r=(this[a]&(1<<s)-1)<<e-s,r|=this[--a]>>(s+=this.DB-e)):(r=this[a]>>(s-=e)&t,s<=0&&(s+=this.DB,--a)),r>0&&(i=!0),i&&(o+=Yr(r));return i?o:"0"}function sU(){var n=Fe();return B.ZERO.subTo(this,n),n}function cU(){return this.s<0?this.negate():this}function lU(n){var e=this.s-n.s;if(e!=0)return e;var t=this.t;if(e=t-n.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this[t]-n[t])!=0)return e;return 0}function pp(n){var e=1,t;return(t=n>>>16)!=0&&(n=t,e+=16),(t=n>>8)!=0&&(n=t,e+=8),(t=n>>4)!=0&&(n=t,e+=4),(t=n>>2)!=0&&(n=t,e+=2),(t=n>>1)!=0&&(n=t,e+=1),e}function dU(){return this.t<=0?0:this.DB*(this.t-1)+pp(this[this.t-1]^this.s&this.DM)}function uU(n,e){var t;for(t=this.t-1;t>=0;--t)e[t+n]=this[t];for(t=n-1;t>=0;--t)e[t]=0;e.t=this.t+n,e.s=this.s}function hU(n,e){for(var t=n;t<this.t;++t)e[t-n]=this[t];e.t=Math.max(this.t-n,0),e.s=this.s}function pU(n,e){var t=n%this.DB,r=this.DB-t,i=(1<<r)-1,o=Math.floor(n/this.DB),a=this.s<<t&this.DM,s;for(s=this.t-1;s>=0;--s)e[s+o+1]=this[s]>>r|a,a=(this[s]&i)<<t;for(s=o-1;s>=0;--s)e[s]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function gU(n,e){e.s=this.s;var t=Math.floor(n/this.DB);if(t>=this.t){e.t=0;return}var r=n%this.DB,i=this.DB-r,o=(1<<r)-1;e[0]=this[t]>>r;for(var a=t+1;a<this.t;++a)e[a-t-1]|=(this[a]&o)<<i,e[a-t]=this[a]>>r;r>0&&(e[this.t-t-1]|=(this.s&o)<<i),e.t=this.t-t,e.clamp()}function fU(n,e){for(var t=0,r=0,i=Math.min(n.t,this.t);t<i;)r+=this[t]-n[t],e[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r-=n.s;t<this.t;)r+=this[t],e[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r-=n[t],e[t++]=r&this.DM,r>>=this.DB;r-=n.s}e.s=r<0?-1:0,r<-1?e[t++]=this.DV+r:r>0&&(e[t++]=r),e.t=t,e.clamp()}function mU(n,e){var t=this.abs(),r=n.abs(),i=t.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+t.t]=t.am(0,r[i],e,i,0,t.t);e.s=0,e.clamp(),this.s!=n.s&&B.ZERO.subTo(e,e)}function vU(n){for(var e=this.abs(),t=n.t=2*e.t;--t>=0;)n[t]=0;for(t=0;t<e.t-1;++t){var r=e.am(t,e[t],n,2*t,0,1);(n[t+e.t]+=e.am(t+1,2*e[t],n,2*t+1,r,e.t-t-1))>=e.DV&&(n[t+e.t]-=e.DV,n[t+e.t+1]=1)}n.t>0&&(n[n.t-1]+=e.am(t,e[t],n,2*t,0,1)),n.s=0,n.clamp()}function bU(n,e,t){var r=n.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t){e?.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=Fe());var o=Fe(),a=this.s,s=n.s,c=this.DB-pp(r[r.t-1]);c>0?(r.lShiftTo(c,o),i.lShiftTo(c,t)):(r.copyTo(o),i.copyTo(t));var l=o.t,h=o[l-1];if(h!=0){var u=h*(1<<this.F1)+(l>1?o[l-2]>>this.F2:0),d=this.FV/u,p=(1<<this.F1)/u,m=1<<this.F2,f=t.t,x=f-l,b=e??Fe();for(o.dlShiftTo(x,b),t.compareTo(b)>=0&&(t[t.t++]=1,t.subTo(b,t)),B.ONE.dlShiftTo(l,b),b.subTo(o,o);o.t<l;)o[o.t++]=0;for(;--x>=0;){var _=t[--f]==h?this.DM:Math.floor(t[f]*d+(t[f-1]+m)*p);if((t[f]+=o.am(0,_,t,x,0,l))<_)for(o.dlShiftTo(x,b),t.subTo(b,t);t[f]<--_;)t.subTo(b,t)}e!=null&&(t.drShiftTo(l,e),a!=s&&B.ZERO.subTo(e,e)),t.t=l,t.clamp(),c>0&&t.rShiftTo(c,t),a<0&&B.ZERO.subTo(t,t)}}}function xU(n){var e=Fe();return this.abs().divRemTo(n,null,e),this.s<0&&e.compareTo(B.ZERO)>0&&n.subTo(e,e),e}function Ao(n){this.m=n}function _U(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function yU(n){return n}function CU(n){n.divRemTo(this.m,null,n)}function wU(n,e,t){n.multiplyTo(e,t),this.reduce(t)}function PU(n,e){n.squareTo(e),this.reduce(e)}Ao.prototype.convert=_U;Ao.prototype.revert=yU;Ao.prototype.reduce=CU;Ao.prototype.mulTo=wU;Ao.prototype.sqrTo=PU;function OU(){if(this.t<1)return 0;var n=this[0];if(!(n&1))return 0;var e=n&3;return e=e*(2-(n&15)*e)&15,e=e*(2-(n&255)*e)&255,e=e*(2-((n&65535)*e&65535))&65535,e=e*(2-n*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ko(n){this.m=n,this.mp=n.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}function MU(n){var e=Fe();return n.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),n.s<0&&e.compareTo(B.ZERO)>0&&this.m.subTo(e,e),e}function SU(n){var e=Fe();return n.copyTo(e),this.reduce(e),e}function EU(n){for(;n.t<=this.mt2;)n[n.t++]=0;for(var e=0;e<this.m.t;++e){var t=n[e]&32767,r=t*this.mpl+((t*this.mph+(n[e]>>15)*this.mpl&this.um)<<15)&n.DM;for(t=e+this.m.t,n[t]+=this.m.am(0,r,n,e,0,this.m.t);n[t]>=n.DV;)n[t]-=n.DV,n[++t]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function AU(n,e){n.squareTo(e),this.reduce(e)}function kU(n,e,t){n.multiplyTo(e,t),this.reduce(t)}ko.prototype.convert=MU;ko.prototype.revert=SU;ko.prototype.reduce=EU;ko.prototype.mulTo=kU;ko.prototype.sqrTo=AU;function DU(){return(this.t>0?this[0]&1:this.s)==0}function FU(n,e){if(n>4294967295||n<1)return B.ONE;var t=Fe(),r=Fe(),i=e.convert(this),o=pp(n)-1;for(i.copyTo(t);--o>=0;)if(e.sqrTo(t,r),(n&1<<o)>0)e.mulTo(r,i,t);else{var a=t;t=r,r=a}return e.revert(t)}function TU(n,e){var t;return n<256||e.isEven()?t=new Ao(e):t=new ko(e),this.exp(n,t)}B.prototype.copyTo=nU;B.prototype.fromInt=rU;B.prototype.fromString=iU;B.prototype.clamp=oU;B.prototype.dlShiftTo=uU;B.prototype.drShiftTo=hU;B.prototype.lShiftTo=pU;B.prototype.rShiftTo=gU;B.prototype.subTo=fU;B.prototype.multiplyTo=mU;B.prototype.squareTo=vU;B.prototype.divRemTo=bU;B.prototype.invDigit=OU;B.prototype.isEven=DU;B.prototype.exp=FU;B.prototype.toString=aU;B.prototype.negate=sU;B.prototype.abs=cU;B.prototype.compareTo=lU;B.prototype.bitLength=dU;B.prototype.mod=xU;B.prototype.modPowInt=TU;B.ZERO=Ki(0);B.ONE=Ki(1);function zU(){var n=Fe();return this.copyTo(n),n}function IU(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function RU(){return this.t==0?this.s:this[0]<<24>>24}function NU(){return this.t==0?this.s:this[0]<<16>>16}function BU(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function qU(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function LU(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var e=this.chunkSize(n),t=Math.pow(n,e),r=Ki(t),i=Fe(),o=Fe(),a="";for(this.divRemTo(r,i,o);i.signum()>0;)a=(t+o.intValue()).toString(n).substr(1)+a,i.divRemTo(r,i,o);return o.intValue().toString(n)+a}function jU(n,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),r=Math.pow(e,t),i=!1,o=0,a=0,s=0;s<n.length;++s){var c=pk(n,s);if(c<0){n.charAt(s)=="-"&&this.signum()==0&&(i=!0);continue}a=e*a+c,++o>=t&&(this.dMultiply(r),this.dAddOffset(a,0),o=0,a=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),i&&B.ZERO.subTo(this,this)}function VU(n,e,t){if(typeof e=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,t),this.testBit(n-1)||this.bitwiseTo(B.ONE.shiftLeft(n-1),B0,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(B.ONE.shiftLeft(n-1),this);else{var r=new Array,i=n&7;r.length=(n>>3)+1,e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}function HU(){var n=this.t,e=new Array;e[0]=this.s;var t=this.DB-n*this.DB%8,r,i=0;if(n-- >0)for(t<this.DB&&(r=this[n]>>t)!=(this.s&this.DM)>>t&&(e[i++]=r|this.s<<this.DB-t);n>=0;)t<8?(r=(this[n]&(1<<t)-1)<<8-t,r|=this[--n]>>(t+=this.DB-8)):(r=this[n]>>(t-=8)&255,t<=0&&(t+=this.DB,--n)),r&128&&(r|=-256),i==0&&(this.s&128)!=(r&128)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function UU(n){return this.compareTo(n)==0}function GU(n){return this.compareTo(n)<0?this:n}function WU(n){return this.compareTo(n)>0?this:n}function KU(n,e,t){var r,i,o=Math.min(n.t,this.t);for(r=0;r<o;++r)t[r]=e(this[r],n[r]);if(n.t<this.t){for(i=n.s&this.DM,r=o;r<this.t;++r)t[r]=e(this[r],i);t.t=this.t}else{for(i=this.s&this.DM,r=o;r<n.t;++r)t[r]=e(i,n[r]);t.t=n.t}t.s=e(this.s,n.s),t.clamp()}function $U(n,e){return n&e}function XU(n){var e=Fe();return this.bitwiseTo(n,$U,e),e}function B0(n,e){return n|e}function JU(n){var e=Fe();return this.bitwiseTo(n,B0,e),e}function gk(n,e){return n^e}function QU(n){var e=Fe();return this.bitwiseTo(n,gk,e),e}function fk(n,e){return n&~e}function YU(n){var e=Fe();return this.bitwiseTo(n,fk,e),e}function ZU(){for(var n=Fe(),e=0;e<this.t;++e)n[e]=this.DM&~this[e];return n.t=this.t,n.s=~this.s,n}function eG(n){var e=Fe();return n<0?this.rShiftTo(-n,e):this.lShiftTo(n,e),e}function tG(n){var e=Fe();return n<0?this.lShiftTo(-n,e):this.rShiftTo(n,e),e}function nG(n){if(n==0)return-1;var e=0;return n&65535||(n>>=16,e+=16),n&255||(n>>=8,e+=8),n&15||(n>>=4,e+=4),n&3||(n>>=2,e+=2),n&1||++e,e}function rG(){for(var n=0;n<this.t;++n)if(this[n]!=0)return n*this.DB+nG(this[n]);return this.s<0?this.t*this.DB:-1}function iG(n){for(var e=0;n!=0;)n&=n-1,++e;return e}function oG(){for(var n=0,e=this.s&this.DM,t=0;t<this.t;++t)n+=iG(this[t]^e);return n}function aG(n){var e=Math.floor(n/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<n%this.DB)!=0}function sG(n,e){var t=B.ONE.shiftLeft(n);return this.bitwiseTo(t,e,t),t}function cG(n){return this.changeBit(n,B0)}function lG(n){return this.changeBit(n,fk)}function dG(n){return this.changeBit(n,gk)}function uG(n,e){for(var t=0,r=0,i=Math.min(n.t,this.t);t<i;)r+=this[t]+n[t],e[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r+=n.s;t<this.t;)r+=this[t],e[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r+=n[t],e[t++]=r&this.DM,r>>=this.DB;r+=n.s}e.s=r<0?-1:0,r>0?e[t++]=r:r<-1&&(e[t++]=this.DV+r),e.t=t,e.clamp()}function hG(n){var e=Fe();return this.addTo(n,e),e}function pG(n){var e=Fe();return this.subTo(n,e),e}function gG(n){var e=Fe();return this.multiplyTo(n,e),e}function fG(){var n=Fe();return this.squareTo(n),n}function mG(n){var e=Fe();return this.divRemTo(n,e,null),e}function vG(n){var e=Fe();return this.divRemTo(n,null,e),e}function bG(n){var e=Fe(),t=Fe();return this.divRemTo(n,e,t),new Array(e,t)}function xG(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function _G(n,e){if(n!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=n;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function sl(){}function mk(n){return n}function yG(n,e,t){n.multiplyTo(e,t)}function CG(n,e){n.squareTo(e)}sl.prototype.convert=mk;sl.prototype.revert=mk;sl.prototype.mulTo=yG;sl.prototype.sqrTo=CG;function wG(n){return this.exp(n,new sl)}function PG(n,e,t){var r=Math.min(this.t+n.t,e);for(t.s=0,t.t=r;r>0;)t[--r]=0;var i;for(i=t.t-this.t;r<i;++r)t[r+this.t]=this.am(0,n[r],t,r,0,this.t);for(i=Math.min(n.t,e);r<i;++r)this.am(0,n[r],t,r,0,e-r);t.clamp()}function OG(n,e,t){--e;var r=t.t=this.t+n.t-e;for(t.s=0;--r>=0;)t[r]=0;for(r=Math.max(e-this.t,0);r<n.t;++r)t[this.t+r-e]=this.am(e-r,n[r],t,0,0,this.t+r-e);t.clamp(),t.drShiftTo(1,t)}function as(n){this.r2=Fe(),this.q3=Fe(),B.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function MG(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var e=Fe();return n.copyTo(e),this.reduce(e),e}function SG(n){return n}function EG(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function AG(n,e){n.squareTo(e),this.reduce(e)}function kG(n,e,t){n.multiplyTo(e,t),this.reduce(t)}as.prototype.convert=MG;as.prototype.revert=SG;as.prototype.reduce=EG;as.prototype.mulTo=kG;as.prototype.sqrTo=AG;function DG(n,e){var t=n.bitLength(),r,i=Ki(1),o;if(t<=0)return i;t<18?r=1:t<48?r=3:t<144?r=4:t<768?r=5:r=6,t<8?o=new Ao(e):e.isEven()?o=new as(e):o=new ko(e);var a=new Array,s=3,c=r-1,l=(1<<r)-1;if(a[1]=o.convert(this),r>1){var h=Fe();for(o.sqrTo(a[1],h);s<=l;)a[s]=Fe(),o.mulTo(h,a[s-2],a[s]),s+=2}var u=n.t-1,d,p=!0,m=Fe(),f;for(t=pp(n[u])-1;u>=0;){for(t>=c?d=n[u]>>t-c&l:(d=(n[u]&(1<<t+1)-1)<<c-t,u>0&&(d|=n[u-1]>>this.DB+t-c)),s=r;!(d&1);)d>>=1,--s;if((t-=s)<0&&(t+=this.DB,--u),p)a[d].copyTo(i),p=!1;else{for(;s>1;)o.sqrTo(i,m),o.sqrTo(m,i),s-=2;s>0?o.sqrTo(i,m):(f=i,i=m,m=f),o.mulTo(m,a[d],i)}for(;u>=0&&!(n[u]&1<<t);)o.sqrTo(i,m),f=i,i=m,m=f,--t<0&&(t=this.DB-1,--u)}return o.revert(i)}function FG(n){var e=this.s<0?this.negate():this.clone(),t=n.s<0?n.negate():n.clone();if(e.compareTo(t)<0){var r=e;e=t,t=r}var i=e.getLowestSetBit(),o=t.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),t.rShiftTo(o,t));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return o>0&&t.lShiftTo(o,t),t}function TG(n){if(n<=0)return 0;var e=this.DV%n,t=this.s<0?n-1:0;if(this.t>0)if(e==0)t=this[0]%n;else for(var r=this.t-1;r>=0;--r)t=(e*t+this[r])%n;return t}function zG(n){var e=n.isEven();if(this.isEven()&&e||n.signum()==0)return B.ZERO;for(var t=n.clone(),r=this.clone(),i=Ki(1),o=Ki(0),a=Ki(0),s=Ki(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(n,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(n,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),e?((!a.isEven()||!s.isEven())&&(a.addTo(this,a),s.subTo(n,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(n,s),s.rShiftTo(1,s);t.compareTo(r)>=0?(t.subTo(r,t),e&&i.subTo(a,i),o.subTo(s,o)):(r.subTo(t,r),e&&a.subTo(i,a),s.subTo(o,s))}if(r.compareTo(B.ONE)!=0)return B.ZERO;if(s.compareTo(n)>=0)return s.subtract(n);if(s.signum()<0)s.addTo(n,s);else return s;return s.signum()<0?s.add(n):s}var Cn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],IG=(1<<26)/Cn[Cn.length-1];function RG(n){var e,t=this.abs();if(t.t==1&&t[0]<=Cn[Cn.length-1]){for(e=0;e<Cn.length;++e)if(t[0]==Cn[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Cn.length;){for(var r=Cn[e],i=e+1;i<Cn.length&&r<IG;)r*=Cn[i++];for(r=t.modInt(r);e<i;)if(r%Cn[e++]==0)return!1}return t.millerRabin(n)}function NG(n){var e=this.subtract(B.ONE),t=e.getLowestSetBit();if(t<=0)return!1;var r=e.shiftRight(t);n=n+1>>1,n>Cn.length&&(n=Cn.length);for(var i=Fe(),o=0;o<n;++o){i.fromInt(Cn[Math.floor(Math.random()*Cn.length)]);var a=i.modPow(r,this);if(a.compareTo(B.ONE)!=0&&a.compareTo(e)!=0){for(var s=1;s++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(B.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}B.prototype.chunkSize=BU;B.prototype.toRadix=LU;B.prototype.fromRadix=jU;B.prototype.fromNumber=VU;B.prototype.bitwiseTo=KU;B.prototype.changeBit=sG;B.prototype.addTo=uG;B.prototype.dMultiply=xG;B.prototype.dAddOffset=_G;B.prototype.multiplyLowerTo=PG;B.prototype.multiplyUpperTo=OG;B.prototype.modInt=TG;B.prototype.millerRabin=NG;B.prototype.clone=zU;B.prototype.intValue=IU;B.prototype.byteValue=RU;B.prototype.shortValue=NU;B.prototype.signum=qU;B.prototype.toByteArray=HU;B.prototype.equals=UU;B.prototype.min=GU;B.prototype.max=WU;B.prototype.and=XU;B.prototype.or=JU;B.prototype.xor=QU;B.prototype.andNot=YU;B.prototype.not=ZU;B.prototype.shiftLeft=eG;B.prototype.shiftRight=tG;B.prototype.getLowestSetBit=rG;B.prototype.bitCount=oG;B.prototype.testBit=aG;B.prototype.setBit=cG;B.prototype.clearBit=lG;B.prototype.flipBit=dG;B.prototype.add=hG;B.prototype.subtract=pG;B.prototype.multiply=gG;B.prototype.divide=mG;B.prototype.remainder=vG;B.prototype.divideAndRemainder=bG;B.prototype.modPow=DG;B.prototype.modInverse=zG;B.prototype.pow=wG;B.prototype.gcd=FG;B.prototype.isProbablePrime=RG;B.prototype.square=fG;function q0(){this.i=0,this.j=0,this.S=new Array}function BG(n){var e,t,r;for(e=0;e<256;++e)this.S[e]=e;for(t=0,e=0;e<256;++e)t=t+this.S[e]+n[e%n.length]&255,r=this.S[e],this.S[e]=this.S[t],this.S[t]=r;this.i=0,this.j=0}function qG(){var n;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,n=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=n,this.S[n+this.S[this.i]&255]}q0.prototype.init=BG;q0.prototype.next=qG;function LG(){return new q0}var T0=256;var cp,Vn,jt;function jG(n){Vn[jt++]^=n&255,Vn[jt++]^=n>>8&255,Vn[jt++]^=n>>16&255,Vn[jt++]^=n>>24&255,jt>=T0&&(jt-=T0)}function L0(){jG(new Date().getTime())}if(Vn==null){if(Vn=new Array,jt=0,ts!==void 0&&(ts.crypto!==void 0||ts.msCrypto!==void 0)){if(A0=ts.crypto||ts.msCrypto,A0.getRandomValues)for(k0=new Uint8Array(32),A0.getRandomValues(k0),Yn=0;Yn<32;++Yn)Vn[jt++]=k0[Yn];else if(ol.appName=="Netscape"&&ol.appVersion<"5")for(D0=ts.crypto.random(32),Yn=0;Yn<D0.length;++Yn)Vn[jt++]=D0.charCodeAt(Yn)&255}for(;jt<T0;)Yn=Math.floor(65536*Math.random()),Vn[jt++]=Yn>>>8,Vn[jt++]=Yn&255;jt=0,L0()}var Yn,A0,k0,D0;function VG(){if(cp==null){for(L0(),cp=LG(),cp.init(Vn),jt=0;jt<Vn.length;++jt)Vn[jt]=0;jt=0}return cp.next()}function HG(n){var e;for(e=0;e<n.length;++e)n[e]=VG()}function ss(){}ss.prototype.nextBytes=HG;function Tn(n,e){return new B(n,e)}function ve(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function UG(n,e){if(this.isPublic=!0,this.isPrivate=!1,typeof n!="string")this.n=n,this.e=e;else if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Tn(n,16),this.e=parseInt(e,16);else throw"Invalid RSA public key"}function GG(n){return n.modPowInt(this.e,this.n)}ve.prototype.doPublic=GG;ve.prototype.setPublic=UG;ve.prototype.type="RSA";function WG(n,e,t){if(this.isPrivate=!0,typeof n!="string")this.n=n,this.e=e,this.d=t;else if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Tn(n,16),this.e=parseInt(e,16),this.d=Tn(t,16);else throw"Invalid RSA private key"}function KG(n,e,t,r,i,o,a,s){if(this.isPrivate=!0,this.isPublic=!1,n==null)throw"RSASetPrivateEx N == null";if(e==null)throw"RSASetPrivateEx E == null";if(n.length==0)throw"RSASetPrivateEx N.length == 0";if(e.length==0)throw"RSASetPrivateEx E.length == 0";if(n!=null&&e!=null&&n.length>0&&e.length>0)this.n=Tn(n,16),this.e=parseInt(e,16),this.d=Tn(t,16),this.p=Tn(r,16),this.q=Tn(i,16),this.dmp1=Tn(o,16),this.dmq1=Tn(a,16),this.coeff=Tn(s,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function $G(n,e){var t=new ss,r=n>>1;this.e=parseInt(e,16);for(var i=new B(e,16),o=n/2-100,a=B.ONE.shiftLeft(o);;){for(;this.p=new B(n-r,1,t),!(this.p.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new B(r,1,t),!(this.q.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var c=this.q.subtract(this.p).abs();if(!(c.bitLength()<o||c.compareTo(a)<=0)){var l=this.p.subtract(B.ONE),h=this.q.subtract(B.ONE),u=l.multiply(h);if(u.gcd(i).compareTo(B.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==n)){this.d=i.modInverse(u),this.dmp1=this.d.mod(l),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function XG(n){if(this.p==null||this.q==null)return n.modPow(this.d,this.n);for(var e=n.mod(this.p).modPow(this.dmp1,this.p),t=n.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(t)<0;)e=e.add(this.p);return e.subtract(t).multiply(this.coeff).mod(this.p).multiply(this.q).add(t)}ve.prototype.doPrivate=XG;ve.prototype.setPrivate=WG;ve.prototype.setPrivateEx=KG;ve.prototype.generate=$G;function zt(n,e){this.x=e,this.q=n}function JG(n){return n==this?!0:this.q.equals(n.q)&&this.x.equals(n.x)}function QG(){return this.x}function YG(){return new zt(this.q,this.x.negate().mod(this.q))}function ZG(n){return new zt(this.q,this.x.add(n.toBigInteger()).mod(this.q))}function eW(n){return new zt(this.q,this.x.subtract(n.toBigInteger()).mod(this.q))}function tW(n){return new zt(this.q,this.x.multiply(n.toBigInteger()).mod(this.q))}function nW(){return new zt(this.q,this.x.square().mod(this.q))}function rW(n){return new zt(this.q,this.x.multiply(n.toBigInteger().modInverse(this.q)).mod(this.q))}zt.prototype.equals=JG;zt.prototype.toBigInteger=QG;zt.prototype.negate=YG;zt.prototype.add=ZG;zt.prototype.subtract=eW;zt.prototype.multiply=tW;zt.prototype.square=nW;zt.prototype.divide=rW;zt.prototype.sqrt=function(){return new zt(this.q,this.x.sqrt().mod(this.q))};function qe(n,e,t,r){this.curve=n,this.x=e,this.y=t,r==null?this.z=B.ONE:this.z=r,this.zinv=null}function iW(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function oW(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function aW(n){if(n==this)return!0;if(this.isInfinity())return n.isInfinity();if(n.isInfinity())return this.isInfinity();var e,t;return e=n.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(n.z)).mod(this.curve.q),e.equals(B.ZERO)?(t=n.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(n.z)).mod(this.curve.q),t.equals(B.ZERO)):!1}function sW(){return this.x==null&&this.y==null?!0:this.z.equals(B.ZERO)&&!this.y.toBigInteger().equals(B.ZERO)}function cW(){return new qe(this.curve,this.x,this.y.negate(),this.z)}function lW(n){if(this.isInfinity())return n;if(n.isInfinity())return this;var e=n.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(n.z)).mod(this.curve.q),t=n.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(n.z)).mod(this.curve.q);if(B.ZERO.equals(t))return B.ZERO.equals(e)?this.twice():this.curve.getInfinity();var r=new B("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),a=n.x.toBigInteger(),s=n.y.toBigInteger(),c=t.square(),l=c.multiply(t),h=i.multiply(c),u=e.square().multiply(this.z),d=u.subtract(h.shiftLeft(1)).multiply(n.z).subtract(l).multiply(t).mod(this.curve.q),p=h.multiply(r).multiply(e).subtract(o.multiply(l)).subtract(u.multiply(e)).multiply(n.z).add(e.multiply(l)).mod(this.curve.q),m=l.multiply(this.z).multiply(n.z).mod(this.curve.q);return new qe(this.curve,this.curve.fromBigInteger(d),this.curve.fromBigInteger(p),m)}function dW(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var n=new B("3"),e=this.x.toBigInteger(),t=this.y.toBigInteger(),r=t.multiply(this.z),i=r.multiply(t).mod(this.curve.q),o=this.curve.a.toBigInteger(),a=e.square().multiply(n);B.ZERO.equals(o)||(a=a.add(this.z.square().multiply(o))),a=a.mod(this.curve.q);var s=a.square().subtract(e.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(r).mod(this.curve.q),c=a.multiply(n).multiply(e).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),l=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new qe(this.curve,this.curve.fromBigInteger(s),this.curve.fromBigInteger(c),l)}function uW(n){if(this.isInfinity())return this;if(n.signum()==0)return this.curve.getInfinity();var e=n,t=e.multiply(new B("3")),r=this.negate(),i=this,o=this.curve.q.subtract(n),a=o.multiply(new B("3")),s=new qe(this.curve,this.x,this.y),c=s.negate(),l;for(l=t.bitLength()-2;l>0;--l){i=i.twice();var h=t.testBit(l),u=e.testBit(l);h!=u&&(i=i.add(h?this:r))}for(l=a.bitLength()-2;l>0;--l){s=s.twice();var d=a.testBit(l),p=o.testBit(l);d!=p&&(s=s.add(d?s:c))}return i}function hW(n,e,t){var r;n.bitLength()>t.bitLength()?r=n.bitLength()-1:r=t.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(e);r>=0;)i=i.twice(),n.testBit(r)?t.testBit(r)?i=i.add(o):i=i.add(this):t.testBit(r)&&(i=i.add(e)),--r;return i}qe.prototype.getX=iW;qe.prototype.getY=oW;qe.prototype.equals=aW;qe.prototype.isInfinity=sW;qe.prototype.negate=cW;qe.prototype.add=lW;qe.prototype.twice=dW;qe.prototype.multiply=uW;qe.prototype.multiplyTwo=hW;function ei(n,e,t){this.q=n,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(t),this.infinity=new qe(this,null,null)}function pW(){return this.q}function gW(){return this.a}function fW(){return this.b}function mW(n){return n==this?!0:this.q.equals(n.q)&&this.a.equals(n.a)&&this.b.equals(n.b)}function vW(){return this.infinity}function bW(n){return new zt(this.q,n)}function xW(n){switch(parseInt(n.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var e=n.substr(0,2),t=n.substr(2),r=this.fromBigInteger(new B(l,16)),i=this.getA(),o=this.getB(),a=r.square().add(i).multiply(r).add(o),s=a.sqrt();return e=="03"&&(s=s.negate()),new qe(this,r,s);case 4:case 6:case 7:var c=(n.length-2)/2,l=n.substr(2,c),h=n.substr(c+2,c);return new qe(this,this.fromBigInteger(new B(l,16)),this.fromBigInteger(new B(h,16)));default:return null}}ei.prototype.getQ=pW;ei.prototype.getA=gW;ei.prototype.getB=fW;ei.prototype.equals=mW;ei.prototype.getInfinity=vW;ei.prototype.fromBigInteger=bW;ei.prototype.decodePointHex=xW;zt.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};qe.prototype.getEncoded=function(n){var e=function(o,a){var s=o.toByteArrayUnsigned();if(a<s.length)s=s.slice(s.length-a);else for(;a>s.length;)s.unshift(0);return s},t=this.getX().toBigInteger(),r=this.getY().toBigInteger(),i=e(t,32);return n?r.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(e(r,32))),i};qe.decodeFrom=function(n,e){var t=e[0],r=e.length-1,i=e.slice(1,1+r/2),o=e.slice(1+r/2,1+r);i.unshift(0),o.unshift(0);var a=new B(i),s=new B(o);return new qe(n,n.fromBigInteger(a),n.fromBigInteger(s))};qe.decodeFromHex=function(n,e){var t=e.substr(0,2),r=e.length-2,i=e.substr(2,r/2),o=e.substr(2+r/2,r/2),a=new B(i,16),s=new B(o,16);return new qe(n,n.fromBigInteger(a),n.fromBigInteger(s))};qe.prototype.add2D=function(n){if(this.isInfinity())return n;if(n.isInfinity())return this;if(this.x.equals(n.x))return this.y.equals(n.y)?this.twice():this.curve.getInfinity();var e=n.x.subtract(this.x),t=n.y.subtract(this.y),r=t.divide(e),i=r.square().subtract(this.x).subtract(n.x),o=r.multiply(this.x.subtract(i)).subtract(this.y);return new qe(this.curve,i,o)};qe.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var n=this.curve.fromBigInteger(B.valueOf(2)),e=this.curve.fromBigInteger(B.valueOf(3)),t=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(n)),r=t.square().subtract(this.x.multiply(n)),i=t.multiply(this.x.subtract(r)).subtract(this.y);return new qe(this.curve,r,i)};qe.prototype.multiply2D=function(n){if(this.isInfinity())return this;if(n.signum()==0)return this.curve.getInfinity();var e=n,t=e.multiply(new B("3")),r=this.negate(),i=this,o;for(o=t.bitLength()-2;o>0;--o){i=i.twice();var a=t.testBit(o),s=e.testBit(o);a!=s&&(i=i.add2D(a?this:r))}return i};qe.prototype.isOnCurve=function(){var n=this.getX().toBigInteger(),e=this.getY().toBigInteger(),t=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=e.multiply(e).mod(i),a=n.multiply(n).multiply(n).add(t.multiply(n)).add(r).mod(i);return o.equals(a)};qe.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};qe.prototype.validate=function(){var n=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),t=this.getY().toBigInteger();if(e.compareTo(B.ONE)<0||e.compareTo(n.subtract(B.ONE))>0)throw new Error("x coordinate out of bounds");if(t.compareTo(B.ONE)<0||t.compareTo(n.subtract(B.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(n).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var vk=function(){var n="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",e='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',t='(?:"'+e+'*")',r=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+n+"|"+t+")","g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),o={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function a(u,d,p){return d?o[d]:String.fromCharCode(parseInt(p,16))}var s=new String(""),c="\\",l={"{":Object,"[":Array},h=Object.hasOwnProperty;return function(u,d){var p=u.match(r),m,f=p[0],x=!1;f==="{"?m={}:f==="["?m=[]:(m=[],x=!0);for(var b,_=[m],O=1-x,S=p.length;O<S;++O){f=p[O];var E;switch(f.charCodeAt(0)){default:E=_[0],E[b||E.length]=+f,b=void 0;break;case 34:if(f=f.substring(1,f.length-1),f.indexOf(c)!==-1&&(f=f.replace(i,a)),E=_[0],!b)if(E instanceof Array)b=E.length;else{b=f||s;break}E[b]=f,b=void 0;break;case 91:E=_[0],_.unshift(E[b||E.length]=[]),b=void 0;break;case 93:_.shift();break;case 102:E=_[0],E[b||E.length]=!1,b=void 0;break;case 110:E=_[0],E[b||E.length]=null,b=void 0;break;case 116:E=_[0],E[b||E.length]=!0,b=void 0;break;case 123:E=_[0],_.unshift(E[b||E.length]={}),b=void 0;break;case 125:_.shift();break}}if(x){if(_.length!==1)throw new Error;m=m[0]}else if(_.length)throw new Error;if(d){var F=function(I,y){var P=I[y];if(P&&typeof P=="object"){var C=null;for(var M in P)if(h.call(P,M)&&P!==I){var A=F(P,M);A!==void 0?P[M]=A:(C||(C=[]),C.push(M))}if(C)for(var T=C.length;--T>=0;)delete P[C[T]]}return d.call(I,y,P)};m=F({"":m},"")}return m}}();(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});g.asn1.ASN1Util=new function(){this.integerToByteHex=function(n){var e=n.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(n){return ll(n)},this.getPEMStringFromHex=function(n,e){return un(n,e)},this.newObject=function(n){var e=g,t=e.asn1,r=t.ASN1Object,i=t.DERBoolean,o=t.DERInteger,a=t.DERBitString,s=t.DEROctetString,c=t.DERNull,l=t.DERObjectIdentifier,h=t.DEREnumerated,u=t.DERUTF8String,d=t.DERNumericString,p=t.DERPrintableString,m=t.DERTeletexString,f=t.DERIA5String,x=t.DERUTCTime,b=t.DERGeneralizedTime,_=t.DERVisibleString,O=t.DERBMPString,S=t.DERSequence,E=t.DERSet,F=t.DERTaggedObject,I=t.ASN1Util.newObject;if(n instanceof t.ASN1Object)return n;var y=Object.keys(n);if(y.length!=1)throw new Error("key of param shall be only one.");var P=y[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+P+":")==-1)throw new Error("undefined key: "+P);if(P=="bool")return new i(n[P]);if(P=="int")return new o(n[P]);if(P=="bitstr")return new a(n[P]);if(P=="octstr")return new s(n[P]);if(P=="null")return new c(n[P]);if(P=="oid")return new l(n[P]);if(P=="enum")return new h(n[P]);if(P=="utf8str")return new u(n[P]);if(P=="numstr")return new d(n[P]);if(P=="prnstr")return new p(n[P]);if(P=="telstr")return new m(n[P]);if(P=="ia5str")return new f(n[P]);if(P=="utctime")return new x(n[P]);if(P=="gentime")return new b(n[P]);if(P=="visstr")return new _(n[P]);if(P=="bmpstr")return new O(n[P]);if(P=="asn1")return new r(n[P]);if(P=="seq"){for(var C=n[P],M=[],A=0;A<C.length;A++){var T=I(C[A]);M.push(T)}return new S({array:M})}if(P=="set"){for(var C=n[P],M=[],A=0;A<C.length;A++){var T=I(C[A]);M.push(T)}return new E({array:M})}if(P=="tag"){var k=n[P];if(Object.prototype.toString.call(k)==="[object Array]"&&k.length==3){var D=I(k[2]);return new F({tag:k[0],explicit:k[1],obj:D})}else return new F(k)}},this.jsonToASN1HEX=function(n){var e=this.newObject(n);return e.tohex()}};g.asn1.ASN1Util.oidHexToInt=function(n){for(var i="",e=parseInt(n.substr(0,2),16),t=Math.floor(e/40),r=e%40,i=t+"."+r,o="",a=2;a<n.length;a+=2){var s=parseInt(n.substr(a,2),16),c=("00000000"+s.toString(2)).slice(-8);if(o=o+c.substr(1,7),c.substr(0,1)=="0"){var l=new B(o,2);i=i+"."+l.toString(10),o=""}}return i};g.asn1.ASN1Util.oidIntToHex=function(n){var e=function(s){var c=s.toString(16);return c.length==1&&(c="0"+c),c},t=function(s){var c="",l=new B(s,10),h=l.toString(2),u=7-h.length%7;u==7&&(u=0);for(var d="",p=0;p<u;p++)d+="0";h=d+h;for(var p=0;p<h.length-1;p+=7){var m=h.substr(p,7);p!=h.length-7&&(m="1"+m),c+=e(parseInt(m,2))}return c};if(!n.match(/^[0-9.]+$/))throw"malformed oid string: "+n;var r="",i=n.split("."),o=parseInt(i[0])*40+parseInt(i[1]);r+=e(o),i.splice(0,2);for(var a=0;a<i.length;a++)r+=t(i[a]);return r};g.asn1.ASN1Object=function(n){var e=!0,t=null,r="00",i="00",o="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+o.length+",v="+this.hV);var a=this.hV.length/2,s=a.toString(16);if(s.length%2==1&&(s="0"+s),a<128)return s;var c=s.length/2;if(c>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+a.toString(16));var l=128+c;return l.toString(16)+s},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(a){this.params=a},n!=null&&n.tlv!=null&&(this.hTLV=n.tlv,this.isModified=!1)};g.asn1.DERAbstractString=function(n){g.asn1.DERAbstractString.superclass.constructor.call(this);var e=null,t=null;this.getString=function(){return this.s},this.setString=function(r){this.hTLV=null,this.isModified=!0,this.s=r,this.hV=fp(this.s).toLowerCase()},this.setStringHex=function(r){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n=="string"?this.setString(n):typeof n.str<"u"?this.setString(n.str):typeof n.hex<"u"&&this.setStringHex(n.hex))};U(g.asn1.DERAbstractString,g.asn1.ASN1Object);g.asn1.DERAbstractTime=function(n){g.asn1.DERAbstractTime.superclass.constructor.call(this);var e=null,t=null;this.localDateToUTC=function(r){var i=r.getTime()+r.getTimezoneOffset()*6e4,o=new Date(i);return o},this.formatDate=function(r,i,o){var a=this.zeroPadding,s=this.localDateToUTC(r),c=String(s.getFullYear());i=="utc"&&(c=c.substr(2,2));var l=a(String(s.getMonth()+1),2),h=a(String(s.getDate()),2),u=a(String(s.getHours()),2),d=a(String(s.getMinutes()),2),p=a(String(s.getSeconds()),2),m=c+l+h+u+d+p;if(o===!0){var f=s.getMilliseconds();if(f!=0){var x=a(String(f),3);x=x.replace(/[0]+$/,""),m=m+"."+x}}return m+"Z"},this.zeroPadding=function(r,i){return r.length>=i?r:new Array(i-r.length+1).join("0")+r},this.setByParam=function(r){this.hV=null,this.hTLV=null,this.params=r},this.getString=function(){},this.setString=function(r){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=r},this.setByDate=function(r){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=r},this.setByDateValue=function(r,i,o,a,s,c){var l=new Date(Date.UTC(r,i-1,o,a,s,c,0));this.setByDate(l)},this.getFreshValueHex=function(){return this.hV}};U(g.asn1.DERAbstractTime,g.asn1.ASN1Object);g.asn1.DERAbstractStructured=function(n){g.asn1.DERAbstractString.superclass.constructor.call(this);var e=null;this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,typeof n<"u"&&typeof n.array<"u"&&(this.asn1Array=n.array)};U(g.asn1.DERAbstractStructured,g.asn1.ASN1Object);g.asn1.DERBoolean=function(n){g.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",n==!1?this.hTLV="010100":this.hTLV="0101ff"};U(g.asn1.DERBoolean,g.asn1.ASN1Object);g.asn1.DERInteger=function(n){g.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var e=ll;this.setByBigInteger=function(t){this.isModified=!0,this.params={bigint:t}},this.setByInteger=function(t){this.isModified=!0,this.params=t},this.setValueHex=function(t){this.isModified=!0,this.params={hex:t}},this.getFreshValueHex=function(){var t=this.params,r=null;if(t==null)throw new Error("value not set");if(typeof t=="object"&&t.hex!=null)return this.hV=t.hex,this.hV;if(typeof t=="number")r=new B(String(t),10);else if(t.int!=null)r=new B(String(t.int),10);else if(t.bigint!=null)r=t.bigint;else throw new Error("wrong parameter");return this.hV=e(r),this.hV},n!=null&&(this.params=n)};U(g.asn1.DERInteger,g.asn1.ASN1Object);g.asn1.DERBitString=function(n){if(n!==void 0&&typeof n.obj<"u"){var e=g.asn1.ASN1Util.newObject(n.obj);n.hex="00"+e.tohex()}g.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,r){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+r},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var r=8-t.length%8;r==8&&(r=0),t+="0000000".substr(0,r);for(var i="",o=0;o<t.length-1;o+=8){var a=t.substr(o,8),s=parseInt(a,2).toString(16);s.length==1&&(s="0"+s),i+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+r+i},this.setByBooleanArray=function(t){for(var r="",i=0;i<t.length;i++)t[i]==!0?r+="1":r+="0";this.setByBinaryString(r)},this.newFalseArray=function(t){for(var r=new Array(t),i=0;i<t;i++)r[i]=!1;return r},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n=="string"&&n.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(n):typeof n.hex<"u"?this.setHexValueIncludingUnusedBits(n.hex):typeof n.bin<"u"?this.setByBinaryString(n.bin):typeof n.array<"u"&&this.setByBooleanArray(n.array))};U(g.asn1.DERBitString,g.asn1.ASN1Object);g.asn1.DEROctetString=function(n){if(n!==void 0&&typeof n.obj<"u"){var e=g.asn1.ASN1Util.newObject(n.obj);n.hex=e.tohex()}g.asn1.DEROctetString.superclass.constructor.call(this,n),this.hT="04"};U(g.asn1.DEROctetString,g.asn1.DERAbstractString);g.asn1.DERNull=function(){g.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};U(g.asn1.DERNull,g.asn1.ASN1Object);g.asn1.DERObjectIdentifier=function(n){g.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=Pk(e);if(t==null)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=g.asn1.x509.OID.name2oid(e);if(t!=="")this.setValueOidString(t);else throw new Error("DERObjectIdentifier oidName undefined: "+e)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){typeof e=="string"?this.setValueNameOrOid(e):e.oid!==void 0?this.setValueNameOrOid(e.oid):e.name!==void 0?this.setValueNameOrOid(e.name):e.hex!==void 0&&this.setValueHex(e.hex)},n!==void 0&&this.setByParam(n)};U(g.asn1.DERObjectIdentifier,g.asn1.ASN1Object);g.asn1.DEREnumerated=function(n){g.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ll(e)},this.setByInteger=function(e){var t=new B(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},typeof n<"u"&&(typeof n.int<"u"?this.setByInteger(n.int):typeof n=="number"?this.setByInteger(n):typeof n.hex<"u"&&this.setValueHex(n.hex))};U(g.asn1.DEREnumerated,g.asn1.ASN1Object);g.asn1.DERUTF8String=function(n){g.asn1.DERUTF8String.superclass.constructor.call(this,n),this.hT="0c"};U(g.asn1.DERUTF8String,g.asn1.DERAbstractString);g.asn1.DERNumericString=function(n){g.asn1.DERNumericString.superclass.constructor.call(this,n),this.hT="12"};U(g.asn1.DERNumericString,g.asn1.DERAbstractString);g.asn1.DERPrintableString=function(n){g.asn1.DERPrintableString.superclass.constructor.call(this,n),this.hT="13"};U(g.asn1.DERPrintableString,g.asn1.DERAbstractString);g.asn1.DERTeletexString=function(n){g.asn1.DERTeletexString.superclass.constructor.call(this,n),this.hT="14"};U(g.asn1.DERTeletexString,g.asn1.DERAbstractString);g.asn1.DERIA5String=function(n){g.asn1.DERIA5String.superclass.constructor.call(this,n),this.hT="16"};U(g.asn1.DERIA5String,g.asn1.DERAbstractString);g.asn1.DERVisibleString=function(n){g.asn1.DERIA5String.superclass.constructor.call(this,n),this.hT="1a"};U(g.asn1.DERVisibleString,g.asn1.DERAbstractString);g.asn1.DERBMPString=function(n){g.asn1.DERBMPString.superclass.constructor.call(this,n),this.hT="1e"};U(g.asn1.DERBMPString,g.asn1.DERAbstractString);g.asn1.DERUTCTime=function(n){g.asn1.DERUTCTime.superclass.constructor.call(this,n),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var e=this.params;if(this.params==null&&(e={date:new Date}),typeof e=="string")if(e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=zn(e);else throw new Error("malformed string for UTCTime: "+e);else if(e.str!=null)this.hV=zn(e.str);else if(e.date==null&&e.millis==!0){var t=new Date;this.hV=zn(this.formatDate(t,"utc",!0))}else if(e.date!=null&&e.date instanceof Date){var r=e.millis===!0;this.hV=zn(this.formatDate(e.date,"utc",r))}else e instanceof Date&&(this.hV=zn(this.formatDate(e,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},n!=null&&this.setByParam(n)};U(g.asn1.DERUTCTime,g.asn1.DERAbstractTime);g.asn1.DERGeneralizedTime=function(n){g.asn1.DERGeneralizedTime.superclass.constructor.call(this,n),this.hT="18",this.params=n,this.getFreshValueHex=function(){var e=this.params;if(this.params==null&&(e={date:new Date}),typeof e=="string")if(e.match(/^[0-9]{14}Z$/)||e.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=zn(e);else throw new Error("malformed string for GeneralizedTime: "+e);else if(e.str!=null)this.hV=zn(e.str);else if(e.date==null&&e.millis==!0){var t=new Date;this.hV=zn(this.formatDate(t,"gen",!0))}else if(e.date!=null&&e.date instanceof Date){var r=e.millis===!0;this.hV=zn(this.formatDate(e.date,"gen",r))}else e instanceof Date&&(this.hV=zn(this.formatDate(e,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},n!=null&&this.setByParam(n)};U(g.asn1.DERGeneralizedTime,g.asn1.DERAbstractTime);g.asn1.DERSequence=function(n){g.asn1.DERSequence.superclass.constructor.call(this,n),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e+=r.tohex()}return this.hV=e,this.hV}};U(g.asn1.DERSequence,g.asn1.DERAbstractStructured);g.asn1.DERSet=function(n){g.asn1.DERSet.superclass.constructor.call(this,n),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.tohex())}return this.sortFlag==!0&&e.sort(),this.hV=e.join(""),this.hV},typeof n<"u"&&typeof n.sortflag<"u"&&n.sortflag==!1&&(this.sortFlag=!1)};U(g.asn1.DERSet,g.asn1.DERAbstractStructured);g.asn1.DERTaggedObject=function(n){g.asn1.DERTaggedObject.superclass.constructor.call(this);var e=g.asn1,t=$,r=t.getV,i=t.isASN1HEX,o=e.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(a,s,c){this.params={tag:s,explicit:a,obj:c}},this.getFreshValueHex=function(){var a=this.params;if(a.explicit==null&&(a.explicit=!0),a.tage!=null&&(a.tag=a.tage,a.explicit=!0),a.tagi!=null&&(a.tag=a.tagi,a.explicit=!1),a.str!=null)this.hV=fp(a.str);else if(a.hex!=null)this.hV=a.hex;else if(a.obj!=null){var s;a.obj instanceof e.ASN1Object?s=a.obj.tohex():typeof a.obj=="object"&&(s=o(a.obj).tohex()),a.explicit?this.hV=s:this.hV=r(s,0)}else throw new Error("str, hex nor obj not specified");return a.tag==null&&(a.tag="a0"),this.hT=a.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(a){this.params=a},n!==void 0&&this.setByParam(n)};U(g.asn1.DERTaggedObject,g.asn1.ASN1Object);var $=new function(){};$.getLblen=function(n,e){if(n.substr(e+2,1)!="8")return 1;var t=parseInt(n.substr(e+3,1));return t==0?-1:0<t&&t<10?t+1:-2};$.getL=function(n,e){var t=$.getLblen(n,e);return t<1?"":n.substr(e+2,t*2)};$.getVblen=function(n,e){var t,r;return t=$.getL(n,e),t==""?-1:(t.substr(0,1)==="8"?r=new B(t.substr(2),16):r=new B(t,16),r.intValue())};$.getVidx=function(n,e){var t=$.getLblen(n,e);return t<0?t:e+(t+1)*2};$.getV=function(n,e){var t=$.getVidx(n,e),r=$.getVblen(n,e);return n.substr(t,r*2)};$.getTLV=function(n,e){return n.substr(e,2)+$.getL(n,e)+$.getV(n,e)};$.getTLVblen=function(n,e){return 2+$.getLblen(n,e)*2+$.getVblen(n,e)*2};$.getNextSiblingIdx=function(n,e){var t=$.getVidx(n,e),r=$.getVblen(n,e);return t+r*2};$.getChildIdx=function(n,e){var t=$,r=[],i,o,a;i=t.getVidx(n,e),o=t.getVblen(n,e)*2,n.substr(e,2)=="03"&&(i+=2,o-=2),a=0;for(var s=i;a<=o;){var c=t.getTLVblen(n,s);if(a+=c,a<=o&&r.push(s),s+=c,a>=o)break}return r};$.getNthChildIdx=function(n,e,t){var r=$.getChildIdx(n,e);return r[t]};$.getIdxbyList=function(n,e,t,r){var i=$,o,a;return t.length==0?r!==void 0&&n.substr(e,2)!==r?-1:e:(o=t.shift(),a=i.getChildIdx(n,e),o>=a.length?-1:i.getIdxbyList(n,a[o],t,r))};$.getIdxbyListEx=function(n,e,t,r){var i=$,o,a;if(t.length==0)return r!==void 0&&n.substr(e,2)!==r?-1:e;o=t.shift(),a=i.getChildIdx(n,e);for(var s=0,c=0;c<a.length;c++){var l=n.substr(a[c],2);if(typeof o=="number"&&!i.isContextTag(l)&&s==o||typeof o=="string"&&i.isContextTag(l,o))return i.getIdxbyListEx(n,a[c],t,r);i.isContextTag(l)||s++}return-1};$.getTLVbyList=function(n,e,t,r){var i=$,o=i.getIdxbyList(n,e,t,r);return o==-1||o>=n.length?null:i.getTLV(n,o)};$.getTLVbyListEx=function(n,e,t,r){var i=$,o=i.getIdxbyListEx(n,e,t,r);return o==-1?null:i.getTLV(n,o)};$.getVbyList=function(n,e,t,r,i){var o=$,a,s;return a=o.getIdxbyList(n,e,t,r),a==-1||a>=n.length?null:(s=o.getV(n,a),i===!0&&(s=s.substr(2)),s)};$.getVbyListEx=function(n,e,t,r,i){var o=$,a,s,c;return a=o.getIdxbyListEx(n,e,t,r),a==-1?null:(c=o.getV(n,a),n.substr(a,2)=="03"&&i!==!1&&(c=c.substr(2)),c)};$.getInt=function(n,e,t){t==null&&(t=-1);try{var r=n.substr(e,2);if(r!="02"&&r!="03")return t;var i=$.getV(n,e);return r=="02"?parseInt(i,16):Mk(i)}catch{return t}};$.getOID=function(n,e,t){t==null&&(t=null);try{if(n.substr(e,2)!="06")return t;var r=$.getV(n,e);return _p(r)}catch{return t}};$.getOIDName=function(n,e,t){t==null&&(t=null);try{var r=$.getOID(n,e,t);if(r==t)return t;var i=g.asn1.x509.OID.oid2name(r);return i==""?r:i}catch{return t}};$.getString=function(n,e,t){t==null&&(t=null);try{var r=$.getV(n,e);return In(r)}catch{return t}};$.hextooidstr=function(n){var e=function(u,d){return u.length>=d?u:new Array(d-u.length+1).join("0")+u},t=[],r=n.substr(0,2),i=parseInt(r,16);t[0]=new String(Math.floor(i/40)),t[1]=new String(i%40);for(var o=n.substr(2),a=[],s=0;s<o.length/2;s++)a.push(parseInt(o.substr(s*2,2),16));for(var c=[],l="",s=0;s<a.length;s++)a[s]&128?l=l+e((a[s]&127).toString(2),7):(l=l+e((a[s]&127).toString(2),7),c.push(new String(parseInt(l,2))),l="");var h=t.join(".");return c.length>0&&(h=h+"."+c.join(".")),h};$.dump=function(n,e,t,r){var i=$,o=i.getV,a=i.dump,s=i.getChildIdx,c=n;n instanceof g.asn1.ASN1Object&&(c=n.tohex());var l=function(I,y){if(I.length<=y*2)return I;var P=I.substr(0,y)+"..(total "+I.length/2+"bytes).."+I.substr(I.length-y,y);return P};e===void 0&&(e={ommit_long_octet:32}),t===void 0&&(t=0),r===void 0&&(r="");var h=e.ommit_long_octet,E=c.substr(t,2);if(E=="01"){var u=o(c,t);return u=="00"?r+`BOOLEAN FALSE
`:r+`BOOLEAN TRUE
`}if(E=="02"){var u=o(c,t);return r+"INTEGER "+l(u,h)+`
`}if(E=="03"){var u=o(c,t);if(i.isASN1HEX(u.substr(2))){var d=r+`BITSTRING, encapsulates
`;return d=d+a(u.substr(2),e,0,r+"  "),d}else return r+"BITSTRING "+l(u,h)+`
`}if(E=="04"){var u=o(c,t);if(i.isASN1HEX(u)){var d=r+`OCTETSTRING, encapsulates
`;return d=d+a(u,e,0,r+"  "),d}else return r+"OCTETSTRING "+l(u,h)+`
`}if(E=="05")return r+`NULL
`;if(E=="06"){var p=o(c,t),m=g.asn1.ASN1Util.oidHexToInt(p),f=g.asn1.x509.OID.oid2name(m),x=m.replace(/\./g," ");return f!=""?r+"ObjectIdentifier "+f+" ("+x+`)
`:r+"ObjectIdentifier ("+x+`)
`}if(E=="0a")return r+"ENUMERATED "+parseInt(o(c,t))+`
`;if(E=="0c")return r+"UTF8String '"+Ve(o(c,t))+`'
`;if(E=="13")return r+"PrintableString '"+Ve(o(c,t))+`'
`;if(E=="14")return r+"TeletexString '"+Ve(o(c,t))+`'
`;if(E=="16")return r+"IA5String '"+Ve(o(c,t))+`'
`;if(E=="17")return r+"UTCTime "+Ve(o(c,t))+`
`;if(E=="18")return r+"GeneralizedTime "+Ve(o(c,t))+`
`;if(E=="1a")return r+"VisualString '"+Ve(o(c,t))+`'
`;if(E=="1e")return r+"BMPString '"+U0(o(c,t))+`'
`;if(E=="30"){if(c.substr(t,4)=="3000")return r+`SEQUENCE {}
`;var d=r+`SEQUENCE
`,b=s(c,t),_=e;if((b.length==2||b.length==3)&&c.substr(b[0],2)=="06"&&c.substr(b[b.length-1],2)=="04"){var f=i.oidname(o(c,b[0])),O=JSON.parse(JSON.stringify(e));O.x509ExtName=f,_=O}for(var S=0;S<b.length;S++)d=d+a(c,_,b[S],r+"  ");return d}if(E=="31"){for(var d=r+`SET
`,b=s(c,t),S=0;S<b.length;S++)d=d+a(c,e,b[S],r+"  ");return d}var E=parseInt(E,16);if(E&128){var F=E&31;if(E&32){for(var d=r+"["+F+`]
`,b=s(c,t),S=0;S<b.length;S++)d=d+a(c,e,b[S],r+"  ");return d}else{var u=o(c,t);if($.isASN1HEX(u)){var d=r+"["+F+`]
`;return d=d+a(u,e,0,r+"  "),d}else(u.substr(0,8)=="68747470"||e.x509ExtName==="subjectAltName"&&F==2)&&(u=Ve(u));var d=r+"["+F+"] "+u+`
`;return d}}return r+"UNKNOWN("+E+") "+o(c,t)+`
`};$.parse=function(n){var e=$,t=e.parse,r=e.isASN1HEX,i=e.getV,o=e.getTLV,a=e.getChildIdx,s=g.asn1,c=s.ASN1Util.oidHexToInt,l=s.x509.OID.oid2name,h=Ve,u=U0,d=OW,p={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},m=function(P){for(var C=[],M=a(P,0),A=0;A<M.length;A++){var T=M[A],k=o(P,T),D=t(k);C.push(D)}return C},f=n.substr(0,2),x={},b=i(n,0);if(f=="01")return n=="0101ff"?{bool:!0}:{bool:!1};if(f=="02")return{int:{hex:b}};if(f=="03")try{if(b.substr(0,2)!="00")throw"not encap";var _=b.substr(2);if(!r(_))throw"not encap";return{bitstr:{obj:t(_)}}}catch{var O=null;return b.length<=10&&(O=Ek(b)),O==null?{bitstr:{hex:b}}:{bitstr:{bin:O}}}else if(f=="04")try{if(!r(b))throw"not encap";return{octstr:{obj:t(b)}}}catch{return{octstr:{hex:b}}}else{if(f=="05")return{null:""};if(f=="06"){var S=c(b),E=l(S);return E==""?{oid:S}:{oid:E}}else{if(f=="0a")return b.length>4?{enum:{hex:b}}:{enum:parseInt(b,16)};if(f=="30"||f=="31")return x[p[f]]=m(n),x;if(f=="14"){var F=d(b);return x[p[f]]={str:F},x}else if(f=="1e"){var F=u(b);return x[p[f]]={str:F},x}else if(":0c:12:13:16:17:18:1a:".indexOf(f)!=-1){var F=h(b);return x[p[f]]={str:F},x}else if(f.match(/^8[0-9]$/)){var F=h(b);return F==null|F==""?{tag:{tag:f,explicit:!1,hex:b}}:F.match(/[\x00-\x1F\x7F-\x9F]/)!=null||F.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:f,explicit:!1,hex:b}}:{tag:{tag:f,explicit:!1,str:F}}}else if(f.match(/^a[0-9]$/))try{if(!r(b))throw new Error("not encap");return{tag:{tag:f,explicit:!0,obj:t(b)}}}catch{return{tag:{tag:f,explicit:!0,hex:b}}}else{var I=new g.asn1.ASN1Object;I.hV=b;var y=I.getLengthHexFromValue();return{asn1:{tlv:f+y+b}}}}}};$.isContextTag=function(n,e){n=n.toLowerCase();var t,r;try{t=parseInt(n,16)}catch{return-1}if(e===void 0)return(t&192)==128;try{var i=e.match(/^\[[0-9]+\]$/);return i==null||(r=parseInt(e.substr(1,e.length-1),10),r>31)?!1:(t&192)==128&&(t&31)==r}catch{return!1}};$.isASN1HEX=function(n){var e=$;if(n.length%2==1)return!1;var t=e.getVblen(n,0),r=n.substr(0,2),i=e.getL(n,0),o=n.length-r.length-i.length;return o==t*2};$.checkStrictDER=function(n,e,t,r,i){var o=$;if(t===void 0){if(typeof n!="string")throw new Error("not hex string");if(n=n.toLowerCase(),!g.lang.String.isHex(n))throw new Error("not hex string");t=n.length,r=n.length/2,r<128?i=1:i=Math.ceil(r.toString(16))+1}var a=o.getL(n,e);if(a.length>i*2)throw new Error("L of TLV too long: idx="+e);var s=o.getVblen(n,e);if(s>r)throw new Error("value of L too long than hex: idx="+e);var c=o.getTLV(n,e),l=c.length-2-o.getL(n,e).length;if(l!==s*2)throw new Error("V string length and L's value not the same:"+l+"/"+s*2);if(e===0&&n.length!=c.length)throw new Error("total length and TLV length unmatch:"+n.length+"!="+c.length);var h=n.substr(e,2);if(h==="02"){var u=o.getVidx(n,e);if(n.substr(u,2)=="00"&&n.charCodeAt(u+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(h,16)&32){for(var d=o.getVblen(n,e),p=0,m=o.getChildIdx(n,e),f=0;f<m.length;f++){var x=o.getTLV(n,m[f]);p+=x.length,o.checkStrictDER(n,m[f],t,r,i)}if(d*2!=p)throw new Error("sum of children's TLV length and L unmatch: "+d*2+"!="+p)}};$.oidname=function(n){var e=g.asn1;g.lang.String.isHex(n)&&(n=e.ASN1Util.oidHexToInt(n));var t=e.x509.OID.oid2name(n);return t===""&&(t=n),t};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.x509>"u"||!g.asn1.x509)&&(g.asn1.x509={});g.asn1.x509.Certificate=function(n){g.asn1.x509.Certificate.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.x509,a=o.TBSCertificate,s=o.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,l=c.sigalg;c.sigalg.name!=null&&(l=c.sigalg.name);var h=c.tbsobj.tohex(),u=new g.crypto.Signature({alg:l});u.init(c.cakey),u.updateHex(h),c.sighex=u.sign()},this.getPEM=function(){return un(this.tohex(),"CERTIFICATE")},this.tohex=function(){var c=this.params;if((c.tbsobj==null||c.tbsobj==null)&&(c.tbsobj=new a(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(c.tbsobj),l.push(new s({name:c.sigalg})),l.push(new r({hex:"00"+c.sighex}));var h=new i({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&(this.params=n)};U(g.asn1.x509.Certificate,g.asn1.ASN1Object);g.asn1.x509.TBSCertificate=function(n){g.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.x509,i=t.DERTaggedObject,o=t.DERInteger,a=t.DERSequence,s=r.AlgorithmIdentifier,c=r.Time,l=r.X500Name,h=r.Extensions,u=r.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(d){this.params=d},this.tohex=function(){var d=[],p=this.params;if(p.version!=null||p.version!=1){var m=2;p.version!=null&&(m=p.version-1);var f=new i({obj:new o({int:m})});d.push(f)}d.push(new o(p.serial)),d.push(new s({name:p.sigalg})),d.push(new l(p.issuer)),d.push(new a({array:[new c(p.notbefore),new c(p.notafter)]})),d.push(new l(p.subject)),d.push(new u(Se.getKey(p.sbjpubkey))),p.ext!==void 0&&p.ext.length>0&&d.push(new i({tag:"a3",obj:new h(p.ext)}));var x=new g.asn1.DERSequence({array:d});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.TBSCertificate,g.asn1.ASN1Object);g.asn1.x509.Extensions=function(n){g.asn1.x509.Extensions.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.DERSequence,i=t.x509;this.aParam=[],this.setByParam=function(o){this.aParam=o},this.tohex=function(){for(var o=[],a=0;a<this.aParam.length;a++){var s=this.aParam[a],c=s.extname,l=null;if(s.extn!=null)l=new i.PrivateExtension(s);else if(c=="subjectKeyIdentifier")l=new i.SubjectKeyIdentifier(s);else if(c=="keyUsage")l=new i.KeyUsage(s);else if(c=="subjectAltName")l=new i.SubjectAltName(s);else if(c=="issuerAltName")l=new i.IssuerAltName(s);else if(c=="basicConstraints")l=new i.BasicConstraints(s);else if(c=="nameConstraints")l=new i.NameConstraints(s);else if(c=="cRLDistributionPoints")l=new i.CRLDistributionPoints(s);else if(c=="certificatePolicies")l=new i.CertificatePolicies(s);else if(c=="policyMappings")l=new i.PolicyMappings(s);else if(c=="policyConstraints")l=new i.PolicyConstraints(s);else if(c=="inhibitAnyPolicy")l=new i.InhibitAnyPolicy(s);else if(c=="authorityKeyIdentifier")l=new i.AuthorityKeyIdentifier(s);else if(c=="extKeyUsage")l=new i.ExtKeyUsage(s);else if(c=="authorityInfoAccess")l=new i.AuthorityInfoAccess(s);else if(c=="cRLNumber")l=new i.CRLNumber(s);else if(c=="cRLReason")l=new i.CRLReason(s);else if(c=="ocspNonce")l=new i.OCSPNonce(s);else if(c=="ocspNoCheck")l=new i.OCSPNoCheck(s);else if(c=="adobeTimeStamp")l=new i.AdobeTimeStamp(s);else if(c=="subjectDirectoryAttributes")l=new i.SubjectDirectoryAttributes(s);else throw new Error("extension not supported:"+JSON.stringify(s));l!=null&&o.push(l)}var h=new r({array:o});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.x509.Extensions,g.asn1.ASN1Object);g.asn1.x509.Extension=function(n){g.asn1.x509.Extension.superclass.constructor.call(this);var e=null,t=g,r=t.asn1,i=r.DERObjectIdentifier,o=r.DEROctetString,a=r.DERBitString,s=r.DERBoolean,c=r.DERSequence;this.tohex=function(){var l=new i({oid:this.oid}),h=new o({hex:this.getExtnValueHex()}),u=new Array;u.push(l),this.critical&&u.push(new s),u.push(h);var d=new c({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,n!==void 0&&n.critical!==void 0&&(this.critical=n.critical)};U(g.asn1.x509.Extension,g.asn1.ASN1Object);g.asn1.x509.KeyUsage=function(n){g.asn1.x509.KeyUsage.superclass.constructor.call(this,n);var e=Error,t={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var r=this.getBinValue();return this.asn1ExtnValue=new g.asn1.DERBitString({bin:r}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var r=this.params;if(typeof r!="object"||typeof r.names!="object"&&typeof r.bin!="string")throw new e("parameter not yet set");if(r.names!=null)return up(r.names,t);if(r.bin!=null)return r.bin;throw new e("parameter not set properly")},this.oid="2.5.29.15",n!==void 0&&(this.params=n)};U(g.asn1.x509.KeyUsage,g.asn1.x509.Extension);g.asn1.x509.BasicConstraints=function(n){g.asn1.x509.BasicConstraints.superclass.constructor.call(this,n);var e=g.asn1,t=e.DERBoolean,r=e.DERInteger,i=e.DERSequence,o=!1,a=-1;this.getExtnValueHex=function(){var s=new Array;this.cA&&s.push(new t),this.pathLen>-1&&s.push(new r({int:this.pathLen}));var c=new i({array:s});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,n!==void 0&&(n.cA!==void 0&&(this.cA=n.cA),n.pathLen!==void 0&&(this.pathLen=n.pathLen))};U(g.asn1.x509.BasicConstraints,g.asn1.x509.Extension);g.asn1.x509.CRLDistributionPoints=function(n){g.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(i){for(var o=[],a=0;a<i.length;a++)if(i[a]instanceof g.asn1.ASN1Object)o.push(i[a]);else{var s=new r.DistributionPoint(i[a]);o.push(s)}this.asn1ExtnValue=new t.DERSequence({array:o})},this.setByOneURI=function(i){var o=new r.DistributionPoint({fulluri:i});this.setByDPArray([o])},this.oid="2.5.29.31",n!==void 0&&(n.array!==void 0?this.setByDPArray(n.array):n.uri!==void 0&&this.setByOneURI(n.uri))};U(g.asn1.x509.CRLDistributionPoints,g.asn1.x509.Extension);g.asn1.x509.DistributionPoint=function(n){g.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=null,t=g,r=t.asn1,i=r.x509.DistributionPointName;this.tohex=function(){var o=new r.DERSequence;if(this.asn1DP!=null){var a=new r.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});o.appendASN1Object(a)}return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.dpobj!==void 0?this.asn1DP=n.dpobj:n.dpname!==void 0?this.asn1DP=new i(n.dpname):n.fulluri!==void 0&&(this.asn1DP=new i({full:[{uri:n.fulluri}]})))};U(g.asn1.x509.DistributionPoint,g.asn1.ASN1Object);g.asn1.x509.DistributionPointName=function(n){g.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=null,t=null,r=null,i=null,o=g,a=o.asn1,s=a.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new s({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0)if(a.x509.GeneralNames.prototype.isPrototypeOf(n))this.type="full",this.tag="a0",this.asn1V=n;else if(n.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new a.x509.GeneralNames(n.full);else throw new Error("This class supports GeneralNames only as argument")};U(g.asn1.x509.DistributionPointName,g.asn1.ASN1Object);g.asn1.x509.CertificatePolicies=function(n){g.asn1.x509.CertificatePolicies.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509,i=t.DERSequence,o=r.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var a=[],s=0;s<this.params.array.length;s++)a.push(new o(this.params.array[s]));var c=new i({array:a});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",n!==void 0&&(this.params=n)};U(g.asn1.x509.CertificatePolicies,g.asn1.x509.Extension);g.asn1.x509.PolicyInformation=function(n){g.asn1.x509.PolicyInformation.superclass.constructor.call(this,n);var e=g.asn1,t=e.DERSequence,r=e.DERObjectIdentifier,i=e.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var o=[new r(this.params.policyoid)];if(this.params.array!==void 0){for(var a=[],s=0;s<this.params.array.length;s++)a.push(new i(this.params.array[s]));a.length>0&&o.push(new t({array:a}))}var c=new t({array:o});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};U(g.asn1.x509.PolicyInformation,g.asn1.ASN1Object);g.asn1.x509.PolicyQualifierInfo=function(n){g.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,n);var e=g.asn1,t=e.DERSequence,r=e.DERIA5String,i=e.DERObjectIdentifier,o=e.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var a=new t({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new r({str:this.params.cps})]});return a.tohex()}if(this.params.unotice!=null){var a=new t({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new o(this.params.unotice)]});return a.tohex()}},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};U(g.asn1.x509.PolicyQualifierInfo,g.asn1.ASN1Object);g.asn1.x509.UserNotice=function(n){g.asn1.x509.UserNotice.superclass.constructor.call(this,n);var e=g.asn1.DERSequence,t=g.asn1.DERInteger,r=g.asn1.x509.DisplayText,i=g.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var o=[];this.params.noticeref!==void 0&&o.push(new i(this.params.noticeref)),this.params.exptext!==void 0&&o.push(new r(this.params.exptext));var a=new e({array:o});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};U(g.asn1.x509.UserNotice,g.asn1.ASN1Object);g.asn1.x509.NoticeReference=function(n){g.asn1.x509.NoticeReference.superclass.constructor.call(this,n);var e=g.asn1.DERSequence,t=g.asn1.DERInteger,r=g.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var i=[];if(this.params.org!==void 0&&i.push(new r(this.params.org)),this.params.noticenum!==void 0){for(var o=[],a=this.params.noticenum,s=0;s<a.length;s++)o.push(new t(a[s]));i.push(new e({array:o}))}if(i.length==0)throw new Error("parameter is empty");var c=new e({array:i});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(this.params=n)};U(g.asn1.x509.NoticeReference,g.asn1.ASN1Object);g.asn1.x509.DisplayText=function(n){g.asn1.x509.DisplayText.superclass.constructor.call(this,n),this.hT="0c",n!==void 0&&(n.type==="ia5"?this.hT="16":n.type==="vis"?this.hT="1a":n.type==="bmp"&&(this.hT="1e"))};U(g.asn1.x509.DisplayText,g.asn1.DERAbstractString);g.asn1.x509.PolicyMappings=function(n){g.asn1.x509.PolicyMappings.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var o=this.params,a=[],s=0;s<o.array.length;s++){var c=o.array[s];a.push({seq:[{oid:c[0]},{oid:c[1]}]})}return this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",n!==void 0&&(this.params=n)};U(g.asn1.x509.PolicyMappings,g.asn1.x509.Extension);g.asn1.x509.PolicyConstraints=function(n){g.asn1.x509.PolicyConstraints.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var o=this.params,a=[];return o.reqexp!=null&&a.push({tag:{tagi:"80",obj:{int:o.reqexp}}}),o.inhibit!=null&&a.push({tag:{tagi:"81",obj:{int:o.inhibit}}}),this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",n!==void 0&&(this.params=n)};U(g.asn1.x509.PolicyConstraints,g.asn1.x509.Extension);g.asn1.x509.InhibitAnyPolicy=function(n){g.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=i({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",n!==void 0&&(this.params=n)};U(g.asn1.x509.InhibitAnyPolicy,g.asn1.x509.Extension);g.asn1.x509.NameConstraints=function(n){g.asn1.x509.NameConstraints.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.x509,i=t.ASN1Util.newObject,o=r.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var a=this.params,s=[];if(a.permit!=null&&a.permit.length!=null){for(var c=[],l=0;l<a.permit.length;l++)c.push(new o(a.permit[l]));s.push({tag:{tagi:"a0",obj:{seq:c}}})}if(a.exclude!=null&&a.exclude.length!=null){for(var h=[],l=0;l<a.exclude.length;l++)h.push(new o(a.exclude[l]));s.push({tag:{tagi:"a1",obj:{seq:h}}})}return this.asn1ExtnValue=i({seq:s}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",n!==void 0&&(this.params=n)};U(g.asn1.x509.NameConstraints,g.asn1.x509.Extension);g.asn1.x509.GeneralSubtree=function(n){g.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var e=g.asn1,t=e.x509,r=t.GeneralName,i=e.ASN1Util.newObject;this.params=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params,a=[new r(o)];o.min!=null&&a.push({tag:{tagi:"80",obj:{int:o.min}}}),o.max!=null&&a.push({tag:{tagi:"81",obj:{int:o.max}}});var s=i({seq:a});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.GeneralSubtree,g.asn1.ASN1Object);g.asn1.x509.ExtKeyUsage=function(n){g.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,n);var e=g,t=e.asn1;this.setPurposeArray=function(r){this.asn1ExtnValue=new t.DERSequence;for(var i=0;i<r.length;i++){var o=new t.DERObjectIdentifier(r[i]);this.asn1ExtnValue.appendASN1Object(o)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",n!==void 0&&n.array!==void 0&&this.setPurposeArray(n.array)};U(g.asn1.x509.ExtKeyUsage,g.asn1.x509.Extension);g.asn1.x509.AuthorityKeyIdentifier=function(n){g.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.DERTaggedObject,i=t.x509.GeneralNames,o=e.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var a=new Array;this.asn1KID&&a.push(new r({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&a.push(new r({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&a.push(new r({explicit:!1,tag:"82",obj:this.asn1CertSN}));var s=new t.DERSequence({array:a});return this.asn1ExtnValue=s,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(a.str!==void 0||a.hex!==void 0)this.asn1KID=new g.asn1.DEROctetString(a);else if(typeof a=="object"&&g.crypto.Util.isKey(a)||typeof a=="string"&&a.indexOf("BEGIN ")!=-1){var s=a;typeof a=="string"&&(s=Se.getKey(a));var c=Se.getKeyID(s);this.asn1KID=new g.asn1.DEROctetString({hex:c})}},this.setCertIssuerByParam=function(a){a.str!==void 0||a.ldapstr!==void 0||a.hex!==void 0||a.certsubject!==void 0||a.certissuer!==void 0?this.asn1CertIssuer=new g.asn1.x509.X500Name(a):typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new g.asn1.x509.X500Name({certissuer:a}))},this.setCertSNByParam=function(a){if(a.str!==void 0||a.bigint!==void 0||a.hex!==void 0)this.asn1CertSN=new g.asn1.DERInteger(a);else if(typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")){var s=new he;s.readCertPEM(a);var c=s.getSerialNumberHex();this.asn1CertSN=new g.asn1.DERInteger({hex:c})}},this.oid="2.5.29.35",n!==void 0&&(n.kid!==void 0&&this.setKIDByParam(n.kid),n.issuer!==void 0&&this.setCertIssuerByParam(n.issuer),n.sn!==void 0&&this.setCertSNByParam(n.sn),n.issuersn!==void 0&&typeof n.issuersn=="string"&&n.issuersn.indexOf("BEGIN ")!=-1&&n.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(n.issuersn),this.setCertIssuerByParam(n.issuersn)))};U(g.asn1.x509.AuthorityKeyIdentifier,g.asn1.x509.Extension);g.asn1.x509.SubjectKeyIdentifier=function(n){g.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new r(i);else if(typeof i=="object"&&g.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN")!=-1){var o=i;typeof i=="string"&&(o=Se.getKey(i));var a=Se.getKeyID(o);this.asn1KID=new g.asn1.DEROctetString({hex:a})}},this.oid="2.5.29.14",n!==void 0&&n.kid!==void 0&&this.setKIDByParam(n.kid)};U(g.asn1.x509.SubjectKeyIdentifier,g.asn1.x509.Extension);g.asn1.x509.AuthorityInfoAccess=function(n){g.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,n),this.setAccessDescriptionArray=function(e){for(var t=new Array,r=g,i=r.asn1,o=i.DERSequence,a=i.DERObjectIdentifier,s=i.x509.GeneralName,c=0;c<e.length;c++){var l,h=e[c];if(h.ocsp!==void 0)l=new o({array:[new a({oid:"1.3.6.1.5.5.7.48.1"}),new s({uri:h.ocsp})]});else if(h.caissuer!==void 0)l=new o({array:[new a({oid:"1.3.6.1.5.5.7.48.2"}),new s({uri:h.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(h));t.push(l)}this.asn1ExtnValue=new o({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",n!==void 0&&n.array!==void 0&&this.setAccessDescriptionArray(n.array)};U(g.asn1.x509.AuthorityInfoAccess,g.asn1.x509.Extension);g.asn1.x509.SubjectAltName=function(n){g.asn1.x509.SubjectAltName.superclass.constructor.call(this,n),this.setNameArray=function(e){this.asn1ExtnValue=new g.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",n!==void 0&&n.array!==void 0&&this.setNameArray(n.array)};U(g.asn1.x509.SubjectAltName,g.asn1.x509.Extension);g.asn1.x509.IssuerAltName=function(n){g.asn1.x509.IssuerAltName.superclass.constructor.call(this,n),this.setNameArray=function(e){this.asn1ExtnValue=new g.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",n!==void 0&&n.array!==void 0&&this.setNameArray(n.array)};U(g.asn1.x509.IssuerAltName,g.asn1.x509.Extension);g.asn1.x509.SubjectDirectoryAttributes=function(n){g.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,n);var e=g.asn1,t=e.DERSequence,r=e.ASN1Util.newObject,i=e.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var o=[],a=0;a<this.params.array.length;a++){var s=this.params.array[a];if(s.attr!=null&&s.array!=null){var c={seq:[{oid:s.attr},{set:s.array}]};o.push(r(c));continue}var l={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(s.attr=="dateOfBirth")l.seq[0].oid=i(s.attr),l.seq[1].set[0]={gentime:s.str};else if(s.attr=="placeOfBirth")l.seq[0].oid=i(s.attr),l.seq[1].set[0]={utf8str:s.str};else if(s.attr=="gender")l.seq[0].oid=i(s.attr),l.seq[1].set[0]={prnstr:s.str};else if(s.attr=="countryOfCitizenship")l.seq[0].oid=i(s.attr),l.seq[1].set[0]={prnstr:s.str};else if(s.attr=="countryOfResidence")l.seq[0].oid=i(s.attr),l.seq[1].set[0]={prnstr:s.str};else throw new Error("unsupported attribute: "+s.attr);o.push(new r(l))}var h=new t({array:o});return this.asn1ExtnValue=h,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",n!==void 0&&(this.params=n)};U(g.asn1.x509.SubjectDirectoryAttributes,g.asn1.x509.Extension);g.asn1.x509.PrivateExtension=function(n){g.asn1.x509.PrivateExtension.superclass.constructor.call(this,n);var e=g,t=e.lang.String.isHex,r=e.asn1,i=r.x509.OID.name2oid,o=r.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.oid=i(a.extname),this.params=a},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var a=this.params.extn;if(typeof a=="string"&&t(a))return a;if(typeof a=="object")try{return o(a).tohex()}catch{}throw new Error("unsupported extn value")},n!=null&&this.setByParam(n)};U(g.asn1.x509.PrivateExtension,g.asn1.x509.Extension);g.asn1.x509.CRL=function(n){g.asn1.x509.CRL.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.DERSequence,i=t.DERBitString,o=t.x509,a=o.AlgorithmIdentifier,s=o.TBSCertList;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=new s(this.params).tohex(),l=new g.crypto.Signature({alg:this.params.sigalg});l.init(this.params.cakey),l.updateHex(c);var h=l.sign();this.params.sighex=h},this.getPEM=function(){return un(this.tohex(),"X509 CRL")},this.tohex=function(){var c=this.params;if(c.tbsobj==null&&(c.tbsobj=new s(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(c.tbsobj),l.push(new a({name:c.sigalg})),l.push(new i({hex:"00"+c.sighex}));var h=new r({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&(this.params=n)};U(g.asn1.x509.CRL,g.asn1.ASN1Object);g.asn1.x509.TBSCertList=function(n){g.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.DERTaggedObject,a=t.DERObjectIdentifier,s=t.x509,c=s.AlgorithmIdentifier,l=s.Time,h=s.Extensions,u=s.X500Name;this.params=null,this.setByParam=function(d){this.params=d},this.getRevCertSequence=function(){for(var d=[],p=this.params.revcert,m=0;m<p.length;m++){var f=[new r(p[m].sn),new l(p[m].date)];p[m].ext!=null&&f.push(new h(p[m].ext)),d.push(new i({array:f}))}return new i({array:d})},this.tohex=function(){var d=[],p=this.params;if(p.version!=null){var m=p.version-1,f=new r({int:m});d.push(f)}if(d.push(new c({name:p.sigalg})),d.push(new u(p.issuer)),d.push(new l(p.thisupdate)),p.nextupdate!=null&&d.push(new l(p.nextupdate)),p.revcert!=null&&d.push(this.getRevCertSequence()),p.ext!=null){var x=new h(p.ext);d.push(new o({tag:"a0",explicit:!0,obj:x}))}var b=new i({array:d});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.TBSCertList,g.asn1.ASN1Object);g.asn1.x509.CRLEntry=function(n){g.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=null,t=null,r=g,i=r.asn1;this.setCertSerial=function(o){this.sn=new i.DERInteger(o)},this.setRevocationDate=function(o){this.time=new i.x509.Time(o)},this.tohex=function(){var o=new i.DERSequence({array:[this.sn,this.time]});return this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.time!==void 0&&this.setRevocationDate(n.time),n.sn!==void 0&&this.setCertSerial(n.sn))};U(g.asn1.x509.CRLEntry,g.asn1.ASN1Object);g.asn1.x509.CRLNumber=function(n){g.asn1.x509.CRLNumber.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",n!=null&&(this.params=n)};U(g.asn1.x509.CRLNumber,g.asn1.x509.Extension);g.asn1.x509.CRLReason=function(n){g.asn1.x509.CRLReason.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",n!=null&&(this.params=n)};U(g.asn1.x509.CRLReason,g.asn1.x509.Extension);g.asn1.x509.OCSPNonce=function(n){g.asn1.x509.OCSPNonce.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",n!=null&&(this.params=n)};U(g.asn1.x509.OCSPNonce,g.asn1.x509.Extension);g.asn1.x509.OCSPNoCheck=function(n){g.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,n),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",n!=null&&(this.params=n)};U(g.asn1.x509.OCSPNoCheck,g.asn1.x509.Extension);g.asn1.x509.AdobeTimeStamp=function(n){g.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,n);var e=g,t=e.asn1,r=t.DERInteger,i=t.DERBoolean,o=t.DERSequence,a=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var s=this.params,c=[new r(1)];return c.push(new a({uri:s.uri})),s.reqauth!=null&&c.push(new i(s.reqauth)),this.asn1ExtnValue=new o({array:c}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",n!==void 0&&this.setByParam(n)};U(g.asn1.x509.AdobeTimeStamp,g.asn1.x509.Extension);g.asn1.x509.X500Name=function(n){g.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var e=g,t=e.asn1,r=t.x509,i=r.RDN,o=xt;this.setByString=function(a,s){s!==void 0&&(this.sRule=s);var c=a.split("/");c.shift();for(var l=[],h=0;h<c.length;h++)if(c[h].match(/^[^=]+=.+$/))l.push(c[h]);else{var u=l.length-1;l[u]=l[u]+"/"+c[h]}for(var h=0;h<l.length;h++)this.asn1Array.push(new i({str:l[h],rule:this.sRule}))},this.setByLdapString=function(a,s){s!==void 0&&(this.sRule=s);var c=r.X500Name.ldapToCompat(a);this.setByString(c,s)},this.setByObject=function(a,s){s!==void 0&&(this.sRule=s);for(var c in a)if(a.hasOwnProperty(c)){var l=new i({str:c+"="+a[c],rule:this.sRule});this.asn1Array?this.asn1Array.push(l):this.asn1Array=[l]}},this.setByParam=function(a){if(a.rule!==void 0&&(this.sRule=a.rule),a.array!==void 0)this.paramArray=a.array;else if(a.str!==void 0)this.setByString(a.str);else if(a.ldapstr!==void 0)this.setByLdapString(a.ldapstr);else if(a.hex!==void 0)this.hTLV=a.hex;else if(a.certissuer!==void 0){var s=new he;s.readCertPEM(a.certissuer),this.hTLV=s.getIssuerHex()}else if(a.certsubject!==void 0){var s=new he;s.readCertPEM(a.certsubject),this.hTLV=s.getSubjectHex()}else typeof a=="object"&&a.certsubject===void 0&&a.certissuer===void 0&&this.setByObject(a)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var s={array:this.paramArray[a]};this.sRule!="utf8"&&(s.rule=this.sRule);var c=new i(s);this.asn1Array.push(c)}var l=new t.DERSequence({array:this.asn1Array});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.X500Name,g.asn1.ASN1Object);g.asn1.x509.X500Name.compatToLDAP=function(n){if(n.substr(0,1)!=="/")throw"malformed input";var e="";n=n.substr(1);var t=n.split("/");return t.reverse(),t=t.map(function(r){return r.replace(/,/,"\\,")}),t.join(",")};g.asn1.x509.X500Name.onelineToLDAP=function(n){return g.asn1.x509.X500Name.compatToLDAP(n)};g.asn1.x509.X500Name.ldapToCompat=function(n){for(var e=n.split(","),t=!1,r=[],i=0;e.length>0;i++){var o=e.shift();if(t===!0){var a=r.pop(),s=(a+","+o).replace(/\\,/g,",");r.push(s),t=!1}else r.push(o);o.substr(-1,1)==="\\"&&(t=!0)}return r=r.map(function(c){return c.replace("/","\\/")}),r.reverse(),"/"+r.join("/")};g.asn1.x509.X500Name.ldapToOneline=function(n){return g.asn1.x509.X500Name.ldapToCompat(n)};g.asn1.x509.RDN=function(n){g.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var e=g.asn1.x509.AttributeTypeAndValue;this.setByParam=function(t){t.rule!==void 0&&(this.sRule=t.rule),t.str!==void 0&&this.addByMultiValuedString(t.str),t.array!==void 0&&(this.paramArray=t.array)},this.addByString=function(t){this.asn1Array.push(new g.asn1.x509.AttributeTypeAndValue({str:t,rule:this.sRule}))},this.addByMultiValuedString=function(t){for(var r=g.asn1.x509.RDN.parseString(t),i=0;i<r.length;i++)this.addByString(r[i])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var t=0;t<this.paramArray.length;t++){var r=this.paramArray[t];r.rule!==void 0&&this.sRule!="utf8"&&(r.rule=this.sRule);var i=new e(r);this.asn1Array.push(i)}var o=new g.asn1.DERSet({array:this.asn1Array});return this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.RDN,g.asn1.ASN1Object);g.asn1.x509.RDN.parseString=function(n){for(var e=n.split(/\+/),t=!1,r=[],i=0;e.length>0;i++){var o=e.shift();if(t===!0){var a=r.pop(),s=(a+"+"+o).replace(/\\\+/g,"+");r.push(s),t=!1}else r.push(o);o.substr(-1,1)==="\\"&&(t=!0)}for(var c=!1,l=[],i=0;r.length>0;i++){var o=r.shift();if(c===!0){var h=l.pop();if(o.match(/"$/)){var s=(h+"+"+o).replace(/^([^=]+)="(.*)"$/,"$1=$2");l.push(s),c=!1}else l.push(h+"+"+o)}else l.push(o);o.match(/^[^=]+="/)&&(c=!0)}return l};g.asn1.x509.AttributeTypeAndValue=function(n){g.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var e=g,t=e.asn1,r=t.DERSequence,i=t.DERUTF8String,o=t.DERPrintableString,a=t.DERTeletexString,s=t.DERIA5String,c=t.DERVisibleString,l=t.DERBMPString,h=e.lang.String.isMail,u=e.lang.String.isPrintable;this.setByParam=function(d){if(d.rule!==void 0&&(this.sRule=d.rule),d.ds!==void 0&&(this.dsType=d.ds),d.value===void 0&&d.str!==void 0){var p=d.str,m=p.match(/^([^=]+)=(.+)$/);if(m)this.sType=m[1],this.sValue=m[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=d.type,this.sValue=d.value},this.setByString=function(d,p){p!==void 0&&(this.sRule=p);var m=d.match(/^([^=]+)=(.+)$/);if(m)this.setByAttrTypeAndValueStr(m[1],m[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var d=this.sType,p=this.sValue,m=this.sRule;return m==="prn"?d=="CN"&&h(p)?"ia5":u(p)?"prn":"utf8":m==="utf8"?d=="CN"&&h(p)?"ia5":d=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(d,p,m){m!==void 0&&(this.sRule=m),this.sType=d,this.sValue=p},this.getValueObj=function(d,p){if(d=="utf8")return new i({str:p});if(d=="prn")return new o({str:p});if(d=="tel")return new a({str:p});if(d=="ia5")return new s({str:p});if(d=="vis")return new c({str:p});if(d=="bmp")return new l({str:p});throw new Error("unsupported directory string type: type="+d+" value="+p)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var d=g.asn1.x509.OID.atype2obj(this.sType),p=this.getValueObj(this.dsType,this.sValue),m=new r({array:[d,p]});return this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.AttributeTypeAndValue,g.asn1.ASN1Object);g.asn1.x509.SubjectPublicKeyInfo=function(n){g.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=null,t=null,r=g,i=r.asn1,o=i.DERInteger,a=i.DERBitString,s=i.DERObjectIdentifier,c=i.DERSequence,l=i.ASN1Util.newObject,h=i.x509,u=h.AlgorithmIdentifier,d=r.crypto,p=d.ECDSA,m=d.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var f=new c({array:[this.asn1AlgId,this.asn1SubjPKey]});return f},this.tohex=function(){var f=this.getASN1Object();return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(f){try{if(f instanceof ve){var x=l({seq:[{int:{bigint:f.n}},{int:{int:f.e}}]}),b=x.tohex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new a({hex:"00"+b})}}catch{}try{if(f instanceof g.crypto.ECDSA){var _=new s({name:f.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:_}),this.asn1SubjPKey=new a({hex:"00"+f.pubKeyHex})}}catch{}try{if(f instanceof g.crypto.DSA){var _=new l({seq:[{int:{bigint:f.p}},{int:{bigint:f.q}},{int:{bigint:f.g}}]});this.asn1AlgId=new u({name:"dsa",asn1params:_});var O=new o({bigint:f.y});this.asn1SubjPKey=new a({hex:"00"+O.tohex()})}}catch{}},n!==void 0&&this.setPubKey(n)};U(g.asn1.x509.SubjectPublicKeyInfo,g.asn1.ASN1Object);g.asn1.x509.Time=function(n){g.asn1.x509.Time.superclass.constructor.call(this);var e=null,t=null,r=g,i=r.asn1,o=i.DERUTCTime,a=i.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(s){this.timeParams=s},this.setByParam=function(s){this.params=s},this.getType=function(s){return s.match(/^[0-9]{12}Z$/)?"utc":s.match(/^[0-9]{14}Z$/)?"gen":s.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":s.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var s=this.params,c=null;if(typeof s=="string"&&(s={str:s}),s!=null&&s.str&&(s.type==null||s.type==null)&&(s.type=this.getType(s.str)),s!=null&&s.str?(s.type=="utc"&&(c=new o(s.str)),s.type=="gen"&&(c=new a(s.str))):this.type=="gen"?c=new a:c=new o,c==null)throw new Error("wrong setting for Time");return this.TLV=c.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};g.asn1.x509.Time_bak=function(n){g.asn1.x509.Time_bak.superclass.constructor.call(this);var e=null,t=null,r=g,i=r.asn1,o=i.DERUTCTime,a=i.DERGeneralizedTime;this.setTimeParams=function(s){this.timeParams=s},this.tohex=function(){var s=null;return this.timeParams!=null?this.type=="utc"?s=new o(this.timeParams):s=new a(this.timeParams):this.type=="utc"?s=new o:s=new a,this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",n!==void 0&&(n.type!==void 0?this.type=n.type:n.str!==void 0&&(n.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),n.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=n)};U(g.asn1.x509.Time,g.asn1.ASN1Object);g.asn1.x509.AlgorithmIdentifier=function(n){g.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=g,t=e.asn1,r=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var o=null;for(var a in r)a===this.nameAlg&&(o=r[a]);if(o!==null)return this.hTLV=o,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var s=[this.asn1Alg];this.asn1Params!==null&&s.push(this.asn1Params);var c=new t.DERSequence({array:s});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&(n.name!==void 0&&(this.nameAlg=n.name),n.asn1params!==void 0&&(this.asn1Params=n.asn1params),n.paramempty!==void 0&&(this.paramEmpty=n.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();i.substr(-7,7)!=="withdsa"&&i.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new t.DERNull)}};U(g.asn1.x509.AlgorithmIdentifier,g.asn1.ASN1Object);g.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};g.asn1.x509.GeneralName=function(n){g.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},t=g,r=t.asn1,i=r.x509,o=i.X500Name,a=i.OtherName,s=r.DERIA5String,c=r.DERPrintableString,l=r.DEROctetString,h=r.DERTaggedObject,u=r.ASN1Object,d=Error;this.params=null,this.setByParam=function(p){this.params=p},this.tohex=function(){var p=this.params,m,x,f,x=!1;if(p.other!==void 0)m="a0",f=new a(p.other);else if(p.rfc822!==void 0)m="81",f=new s({str:p.rfc822});else if(p.dns!==void 0)m="82",f=new s({str:p.dns});else if(p.dn!==void 0)m="a4",x=!0,typeof p.dn=="string"?f=new o({str:p.dn}):p.dn instanceof g.asn1.x509.X500Name?f=p.dn:f=new o(p.dn);else if(p.ldapdn!==void 0)m="a4",x=!0,f=new o({ldapstr:p.ldapdn});else if(p.certissuer!==void 0||p.certsubj!==void 0){m="a4",x=!0;var b,_,O=null;if(p.certsubj!==void 0?(b=!1,_=p.certsubj):(b=!0,_=p.certissuer),_.match(/^[0-9A-Fa-f]+$/)&&O==_,_.indexOf("-----BEGIN ")!=-1&&(O=xt(_)),O==null)throw new Error("certsubj/certissuer not cert");var S=new he;S.hex=O;var E;b?E=S.getIssuerHex():E=S.getSubjectHex(),f=new u,f.hTLV=E}else if(p.uri!==void 0)m="86",f=new s({str:p.uri});else if(p.ip!==void 0){m="87";var F,I=p.ip;try{if(I.match(/^[0-9a-f]+$/)){var y=I.length;if(y==8||y==16||y==32||y==64)F=I;else throw"err"}else F=H0(I)}catch(C){throw new d("malformed IP address: "+p.ip+":"+C.message)}f=new l({hex:F})}else throw new d("improper params");var P=new h({tag:m,explicit:x,obj:f});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.GeneralName,g.asn1.ASN1Object);g.asn1.x509.GeneralNames=function(n){g.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=null,t=g,r=t.asn1;this.setByParamArray=function(i){for(var o=0;o<i.length;o++){var a=new r.x509.GeneralName(i[o]);this.asn1Array.push(a)}},this.tohex=function(){var i=new r.DERSequence({array:this.asn1Array});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof n<"u"&&this.setByParamArray(n)};U(g.asn1.x509.GeneralNames,g.asn1.ASN1Object);g.asn1.x509.OtherName=function(n){g.asn1.x509.OtherName.superclass.constructor.call(this);var e=null,t=null,r=g,i=r.asn1,o=i.DERObjectIdentifier,a=i.DERSequence,s=i.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if(c.oid==null||c.value==null)throw new Error("oid or value not specified");var l=new o({oid:c.oid}),h=s({tag:{tag:"a0",explicit:!0,obj:c.value}}),u=new a({array:[l,h]});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.x509.OtherName,g.asn1.ASN1Object);g.asn1.x509.OID=new function(){var n=g.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(e){if(typeof this.objCache[e]<"u")return this.objCache[e];if(typeof this.name2oidList[e]>"u")throw"Name of ObjectIdentifier not defined: "+e;var t=this.name2oidList[e],r=new n({oid:t});return this.objCache[e]=r,r},this.atype2obj=function(e){if(this.objCache[e]!==void 0)return this.objCache[e];var t;if(e.match(/^\d+\.\d+\.[0-9.]+$/))t=e;else if(this.atype2oidList[e]!==void 0)t=this.atype2oidList[e];else if(this.name2oidList[e]!==void 0)t=this.name2oidList[e];else throw new Error("AttributeType name undefined: "+e);var r=new n({oid:t});return this.objCache[e]=r,r},this.registerOIDs=function(e){if(this.checkOIDs(e))for(var t in e)this.name2oidList[t]=e[t]},this.checkOIDs=function(e){try{var t=Object.keys(e);return t.length==0?!1:(t.map(function(r,i,o){var a=this[r];if(!a.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},e),!0)}catch{return!1}}};g.asn1.x509.OID.oid2name=function(n){var e=g.asn1.x509.OID.name2oidList;for(var t in e)if(e[t]==n)return t;return""};g.asn1.x509.OID.oid2atype=function(n){var e=g.asn1.x509.OID.atype2oidList;for(var t in e)if(e[t]==n)return t;return n};g.asn1.x509.OID.name2oid=function(n){if(n.match(/^[0-9.]+$/))return n;var e=g.asn1.x509.OID.name2oidList;return e[n]===void 0?"":e[n]};g.asn1.x509.X509Util={};g.asn1.x509.X509Util.newCertPEM=function(n){var e=g.asn1.x509,t=e.TBSCertificate,r=e.Certificate,i=new r(n);return i.getPEM()};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.cms>"u"||!g.asn1.cms)&&(g.asn1.cms={});g.asn1.cms.Attribute=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.DERSet,a=r.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(s){this.params=s},this.getValueArray=function(){throw new e("not yet implemented abstract")},this.tohex=function(){var s=new a({oid:this.typeOid}),c=new o({array:this.getValueArray()}),l=new i({array:[s,c]});return l.tohex()},this.getEncodedHex=function(){return this.tohex()}};U(g.asn1.cms.Attribute,g.asn1.ASN1Object);g.asn1.cms.ContentType=function(n){var e=g,t=e.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var r=new t.DERObjectIdentifier(this.params.type);return[r]},n!=null&&this.setByParam(n)};U(g.asn1.cms.ContentType,g.asn1.cms.Attribute);g.asn1.cms.MessageDigest=function(n){var e=g,t=e.asn1,r=t.DEROctetString,i=t.cms;i.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var o=new r(this.params);return[o]},n!=null&&this.setByParam(n)};U(g.asn1.cms.MessageDigest,g.asn1.cms.Attribute);g.asn1.cms.SigningTime=function(n){var e=g,t=e.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var r=new t.x509.Time(this.params);return[r]},n!=null&&this.setByParam(n)};U(g.asn1.cms.SigningTime,g.asn1.cms.Attribute);g.asn1.cms.SigningCertificate=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.cms,a=o.ESSCertID,s=t.crypto;o.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new e("parameter 'array' not specified");for(var c=this.params.array,l=[],h=0;h<c.length;h++){var u=c[h];n.hasis==!1&&typeof u=="string"&&(u.indexOf("-----BEGIN")!=-1||$.isASN1HEX(u))&&(u={cert:u}),u.hasis!=!1&&n.hasis==!1&&(u.hasis=!1),l.push(new a(u))}var d=new i({array:l}),p=new i({array:[d]});return[p]},n!=null&&this.setByParam(n)};U(g.asn1.cms.SigningCertificate,g.asn1.cms.Attribute);g.asn1.cms.ESSCertID=function(n){g.asn1.cms.ESSCertID.superclass.constructor.call(this);var e=Error,t=g,r=t.asn1,i=r.DEROctetString,o=r.DERSequence,a=r.cms.IssuerSerial;this.params=null,this.getCertHash=function(s,c){if(s.hash!=null)return s.hash;if(typeof s=="string"&&s.indexOf("-----BEGIN")==-1&&!$.isASN1HEX(s))return s;var l;if(typeof s=="string")l=s;else if(s.cert!=null)l=s.cert;else throw new e("hash nor cert unspecified");var h;l.indexOf("-----BEGIN")!=-1?h=xt(l):h=l,typeof s=="string"&&(s.indexOf("-----BEGIN")!=-1?h=xt(s):$.isASN1HEX(s)&&(h=s));var u;if(s.alg!=null)u=s.alg;else if(c!=null)u=c;else throw new e("hash alg unspecified");return t.crypto.Util.hashHex(h,u)},this.tohex=function(){var s=this.params,c=this.getCertHash(s,"sha1"),l=[];l.push(new i({hex:c})),(typeof s=="string"&&s.indexOf("-----BEGIN")!=-1||s.cert!=null&&s.hasis!=!1||s.issuer!=null&&s.serial!=null)&&l.push(new a(s));var h=new o({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.ESSCertID,g.asn1.ASN1Object);g.asn1.cms.SigningCertificateV2=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.x509,a=r.cms,s=a.ESSCertIDv2,c=t.crypto;a.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new e("parameter 'array' not specified");for(var l=this.params.array,h=[],u=0;u<l.length;u++){var d=l[u];(n.alg!=null||n.hasis==!1)&&typeof d=="string"&&(d.indexOf("-----BEGIN")!=-1||$.isASN1HEX(d))&&(d={cert:d}),d.alg==null&&n.alg!=null&&(d.alg=n.alg),d.hasis!=!1&&n.hasis==!1&&(d.hasis=!1),h.push(new s(d))}var p=new i({array:h}),m=new i({array:[p]});return[m]},n!=null&&this.setByParam(n)};U(g.asn1.cms.SigningCertificateV2,g.asn1.cms.Attribute);g.asn1.cms.ESSCertIDv2=function(n){g.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var e=Error,t=g,r=t.asn1,i=r.DEROctetString,o=r.DERSequence,a=r.cms.IssuerSerial,s=r.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var c=this.params,l=this.getCertHash(c,"sha256"),h=[];c.alg!=null&&c.alg!="sha256"&&h.push(new s({name:c.alg})),h.push(new i({hex:l})),(typeof c=="string"&&c.indexOf("-----BEGIN")!=-1||c.cert!=null&&c.hasis!=!1||c.issuer!=null&&c.serial!=null)&&h.push(new a(c));var u=new o({array:h});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.ESSCertIDv2,g.asn1.cms.ESSCertID);g.asn1.cms.IssuerSerial=function(n){var e=Error,t=g,r=t.asn1,i=r.DERInteger,o=r.DERSequence,a=r.cms,s=r.x509,c=s.GeneralNames,l=he;a.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(h){this.params=h},this.tohex=function(){var h=this.params,u,d;if(typeof h=="string"&&h.indexOf("-----BEGIN")!=-1||h.cert!=null){var p;h.cert!=null?p=h.cert:p=h;var m=new l;m.readCertPEM(p),u=m.getIssuer(),d={hex:m.getSerialNumberHex()}}else if(h.issuer!=null&&h.serial)u=h.issuer,d=h.serial;else throw new e("cert or issuer and serial parameter not specified");var f=new c([{dn:u}]),x=new i(d),b=new o({array:[f,x]});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.IssuerSerial,g.asn1.ASN1Object);g.asn1.cms.SignerIdentifier=function(n){var e=g,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.cms,a=o.IssuerAndSerialNumber,s=o.SubjectKeyIdentifier,c=t.x509,l=c.X500Name,h=he,u=Error;o.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params;if(d.type=="isssn"){var p=new a(d);return p.tohex()}else if(d.type=="skid"){var m=new s(d);return m.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.SignerIdentifier,g.asn1.ASN1Object);g.asn1.cms.IssuerAndSerialNumber=function(n){var e=g,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.cms,a=t.x509,s=a.X500Name,c=he,l=Error;o.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u,d;if(typeof h=="string"&&h.indexOf("-----BEGIN")!=-1||h.cert!=null){var p;h.cert!=null?p=h.cert:p=h;var m=new c;m.readCertPEM(p),u=m.getIssuer(),d={hex:m.getSerialNumberHex()}}else if(h.issuer!=null&&h.serial)u=h.issuer,d=h.serial;else throw new l("cert or issuer and serial parameter not specified");var f=new s(u),x=new r(d),b=new i({array:[f,x]});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},n!=null&&this.setByParam(n)};U(g.asn1.cms.IssuerAndSerialNumber,g.asn1.ASN1Object);g.asn1.cms.SubjectKeyIdentifier=function(n){var e=g,t=e.asn1,r=t.DERInteger,i=t.DERSequence,o=t.ASN1Util.newObject,a=t.cms,s=a.IssuerAndSerialName,c=a.SubjectKeyIdentifier,l=t.x509,h=l.X500Name,u=he,d=Error;a.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var p=this.params;if(p.cert==null&&p.skid==null)throw new d("property cert nor skid undefined");var m;if(p.cert!=null){var f=new u(p.cert),x=f.getExtSubjectKeyIdentifier();m=x.kid.hex}else p.skid!=null&&(m=p.skid);var b=o({tag:{tage:"a0",obj:{octstr:{hex:m}}}});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.SubjectKeyIdentifier,g.asn1.ASN1Object);g.asn1.cms.AttributeList=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSet,o=r.cms;o.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(this.hTLV!=null)return this.hTLV;var s=!0;a.sortflag!=null&&(s=a.sortflag);for(var c=a.array,l=[],h=0;h<c.length;h++){var u=c[h],d=u.attr;if(d=="contentType")l.push(new o.ContentType(u));else if(d=="messageDigest")l.push(new o.MessageDigest(u));else if(d=="signingTime")l.push(new o.SigningTime(u));else if(d=="signingCertificate")l.push(new o.SigningCertificate(u));else if(d=="signingCertificateV2")l.push(new o.SigningCertificateV2(u));else if(d=="signaturePolicyIdentifier")l.push(new g.asn1.cades.SignaturePolicyIdentifier(u));else if(d=="signatureTimeStamp"||d=="timeStampToken")l.push(new g.asn1.cades.SignatureTimeStamp(u));else throw new e("unknown attr: "+d)}var p=new i({array:l,sortflag:s});return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.AttributeList,g.asn1.ASN1Object);g.asn1.cms.SignerInfo=function(n){var e=Error,t=g,r=t.asn1,i=r.DERInteger,o=r.DEROctetString,a=r.DERSequence,s=r.DERTaggedObject,c=r.cms,l=c.SignerIdentifier,h=c.AttributeList,u=c.ContentType,d=c.EncapsulatedContentInfo,p=c.MessageDigest,m=c.SignedData,f=r.x509,x=f.AlgorithmIdentifier,b=t.crypto,_=Se;c.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var O=this.params,S=O.sigalg,E=new h(O.sattrs).tohex(),F=_.getKey(O.signkey),I=new b.Signature({alg:S});I.init(F),I.updateHex(E);var y=I.sign();O.sighex=y},this.tohex=function(){var O=this.params,S=[];if(S.push(new i({int:O.version})),S.push(new l(O.id)),S.push(new x({name:O.hashalg})),O.sattrs!=null){var E=new h(O.sattrs);try{S.push(new s({tag:"a0",explicit:!1,obj:E}))}catch(I){throw new e("si sattr error: "+I)}}if(O.sigalgfield!=null?S.push(new x({name:O.sigalgfield})):S.push(new x({name:O.sigalg})),O.sighex==null&&O.signkey!=null&&this.sign(),S.push(new o({hex:O.sighex})),O.uattrs!=null){var E=new h(O.uattrs);try{S.push(new s({tag:"a1",explicit:!1,obj:E}))}catch(y){throw new e("si uattr error: "+y)}}var F=new a({array:S});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.SignerInfo,g.asn1.ASN1Object);g.asn1.cms.EncapsulatedContentInfo=function(n){var e=g,t=e.asn1,r=t.DERTaggedObject,i=t.DERSequence,o=t.DERObjectIdentifier,a=t.DEROctetString,s=t.cms;s.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,l=[];if(l.push(new o(c.type)),c.content!=null&&(c.content.hex!=null||c.content.str!=null)&&c.isDetached!=!0){var h=new a(c.content),u=new r({tag:"a0",explicit:!0,obj:h});l.push(u)}var d=new i({array:l});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},n!=null&&this.setByParam(n)};U(g.asn1.cms.EncapsulatedContentInfo,g.asn1.ASN1Object);g.asn1.cms.ContentInfo=function(n){var e=g,t=e.asn1,r=t.DERTaggedObject,i=t.DERSequence,o=t.DERObjectIdentifier,a=t.x509,s=a.OID.name2obj;g.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,l=[];l.push(new o(c.type));var h=new r({tag:"a0",explicit:!0,obj:c.obj});l.push(h);var u=new i({array:l});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},n!=null&&this.setByParam(n)};U(g.asn1.cms.ContentInfo,g.asn1.ASN1Object);g.asn1.cms.SignedData=function(n){var e=Error,t=g,r=t.asn1,i=r.ASN1Object,o=r.DERInteger,a=r.DERSet,s=r.DERSequence,c=r.DERTaggedObject,l=r.cms,h=l.EncapsulatedContentInfo,u=l.SignerInfo,d=l.ContentInfo,p=l.CertificateSet,m=l.RevocationInfoChoices,f=r.x509,x=f.AlgorithmIdentifier;g.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var b=this.params;this._setDigestAlgs(b),this._setContentTypeByEContent(b),this._setMessageDigestByEContent(b),this._setSignerInfoVersion(b),this._setSignedDataVersion(b)},this._setDigestAlgs=function(b){for(var _={},O=b.sinfos,S=0;S<O.length;S++){var E=O[S];_[E.hashalg]=1}b.hashalgs=Object.keys(_).sort()},this._setContentTypeByEContent=function(b){for(var _=b.econtent.type,O=b.sinfos,S=0;S<O.length;S++){var E=O[S],F=this._getAttrParamByName(E,"contentType");F.type=_}},this._setMessageDigestByEContent=function(b){var _=b.econtent,O=b.econtent.type,S=_.content.hex;S==null&&_.type=="data"&&_.content.str!=null&&(S=Ir(_.content.str));for(var E=b.sinfos,F=0;F<E.length;F++){var I=E[F],y=I.hashalg,P=this._getAttrParamByName(I,"messageDigest"),C=g.crypto.Util.hashHex(S,y);P.hex=C}},this._getAttrParamByName=function(b,_){for(var O=b.sattrs.array,S=0;S<O.length;S++)if(O[S].attr==_)return O[S]},this._setSignerInfoVersion=function(b){for(var _=b.sinfos,O=0;O<_.length;O++){var S=_[O],E=1;S.id.type=="skid"&&(E=3),S.version=E}},this._setSignedDataVersion=function(b){var _=this._getSignedDataVersion(b);b.version=_},this._getSignedDataVersion=function(b){if(b.revinfos!=null)for(var _=b.revinfos,O=0;O<_.length;O++){var S=_[O];if(S.ocsp!=null)return 5}for(var E=b.sinfos,O=0;O<E.length;O++){var F=b.sinfos[O];if(F.version==3)return 3}return b.econtent.type!="data"?3:1},this.tohex=function(){var b=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),b.fixed!=!0&&this.checkAndFixParam();var _=[];_.push(new o({int:b.version}));for(var O=[],S=0;S<b.hashalgs.length;S++){var E=b.hashalgs[S];O.push(new x({name:E}))}_.push(new a({array:O})),_.push(new h(b.econtent)),b.certs!=null&&_.push(new p(b.certs)),b.revinfos!=null&&_.push(new m(b.revinfos));for(var F=[],S=0;S<b.sinfos.length;S++){var I=b.sinfos[S];F.push(new u(I))}_.push(new a({array:F}));var y=new s({array:_});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var b=new d({type:"signed-data",obj:this});return b},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.SignedData,g.asn1.ASN1Object);g.asn1.cms.CertificateSet=function(n){g.asn1.cms.CertificateSet.superclass.constructor.call(this);var e=Error,t=g.asn1,r=t.DERTaggedObject,i=t.DERSet,o=t.ASN1Object;this.params=null,this.tohex=function(){var a=this.params,s=[],c;if(a instanceof Array)c=a;else if(a.array!=null)c=a.array;else throw new e("cert array not specified");for(var l=0;l<c.length;l++){var h=c[l],u=xt(h),d=new o;d.hTLV=u,s.push(d)}var p={array:s};a.sortflag==!1&&(p.sortflag=!1);var m=new i(p),f=new r({tag:"a0",explicit:!1,obj:m});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.CertificateSet,g.asn1.ASN1Object);g.asn1.cms.RevocationInfoChoices=function(n){g.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],r=0;r<e.length;r++)t.push(new g.asn1.cms.RevocationInfoChoice(e[r]));var i=g.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.RevocationInfoChoices,g.asn1.ASN1Object);g.asn1.cms.RevocationInfoChoice=function(n){g.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(e.crl!=null&&typeof e.crl=="string"){var t=e.crl;return e.crl.indexOf("-----BEGIN")!=-1&&(t=xt(e.crl)),t}else if(e.ocsp!=null){var r=g.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new g.asn1.cms.OtherRevocationFormat(e)}});return r.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.RevocationInfoChoice,g.asn1.ASN1Object);g.asn1.cms.OtherRevocationFormat=function(n){g.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var e=Error,t=g,r=t.asn1,i=r.ASN1Util.newObject,o=t.lang.String.isHex;this.params=null,this.tohex=function(){var a=this.params;if(a.ocsp==null)throw new e("property ocsp not specified");if(!o(a.ocsp)||!$.isASN1HEX(a.ocsp))throw new e("ocsp value not ASN.1 hex string");var s=i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:a.ocsp}}]});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cms.OtherRevocationFormat,g.asn1.ASN1Object);g.asn1.cms.CMSUtil=new function(){};g.asn1.cms.CMSUtil.newSignedData=function(n){return new g.asn1.cms.SignedData(n)};g.asn1.cms.CMSUtil.verifySignedData=function(n){var e=g,t=e.asn1,r=t.cms,i=r.SignerInfo,o=r.SignedData,a=r.SigningTime,s=r.SigningCertificate,c=r.SigningCertificateV2,l=t.cades,h=l.SignaturePolicyIdentifier,u=e.lang.String.isHex,d=$,p=d.getVbyList,m=d.getTLVbyList,f=d.getIdxbyList,x=d.getChildIdx,b=d.getTLV,_=d.oidname,O=e.crypto.Util.hashHex;n.cms===void 0&&u(n.cms);var S=n.cms,E=function(D,R){for(var N,L=3;L<6;L++)if(N=f(D,0,[1,0,L]),N!==void 0){var V=D.substr(N,2);V==="a0"&&(R.certsIdx=N),V==="a1"&&(R.revinfosIdx=N),V==="31"&&(R.signerinfosIdx=N)}},F=function(D,R){var N=R.signerinfosIdx;if(N!==void 0){var L=x(D,N);R.signerInfoIdxList=L;for(var V=0;V<L.length;V++){var G=L[V],re={idx:G};I(D,re),R.signerInfos.push(re)}}},I=function(D,R){var N=R.idx;R.signerid_issuer1=m(D,N,[1,0],"30"),R.signerid_serial1=p(D,N,[1,1],"02"),R.hashalg=_(p(D,N,[2,0],"06"));var L=f(D,N,[3],"a0");R.idxSignedAttrs=L,y(D,R,L);var V=x(D,N),G=V.length;if(G<6)throw"malformed SignerInfo";R.sigalg=_(p(D,N,[G-2,0],"06")),R.sigval=p(D,N,[G-1],"04")},y=function(D,R,N){var L=x(D,N);R.signedAttrIdxList=L;for(var V=0;V<L.length;V++){var G=L[V],re=p(D,G,[0],"06"),te;re==="2a864886f70d010905"?(te=Ve(p(D,G,[1,0])),R.saSigningTime=te):re==="2a864886f70d010904"&&(te=p(D,G,[1,0],"04"),R.saMessageDigest=te)}},P=function(D,R){if(p(D,0,[0],"06")!=="2a864886f70d010702")return R;R.cmsType="signedData",R.econtent=p(D,0,[1,0,2,1,0]),E(D,R),R.signerInfos=[],F(D,R)},C=function(D,R){for(var N=R.parse.signerInfos,L=N.length,V=!0,G=0;G<L;G++){var re=N[G];A(D,R,re,G),re.isValid||(V=!1)}R.isValid=V},M=function(D,R,N,L){var V=R.parse.certsIdx,G;if(R.certs===void 0){G=[],R.certkeys=[];for(var re=x(D,V),te=0;te<re.length;te++){var be=b(D,re[te]),ge=new he;ge.readCertHex(be),G[te]=ge,R.certkeys[te]=ge.getPublicKey()}R.certs=G}else G=R.certs;R.cccc=G.length,R.cccci=re.length;for(var te=0;te<G.length;te++){var rt=ge.getIssuerHex(),He=ge.getSerialNumberHex();N.signerid_issuer1===rt&&N.signerid_serial1===He&&(N.certkey_idx=te)}},A=function(D,R,N,L){N.verifyDetail={};var V=N.verifyDetail,G=R.parse.econtent,re=N.hashalg,te=N.saMessageDigest;V.validMessageDigest=!1,O(G,re)===te&&(V.validMessageDigest=!0),M(D,R,N,L),V.validSignatureValue=!1;var be=N.sigalg,ge="31"+b(D,N.idxSignedAttrs).substr(2);N.signedattrshex=ge;var rt=R.certs[N.certkey_idx].getPublicKey(),He=new g.crypto.Signature({alg:be});He.init(rt),He.updateHex(ge);var Ue=He.verify(N.sigval);V.validSignatureValue_isValid=Ue,Ue===!0&&(V.validSignatureValue=!0),N.isValid=!1,V.validMessageDigest&&V.validSignatureValue&&(N.isValid=!0)},T=function(){},k={isValid:!1,parse:{}};return P(S,k.parse),C(S,k),k};g.asn1.cms.CMSParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,a=r.getIdxbyList,s=r.getTLVbyList,c=r.getTLVbyListEx,l=r.getVbyList,h=r.getVbyListEx,u=r.getChildIdx;this.getCMSSignedData=function(d){var p=s(d,0,[1,0]),m=this.getSignedData(p);return m},this.getSignedData=function(d){var p=u(d,0),m={},f=i(d,p[0]),x=parseInt(f,16);m.version=x;var b=o(d,p[1]);m.hashalgs=this.getHashAlgArray(b);var _=o(d,p[2]);m.econtent=this.getEContent(_);var O=c(d,0,["[0]"]);O!=null&&(m.certs=this.getCertificateSet(O));var S=c(d,0,["[1]"]);S!=null;var E=c(d,0,[3]);return m.sinfos=this.getSignerInfos(E),m},this.getHashAlgArray=function(d){for(var p=u(d,0),m=new e,f=[],x=0;x<p.length;x++){var b=o(d,p[x]),_=m.getAlgorithmIdentifierName(b);f.push(_)}return f},this.getEContent=function(d){var p={},m=l(d,0,[0]),f=l(d,0,[1,0]);return p.type=g.asn1.x509.OID.oid2name($.hextooidstr(m)),p.content={hex:f},p},this.getSignerInfos=function(d){for(var p=[],m=u(d,0),f=0;f<m.length;f++){var x=o(d,m[f]),b=this.getSignerInfo(x);p.push(b)}return p},this.getSignerInfo=function(d){var p={},m=u(d,0),f=r.getInt(d,m[0],-1);f!=-1&&(p.version=f);var x=o(d,m[1]),b=this.getIssuerAndSerialNumber(x);p.id=b;var _=o(d,m[2]),O=t.getAlgorithmIdentifierName(_);p.hashalg=O;var S=c(d,0,["[0]"]);if(S!=null){var E=this.getAttributeList(S);p.sattrs=E}var F=c(d,0,[3]),I=t.getAlgorithmIdentifierName(F);p.sigalg=I;var y=h(d,0,[4]);p.sighex=y;var P=c(d,0,["[1]"]);if(P!=null){var C=this.getAttributeList(P);p.uattrs=C}return p},this.getSignerIdentifier=function(d){if(d.substr(0,2)=="30")return this.getIssuerAndSerialNumber(d);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(d){var p={type:"isssn"},m=u(d,0),f=o(d,m[0]);p.issuer=t.getX500Name(f);var x=i(d,m[1]);return p.serial={hex:x},p},this.getAttributeList=function(d){for(var p=[],m=u(d,0),f=0;f<m.length;f++){var x=o(d,m[f]),b=this.getAttribute(x);p.push(b)}return{array:p}},this.getAttribute=function(d){var p={},m=u(d,0),f=r.getOID(d,m[0]),x=g.asn1.x509.OID.oid2name(f);p.attr=x;var b=o(d,m[1]),_=u(b,0);if(_.length==1)p.valhex=o(b,_[0]);else{for(var O=[],S=0;S<_.length;S++)O.push(o(b,_[S]));p.valhex=O}return x=="contentType"?this.setContentType(p):x=="messageDigest"?this.setMessageDigest(p):x=="signingTime"?this.setSigningTime(p):x=="signingCertificate"?this.setSigningCertificate(p):x=="signingCertificateV2"?this.setSigningCertificateV2(p):x=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(p),p},this.setContentType=function(d){var p=r.getOIDName(d.valhex,0,null);p!=null&&(d.type=p,delete d.valhex)},this.setSigningTime=function(d){var p=i(d.valhex,0),m=Ve(p);d.str=m,delete d.valhex},this.setMessageDigest=function(d){var p=i(d.valhex,0);d.hex=p,delete d.valhex},this.setSigningCertificate=function(d){var p=u(d.valhex,0);if(p.length>0){for(var m=o(d.valhex,p[0]),f=u(m,0),x=[],b=0;b<f.length;b++){var _=o(m,f[b]),O=this.getESSCertID(_);x.push(O)}d.array=x}if(p.length>1){var S=o(d.valhex,p[1]);d.polhex=S}delete d.valhex},this.setSignaturePolicyIdentifier=function(d){var p=u(d.valhex,0);if(p.length>0){var m=r.getOID(d.valhex,p[0]);d.oid=m}if(p.length>1){var f=new e,x=u(d.valhex,p[1]),b=o(d.valhex,x[0]),_=f.getAlgorithmIdentifierName(b);d.alg=_;var O=i(d.valhex,x[1]);d.hash=O}delete d.valhex},this.setSigningCertificateV2=function(d){var p=u(d.valhex,0);if(p.length>0){for(var m=o(d.valhex,p[0]),f=u(m,0),x=[],b=0;b<f.length;b++){var _=o(m,f[b]),O=this.getESSCertIDv2(_);x.push(O)}d.array=x}if(p.length>1){var S=o(d.valhex,p[1]);d.polhex=S}delete d.valhex},this.getESSCertID=function(d){var p={},m=u(d,0);if(m.length>0){var f=i(d,m[0]);p.hash=f}if(m.length>1){var x=o(d,m[1]),b=this.getIssuerSerial(x);b.serial!=null&&(p.serial=b.serial),b.issuer!=null&&(p.issuer=b.issuer)}return p},this.getESSCertIDv2=function(d){var p={},m=u(d,0);if(m.length<1||3<m.length)throw new n("wrong number of elements");var f=0;if(d.substr(m[0],2)=="30"){var x=o(d,m[0]);p.alg=t.getAlgorithmIdentifierName(x),f++}else p.alg="sha256";var b=i(d,m[f]);if(p.hash=b,m.length>f+1){var _=o(d,m[f+1]),O=this.getIssuerSerial(_);p.issuer=O.issuer,p.serial=O.serial}return p},this.getIssuerSerial=function(d){var p={},m=u(d,0),f=o(d,m[0]),x=t.getGeneralNames(f),b=x[0].dn;p.issuer=b;var _=i(d,m[1]);return p.serial={hex:_},p},this.getCertificateSet=function(d){for(var p=u(d,0),m=[],f=0;f<p.length;f++){var x=o(d,p[f]);if(x.substr(0,2)=="30"){var b=un(x,"CERTIFICATE");m.push(b)}}return{array:m,sortflag:!1}}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.tsp>"u"||!g.asn1.tsp)&&(g.asn1.tsp={});g.asn1.tsp.TimeStampToken=function(n){var e=g,t=e.asn1,r=t.tsp;r.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var i=new r.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=i.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.TimeStampToken,g.asn1.cms.SignedData);g.asn1.tsp.TSTInfo=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.DERInteger,a=r.DERBoolean,s=r.DERGeneralizedTime,c=r.DERObjectIdentifier,l=r.DERTaggedObject,h=r.tsp,u=h.MessageImprint,d=h.Accuracy,p=r.x509.X500Name,m=r.x509.GeneralName;if(h.TSTInfo.superclass.constructor.call(this),this.dVersion=new o({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var f=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(f.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(f.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(f.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");f.push(this.dGenTime),this.dAccuracy!=null&&f.push(this.dAccuracy),this.dOrdering!=null&&f.push(this.dOrdering),this.dNonce!=null&&f.push(this.dNonce),this.dTsa!=null&&f.push(this.dTsa);var x=new i({array:f});return this.hTLV=x.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0){if(typeof n.policy=="string"){if(!n.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new c({oid:n.policy})}n.messageImprint!==void 0&&(this.dMessageImprint=new u(n.messageImprint)),n.serial!==void 0&&(this.dSerial=new o(n.serial)),n.genTime!==void 0&&(this.dGenTime=new s(n.genTime)),n.accuracy!==void 0&&(this.dAccuracy=new d(n.accuracy)),n.ordering!==void 0&&n.ordering==!0&&(this.dOrdering=new a),n.nonce!==void 0&&(this.dNonce=new o(n.nonce)),n.tsa!==void 0&&(this.dTsa=new l({tag:"a0",explicit:!0,obj:new m({dn:n.tsa})}))}};U(g.asn1.tsp.TSTInfo,g.asn1.ASN1Object);g.asn1.tsp.Accuracy=function(n){var e=g,t=e.asn1,r=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,o=[];return i.seconds!=null&&typeof i.seconds=="number"&&o.push({int:i.seconds}),i.millis!=null&&typeof i.millis=="number"&&o.push({tag:{tagi:"80",obj:{int:i.millis}}}),i.micros!=null&&typeof i.micros=="number"&&o.push({tag:{tagi:"81",obj:{int:i.micros}}}),r({seq:o}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.Accuracy,g.asn1.ASN1Object);g.asn1.tsp.MessageImprint=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.DEROctetString,o=t.x509,a=o.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var s=this.params,c=new a({name:s.alg}),l=new i({hex:s.hash}),h=new r({array:[c,l]});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.tsp.MessageImprint,g.asn1.ASN1Object);g.asn1.tsp.TimeStampReq=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.DERInteger,o=t.DERBoolean,a=t.ASN1Object,s=t.DERObjectIdentifier,c=t.tsp,l=c.MessageImprint;c.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u=[];u.push(new i({int:1})),h.messageImprint instanceof g.asn1.ASN1Object?u.push(h.messageImprint):u.push(new l(h.messageImprint)),h.policy!=null&&u.push(new s(h.policy)),h.nonce!=null&&u.push(new i(h.nonce)),h.certreq==!0&&u.push(new o);var d=new r({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.TimeStampReq,g.asn1.ASN1Object);g.asn1.tsp.TimeStampResp=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.ASN1Object,o=t.tsp,a=o.PKIStatusInfo;o.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var s=this.params,c=[];if(s.econtent!=null||s.tst!=null)if(s.statusinfo!=null?c.push(new a(s.statusinfo)):c.push(new a("granted")),s.econtent!=null)c.push(new o.TimeStampToken(s).getContentInfo());else if(s.tst instanceof t.ASN1Object)c.push(s.tst);else throw new Error("improper member tst value");else if(s.statusinfo!=null)c.push(new a(s.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var l=new r({array:c});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.TimeStampResp,g.asn1.ASN1Object);g.asn1.tsp.PKIStatusInfo=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.tsp,a=o.PKIStatus,s=o.PKIFreeText,c=o.PKIFailureInfo;o.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var l=this.params,h=[];if(typeof l=="string")h.push(new a(l));else{if(l.status==null)throw new e("property 'status' unspecified");h.push(new a(l.status)),l.statusstr!=null&&h.push(new s(l.statusstr)),l.failinfo!=null&&h.push(new c(l.failinfo))}var u=new i({array:h});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.PKIStatusInfo,g.asn1.ASN1Object);g.asn1.tsp.PKIStatus=function(n){var e=Error,t=g,r=t.asn1,i=r.DERInteger,o=r.tsp;o.PKIStatus.superclass.constructor.call(this);var a={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var s=this.params,c,l;if(typeof s=="string")try{l=a[s]}catch{throw new e("undefined name: "+s)}else if(typeof s=="number")l=s;else throw new e("unsupported params");return new i({int:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.PKIStatus,g.asn1.ASN1Object);g.asn1.tsp.PKIFreeText=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.DERUTF8String,a=r.tsp;a.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var s=this.params;if(!s instanceof Array)throw new e("wrong params: not array");for(var c=[],l=0;l<s.length;l++)c.push(new o({str:s[l]}));var h=new i({array:c});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.PKIFreeText,g.asn1.ASN1Object);g.asn1.tsp.PKIFailureInfo=function(n){var e=Error,t=g,r=t.asn1,i=r.DERBitString,o=r.tsp,a=o.PKIFailureInfo,s={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};a.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var c=this.params,l=0;if(typeof c=="number"&&0<=c&&c<=25){l|=1<<c;for(var h=l.toString(2),u="",d=h.length-1;d>=0;d--)u+=h[d];return u}else{if(typeof c=="string"&&s[c]!=null)return up([c],s);if(typeof c=="object"&&c.length!=null)return up(c,s);throw new e("wrong params")}},this.tohex=function(){var c=this.params,l=this.getBinValue();return new i({bin:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.tsp.PKIFailureInfo,g.asn1.ASN1Object);g.asn1.tsp.AbstractTSAAdapter=function(n){this.getTSTHex=function(e,t){throw"not implemented yet"}};g.asn1.tsp.SimpleTSAAdapter=function(n){var e=g,t=e.asn1,r=t.tsp,i=e.crypto.Util.hashHex;r.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(o,a){var s=i(o,a);this.params.econtent.content.messageImprint={alg:a,hash:s},this.params.econtent.content.serial={int:this.serial++};var c=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:c};var l=new r.TimeStampToken(this.params);return l.getContentInfoEncodedHex()},n!==void 0&&(this.params=n)};U(g.asn1.tsp.SimpleTSAAdapter,g.asn1.tsp.AbstractTSAAdapter);g.asn1.tsp.FixedTSAAdapter=function(n){var e=g,t=e.asn1,r=t.tsp,i=e.crypto.Util.hashHex;r.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(o,a){var s=i(o,a);this.params.econtent.content.messageImprint={alg:a,hash:s};var c=new r.TimeStampToken(this.params);return c.getContentInfoEncodedHex()},n!==void 0&&(this.params=n)};U(g.asn1.tsp.FixedTSAAdapter,g.asn1.tsp.AbstractTSAAdapter);g.asn1.tsp.TSPUtil=new function(){};g.asn1.tsp.TSPUtil.newTimeStampToken=function(n){return new g.asn1.tsp.TimeStampToken(n)};g.asn1.tsp.TSPUtil.parseTimeStampReq=function(n){var e=new g.asn1.tsp.TSPParser;return e.getTimeStampReq(n)};g.asn1.tsp.TSPUtil.parseMessageImprint=function(n){var e=new g.asn1.tsp.TSPParser;return e.getMessageImprint(n)};g.asn1.tsp.TSPParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,a=r.getIdxbyList,s=r.getTLVbyListEx,c=r.getChildIdx,l=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],h={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(u){var d=c(u,0);if(d.length==1)return this.getPKIStatusInfo(o(u,d[0]));if(d.length>1){var p=this.getPKIStatusInfo(o(u,d[0])),m=o(u,d[1]),f=this.getToken(m);return f.statusinfo=p,f}},this.getToken=function(u){var d=new g.asn1.cms.CMSParser,p=d.getCMSSignedData(u);return this.setTSTInfo(p),p},this.setTSTInfo=function(u){var d=u.econtent;if(d.type=="tstinfo"){var p=d.content.hex,m=this.getTSTInfo(p);d.content=m}},this.getTSTInfo=function(u){var d={},p=c(u,0),m=i(u,p[1]);d.policy=_p(m);var f=o(u,p[2]);d.messageImprint=this.getMessageImprint(f);var x=i(u,p[3]);d.serial={hex:x};var b=i(u,p[4]);d.genTime={str:Ve(b)};var _=0;if(p.length>5&&u.substr(p[5],2)=="30"){var O=o(u,p[5]);d.accuracy=this.getAccuracy(O),_++}if(p.length>5+_&&u.substr(p[5+_],2)=="01"){var S=i(u,p[5+_]);S=="ff"&&(d.ordering=!0),_++}if(p.length>5+_&&u.substr(p[5+_],2)=="02"){var E=i(u,p[5+_]);d.nonce={hex:E},_++}if(p.length>5+_&&u.substr(p[5+_],2)=="a0"){var F=o(u,p[5+_]);F="30"+F.substr(2),pGeneralNames=t.getGeneralNames(F);var I=pGeneralNames[0].dn;d.tsa=I,_++}if(p.length>5+_&&u.substr(p[5+_],2)=="a1"){var y=o(u,p[5+_]);y="30"+y.substr(2);var P=t.getExtParamArray(y);d.ext=P,_++}return d},this.getAccuracy=function(u){for(var d={},p=c(u,0),m=0;m<p.length;m++){var f=u.substr(p[m],2),x=i(u,p[m]),b=parseInt(x,16);f=="02"?d.seconds=b:f=="80"?d.millis=b:f=="81"&&(d.micros=b)}return d},this.getMessageImprint=function(u){if(u.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var d={},p=c(u,0),m=a(u,0,[0,0]),f=i(u,m),x=r.hextooidstr(f),b=g.asn1.x509.OID.oid2name(x);if(b=="")throw new Error("hashAlg name undefined: "+x);var _=b,O=a(u,0,[1]);return d.alg=_,d.hash=i(u,O),d},this.getPKIStatusInfo=function(u){var d={},p=c(u,0),m=0;try{var f=i(u,p[0]),x=parseInt(f,16);d.status=l[x]}catch{}if(p.length>1&&u.substr(p[1],2)=="30"){var b=o(u,p[1]);d.statusstr=this.getPKIFreeText(b),m++}if(p.length>m&&u.substr(p[1+m],2)=="03"){var _=o(u,p[1+m]);d.failinfo=this.getPKIFailureInfo(_)}return d},this.getPKIFreeText=function(u){for(var d=[],p=c(u,0),m=0;m<p.length;m++)d.push(r.getString(u,p[m]));return d},this.getPKIFailureInfo=function(u){var d=r.getInt(u,0);return h[d]!=null?h[d]:d},this.getTimeStampReq=function(u){var d={};d.certreq=!1;var p=c(u,0);if(p.length<2)throw new Error("TimeStampReq must have at least 2 items");var m=o(u,p[1]);d.messageImprint=g.asn1.tsp.TSPUtil.parseMessageImprint(m);for(var f=2;f<p.length;f++){var x=p[f],b=u.substr(x,2);if(b=="06"){var _=i(u,x);d.policy=r.hextooidstr(_)}b=="02"&&(d.nonce=i(u,x)),b=="01"&&(d.certreq=!0)}return d}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.cades>"u"||!g.asn1.cades)&&(g.asn1.cades={});g.asn1.cades.SignaturePolicyIdentifier=function(n){var e=g,t=e.asn1,r=t.cades,i=r.SignaturePolicyId;r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new i(this.params)]},this.setByParam=function(o){this.params=o},n!=null&&this.setByParam(n)};U(g.asn1.cades.SignaturePolicyIdentifier,g.asn1.cms.Attribute);g.asn1.cades.SignaturePolicyId=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.DERObjectIdentifier,o=t.x509,a=o.AlgorithmIdentifier,s=t.cades,c=s.SignaturePolicyId,l=s.OtherHashAlgAndValue;c.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,u=[];u.push(new i(h.oid)),u.push(new l(h));var d=new r({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},n!=null&&this.setByParam(n)};U(g.asn1.cades.SignaturePolicyId,g.asn1.ASN1Object);g.asn1.cades.OtherHashAlgAndValue=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.DEROctetString,a=r.x509,s=a.AlgorithmIdentifier,c=r.cades,l=c.OtherHashAlgAndValue;l.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params;if(h.alg==null)throw new e("property 'alg' not specified");if(h.hash==null&&h.cert==null)throw new e("property 'hash' nor 'cert' not specified");var u=null;if(h.hash!=null)u=h.hash;else if(h.cert!=null){if(typeof h.cert!="string")throw new e("cert not string");var d=h.cert;h.cert.indexOf("-----BEGIN")!=-1&&(d=xt(h.cert)),u=g.crypto.Util.hashHex(d,h.alg)}var p=[];p.push(new s({name:h.alg})),p.push(new o({hex:u}));var m=new i({array:p});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cades.OtherHashAlgAndValue,g.asn1.ASN1Object);g.asn1.cades.OtherHashValue=function(n){g.asn1.cades.OtherHashValue.superclass.constructor.call(this);var e=Error,t=g,r=t.lang.String.isHex,i=t.asn1,o=i.DEROctetString,a=t.crypto.Util.hashHex;this.params=null,this.tohex=function(){var s=this.params;if(s.hash==null&&s.cert==null)throw new e("hash or cert not specified");var c=null;if(s.hash!=null)c=s.hash;else if(s.cert!=null){if(typeof s.cert!="string")throw new e("cert not string");var l=s.cert;s.cert.indexOf("-----BEGIN")!=-1&&(l=xt(s.cert)),c=g.crypto.Util.hashHex(l,"sha1")}return new o({hex:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cades.OtherHashValue,g.asn1.ASN1Object);g.asn1.cades.SignatureTimeStamp=function(n){var e=Error,t=g,r=t.lang.String.isHex,i=t.asn1,o=i.ASN1Object,a=i.x509,s=i.cades;s.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var c=this.params;if(c.tst!=null)if(r(c.tst)){var l=new o;return l.hTLV=c.tst,[l]}else{if(c.tst instanceof o)return[c.tst];throw new e("params.tst has wrong value")}else if(c.res!=null){var h=c.res;if(h instanceof o&&(h=h.tohex()),typeof h!="string"||!r(h))throw new e("params.res has wrong value");var u=$.getTLVbyList(h,0,[1]),l=new o;return l.hTLV=c.tst,[l]}},n!=null&&this.setByParam(n)};U(g.asn1.cades.SignatureTimeStamp,g.asn1.cms.Attribute);g.asn1.cades.CompleteCertificateRefs=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.cades,a=o.OtherCertID,s=t.lang.String.isHex;o.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var c=this.params,l=[],h=0;h<c.array.length;h++){var u=c.array[h];if(typeof u=="string")if(u.indexOf("-----BEGIN")!=-1)u={cert:u};else if(s(u))u={hash:u};else throw new e("unsupported value: "+u);c.alg!=null&&u.alg==null&&(u.alg=c.alg),c.hasis!=null&&u.hasis==null&&(u.hasis=c.hasis);var d=new a(u);l.push(d)}var p=new i({array:l});return[p]},n!=null&&this.setByParam(n)};U(g.asn1.cades.CompleteCertificateRefs,g.asn1.cms.Attribute);g.asn1.cades.OtherCertID=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.cms,o=i.IssuerSerial,a=t.cades,s=a.OtherHashValue,c=a.OtherHashAlgAndValue;a.OtherCertID.superclass.constructor.call(this),this.params=n,this.tohex=function(){var l=this.params;typeof l=="string"&&(l.indexOf("-----BEGIN")!=-1?l={cert:l}:_isHex(l)&&(l={hash:l}));var h=[],u=null;if(l.alg!=null?u=new c(l):u=new s(l),h.push(u),l.cert!=null&&l.hasis==!0||l.issuer!=null&&l.serial!=null){var d=new o(l);h.push(d)}var p=new r({array:h});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cades.OtherCertID,g.asn1.ASN1Object);g.asn1.cades.OtherHash=function(n){var e=Error,t=g,r=t.asn1,i=r.cms,o=r.cades,a=o.OtherHashAlgAndValue,s=o.OtherHashValue,c=t.crypto.Util.hashHex,l=t.lang.String.isHex;o.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params;typeof h=="string"&&(h.indexOf("-----BEGIN")!=-1?h={cert:h}:l(h)&&(h={hash:h}));var u=null;return h.alg!=null?u=new a(h):u=new s(h),u.tohex()},this.getEncodedHex=function(){return this.tohex()},n!=null&&this.setByParam(n)};U(g.asn1.cades.OtherHash,g.asn1.ASN1Object);g.asn1.cades.CAdESUtil=new function(){};g.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(n){var e=new g.asn1.cms.CMSParser,t=e.getCMSSignedData(n);return t};g.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(n,e,t){var r=$,i=r.getChildIdx,o=r.getTLV,a=r.getV,s=g,c=s.asn1,l=c.ASN1Object,h=c.cms,u=h.AttributeList,d=h.SignerInfo,p={},m=i(n,e);if(m.length!=6)throw"not supported items for SignerInfo (!=6)";var f=m.shift();p.version=o(n,f);var x=m.shift();p.si=o(n,x);var b=m.shift();p.digalg=o(n,b);var _=m.shift();p.sattrs=o(n,_);var O=m.shift();p.sigalg=o(n,O);var S=m.shift();p.sig=o(n,S),p.sigval=a(n,S);var E=null;return p.obj=new d,E=new l,E.hTLV=p.version,p.obj.dCMSVersion=E,E=new l,E.hTLV=p.si,p.obj.dSignerIdentifier=E,E=new l,E.hTLV=p.digalg,p.obj.dDigestAlgorithm=E,E=new l,E.hTLV=p.sattrs,p.obj.dSignedAttrs=E,E=new l,E.hTLV=p.sigalg,p.obj.dSigAlg=E,E=new l,E.hTLV=p.sig,p.obj.dSig=E,p.obj.dUnsignedAttrs=new u,p};(typeof g.asn1.csr>"u"||!g.asn1.csr)&&(g.asn1.csr={});g.asn1.csr.CertificationRequest=function(n){var e=g,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.csr,a=t.x509,s=o.CertificationRequestInfo;o.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(c){this.params=c},this.sign=function(){var c=new s(this.params).tohex(),l=new g.crypto.Signature({alg:this.params.sigalg});l.init(this.params.sbjprvkey),l.updateHex(c);var h=l.sign();this.params.sighex=h},this.getPEM=function(){return un(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var c=this.params,l=new g.asn1.csr.CertificationRequestInfo(this.params),h=new g.asn1.x509.AlgorithmIdentifier({name:c.sigalg});if(c.sighex==null&&c.sbjprvkey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var u=new r({hex:"00"+c.sighex}),d=new i({array:[l,h,u]});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.csr.CertificationRequest,g.asn1.ASN1Object);g.asn1.csr.CertificationRequestInfo=function(n){var e=g,t=e.asn1,r=t.DERBitString,i=t.DERSequence,o=t.DERInteger,a=t.DERUTF8String,s=t.DERTaggedObject,c=t.ASN1Util.newObject,l=t.csr,h=t.x509,u=h.X500Name,d=h.Extensions,p=h.SubjectPublicKeyInfo,m=l.AttributeList;l.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(x){x!=null&&(this.params=x)},this.tohex=function(){var x=this.params,b=[];if(b.push(new o({int:0})),b.push(new u(x.subject)),b.push(new p(Se.getKey(x.sbjpubkey))),x.attrs!=null){var _=f(x.attrs),O=c({tag:{tage:"a0",obj:_}});b.push(O)}else if(x.extreq!=null){var S=new d(x.extreq),O=c({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[S]}]}}});b.push(O)}else b.push(new s({tag:"a0",explicit:!1,obj:new a({str:""})}));var E=new i({array:b});return E.tohex()},this.getEncodedHex=function(){return this.tohex()};function f(x){for(var b=Error,_=g.asn1.x509.Extensions,O=[],S=0;S<x.length;S++){var E=x[S],F=E.attr;if(F=="extensionRequest"){var I=new _(E.ext),y={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[I]}]};O.push(y)}else if(F=="unstructuredName"){var y={seq:[{oid:"1.2.840.113549.1.9.2"},{set:E.names}]};O.push(y)}else if(F=="challengePassword"){var y={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:E.password}]}]};O.push(y)}else throw new b("unknown CSR attribute")}return{set:O}}n!=null&&this.setByParam(n)};U(g.asn1.csr.CertificationRequestInfo,g.asn1.ASN1Object);g.asn1.csr.AttributeList=function(n){function e(t){}};U(g.asn1.csr.AttributeList,g.asn1.ASN1Object);g.asn1.csr.CSRUtil=new function(){};g.asn1.csr.CSRUtil.newCSRPEM=function(n){var e=Se,t=g.asn1.csr,r=new t.CertificationRequest(n),i=r.getPEM();return i};g.asn1.csr.CSRUtil.getParam=function(n,e){var t=$,r=t.getV,i=t.getIdxbyList,o=t.getTLVbyList,a=t.getTLVbyListEx,s=t.getVbyListEx,c=function(_){var O=i(_,0,[0,3,0,0],"06");return r(_,O)!="2a864886f70d01090e"?null:o(_,0,[0,3,0,1,0],"30")},l={};if(n.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var h=xt(n,"CERTIFICATE REQUEST");e&&(l.tbs=o(h,0,[0]));try{var u=a(h,0,[0,1]);if(u=="3000")l.subject={};else{var f=new he;l.subject=f.getX500Name(u)}}catch{}var d=a(h,0,[0,2]),p=Se.getKey(d,null,"pkcs8pub");l.sbjpubkey=Se.getPEM(p,"PKCS8PUB");var m=c(h),f=new he;m!=null&&(l.extreq=f.getExtParamArray(m));try{var x=a(h,0,[1],"30"),f=new he;l.sigalg=f.getAlgorithmIdentifierName(x)}catch{}try{var b=s(h,0,[2]);l.sighex=b}catch{}return l};g.asn1.csr.CSRUtil.verifySignature=function(n){try{var e=null;if(typeof n=="string"&&n.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?e=g.asn1.csr.CSRUtil.getParam(n,!0):typeof n=="object"&&n.sbjpubkey!=null&&n.sigalg!=null&&n.sighex!=null&&n.tbs!=null&&(e=n),e==null)return!1;var t=new g.crypto.Signature({alg:e.sigalg});return t.init(e.sbjpubkey),t.updateHex(e.tbs),t.verify(e.sighex)}catch(r){return alert(r),!1}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.ocsp>"u"||!g.asn1.ocsp)&&(g.asn1.ocsp={});g.asn1.ocsp.DEFAULT_HASH="sha1";g.asn1.ocsp.OCSPResponse=function(n){g.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var e=g.asn1.DEREnumerated,t=g.asn1.ASN1Util.newObject,r=g.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var o=this.params.resstatus;return typeof o=="number"?o:typeof o!="string"?-1:i.indexOf(o)},this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params,a=this._getStatusCode();if(a==-1)throw new Error("responseStatus not supported: "+o.resstatus);if(a!=0)return t({seq:[{enum:{int:a}}]}).tohex();var s=new r(o);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:s}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.OCSPResponse,g.asn1.ASN1Object);g.asn1.ocsp.ResponseBytes=function(n){g.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var e=g.asn1,t=e.DERSequence,r=e.DERObjectIdentifier,i=e.DEROctetString,o=e.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(a.restype!="ocspBasic")throw new Error("not supported responseType: "+a.restype);var s=new o(a),c=[];c.push(new r({name:"ocspBasic"})),c.push(new i({hex:s.tohex()}));var l=new t({array:c});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.ResponseBytes,g.asn1.ASN1Object);g.asn1.ocsp.BasicOCSPResponse=function(n){g.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var e=Error,t=g.asn1,r=t.ASN1Object,i=t.DERSequence,o=t.DERGeneralizedTime,a=t.DERTaggedObject,s=t.DERBitString,c=t.x509.Extensions,l=t.x509.AlgorithmIdentifier,h=t.ocsp,u=h.ResponderID;_SingleResponseList=h.SingleResponseList,_ResponseData=h.ResponseData,this.params=null,this.setByParam=function(d){this.params=d},this.sign=function(){var d=this.params,p=d.tbsresp.tohex(),m=new g.crypto.Signature({alg:d.sigalg});m.init(d.reskey),m.updateHex(p),d.sighex=m.sign()},this.tohex=function(){var d=this.params;d.tbsresp==null&&(d.tbsresp=new _ResponseData(d)),d.sighex==null&&d.reskey!=null&&this.sign();var p=[];if(p.push(d.tbsresp),p.push(new l({name:d.sigalg})),p.push(new s({hex:"00"+d.sighex})),d.certs!=null&&d.certs.length!=null){for(var m=[],f=0;f<d.certs.length;f++){var x=d.certs[f],b=null;if($.isASN1HEX(x))b=x;else if(x.match(/-----BEGIN/))b=xt(x);else throw new e("certs["+f+"] not hex or PEM");m.push(new r({tlv:b}))}var _=new i({array:m});p.push(new a({tag:"a0",explicit:!0,obj:_}))}var O=new i({array:p});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.BasicOCSPResponse,g.asn1.ASN1Object);g.asn1.ocsp.ResponseData=function(n){g.asn1.ocsp.ResponseData.superclass.constructor.call(this);var e=Error,t=g.asn1,r=t.DERSequence,i=t.DERGeneralizedTime,o=t.DERTaggedObject,a=t.x509.Extensions,s=t.ocsp,c=s.ResponderID;_SingleResponseList=s.SingleResponseList,this.params=null,this.tohex=function(){var l=this.params;l.respid!=null&&new e("respid not specified"),l.prodat!=null&&new e("prodat not specified"),l.array!=null&&new e("array not specified");var h=[];if(h.push(new c(l.respid)),h.push(new i(l.prodat)),h.push(new _SingleResponseList(l.array)),l.ext!=null){var u=new a(l.ext);h.push(new o({tag:"a1",explicit:!0,obj:u}))}var d=new r({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(l){this.params=l},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.ResponseData,g.asn1.ASN1Object);g.asn1.ocsp.ResponderID=function(n){g.asn1.ocsp.ResponderID.superclass.constructor.call(this);var e=g,t=e.asn1,r=t.ASN1Util.newObject,i=t.x509.X500Name,o=e.lang.String.isHex,a=Error;this.params=null,this.tohex=function(){var s=this.params;if(s.key!=null){var c=null;if(typeof s.key=="string"){if(o(s.key)&&(c=s.key),s.key.match(/-----BEGIN CERTIFICATE/)){var l=new he(s.key),h=l.getExtSubjectKeyIdentifier();h!=null&&(c=h.kid.hex)}}else if(s.key instanceof he){var h=s.key.getExtSubjectKeyIdentifier();h!=null&&(c=h.kid.hex)}if(c==null)throw new a("wrong key member value");var u=r({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:c}}}});return u.tohex()}else if(s.name!=null){var d=null;if(typeof s.name=="string"&&s.name.match(/-----BEGIN CERTIFICATE/)){var l=new he(s.name);d=l.getSubject()}else s.name instanceof he?d=s.name.getSubject():typeof s.name=="object"&&(s.name.array!=null||s.name.str!=null)&&(d=s.name);if(d==null)throw new a("wrong name member value");var u=r({tag:{tag:"a1",explicit:!0,obj:new i(d)}});return u.tohex()}throw new a("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(s){this.params=s},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.ResponderID,g.asn1.ASN1Object);g.asn1.ocsp.SingleResponseList=function(n){g.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var e=g.asn1,t=e.DERSequence,r=e.ocsp.SingleResponse;this.params=null,this.tohex=function(){var i=this.params;if(typeof i!="object"||i.length==null)throw new Error("params not specified properly");for(var o=[],a=0;a<i.length;a++)o.push(new r(i[a]));var s=new t({array:o});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.SingleResponseList,g.asn1.ASN1Object);g.asn1.ocsp.SingleResponse=function(n){var e=Error,t=g,r=t.asn1,i=r.DERSequence,o=r.DERGeneralizedTime,a=r.DERTaggedObject,s=r.ocsp,c=s.CertID,l=s.CertStatus,h=r.x509,u=h.Extensions;s.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,p=[];if(d.certid==null)throw new e("certid unspecified");if(d.status==null)throw new e("status unspecified");if(d.thisupdate==null)throw new e("thisupdate unspecified");if(p.push(new c(d.certid)),p.push(new l(d.status)),p.push(new o(d.thisupdate)),d.nextupdate!=null){var m=new o(d.nextupdate);p.push(new a({tag:"a0",explicit:!0,obj:m}))}if(d.ext!=null){var f=new u(d.ext);p.push(new a({tag:"a1",explicit:!0,obj:f}))}var x=new i({array:p});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.SingleResponse,g.asn1.ASN1Object);g.asn1.ocsp.CertID=function(n){var e=g,t=e.asn1,r=t.DEROctetString,i=t.DERInteger,o=t.DERSequence,a=t.x509,s=a.AlgorithmIdentifier,c=t.ocsp,l=c.DEFAULT_HASH,h=e.crypto,u=h.Util.hashHex,d=he,p=$,m=p.getVbyList;c.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(f,x,b,_){_==null&&(_=this.DEFAULT_HASH),this.params={alg:_,issname:f,isskey:x,sbjsn:b}},this.setByCert=function(f,x,b){b==null&&(b=this.DEFAULT_HASH),this.params={alg:b,issuerCert:f,subjectCert:x}},this.getParamByCerts=function(f,x,b){b==null&&(b=this.DEFAULT_HASH);var _=new d(f),O=new d(x),S=u(_.getSubjectHex(),b),E=_.getPublicKeyHex(),F=u(m(E,0,[1],"03",!0),b),I=O.getSerialNumberHex(),y={alg:b,issname:S,isskey:F,sbjsn:I};return y},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var f=this.params,x,b,_,O;if(f.alg==null?O=this.DEFAULT_HASH:O=f.alg,f.issuerCert!=null&&f.subjectCert!=null){var S=this.getParamByCerts(f.issuerCert,f.subjectCert,O);x=S.issname,b=S.isskey,_=S.sbjsn}else if(f.issname!=null&&f.isskey!=null&&f.sbjsn!=null)x=f.issname,b=f.isskey,_=f.sbjsn;else throw new Error("required param members not defined");var E=new s({name:O}),F=new r({hex:x}),I=new r({hex:b}),y=new i({hex:_}),P=new o({array:[E,F,I,y]});return this.hTLV=P.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.CertID,g.asn1.ASN1Object);g.asn1.ocsp.CertStatus=function(n){g.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(e.status=="good")return"8000";if(e.status=="unknown")return"8200";if(e.status=="revoked"){var t=[{gentime:{str:e.time}}];e.reason!=null&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var r={tag:"a1",explicit:!1,obj:{seq:t}};return g.asn1.ASN1Util.newObject({tag:r}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},n!==void 0&&this.setByParam(n)};U(g.asn1.ocsp.CertStatus,g.asn1.ASN1Object);g.asn1.ocsp.Request=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var a=[];if(this.dReqCert===null)throw"reqCert not set";a.push(this.dReqCert);var s=new r({array:a});return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof n<"u"){var o=new i.CertID(n);this.dReqCert=o}};U(g.asn1.ocsp.Request,g.asn1.ASN1Object);g.asn1.ocsp.TBSRequest=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(o){for(var a=[],s=0;s<o.length;s++){var c=new i.Request(o[0]);a.push(c)}this.dRequestList=a},this.tohex=function(){var o=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var a=new r({array:this.dRequestList});if(o.push(a),this.dRequestExt!==null)throw"requestExtensions not supported";var s=new r({array:o});return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&n.reqList!==void 0&&this.setRequestListByParam(n.reqList)};U(g.asn1.ocsp.TBSRequest,g.asn1.ASN1Object);g.asn1.ocsp.OCSPRequest=function(n){var e=g,t=e.asn1,r=t.DERSequence,i=t.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var a=[];if(this.dTbsRequest!==null)a.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var s=new r({array:a});return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},n!==void 0&&n.reqList!==void 0){var o=new i.TBSRequest(n);this.dTbsRequest=o}};U(g.asn1.ocsp.OCSPRequest,g.asn1.ASN1Object);g.asn1.ocsp.OCSPUtil={};g.asn1.ocsp.OCSPUtil.getRequestHex=function(n,e,t){var r=g,i=r.asn1,o=i.ocsp;t===void 0&&(t=o.DEFAULT_HASH);var a={alg:t,issuerCert:n,subjectCert:e},s=new o.OCSPRequest({reqList:[a]});return s.tohex()};g.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(n){var e=$,t=e.getVbyList,r=e.getVbyListEx,i=e.getIdxbyList,o=e.getIdxbyListEx,a=e.getV,s={};try{var c=r(n,0,[0],"0a");s.responseStatus=parseInt(c,16)}catch{}if(s.responseStatus!==0)return s;try{var l=i(n,0,[1,0,1,0,0,2,0,1]);n.substr(l,2)==="80"?s.certStatus="good":n.substr(l,2)==="a1"?(s.certStatus="revoked",s.revocationTime=Ve(t(n,l,[0]))):n.substr(l,2)==="82"&&(s.certStatus="unknown")}catch{}try{var h=i(n,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=Ve(a(n,h))}catch{}try{var u=i(n,0,[1,0,1,0,0,2,0,3]);n.substr(u,2)==="a0"&&(s.nextUpdate=Ve(t(n,u,[0])))}catch{}return s};g.asn1.ocsp.OCSPParser=function(){var n=Error,e=he,t=new e,r=$,i=r.getV,o=r.getTLV,a=r.getIdxbyList,s=r.getVbyList,c=r.getTLVbyList,l=r.getVbyListEx,h=r.getTLVbyListEx,u=r.getChildIdx;this.getOCSPRequest=function(d){var p=u(d,0);if(p.length!=1&&p.length!=2)throw new n("wrong number elements: "+p.length);var m=this.getTBSRequest(o(d,p[0]));return m},this.getTBSRequest=function(d){var p={},m=h(d,0,[0],"30");p.array=this.getRequestList(m);var f=h(d,0,["[2]",0],"30");return f!=null&&(p.ext=t.getExtParamArray(f)),p},this.getRequestList=function(d){for(var p=[],m=u(d,0),f=0;f<m.length;f++){var d=o(d,m[f]);p.push(this.getRequest(d))}return p},this.getRequest=function(d){var p=u(d,0);if(p.length!=1&&p.length!=2)throw new n("wrong number elements: "+p.length);var m=this.getCertID(o(d,p[0]));if(p.length==2){var f=a(d,0,[1,0]);m.ext=t.getExtParamArray(o(d,f))}return m},this.getCertID=function(d){var p=u(d,0);if(p.length!=4)throw new n("wrong number elements: "+p.length);var m=new e,f={};return f.alg=m.getAlgorithmIdentifierName(o(d,p[0])),f.issname=i(d,p[1]),f.isskey=i(d,p[2]),f.sbjsn=i(d,p[3]),f},this.getOCSPResponse=function(d){var p=u(d,0),m,f=i(d,p[0]),x=parseInt(f);if(p.length==1)return{resstatus:x};var b=c(d,0,[1,0]);return m=this.getResponseBytes(b),m.resstatus=x,m},this.getResponseBytes=function(d){var p=u(d,0),m,f=c(d,0,[1,0]);m=this.getBasicOCSPResponse(f);var x=i(d,p[0]);return m.restype=g.asn1.x509.OID.oid2name(_p(x)),m},this.getBasicOCSPResponse=function(d){var p=u(d,0),m;m=this.getResponseData(o(d,p[0]));var f=new he;m.alg=f.getAlgorithmIdentifierName(o(d,p[1]));var x=i(d,p[2]);m.sighex=x.substr(2);var b=l(d,0,["[0]"]);if(b!=null){for(var _=u(b,0),O=[],S=0;S<_.length;S++){var E=o(b,_[S]);O.push(E)}m.certs=O}return m},this.getResponseData=function(d){var p=u(d,0),m=p.length,f={},x=0;d.substr(p[0],2)=="a0"&&x++,f.respid=this.getResponderID(o(d,p[x++]));var b=i(d,p[x++]);if(f.prodat=Ve(b),f.array=this.getSingleResponseList(o(d,p[x++])),d.substr(p[m-1],2)=="a1"){var _=c(d,p[m-1],[0]),O=new he;f.ext=O.getExtParamArray(_)}return f},this.getResponderID=function(d){var p={};if(d.substr(0,2)=="a2"){var m=s(d,0,[0]);p.key=m}if(d.substr(0,2)=="a1"){var f=c(d,0,[0]),x=new he;p.name=x.getX500Name(f)}return p},this.getSingleResponseList=function(d){for(var p=u(d,0),m=[],f=0;f<p.length;f++){var x=this.getSingleResponse(o(d,p[f]));m.push(x)}return m},this.getSingleResponse=function(d){var p=u(d,0),m={},f=this.getCertID(o(d,p[0]));m.certid=f;var x=this.getCertStatus(o(d,p[1]));if(m.status=x,d.substr(p[2],2)=="18"){var b=i(d,p[2]);m.thisupdate=Ve(b)}for(var _=3;_<p.length;_++){if(d.substr(p[_],2)=="a0"){var O=s(d,p[_],[0],"18");m.nextupdate=Ve(O)}if(d.substr(p[_],2)=="a1"){var S=new he,E=c(d,0,[_,0]);m.ext=S.getExtParamArray(E)}}return m},this.getCertStatus=function(d){var p={};if(d=="8000")return{status:"good"};if(d=="8200")return{status:"unknown"};if(d.substr(0,2)=="a1"){p.status="revoked";var m=s(d,0,[0]),f=Ve(m);p.time=f}return p}};var g;(typeof g>"u"||!g)&&(g={});(typeof g.lang>"u"||!g.lang)&&(g.lang={});g.lang.String=function(){};function bk(n){for(var e=new Array,t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}function xk(n){for(var e="",t=0;t<n.length;t++)e=e+String.fromCharCode(n[t]);return e}function gp(n){for(var e="",t=0;t<n.length;t++){var r=n[t].toString(16);r.length==1&&(r="0"+r),e=e+r}return e}function zn(n){return gp(bk(n))}function _W(n){return Zr(zn(n))}function yW(n){return rs(Zr(zn(n)))}function CW(n){return xk(hk(cl(n)))}function rs(n){return n=n.replace(/\=/g,""),n=n.replace(/\+/g,"-"),n=n.replace(/\//g,"_"),n}function cl(n){return n.length%4==2?n=n+"==":n.length%4==3&&(n=n+"="),n=n.replace(/-/g,"+"),n=n.replace(/_/g,"/"),n}function Tt(n){return n.length%2==1&&(n="0"+n),rs(Zr(n))}function gt(n){return is(cl(n))}var al,gr;typeof Buffer=="function"?(al=function(n){return rs(Buffer.from(n,"utf8").toString("base64"))},gr=function(n){return Buffer.from(cl(n),"base64").toString("utf8")}):(al=function(n){return Tt(vp(xp(n)))},gr=function(n){return decodeURIComponent(bp(gt(n)))});function wW(n){return Zr(vp(xp(n)))}function PW(n){return decodeURIComponent(bp(is(n)))}function fp(n){return vp(xp(n)).toLowerCase()}function Ve(n){try{return decodeURIComponent(bp(n))}catch{return null}}function OW(n){return Ve(MW(n))}function MW(n){for(var e=n.match(/.{1,2}/g),t=[],r=0;r<e.length;r++){var i=parseInt(e[r],16);161<=i&&i<=191?(t.push("c2"),t.push(e[r])):192<=i&&i<=255?(t.push("c3"),t.push((i-64).toString(16))):t.push(e[r])}return t.join("")}function In(n){for(var e="",t=0;t<n.length-1;t+=2)e+=String.fromCharCode(parseInt(n.substr(t,2),16));return e}function Ir(n){for(var e="",t=0;t<n.length;t++)e+=("0"+n.charCodeAt(t).toString(16)).slice(-2);return e}function j0(n){return Zr(n)}function SW(n){return mp(j0(n),64)}function mp(n,e){return n=n.replace(new RegExp("(.{"+e+"})","g"),`$1\r
`),n=n.replace(/\s+$/,""),n}function _k(n){var e=n.replace(/[^0-9A-Za-z\/+=]*/g,""),t=is(e);return t}function EW(n,e){return"-----BEGIN "+e+`-----\r
`+mp(n,64)+`\r
-----END `+e+`-----\r
`}function un(n,e){return"-----BEGIN "+e+`-----\r
`+mp(j0(n),64)+`\r
-----END `+e+`-----\r
`}function xt(n,e){if(n.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return e!==void 0?(n=n.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),""),n=n.replace(new RegExp("-----END "+e+"-----[^]*$"),"")):(n=n.replace(/^[^]*-----BEGIN [^-]+-----/,""),n=n.replace(/-----END [^-]+-----[^]*$/,"")),_k(n)}function AW(n){return n.indexOf("-----BEGIN ")==-1||n.indexOf("-----END ")==-1?null:(n=n.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),n=n.replace(/-----END [\s\S]+$/m,""),n=n.replace(/\s+/g,""),n.match(/^[0-9a-zA-Z+/=]+$/)?n:null)}function kW(n){if(n.length%2!=0)throw"input is not even length";if(n.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var e=new ArrayBuffer(n.length/2),t=new DataView(e),r=0;r<n.length/2;r++)t.setUint8(r,parseInt(n.substr(r*2,2),16));return e}function DW(n){for(var e="",t=new DataView(n),r=0;r<n.byteLength;r++)e+=("00"+t.getUint8(r).toString(16)).slice(-2);return e}function V0(n){var e,t,r,i,o,a,s,c,l,h,u,d;if(n=Ck(n),d=n.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),d)return e=parseInt(d[1]),t=parseInt(d[2])-1,r=parseInt(d[3]),i=parseInt(d[4]),o=parseInt(d[5]),a=parseInt(d[6]),s=0,h=d[7],h!==""&&(u=(h.substr(1)+"00").substr(0,3),s=parseInt(u)),Date.UTC(e,t,r,i,o,a,s);throw new Error("unsupported zulu format: "+n)}function FW(n){var e=new Date(n),t=("0000"+e.getUTCFullYear()).slice(-4),r=("00"+(e.getUTCMonth()+1)).slice(-2),i=("00"+e.getUTCDate()).slice(-2),o=("00"+e.getUTCHours()).slice(-2),a=("00"+e.getUTCMinutes()).slice(-2),s=("00"+e.getUTCSeconds()).slice(-2),c=("000"+e.getUTCMilliseconds()).slice(-3);return c=c.replace(/0+$/,""),c=c!=""?"."+c:c,t+r+i+o+a+s+c+"Z"}function yk(n){return Math.round(V0(n)/1e3)}function TW(n){return new Date(V0(n))}function zW(n,e,t){var r,i=n.getUTCFullYear();if(e){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;r=(""+i).slice(-2)}else r=("000"+i).slice(-4);if(r+=("0"+(n.getUTCMonth()+1)).slice(-2),r+=("0"+n.getUTCDate()).slice(-2),r+=("0"+n.getUTCHours()).slice(-2),r+=("0"+n.getUTCMinutes()).slice(-2),r+=("0"+n.getUTCSeconds()).slice(-2),t){var o=n.getUTCMilliseconds();o!==0&&(o=("00"+o).slice(-3),o=o.replace(/0+$/g,""),r+="."+o)}return r+="Z",r}function Ck(n){return n.match(/^[0-9]{12}Z$/)||n.match(/^[0-9]{12}[.][0-9]*Z$/)?n.match(/^[0-4]/)?"20"+n:"19"+n:n}function vp(n){return n.replace(/%/g,"")}function bp(n){return n.replace(/(..)/g,"%$1")}function z0(n){var e="malformed IPv6 address";if(!n.match(/^[0-9A-Fa-f:]+$/))throw e;n=n.toLowerCase();var t=n.split(":").length-1;if(t<2)throw e;var r=":".repeat(7-t+2);n=n.replace("::",r);var i=n.split(":");if(i.length!=8)throw e;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function I0(n){if(!n.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+n);n=n.toLowerCase();var e=n.match(/.{1,4}/g);e=e.map(function(i){return i.replace(/^0+/,"")}),e=e.map(function(i){return i==""?"0":i}),n=":"+e.join(":")+":";var t=n.match(/:(0:){2,}/g);if(t==null)return n.slice(1,-1);var r=t.sort().slice(-1)[0];return n=n.replace(r.substr(0,r.length-1),":"),n.substr(0,2)!="::"&&(n=n.substr(1)),n.substr(-2,2)!="::"&&(n=n.substr(0,n.length-1)),n}function lp(n){var e=new Error("malformed hex value");if(!n.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(n.length==8){var t;try{return t=parseInt(n.substr(0,2),16)+"."+parseInt(n.substr(2,2),16)+"."+parseInt(n.substr(4,2),16)+"."+parseInt(n.substr(6,2),16),t}catch{throw e}}else if(n.length==16)try{return lp(n.substr(0,8))+"/"+dk(n.substr(8))}catch{throw e}else{if(n.length==32)return I0(n);if(n.length==64){try{return I0(n.substr(0,32))+"/"+dk(n.substr(32))}catch{throw e}return}else return n}}function dk(n){var e=new Error("malformed mask"),t;try{t=new B(n,16).toString(2)}catch{throw e}if(!t.match(/^1*0*$/))throw e;return t.replace(/0+$/,"").length}function H0(n){var e=new Error("malformed IP address");if(n=n.toLowerCase(n),!n.match(/^[0-9a-f.:/]+$/))throw e;if(n.match(/^[0-9.]+$/)){var t=n.split(".");if(t.length!==4)throw e;var r="";try{for(var i=0;i<4;i++){var o=parseInt(t[i]);r+=("0"+o.toString(16)).slice(-2)}return r}catch{throw e}}else if(n.match(/^[0-9.]+\/[0-9]+$/)){var a=n.split("/");return H0(a[0])+uk(parseInt(a[1]),32)}else{if(n.match(/^[0-9a-f:]+$/)&&n.indexOf(":")!==-1)return z0(n);if(n.match(/^[0-9a-f:]+\/[0-9]+$/)&&n.indexOf(":")!==-1){var a=n.split("/");return z0(a[0])+uk(parseInt(a[1]),128)}else throw e}}function uk(n,e){if(e==32&&n==0)return"00000000";if(e==128&&n==0)return"00000000000000000000000000000000";var t=Array(n+1).join("1")+Array(e-n+1).join("0");return new B(t,2).toString(16)}function U0(n){function e(i){var o=parseInt(i.substr(0,2),16),a=parseInt(i.substr(2),16);if(o==0&a<128)return String.fromCharCode(a);if(o<8){var s=192|(o&7)<<3|(a&192)>>6,c=128|a&63;return Ve(s.toString(16)+c.toString(16))}var s=224|(o&240)>>4,c=128|(o&15)<<2|(a&192)>>6,l=128|a&63;return Ve(s.toString(16)+c.toString(16)+l.toString(16))}var t=n.match(/.{4}/g),r=t.map(e);return r.join("")}function xp(n){for(var e=encodeURIComponent(n),t="",r=0;r<e.length;r++)e[r]=="%"?(t=t+e.substr(r,3),r=r+2):t=t+"%"+zn(e[r]);return t}function IW(n){return n=n.replace(/\r\n/mg,`
`),n}function RW(n){return n=n.replace(/\r\n/mg,`
`),n=n.replace(/\n/mg,`\r
`),n}g.lang.String.isInteger=function(n){return n.match(/^[0-9]+$/)?!0:!!n.match(/^-[0-9]+$/)};g.lang.String.isHex=function(n){return wk(n)};function wk(n){return!!(n.length%2==0&&(n.match(/^[0-9a-f]+$/)||n.match(/^[0-9A-F]+$/)))}g.lang.String.isBase64=function(n){return n=n.replace(/\s+/g,""),!!(n.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&n.length%4==0)};g.lang.String.isBase64URL=function(n){return n.match(/[+/=]/)?!1:(n=cl(n),g.lang.String.isBase64(n))};function G0(n){return!!n.match(/^[0-9A-Za-z-_.]+$/)}g.lang.String.isIntegerArray=function(n){return n=n.replace(/\s+/g,""),!!n.match(/^\[[0-9,]+\]$/)};g.lang.String.isPrintable=function(n){return n.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};g.lang.String.isIA5=function(n){return n.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};g.lang.String.isMail=function(n){return n.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function R0(n){return n.length%2==1?"0"+n:n.substr(0,1)>"7"?"00"+n:n}function NW(n){n=n.replace(/^\s*\[\s*/,""),n=n.replace(/\s*\]\s*$/,""),n=n.replace(/\s*/g,"");try{var e=n.split(/,/).map(function(t,r,i){var o=parseInt(t);if(o<0||255<o)throw"integer not in range 0-255";var a=("00"+o.toString(16)).slice(-2);return a}).join("");return e}catch(t){throw"malformed integer array string: "+t}}var BW=function(n,e){var t=n.length;n.length>e.length&&(t=e.length);for(var r=0;r<t;r++)if(n.charCodeAt(r)!=e.charCodeAt(r))return r;return n.length!=e.length?t:-1};function Pk(n){var e=function(s){var c=s.toString(16);return c.length==1&&(c="0"+c),c},t=function(s){var c="",l=parseInt(s,10),h=l.toString(2),u=7-h.length%7;u==7&&(u=0);for(var d="",p=0;p<u;p++)d+="0";h=d+h;for(var p=0;p<h.length-1;p+=7){var m=h.substr(p,7);p!=h.length-7&&(m="1"+m),c+=e(parseInt(m,2))}return c};try{if(!n.match(/^[0-9.]+$/))return null;var r="",i=n.split("."),o=parseInt(i[0],10)*40+parseInt(i[1],10);r+=e(o),i.splice(0,2);for(var a=0;a<i.length;a++)r+=t(i[a]);return r}catch{return null}}function _p(n){if(!wk(n))return null;try{var e=[],t=n.substr(0,2),r=parseInt(t,16);e[0]=new String(Math.floor(r/40)),e[1]=new String(r%40);for(var i=n.substr(2),o=[],a=0;a<i.length/2;a++)o.push(parseInt(i.substr(a*2,2),16));for(var s=[],c="",a=0;a<o.length;a++)o[a]&128?c=c+dp((o[a]&127).toString(2),7):(c=c+dp((o[a]&127).toString(2),7),s.push(new String(parseInt(c,2))),c="");var l=e.join(".");return s.length>0&&(l=l+"."+s.join(".")),l}catch{return null}}function Ok(n){var e=new B(String(n),10);return ll(e)}function ll(n){var e=n.toString(16);if(e.substr(0,1)!="-")return e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e),e;var t=e.substr(1),r=t.length;r%2==1?r+=1:e.match(/^[0-7]/)||(r+=2);for(var i="",o=0;o<r;o++)i+="f";var a=new B(i,16),s=a.xor(n).add(B.ONE);return e=s.toString(16).replace(/^-/,""),e}var dp=function(n,e,t){return t==null&&(t="0"),n.length>=e?n:new Array(e-n.length+1).join(t)+n};function Mk(n){if(n.length%2!=0||(n=n.toLowerCase(),n.match(/^[0-9a-f]+$/)==null))return-1;try{var e=n.substr(0,2);if(e=="00")return parseInt(n.substr(2),16);var t=parseInt(e,16);if(t>7)return-1;var r=n.substr(2),i=parseInt(r,16).toString(2);i=="0"&&(i="00000000"),i=i.slice(0,0-t);var o=parseInt(i,2);return o==NaN?-1:o}catch{return-1}}function Sk(n){if(typeof n!="number"||n<0)return null;var e=Number(n).toString(2),t=8-e.length%8;t==8&&(t=0),e=e+dp("",t,"0");var r=parseInt(e,2).toString(16);r.length%2==1&&(r="0"+r);var i="0"+t;return i+r}function Ek(n){if(typeof n!="string"||n.length%2!=0||!n.match(/^[0-9a-f]+$/))return null;try{var e=parseInt(n.substr(0,2),16);if(e<0||7<e)return null;for(var t=n.substr(2),r="",i=0;i<t.length;i+=2){var o=t.substr(i,2),a=parseInt(o,16).toString(2);a=("0000000"+a).slice(-8),r+=a}return r.substr(0,r.length-e)}catch{return null}}function qW(n){if(typeof n!="string"||n.match(/^[01]+$/)==null)return null;try{var e=parseInt(n,2);return Sk(e)}catch{return null}}function up(n,e){for(var t=0,r=0;r<n.length;r++)t|=1<<e[n[r]];for(var i=t.toString(2),o="",r=i.length-1;r>=0;r--)o+=i[r];return o}function et(n,r,t){if(typeof n=="object"){for(var r=String(r).split("."),i=0;i<r.length&&n;i++){var o=r[i];o.match(/^[0-9]+$/)&&(o=parseInt(o)),n=n[o]}return n||n===!1?n:t}}function U(n,e){var t=function(){};t.prototype=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)}(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:Q.algo.MD5,sha1:Q.algo.SHA1,sha224:Q.algo.SHA224,sha256:Q.algo.SHA256,sha384:Q.algo.SHA384,sha512:Q.algo.SHA512,ripemd160:Q.algo.RIPEMD160},this.getDigestInfoHex=function(n,e){if(typeof this.DIGESTINFOHEAD[e]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+n},this.getPaddedDigestInfoHex=function(n,e,t){var r=this.getDigestInfoHex(n,e),i=t/4;if(r.length+22>i)throw"key is too short for SigAlg: keylen="+t+","+e;for(var o="0001",a="00"+r,s="",c=i-o.length-a.length,l=0;l<c;l+=2)s+="ff";var h=o+s+a;return h},this.hashString=function(n,e){var t=new g.crypto.MessageDigest({alg:e});return t.digestString(n)},this.hashHex=function(n,e){var t=new g.crypto.MessageDigest({alg:e});return t.digestHex(n)},this.sha1=function(n){return this.hashString(n,"sha1")},this.sha256=function(n){return this.hashString(n,"sha256")},this.sha256Hex=function(n){return this.hashHex(n,"sha256")},this.sha512=function(n){return this.hashString(n,"sha512")},this.sha512Hex=function(n){return this.hashHex(n,"sha512")},this.isKey=function(n){return n instanceof ve||n instanceof g.crypto.DSA||n instanceof g.crypto.ECDSA}};g.crypto.Util.md5=function(n){var e=new g.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return e.digestString(n)};g.crypto.Util.ripemd160=function(n){var e=new g.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return e.digestString(n)};g.crypto.Util.SECURERANDOMGEN=new ss;g.crypto.Util.getRandomHexOfNbytes=function(n){var e=new Array(n);return g.crypto.Util.SECURERANDOMGEN.nextBytes(e),gp(e)};g.crypto.Util.getRandomBigIntegerOfNbytes=function(n){return new B(g.crypto.Util.getRandomHexOfNbytes(n),16)};g.crypto.Util.getRandomHexOfNbits=function(n){var e=n%8,t=(n-e)/8,r=new Array(t+1);return g.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<e&255^255)&r[0],gp(r)};g.crypto.Util.getRandomBigIntegerOfNbits=function(n){return new B(g.crypto.Util.getRandomHexOfNbits(n),16)};g.crypto.Util.getRandomBigIntegerZeroToMax=function(n){for(var e=n.bitLength();;){var t=g.crypto.Util.getRandomBigIntegerOfNbits(e);if(n.compareTo(t)!=-1)return t}};g.crypto.Util.getRandomBigIntegerMinToMax=function(n,e){var t=n.compareTo(e);if(t==1)throw"biMin is greater than biMax";if(t==0)return n;var r=e.subtract(n),i=g.crypto.Util.getRandomBigIntegerZeroToMax(r);return i.add(n)};g.crypto.MessageDigest=function(n){var e=null,t=null,r=null;this.setAlgAndProvider=function(i,o){if(i=g.crypto.MessageDigest.getCanonicalAlgName(i),i!==null&&o===void 0&&(o=g.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&o=="cryptojs"){try{this.md=g.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var s=Q.enc.Hex.parse(a);this.md.update(s)},this.digest=function(){var a=this.md.finalize();return a.toString(Q.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(":sha256:".indexOf(i)!=-1&&o=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var s=sjcl.codec.hex.toBits(a);this.md.update(s)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},n!==void 0&&n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0&&(this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};g.crypto.MessageDigest.getCanonicalAlgName=function(n){return typeof n=="string"&&(n=n.toLowerCase(),n=n.replace(/-/,"")),n};g.crypto.MessageDigest.getHashLength=function(n){var e=g.crypto.MessageDigest,t=e.getCanonicalAlgName(n);if(e.HASHLENGTH[t]===void 0)throw"not supported algorithm: "+n;return e.HASHLENGTH[t]};g.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};g.crypto.Mac=function(n){var e=null,t=null,r=null,i=null,o=null;this.setAlgAndProvider=function(a,s){if(a=a.toLowerCase(),a==null&&(a="hmacsha1"),a=a.toLowerCase(),a.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+a;s===void 0&&(s=g.crypto.Util.DEFAULTPROVIDER[a]),this.algProv=a+"/"+s;var c=a.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&s=="cryptojs"){try{var l=g.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c];this.mac=Q.algo.HMAC.create(l,this.pass)}catch(h){throw"setAlgAndProvider hash alg set fail hashAlg="+c+"/"+h}this.updateString=function(h){this.mac.update(h)},this.updateHex=function(h){var u=Q.enc.Hex.parse(h);this.mac.update(u)},this.doFinal=function(){var h=this.mac.finalize();return h.toString(Q.enc.Hex)},this.doFinalString=function(h){return this.updateString(h),this.doFinal()},this.doFinalHex=function(h){return this.updateHex(h),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(a){if(typeof a=="string"){var s=a;(a.length%2==1||!a.match(/^[0-9A-Fa-f]+$/))&&(s=Ir(a)),this.pass=Q.enc.Hex.parse(s);return}if(typeof a!="object")throw"KJUR.crypto.Mac unsupported password type: "+a;var s=null;if(a.hex!==void 0){if(a.hex.length%2!=0||!a.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+a.hex;s=a.hex}if(a.utf8!==void 0&&(s=fp(a.utf8)),a.rstr!==void 0&&(s=Ir(a.rstr)),a.b64!==void 0&&(s=is(a.b64)),a.b64u!==void 0&&(s=gt(a.b64u)),s==null)throw"KJUR.crypto.Mac unsupported password type: "+a;this.pass=Q.enc.Hex.parse(s)},n!==void 0&&(n.pass!==void 0&&this.setPassword(n.pass),n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0&&(this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};g.crypto.Signature=function(n){var e=null,t=null,r=null,i=null,o=null,a=null,s=null,c=null,l=null,h=null,u=-1,d=null,p=null,m=null,f=null,x=null;if(this._setAlgNames=function(){var b=this.algName.match(/^(.+)with(.+)$/);b&&(this.mdAlgName=b[1].toLowerCase(),this.pubkeyAlgName=b[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(b,_){for(var O="",S=_/4-b.length,E=0;E<S;E++)O=O+"0";return O+b},this.setAlgAndProvider=function(b,_){if(this._setAlgNames(),_!="cryptojs/jsrsa")throw new Error("provider not supported: "+_);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new g.crypto.MessageDigest({alg:this.mdAlgName})}catch(O){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+O)}this.init=function(O,S){var E=null;try{S===void 0?E=Se.getKey(O):E=Se.getKey(O,S)}catch(F){throw"init failed:"+F}if(E.isPrivate===!0)this.prvKey=E,this.state="SIGN";else if(E.isPublic===!0)this.pubKey=E,this.state="VERIFY";else throw"init failed.:"+E},this.updateString=function(O){this.md.updateString(O)},this.updateHex=function(O){this.md.updateHex(O)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&g.crypto.ECDSA!==void 0&&(this.prvKey=new g.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ve&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof g.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof g.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(O){return this.updateString(O),this.sign()},this.signHex=function(O){return this.updateHex(O),this.sign()},this.verify=function(O){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&g.crypto.ECDSA!==void 0&&(this.pubKey=new g.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,O,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ve&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,O);if(g.crypto.ECDSA!==void 0&&this.pubKey instanceof g.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,O);if(g.crypto.DSA!==void 0&&this.pubKey instanceof g.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,O);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(b,_){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(b){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(b){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(b){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(b){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(b){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=n,n!==void 0&&(n.alg!==void 0&&(this.algName=n.alg,n.prov===void 0?this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=n.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),n.psssaltlen!==void 0&&(this.pssSaltLen=n.psssaltlen),n.prvkeypem!==void 0)){if(n.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var e=Se.getKey(n.prvkeypem);this.init(e)}catch(b){throw"fatal error to load pem private key: "+b}}};g.crypto.Cipher=function(n){};g.crypto.Cipher.encrypt=function(n,e,t,r){if(et(r,"enclag")!=null&&(t=r.encalg),typeof t=="string"&&t.substr(-4)=="-CBC"){var i=e,o=n;et(r,"key")!=null&&(i=r.key),et(r,"enc")!=null&&(hEnc=r.enc);var a=Q.enc.Hex.parse(i),s=Q.enc.Hex.parse(o),c=Q.enc.Hex.parse(r.iv),l;if(t=="des-EDE3-CBC")l=Q.TripleDES.encrypt(s,a,{iv:c});else if(t=="aes128-CBC"||t=="aes256-CBC")l=Q.AES.encrypt(s,a,{iv:c});else throw new Error("unsupported algorithm: "+t);return l+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")};g.crypto.Cipher.decrypt=function(n,e,t,r){if(et(r,"enclag")!=null&&(t=r.encalg),typeof t=="string"&&t.substr(-4)=="-CBC"){var i=e,o=n;et(r,"key")!=null&&(i=r.key),et(r,"enc")!=null&&(o=r.enc);var a=Q.enc.Hex.parse(i),s=Q.enc.Hex.parse(o),c=Q.enc.Hex.parse(r.iv),l;if(t=="des-EDE3-CBC")l=Q.TripleDES.decrypt({ciphertext:s},a,{iv:c});else if(t=="aes128-CBC"||t=="aes256-CBC")l=Q.AES.decrypt({ciphertext:s},a,{iv:c});else throw new Error("unsupported algorithm: "+t);return Q.enc.Hex.stringify(l)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")};g.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.ECDSA=function(n){var e="secp256r1",t=null,r=null,i=null,o=Error,a=B,s=qe,c=g.crypto.ECDSA,l=g.crypto.ECParameterDB,h=c.getName,u=$,d=u.getVbyListEx,p=u.isASN1HEX,m=new ss,f=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function x(b,_,O,S){for(var E=Math.max(_.bitLength(),S.bitLength()),F=b.add2D(O),I=b.curve.getInfinity(),y=E-1;y>=0;--y)I=I.twice2D(),I.z=a.ONE,_.testBit(y)?S.testBit(y)?I=I.add2D(F):I=I.add2D(b):S.testBit(y)&&(I=I.add2D(O));return I}this.getBigRandom=function(b){return new a(b.bitLength(),m).mod(b.subtract(a.ONE)).add(a.ONE)},this.setNamedCurve=function(b){this.ecparams=l.getByName(b),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=b},this.setPrivateKeyHex=function(b){this.isPrivate=!0,this.prvKeyHex=b},this.setPublicKeyHex=function(b){this.isPublic=!0,this.pubKeyHex=b},this.getPublicKeyXYHex=function(){var b=this.pubKeyHex;if(b.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var _=this.ecparams.keycharlen;if(b.length!==2+_*2)throw"malformed public key hex length";var O={};return O.x=b.substr(2,_),O.y=b.substr(2+_),O},this.getShortNISTPCurveName=function(){var b=this.curveName;return b==="secp256r1"||b==="NIST P-256"||b==="P-256"||b==="prime256v1"?"P-256":b==="secp384r1"||b==="NIST P-384"||b==="P-384"?"P-384":b==="secp521r1"||b==="NIST P-521"||b==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var b=this.ecparams.n,_=this.getBigRandom(b),O=this.ecparams.keycharlen,S=("0000000000"+_.toString(16)).slice(-O);this.setPrivateKeyHex(S);var E=this.generatePublicKeyHex();return{ecprvhex:S,ecpubhex:E}},this.generatePublicKeyHex=function(){var b=new a(this.prvKeyHex,16),_=this.ecparams.G.multiply(b),O=_.getX().toBigInteger(),S=_.getY().toBigInteger(),E=this.ecparams.keycharlen,F=("0000000000"+O.toString(16)).slice(-E),I=("0000000000"+S.toString(16)).slice(-E),y="04"+F+I;return this.setPublicKeyHex(y),y},this.signWithMessageHash=function(b){return this.signHex(b,this.prvKeyHex)},this.signHex=function(b,_){var O=new a(_,16),S=this.ecparams.n,E=new a(b.substring(0,this.ecparams.keycharlen),16);do var F=this.getBigRandom(S),I=this.ecparams.G,y=I.multiply(F),P=y.getX().toBigInteger().mod(S);while(P.compareTo(a.ZERO)<=0);var C=F.modInverse(S).multiply(E.add(O.multiply(P))).mod(S);return c.biRSSigToASN1Sig(P,C)},this.sign=function(b,_){var O=_,S=this.ecparams.n,E=a.fromByteArrayUnsigned(b);do var F=this.getBigRandom(S),I=this.ecparams.G,y=I.multiply(F),P=y.getX().toBigInteger().mod(S);while(P.compareTo(B.ZERO)<=0);var C=F.modInverse(S).multiply(E.add(O.multiply(P))).mod(S);return this.serializeSig(P,C)},this.verifyWithMessageHash=function(b,_){return this.verifyHex(b,_,this.pubKeyHex)},this.verifyHex=function(b,_,O){try{var S,E,F=c.parseSigHex(_);S=F.r,E=F.s;var I=s.decodeFromHex(this.ecparams.curve,O),y=new a(b.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(y,S,E,I)}catch{return!1}},this.verify=function(b,_,O){var S,E;if(Bitcoin.Util.isArray(_)){var F=this.parseSig(_);S=F.r,E=F.s}else if(typeof _=="object"&&_.r&&_.s)S=_.r,E=_.s;else throw"Invalid value for signature";var I;if(O instanceof qe)I=O;else if(Bitcoin.Util.isArray(O))I=s.decodeFrom(this.ecparams.curve,O);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var y=a.fromByteArrayUnsigned(b);return this.verifyRaw(y,S,E,I)},this.verifyRaw=function(b,_,O,S){var E=this.ecparams.n,F=this.ecparams.G;if(_.compareTo(a.ONE)<0||_.compareTo(E)>=0||O.compareTo(a.ONE)<0||O.compareTo(E)>=0)return!1;var I=O.modInverse(E),y=b.multiply(I).mod(E),P=_.multiply(I).mod(E),C=F.multiply(y).add(S.multiply(P)),M=C.getX().toBigInteger().mod(E);return M.equals(_)},this.serializeSig=function(b,_){var O=b.toByteArraySigned(),S=_.toByteArraySigned(),E=[];return E.push(2),E.push(O.length),E=E.concat(O),E.push(2),E.push(S.length),E=E.concat(S),E.unshift(E.length),E.unshift(48),E},this.parseSig=function(b){var _;if(b[0]!=48)throw new Error("Signature not a valid DERSequence");if(_=2,b[_]!=2)throw new Error("First element in signature must be a DERInteger");var O=b.slice(_+2,_+2+b[_+1]);if(_+=2+b[_+1],b[_]!=2)throw new Error("Second element in signature must be a DERInteger");var S=b.slice(_+2,_+2+b[_+1]);_+=2+b[_+1];var E=a.fromByteArrayUnsigned(O),F=a.fromByteArrayUnsigned(S);return{r:E,s:F}},this.parseSigCompact=function(b){if(b.length!==65)throw"Signature has the wrong length";var _=b[0]-27;if(_<0||_>7)throw"Invalid signature type";var O=this.ecparams.n,S=a.fromByteArrayUnsigned(b.slice(1,33)).mod(O),E=a.fromByteArrayUnsigned(b.slice(33,65)).mod(O);return{r:S,s:E,i:_}},this.readPKCS5PrvKeyHex=function(b){if(p(b)===!1)throw new Error("not ASN.1 hex string");var _,O,S;try{_=d(b,0,["[0]",0],"06"),O=d(b,0,[1],"04");try{S=d(b,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=h(_),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(S),this.setPrivateKeyHex(O),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(b){if(p(b)===!1)throw new o("not ASN.1 hex string");var _,O,S,E;try{_=d(b,0,[1,0],"06"),O=d(b,0,[1,1],"06"),S=d(b,0,[2,0,1],"04");try{E=d(b,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new o("malformed PKCS#8 plain ECC private key")}if(this.curveName=h(O),this.curveName===void 0)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E),this.setPrivateKeyHex(S),this.isPublic=!1},this.readPKCS8PubKeyHex=function(b){if(p(b)===!1)throw new o("not ASN.1 hex string");var _,O,S;try{_=d(b,0,[0,0],"06"),O=d(b,0,[0,1],"06"),S=d(b,0,[1],"03")}catch{throw new o("malformed PKCS#8 ECC public key")}if(this.curveName=h(O),this.curveName===null)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(S)},this.readCertPubKeyHex=function(b,_){if(p(b)===!1)throw new o("not ASN.1 hex string");var O,S;try{O=d(b,0,[0,5,0,1],"06"),S=d(b,0,[0,5,1],"03")}catch{throw new o("malformed X.509 certificate ECC public key")}if(this.curveName=h(O),this.curveName===null)throw new o("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(S)},n!==void 0&&n.curve!==void 0&&(this.curveName=n.curve),this.curveName===void 0&&(this.curveName=e),this.setNamedCurve(this.curveName),n!==void 0&&(n.prv!==void 0&&this.setPrivateKeyHex(n.prv),n.pub!==void 0&&this.setPublicKeyHex(n.pub))};g.crypto.ECDSA.parseSigHex=function(n){var e=g.crypto.ECDSA.parseSigHexInHexRS(n),t=new B(e.r,16),r=new B(e.s,16);return{r:t,s:r}};g.crypto.ECDSA.parseSigHexInHexRS=function(n){var e=$,t=e.getChildIdx,r=e.getV;if(e.checkStrictDER(n,0),n.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var i=t(n,0);if(i.length!=2)throw new Error("signature shall have two elements");var o=i[0],a=i[1];if(n.substr(o,2)!="02")throw new Error("1st item not ASN.1 integer");if(n.substr(a,2)!="02")throw new Error("2nd item not ASN.1 integer");var s=r(n,o),c=r(n,a);return{r:s,s:c}};g.crypto.ECDSA.asn1SigToConcatSig=function(n){var e=g.crypto.ECDSA.parseSigHexInHexRS(n),t=e.r,r=e.s;if(t.length>=130&&t.length<=134){if(t.length%2!=0)throw Error("unknown ECDSA sig r length error");if(r.length%2!=0)throw Error("unknown ECDSA sig s length error");t.substr(0,2)=="00"&&(t=t.substr(2)),r.substr(0,2)=="00"&&(r=r.substr(2));var i=Math.max(t.length,r.length);return t=("000000"+t).slice(-i),r=("000000"+r).slice(-i),t+r}if(t.substr(0,2)=="00"&&t.length%32==2&&(t=t.substr(2)),r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),t.length%32==30&&(t="00"+t),r.length%32==30&&(r="00"+r),t.length%32!=0)throw Error("unknown ECDSA sig r length error");if(r.length%32!=0)throw Error("unknown ECDSA sig s length error");return t+r};g.crypto.ECDSA.concatSigToASN1Sig=function(n){if(n.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var e=n.substr(0,n.length/2),t=n.substr(n.length/2);return g.crypto.ECDSA.hexRSSigToASN1Sig(e,t)};g.crypto.ECDSA.hexRSSigToASN1Sig=function(n,e){var t=new B(n,16),r=new B(e,16);return g.crypto.ECDSA.biRSSigToASN1Sig(t,r)};g.crypto.ECDSA.biRSSigToASN1Sig=function(n,e){var t=g.asn1,r=new t.DERInteger({bigint:n}),i=new t.DERInteger({bigint:e}),o=new t.DERSequence({array:[r,i]});return o.tohex()};g.crypto.ECDSA.getName=function(n){return n==="2b8104001f"?"secp192k1":n==="2a8648ce3d030107"?"secp256r1":n==="2b8104000a"?"secp256k1":n==="2b81040021"?"secp224r1":n==="2b81040022"?"secp384r1":n==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(n)!==-1?"secp256r1":"|secp256k1|".indexOf(n)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(n)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(n)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(n)!==-1?"secp521r1":null};(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.ECParameterDB=new function(){var n={},e={};function t(r){return new B(r,16)}this.getByName=function(r){var i=r;if(typeof e[i]<"u"&&(i=e[r]),typeof n[i]<"u")return n[i];throw"unregistered EC curve name: "+i},this.regist=function(r,i,o,a,s,c,l,h,u,d,p,m){n[r]={};var f=t(o),x=t(a),b=t(s),_=t(c),O=t(l),S=new ei(f,x,b),E=S.decodePointHex("04"+h+u);n[r].name=r,n[r].keylen=i,n[r].keycharlen=Math.ceil(i/8)*2,n[r].curve=S,n[r].G=E,n[r].n=_,n[r].h=O,n[r].oid=p,n[r].info=m;for(var F=0;F<d.length;F++)e[d[F]]=r}};g.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");g.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");g.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");g.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);g.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);g.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);g.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);g.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);g.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);g.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.DSA=function(){var n=$,e=n.getVbyList,t=n.getVbyListEx,r=n.isASN1HEX,i=B;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(o,a,s,c,l){this.isPrivate=!0,this.p=o,this.q=a,this.g=s,this.y=c,this.x=l},this.setPrivateHex=function(o,a,s,c,l){var h,u,d,p,m;h=new B(o,16),u=new B(a,16),d=new B(s,16),typeof c=="string"&&c.length>1?p=new B(c,16):p=null,m=new B(l,16),this.setPrivate(h,u,d,p,m)},this.setPublic=function(o,a,s,c){this.isPublic=!0,this.p=o,this.q=a,this.g=s,this.y=c,this.x=null},this.setPublicHex=function(o,a,s,c){var l,h,u,d;l=new B(o,16),h=new B(a,16),u=new B(s,16),d=new B(c,16),this.setPublic(l,h,u,d)},this.signWithMessageHash=function(o){var a=this.p,s=this.q,c=this.g,l=this.y,h=this.x,u=g.crypto.Util.getRandomBigIntegerMinToMax(B.ONE.add(B.ONE),s.subtract(B.ONE)),d=o.substr(0,s.bitLength()/4),p=new B(d,16),m=c.modPow(u,a).mod(s),f=u.modInverse(s).multiply(p.add(h.multiply(m))).mod(s),x=g.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:m}},{int:{bigint:f}}]});return x},this.verifyWithMessageHash=function(o,a){var s=this.p,c=this.q,l=this.g,h=this.y,u=this.parseASN1Signature(a),d=u[0],p=u[1],m=o.substr(0,c.bitLength()/4),f=new B(m,16);if(B.ZERO.compareTo(d)>0||d.compareTo(c)>0||B.ZERO.compareTo(p)>=0||p.compareTo(c)>0)throw"invalid DSA signature";var x=p.modInverse(c),b=f.multiply(x).mod(c),_=d.multiply(x).mod(c),O=l.modPow(b,s).multiply(h.modPow(_,s)).mod(s).mod(c);return O.compareTo(d)==0},this.parseASN1Signature=function(o){try{var a=new i(t(o,0,[0],"02"),16),s=new i(t(o,0,[1],"02"),16);return[a,s]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(o){var a,s,c,l,h;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{a=t(o,0,[1],"02"),s=t(o,0,[2],"02"),c=t(o,0,[3],"02"),l=t(o,0,[4],"02"),h=t(o,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(a,s,c,l,h)},this.readPKCS8PrvKeyHex=function(o){var a,s,c,l;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{a=t(o,0,[1,1,0],"02"),s=t(o,0,[1,1,1],"02"),c=t(o,0,[1,1,2],"02"),l=t(o,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(a,s,c,null,l)},this.readPKCS8PubKeyHex=function(o){var a,s,c,l;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{a=t(o,0,[0,1,0],"02"),s=t(o,0,[0,1,1],"02"),c=t(o,0,[0,1,2],"02"),l=t(o,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(a,s,c,l)},this.readCertPubKeyHex=function(o,a){var s,c,l,h;if(r(o)===!1)throw new Error("not ASN.1 hex string");try{s=t(o,0,[0,5,0,1,0],"02"),c=t(o,0,[0,5,0,1,1],"02"),l=t(o,0,[0,5,0,1,2],"02"),h=t(o,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(s,c,l,h)}};var Se=function(){var n=function(f,x,b){return r(Q.AES,f,x,b)},e=function(f,x,b){return r(Q.TripleDES,f,x,b)},t=function(f,x,b){return r(Q.DES,f,x,b)},r=function(f,x,b,_){var O=Q.enc.Hex.parse(x),S=Q.enc.Hex.parse(b),E=Q.enc.Hex.parse(_),F={};F.key=S,F.iv=E,F.ciphertext=O;var I=f.decrypt(F,S,{iv:E});return Q.enc.Hex.stringify(I)},i=function(f,x,b){return s(Q.AES,f,x,b)},o=function(f,x,b){return s(Q.TripleDES,f,x,b)},a=function(f,x,b){return s(Q.DES,f,x,b)},s=function(f,x,b,_){var O=Q.enc.Hex.parse(x),S=Q.enc.Hex.parse(b),E=Q.enc.Hex.parse(_),F=f.encrypt(O,S,{iv:E}),I=Q.enc.Hex.parse(F.toString()),y=Q.enc.Base64.stringify(I);return y},c={"AES-256-CBC":{proc:n,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:n,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:n,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:o,keylen:24,ivlen:8},"DES-CBC":{proc:t,eproc:a,keylen:8,ivlen:8}},l=function(f){return c[f].proc},h=function(f){var x=Q.lib.WordArray.random(f),b=Q.enc.Hex.stringify(x);return b},u=function(f){var x={},b=f.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));b&&(x.cipher=b[1],x.ivsalt=b[2]);var _=f.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));_&&(x.type=_[1]);var O=-1,S=0;f.indexOf(`\r
\r
`)!=-1&&(O=f.indexOf(`\r
\r
`),S=2),f.indexOf(`

`)!=-1&&(O=f.indexOf(`

`),S=1);var E=f.indexOf("-----END");if(O!=-1&&E!=-1){var F=f.substring(O+S*2,E-S);F=F.replace(/\s+/g,""),x.data=F}return x},d=function(f,x,b){for(var _=b.substring(0,16),O=Q.enc.Hex.parse(_),S=Q.enc.Utf8.parse(x),E=c[f].keylen+c[f].ivlen,F="",I=null;;){var y=Q.algo.MD5.create();if(I!=null&&y.update(I),y.update(S),y.update(O),I=y.finalize(),F=F+Q.enc.Hex.stringify(I),F.length>=E*2)break}var P={};return P.keyhex=F.substr(0,c[f].keylen*2),P.ivhex=F.substr(c[f].keylen*2,c[f].ivlen*2),P},p=function(f,x,b,_){var O=Q.enc.Base64.parse(f),S=Q.enc.Hex.stringify(O),E=c[x].proc,F=E(S,b,_);return F},m=function(f,x,b,_){var O=c[x].eproc,S=O(f,b,_);return S};return{version:"1.0.0",parsePKCS5PEM:function(f){return u(f)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(f,x,b){return d(f,x,b)},decryptKeyB64:function(f,x,b,_){return p(f,x,b,_)},getDecryptedKeyHex:function(f,x){var b=u(f),_=b.type,O=b.cipher,S=b.ivsalt,E=b.data,F=d(O,x,S),I=F.keyhex,y=p(E,O,I,S);return y},getEncryptedPKCS5PEMFromPrvKeyHex:function(f,x,b,_,O){var C="";if((typeof _>"u"||_==null)&&(_="AES-256-CBC"),typeof c[_]>"u")throw new Error("KEYUTIL unsupported algorithm: "+_);if(typeof O>"u"||O==null){var S=c[_].ivlen,E=h(S);O=E.toUpperCase()}var F=d(_,b,O),I=F.keyhex,y=m(x,_,I,O),P=y.replace(/(.{64})/g,`$1\r
`),C="-----BEGIN "+f+` PRIVATE KEY-----\r
`;return C+=`Proc-Type: 4,ENCRYPTED\r
`,C+="DEK-Info: "+_+","+O+`\r
`,C+=`\r
`,C+=P,C+=`\r
-----END `+f+` PRIVATE KEY-----\r
`,C},getEncryptedPKCS8PEM:function(f,x,b){var _=this.getEncryptedPKCS8Hex(f,x,b);return un(_,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(f,x,b){var _;b==null||b==null?_={}:_=JSON.parse(JSON.stringify(b)),_.plain=f,this.initPBES2Param(_),this.encryptPBES2Param(_,x);var O=this.generatePBES2ASN1Param(_);return g.asn1.ASN1Util.newObject(O).tohex()},initPBES2Param:function(f){if(et(f,"encalg")==null&&(f.encalg="aes256-CBC"),et(f,"iter")==null&&(f.iter=2048),et(f,"prf")==null&&(f.prf="hmacWithSHA256"),et(f,"salt")==null&&(f.salt=Q.enc.Hex.stringify(Q.lib.WordArray.random(8))),et(f,"enciv")==null){var x;f.encalg=="des-EDE3-CBC"&&(x=8),f.encalg=="aes128-CBC"&&(x=16),f.encalg=="aes256-CBC"&&(x=16),f.enciv=Q.enc.Hex.stringify(Q.lib.WordArray.random(x))}},encryptPBES2Param:function(f,x){var b=Se.getDKFromPBES2Param(f,x);try{var _=g.crypto.Cipher.encrypt(f.plain,b,f.encalg,{iv:f.enciv})}catch{throw new Error("encrypt error: "+f.plain+" "+b+" "+f.encalg+" "+f.enciv)}f.enc=_},generatePBES2ASN1Param:function(f){var x={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:f.salt}},{int:{hex:Ok(f.iter)}}]}]},{seq:[{oid:f.encalg},{octstr:{hex:f.enciv}}]}]}]},{octstr:{hex:f.enc}}]};return f.prf!="hmacWithSHA1"&&x.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:f.prf},{null:""}]}),x},parseHexOfEncryptedPKCS8:function(f){var x=$,b=x.getChildIdx,_=x.getV,O={},S=b(f,0);if(S.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+S.length);O.ciphertext=_(f,S[1]);var E=b(f,S[0]);if(E.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+E.length);if(_(f,E[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var F=b(f,E[1]);if(E.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+F.length);var I=b(f,F[1]);if(I.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+I.length);if(_(f,I[0])!="2a864886f70d0307")throw"this only supports TripleDES";O.encryptionSchemeAlg="TripleDES",O.encryptionSchemeIV=_(f,I[1]);var y=b(f,F[0]);if(y.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+y.length);if(_(f,y[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var P=b(f,y[1]);if(P.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+P.length);O.pbkdf2Salt=_(f,P[0]);var C=_(f,P[1]);try{O.pbkdf2Iter=parseInt(C,16)}catch{throw new Error("malformed format pbkdf2Iter: "+C)}return O},getPBKDF2KeyHexFromParam:function(f,x){var b=Q.enc.Hex.parse(f.pbkdf2Salt),_=f.pbkdf2Iter,O=Q.PBKDF2(x,b,{keySize:192/32,iterations:_}),S=Q.enc.Hex.stringify(O);return S},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(f,x){var b=xt(f,"ENCRYPTED PRIVATE KEY"),_=this.parseHexOfEncryptedPKCS8(b),O=Se.getPBKDF2KeyHexFromParam(_,x),S={};S.ciphertext=Q.enc.Hex.parse(_.ciphertext);var E=Q.enc.Hex.parse(O),F=Q.enc.Hex.parse(_.encryptionSchemeIV),I=Q.TripleDES.decrypt(S,E,{iv:F}),y=Q.enc.Hex.stringify(I);return y},parsePBES2:function(f){var x=$.parse(f);if(et(x,"seq.0.seq.0.oid")!="pkcs5PBES2"||et(x,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var b=et(x,"seq.0.seq.1.seq.0.seq.1.seq");if(b==null)throw new Error("PBKDF2 parameter not found");var _=et(b,"0.octstr.hex"),O=et(b,"1.int.hex"),S=et(b,"2.seq.0.oid","hmacWithSHA1"),E=-1;try{E=parseInt(O,16)}catch{throw new Error("iter not proper value")}var F=et(x,"seq.0.seq.1.seq.1.seq.0.oid"),I=et(x,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),y=et(x,"seq.1.octstr.hex");if(F==null||I==null||y==null)throw new Error("encalg, enciv or enc is undefined");var P={salt:_,iter:E,prf:S,encalg:F,enciv:I,enc:y};return P},getDKFromPBES2Param:function(f,x){var b={hmacWithSHA1:Q.algo.SHA1,hmacWithSHA224:Q.algo.SHA224,hmacWithSHA256:Q.algo.SHA256,hmacWithSHA384:Q.algo.SHA384,hmacWithSHA512:Q.algo.SHA512},_={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},O=b[f.prf];if(O==null)throw new Error("unsupported prf");var S=_[f.encalg];if(S==null)throw new Error("unsupported encalg");var E=Q.enc.Hex.parse(f.salt),F=f.iter;try{var I=Q.PBKDF2(x,E,{keySize:S,iterations:F,hasher:O});return Q.enc.Hex.stringify(I)}catch(y){throw new Error("PBKDF2 error: "+y+" "+JSON.stringify(f)+" "+x)}},getPlainHexFromEncryptedPKCS8PEM:function(f,x){if(f.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var b=xt(f),_;try{_=Se.parsePBES2(b)}catch(S){throw new Error("malformed PBES2 format: "+S.message)}var O=Se.getDKFromPBES2Param(_,x);return g.crypto.Cipher.decrypt(_.enc,O,_.encalg,{iv:_.enciv})},getKeyFromEncryptedPKCS8PEM:function(f,x){var b=this.getPlainHexFromEncryptedPKCS8PEM(f,x),_=this.getKeyFromPlainPrivatePKCS8Hex(b);return _},parsePlainPrivatePKCS8Hex:function(f){var x=$,b=x.getChildIdx,_=x.getV,O={};if(O.algparam=null,f.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var S=b(f,0);if(S.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(f.substr(S[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var E=b(f,S[1]);if(E.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(f.substr(E[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(O.algoid=_(f,E[0]),f.substr(E[1],2)=="06"&&(O.algparam=_(f,E[1])),f.substr(S[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return O.keyidx=x.getVidx(f,S[2]),O},getKeyFromPlainPrivatePKCS8PEM:function(f){var x=xt(f,"PRIVATE KEY"),b=this.getKeyFromPlainPrivatePKCS8Hex(x);return b},getKeyFromPlainPrivatePKCS8Hex:function(f){var x=this.parsePlainPrivatePKCS8Hex(f),b;if(x.algoid=="2a864886f70d010101")b=new ve;else if(x.algoid=="2a8648ce380401")b=new g.crypto.DSA;else if(x.algoid=="2a8648ce3d0201")b=new g.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return b.readPKCS8PrvKeyHex(f),b},_getKeyFromPublicPKCS8Hex:function(f){var x,b=$.getVbyList(f,0,[0,0],"06");if(b==="2a864886f70d010101")x=new ve;else if(b==="2a8648ce380401")x=new g.crypto.DSA;else if(b==="2a8648ce3d0201")x=new g.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return x.readPKCS8PubKeyHex(f),x},parsePublicRawRSAKeyHex:function(f){var x=$,b=x.getChildIdx,_=x.getV,O={};if(f.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var S=b(f,0);if(S.length!=2)throw new Error("malformed RSA key(code:002)");if(f.substr(S[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(O.n=_(f,S[0]),f.substr(S[1],2)!="02")throw new Error("malformed RSA key(code:004)");return O.e=_(f,S[1]),O},parsePublicPKCS8Hex:function(f){var x=$,b=x.getChildIdx,_=x.getV,O={};O.algparam=null;var S=b(f,0);if(S.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+S.length);var E=S[0];if(f.substr(E,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var F=b(f,E);if(F.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(f.substr(F[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(O.algoid=_(f,F[0]),f.substr(F[1],2)=="06"?O.algparam=_(f,F[1]):f.substr(F[1],2)=="30"&&(O.algparam={},O.algparam.p=x.getVbyList(f,F[1],[0],"02"),O.algparam.q=x.getVbyList(f,F[1],[1],"02"),O.algparam.g=x.getVbyList(f,F[1],[2],"02")),f.substr(S[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return O.key=_(f,S[1]).substr(2),O}}}();Se.getKey=function(n,e,t){var r=$,i=r.getChildIdx,o=r.getV,a=r.getVbyList,s=g.crypto,c=s.ECDSA,l=s.DSA,h=ve,u=xt,d=Se;if(typeof h<"u"&&n instanceof h||typeof c<"u"&&n instanceof c||typeof l<"u"&&n instanceof l)return n;if(n.curve!==void 0&&n.xy!==void 0&&n.d===void 0)return new c({pub:n.xy,curve:n.curve});if(n.curve!==void 0&&n.d!==void 0)return new c({prv:n.d,curve:n.curve});if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d===void 0){var p=new h;return p.setPublic(n.n,n.e),p}if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p!==void 0&&n.q!==void 0&&n.dp!==void 0&&n.dq!==void 0&&n.co!==void 0&&n.qi===void 0){var p=new h;return p.setPrivateEx(n.n,n.e,n.d,n.p,n.q,n.dp,n.dq,n.co),p}if(n.kty===void 0&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p===void 0){var p=new h;return p.setPrivate(n.n,n.e,n.d),p}if(n.p!==void 0&&n.q!==void 0&&n.g!==void 0&&n.y!==void 0&&n.x===void 0){var p=new l;return p.setPublic(n.p,n.q,n.g,n.y),p}if(n.p!==void 0&&n.q!==void 0&&n.g!==void 0&&n.y!==void 0&&n.x!==void 0){var p=new l;return p.setPrivate(n.p,n.q,n.g,n.y,n.x),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d===void 0){var p=new h;return p.setPublic(gt(n.n),gt(n.e)),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0&&n.p!==void 0&&n.q!==void 0&&n.dp!==void 0&&n.dq!==void 0&&n.qi!==void 0){var p=new h;return p.setPrivateEx(gt(n.n),gt(n.e),gt(n.d),gt(n.p),gt(n.q),gt(n.dp),gt(n.dq),gt(n.qi)),p}if(n.kty==="RSA"&&n.n!==void 0&&n.e!==void 0&&n.d!==void 0){var p=new h;return p.setPrivate(gt(n.n),gt(n.e),gt(n.d)),p}if(n.kty==="EC"&&n.crv!==void 0&&n.x!==void 0&&n.y!==void 0&&n.d===void 0){var m=new c({curve:n.crv}),f=m.ecparams.keycharlen,x=("0000000000"+gt(n.x)).slice(-f),b=("0000000000"+gt(n.y)).slice(-f),_="04"+x+b;return m.setPublicKeyHex(_),m}if(n.kty==="EC"&&n.crv!==void 0&&n.x!==void 0&&n.y!==void 0&&n.d!==void 0){var m=new c({curve:n.crv}),f=m.ecparams.keycharlen,x=("0000000000"+gt(n.x)).slice(-f),b=("0000000000"+gt(n.y)).slice(-f),_="04"+x+b,O=("0000000000"+gt(n.d)).slice(-f);return m.setPublicKeyHex(_),m.setPrivateKeyHex(O),m}if(t==="pkcs5prv"){var S=n,r=$,E,p;if(E=i(S,0),E.length===9)p=new h,p.readPKCS5PrvKeyHex(S);else if(E.length===6)p=new l,p.readPKCS5PrvKeyHex(S);else if(E.length>2&&S.substr(E[1],2)==="04")p=new c,p.readPKCS5PrvKeyHex(S);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return p}if(t==="pkcs8prv"){var p=d.getKeyFromPlainPrivatePKCS8Hex(n);return p}if(t==="pkcs8pub")return d._getKeyFromPublicPKCS8Hex(n);if(t==="x509pub")return he.getPublicKeyFromCertHex(n);if(n.indexOf("-END CERTIFICATE-",0)!=-1||n.indexOf("-END X509 CERTIFICATE-",0)!=-1||n.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return he.getPublicKeyFromCertPEM(n);if(n.indexOf("-END PUBLIC KEY-")!=-1){var F=xt(n,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(F)}if(n.indexOf("-END RSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var I=u(n,"RSA PRIVATE KEY");return d.getKey(I,null,"pkcs5prv")}if(n.indexOf("-END DSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var y=u(n,"DSA PRIVATE KEY"),P=a(y,0,[1],"02"),C=a(y,0,[2],"02"),M=a(y,0,[3],"02"),A=a(y,0,[4],"02"),T=a(y,0,[5],"02"),p=new l;return p.setPrivate(new B(P,16),new B(C,16),new B(M,16),new B(A,16),new B(T,16)),p}if(n.indexOf("-END EC PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")==-1){var I=u(n,"EC PRIVATE KEY");return d.getKey(I,null,"pkcs5prv")}if(n.indexOf("-END PRIVATE KEY-")!=-1)return d.getKeyFromPlainPrivatePKCS8PEM(n);if(n.indexOf("-END RSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var k=d.getDecryptedKeyHex(n,e),D=new ve;return D.readPKCS5PrvKeyHex(k),D}if(n.indexOf("-END EC PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var y=d.getDecryptedKeyHex(n,e),p=a(y,0,[1],"04"),R=a(y,0,[2,0],"06"),N=a(y,0,[3,0],"03").substr(2),L="";if(g.crypto.OID.oidhex2name[R]!==void 0)L=g.crypto.OID.oidhex2name[R];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+R);var m=new c({curve:L});return m.setPublicKeyHex(N),m.setPrivateKeyHex(p),m.isPublic=!1,m}if(n.indexOf("-END DSA PRIVATE KEY-")!=-1&&n.indexOf("4,ENCRYPTED")!=-1){var y=d.getDecryptedKeyHex(n,e),P=a(y,0,[1],"02"),C=a(y,0,[2],"02"),M=a(y,0,[3],"02"),A=a(y,0,[4],"02"),T=a(y,0,[5],"02"),p=new l;return p.setPrivate(new B(P,16),new B(C,16),new B(M,16),new B(A,16),new B(T,16)),p}if(n.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return d.getKeyFromEncryptedPKCS8PEM(n,e);throw new Error("not supported argument")};Se.generateKeypair=function(n,e){if(n=="RSA"){var t=e,r=new ve;r.generate(t,"10001"),r.isPrivate=!0,r.isPublic=!0;var i=new ve,o=r.n.toString(16),a=r.e.toString(16);i.setPublic(o,a),i.isPrivate=!1,i.isPublic=!0;var s={};return s.prvKeyObj=r,s.pubKeyObj=i,s}else if(n=="EC"){var c=e,l=new g.crypto.ECDSA({curve:c}),h=l.generateKeyPairHex(),r=new g.crypto.ECDSA({curve:c});r.setPublicKeyHex(h.ecpubhex),r.setPrivateKeyHex(h.ecprvhex),r.isPrivate=!0,r.isPublic=!1;var i=new g.crypto.ECDSA({curve:c});i.setPublicKeyHex(h.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var s={};return s.prvKeyObj=r,s.pubKeyObj=i,s}else throw new Error("unknown algorithm: "+n)};Se.getPEM=function(n,e,t,r,i,o){var a=g,s=a.asn1,c=s.DERObjectIdentifier,l=s.DERInteger,h=s.ASN1Util.newObject,u=s.x509,d=u.SubjectPublicKeyInfo,p=a.crypto,m=p.DSA,f=p.ECDSA,x=ve;function b(D){var R=h({seq:[{int:0},{int:{bigint:D.n}},{int:D.e},{int:{bigint:D.d}},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.dmp1}},{int:{bigint:D.dmq1}},{int:{bigint:D.coeff}}]});return R}function _(D){var R=h({seq:[{int:1},{octstr:{hex:D.prvKeyHex}},{tag:["a0",!0,{oid:{name:D.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+D.pubKeyHex}}]}]});return R}function O(D){var R=h({seq:[{int:0},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.g}},{int:{bigint:D.y}},{int:{bigint:D.x}}]});return R}if((x!==void 0&&n instanceof x||m!==void 0&&n instanceof m||f!==void 0&&n instanceof f)&&n.isPublic==!0&&(e===void 0||e=="PKCS8PUB")){var S=new d(n),E=S.tohex();return un(E,"PUBLIC KEY")}if(e=="PKCS1PRV"&&x!==void 0&&n instanceof x&&(t===void 0||t==null)&&n.isPrivate==!0){var S=b(n),E=S.tohex();return un(E,"RSA PRIVATE KEY")}if(e=="PKCS1PRV"&&f!==void 0&&n instanceof f&&(t===void 0||t==null)&&n.isPrivate==!0){var F=new c({name:n.curveName}),I=F.tohex(),y=_(n),P=y.tohex(),C="";return C+=un(I,"EC PARAMETERS"),C+=un(P,"EC PRIVATE KEY"),C}if(e=="PKCS1PRV"&&m!==void 0&&n instanceof m&&(t===void 0||t==null)&&n.isPrivate==!0){var S=O(n),E=S.tohex();return un(E,"DSA PRIVATE KEY")}if(e=="PKCS5PRV"&&x!==void 0&&n instanceof x&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=b(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,t,r,o)}if(e=="PKCS5PRV"&&f!==void 0&&n instanceof f&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=_(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,t,r,o)}if(e=="PKCS5PRV"&&m!==void 0&&n instanceof m&&t!==void 0&&t!=null&&n.isPrivate==!0){var S=O(n),E=S.tohex();return r===void 0&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,t,r,o)}var M=function(D,R){if(typeof R=="string")return Se.getEncryptedPKCS8PEM(D,R);if(typeof R=="object"&&et(R,"passcode")!=null){var N=JSON.parse(JSON.stringify(R)),L=N.passcode;return delete N.passcode,Se.getEncryptedPKCS8PEM(D,L,N)}};if(e=="PKCS8PRV"&&x!=null&&n instanceof x&&n.isPrivate==!0){var A=b(n),T=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:T}}]}),E=S.tohex();return t===void 0||t==null?un(E,"PRIVATE KEY"):M(E,t)}if(e=="PKCS8PRV"&&f!==void 0&&n instanceof f&&n.isPrivate==!0){var k={seq:[{int:1},{octstr:{hex:n.prvKeyHex}}]};typeof n.pubKeyHex=="string"&&k.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+n.pubKeyHex}}]});var A=new h(k),T=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:n.curveName}}]},{octstr:{hex:T}}]}),E=S.tohex();return t===void 0||t==null?un(E,"PRIVATE KEY"):M(E,t)}if(e=="PKCS8PRV"&&m!==void 0&&n instanceof m&&n.isPrivate==!0){var A=new l({bigint:n.x}),T=A.tohex(),S=h({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:n.p}},{int:{bigint:n.q}},{int:{bigint:n.g}}]}]},{octstr:{hex:T}}]}),E=S.tohex();return t===void 0||t==null?un(E,"PRIVATE KEY"):M(E,t)}throw new Error("unsupported object nor format")};Se.getKeyFromCSRPEM=function(n){var e=xt(n,"CERTIFICATE REQUEST"),t=Se.getKeyFromCSRHex(e);return t};Se.getKeyFromCSRHex=function(n){var e=Se.parseCSRHex(n),t=Se.getKey(e.p8pubkeyhex,null,"pkcs8pub");return t};Se.parseCSRHex=function(n){var e=$,t=e.getChildIdx,r=e.getTLV,i={},o=n;if(o.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var a=t(o,0);if(a.length<1)throw new Error("malformed CSR(code:002)");if(o.substr(a[0],2)!="30")throw new Error("malformed CSR(code:003)");var s=t(o,a[0]);if(s.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=r(o,s[2]),i};Se.getKeyID=function(n){var e=Se,t=$;typeof n=="string"&&n.indexOf("BEGIN ")!=-1&&(n=e.getKey(n));var r=xt(e.getPEM(n)),i=t.getIdxbyList(r,0,[1]),o=t.getV(r,i).substring(2);return g.crypto.Util.hashHex(o,"sha1")};Se.getJWK=function(n,e,t,r,i){var o,a={},s,c=g.crypto.Util.hashHex;if(typeof n=="string")o=Se.getKey(n),n.indexOf("CERTIFICATE")!=-1&&(s=xt(n));else if(typeof n=="object")n instanceof he?(o=n.getPublicKey(),s=n.hex):o=n;else throw new Error("unsupported keyinfo type");if(o instanceof ve&&o.isPrivate)a.kty="RSA",a.n=Tt(o.n.toString(16)),a.e=Tt(o.e.toString(16)),a.d=Tt(o.d.toString(16)),a.p=Tt(o.p.toString(16)),a.q=Tt(o.q.toString(16)),a.dp=Tt(o.dmp1.toString(16)),a.dq=Tt(o.dmq1.toString(16)),a.qi=Tt(o.coeff.toString(16));else if(o instanceof ve&&o.isPublic)a.kty="RSA",a.n=Tt(o.n.toString(16)),a.e=Tt(o.e.toString(16));else if(o instanceof g.crypto.ECDSA&&o.isPrivate){var l=o.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var h=o.getPublicKeyXYHex();a.kty="EC",a.crv=l,a.x=Tt(h.x),a.y=Tt(h.y),a.d=Tt(o.prvKeyHex)}else if(o instanceof g.crypto.ECDSA&&o.isPublic){var l=o.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var h=o.getPublicKeyXYHex();a.kty="EC",a.crv=l,a.x=Tt(h.x),a.y=Tt(h.y)}if(a.kty==null)throw new Error("unsupported keyinfo");return!o.isPrivate&&e!=!0&&(a.kid=g.jws.JWS.getJWKthumbprint(a)),s!=null&&t!=!0&&(a.x5c=[Zr(s)]),s!=null&&r!=!0&&(a.x5t=rs(Zr(c(s,"sha1")))),s!=null&&i!=!0&&(a["x5t#S256"]=rs(Zr(c(s,"sha256")))),a};Se.getJWKFromKey=function(n){return Se.getJWK(n,!0,!0,!0,!0)};ve.getPosArrayOfChildrenFromHex=function(n){return $.getChildIdx(n,0)};ve.getHexValueArrayOfChildrenFromHex=function(n){var e=$,t=e.getV,d=ve.getPosArrayOfChildrenFromHex(n),r=t(n,d[0]),i=t(n,d[1]),o=t(n,d[2]),a=t(n,d[3]),s=t(n,d[4]),c=t(n,d[5]),l=t(n,d[6]),h=t(n,d[7]),u=t(n,d[8]),d=new Array;return d.push(r,i,o,a,s,c,l,h,u),d};ve.prototype.readPrivateKeyFromPEMString=function(n){var e=xt(n),t=ve.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};ve.prototype.readPKCS5PrvKeyHex=function(n){var e=ve.getHexValueArrayOfChildrenFromHex(n);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};ve.prototype.readPKCS8PrvKeyHex=function(n){var e,t,r,i,o,a,s,c,l=$,h=l.getVbyListEx;if(l.isASN1HEX(n)===!1)throw new Error("not ASN.1 hex string");try{e=h(n,0,[2,0,1],"02"),t=h(n,0,[2,0,2],"02"),r=h(n,0,[2,0,3],"02"),i=h(n,0,[2,0,4],"02"),o=h(n,0,[2,0,5],"02"),a=h(n,0,[2,0,6],"02"),s=h(n,0,[2,0,7],"02"),c=h(n,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(e,t,r,i,o,a,s,c)};ve.prototype.readPKCS5PubKeyHex=function(n){var e=$,t=e.getV;if(e.isASN1HEX(n)===!1)throw new Error("keyHex is not ASN.1 hex string");var r=e.getChildIdx(n,0);if(r.length!==2||n.substr(r[0],2)!=="02"||n.substr(r[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var i=t(n,r[0]),o=t(n,r[1]);this.setPublic(i,o)};ve.prototype.readPKCS8PubKeyHex=function(n){var e=$;if(e.isASN1HEX(n)===!1)throw new Error("not ASN.1 hex string");if(e.getTLVbyListEx(n,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var t=e.getTLVbyListEx(n,0,[1,0]);this.readPKCS5PubKeyHex(t)};ve.prototype.readCertPubKeyHex=function(n,e){var t,r;t=new he,t.readCertHex(n),r=t.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)};var mme=new RegExp("[^0-9a-f]","gi");function Ak(n,e){for(var t="",r=e/4-n.length,i=0;i<r;i++)t=t+"0";return t+n}ve.prototype.sign=function(n,e){var t=function(i){return g.crypto.Util.hashString(i,e)},r=t(n);return this.signWithMessageHash(r,e)};ve.prototype.signWithMessageHash=function(n,e){var t=g.crypto.Util.getPaddedDigestInfoHex(n,e,this.n.bitLength()),r=Tn(t,16),i=this.doPrivate(r),o=i.toString(16);return Ak(o,this.n.bitLength())};function kk(n,e,t){for(var r="",i=0;r.length<e;)r+=In(t(Ir(n+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])))),i+=1;return r}ve.prototype.signPSS=function(n,e,t){var r=function(o){return g.crypto.Util.hashHex(o,e)},i=r(Ir(n));return t===void 0&&(t=-1),this.signWithMessageHashPSS(i,e,t)};ve.prototype.signWithMessageHashPSS=function(n,e,t){var r=In(n),i=r.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),s,c=function(x){return g.crypto.Util.hashHex(x,e)};if(t===-1||t===void 0)t=i;else if(t===-2)t=a-i-2;else if(t<-2)throw new Error("invalid salt length");if(a<i+t+2)throw new Error("data too long");var l="";t>0&&(l=new Array(t),new ss().nextBytes(l),l=String.fromCharCode.apply(String,l));var h=In(c(Ir("\0\0\0\0\0\0\0\0"+r+l))),u=[];for(s=0;s<a-t-i-2;s+=1)u[s]=0;var d=String.fromCharCode.apply(String,u)+""+l,p=kk(h,d.length,c),m=[];for(s=0;s<d.length;s+=1)m[s]=d.charCodeAt(s)^p.charCodeAt(s);var f=65280>>8*a-o&255;for(m[0]&=~f,s=0;s<i;s++)m.push(h.charCodeAt(s));return m.push(188),Ak(this.doPrivate(new B(m)).toString(16),this.n.bitLength())};function Dk(n){for(var e in g.crypto.Util.DIGESTINFOHEAD){var t=g.crypto.Util.DIGESTINFOHEAD[e],r=t.length;if(n.substring(0,r)==t){var i=[e,n.substring(r)];return i}}return[]}ve.prototype.verify=function(n,e){if(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null)return!1;var t=Tn(e,16),r=this.n.bitLength();if(t.bitLength()>r)return!1;var i=this.doPublic(t),o=i.toString(16);if(o.length+3!=r/4)return!1;var a=o.replace(/^1f+00/,""),s=Dk(a);if(s.length==0)return!1;var c=s[0],l=s[1],h=function(d){return g.crypto.Util.hashString(d,c)},u=h(n);return l==u};ve.prototype.verifyWithMessageHash=function(n,e){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var t=Tn(e,16);if(t.bitLength()>this.n.bitLength())return 0;var r=this.doPublic(t),i=r.toString(16).replace(/^1f+00/,""),o=Dk(i);if(o.length==0)return!1;var a=o[0],s=o[1];return s==n};ve.prototype.verifyPSS=function(n,e,t,r){var i=function(a){return g.crypto.Util.hashHex(a,t)},o=i(Ir(n));return r===void 0&&(r=-1),this.verifyWithMessageHashPSS(o,e,t,r)};ve.prototype.verifyWithMessageHashPSS=function(n,e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var i=new B(e,16),o=function(_){return g.crypto.Util.hashHex(_,t)},a=In(n),s=a.length,c=this.n.bitLength()-1,l=Math.ceil(c/8),h;if(r===-1||r===void 0)r=s;else if(r===-2)r=l-s-2;else if(r<-2)throw new Error("invalid salt length");if(l<s+r+2)throw new Error("data too long");var u=this.doPublic(i).toByteArray();for(h=0;h<u.length;h+=1)u[h]&=255;for(;u.length<l;)u.unshift(0);if(u[l-1]!==188)throw new Error("encoded message does not end in 0xbc");u=String.fromCharCode.apply(String,u);var d=u.substr(0,l-s-1),p=u.substr(d.length,s),m=65280>>8*l-c&255;if(d.charCodeAt(0)&m)throw new Error("bits beyond keysize not zero");var f=kk(p,d.length,o),x=[];for(h=0;h<d.length;h+=1)x[h]=d.charCodeAt(h)^f.charCodeAt(h);x[0]&=~m;var b=l-s-r-2;for(h=0;h<b;h+=1)if(x[h]!==0)throw new Error("leftmost octets not zero");if(x[b]!==1)throw new Error("0x01 marker not found");return p===In(o(Ir("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,x.slice(-r)))))};ve.SALT_LEN_HLEN=-1;ve.SALT_LEN_MAX=-2;ve.SALT_LEN_RECOVER=-2;function he(n){var e=$,t=e.getChildIdx,r=e.getV,i=e.dump,o=e.parse,a=e.getTLV,s=e.getVbyList,c=e.getVbyListEx,l=e.getTLVbyList,h=e.getTLVbyListEx,u=e.getIdxbyList,d=e.getIdxbyListEx,p=e.getVidx,m=e.getInt,f=e.oidname,x=e.hextooidstr,b=he,_=xt,O,S=Error;try{O=g.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var y=l(this.hex,0,[0,0]);if(y.substr(0,2)=="a0"){var P=l(y,0,[0]),C=m(P,0);if(C<0||2<C)throw new Error("malformed version field");return this.version=C+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return c(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var y=h(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(y)},this.getAlgorithmIdentifierName=function(y){for(var P in O)if(y===O[P])return P;return f(c(y,0,[0],"06"))},this.getIssuer=function(y,P){return this.getX500Name(this.getIssuerHex(),y,P)},this.getIssuerHex=function(){return l(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var y=this.getIssuer();return y.str},this.getSubject=function(y,P){return this.getX500Name(this.getSubjectHex(),y,P)},this.getSubjectHex=function(){return l(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var y=this.getSubject();return y.str},this.getNotBefore=function(){var y=s(this.hex,0,[0,4+this.foffset,0]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getNotAfter=function(){var y=s(this.hex,0,[0,4+this.foffset,1]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var y=this.getSPKI();return y==null?null:s(y,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return u(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var y=this.getPublicKeyIdx();return u(this.hex,y,[1,0],"30")},this.getPublicKey=function(){return Se.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var y=l(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(y)},this.getSignatureValueHex=function(){return s(this.hex,0,[2],"03",!0)},this.verifySignature=function(y){var P=this.getSignatureAlgorithmField(),C=this.getSignatureValueHex(),M=l(this.hex,0,[0],"30"),A=new g.crypto.Signature({alg:P});return A.init(y),A.updateHex(M),A.verify(C)},this.parseExt=function(y){var P,C,M;if(y===void 0){if(M=this.hex,this.version!==3)return-1;P=u(M,0,[0,7,0],"30"),C=t(M,P)}else{M=xt(y);var A=u(M,0,[0,3,0,0],"06");if(r(M,A)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}P=u(M,0,[0,3,0,1,0],"30"),C=t(M,P),this.hex=M}this.aExtInfo=new Array;for(var T=0;T<C.length;T++){var k={};k.critical=!1;var D=t(M,C[T]),R=0;D.length===3&&(k.critical=!0,R=1),k.oid=e.hextooidstr(s(M,C[T],[0],"06"));var N=u(M,C[T],[1+R]);k.vidx=p(M,N),this.aExtInfo.push(k)}},this.getExtInfo=function(y){var P=this.aExtInfo,C=y;if(y.match(/^[0-9.]+$/)||(C=g.asn1.x509.OID.name2oid(y)),C!==""){for(var M=0;M<P.length;M++)if(P[M].oid===C)return P[M]}},this.getCriticalExtV=function(y,P,C){if(P!=null)return[P,C];var M=this.getExtInfo(y);return M==null?[null,null]:[a(this.hex,M.vidx),M.critical]},this.getExtBasicConstraints=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("basicConstraints");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"basicConstraints"};if(P&&(M.critical=!0),y==="3000")return M;if(y==="30030101ff")return M.cA=!0,M;if(y.substr(0,12)==="30060101ff02"){var A=r(y,10),T=parseInt(A,16);return M.cA=!0,M.pathLen=T,M}throw new Error("hExtV parse error: "+y)},this.getExtNameConstraints=function(y,P){var C=this.getCriticalExtV("nameConstraints",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"nameConstraints"};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++){for(var k=[],D=t(y,A[T]),R=0;R<D.length;R++){var N=a(y,D[R]),L=this.getGeneralSubtree(N);k.push(L)}var V=y.substr(A[T],2);V=="a0"?M.permit=k:V=="a1"&&(M.exclude=k)}return M}},this.getGeneralSubtree=function(y){var P=t(y,0),C=P.length;if(C<1||2<C)throw new Error("wrong num elements");for(var M=this.getGeneralName(a(y,P[0])),A=1;A<C;A++){var T=y.substr(P[A],2),k=r(y,P[A]),D=parseInt(k,16);T=="80"&&(M.min=D),T=="81"&&(M.max=D)}return M},this.getExtKeyUsage=function(y,P){var C=this.getCriticalExtV("keyUsage",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"keyUsage"};return P&&(M.critical=!0),M.names=this.getExtKeyUsageString(y).split(","),M}},this.getExtKeyUsageBin=function(y){if(y===void 0){var P=this.getExtInfo("keyUsage");if(P===void 0)return"";y=a(this.hex,P.vidx)}if(y.length!=8&&y.length!=10)throw new Error("malformed key usage value: "+y);var C="000000000000000"+parseInt(y.substr(6),16).toString(2);return y.length==8&&(C=C.slice(-8)),y.length==10&&(C=C.slice(-16)),C=C.replace(/0+$/,""),C==""&&(C="0"),C},this.getExtKeyUsageString=function(y){for(var P=this.getExtKeyUsageBin(y),C=new Array,M=0;M<P.length;M++)P.substr(M,1)=="1"&&C.push(he.KEYUSAGE_NAME[M]);return C.join(",")},this.getExtSubjectKeyIdentifier=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectKeyIdentifier");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"subjectKeyIdentifier"};P&&(M.critical=!0);var A=r(y,0);return M.kid={hex:A},M},this.getExtAuthorityKeyIdentifier=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("authorityKeyIdentifier");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"authorityKeyIdentifier"};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++){var k=y.substr(A[T],2);if(k==="80"&&(M.kid={hex:r(y,A[T])}),k==="a1"){var D=a(y,A[T]),R=this.getGeneralNames(D);M.issuer=R[0].dn}k==="82"&&(M.sn={hex:r(y,A[T])})}return M},this.getExtExtKeyUsage=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("extKeyUsage");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"extKeyUsage",array:[]};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++)M.array.push(f(r(y,A[T])));return M},this.getExtExtKeyUsageName=function(){var y=this.getExtInfo("extKeyUsage");if(y===void 0)return y;var P=new Array,C=a(this.hex,y.vidx);if(C==="")return P;for(var M=t(C,0),A=0;A<M.length;A++)P.push(f(r(C,M[A])));return P},this.getExtSubjectAltName=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectAltName");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"subjectAltName",array:[]};return P&&(M.critical=!0),M.array=this.getGeneralNames(y),M},this.getExtIssuerAltName=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("issuerAltName");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"issuerAltName",array:[]};return P&&(M.critical=!0),M.array=this.getGeneralNames(y),M},this.getGeneralNames=function(y){for(var P=t(y,0),C=[],M=0;M<P.length;M++){var A=this.getGeneralName(a(y,P[M]));A!==void 0&&C.push(A)}return C},this.getGeneralName=function(y){var P=y.substr(0,2),C=r(y,0),M=In(C);if(P=="81")return{rfc822:M};if(P=="82")return{dns:M};if(P=="86")return{uri:M};if(P=="87")return{ip:lp(C)};if(P=="a4")return{dn:this.getX500Name(C)};if(P=="a0")return{other:this.getOtherName(y)}},this.getExtSubjectAltName2=function(){var y,P,C,M=this.getExtInfo("subjectAltName");if(M===void 0)return M;for(var A=new Array,T=a(this.hex,M.vidx),k=t(T,0),D=0;D<k.length;D++)C=T.substr(k[D],2),y=r(T,k[D]),C==="81"&&(P=Ve(y),A.push(["MAIL",P])),C==="82"&&(P=Ve(y),A.push(["DNS",P])),C==="84"&&(P=he.hex2dn(y,0),A.push(["DN",P])),C==="86"&&(P=Ve(y),A.push(["URI",P])),C==="87"&&(P=lp(y),A.push(["IP",P]));return A},this.getExtCRLDistributionPoints=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("cRLDistributionPoints");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"cRLDistributionPoints",array:[]};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++){var k=a(y,A[T]);M.array.push(this.getDistributionPoint(k))}return M},this.getDistributionPoint=function(y){for(var P={},C=t(y,0),M=0;M<C.length;M++){var A=y.substr(C[M],2),T=a(y,C[M]);A=="a0"&&(P.dpname=this.getDistributionPointName(T))}return P},this.getDistributionPointName=function(y){for(var P={},C=t(y,0),M=0;M<C.length;M++){var A=y.substr(C[M],2),T=a(y,C[M]);A=="a0"&&(P.full=this.getGeneralNames(T))}return P},this.getExtCRLDistributionPointsURI=function(){var y=this.getExtCRLDistributionPoints();if(y==null)return y;for(var P=y.array,C=[],M=0;M<P.length;M++)try{P[M].dpname.full[0].uri!=null&&C.push(P[M].dpname.full[0].uri)}catch{}return C},this.getExtAIAInfo=function(){var y=this.getExtInfo("authorityInfoAccess");if(y===void 0)return y;for(var P={ocsp:[],caissuer:[]},C=t(this.hex,y.vidx),M=0;M<C.length;M++){var A=s(this.hex,C[M],[0],"06"),T=s(this.hex,C[M],[1],"86");A==="2b06010505073001"&&P.ocsp.push(Ve(T)),A==="2b06010505073002"&&P.caissuer.push(Ve(T))}return P},this.getExtAuthorityInfoAccess=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("authorityInfoAccess");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"authorityInfoAccess",array:[]};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++){var k=c(y,A[T],[0],"06"),D=s(y,A[T],[1],"86"),R=Ve(D);if(k=="2b06010505073001")M.array.push({ocsp:R});else if(k=="2b06010505073002")M.array.push({caissuer:R});else throw new Error("unknown method: "+k)}return M},this.getExtCertificatePolicies=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("certificatePolicies");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"certificatePolicies",array:[]};P&&(M.critical=!0);for(var A=t(y,0),T=0;T<A.length;T++){var k=a(y,A[T]),D=this.getPolicyInformation(k);M.array.push(D)}return M},this.getPolicyInformation=function(y){var P={},C=s(y,0,[0],"06");P.policyoid=f(C);var M=d(y,0,[1],"30");if(M!=-1){P.array=[];for(var A=t(y,M),T=0;T<A.length;T++){var k=a(y,A[T]),D=this.getPolicyQualifierInfo(k);P.array.push(D)}}return P},this.getOtherName=function(y){var P={},C=t(y,0),M=s(y,C[0],[],"06"),A=s(y,C[1],[]);return P.oid=f(M),P.value=o(A),P},this.getPolicyQualifierInfo=function(y){var P={},C=s(y,0,[0],"06");if(C==="2b06010505070201"){var M=c(y,0,[1],"16");P.cps=In(M)}else if(C==="2b06010505070202"){var A=l(y,0,[1],"30");P.unotice=this.getUserNotice(A)}return P},this.getUserNotice=function(y){var P=null,C={};try{P=e.parse(y);var M=this._asn1ToUnotice(P);return M}catch{return}},this._asn1ToUnotice=function(y){try{for(var P={},C=et(y,"seq"),M=0;M<C.length;M++){var A=this._asn1ToNoticeRef(C[M]);A!=null&&(P.noticeref=A);var T=this.asn1ToDisplayText(C[M]);T!=null&&(P.exptext=T)}return Object.keys(P).length>0?P:void 0}catch{return}},this._asn1ToNoticeRef=function(y){try{for(var P={},C=et(y,"seq"),M=0;M<C.length;M++){var A=this._asn1ToNoticeNum(C[M]);A!=null&&(P.noticenum=A);var T=this.asn1ToDisplayText(C[M]);T!=null&&(P.org=T)}return Object.keys(P).length>0?P:void 0}catch{return}},this._asn1ToNoticeNum=function(y){try{for(var P=et(y,"seq"),C=[],M=0;M<P.length;M++){var A=P[M];C.push(parseInt(et(A,"int.hex"),16))}return C}catch{return}},this.getDisplayText=function(y){var P={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},C={};return C.type=P[y.substr(0,2)],C.str=In(r(y,0)),C},this.asn1ToDisplayText=function(y){if(y.utf8str!=null)return{type:"utf8",str:y.utf8str.str};if(y.ia5str!=null)return{type:"ia5",str:y.ia5str.str};if(y.visstr!=null)return{type:"vis",str:y.visstr.str};if(y.bmpstr!=null)return{type:"bmp",str:y.bmpstr.str};if(y.prnstr!=null)return{type:"prn",str:y.prnstr.str}},this.getExtPolicyMappings=function(y,P){var C=this.getCriticalExtV("policyMappings",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"policyMappings"};P&&(M.critical=!0);try{for(var A=o(y),T=A.seq,k=[],D=0;D<T.length;D++){var R=T[D].seq;k.push([R[0].oid,R[1].oid])}M.array=k}catch{throw new S("malformed policyMappings")}return M}},this.getExtPolicyConstraints=function(y,P){var C=this.getCriticalExtV("policyConstraints",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"policyConstraints"};P&&(M.critical=!0);var A=o(y);try{for(var T=A.seq,k=0;k<T.length;k++){var D=T[k].tag;D.explicit==!1&&(D.tag=="80"&&(M.reqexp=parseInt(D.hex,16)),D.tag=="81"&&(M.inhibit=parseInt(D.hex,16)))}}catch{return new S("malformed policyConstraints value")}return M}},this.getExtInhibitAnyPolicy=function(y,P){var C=this.getCriticalExtV("inhibitAnyPolicy",y,P);if(y=C[0],P=C[1],y!=null){var M={extname:"inhibitAnyPolicy"};P&&(M.critical=!0);var A=m(y,0);return A==-1?new S("wrong value"):(M.skip=A,M)}},this.getExtCRLNumber=function(y,P){var C={extname:"cRLNumber"};if(P&&(C.critical=!0),y.substr(0,2)=="02")return C.num={hex:r(y,0)},C;throw new S("hExtV parse error: "+y)},this.getExtCRLReason=function(y,P){var C={extname:"cRLReason"};if(P&&(C.critical=!0),y.substr(0,2)=="0a")return C.code=parseInt(r(y,0),16),C;throw new Error("hExtV parse error: "+y)},this.getExtOcspNonce=function(y,P){var C={extname:"ocspNonce"};P&&(C.critical=!0);var M=r(y,0);return C.hex=M,C},this.getExtOcspNoCheck=function(y,P){var C={extname:"ocspNoCheck"};return P&&(C.critical=!0),C},this.getExtAdobeTimeStamp=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("adobeTimeStamp");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"adobeTimeStamp"};P&&(M.critical=!0);var A=t(y,0);if(A.length>1){var T=a(y,A[1]),k=this.getGeneralName(T);k.uri!=null&&(M.uri=k.uri)}if(A.length>2){var D=a(y,A[2]);D=="0101ff"&&(M.reqauth=!0),D=="010100"&&(M.reqauth=!1)}return M},this.getExtSubjectDirectoryAttributes=function(y,P){if(y===void 0&&P===void 0){var C=this.getExtInfo("subjectDirectoryAttributes");if(C===void 0)return;y=a(this.hex,C.vidx),P=C.critical}var M={extname:"subjectDirectoryAttributes"};P&&(M.critical=!0);try{for(var A=o(y),T=[],k=0;k<A.seq.length;k++){var D=A.seq[k],R=et(D,"seq.0.oid"),N=et(D,"seq.1.set");if(R==null||N==null)throw"error";T.push({attr:R,array:N})}return M.array=T,M}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var E=function(y){var P={};try{var C=y.seq[0].oid,M=g.asn1.x509.OID.name2oid(C);P.type=g.asn1.x509.OID.oid2atype(M);var A=y.seq[1];if(A.utf8str!=null)P.ds="utf8",P.value=A.utf8str.str;else if(A.numstr!=null)P.ds="num",P.value=A.numstr.str;else if(A.telstr!=null)P.ds="tel",P.value=A.telstr.str;else if(A.prnstr!=null)P.ds="prn",P.value=A.prnstr.str;else if(A.ia5str!=null)P.ds="ia5",P.value=A.ia5str.str;else if(A.visstr!=null)P.ds="vis",P.value=A.visstr.str;else if(A.bmpstr!=null)P.ds="bmp",P.value=A.bmpstr.str;else throw"error";return P}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},F=function(y){try{return y.set.map(function(P){return E(P)})}catch(P){throw new Error("improper ASN.1 parsed RDN: "+P)}},I=function(y){try{return y.seq.map(function(P){return F(P)})}catch(P){throw new Error("improper ASN.1 parsed X500Name: "+P)}};this.getX500NameRule=function(y){for(var P=!0,C=!0,M=!1,A="",T="",k=null,D=[],R=0;R<y.length;R++)for(var N=y[R],L=0;L<N.length;L++)D.push(N[L]);for(var R=0;R<D.length;R++){var V=D[R],G=V.ds,re=V.value,te=V.type;if(A+=":"+G,G!="prn"&&G!="utf8"&&G!="ia5")return"mixed";if(G=="ia5"){if(te!="CN")return"mixed";if(g.lang.String.isMail(re))continue;return"mixed"}if(te=="C"){if(G=="prn")continue;return"mixed"}if(T+=":"+G,k==null)k=G;else if(k!==G)return"mixed"}return k??"prn"},this.getAttrTypeAndValue=function(y){var P=o(y);return E(P)},this.getRDN=function(y){var P=o(y);return F(P)},this.getX500NameArray=function(y){var P=o(y);return I(P)},this.getX500Name=function(y,P,C){var M=this.getX500NameArray(y),A=this.dnarraytostr(M),T={str:A};return T.array=M,C==!0&&(T.hex=y),P==!0&&(T.canon=this.c14nRDNArray(M)),T},this.readCertPEM=function(y){this.readCertHex(_(y))},this.readCertHex=function(y){this.hex=y,this.getVersion();try{u(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(y){var P={};return y==null&&(y={}),P.version=this.getVersion(),P.serial={hex:this.getSerialNumberHex()},P.sigalg=this.getSignatureAlgorithmField(),P.issuer=this.getIssuer(y.dncanon,y.dnhex),P.notbefore=this.getNotBefore(),P.notafter=this.getNotAfter(),P.subject=this.getSubject(y.dncanon,y.dnhex),P.sbjpubkey=un(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(P.ext=this.getExtParamArray()),P.sighex=this.getSignatureValueHex(),y.tbshex==!0&&(P.tbshex=l(this.hex,0,[0])),y.nodnarray==!0&&(delete P.issuer.array,delete P.subject.array),P},this.getExtParamArray=function(y){if(y==null){var P=d(this.hex,0,[0,"[3]"]);P!=-1&&(y=h(this.hex,0,[0,"[3]",0],"30"))}for(var C=[],M=t(y,0),A=0;A<M.length;A++){var T=a(y,M[A]),k=this.getExtParam(T);k!=null&&C.push(k)}return C},this.getExtParam=function(y){var P={},C=t(y,0),M=C.length;if(M!=2&&M!=3)throw new Error("wrong number elements in Extension: "+M+" "+y);var A=x(s(y,0,[0],"06")),T=!1;M==3&&l(y,0,[1])=="0101ff"&&(T=!0);var k=l(y,0,[M-1,0]),D=void 0;if(A=="2.5.29.14"?D=this.getExtSubjectKeyIdentifier(k,T):A=="2.5.29.15"?D=this.getExtKeyUsage(k,T):A=="2.5.29.17"?D=this.getExtSubjectAltName(k,T):A=="2.5.29.18"?D=this.getExtIssuerAltName(k,T):A=="2.5.29.19"?D=this.getExtBasicConstraints(k,T):A=="2.5.29.30"?D=this.getExtNameConstraints(k,T):A=="2.5.29.31"?D=this.getExtCRLDistributionPoints(k,T):A=="2.5.29.32"?D=this.getExtCertificatePolicies(k,T):A=="2.5.29.33"?D=this.getExtPolicyMappings(k,T):A=="2.5.29.35"?D=this.getExtAuthorityKeyIdentifier(k,T):A=="2.5.29.36"?D=this.getExtPolicyConstraints(k,T):A=="2.5.29.37"?D=this.getExtExtKeyUsage(k,T):A=="2.5.29.54"?D=this.getExtInhibitAnyPolicy(k,T):A=="1.3.6.1.5.5.7.1.1"?D=this.getExtAuthorityInfoAccess(k,T):A=="2.5.29.20"?D=this.getExtCRLNumber(k,T):A=="2.5.29.21"?D=this.getExtCRLReason(k,T):A=="2.5.29.9"?D=this.getExtSubjectDirectoryAttributes(k,T):A=="1.3.6.1.5.5.7.48.1.2"?D=this.getExtOcspNonce(k,T):A=="1.3.6.1.5.5.7.48.1.5"?D=this.getExtOcspNoCheck(k,T):A=="1.2.840.113583.1.1.9.1"?D=this.getExtAdobeTimeStamp(k,T):he.EXT_PARSER[A]!=null&&(D=he.EXT_PARSER[A](A,T,k)),D!=null)return D;var R={extname:A,extn:k};try{R.extn=o(k)}catch{}return T&&(R.critical=!0),R},this.findExt=function(y,P){for(var C=0;C<y.length;C++)if(y[C].extname==P)return y[C];return null},this.updateExtCDPFullURI=function(y,P){var C=this.findExt(y,"cRLDistributionPoints");if(C!=null&&C.array!=null){for(var M=C.array,A=0;A<M.length;A++)if(M[A].dpname!=null&&M[A].dpname.full!=null)for(var T=M[A].dpname.full,k=0;k<T.length;k++){var D=T[A];D.uri!=null&&(D.uri=P)}}},this.updateExtAIAOCSP=function(y,P){var C=this.findExt(y,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var M=C.array,A=0;A<M.length;A++)M[A].ocsp!=null&&(M[A].ocsp=P)},this.updateExtAIACAIssuer=function(y,P){var C=this.findExt(y,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var M=C.array,A=0;A<M.length;A++)M[A].caissuer!=null&&(M[A].caissuer=P)},this.dnarraytostr=function(y){function P(M){return M.map(function(A){return C(A).replace(/\+/,"\\+")}).join("+")}function C(M){return M.type+"="+M.value}return"/"+y.map(function(M){return P(M).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(y){var P;if(y.str!=null&&y.array==null){var C=new g.asn1.x509.X500Name({str:y.str}),M=C.tohex();P=this.getX500NameArray(M)}else P=y.array;y.canon==null&&(y.canon=this.c14nRDNArray(P))},this.c14nRDNArray=function(y){for(var P=[],C=0;C<y.length;C++){for(var M=y[C],A=[],T=0;T<M.length;T++){var k=M[T],D=k.value;D=D.replace(/^\s*/,""),D=D.replace(/\s*$/,""),D=D.replace(/\s+/g," "),D=D.toLowerCase(),A.push(k.type.toLowerCase()+"="+D)}P.push(A.join("+"))}return"/"+P.join("/")},this.getInfo=function(){var y=function(ze){for(var pe="",Ae="    ",Me=`
`,Ge=ze.array,St=0;St<Ge.length;St++){var $e=Ge[St];if($e.dn!=null&&(pe+=Ae+"dn: "+$e.dn.str+Me),$e.ip!=null&&(pe+=Ae+"ip: "+$e.ip+Me),$e.rfc822!=null&&(pe+=Ae+"rfc822: "+$e.rfc822+Me),$e.dns!=null&&(pe+=Ae+"dns: "+$e.dns+Me),$e.uri!=null&&(pe+=Ae+"uri: "+$e.uri+Me),$e.other!=null){var wn=$e.other.oid,vs=JSON.stringify($e.other.value).replace(/\"/g,"");pe+=Ae+"other: "+wn+"="+vs+Me}}return pe=pe.replace(/\n$/,""),pe},P=function(ze){for(var pe="",Ae=ze.array,Me=0;Me<Ae.length;Me++){var Ge=Ae[Me];if(pe+="    policy oid: "+Ge.policyoid+`
`,Ge.array!==void 0)for(var St=0;St<Ge.array.length;St++){var $e=Ge.array[St];$e.cps!==void 0&&(pe+="    cps: "+$e.cps+`
`)}}return pe},C=function(ze){for(var pe="",Ae=ze.array,Me=0;Me<Ae.length;Me++){var Ge=Ae[Me];try{Ge.dpname.full[0].uri!==void 0&&(pe+="    "+Ge.dpname.full[0].uri+`
`)}catch{}try{Ge.dname.full[0].dn.hex!==void 0&&(pe+="    "+he.hex2dn(Ge.dpname.full[0].dn.hex)+`
`)}catch{}}return pe},M=function(ze){for(var pe="",Ae=ze.array,Me=0;Me<Ae.length;Me++){var Ge=Ae[Me];Ge.caissuer!==void 0&&(pe+="    caissuer: "+Ge.caissuer+`
`),Ge.ocsp!==void 0&&(pe+="    ocsp: "+Ge.ocsp+`
`)}return pe},A=he,T,k,D;if(T=`Basic Fields
`,T+="  serial number: "+this.getSerialNumberHex()+`
`,T+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,T+="  issuer: "+this.getIssuerString()+`
`,T+="  notBefore: "+this.getNotBefore()+`
`,T+="  notAfter: "+this.getNotAfter()+`
`,T+="  subject: "+this.getSubjectString()+`
`,T+=`  subject public key info: 
`,k=this.getPublicKey(),T+="    key algorithm: "+k.type+`
`,k.type==="RSA"&&(T+="    n="+R0(k.n.toString(16)).substr(0,16)+`...
`,T+="    e="+R0(k.e.toString(16))+`
`),D=this.aExtInfo,D!=null){T+=`X509v3 Extensions:
`;for(var R=0;R<D.length;R++){var N=D[R],L=g.asn1.x509.OID.oid2name(N.oid);L===""&&(L=N.oid);var V="";if(N.critical===!0&&(V="CRITICAL"),T+="  "+L+" "+V+`:
`,L==="basicConstraints"){var G=this.getExtBasicConstraints();G.cA===void 0?T+=`    {}
`:(T+="    cA=true",G.pathLen!==void 0&&(T+=", pathLen="+G.pathLen),T+=`
`)}else if(L=="policyMappings"){var re=this.getExtPolicyMappings().array,te=re.map(function(ze){var pe=ze;return pe[0]+":"+pe[1]}).join(", ");T+="    "+te+`
`}else if(L=="policyConstraints"){var be=this.getExtPolicyConstraints();T+="    ",be.reqexp!=null&&(T+=" reqexp="+be.reqexp),be.inhibit!=null&&(T+=" inhibit="+be.inhibit),T+=`
`}else if(L=="inhibitAnyPolicy"){var be=this.getExtInhibitAnyPolicy();T+="    skip="+be.skip+`
`}else if(L=="keyUsage")T+="    "+this.getExtKeyUsageString()+`
`;else if(L=="subjectKeyIdentifier")T+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(L=="authorityKeyIdentifier"){var ge=this.getExtAuthorityKeyIdentifier();ge.kid!==void 0&&(T+="    kid="+ge.kid.hex+`
`)}else if(L=="extKeyUsage"){var rt=this.getExtExtKeyUsage().array;T+="    "+rt.join(", ")+`
`}else if(L=="subjectAltName"){var He=y(this.getExtSubjectAltName());T+=He+`
`}else if(L=="cRLDistributionPoints"){var Ue=this.getExtCRLDistributionPoints();T+=C(Ue)}else if(L=="authorityInfoAccess"){var Ke=this.getExtAuthorityInfoAccess();T+=M(Ke)}else L=="certificatePolicies"&&(T+=P(this.getExtCertificatePolicies()))}}return T+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,T+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,T},typeof n=="string"&&(n.indexOf("-----BEGIN")!=-1?this.readCertPEM(n):g.lang.String.isHex(n)&&this.readCertHex(n))}he.EXT_PARSER={};he.registExtParser=function(n,e){he.EXT_PARSER[n]=e};he.hex2dn=function(n,e){e===void 0&&(e=0);var t=new he,r=$.getTLV(n,e),i=t.getX500Name(n);return i.str};he.hex2rdn=function(n,e){if(e===void 0&&(e=0),n.substr(e,2)!=="31")throw new Error("malformed RDN");for(var t=new Array,r=$.getChildIdx(n,e),i=0;i<r.length;i++)t.push(he.hex2attrTypeValue(n,r[i]));return t=t.map(function(o){return o.replace("+","\\+")}),t.join("+")};he.hex2attrTypeValue=function(n,e){var t=$,r=t.getV;if(e===void 0&&(e=0),n.substr(e,2)!=="30")throw new Error("malformed attribute type and value");var i=t.getChildIdx(n,e);i.length!==2||n.substr(i[0],2);var o=r(n,i[0]),a=g.asn1.ASN1Util.oidHexToInt(o),s=g.asn1.x509.OID.oid2atype(a),c=r(n,i[1]),l=In(c);return s+"="+l};he.getPublicKeyFromCertHex=function(n){var e=new he;return e.readCertHex(n),e.getPublicKey()};he.getPublicKeyFromCertPEM=function(n){var e=new he;return e.readCertPEM(n),e.getPublicKey()};he.getPublicKeyInfoPropOfCertPEM=function(n){var e=$,t=e.getVbyList,r={},i,o,a;return r.algparam=null,i=new he,i.readCertPEM(n),o=i.getPublicKeyHex(),r.keyhex=t(o,0,[1],"03").substr(2),r.algoid=t(o,0,[0,0],"06"),r.algoid==="2a8648ce3d0201"&&(r.algparam=t(o,0,[0,1],"06")),r};he.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var LW=function(n){var e=g,t=e.lang.String.isHex,r=$,i=r.getV,o=r.getTLV,a=r.getVbyList,s=r.getTLVbyList,c=r.getTLVbyListEx,l=r.getIdxbyList,h=r.getIdxbyListEx,u=r.getChildIdx,d=new he;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var p=l(this.hex,0,[0,0]),m=this.hex.substr(p,2);if(m=="02")this.posSigAlg=1;else if(m=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+m);var f=l(this.hex,0,[0,this.posSigAlg+3]),x=this.hex.substr(f,2);if(x=="17"||x=="18"){var b,_;b=l(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,b!=-1&&(_=this.hex.substr(b,2),_=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(x=="30")this.posRevCert=this.posSigAlg+3;else if(x=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+x)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(a(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var p=s(this.hex,0,[0,this.posSigAlg],"30");return d.getAlgorithmIdentifierName(p)},this.getIssuer=function(){return d.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return s(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var p=a(this.hex,0,[0,this.posSigAlg+2]);return result=In(p)},this.getNextUpdate=function(){var p=l(this.hex,0,[0,this.posSigAlg+3]),m=this.hex.substr(p,2);return m!="17"&&m!="18"?null:In(i(this.hex,p))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var p=[],m=l(this.hex,0,[0,this.posRevCert]),f=u(this.hex,m),x=0;x<f.length;x++){var b=o(this.hex,f[x]);p.push(this.getRevCert(b))}return p},this.getRevCert=function(p){var m={},f=u(p,0);return m.sn={hex:a(p,0,[0],"02")},m.date=In(a(p,0,[1])),f.length==3&&(m.ext=d.getExtParamArray(s(p,0,[2]))),m},this.findRevCert=function(p){var m=new he(p),f=m.getSerialNumberHex();return this.findRevCertBySN(f)},this.findRevCertBySN=function(p){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var m=this.parsed.revcert,f=0;f<m.length;f++)if(p==m[f].sn.hex)return m[f];return null},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(p){var m=this.getSignatureAlgorithmField(),f=this.getSignatureValueHex(),x=s(this.hex,0,[0],"30"),b=new g.crypto.Signature({alg:m});return b.init(p),b.updateHex(x),b.verify(f)},this.getParam=function(p){var m={},f=this.getVersion();f!=null&&(m.version=f),m.sigalg=this.getSignatureAlgorithmField(),m.issuer=this.getIssuer(),m.thisupdate=this.getThisUpdate();var x=this.getNextUpdate();x!=null&&(m.nextupdate=x);var b=this.getRevCertArray();b!=null&&(m.revcert=b);var _=h(this.hex,0,[0,"[0]"]);if(_!=-1){var O=c(this.hex,0,[0,"[0]",0]);m.ext=d.getExtParamArray(O)}return m.sighex=this.getSignatureValueHex(),this.parsed=m,typeof p=="object"&&(p.tbshex==!0&&(m.tbshex=s(this.hex,0,[0])),p.nodnarray==!0&&delete m.issuer.array),m},typeof n=="string"&&(t(n)?this.hex=n:n.match(/-----BEGIN X509 CRL/)&&(this.hex=xt(n)),this._setPos())};(typeof g>"u"||!g)&&(g={});(typeof g.jws>"u"||!g.jws)&&(g.jws={});g.jws.JWS=function(){var n=g,e=n.jws.JWS,t=e.isSafeJSONString;this.parseJWS=function(r,i){if(!(this.parsedJWS!==void 0&&(i||this.parsedJWS.sigvalH!==void 0))){var o=r.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(o==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var a=o[1],s=o[2],c=o[3],l=a+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=a,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=c,this.parsedJWS.si=l,!i){var h=gt(c),u=Tn(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=u}var d=gr(a),p=gr(s);if(this.parsedJWS.headS=d,this.parsedJWS.payloadS=p,!t(d,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+d}}};g.jws.JWS.sign=function(n,e,t,r,i){var o=g,a=o.jws,s=a.JWS,c=s.readSafeJSONString,l=s.isSafeJSONString,h=o.crypto,u=h.ECDSA,d=h.Mac,p=h.Signature,m=JSON,f,x,b;if(typeof e!="string"&&typeof e!="object")throw"spHeader must be JSON string or object: "+e;if(typeof e=="object"&&(x=e,f=m.stringify(x)),typeof e=="string"){if(f=e,!l(f))throw"JWS Head is not safe JSON string: "+f;x=c(f)}if(b=t,typeof t=="object"&&(b=m.stringify(t)),(n==""||n==null)&&x.alg!==void 0&&(n=x.alg),n!=""&&n!=null&&x.alg===void 0&&(x.alg=n,f=m.stringify(x)),n!==x.alg)throw"alg and sHeader.alg doesn't match: "+n+"!="+x.alg;var _=null;if(s.jwsalg2sigalg[n]===void 0)throw"unsupported alg name: "+n;_=s.jwsalg2sigalg[n];var O=al(f),S=al(b),E=O+"."+S,F="";if(_.substr(0,4)=="Hmac"){if(r===void 0)throw"mac key shall be specified for HS* alg";var I=new d({alg:_,prov:"cryptojs",pass:r});I.updateString(E),F=I.doFinal()}else if(_.indexOf("withECDSA")!=-1){var y=new p({alg:_});y.init(r,i),y.updateString(E);var P=y.sign();F=g.crypto.ECDSA.asn1SigToConcatSig(P)}else if(_!="none"){var y=new p({alg:_});y.init(r,i),y.updateString(E),F=y.sign()}var C=Tt(F);return E+"."+C};g.jws.JWS.verify=function(n,e,t){var r=g,i=r.jws,o=i.JWS,a=o.readSafeJSONString,s=r.crypto,c=s.ECDSA,l=s.Mac,h=s.Signature,u;if(typeof ve!==void 0&&(u=ve),!G0(n))return!1;var d=n.split(".");if(d.length!==3)return!1;var p=d[0],m=d[1],f=p+"."+m,x=gt(d[2]),b=a(gr(d[0])),_=null,O=null;if(b.alg===void 0)throw"algorithm not specified in header";if(_=b.alg,O=_.substr(0,2),t!=null&&Object.prototype.toString.call(t)==="[object Array]"&&t.length>0){var S=":"+t.join(":")+":";if(S.indexOf(":"+_+":")==-1)throw"algorithm '"+_+"' not accepted in the list"}if(_!="none"&&e===null)throw"key shall be specified to verify.";if(typeof e=="string"&&e.indexOf("-----BEGIN ")!=-1&&(e=Se.getKey(e)),(O=="RS"||O=="PS")&&!(e instanceof u))throw"key shall be a RSAKey obj for RS* and PS* algs";if(O=="ES"&&!(e instanceof c))throw"key shall be a ECDSA obj for ES* algs";_=="none";var E=null;if(o.jwsalg2sigalg[b.alg]===void 0)throw"unsupported alg name: "+_;if(E=o.jwsalg2sigalg[_],E=="none")throw"not supported";if(E.substr(0,4)=="Hmac"){var F=null;if(e===void 0)throw"hexadecimal key shall be specified for HMAC";var I=new l({alg:E,pass:e});return I.updateString(f),F=I.doFinal(),x==F}else if(E.indexOf("withECDSA")!=-1){var y=null;try{y=c.concatSigToASN1Sig(x)}catch{return!1}var P=new h({alg:E});return P.init(e),P.updateString(f),P.verify(y)}else{var P=new h({alg:E});return P.init(e),P.updateString(f),P.verify(x)}};g.jws.JWS.parse=function(n){var e=n.split("."),t={},r,i,o;if(e.length!=2&&e.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return r=e[0],i=e[1],e.length==3&&(o=e[2]),t.headerObj=g.jws.JWS.readSafeJSONString(gr(r)),t.payloadObj=g.jws.JWS.readSafeJSONString(gr(i)),t.headerPP=JSON.stringify(t.headerObj,null,"  "),t.payloadObj==null?t.payloadPP=gr(i):t.payloadPP=JSON.stringify(t.payloadObj,null,"  "),o!==void 0&&(t.sigHex=gt(o)),t};g.jws.JWS.verifyJWT=function(n,e,t){var r=g,i=r.jws,o=i.JWS,a=o.readSafeJSONString,s=o.inArray,c=o.includedArray;if(!G0(n))return!1;var l=n.split(".");if(l.length!=3)return!1;var h=l[0],u=l[1],d=h+"."+u,p=gt(l[2]),m=a(gr(h)),f=a(gr(u));if(m.alg===void 0)return!1;if(t.alg===void 0)throw"acceptField.alg shall be specified";if(!s(m.alg,t.alg)||f.iss!==void 0&&typeof t.iss=="object"&&!s(f.iss,t.iss)||f.sub!==void 0&&typeof t.sub=="object"&&!s(f.sub,t.sub))return!1;if(f.aud!==void 0&&typeof t.aud=="object"){if(typeof f.aud=="string"){if(!s(f.aud,t.aud))return!1}else if(typeof f.aud=="object"&&!c(f.aud,t.aud))return!1}var x=i.IntDate.getNow();return t.verifyAt!==void 0&&typeof t.verifyAt=="number"&&(x=t.verifyAt),(t.gracePeriod===void 0||typeof t.gracePeriod!="number")&&(t.gracePeriod=0),!(f.exp!==void 0&&typeof f.exp=="number"&&f.exp+t.gracePeriod<x||f.nbf!==void 0&&typeof f.nbf=="number"&&x<f.nbf-t.gracePeriod||f.iat!==void 0&&typeof f.iat=="number"&&x<f.iat-t.gracePeriod||f.jti!==void 0&&t.jti!==void 0&&f.jti!==t.jti||!o.verify(n,e,t.alg))};g.jws.JWS.includedArray=function(n,e){var t=g.jws.JWS.inArray;if(n===null||typeof n!="object"||typeof n.length!="number")return!1;for(var r=0;r<n.length;r++)if(!t(n[r],e))return!1;return!0};g.jws.JWS.inArray=function(n,e){if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var t=0;t<e.length;t++)if(e[t]==n)return!0;return!1};g.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};g.jws.JWS.isSafeJSONString=function(n,e,t){var r=null;try{return r=vk(n),typeof r!="object"||r.constructor===Array?0:(e&&(e[t]=r),1)}catch{return 0}};g.jws.JWS.readSafeJSONString=function(n){var e=null;try{return e=vk(n),typeof e!="object"||e.constructor===Array?null:e}catch{return null}};g.jws.JWS.getEncodedSignatureValueFromJWS=function(n){var e=n.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(e==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]};g.jws.JWS.getJWKthumbprint=function(n){if(n.kty!=="RSA"&&n.kty!=="EC"&&n.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var e="{";if(n.kty==="RSA"){if(typeof n.n!="string"||typeof n.e!="string")throw"wrong n and e value for RSA key";e+='"e":"'+n.e+'",',e+='"kty":"'+n.kty+'",',e+='"n":"'+n.n+'"}'}else if(n.kty==="EC"){if(typeof n.crv!="string"||typeof n.x!="string"||typeof n.y!="string")throw"wrong crv, x and y value for EC key";e+='"crv":"'+n.crv+'",',e+='"kty":"'+n.kty+'",',e+='"x":"'+n.x+'",',e+='"y":"'+n.y+'"}'}else if(n.kty==="oct"){if(typeof n.k!="string")throw"wrong k value for oct(symmetric) key";e+='"kty":"'+n.kty+'",',e+='"k":"'+n.k+'"}'}var t=Ir(e),r=g.crypto.Util.hashHex(t,"sha256"),i=Tt(r);return i};g.jws.IntDate={};g.jws.IntDate.get=function(n){var e=g.jws.IntDate,t=e.getNow,r=e.getZulu;if(n=="now")return t();if(n=="now + 1hour")return t()+60*60;if(n=="now + 1day")return t()+60*60*24;if(n=="now + 1month")return t()+60*60*24*30;if(n=="now + 1year")return t()+60*60*24*365;if(n.match(/Z$/))return r(n);if(n.match(/^[0-9]+$/))return parseInt(n);throw"unsupported format: "+n};g.jws.IntDate.getZulu=function(n){return yk(n)};g.jws.IntDate.getNow=function(){var n=~~(new Date/1e3);return n};g.jws.IntDate.intDate2UTCString=function(n){var e=new Date(n*1e3);return e.toUTCString()};g.jws.IntDate.intDate2Zulu=function(n){var e=new Date(n*1e3),t=("0000"+e.getUTCFullYear()).slice(-4),r=("00"+(e.getUTCMonth()+1)).slice(-2),i=("00"+e.getUTCDate()).slice(-2),o=("00"+e.getUTCHours()).slice(-2),a=("00"+e.getUTCMinutes()).slice(-2),s=("00"+e.getUTCSeconds()).slice(-2);return t+r+i+o+a+s+"Z"};(typeof g>"u"||!g)&&(g={});(typeof g.jws>"u"||!g.jws)&&(g.jws={});g.jws.JWSJS=function(){var n=g,e=n.jws,t=e.JWS,r=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(i){this.init();var o=i.split(".");if(o.length!=3)throw"malformed input JWS";this.aHeader.push(o[0]),this.sPayload=o[1],this.aSignature.push(o[2])},this.addSignature=function(i,o,a,s){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var c=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var l=g.jws.JWS.sign(i,o,this.sPayload,a,s),h=l.split("."),u=h[0],d=h[2];this.aHeader.push(h[0]),this.aSignature.push(h[2])}catch(p){throw this.aHeader.length>c&&this.aHeader.pop(),this.aSignature.length>c&&this.aSignature.pop(),"addSignature failed: "+p}},this.verifyAll=function(i){if(this.aHeader.length!==i.length||this.aSignature.length!==i.length)return!1;for(var o=0;o<i.length;o++){var a=i[o];if(a.length!==2)return!1;var s=this.verifyNth(o,a[0],a[1]);if(s===!1)return!1}return!0},this.verifyNth=function(i,o,a){if(this.aHeader.length<=i||this.aSignature.length<=i)return!1;var s=this.aHeader[i],c=this.aSignature[i],l=s+"."+this.sPayload+"."+c,h=!1;try{h=t.verify(l,o,a)}catch{return!1}return h},this.readJWSJS=function(i){if(typeof i=="string"){var o=r(i);if(o==null)throw"argument is not safe JSON object string";this.aHeader=o.headers,this.sPayload=o.payload,this.aSignature=o.signatures}else try{if(i.headers.length>0)this.aHeader=i.headers;else throw"malformed header";if(typeof i.payload=="string")this.sPayload=i.payload;else throw"malformed signatures";if(i.signatures.length>0)this.aSignature=i.signatures;else throw"malformed signatures"}catch(a){throw"malformed JWS-JS JSON object: "+a}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};J.SecureRandom=ss;J.rng_seed_time=L0;J.BigInteger=B;J.RSAKey=ve;J.ECDSA=g.crypto.ECDSA;J.DSA=g.crypto.DSA;J.Signature=g.crypto.Signature;J.MessageDigest=g.crypto.MessageDigest;J.Mac=g.crypto.Mac;J.KEYUTIL=Se;J.ASN1HEX=$;J.X509=he;J.X509CRL=LW;J.CryptoJS=Q;J.b64tohex=is;J.b64toBA=hk;J.ECFieldElementFp=zt;J.ECPointFp=qe;J.ECCurveFp=ei;J.stoBA=bk;J.BAtos=xk;J.BAtohex=gp;J.stohex=zn;J.stob64=_W;J.stob64u=yW;J.b64utos=CW;J.b64tob64u=rs;J.b64utob64=cl;J.hex2b64=Zr;J.hextob64u=Tt;J.b64utohex=gt;J.utf8tob64u=al;J.b64utoutf8=gr;J.utf8tob64=wW;J.b64toutf8=PW;J.utf8tohex=fp;J.hextoutf8=Ve;J.hextorstr=In;J.rstrtohex=Ir;J.hextob64=j0;J.hextob64nl=SW;J.b64nltohex=_k;J.hextopem=un;J.pemtohex=xt;J.hextoArrayBuffer=kW;J.ArrayBuffertohex=DW;J.zulutomsec=V0;J.msectozulu=FW;J.zulutosec=yk;J.zulutodate=TW;J.datetozulu=zW;J.uricmptohex=vp;J.hextouricmp=bp;J.ipv6tohex=z0;J.hextoipv6=I0;J.hextoip=lp;J.iptohex=H0;J.ucs2hextoutf8=U0;J.encodeURIComponentAll=xp;J.newline_toUnix=IW;J.newline_toDos=RW;J.hextoposhex=R0;J.intarystrtohex=NW;J.strdiffidx=BW;J.oidtohex=Pk;J.hextooid=_p;J.strpad=dp;J.bitstrtoint=Mk;J.inttobitstr=Sk;J.bitstrtobinstr=Ek;J.binstrtobitstr=qW;J.isBase64URLDot=G0;J.namearraytobinstr=up;J.extendClass=U;J.foldnl=mp;J.b64topem=EW;J.pemtob64=AW;J.timeogen=Ck;J.aryval=et;J.inttohex=Ok;J.twoscompl=ll;J.KJUR=g;J.crypto=g.crypto;J.asn1=g.asn1;J.jws=g.jws;J.lang=g.lang;J.VERSION=XH;J.VERSION_FULL=JH});var Nk=z((Dme,Rk)=>{"use strict";function jW(n,e){return Object.prototype.hasOwnProperty.call(n,e)}Rk.exports=function(n,e,t,r){e=e||"&",t=t||"=";var i={};if(typeof n!="string"||n.length===0)return i;var o=/\+/g;n=n.split(e);var a=1e3;r&&typeof r.maxKeys=="number"&&(a=r.maxKeys);var s=n.length;a>0&&s>a&&(s=a);for(var c=0;c<s;++c){var l=n[c].replace(o,"%20"),h=l.indexOf(t),u,d,p,m;h>=0?(u=l.substr(0,h),d=l.substr(h+1)):(u=l,d=""),p=decodeURIComponent(u),m=decodeURIComponent(d),jW(i,p)?Array.isArray(i[p])?i[p].push(m):i[p]=[i[p],m]:i[p]=m}return i}});var qk=z((Fme,Bk)=>{"use strict";var ul=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};Bk.exports=function(n,e,t,r){return e=e||"&",t=t||"=",n===null&&(n=void 0),typeof n=="object"?Object.keys(n).map(function(i){var o=encodeURIComponent(ul(i))+t;return Array.isArray(n[i])?n[i].map(function(a){return o+encodeURIComponent(ul(a))}).join(e):o+encodeURIComponent(ul(n[i]))}).filter(Boolean).join(e):r?encodeURIComponent(ul(r))+t+encodeURIComponent(ul(n)):""}});var Lk=z(hl=>{"use strict";hl.decode=hl.parse=Nk();hl.encode=hl.stringify=qk()});var $0=z((K0,Vk)=>{K0=Vk.exports=VW;K0.getSerialize=jk;function VW(n,e,t,r){return JSON.stringify(n,jk(e,r),t)}function jk(n,e){var t=[],r=[];return e==null&&(e=function(i,o){return t[0]===o?"[Circular ~]":"[Circular ~."+r.slice(0,t.indexOf(o)).join(".")+"]"}),function(i,o){if(t.length>0){var a=t.indexOf(this);~a?t.splice(a+1):t.push(this),~a?r.splice(a,1/0,i):r.push(i),~t.indexOf(o)&&(o=e.call(this,i,o))}else t.push(o);return n==null?o:n.call(this,i,o)}}});var F3=z((ii,D3)=>{var k3=typeof self<"u"?self:ii,Wp=function(){function n(){this.fetch=!1,this.DOMException=k3.DOMException}return n.prototype=k3,new n}();(function(n){var e=function(t){var r={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function i(C){return C&&DataView.prototype.isPrototypeOf(C)}if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(C){return C&&o.indexOf(Object.prototype.toString.call(C))>-1};function s(C){if(typeof C!="string"&&(C=String(C)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(C))throw new TypeError("Invalid character in header field name");return C.toLowerCase()}function c(C){return typeof C!="string"&&(C=String(C)),C}function l(C){var M={next:function(){var A=C.shift();return{done:A===void 0,value:A}}};return r.iterable&&(M[Symbol.iterator]=function(){return M}),M}function h(C){this.map={},C instanceof h?C.forEach(function(M,A){this.append(A,M)},this):Array.isArray(C)?C.forEach(function(M){this.append(M[0],M[1])},this):C&&Object.getOwnPropertyNames(C).forEach(function(M){this.append(M,C[M])},this)}h.prototype.append=function(C,M){C=s(C),M=c(M);var A=this.map[C];this.map[C]=A?A+", "+M:M},h.prototype.delete=function(C){delete this.map[s(C)]},h.prototype.get=function(C){return C=s(C),this.has(C)?this.map[C]:null},h.prototype.has=function(C){return this.map.hasOwnProperty(s(C))},h.prototype.set=function(C,M){this.map[s(C)]=c(M)},h.prototype.forEach=function(C,M){for(var A in this.map)this.map.hasOwnProperty(A)&&C.call(M,this.map[A],A,this)},h.prototype.keys=function(){var C=[];return this.forEach(function(M,A){C.push(A)}),l(C)},h.prototype.values=function(){var C=[];return this.forEach(function(M){C.push(M)}),l(C)},h.prototype.entries=function(){var C=[];return this.forEach(function(M,A){C.push([A,M])}),l(C)},r.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function u(C){if(C.bodyUsed)return Promise.reject(new TypeError("Already read"));C.bodyUsed=!0}function d(C){return new Promise(function(M,A){C.onload=function(){M(C.result)},C.onerror=function(){A(C.error)}})}function p(C){var M=new FileReader,A=d(M);return M.readAsArrayBuffer(C),A}function m(C){var M=new FileReader,A=d(M);return M.readAsText(C),A}function f(C){for(var M=new Uint8Array(C),A=new Array(M.length),T=0;T<M.length;T++)A[T]=String.fromCharCode(M[T]);return A.join("")}function x(C){if(C.slice)return C.slice(0);var M=new Uint8Array(C.byteLength);return M.set(new Uint8Array(C)),M.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(C){this._bodyInit=C,C?typeof C=="string"?this._bodyText=C:r.blob&&Blob.prototype.isPrototypeOf(C)?this._bodyBlob=C:r.formData&&FormData.prototype.isPrototypeOf(C)?this._bodyFormData=C:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)?this._bodyText=C.toString():r.arrayBuffer&&r.blob&&i(C)?(this._bodyArrayBuffer=x(C.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(C)||a(C))?this._bodyArrayBuffer=x(C):this._bodyText=C=Object.prototype.toString.call(C):this._bodyText="",this.headers.get("content-type")||(typeof C=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var C=u(this);if(C)return C;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var C=u(this);if(C)return C;if(this._bodyBlob)return m(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(f(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function O(C){var M=C.toUpperCase();return _.indexOf(M)>-1?M:C}function S(C,M){M=M||{};var A=M.body;if(C instanceof S){if(C.bodyUsed)throw new TypeError("Already read");this.url=C.url,this.credentials=C.credentials,M.headers||(this.headers=new h(C.headers)),this.method=C.method,this.mode=C.mode,this.signal=C.signal,!A&&C._bodyInit!=null&&(A=C._bodyInit,C.bodyUsed=!0)}else this.url=String(C);if(this.credentials=M.credentials||this.credentials||"same-origin",(M.headers||!this.headers)&&(this.headers=new h(M.headers)),this.method=O(M.method||this.method||"GET"),this.mode=M.mode||this.mode||null,this.signal=M.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&A)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(A)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function E(C){var M=new FormData;return C.trim().split("&").forEach(function(A){if(A){var T=A.split("="),k=T.shift().replace(/\+/g," "),D=T.join("=").replace(/\+/g," ");M.append(decodeURIComponent(k),decodeURIComponent(D))}}),M}function F(C){var M=new h,A=C.replace(/\r?\n[\t ]+/g," ");return A.split(/\r?\n/).forEach(function(T){var k=T.split(":"),D=k.shift().trim();if(D){var R=k.join(":").trim();M.append(D,R)}}),M}b.call(S.prototype);function I(C,M){M||(M={}),this.type="default",this.status=M.status===void 0?200:M.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in M?M.statusText:"OK",this.headers=new h(M.headers),this.url=M.url||"",this._initBody(C)}b.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},I.error=function(){var C=new I(null,{status:0,statusText:""});return C.type="error",C};var y=[301,302,303,307,308];I.redirect=function(C,M){if(y.indexOf(M)===-1)throw new RangeError("Invalid status code");return new I(null,{status:M,headers:{location:C}})},t.DOMException=n.DOMException;try{new t.DOMException}catch{t.DOMException=function(M,A){this.message=M,this.name=A;var T=Error(M);this.stack=T.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function P(C,M){return new Promise(function(A,T){var k=new S(C,M);if(k.signal&&k.signal.aborted)return T(new t.DOMException("Aborted","AbortError"));var D=new XMLHttpRequest;function R(){D.abort()}D.onload=function(){var N={status:D.status,statusText:D.statusText,headers:F(D.getAllResponseHeaders()||"")};N.url="responseURL"in D?D.responseURL:N.headers.get("X-Request-URL");var L="response"in D?D.response:D.responseText;A(new I(L,N))},D.onerror=function(){T(new TypeError("Network request failed"))},D.ontimeout=function(){T(new TypeError("Network request failed"))},D.onabort=function(){T(new t.DOMException("Aborted","AbortError"))},D.open(k.method,k.url,!0),k.credentials==="include"?D.withCredentials=!0:k.credentials==="omit"&&(D.withCredentials=!1),"responseType"in D&&r.blob&&(D.responseType="blob"),k.headers.forEach(function(N,L){D.setRequestHeader(L,N)}),k.signal&&(k.signal.addEventListener("abort",R),D.onreadystatechange=function(){D.readyState===4&&k.signal.removeEventListener("abort",R)}),D.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return P.polyfill=!0,n.fetch||(n.fetch=P,n.Headers=h,n.Request=S,n.Response=I),t.Headers=h,t.Request=S,t.Response=I,t.fetch=P,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(Wp);Wp.fetch.ponyfill=!0;delete Wp.fetch.polyfill;var us=Wp;ii=us.fetch;ii.default=us.fetch;ii.fetch=us.fetch;ii.Headers=us.Headers;ii.Request=us.Request;ii.Response=us.Response;D3.exports=ii});var I3=z((oxe,z3)=>{"use strict";z3.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var B3=z(fb=>{"use strict";var mK=Object.prototype.hasOwnProperty,vK;function R3(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch{return null}}function N3(n){try{return encodeURIComponent(n)}catch{return null}}function bK(n){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},r;r=e.exec(n);){var i=R3(r[1]),o=R3(r[2]);i===null||o===null||i in t||(t[i]=o)}return t}function xK(n,e){e=e||"";var t=[],r,i;typeof e!="string"&&(e="?");for(i in n)if(mK.call(n,i)){if(r=n[i],!r&&(r===null||r===vK||isNaN(r))&&(r=""),i=N3(i),r=N3(r),i===null||r===null)continue;t.push(i+"="+r)}return t.length?e+t.join("&"):""}fb.stringify=xK;fb.parse=bK});var W3=z((sxe,G3)=>{"use strict";var L3=I3(),Jp=B3(),_K=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,j3=/[\n\r\t]/g,yK=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,V3=/:\d+$/,CK=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,wK=/^[a-zA-Z]:/;function vb(n){return(n||"").toString().replace(_K,"")}var mb=[["#","hash"],["?","query"],function(e,t){return Rr(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],q3={hash:1,query:1};function H3(n){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var t=e.location||{};n=n||t;var r={},i=typeof n,o;if(n.protocol==="blob:")r=new Nr(unescape(n.pathname),{});else if(i==="string"){r=new Nr(n,{});for(o in q3)delete r[o]}else if(i==="object"){for(o in n)o in q3||(r[o]=n[o]);r.slashes===void 0&&(r.slashes=yK.test(n.href))}return r}function Rr(n){return n==="file:"||n==="ftp:"||n==="http:"||n==="https:"||n==="ws:"||n==="wss:"}function U3(n,e){n=vb(n),n=n.replace(j3,""),e=e||{};var t=CK.exec(n),r=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],a=0,s;return i?o?(s=t[2]+t[3]+t[4],a=t[2].length+t[3].length):(s=t[2]+t[4],a=t[2].length):o?(s=t[3]+t[4],a=t[3].length):s=t[4],r==="file:"?a>=2&&(s=s.slice(2)):Rr(r)?s=t[4]:r?i&&(s=s.slice(2)):a>=2&&Rr(e.protocol)&&(s=t[4]),{protocol:r,slashes:i||Rr(r),slashesCount:a,rest:s}}function PK(n,e){if(n==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(n.split("/")),r=t.length,i=t[r-1],o=!1,a=0;r--;)t[r]==="."?t.splice(r,1):t[r]===".."?(t.splice(r,1),a++):a&&(r===0&&(o=!0),t.splice(r,1),a--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function Nr(n,e,t){if(n=vb(n),n=n.replace(j3,""),!(this instanceof Nr))return new Nr(n,e,t);var r,i,o,a,s,c,l=mb.slice(),h=typeof e,u=this,d=0;for(h!=="object"&&h!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=Jp.parse),e=H3(e),i=U3(n||"",e),r=!i.protocol&&!i.slashes,u.slashes=i.slashes||r&&e.slashes,u.protocol=i.protocol||e.protocol||"",n=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||wK.test(n))||!i.slashes&&(i.protocol||i.slashesCount<2||!Rr(u.protocol)))&&(l[3]=[/(.*)/,"pathname"]);d<l.length;d++){if(a=l[d],typeof a=="function"){n=a(n,u);continue}o=a[0],c=a[1],o!==o?u[c]=n:typeof o=="string"?(s=o==="@"?n.lastIndexOf(o):n.indexOf(o),~s&&(typeof a[2]=="number"?(u[c]=n.slice(0,s),n=n.slice(s+a[2])):(u[c]=n.slice(s),n=n.slice(0,s)))):(s=o.exec(n))&&(u[c]=s[1],n=n.slice(0,s.index)),u[c]=u[c]||r&&a[3]&&e[c]||"",a[4]&&(u[c]=u[c].toLowerCase())}t&&(u.query=t(u.query)),r&&e.slashes&&u.pathname.charAt(0)!=="/"&&(u.pathname!==""||e.pathname!=="")&&(u.pathname=PK(u.pathname,e.pathname)),u.pathname.charAt(0)!=="/"&&Rr(u.protocol)&&(u.pathname="/"+u.pathname),L3(u.port,u.protocol)||(u.host=u.hostname,u.port=""),u.username=u.password="",u.auth&&(s=u.auth.indexOf(":"),~s?(u.username=u.auth.slice(0,s),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=u.auth.slice(s+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(u.auth)),u.auth=u.password?u.username+":"+u.password:u.username),u.origin=u.protocol!=="file:"&&Rr(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString()}function OK(n,e,t){var r=this;switch(n){case"query":typeof e=="string"&&e.length&&(e=(t||Jp.parse)(e)),r[n]=e;break;case"port":r[n]=e,L3(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[n]="");break;case"hostname":r[n]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[n]=e,V3.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!t;break;case"pathname":case"hash":if(e){var i=n==="pathname"?"/":"#";r[n]=e.charAt(0)!==i?i+e:e}else r[n]=e;break;case"username":case"password":r[n]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(r.username=e.slice(0,o),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(o+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<mb.length;a++){var s=mb[a];s[4]&&(r[s[1]]=r[s[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin=r.protocol!=="file:"&&Rr(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function MK(n){(!n||typeof n!="function")&&(n=Jp.stringify);var e,t=this,r=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Rr(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Rr(t.protocol)&&!r&&t.pathname!=="/"&&(o+="@"),(r[r.length-1]===":"||V3.test(t.hostname)&&!t.port)&&(r+=":"),o+=r+t.pathname,e=typeof t.query=="object"?n(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}Nr.prototype={set:OK,toString:MK};Nr.extractProtocol=U3;Nr.location=H3;Nr.trimLeft=vb;Nr.qs=Jp;G3.exports=Nr});var $3=W(()=>{});var X3=W(()=>{});var J3=W(()=>{});var Q3,Y3,Z3=W(()=>{Q3=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(Q3||{}),Y3=function(n){return n.ThrottlingError="ThrottlingError",n.InvalidScopeError="InvalidScopeError",n.BadRequestError="BadRequestError",n.LimitExceededError="LimitExceededError",n}(Y3||{})});var e5,t5,n5=W(()=>{e5=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(e5||{}),t5=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(t5||{})});var r5,i5=W(()=>{r5=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(r5||{})});var o5=W(()=>{});var a5=W(()=>{});var s5,c5=W(()=>{s5=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(s5||{})});var l5=W(()=>{});var Cb={};Zi(Cb,{FileMode:()=>e5,MessageType:()=>Q3,NackErrorType:()=>Y3,ScopeType:()=>s5,SummaryType:()=>r5,TreeEntry:()=>t5});var wb=W(()=>{$3();X3();J3();Z3();n5();i5();o5();a5();c5();l5();});var d5=z(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.generateUser=hs.generateToken=void 0;var DK=Fk(),Pb=(Nt(),Zt(pc));function FK(n,e,t,r,i,o=60*60,a="1.0"){let s=i||Ob();(s.id===""||s.id===void 0)&&(s=Ob());let c=Math.round(Date.now()/1e3),h={documentId:r??"",scopes:t,tenantId:n,user:s,iat:c,exp:c+o,ver:a,jti:(0,Pb.v4)()},u={utf8:e};return DK.KJUR.jws.JWS.sign(null,JSON.stringify({alg:"HS256",typ:"JWT"}),h,u)}hs.generateToken=FK;function Ob(){return{id:(0,Pb.v4)(),name:(0,Pb.v4)()}}hs.generateUser=Ob});var h5=z(eg=>{"use strict";Object.defineProperty(eg,"__esModule",{value:!0});eg.InsecureTokenProvider=void 0;var ps=(wb(),Zt(Cb)),u5=d5(),Mb=class{constructor(e,t,r){this.tenantKey=e,this.user=t,this.scopes=r}fetchOrdererToken(e,t){return v(this,null,function*(){var r;return{fromCache:!0,jwt:(0,u5.generateToken)(e,this.tenantKey,(r=this.scopes)!==null&&r!==void 0?r:[ps.ScopeType.DocRead,ps.ScopeType.DocWrite,ps.ScopeType.SummaryWrite],t,this.user)}})}fetchStorageToken(e,t){return v(this,null,function*(){var r;return{fromCache:!0,jwt:(0,u5.generateToken)(e,this.tenantKey,(r=this.scopes)!==null&&r!==void 0?r:[ps.ScopeType.DocRead,ps.ScopeType.DocWrite,ps.ScopeType.SummaryWrite],t,this.user)}})}};eg.InsecureTokenProvider=Mb});var g5=z(tg=>{"use strict";Object.defineProperty(tg,"__esModule",{value:!0});tg.MockFluidDataStoreContext=void 0;var TK=(Oe(),Zt(pm)),p5=(Nt(),Zt(pc)),Sb=class{constructor(e=(0,p5.v4)(),t=!1,r=TK.DebugLogger.create("fluid:MockFluidDataStoreContext")){this.id=e,this.existing=t,this.logger=r,this.documentId=void 0,this.isLocalDataStore=!0,this.packagePath=void 0,this.options=void 0,this.clientId=(0,p5.v4)(),this.clientDetails=void 0,this.connected=!0,this.deltaManager=void 0,this.containerRuntime=void 0,this.storage=void 0,this.IFluidDataStoreRegistry=void 0,this.IFluidHandleContext=void 0,this.attachState=void 0,this.scope=void 0}on(e,t){switch(e){case"attaching":case"attached":return this;default:throw new Error("Method not implemented.")}}once(e,t){return this}off(e,t){throw new Error("Method not implemented.")}getQuorum(){}getAudience(){}submitMessage(e,t,r){throw new Error("Method not implemented.")}submitSignal(e,t){throw new Error("Method not implemented.")}bindToContext(){throw new Error("Method not implemented.")}setChannelDirty(e){throw new Error("Method not implemented.")}getAbsoluteUrl(e){return v(this,null,function*(){throw new Error("Method not implemented.")})}getCreateChildSummarizerNodeFn(e,t){throw new Error("Method not implemented.")}uploadBlob(e){return v(this,null,function*(){throw new Error("Method not implemented.")})}getInitialGCSummaryDetails(){return v(this,null,function*(){throw new Error("Method not implemented.")})}getBaseGCDetails(){return v(this,null,function*(){throw new Error("Method not implemented.")})}};tg.MockFluidDataStoreContext=Sb});var Ab=z(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.MockDeltaManager=fs.MockDeltaQueue=void 0;var zK=fi(),f5=(Y(),Zt(oc)),gs=class extends zK.EventEmitter{constructor(){super(),this.queue=[],this.pauseCount=0,this.processCallback=()=>{}}get disposed(){}get paused(){return this.pauseCount!==0}get length(){return this.queue.length}get idle(){return this.queue.length===0}process(){Promise.resolve().then(()=>{for(;this.pauseCount===0&&this.length>0;){let e=this.pop();(0,f5.assert)(e!==void 0,"this is impossible due to the above length check"),this.processCallback(e)}})}push(e){this.queue.push(e),this.emit("push",e),this.process()}pop(){return this.queue.shift()}pause(){return v(this,null,function*(){this.pauseCount++})}resume(){this.pauseCount--,this.process()}peek(){return this.queue[0]}toArray(){return this.queue}dispose(){}waitTillProcessingDone(){return v(this,null,function*(){throw new Error("NYI")})}};fs.MockDeltaQueue=gs;var Eb=class extends f5.TypedEventEmitter{constructor(){super(),this.readOnlyInfo={readonly:!1},this.clientType=void 0,this.clientDetails=void 0,this._inbound=void 0,this._inboundSignal=void 0,this._outbound=void 0,this.minimumSequenceNumber=0,this.lastSequenceNumber=0,this.lastKnownSeqNumber=0,this.initialSequenceNumber=0,this.hasCheckpointSequenceNumber=!1,this._inbound=new gs,this._outbound=new gs,this._inboundSignal=new gs}get disposed(){}get IDeltaSender(){return this}get inbound(){return this._inbound}get outbound(){return this._outbound}get inboundSignal(){return this._inboundSignal}get version(){}get maxMessageSize(){return 0}get serviceConfiguration(){}get active(){return!0}close(){}submitSignal(e){}flush(){}submit(e,t,r=!1,i){return 0}dispose(){}};fs.MockDeltaManager=Eb});var m5=z(ng=>{"use strict";Object.defineProperty(ng,"__esModule",{value:!0});ng.MockHandle=void 0;var kb=(qt(),Zt(Uv)),Db=class{constructor(e,t=`mock-handle-${Math.random().toString(36).slice(2)}`,r=`/${t}`){this.value=e,this.path=t,this.absolutePath=r,this.graphAttachState=kb.AttachState.Detached}get IFluidHandle(){return this}get isAttached(){return this.graphAttachState===kb.AttachState.Attached}get(){return v(this,null,function*(){return this.value})}attachGraph(){this.graphAttachState=kb.AttachState.Attached}bind(){throw Error("MockHandle.bind() unimplemented.")}};ng.MockHandle=Db});var Nb=z(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.MockSharedObjectServices=Vt.MockObjectStorageService=Vt.MockEmptyDeltaConnection=Vt.MockFluidDataStoreRuntime=Vt.MockQuorumClients=Vt.MockContainerRuntimeFactory=Vt.MockContainerRuntime=Vt.MockDeltaConnection=void 0;var b5=fi(),cg=(Y(),Zt(oc)),v5=(qt(),Zt(Uv)),IK=(Oe(),Zt(pm)),rg=(wb(),Zt(Cb)),Fb=(vt(),Zt(Vv)),Tb=(Nt(),Zt(pc)),x5=Ab(),ig=class{constructor(e,t){this.submitFn=e,this.dirtyFn=t,this._connected=!0}get connected(){return this._connected}attach(e){this.handler=e,e.setConnectionState(this.connected)}submit(e,t){return this.submitFn(e,t)}dirty(){this.dirtyFn()}setConnectionState(e){var t;this._connected=e,(t=this.handler)===null||t===void 0||t.setConnectionState(e)}process(e,t,r){var i;(i=this.handler)===null||i===void 0||i.process(e,t,r)}reSubmit(e,t){var r;(r=this.handler)===null||r===void 0||r.reSubmit(e,t)}};Vt.MockDeltaConnection=ig;var og=class{constructor(e,t){var r;this.dataStoreRuntime=e,this.factory=t,this.clientSequenceNumber=0,this.deltaConnections=[],this.pendingMessages=[],this.deltaManager=new x5.MockDeltaManager,this.dataStoreRuntime.deltaManager=this.deltaManager,this.dataStoreRuntime.quorum=t.quorum,this.clientId=(r=this.dataStoreRuntime.clientId)!==null&&r!==void 0?r:(0,Tb.v4)(),t.quorum.addMember(this.clientId,{})}createDeltaConnection(){let e=new ig((t,r)=>this.submit(t,r),()=>this.dirty());return this.deltaConnections.push(e),e}submit(e,t){let r=this.clientSequenceNumber++,i={clientId:this.clientId,clientSequenceNumber:r,contents:e,referenceSequenceNumber:this.deltaManager.lastSequenceNumber,type:rg.MessageType.Operation};return this.factory.pushMessage(i),this.addPendingMessage(e,t,r),r}dirty(){}process(e){this.deltaManager.lastSequenceNumber=e.sequenceNumber,this.deltaManager.lastMessage=e,this.deltaManager.minimumSequenceNumber=e.minimumSequenceNumber;let[t,r]=this.processInternal(e);this.deltaConnections.forEach(i=>{i.process(e,t,r)})}addPendingMessage(e,t,r){let i={content:e,clientSequenceNumber:r,localOpMetadata:t};this.pendingMessages.push(i)}processInternal(e){let t,r=this.clientId===e.clientId;if(r){let i=this.pendingMessages.shift();(0,cg.assert)(i?.clientSequenceNumber===e.clientSequenceNumber,"Unexpected client sequence number from message"),t=i.localOpMetadata}return[r,t]}};Vt.MockContainerRuntime=og;var zb=class{constructor(){this.sequenceNumber=0,this.minSeq=new Map,this.quorum=new El,this.messages=[],this.runtimes=[]}get outstandingMessageCount(){return this.messages.length}getMinSeq(){let e;for(let[t,r]of this.minSeq)this.quorum.getMember(t)!==void 0&&(e=e===void 0?r:Math.min(e,r));return e??0}createContainerRuntime(e){let t=new og(e,this);return this.runtimes.push(t),t}pushMessage(e){e.clientId&&e.referenceSequenceNumber!==void 0&&!this.minSeq.has(e.clientId)&&this.minSeq.set(e.clientId,e.referenceSequenceNumber),this.messages.push(e)}processOneMessage(){if(this.messages.length===0)throw new Error("Tried to process a message that did not exist");let e=this.messages.shift();e=JSON.parse(JSON.stringify(e)),this.minSeq.set(e.clientId,e.referenceSequenceNumber),e.sequenceNumber=++this.sequenceNumber,e.minimumSequenceNumber=this.getMinSeq();for(let t of this.runtimes)t.process(e)}processSomeMessages(e){if(e>this.messages.length)throw new Error("Tried to process more messages than exist");for(let t=0;t<e;t++)this.processOneMessage()}processAllMessages(){for(;this.messages.length>0;)this.processOneMessage()}};Vt.MockContainerRuntimeFactory=zb;var El=class{constructor(...e){var t;this.eventEmitter=new b5.EventEmitter,this.disposed=!1,this.members=new Map((t=e)!==null&&t!==void 0?t:[])}addMember(e,t){this.members.set(e,t),this.eventEmitter.emit("addMember",e,t)}removeMember(e){this.members.delete(e)&&this.eventEmitter.emit("removeMember",e)}getMembers(){return this.members}getMember(e){return this.getMembers().get(e)}dispose(){throw new Error("Method not implemented.")}addListener(e,t){throw new Error("Method not implemented.")}on(e,t){switch(e){case"afterOn":return this.eventEmitter.on(e,t),this;case"addMember":case"removeMember":return this.eventEmitter.on(e,t),this.eventEmitter.emit("afterOn",e),this;default:throw new Error("Method not implemented.")}}once(e,t){throw new Error("Method not implemented.")}prependListener(e,t){throw new Error("Method not implemented.")}prependOnceListener(e,t){throw new Error("Method not implemented.")}removeListener(e,t){return this.eventEmitter.removeListener(e,t),this}off(e,t){return this.eventEmitter.off(e,t),this}removeAllListeners(e){throw new Error("Method not implemented.")}setMaxListeners(e){throw new Error("Method not implemented.")}getMaxListeners(){throw new Error("Method not implemented.")}listeners(e){throw new Error("Method not implemented.")}rawListeners(e){throw new Error("Method not implemented.")}emit(e,...t){throw new Error("Method not implemented.")}eventNames(){throw new Error("Method not implemented.")}listenerCount(e){throw new Error("Method not implemented.")}};Vt.MockQuorumClients=El;var Ib=class extends b5.EventEmitter{constructor(){super(...arguments),this.documentId=void 0,this.id=(0,Tb.v4)(),this.existing=void 0,this.options={},this.clientId=(0,Tb.v4)(),this.path="",this.connected=!0,this.deltaManager=new x5.MockDeltaManager,this.loader=void 0,this.logger=IK.DebugLogger.create("fluid:MockFluidDataStoreRuntime"),this.quorum=new El,this._local=!1,this._disposed=!1}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get IFluidRouter(){return this}get absolutePath(){return`/${this.id}`}get local(){return this._local}set local(e){this._local=e}get disposed(){return this._disposed}dispose(){this._disposed=!0}getChannel(e){return v(this,null,function*(){return null})}createChannel(e,t){return null}get isAttached(){return!this.local}get attachState(){return this.local?v5.AttachState.Detached:v5.AttachState.Attached}bindChannel(e){}attachGraph(){}bindToContext(){}bind(e){}getQuorum(){return this.quorum}getAudience(){return null}save(e){}close(){return v(this,null,function*(){})}uploadBlob(e){return v(this,null,function*(){return null})}getBlob(e){return v(this,null,function*(){return null})}submitMessage(e,t){return null}submitSignal(e,t){return null}process(e,t){}processSignal(e,t){}updateMinSequenceNumber(e){}setConnectionState(e,t){}resolveHandle(e){return v(this,null,function*(){return this.request(e)})}request(e){return v(this,null,function*(){return null})}addedGCOutboundReference(e,t){}summarize(e,t){return v(this,null,function*(){let r=(0,Fb.mergeStats)();return r.treeNodeCount++,{summary:{type:rg.SummaryType.Tree,tree:{}},stats:r}})}getGCData(){return v(this,null,function*(){return{gcNodes:{}}})}updateUsedRoutes(e,t){}getAttachSnapshot(){return[]}getAttachSummary(){let e=(0,Fb.mergeStats)();return e.treeNodeCount++,{summary:{type:rg.SummaryType.Tree,tree:{}},stats:e}}setAttachState(e){}waitAttached(){return v(this,null,function*(){})}requestDataStore(e){return v(this,null,function*(){return null})}reSubmit(e,t){}applyStashedOp(e){return v(this,null,function*(){})}rollback(e,t){}};Vt.MockFluidDataStoreRuntime=Ib;var ag=class{constructor(){this.connected=!1}attach(e){}submit(e){return(0,cg.assert)(!1,"Throw submit error on mock empty delta connection"),0}dirty(){}};Vt.MockEmptyDeltaConnection=ag;var sg=class{constructor(e){this.contents=e}readBlob(e){return v(this,null,function*(){return(0,cg.stringToBuffer)(this.contents[e],"utf8")})}contains(e){return v(this,null,function*(){return this.contents[e]!==void 0})}list(e){return v(this,null,function*(){let t=(0,Fb.getNormalizedObjectStoragePathParts)(e).length;return Object.keys(this.contents).filter(r=>r.startsWith(e)&&r.split("/").length===t+1)})}};Vt.MockObjectStorageService=sg;var Rb=class n{constructor(e){this.deltaConnection=new ag,this.objectStorage=new sg(e)}static createFromSummary(e){let t={};for(let[r,i]of Object.entries(e.tree))(0,cg.assert)(i.type===rg.SummaryType.Blob,"Unexpected summary type on mock createFromSummary"),t[r]=i.content;return new n(t)}};Vt.MockSharedObjectServices=Rb});var y5=z(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.MockContainerRuntimeFactoryForReconnection=ms.MockContainerRuntimeForReconnection=void 0;var RK=(Nt(),Zt(pc)),NK=(Y(),Zt(oc)),_5=Nb(),lg=class extends _5.MockContainerRuntime{constructor(e,t){super(e,t),this.pendingRemoteMessages=[],this._connected=!0}get connected(){return this._connected}set connected(e){if(this._connected!==e){if(this._connected=e,e){for(let t of this.pendingRemoteMessages)this.process(t);this.pendingRemoteMessages.length=0,this.clientSequenceNumber=0,this.clientId=(0,RK.v4)(),this.dataStoreRuntime.clientId=this.clientId,this.factory.quorum.addMember(this.clientId,{}),this.reSubmitMessages()}else this.factory.clearOutstandingClientMessages(this.clientId),this.factory.quorum.removeMember(this.clientId);this.deltaConnections.forEach(t=>{t.setConnectionState(this.connected)})}}process(e){this.connected?super.process(e):this.pendingRemoteMessages.push(e)}submit(e,t){return this.connected?super.submit(e,t):(this.addPendingMessage(e,t,-1),-1)}reSubmitMessages(){let e=this.pendingMessages.length;for(;e>0;){let t=this.pendingMessages.shift();(0,NK.assert)(t!==void 0,"this is impossible due to the above length check"),this.deltaConnections.forEach(r=>{r.reSubmit(t.content,t.localOpMetadata)}),e--}}};ms.MockContainerRuntimeForReconnection=lg;var Bb=class extends _5.MockContainerRuntimeFactory{createContainerRuntime(e){let t=new lg(e,this);return this.runtimes.push(t),t}clearOutstandingClientMessages(e){this.messages=this.messages.filter(t=>t.clientId!==e)}};ms.MockContainerRuntimeFactoryForReconnection=Bb});var w5=z(dg=>{"use strict";Object.defineProperty(dg,"__esModule",{value:!0});dg.MockStorage=void 0;var qb=(Y(),Zt(oc)),C5=(vt(),Zt(Vv)),Lb=class n{constructor(e){this.tree=e}static createFromSummary(e){let t=(0,C5.convertSummaryTreeToITree)(e);return new n(t)}static readBlobCore(e,t){if(e){for(let r of e.entries)if(r.path===t[0])return r.type==="Blob"?((0,qb.assert)(t.length===1,JSON.stringify(Object.assign({},arguments))),r.value):r.type==="Tree"?n.readBlobCore(r.value,t.slice(1)):void 0;return}}readBlob(e){return v(this,null,function*(){let t=n.readBlobCore(this.tree,e.split("/"));return(0,qb.assert)(t!==void 0,`Blob does not exist: ${e}`),(0,qb.stringToBuffer)(t.contents,t.encoding)})}contains(e){return v(this,null,function*(){return n.readBlobCore(this.tree,e.split("/"))!==void 0})}list(e){return v(this,null,function*(){return(0,C5.listBlobsAtTreePath)(this.tree,e)})}};dg.MockStorage=Lb});var P5=z(ug=>{"use strict";Object.defineProperty(ug,"__esModule",{value:!0});ug.shortCodeMap=void 0;ug.shortCodeMap={"0x000":"nonzero isobuffer byte offset","0x001":"unexpected isobuffer byte length","0x003":"Primary to add to range < last primary!","0x004":"Secondary to add to range < last secondary!","0x005":"Target primary to retrieve < first range's primary!","0x006":"Target primary to retrieve < last range's primary!","0x007":"Target primary to update < first range's primary!","0x008":"Target primary to update < last range's primary!","0x009":"After update, target primary is not first range's primary!","0x00a":"Running timer missing handler","0x00b":"Handler executed without deferred","0x00c":"messageId is incorrect from from the local client's ACK","0x00d":"Missing message handler for message type","0x00e":"Missing message handler for message type","0x00f":"pendingMessageId is missing from the local client's operation","0x010":"Received out of order storage op when there is an unackd clear message","0x011":"pendingMessageId is missing from the local client's operation","0x012":"pendingMessageId is missing from the local client's operation","0x013":"Received out of order op when there is an unackd clear message","0x014":"pendingMessageId is missing from the local client's operation","0x015":"pendingMessageId is missing from the local client's clear operation","0x016":"apply stashed op not implemented for custom value type ops","0x017":"Trying to add invalid handle!","0x018":"Trying to insert handle into position with already valid handle!","0x019":"SharedMatrix.openUndo() supports at most a single IUndoConsumer.","0x01a":"Trying to set out-of-bounds cell!","0x01b":"Trying to set multiple out-of-bounds cells!","0x01c":"The 'localSeq' of the vector submitting an op must >= the 'localSeq' of the other vector.","0x01d":"Trying to submit message to runtime while detached!","0x01e":"Row and col collab window 'localSeq' desynchronized!","0x01f":"Row and col collab window 'collaborating' status desynchronized!","0x020":"Unknown SharedMatrix 'op' type.","0x021":"SharedMatrix message contents have unexpected type!","0x022":"SharedMatrix row and/or col handles are invalid!","0x023":"The 'localSeq' of pending write (if any) must be <= the localSeq of the currently processed op.","0x024":"Start of PermutationSegment already allocated!","0x025":"Trying to set start of PermutationSegment to invalid handle!","0x026":"Trying to split segment at out-of-bounds position!","0x027":"Trying to get handle of out-of-bounds position!","0x028":"'localSeq' for op being resubmitted must be <= the 'localSeq' of the last submitted op.","0x029":"Invalid handle at start of containing segment!","0x02a":"On vector undo, unexpected 'currentOp' type/state!","0x02b":"Must not nest calls to IRevertible.revert()","0x02c":"On cellSet(), invalid row and/or column handles!","0x02d":"Unexpected op type on range remove!","0x02e":"Unexpected op type on range annotate!","0x02f":"Unexpected op type on range insert!","0x030":"Incoming remote op sequence# <= local collabWindow's currentSequence#","0x031":"Incoming remote op minSequence# < local collabWindow's minSequence#","0x032":"localSeq greater than collab window","0x033":"Segment group undefined","0x034":"Segment group not at head of merge tree pending queue","0x035":"Segment group not at head of segment pending queue","0x036":"Segment has no pending properties","0x037":"Segment already has assigned sequence number","0x038":"Incoming op sequence# < local collabWindow's currentSequence#","0x039":"Incoming op sequence# < minSequence#","0x03a":"Number of ops in 'resetOp' must match the number of segment groups provided.","0x03b":"Number of ops in 'resetOp' must match the number of segment groups provided.","0x03c":"Reset op has 'group' delta type!","0x03d":"segmentGroup is array rather than singleton!","0x03e":"minSeq mismatch between collab window and delta manager!","0x03f":"New format should not emit catchup ops","0x040":"Child count is not within [1,7] range!","0x041":"Unexpected child ordinal length!","0x043":"On ack, unexpected segmentGroup!","0x044":"On annotate ack, missing segment property manager!","0x045":"On insert, seq number already assigned!","0x046":"On remove ack, missing removal info!","0x048":"onMinGE()","0x049":"Trying to reload from segments while collaborating!","0x04f":"minSeq of collab window > target minSeq!","0x050":"Next segment changes are undefined!","0x051":"Too many children on merge block!","0x054":"Sequence number less than minSeq!","0x055":"Sequence number is not sorted!","0x056":"Unexpected total for accumulation of all seglen adjustments!","0x057":"Negative length after length adjustment!","0x058":"Both overlapRemoveClients and clientPartials are set!","0x059":"Client view exists but flat view does not!","0x05a":"Mismatch between number of partial lengths on client and flat views!","0x05b":"Flat view exists but client view does not!","0x05c":"Trying to update more annotate props than do exist!","0x05d":"emit: mismatch in segmentsTotalLength","0x05e":"emit: mismatch in totalSegmentCount","0x05f":"Missing blob header on legacy snapshot!","0x060":"There should be only one blob with catch up ops","0x061":"Mismatch in totalLength","0x062":"Mismatch in totalSegmentCount","0x063":"Mismatch in totalLength","0x064":"Mismatch in totalSegmentCount","0x065":"On removal info preservation, segment has invalid removed sequence number!","0x066":"Corrupted preservation of segment metadata!","0x067":"Missing clientId for removal!","0x068":"On consensusOrderedCollection load, job tracking size > 0","0x069":"On consensusOrderedCollection load, data size > 0","0x06a":"Trying to submit message while detached!","0x06b":"Loading snapshot into a non-empty collection","0x06c":"Value should be undefined or non-empty","0x06d":"SharedObjects contained in ConsensusRegisterCollection can no longer be deserialized as of 0.17","0x06e":"Message's reference sequence number < op's reference sequence number!","0x06f":"data missing for non-atomic inbound update!","0x070":"sequence numbers are expected to be 0 when unattached","0x071":"Versions should naturally be ordered by sequenceNumber","0x072":"Unexpected local op when loading not finished","0x073":"Sequence message not operation","0x074":"Snapshot called when not fully loaded","0x075":"SummarySerializer should be used for serializing data during summary.","0x078":"Possible re-entrancy! Summary should not already be in progress.","0x079":"Possible re-entrancy! Summary should have been in progress.","0x07a":"Services should be there to attach delta handler","0x07b":"Unexpected op","0x07c":"Unexpected op type","0x07d":"Unexpected op","0x07e":"Unexpected op type","0x07f":"clientId undefined","0x080":"Invalid document service!","0x081":"Document service already set!","0x082":"Document storage service already set!","0x083":"User selection status does not match replay controller use status!","0x084":"On storage resolve, user selection already made!","0x085":"On storage resolve, missing storage!","0x086":"After storage resolve, user selection status still false!","0x088":"Missing button ops button!","0x089":"Stringified length of chunk contents > total starting length","0x08a":"resetting ChunkedOpProcessor that never wrote back its contents","0x08b":"Unexpected type on contents for fix of an attach!","0x08c":"innerContent for fixing op contents is undefined!","0x08d":"After sanitize, pending incomplete ops!","0x08e":"Potentially missed initial messages","0x08f":"No op handler is setup!","0x090":"No signal handler is setup!","0x091":"Retrieved ops' first sequence number has unexpected value!","0x092":"version input for reading snapshot tree is null!","0x093":"invalid version input for reading snapshot tree!","0x094":"Missing snapshot tree!","0x096":"Trying to remove valid tree IDs in removeNullTreeIds()!","0x097":"Missing param from office.com URL parameter","0x098":"OuterDocumentServiceFactoryProxy unavailable","0x099":"OuterUrlResolverProxy unavailable","0x09a":"'documentId' must be a defined, non-zero length string.","0x09d":"Connection details should contain epoch","0x09f":"No more socketIO refs to remove!","0x0a0":"Unexpected socketIO references on timeout","0x0a1":"Socket reference set unexpectedly does not point to this socket!","0x0a2":"reentrancy not supported!","0x0a4":"Unexpected blob encoding type","0x0a5":"Trying to set ops when they are already set!","0x0a8":"Docid should not contain slashes!!","0x0ad":"Snapshot entry has both a tree value and a referenced id!","0x0ae":"Tried to create rate limiter with 0 max requests!","0x0b0":"Missing document snapshot tree!","0x0b1":"Storage service not initialized","0x0b2":"Missing orderer URL!","0x0b7":"Pathname should be defined","0x0b8":"'tenantId' and 'documentId' must be defined, non-zero length strings.","0x0b9":"PathName should exist","0x0ba":"Tenant id should exist","0x0bb":"Document id should exist","0x0bc":"Runtime has no DataObject!","0x0bd":"Object runtime already has DataObject!","0x0be":"Trying to initialize from existing while initProps is set!","0x0bf":"set called recursively from the interception callback","0x0c0":"set called recursively from the interception callback","0x0c1":"Interception wrapper methods called recursively from the interception callback","0x0c2":"Interception wrapper methods called recursively from the interception callback","0x0c3":"Interception wrapper methods called recursively from the interception callback","0x0c4":"Interception wrapper methods called recursively from the interception callback","0x0c5":"Interception wrapper methods called recursively from the interception callback","0x0c6":"Interception wrapper methods called recursively from the interception callback","0x0c7":"Interception wrapper methods called recursively from the interception callback","0x0c8":"Interception wrapper methods called recursively from the interception callback","0x0c9":"Interception wrapper methods called recursively from the interception callback","0x0ca":"Trying to use legacy graph attach!","0x0cd":"Container disconnected while waiting for ops!","0x0cf":"disconnect event was not raised!","0x0d1":"Container should be attached before close","0x0d2":"resolved url should be valid Fluid url","0x0d3":"Should only be called in detached container","0x0d6":"Inbound queue should be empty when attaching","0x0d9":"Attempting to connect() a closed DeltaManager","0x0dd":"Existing context not disposed","0x0de":"Mismatch in connection state while setting","0x0df":"Missing active connection","0x0e0":"lost minBlobSize policy","0x0e2":"DeltaManager already has attached op handler!","0x0e3":"Newly set op handler is null/undefined!","0x0e4":"Lost old connection!","0x0e6":"old connection exists on new connection setup","0x0e7":"claims/connectionMode mismatch","0x0e8":"readonly perf with write connection","0x0e9":"messageBuffer is not empty on new connection","0x0eb":"Missing connection for reconnect","0x0ec":"Unexpected value for previously processed message's sequence number","0x0ed":"non-system message have to have clientId","0x0ee":"Not accounting local messages correctly","0x0ef":"client seq# not growing","0x0f0":"Incoming local client seq# > generated by this client","0x0f2":"previouslyProcessedMessage","0x0f3":"not positive","0x0f4":"Nonzero pause-count on resume()","0x0f6":"real blob ID exists","0x0f7":"aggregate blob missing","0x0f8":"blob from aggregate blob exists on its own","0x0f9":"never read summary","0x0fa":"virtual blob not found","0x0fb":"logic err with aggregator","0x0fc":"tree reuse at lower level","0x0fd":"data stores are writing incremental summaries!","0x0fe":"attachment is aggregate blob","0x0ff":"duplicate aggregate blob","0x100":"logic error","0x101":"Unexpected tree entry type on flatten!","0x102":"invalid level of concurrency","0x103":"trying to parallel run while not working","0x104":"undefined end point for parallel fetch","0x105":"unexpected end point for parallel fetch","0x107":"ending dispatch with remaining results to be sent","0x108":"ending results dispatch but knew in advance about more requests","0x109":"unexpected next chunk position","0x10a":"cannot add parallel request while not working","0x10b":"invalid parallel request range","0x10c":"invalid parallel request start point","0x10d":"invalid parallel request end point","0x10e":"should not throw result if we knew about boundary in advance","0x10f":"empty/partial chunks should not be returned by caching","0x110":"callback should retry until valid fetch before it learns new boundary","0x112":"cannot push onto queue if done","0x113":"deferred queue should be empty","0x114":"cannot pop if deferred","0x115":"queue should not be done during pop","0x116":"Missing handle on scheduler load","0x117":"Trying to get missing clientId!","0x118":"Bad client interactive check","0x119":"This agent became inactive while releasing","0x11a":"Unsuccessful registration","0x11b":"Trying to clear tasks on inactive agent","0x11c":"Detached object routing context","0x11d":"task is already running","0x11e":"client is undefined","0x11f":"requesting unknown blobs","0x120":"Undefined latency statistics (op send time)","0x121":"Undefined inner contents type!","0x122":"Message to unpack is not proper runtime message","0x124":"inconsistent readonly property/event state","0x125":"Unsafe to transition to read-only state!","0x126":"Expected createSubRequest url to include a leading slash","0x127":"dirty document event not set on replay","0x12a":"Missing blob id on metadata","0x12b":"did not get root data store","0x12d":"Container Context should already be in attaching state","0x12e":"Container Context should already be in attached state","0x12f":"Container Runtime's summarize should always return a tree","0x131":"Mismatch between new chunkId and expected chunkMap","0x132":"sending ops in detached container","0x133":"Container disconnected when trying to submit system message","0x137":"Failed to get version from storage","0x138":"Failed to get snapshot from storage","0x139":"Undefined package path","0x13a":"Data store ID contains slash","0x13b":"datastore context is already in bound state","0x13c":"undefined channel on datastore context","0x13d":"Detached runtime creation on realize()","0x13e":"Unexpected package path","0x13f":"datastore context registry is already set","0x140":"undefined channel on datastore context","0x141":"Unexpected connected state","0x142":"local store channel is not loaded","0x143":"Channel should not be undefined when running GC","0x144":"Channel should be loaded when updating used routes","0x145":"Channel should be present when data store is loaded","0x146":"Channel must exist when submitting message","0x147":"Channel must exist on submitting signal","0x148":"Detached runtime creation on runtime bind","0x149":"Undefined channel deferral","0x14a":"Undefined package path","0x14b":"Channel must exist when resubmitting ops","0x14c":"Channel must exist when rebasing ops","0x14d":"Should move from detached to attaching","0x14e":"Should move from attaching to attached","0x14f":"There should be a channel when generating attach message","0x150":"pkg should be available in local data store context","0x152":"pkg should be available in local data store","0x154":"runtime creation is already attached","0x155":"channel deferral is already set","0x156":"Unexpected factory for package path","0x157":"datastore registry already attached","0x158":"Creating store with existing ID","0x159":"The given id was not found in notBoundContexts to delete","0x15a":"Cannot find context to resolve to","0x15b":"Expected this id to already be removed from notBoundContexts","0x15c":"Cannot find deferred to resolve","0x15d":"Creating store with existing ID","0x15e":"Local object does not have matching attach message id","0x15f":"Could not find unbound context to bind","0x160":"There should be a store context for the op","0x161":"There should be a store context for the op","0x162":"There should be a store context for the op","0x163":"Missing datastore for local signal","0x165":"Summarizer cannot work if client has local changes","0x166":"BaseSnapshot should be there as detached container loaded from snapshot","0x167":"Used route does not belong to any known data store","0x168":"Expected tree in snapshot not found","0x169":"No pending message found for this remote message","0x16b":"The pending batch state indicates we are already processing a batch","0x16d":"There is no pending batch begin message","0x16e":"Batch with single message should not have batch metadata","0x16f":"Did not receive batch begin metadata","0x170":"Did not receive batch end metadata","0x171":"No pending state found for the remote message","0x172":"The connection state is not consistent with the runtime","0x173":"replayPendingStates called twice for same clientId!","0x174":"initial states should be empty before replaying pending","0x175":"Can only broadcast if summarizer starts in local state","0x176":"Can only ack/nack if summarizer is in broadcasting state","0x177":"Missing delta handler","0x178":"Missing delta handler on attach","0x179":"createChannel() with existing ID","0x17a":"Channel should be loaded when created!!","0x17b":"Channel to be binded should be in not bounded set","0x17c":"Unexpected attach (local) channel OP","0x17e":"Used route does not belong to any known context","0x17f":"Not expecting detached channels during summarize","0x180":"getAttachSummary should always return a tree","0x181":"BaseSnapshot should be there as detached container loaded from snapshot","0x182":"Data store should be attached to attach the channel.","0x183":"There should be a channel context for the op","0x184":"There should be a channel context for the op","0x185":"Channel not found","0x189":"Should always be remote because a local dds shouldn't generate ops before loading","0x18a":"Channel should be loaded to resubmit ops","0x18c":"Channel should be loaded to summarize","0x18d":"Channel should be loaded to take snapshot","0x18e":"Channel must not already be loaded when loading","0x190":".attributes blob should be present","0x192":"Channel should be there if loaded!!","0x193":"Channel should be loaded to run GC","0x194":"Remote channel must be loaded when rebasing op","0x195":"Remote channel must not be local when processing op","0x196":"Remote channel must be loaded when resubmitting op","0x197":"Remote channel must not already be loaded when loading","0x198":"Used route should always be an absolute route","0x19a":"Invalid response value for Fluid object request","0x19b":"Cannot not create response error on 200 status","0x19c":"storage service path has trailing separator","0x19d":"Handles should always have absolute paths","0x19f":"wipSummaryLogger should not be set yet in startSummary","0x1a0":"Already tracking a summary","0x1a1":"summarize should not be called when not tracking the summary","0x1a2":"wipSummaryLogger should have been set in startSummary or ctor","0x1a3":"wipSummaryLogger should have been set in startSummary or ctor","0x1a4":"Not tracking a summary","0x1a5":"Tracked summary local paths not set","0x1a6":"Not found pending summary, but this node has previously completed a summary","0x1a7":"Pending summary reference sequence number should be consistent","0x1a9":"When loading base summary, expected outstanding ops <= tracking sequence number","0x1aa":"Out of order change recorded","0x1ab":"Create SummarizerNode child already exists","0x1ac":"Cannot create child from summary if parent does not have latest summary","0x1ad":"Missing child summary tree","0x1ae":"Child summary object is not a tree","0x1af":"Outstanding ops blob missing, but base summary tree exists","0x1b0":"Base summary tree missing, but outstanding ops blob exists","0x1b1":"wip used routes should be set if tracking a summary","0x1b2":"Getting GC data should not be called when GC is disabled!","0x1b3":"GC data cannot be retrieved without getGCDataFn","0x1b4":"We should not already be tracking used routes when to track a new summary","0x1b5":"We should have been tracking used routes","0x1b6":"Create SummarizerNode child already exists","0x1b7":"Bad session state for processing quorum messages","0x1b8":"Bad session state for processing quorum messages","0x1b9":"Unexpected value for sequence number of first message in file","0x1ba":"should not return empty buckets","0x1bb":"Unexpected sequence number on first of messages to save","0x1bc":"Unexpected sequence number on last of messages to save","0x1bd":"Stopped writing at unexpected sequence number","0x1c5":"snapshot should be set before retrieving it","0x1c6":"snapshot should be set before retrieving it","0x1c7":"snapshot should be set before retrieving it as expanded string","0x1c8":"Mismatch between document sequence number and current op number","0x1c9":"Leftover documents after replay!","0x1ca":"replay-to target is <= current op in replay cycle","0x1cb":"Bad window to verify snapshot","0x1cc":"Unexpected previous snapshot op number","0x1ce":"clientId not found","0x1cf":"clientId not found","0x1d0":"sequenceNumber not found","0x1d3":"Missing client id on disconnect","0x1d5":"Invalid snapshot format version","0x1d6":"Parent summary object is not a tree","0x1d8":"Should only transition from Connecting state","0x1d9":"addRequestCore() should break into smaller chunks","0x1da":"Client id should be set if connected","0x1db":"epoch exists","0x1dc":"all entries have to have epoch","0x1dd":"no epoch","0x1de":"Not an ODSP resolved url","0x1e0":"Protocol and App summary trees should be present","0x1e2":"Caller must ensure 'isAttached()' before calling 'sendSetCellOp'.","0x1e4":"Unexpected serializable type","0x1e5":"Storage token should not be null","0x1e6":"Epoch  should be present in response","0x1e7":"caching was not performed!","0x1e8":"reentrancy","0x1e9":"Pending ops","0x1ea":"Prefetch snapshot only available for odsp!","0x1eb":"Snapshot should be prefetched!","0x1ec":"No refresh token provided.","0x1ed":"Share link should be present","0x1ef":"services must be defined","0x1f0":"Unexpected mismatch in readonly","0x1f5":"Attached state should have storage","0x1f6":"Negative client sequence number not allowed","0x1f7":"Previous client should always be defined","0x1f8":"local BlobAttach op with no pending blob","0x1fc":"summary is not a tree","0x1fe":"isolated channels subtree should exist in remote datastore snapshot","0x1ff":"isolated channels subtree should exist in local datastore snapshot","0x200":"Returned odsp snapshot is malformed. No trees!","0x201":"Returned odsp snapshot is malformed. No blobs!","0x203":"Summary handle is undefined","0x205":"attach() called more than once","0x207":"Channel should be defined","0x208":"Factory should be undefined before loading","0x209":"Factory Type should be defined","0x20a":"register for event on disposed object","0x20b":"mismatch","0x20c":"connection disposed","0x20d":"double connection listener","0x20e":"double tracked listener","0x20f":"Driver min read version should >= to server minReadVersion","0x210":"Snapshot should be created with minReadVersion or above","0x219":"1 root should be there","0x21b":"Snapshot id should be provided","0x21c":"Seq number should be provided","0x21d":"body is not string","0x21e":"improper boundary format","0x220":"socket key collision","0x221":"Root tree should contain the id","0x222":"Root tree should contain the id!!","0x223":"unexpected end of buffer","0x224":"Skip length should be positive","0x225":"Data should be there","0x226":"Should write complete data","0x227":"Data should be there","0x22b":"Should be a pair","0x22c":"reading pairs","0x231":"Number should be an integer","0x232":"Payload should not be negative","0x233":"Unexpected data at the end of buffer","0x234":"has joinOpTimer","0x235":"no joinOpTimer","0x236":"In all cases it should be already installed","0x237":"Snapshot should exist","0x238":"called only in connected state","0x239":"called only in disconnected state","0x23a":"seq#'s","0x23b":"we are not packing at the right level","0x23c":"we are not packing at the right level","0x23d":"pending is undefined","0x23e":"pending is undefined","0x23f":"pending undefined","0x240":"Binary format snapshot only for odsp driver!!","0x241":"disconnect should result in stopSequenceNumberUpdate() call","0x242":"has timer","0x243":"stopSequenceNumberUpdate should be called as result of sending any op!","0x244":"Socket is closed, but connection is not!","0x245":"tracked listener","0x246":"checking consistency of socket & _disposed flags","0x247":"Use addTrackedListener instead","0x248":"should not subscribe to forwarded events","0x24c":"Cannot call `flush()` from `orderSequentially`'s callback","0x24e":"assertion for type narrowing","0x250":"serialized container with attachment blobs must be rehydrated with detached blob storage","0x251":"creation summary has to have seq=0 && handle === undefined","0x252":"redirect table can only be set in detached container","0x253":"redirect table already exists","0x254":"unrecognized id in redirect table","0x255":"detached blob id absent in redirect table","0x256":"storage undefined in attached container","0x257":"This is not summarizing container","0x258":"connected","0x259":"Container disconnected when trying to submit system message","0x25b":"Caller is responsible for checking lock","0x25d":"We should never connect as 'read'","0x25e":"no reason to call fail if all promises have been completed","0x25f":"retryAfterSeconds","0x260":"Disposed should mean disconnected!","0x261":"Expected: off","0x262":"Old summarizer is still working!","0x263":"Expected: starting","0x264":"Expected: Not Off","0x266":"lastKnownSeqNumber should never be below last processed sequence number","0x267":"lastObservedSeqNumber should be updated first","0x268":"There can't be pending fetch that early in boot sequence!","0x269":"pending ops are not dropped","0x26a":"not closed","0x26b":"initial state","0x26c":"handler should be installed","0x26d":"wrong start","0x26e":"wrong start","0x26f":"continuous and no duplicates","0x270":"All requested ops fetched","0x272":"empty request","0x273":"Invalid document id from parsed URL","0x274":"type check","0x275":"Root tree should contain the id","0x278":"API is not supported for non-connecting or closed container","0x27b":"reentrancy may result in incorrect behavior","0x280":"Validate first op seq number","0x281":"Unreferenced if present should be true","0x282":"Headers should be present now","0x283":"Length of data len should fit in the bytes from the map","0x284":"Length of id should fit in the bytes from the map","0x285":"Start code should not undefined","0x286":"End code should not undefined","0x287":"key must exist in the map","0x288":"All properties should exist","0x289":"logic error","0x28a":"can't be disposed - Callers need to ensure that!","0x292":"Unexpected undefined result from getFileLinkCore","0x293":"initial state","0x294":"can't have op processing paused if we are processing an op","0x295":"there should be no pending batch if we have no ops","0x296":"we should never start processing incomplete batch!","0x297":"always called from resumed state","0x298":"we have something in the queue that generates this event","0x299":"non-synchronized state","0x29a":"System message in the middle of batch!","0x29b":"system op in a batch?","0x29c":"we should be processing ops when there is no active batch","0x29d":"we should be processing ops when there is no active batch","0x29e":"there can't be active batch","0x29f":"we should be processing ops when there is no active batch","0x2a0":"batch presence was validated above","0x2a1":"logic error","0x2a2":"Batch is interrupted by other client op. Should be caught by trackPending()","0x2a3":"container should be closed on any error","0x2a5":"join timer","0x2a6":"waitingForLeaveOp should imply writeConnection (we need to be ready to flush pending ops)","0x2a7":"Container is not attached","0x2a8":"Expected data store snapshot tree in base snapshot","0x2a9":"GC nodes for data store not in GC blob","0x2ac":"Connected when timeout waiting for leave from previous session fired!","0x2ad":"GC blob missing from snapshot","0x2ae":"node id should always be an absolute route","0x2af":"Child GC data should have been initialized","0x2b0":"Used route should always be an absolute route","0x2b1":"This should have be initiallized when generate GC nodes above","0x2b2":"Two entries for the same GC node with different unreferenced timestamp","0x2b3":"logic error","0x2b4":"not connected on sending ops!","0x2b5":"logic error","0x2b6":"Missing data store context","0x2b8":"Chunk should be set in map","0x2ba":"batchBegin must fire before batchEnd","0x2bb":"Instrumented token fetcher with throwOnNullToken = true should never return null","0x2bc":"Instrumented token fetcher with throwOnNullToken =true should never return null","0x2bd":"We should not see a pending FlushMode until we see a flush when processing a batch","0x2be":"LocalReferences array contains a gap","0x2bf":"both removedClientIds and removedSeq should be set or not set","0x2c0":"ID must be created before adding interval to collection","0x2c1":"Creating an interval collection that already exists?","0x2c2":"Create Version should be equal to currentReadVersion","0x2c4":"client should not be summarizer before container is created","0x2c5":"Attempting to connect() a closed Container","0x2c6":"Attempting to connect() a container that is not attached","0x2c7":"Attempting to disconnect() a closed Container","0x2c8":"outboundPushEventTime should be undefined","0x2c9":"durationNetwork should be undefined","0x2ca":"durationOutboundBatching should be undefined","0x2cb":"submitOpEventTime should be undefined","0x2cc":"OpTimeSittingInboundQueue should be undefined","0x2cd":"durationNetwork should be undefined","0x2ce":"msnTrackingTimestamp should not be undefined","0x2cf":"undefined channel on datastore context","0x2d0":"Data store should be globally visible to attach channels.","0x2d1":"Data store should be locally visible before it can become globally visible.","0x2d2":"Data store should be globally visible when its attached.","0x2d3":"Local channel must be globally visible when processing op","0x2d4":"Local channel must be globally visible when resubmitting op","0x2d5":"Invalid blob node id in unused routes.","0x2d7":"No data store with specified id","0x2d8":"Empty change event should not be emitted.","0x2da":"Unknown SharedMatrix 'op' type.","0x2db":"Applying op must generate a pending segment","0x2dc":"Cannot find code proposal","0x2dd":"Cannot find blob for a given id","0x2de":"Package path requested for unsupported node type.","0x2df":"transient references cannot be bound to segments","0x2e0":"lref not a Local Reference","0x2e1":"Support for plain value types removed.","0x2e2":"Must only wait for leave message when clientId in quorum","0x2e3":"Must have a valid protocol handler instance","0x2e4":"there should be service config for active connection","0x2e5":"Must have a base snapshot","0x2e6":"Must have a base snapshot","0x2e7":"Must serialize base snapshot blobs before getting runtime state","0x2e8":"There should be a store context for the op","0x2e9":"Must call getLocalState() after applying initial states","0x2ea":"Configuration state should be enabled","0x2eb":"Summary not supported with configuration disabled","0x2ec":"Blob must be present in blobsContents","0x2ed":"There should be a channel context for the op","0x2ee":"Channel should be loaded to rollback ops","0x2ef":"Local channel must be globally visible when rolling back op","0x2f0":"Remote channel must be loaded when rolling back op","0x2f1":"slideReferences from a segment which has not been removed and acked","0x2f2":"Ref not in the segment localRefs","0x2f3":"Ref not in the segment localRefs","0x2f4":"localRefs must be allocated","0x2f5":"op create references must be SlideOnRemove","0x2f6":"SlideOnRemove references must be op created","0x2f8":"Unexpected accept op, nothing pending","0x2f9":"Unexpected accept op, client not in expectedSignoffs","0x2fa":"Unexpected pending message received","0x2fb":"pendingMessageId does not match","0x2fc":"Invalid localOpMetadata for clear","0x2fd":"pendingMessageId does not match","0x2fe":"Invalid localOpMetadata in submit","0x2ff":"Unexpected pending message received","0x300":"localSeq greater than collab window","0x301":"Either seq or localSeq should be defined","0x302":"No segment found","0x303":"Invalid offset","0x304":"Id cannot contain slashes","0x305":"registerDependent on disposed Dependee","0x306":"invalidateDependents on disposed Dependee","0x307":"endInitialization should be called exactly once","0x308":"onDispose should be set when disposing","0x309":"Cannot unregister dependees on a disposed SimpleObservingDependent.","0x30a":"shouldClientJoinWrite should imply this is a writeConnection","0x30b":"Must have a valid protocol handler instance","0x30c":"Id cannot contain slashes","0x30d":"Id cannot contain slashes","0x30e":"Id cannot contain slashes. DataStoreContext should have validated this.","0x30f":"Channel context ID cannot contain slashes","0x310":"Channel context ID cannot contain slashes","0x311":"expected id to exist on interval","0x312":"snapshot should be parsed","0x313":'Specified user was not of type "TinyliciousUser".',"0x314":"Container properly closed","0x315":"re-entrancy","0x316":"There should be a cached promise of in-progress aliasing","0x317":"dataStoreFactory is undefined","0x318":"resolvedUrl is undefined","0x319":"No delta connection server associated with specified document ID","0x31a":"resolvedUrl is undefined","0x31b":"container1.resolvedUrl is undefined","0x31c":"rightDiv is undefined","0x31d":'options are not of type "IRouterliciousRouteOptions" as expected',"0x31e":"options.tenantId is undefined","0x320":"options.tenantId is undefined","0x322":"options.fluidHost is undefined","0x324":"options.server is undefined","0x325":"options.odspAccessToken is undefined","0x326":"lockResolver is undefined","0x327":"options.server is undefined","0x328":"options.server is undefined","0x329":"browser.umd property is undefined","0x32a":"pendingMessageId does not match","0x32b":"Invalid localOpMetadata for clear","0x32c":"pendingMessageId does not match","0x32d":"Invalid localOpMetadata in submit","0x32e":"Unexpected pending message received","0x32f":"Invalid localOpMetadata for sub directory op","0x330":"Unexpected pending message received","0x331":"Unexpected pending message received","0x332":"Unexpected pending message received","0x333":"PathShared.splice can only insert detached ranges","0x334":"Anchor must not be double freed","0x335":"ObjectForest.getRoot only valid for existing roots","0x336":"ObjectForest must only be given its own Anchors","0x337":"ObjectForest must only be given its own Cursor type","0x338":"ObjectForest must only be given its own Cursor","0x339":"Anchor must not be double freed","0x33a":"Anchor must not be double freed","0x33b":"Cursor must not be freed","0x33c":"Cursor must not be freed","0x33d":"Cursor must be current to be used","0x33e":"Cursor must be current to be used","0x33f":"Cursor must not be double freed","0x340":"Cursor must be current to be used","0x341":"Cursor must be current to be used","0x342":'Invalid usage. "blobid" should always be null',"0x343":'Invalid usage. "count" should always be 1',"0x344":"this.pendingConnection should be undefined","0x345":"this.pendingConnection is undefined when trying to cancel","0x346":"inboundQueuePausedFromInit should be true"}});var O5=z(hg=>{"use strict";Object.defineProperty(hg,"__esModule",{value:!0});hg.validateAssertionError=void 0;var BK=P5();function qK(n,e){var t;let r=(t=BK.shortCodeMap[n.message])!==null&&t!==void 0?t:n.message;if(r!==e)throw new Error(`Unexpected assertion thrown: ${n.message} ('${r}')`);return!0}hg.validateAssertionError=qK});var M5=z(Rn=>{"use strict";var LK=Rn&&Rn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Qi=Rn&&Rn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&LK(e,n,t)};Object.defineProperty(Rn,"__esModule",{value:!0});Qi(h5(),Rn);Qi(g5(),Rn);Qi(Ab(),Rn);Qi(m5(),Rn);Qi(Nb(),Rn);Qi(y5(),Rn);Qi(w5(),Rn);Qi(O5(),Rn)});function zx(n,e,t,r=i=>i){return n*r(.5-e*(.5-t))}function F5(n){return[-n[0],-n[1]]}function or(n,e){return[n[0]+e[0],n[1]+e[1]]}function $n(n,e){return[n[0]-e[0],n[1]-e[1]]}function ir(n,e){return[n[0]*e,n[1]*e]}function T5(n,e){return[n[0]/e,n[1]/e]}function Ms(n){return[n[1],-n[0]]}function Ix(n,e){return n[0]*e[0]+n[1]*e[1]}function z5(n,e){return n[0]===e[0]&&n[1]===e[1]}function I5(n){return Math.hypot(n[0],n[1])}function R5(n){return n[0]*n[0]+n[1]*n[1]}function Rx(n,e){return R5($n(n,e))}function qx(n){return T5(n,I5(n))}function N5(n,e){return Math.hypot(n[1]-e[1],n[0]-e[0])}function Ss(n,e,t){let r=Math.sin(t),i=Math.cos(t),o=n[0]-e[0],a=n[1]-e[1],s=o*i-a*r,c=o*r+a*i;return[s+e[0],c+e[1]]}function Og(n,e,t){return or(n,ir($n(e,n),t))}function Nx(n,e,t){return or(n,ir(e,t))}var{min:Ho,PI:B5}=Math,Bx=.275,Es=B5+1e-4;function q5(n,e={}){let{size:t=16,smoothing:r=.5,thinning:i=.5,simulatePressure:o=!0,easing:a=N=>N,start:s={},end:c={},last:l=!1}=e,{cap:h=!0,easing:u=N=>N*(2-N)}=s,{cap:d=!0,easing:p=N=>--N*N*N+1}=c;if(n.length===0||t<=0)return[];let m=n[n.length-1].runningLength,f=s.taper===!1?0:s.taper===!0?Math.max(t,m):s.taper,x=c.taper===!1?0:c.taper===!0?Math.max(t,m):c.taper,b=Math.pow(t*r,2),_=[],O=[],S=n.slice(0,10).reduce((N,L)=>{let V=L.pressure;if(o){let G=Ho(1,L.distance/t),re=Ho(1,1-G);V=Ho(1,N+(re-N)*(G*Bx))}return(N+V)/2},n[0].pressure),E=zx(t,i,n[n.length-1].pressure,a),F,I=n[0].vector,y=n[0].point,P=y,C=y,M=P,A=!1;for(let N=0;N<n.length;N++){let{pressure:L}=n[N],{point:V,vector:G,distance:re,runningLength:te}=n[N];if(N<n.length-1&&m-te<3)continue;if(i){if(o){let pe=Ho(1,re/t),Ae=Ho(1,1-pe);L=Ho(1,S+(Ae-S)*(pe*Bx))}E=zx(t,i,L,a)}else E=t/2;F===void 0&&(F=E);let be=te<f?u(te/f):1,ge=m-te<x?p((m-te)/x):1;E=Math.max(.01,E*Math.min(be,ge));let rt=(N<n.length-1?n[N+1]:n[N]).vector,He=N<n.length-1?Ix(G,rt):1,Ue=Ix(G,I)<0&&!A,Ke=He!==null&&He<0;if(Ue||Ke){let pe=ir(Ms(I),E);for(let Ae=1/13,Me=0;Me<=1;Me+=Ae)C=Ss($n(V,pe),V,Es*Me),_.push(C),M=Ss(or(V,pe),V,Es*-Me),O.push(M);y=C,P=M,Ke&&(A=!0);continue}if(A=!1,N===n.length-1){let pe=ir(Ms(G),E);_.push($n(V,pe)),O.push(or(V,pe));continue}let ze=ir(Ms(Og(rt,G,He)),E);C=$n(V,ze),(N<=1||Rx(y,C)>b)&&(_.push(C),y=C),M=or(V,ze),(N<=1||Rx(P,M)>b)&&(O.push(M),P=M),S=L,I=G}let T=n[0].point.slice(0,2),k=n.length>1?n[n.length-1].point.slice(0,2):or(n[0].point,[1,1]),D=[],R=[];if(n.length===1){if(!(f||x)||l){let N=Nx(T,qx(Ms($n(T,k))),-(F||E)),L=[];for(let V=1/13,G=V;G<=1;G+=V)L.push(Ss(N,T,Es*2*G));return L}}else{if(!(f||x&&n.length===1))if(h)for(let L=1/13,V=L;V<=1;V+=L){let G=Ss(O[0],T,Es*V);D.push(G)}else{let L=$n(_[0],O[0]),V=ir(L,.5),G=ir(L,.51);D.push($n(T,V),$n(T,G),or(T,G),or(T,V))}let N=Ms(F5(n[n.length-1].vector));if(x||f&&n.length===1)R.push(k);else if(d){let L=Nx(k,N,E);for(let V=1/29,G=V;G<1;G+=V)R.push(Ss(L,k,Es*3*G))}else R.push(or(k,ir(N,E)),or(k,ir(N,E*.99)),$n(k,ir(N,E*.99)),$n(k,ir(N,E)))}return _.concat(R,O.reverse(),D)}function L5(n,e={}){var t;let{streamline:r=.5,size:i=16,last:o=!1}=e;if(n.length===0)return[];let a=.15+(1-r)*.85,s=Array.isArray(n[0])?n:n.map(({x:p,y:m,pressure:f=.5})=>[p,m,f]);if(s.length===2){let p=s[1];s=s.slice(0,-1);for(let m=1;m<5;m++)s.push(Og(s[0],p,m/4))}s.length===1&&(s=[...s,[...or(s[0],[1,1]),...s[0].slice(2)]]);let c=[{point:[s[0][0],s[0][1]],pressure:s[0][2]>=0?s[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],l=!1,h=0,u=c[0],d=s.length-1;for(let p=1;p<s.length;p++){let m=o&&p===d?s[p].slice(0,2):Og(u.point,s[p],a);if(z5(u.point,m))continue;let f=N5(m,u.point);if(h+=f,p<d&&!l){if(h<i)continue;l=!0}u={point:m,pressure:s[p][2]>=0?s[p][2]:.5,vector:qx($n(u.point,m)),distance:f,runningLength:h},c.push(u)}return c[0].vector=((t=c[1])==null?void 0:t.vector)||[0,0],c}function $l(n,e={}){return q5(L5(n,e),e)}var j5=["svgContainer"],V5=["textInput"],H5=(n,e)=>[0,0,n,e];function U5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"rect",20),j()),n&2){let t=ne();H(),me("width",t.canvasWidth*t.zoom+100*2)("height",t.canvasHeight*t.zoom+100*2)}}function G5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"path",24),j()),n&2){let t=ne().$implicit;H(),me("d",t.value)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)}}function W5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"image",25),j()),n&2){let t=ne().$implicit;H(),me("height",t.options.height)("width",t.options.width)("href",t.value,null,"xlink")("href",t.value)("stroke-width",t.options.strokeWidth)("stroke-dasharray",t.options.dasharray)("fill",t.options.fill)("stroke",t.options.strokeColor)}}function K5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"line",26),j()),n&2){let t=ne().$implicit;H(),me("x1",t.options.x1)("y1",t.options.y1)("x2",t.options.x2)("y2",t.options.y2)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)}}function $5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"rect",27),j()),n&2){let t=ne().$implicit;H(),me("x",t.options.x2)("y",t.options.y2)("rx",t.options.rx)("width",t.options.width)("height",t.options.height)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",t.options.dashoffset)("stroke-width",t.options.strokeWidth)("fill",t.options.fill)("stroke",t.options.strokeColor)}}function X5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"ellipse",28),j()),n&2){let t=ne().$implicit;H(),me("cx",t.options.cx)("cy",t.options.cy)("rx",t.options.rx)("ry",t.options.ry)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)("fill",t.options.fill)}}function J5(n,e){if(n&1&&(ce(),q(0,"g")(1,"text",29),it(2),j()()),n&2){let t=ne().$implicit;H(),me("x",t.options.left)("y",t.options.top)("width",t.options.width)("height",t.options.height)("font-size",t.options.fontSize)("font-family",t.options.fontFamily)("stroke-dasharray",t.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.options.strokeWidth)("stroke-linecap",t.options.lineCap)("stroke-linejoin",t.options.lineJoin)("stroke",t.options.strokeColor)("fill",t.options.fill)("font-style",t.options.fontStyle)("font-weight",t.options.fontWeight),H(),no(" ",t.value," ")}}function Q5(n,e){n&1&&(ce(),q(0,"g")(1,"text"),it(2,"Not defined type"),j()())}function Y5(n,e){if(n&1&&(ce(),ci(0),q(1,"g",21),we(2,G5,2,7,"g",22)(3,W5,2,8,"g",22)(4,K5,2,10,"g",22)(5,$5,2,10,"g",22)(6,X5,2,11,"g",22)(7,J5,3,16,"g",22)(8,Q5,3,0,"g",23),j(),li()),n&2){let t=e.$implicit,r=ne();H(),ee("id","item_"+t.id)("ngSwitch",t.type),me("data-wb-id",t.id)("transform","translate("+t.x+","+t.y+")rotate("+t.rotation+")")("opacity",t.opacity/100),H(),ee("ngSwitchCase",r.types.BRUSH),H(),ee("ngSwitchCase",r.types.IMAGE),H(),ee("ngSwitchCase",r.types.LINE),H(),ee("ngSwitchCase",r.types.RECT),H(),ee("ngSwitchCase",r.types.ELLIPSE),H(),ee("ngSwitchCase",r.types.TEXT)}}function Z5(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"path",24),j()),n&2){let t=ne(2);H(),me("d",t.tempElement.value)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)}}function eD(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"image",25),j()),n&2){let t=ne(2);H(),me("height",t.tempElement.options.height)("width",t.tempElement.options.width)("href",t.tempElement.value,null,"xlink")("href",t.tempElement.value)("stroke-width",t.tempElement.options.strokeWidth)("stroke-dasharray",t.tempElement.options.dasharray)("fill",t.tempElement.options.fill)("stroke",t.tempElement.options.strokeColor)}}function tD(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"line",26),j()),n&2){let t=ne(2);H(),me("x1",t.tempElement.options.x1)("y1",t.tempElement.options.y1)("x2",t.tempElement.options.x2)("y2",t.tempElement.options.y2)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)}}function nD(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"rect",27),j()),n&2){let t=ne(2);H(),me("x",t.tempElement.options.x2)("y",t.tempElement.options.y2)("rx",t.tempElement.options.rx)("width",t.tempElement.options.width)("height",t.tempElement.options.height)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",t.tempElement.options.dashoffset)("stroke-width",t.tempElement.options.strokeWidth)("fill",t.tempElement.options.fill)("stroke",t.tempElement.options.strokeColor)}}function rD(n,e){if(n&1&&(ce(),q(0,"g"),Z(1,"ellipse",28),j()),n&2){let t=ne(2);H(),me("cx",t.tempElement.options.cx)("cy",t.tempElement.options.cy)("rx",t.tempElement.options.rx)("ry",t.tempElement.options.ry)("stroke-dasharray",t.tempElement.options.dasharray)("stroke-dashoffset",1)("stroke-width",t.tempElement.options.strokeWidth)("stroke-linecap",t.tempElement.options.lineCap)("stroke-linejoin",t.tempElement.options.lineJoin)("stroke",t.tempElement.options.strokeColor)("fill",t.tempElement.options.fill)}}function iD(n,e){n&1&&(ce(),Z(0,"g"))}function oD(n,e){n&1&&(ce(),q(0,"g")(1,"text"),it(2,"Not defined type"),j()())}function aD(n,e){if(n&1&&(ce(),q(0,"g",30),we(1,Z5,2,7,"g",22)(2,eD,2,8,"g",22)(3,tD,2,10,"g",22)(4,nD,2,10,"g",22)(5,rD,2,11,"g",22)(6,iD,1,0,"g",22)(7,oD,3,0,"g",23),j()),n&2){let t=ne();ee("ngSwitch",t.selectedTool),H(),ee("ngSwitchCase",t.tools.BRUSH),H(),ee("ngSwitchCase",t.types.IMAGE),H(),ee("ngSwitchCase",t.types.LINE),H(),ee("ngSwitchCase",t.types.RECT),H(),ee("ngSwitchCase",t.types.ELLIPSE),H(),ee("ngSwitchCase",t.types.TEXT)}}function sD(n,e){if(n&1){let t=yt();ce(),q(0,"g",31)(1,"g",32)(2,"g",33)(3,"rect",34),K("pointerdown",function(i){ae(t);let o=ne();return se(o.moveSelect(i))}),j()(),q(4,"g",33),Z(5,"circle",35)(6,"circle",36)(7,"circle",37)(8,"circle",38),q(9,"rect",39),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(10,"rect",40),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(11,"rect",41),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(12,"rect",42),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(13,"rect",43),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(14,"rect",44),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(15,"rect",45),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j(),q(16,"rect",46),K("pointerdown",function(i){ae(t);let o=ne();return se(o.resizeSelect(i))}),j()()()()}if(n&2){let t=ne();H(),tn("display",t.rubberBox.display),me("transform","translate("+t.selectedElement.x+","+t.selectedElement.y+")rotate("+t.selectedElement.rotation+")"),H(2),me("x",t.rubberBox.x)("y",t.rubberBox.y)("width",t.rubberBox.width)("height",t.rubberBox.height),H(2),me("cx",t.rubberBox.x-4)("cy",t.rubberBox.y-4),H(),me("cx",t.rubberBox.x+t.rubberBox.width+4)("cy",t.rubberBox.y-4),H(),me("cx",t.rubberBox.x+t.rubberBox.width+4)("cy",t.rubberBox.y+t.rubberBox.height+4),H(),me("cx",t.rubberBox.x-4)("cy",t.rubberBox.y+t.rubberBox.height+4),H(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y-4),H(),me("x",t.rubberBox.x+t.rubberBox.width/2-4)("y",t.rubberBox.y-4),H(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y-4),H(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y+t.rubberBox.height/2-4),H(),me("x",t.rubberBox.x+t.rubberBox.width-4)("y",t.rubberBox.y+t.rubberBox.height-4),H(),me("x",t.rubberBox.x+t.rubberBox.width/2-4)("y",t.rubberBox.y+t.rubberBox.height-4),H(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y+t.rubberBox.height-4),H(),me("x",t.rubberBox.x-4)("y",t.rubberBox.y+t.rubberBox.height/2-4)}}function cD(n,e){if(n&1){let t=yt();q(0,"div")(1,"input",47,1),K("input",function(){ae(t);let i=_r(2),o=ne();return se(o.updateTextItem(i.value))}),j()()}if(n&2){let t=_r(2),r=ne();tn("font-family",r.fontFamily)("font-size",r.fontSize,"px")("pointer-events","none")("width",r.canvasWidth*r.zoom,"px")("height",r.canvasHeight*r.zoom,"px")("position","absolute")("top",r.y,"px")("left",r.x,"px"),H(),tn("width",t.value.length+"ch")("height",2*r.zoom+"ch")("top",(r.tempElement.options.top||0)*r.zoom,"px")("left",(r.tempElement.options.left||0)*r.zoom,"px")("font-size",r.tempElement.options.fontSize,"px"),ee("value",r.tempElement.value)}}var It=function(n){return n.BRUSH="BRUSH",n.LINE="LINE",n.RECT="RECT",n.ELLIPSE="ELLIPSE",n.IMAGE="IMAGE",n.TEXT="TEXT",n.SHAPE="SHAPE",n}(It||{}),Uo=function(n){return n.BUTT="butt",n.SQUARE="square",n.ROUND="round",n}(Uo||{}),Go=function(n){return n.MITER="miter",n.ROUND="round",n.BEVEL="bevel",n.MITER_CLIP="miter-clip",n}(Go||{}),_e=function(n){return n.SELECT="SELECT",n.BRUSH="BRUSH",n.IMAGE="IMAGE",n.LINE="LINE",n.RECT="RECT",n.ELLIPSE="ELLIPSE",n.TEXT="TEXT",n.ERASER="ERASER",n}(_e||{}),Sg=class{constructor(e){this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.lineCap=e.lineCap||Uo.ROUND,this.lineJoin=e.lineJoin||Go.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Eg=class{constructor(e){this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.dasharray=e.dasharray||"",this.fill=e.fill||"#000000"}},Ag=class{constructor(e){this.x1=e.x1||0,this.y1=e.y1||0,this.x2=e.x2||0,this.y2=e.y2||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.lineCap=e.lineCap||Uo.ROUND,this.lineJoin=e.lineJoin||Go.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},kg=class{constructor(e){this.left=e.left||0,this.top=e.top||0,this.width=e.width||0,this.height=e.height||0,this.fontFamily=e.fontFamily||"Arial",this.fontSize=e.fontSize||14,this.fontStyle=e.fontStyle||"normal",this.fontWeight=e.fontWeight||"normal",this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.lineJoin=e.lineJoin||Go.ROUND,this.lineCap=e.lineCap||Uo.ROUND,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Dg=class{constructor(e){this.cx=e.cx||0,this.cy=e.cy||0,this.rx=e.rx||0,this.ry=e.ry||0,this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.lineCap=e.lineCap||Uo.ROUND,this.lineJoin=e.lineJoin||Go.ROUND}},Fg=class{constructor(e){this.width=e.width||0,this.height=e.height||0,this.x1=e.x1||0,this.y1=e.y1||0,this.rx=e.rx||0,this.strokeWidth=e.strokeWidth||2,this.strokeColor=e.strokeColor||"#000000",this.fill=e.fill||"#000000",this.dasharray=e.dasharray||"",this.dashoffset=e.dashoffset||0}},Tg=class{constructor(e,t,r){switch(this.x=0,this.y=0,this.rotation=0,this.opacity=100,this.options={},this.type=e,this.value=r||"",this.id=`element_${this.type}_${Math.floor(Math.random()*1e3)}`,e){case It.BRUSH:this.options=new Sg(t);break;case It.IMAGE:this.options=new Eg(t);break;case It.RECT:this.options=new Fg(t);break;case It.LINE:this.options=new Ag(t);break;case It.ELLIPSE:this.options=new Dg(t);break;case It.TEXT:this.options=new kg(t);break;default:this.options={};break}}},qr=function(n){return n.Png="png",n.Jpeg="jpeg",n.Svg="svg",n.Base64="base64",n}(qr||{}),ks=(()=>{let e=class e{constructor(){this.eraseMethodCallSource=new tt,this.saveMethodCallSource=new tt,this.undoMethodCallSource=new tt,this.redoMethodCallSource=new tt,this.addImageMethodCallSource=new tt,this.eraseMethodCalled$=this.eraseMethodCallSource.asObservable(),this.saveMethodCalled$=this.saveMethodCallSource.asObservable(),this.undoMethodCalled$=this.undoMethodCallSource.asObservable(),this.redoMethodCalled$=this.redoMethodCallSource.asObservable(),this.addImageMethodCalled$=this.addImageMethodCallSource.asObservable()}erase(){this.eraseMethodCallSource.next()}save(r=qr.Base64,i="New board"){this.saveMethodCallSource.next({name:i,format:r})}undo(){this.undoMethodCallSource.next()}redo(){this.redoMethodCallSource.next()}addImage(r,i,o){this.addImageMethodCallSource.next({image:r,x:i,y:o})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),At=class{static toSvgString(e){let r=new XMLSerializer().serializeToString(e);return r=r.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),r=r.replace(/NS\d+:href/g,"xlink:href"),r}static snapToGrid(e,t){let r=t;return Math.round(e/r)*r}static snapToAngle(e,t,r,i){let o=Math.PI/4,a=r-e,s=i-t,c=Math.atan2(s,a),l=Math.sqrt(a*a+s*s),h=Math.round(c/o)*o,u=e+l*Math.cos(h),d=t+l*Math.sin(h);return{x:u,y:d,a:h}}static downloadFile(e,t){let r=document.createElement("a");r.href=e,r.setAttribute("visibility","hidden"),r.download=t||"new white-board",document.body.appendChild(r),r.click(),document.body.removeChild(r)}static svgToBase64(e,t,r,i=qr.Png){return new Promise((o,a)=>{let s=document.createElement("canvas");s.width=t,s.height=r;let c=s.getContext("2d"),l=new Image;l.src=`data:image/svg+xml;base64,${btoa(e)}`,l.onload=()=>{c.drawImage(l,0,0,t,r);let h=s.toDataURL(`image/${i}`);o(h)},l.onerror=h=>{a(h)}})}static getSvgPathFromStroke(e,t=!0){let r=e.length;if(r<4)return"";let i=e[0],o=e[1],a=e[2],s=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${o[0].toFixed(2)},${o[1].toFixed(2)} ${((o[0]+a[0])/2).toFixed(2)},${((o[1]+a[1])/2).toFixed(2)} T`;for(let c=2,l=r-1;c<l;c++)i=e[c],o=e[c+1],s+=`${((i[0]+o[0])/2).toFixed(2)},${((i[1]+o[1])/2).toFixed(2)} `;return t&&(s+="Z"),s}},zg=(()=>{let e=class e{constructor(){this.isPointing=!1,this.pointerDownSubject=new tt,this.pointerMoveSubject=new tt,this.pointerUpSubject=new tt}onPointerDown(r){this.isPointing=!0,this.pointerDownSubject.next(r)}onPointerMove(r){this.isPointing&&this.pointerMoveSubject.next(r)}onPointerUp(r){this.isPointing=!1,this.pointerUpSubject.next(r)}getPointerDown$(){return this.pointerDownSubject.asObservable()}getPointerMove$(){return this.pointerMoveSubject.asObservable()}getPointerUp$(){return this.pointerUpSubject.asObservable()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac});let n=e;return n})(),lD=(()=>{let e=class e{constructor(r,i){this.elementRef=r,this.svgService=i}onPointerDown(r){if(r.button!==0&&r.button!==1&&r.button!==5)return;this.elementRef.nativeElement.setPointerCapture(r.pointerId);let i=r;this.svgService.onPointerDown(i)}onPointerMove(r){if(r.clientX===this.lastX&&r.clientY===this.lastY)return;this.lastX=r.clientX,this.lastY=r.clientY;let i=r;this.svgService.onPointerMove(i)}onPointerUp(r){if(r.button!==0&&r.button!==1&&r.button!==2&&r.button!==5)return;this.lastX=r.clientX,this.lastY=r.clientY,this.elementRef.nativeElement.hasPointerCapture(r.pointerId)&&this.elementRef.nativeElement?.releasePointerCapture(r.pointerId);let i=r;this.svgService.onPointerUp(i)}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(zg))},e.\u0275dir=nt({type:e,selectors:[["","svg",""]],hostBindings:function(i,o){i&1&&K("pointerdown",function(s){return o.onPointerDown(s)})("pointermove",function(s){return o.onPointerMove(s)})("pointerup",function(s){return o.onPointerUp(s)})}});let n=e;return n})(),Mg={size:1,smoothing:1,thinning:0,streamline:.9},Lx=(()=>{let e=class e{set data(r){r&&this._data.next(r)}get data(){return this._data.getValue()}set selectedTool(r){this._selectedTool!==r&&(this._selectedTool===_e.TEXT&&this.tempElement?.type===It.TEXT&&this.finishTextInput(),this._selectedTool=r,this.toolChanged.emit(r),this.clearSelectedElement(),this.tempElement=null)}get selectedTool(){return this._selectedTool}constructor(r,i,o){this.whiteboardService=r,this._cd=i,this._svgService=o,this._data=new Al([]),this.drawingEnabled=!0,this.canvasWidth=800,this.canvasHeight=600,this.fullScreen=!0,this.center=!0,this.strokeColor="#000",this.strokeWidth=2,this.backgroundColor="#fff",this.lineJoin=Go.ROUND,this.lineCap=Uo.ROUND,this.fill="#333",this.zoom=1,this.fontFamily="sans-serif",this.fontSize=24,this.dasharray="",this.dashoffset=0,this.x=0,this.y=0,this.enableGrid=!1,this.gridSize=10,this.snapToGrid=!1,this.ready=new ie,this.dataChange=new ie,this.clear=new ie,this.undo=new ie,this.redo=new ie,this.save=new ie,this.imageAdded=new ie,this.selectElement=new ie,this.deleteElement=new ie,this.toolChanged=new ie,this._subscriptionList=[],this._initialData=[],this.undoStack=[],this.redoStack=[],this._selectedTool=_e.BRUSH,this.types=It,this.tools=_e,this.rubberBox={x:0,y:0,width:0,height:0,display:"none"}}ngOnInit(){this._initInputsFromOptions(this.options),this._initObservables(),this._initialData=JSON.parse(JSON.stringify(this.data))}ngOnChanges(r){r.options&&this._initInputsFromOptions(r.options.currentValue)}ngAfterViewInit(){this._resizeScreen(),this._cd.detectChanges(),this.ready.emit()}ngOnDestroy(){this._subscriptionList.forEach(r=>this._unsubscribe(r))}_initInputsFromOptions(r){r&&(r.drawingEnabled!=null&&(this.drawingEnabled=r.drawingEnabled),r.selectedTool!=null&&(this.selectedTool=r.selectedTool),r.canvasWidth!=null&&(this.canvasWidth=r.canvasWidth),r.canvasHeight!=null&&(this.canvasHeight=r.canvasHeight),r.fullScreen!=null&&(this.fullScreen=r.fullScreen),r.center!=null&&(this.center=r.center),r.strokeColor!=null&&(this.strokeColor=r.strokeColor),r.strokeWidth!=null&&(this.strokeWidth=r.strokeWidth),r.backgroundColor!=null&&(this.backgroundColor=r.backgroundColor),r.lineJoin!=null&&(this.lineJoin=r.lineJoin),r.lineCap!=null&&(this.lineCap=r.lineCap),r.fill!=null&&(this.fill=r.fill),r.zoom!=null&&(this.zoom=r.zoom),r.fontFamily!=null&&(this.fontFamily=r.fontFamily),r.fontSize!=null&&(this.fontSize=r.fontSize),r.dasharray!=null&&(this.dasharray=r.dasharray),r.dashoffset!=null&&(this.dashoffset=r.dashoffset),r.x!=null&&(this.x=r.x),r.y!=null&&(this.y=r.y),r.enableGrid!=null&&(this.enableGrid=r.enableGrid),r.gridSize!=null&&(this.gridSize=r.gridSize),r.snapToGrid!=null&&(this.snapToGrid=r.snapToGrid))}_initObservables(){this._subscriptionList.push(this._svgService.getPointerDown$().subscribe(this.handleStartEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerMove$().subscribe(this.handleDragEvent.bind(this))),this._subscriptionList.push(this._svgService.getPointerUp$().subscribe(this.handleEndEvent.bind(this))),this._subscriptionList.push(this.whiteboardService.saveMethodCalled$.subscribe(({name:r,format:i})=>this.saveDraw(r,i))),this._subscriptionList.push(this.whiteboardService.addImageMethodCalled$.subscribe(r=>this.addImage(r))),this._subscriptionList.push(this.whiteboardService.eraseMethodCalled$.subscribe(()=>this.clearDraw())),this._subscriptionList.push(this.whiteboardService.undoMethodCalled$.subscribe(()=>this.undoDraw())),this._subscriptionList.push(this.whiteboardService.redoMethodCalled$.subscribe(()=>this.redoDraw())),this._subscriptionList.push(pg(window,"resize").subscribe(()=>this._resizeScreen())),this._subscriptionList.push(this._data.pipe(Yb(1)).subscribe(r=>{this.dataChange.emit(r)}))}handleStartEvent(r){this.redoStack=[];let o={[_e.BRUSH]:this.handleStartBrush,[_e.IMAGE]:this.handleImageTool,[_e.LINE]:this.handleStartLine,[_e.RECT]:this.handleStartRect,[_e.ELLIPSE]:this.handleStartEllipse,[_e.TEXT]:this.handleTextTool,[_e.SELECT]:this.handleSelectTool,[_e.ERASER]:this.handleEraserTool}[this.selectedTool];o&&o.apply(this,[r])}handleDragEvent(r){let o={[_e.BRUSH]:this.handleDragBrush,[_e.LINE]:this.handleDragLine,[_e.RECT]:this.handleDragRect,[_e.ELLIPSE]:this.handleDragEllipse,[_e.TEXT]:this.handleTextDrag}[this.selectedTool];o&&o.apply(this,[r])}handleEndEvent(r){let o={[_e.BRUSH]:this.handleEndBrush,[_e.LINE]:this.handleEndLine,[_e.RECT]:this.handleEndRect,[_e.ELLIPSE]:this.handleEndEllipse,[_e.TEXT]:this.handleTextEnd}[this.selectedTool];o&&o.apply(this,[r])}handleStartBrush(r){let i=this._generateNewElement(It.BRUSH);this.tempDraw=[this._calculateXAndY([r.offsetX,r.offsetY])];let o=$l(this.tempDraw,Mg),a=At.getSvgPathFromStroke(o);i.value=a,i.options.strokeWidth=this.strokeWidth,this.tempElement=i}handleDragBrush(r){this.tempDraw.push(this._calculateXAndY([r.offsetX,r.offsetY]));let i=$l(this.tempDraw,Mg),o=At.getSvgPathFromStroke(i);this.tempElement.value=o}handleEndBrush(r){this.tempDraw.push(this._calculateXAndY([r.offsetX,r.offsetY]));let i=$l(this.tempDraw,Mg),o=At.getSvgPathFromStroke(i);this.tempElement.value=o,this._pushToData(this.tempElement),this._pushToUndo(),this.tempDraw=null,this.tempElement=null}handleImageTool(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=s=>{let c=s.target.files;if(c){let l=new FileReader;l.onload=h=>{let u=h.target.result;this.addImage({image:u,x:i,y:o})},l.readAsDataURL(c[0])}},a.click()}handleStartLine(r){let i=this._generateNewElement(It.LINE),[o,a]=this._calculateXAndY([r.offsetX,r.offsetY]);this.snapToGrid&&(o=At.snapToGrid(o,this.gridSize),a=At.snapToGrid(a,this.gridSize)),i.options.x1=o,i.options.y1=a,i.options.x2=o,i.options.y2=a,this.tempElement=i}handleDragLine(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]);if(this.snapToGrid&&(i=At.snapToGrid(i,this.gridSize),o=At.snapToGrid(o,this.gridSize)),r.shiftKey){let a=this.tempElement.options.x1,s=this.tempElement.options.y1,{x:c,y:l}=At.snapToAngle(a,s,i,o);[i,o]=[c,l]}this.tempElement.options.x2=i,this.tempElement.options.y2=o}handleEndLine(){(this.tempElement.options.x1!=this.tempElement.options.x2||this.tempElement.options.y1!=this.tempElement.options.y2)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartRect(r){let i=this._generateNewElement(It.RECT),[o,a]=this._calculateXAndY([r.offsetX,r.offsetY]);this.snapToGrid&&(o=At.snapToGrid(o,this.gridSize),a=At.snapToGrid(a,this.gridSize)),i.options.x1=o,i.options.y1=a,i.options.x2=o,i.options.y2=a,i.options.width=1,i.options.height=1,this.tempElement=i}handleDragRect(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),a=this.tempElement.options.x1||0,s=this.tempElement.options.y1||0,c=Math.abs(i-a),l=Math.abs(o-s),h=null,u=null;r.shiftKey?(c=l=Math.max(c,l),h=a<i?a:a-c,u=s<o?s:s-l):(h=Math.min(a,i),u=Math.min(s,o)),r.altKey&&(c*=2,l*=2,h=a-c/2,u=s-l/2),this.snapToGrid&&(c=At.snapToGrid(c,this.gridSize),l=At.snapToGrid(l,this.gridSize),h=At.snapToGrid(h,this.gridSize),u=At.snapToGrid(u,this.gridSize)),this.tempElement.options.width=c,this.tempElement.options.height=l,this.tempElement.options.x2=h,this.tempElement.options.y2=u}handleEndRect(){(this.tempElement.options.width!=0||this.tempElement.options.height!=0)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleStartEllipse(r){let i=this._generateNewElement(It.ELLIPSE),[o,a]=this._calculateXAndY([r.offsetX,r.offsetY]);i.options.x1=o,i.options.y1=a,i.options.cx=o,i.options.cy=a,this.tempElement=i}handleDragEllipse(r){let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]),a=this.tempElement.options.x1||0,s=this.tempElement.options.y1||0,c=Math.abs(a+(i-a)/2),l=Math.abs(s+(o-s)/2),h=Math.abs(a-c),u=Math.abs(s-l);r.shiftKey&&(u=h,l=o>s?s+h:s-h),r.altKey&&(c=a,l=s,h=Math.abs(i-c),u=r.shiftKey?h:Math.abs(o-l)),this.tempElement.options.rx=h,this.tempElement.options.ry=u,this.tempElement.options.cx=c,this.tempElement.options.cy=l}handleEndEllipse(){(this.tempElement.options.rx!=0||this.tempElement.options.ry!=0)&&(this._pushToData(this.tempElement),this._pushToUndo(),this.tempElement=null)}handleTextTool(r){if(this.tempElement){this.finishTextInput();return}let i=this._getTargetElement(r);if(i&&i.type===It.TEXT)this._removeFromData(i);else{i=this._generateNewElement(It.TEXT);let[o,a]=this._calculateXAndY([r.offsetX,r.offsetY]);i.options.top=a,i.options.left=o,i.options.strokeWidth=0}this.tempElement=i,this._cd.detectChanges(),setTimeout(()=>{this.textInput.nativeElement.focus()},0)}handleTextDrag(r){if(!this.tempElement)return;let[i,o]=this._calculateXAndY([r.offsetX,r.offsetY]);this.tempElement.options.top=o,this.tempElement.options.left=i}handleTextEnd(){this.tempElement&&this._pushToUndo()}handleSelectTool(r){let i=this._getMouseTarget(r);if(i){if(i.id==="selectorGroup")return;let o=i.getAttribute("data-wb-id"),a=this.data.find(s=>s.id===o);this.setSelectedElement(a)}else this.clearSelectedElement()}handleEraserTool(r){let i=this._getTargetElement(r);i&&(this.data=this.data.filter(o=>o.id!==i.id),this._pushToUndo(),this.deleteElement.emit(i))}finishTextInput(){let r=this.textInput.nativeElement.value;this.tempElement.value=r,this.tempElement.value&&(this._pushToData(this.tempElement),this._pushToUndo()),this.tempElement=null}updateTextItem(r){this.tempElement&&this.selectedTool==_e.TEXT&&(this.tempElement.value=r)}setSelectedElement(r){this.selectedTool=_e.SELECT;let i=this._getElementBbox(r);this.selectedElement=r,this.selectElement.emit(r),this._showGrips(i)}clearSelectedElement(){this.selectedElement=null,this.rubberBox.display="none",this.selectElement.emit(null)}addImage(r){let i=new Image;i.onload=()=>{let o=this.canvasHeight,a=i.width,s=i.height,c=i.width/i.height,l=s>o?o-40:s,h=l===o-40?(o-40)*c:a,u=r.x||(a-h)*(r.x||0),d=r.y||(s-l)*(r.y||0);u<0&&(u=0),d<0&&(d=0);let p=this._generateNewElement(It.IMAGE);p.value=r.image,p.options.width=h,p.options.height=l,p.x=u,p.y=d,this._pushToData(p),this.imageAdded.emit(),this._pushToUndo()},i.src=r.image}saveDraw(r,i){return v(this,null,function*(){let a=this.svgContainer.nativeElement.getElementById("svgcontent").cloneNode(!0),s=a.getElementById("selectorParentGroup");s&&s.remove();let c=a.getElementById("contentBackground");c&&c.removeAttribute("opacity"),a.setAttribute("x","0"),a.setAttribute("y","0");let l=new XMLSerializer().serializeToString(a),h=yield At.svgToBase64(l,this.canvasWidth,this.canvasHeight,i);switch(i){case qr.Base64:this.save.emit(h);break;case qr.Svg:{let u="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l)));At.downloadFile(u,r),this.save.emit(u);break}default:At.downloadFile(h,r),this.save.emit(h);break}})}clearDraw(){this.data=[],this._data.next(this.data),this._pushToUndo(),this.clear.emit()}undoDraw(){if(!this.undoStack.length)return;let r=this.undoStack.pop();this.redoStack.push(r),this.undoStack.length?this.data=JSON.parse(JSON.stringify(this.undoStack[this.undoStack.length-1])):this.data=JSON.parse(JSON.stringify(this._initialData)),this.undo.emit()}redoDraw(){if(!this.redoStack.length)return;let r=this.redoStack.pop();this.undoStack.push(JSON.parse(JSON.stringify(r))),this.data=r,this.redo.emit()}_pushToUndo(){this.undoStack.push(JSON.parse(JSON.stringify(this.data)))}_pushToData(r){this.data.push(r),this._data.next(this.data)}_removeFromData(r){let i=this.data.indexOf(r);i>-1&&(this.data.splice(i,1),this._data.next(this.data))}_generateNewElement(r){return new Tg(r,{strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fill:this.fill,lineJoin:this.lineJoin,lineCap:this.lineCap,fontSize:this.fontSize,fontFamily:this.fontFamily,dasharray:this.dasharray,dashoffset:this.dashoffset})}_calculateXAndY([r,i]){return[(r-this.x)/this.zoom,(i-this.y)/this.zoom]}_resizeScreen(){let r=this.svgContainer.nativeElement;this.fullScreen&&(this.canvasWidth=r.clientWidth,this.canvasHeight=r.clientHeight),this.center&&(this.x=r.clientWidth/2-this.canvasWidth/2,this.y=r.clientHeight/2-this.canvasHeight/2)}_getElementBbox(r){let i=`item_${r.id}`;return this.svgContainer.nativeElement.getElementById(i).getBBox()}_getMouseTarget(r){if(r==null||r.target==null)return null;let i=r.target;if(i.id==="svgroot")return null;if(i.parentNode){if(i=i.parentNode.parentNode,i.id==="selectorGroup")return i;for(;!i.id.includes("item_");){if(i.id==="svgroot")return null;i=i.parentNode}}return i}_getTargetElement(r){let i=this._getMouseTarget(r);if(i){if(i.id==="selectorGroup")return null;let o=i.getAttribute("data-wb-id");return this.data.find(a=>a.id===o)}return null}_showGrips(r){this.rubberBox={x:r.x-(this.selectedElement.options.strokeWidth||0)*.5,y:r.y-(this.selectedElement.options.strokeWidth||0)*.5,width:r.width+this.selectedElement.options.strokeWidth||0,height:r.height+this.selectedElement.options.strokeWidth||0,display:"block"}}moveSelect(r){let i=!0;r.stopPropagation();let o=r.target;o.addEventListener("pointermove",a=>{i&&this.selectedElement&&(this.selectedElement.x+=a.movementX,this.selectedElement.y+=a.movementY)}),o.addEventListener("pointerup",()=>{i=!1})}resizeSelect(r){let i=!0,o=r.target;document.addEventListener("pointermove",a=>{if(!i)return;let s=o.id.split("_")[2],c=a.movementX,l=a.movementY,h=this._getElementBbox(this.selectedElement),u=h.width,d=h.height;switch(this.selectedElement.type){case It.ELLIPSE:this._resizeElipse(s,{x:c,y:l,width:u,height:d});break;case It.LINE:this._resizeLine(s,{x:c,y:l,width:u,height:d});break;default:this._resizeDefault(s,{x:c,y:l,width:u,height:d});break}this._showGrips(this._getElementBbox(this.selectedElement))}),document.addEventListener("pointerup",()=>{i=!1})}_resizeLine(r,i){switch(r){case"nw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y1+=i.y;break;case"n":this.selectedElement.options.y1+=i.y;break;case"ne":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y1+=i.y;break;case"e":this.selectedElement.options.x2+=i.x;break;case"se":this.selectedElement.options.x2+=i.x,this.selectedElement.options.y2+=i.y;break;case"s":this.selectedElement.options.y2+=i.y;break;case"sw":this.selectedElement.options.x1+=i.x,this.selectedElement.options.y2+=i.y;break;case"w":this.selectedElement.options.x1+=i.x;break}}_resizeElipse(r,i){switch(r){case"nw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"n":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry-=i.y/2;break;case"ne":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry-=i.y/2;break;case"e":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx+=i.x/2;break;case"se":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx+=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"s":this.selectedElement.y+=i.y/2,this.selectedElement.options.ry+=i.y/2;break;case"sw":this.selectedElement.x+=i.x/2,this.selectedElement.y+=i.y/2,this.selectedElement.options.rx-=i.x/2,this.selectedElement.options.ry+=i.y/2;break;case"w":this.selectedElement.x+=i.x/2,this.selectedElement.options.rx-=i.x/2;break}}_resizeDefault(r,i){switch(r){case"nw":this.selectedElement.x+=i.x,this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height-i.y;break;case"n":this.selectedElement.y+=i.y,this.selectedElement.options.height=i.height-i.y;break;case"ne":this.selectedElement.y+=i.y,this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height-i.y;break;case"e":this.selectedElement.options.width=i.width+i.x;break;case"se":this.selectedElement.options.width=i.width+i.x,this.selectedElement.options.height=i.height+i.y;break;case"s":this.selectedElement.options.height=i.height+i.y;break;case"sw":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x,this.selectedElement.options.height=i.height+i.y;break;case"w":this.selectedElement.x+=i.x,this.selectedElement.options.width=i.width-i.x;break}}_unsubscribe(r){r&&r.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)(X(ks),X(yr),X(zg))},e.\u0275cmp=fe({type:e,selectors:[["ng-whiteboard"]],viewQuery:function(i,o){if(i&1&&(Ct(j5,5),Ct(V5,5)),i&2){let a;Xe(a=Je())&&(o.svgContainer=a.first),Xe(a=Je())&&(o.textInput=a.first)}},inputs:{data:"data",options:"options",selectedTool:"selectedTool",drawingEnabled:"drawingEnabled",canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",fullScreen:"fullScreen",center:"center",strokeColor:"strokeColor",strokeWidth:"strokeWidth",backgroundColor:"backgroundColor",lineJoin:"lineJoin",lineCap:"lineCap",fill:"fill",zoom:"zoom",fontFamily:"fontFamily",fontSize:"fontSize",dasharray:"dasharray",dashoffset:"dashoffset",x:"x",y:"y",enableGrid:"enableGrid",gridSize:"gridSize",snapToGrid:"snapToGrid"},outputs:{ready:"ready",dataChange:"dataChange",clear:"clear",undo:"undo",redo:"redo",save:"save",imageAdded:"imageAdded",selectElement:"selectElement",deleteElement:"deleteElement",toolChanged:"toolChanged"},features:[gn([zg]),tr],decls:19,vars:24,consts:[["svgContainer",""],["textInput",""],["id","svgroot","xlinkns","http://www.w3.org/2000/svg","svg",""],["id","canvasBackground",2,"pointer-events","none"],["id","grid-pattern"],["id","smallGrid","patternUnits","userSpaceOnUse"],["fill","none","stroke","gray","stroke-width","0.5"],["id","grid","width","100","height","100","patternUnits","userSpaceOnUse"],["width","100","height","100","fill","url(#smallGrid)"],["d","M 100 0 H 0 V 100","fill","none","stroke","gray","stroke-width","2"],["id","placeholder_defs"],["width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent",2,"pointer-events","none"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","id","svgcontent"],["id","contentBackground","opacity","0","width","100%","height","100%","x","0","y","0","stroke-width","0","stroke","transparent"],[2,"pointer-events","all"],[4,"ngFor","ngForOf"],["class","temp-element",3,"ngSwitch",4,"ngIf"],["id","selectorParentGroup",4,"ngIf"],[3,"font-family","font-size","pointer-events","width","height","position","top","left",4,"ngIf"],["x","-100","y","-100","fill","url(#grid)"],[1,"wb_element",3,"id","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["fill","none",1,"brush"],["preserveAspectRatio","none",2,"pointer-events","inherit"],[1,"line",2,"pointer-events","inherit"],[1,"rect"],[2,"pointer-events","inherit"],["text-anchor","start",0,"xml","space","preserve","alignment-baseline","before-edge",1,"text_element",2,"pointer-events","inherit","white-space","normal"],[1,"temp-element",3,"ngSwitch"],["id","selectorParentGroup"],["id","selectorGroup","transform","",1,"selectorGroup"],["display","inline"],["id","selectedBox","fill","none","stroke","#4F80FF","shape-rendering","crispEdges",2,"cursor","move",3,"pointerdown"],["id","selectorGrip_rotate_nw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_ne","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_se","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_rotate_sw","fill","#000","r","8","stroke","#000","fill-opacity","0","stroke-opacity","0","stroke-width","0",1,"selector_rotate"],["id","selectorGrip_resize_nw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","nw-resize",3,"pointerdown"],["id","selectorGrip_resize_n","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","n-resize",3,"pointerdown"],["id","selectorGrip_resize_ne","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","ne-resize",3,"pointerdown"],["id","selectorGrip_resize_e","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","e-resize",3,"pointerdown"],["id","selectorGrip_resize_se","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","se-resize",3,"pointerdown"],["id","selectorGrip_resize_s","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","s-resize",3,"pointerdown"],["id","selectorGrip_resize_sw","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","sw-resize",3,"pointerdown"],["id","selectorGrip_resize_w","width","8","height","8","fill","#4F80FF","stroke","rgba(0,0,0,0)","pointer-events","all",2,"cursor","w-resize",3,"pointerdown"],["type","text","autofocus","",1,"text-input",3,"input","value"]],template:function(i,o){i&1&&(ce(),q(0,"svg",2,0)(2,"svg",3)(3,"defs",4)(4,"pattern",5),Z(5,"path",6),j(),q(6,"pattern",7),Z(7,"rect",8)(8,"path",9),j()(),Z(9,"defs",10)(10,"rect",11),we(11,U5,2,2,"g",12),j(),q(12,"svg",13),Z(13,"rect",14),q(14,"g",15),we(15,Y5,9,11,"ng-container",16)(16,aD,8,7,"g",17)(17,sD,17,31,"g",18),j()()(),we(18,cD,3,27,"div",19)),i&2&&(rx("svgroot "+o.selectedTool),H(2),me("width",o.canvasWidth*o.zoom)("height",o.canvasHeight*o.zoom)("x",o.x)("y",o.y),H(2),me("width",o.gridSize)("height",o.gridSize),H(),me("d","M "+o.gridSize+" 0 H 0 V "+o.gridSize),H(5),me("fill",o.backgroundColor),H(),ee("ngIf",o.enableGrid),H(),me("width",o.canvasWidth*o.zoom)("height",o.canvasHeight*o.zoom)("viewBox",ix(21,H5,o.canvasWidth,o.canvasHeight))("x",o.x)("y",o.y),H(),me("fill",o.backgroundColor),H(2),ee("ngForOf",o.data),H(),ee("ngIf",o.tempElement),H(),ee("ngIf",o.selectedElement),H(),ee("ngIf",o.tempElement&&o.selectedTool===o.tools.TEXT))},dependencies:[Lo,ro,dx,ux,hx,lD],styles:['[_nghost-%COMP%]{width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;width:inherit;height:inherit;min-width:inherit;min-height:inherit;max-width:inherit;max-height:inherit;background-size:cover;background-position:50%;background-repeat:no-repeat;touch-action:none}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .wb_element[_ngcontent-%COMP%], [_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .selectorGroup[_ngcontent-%COMP%]{transform-box:fill-box;transform-origin:center}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif}[_nghost-%COMP%]   .svgroot.drawing[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 height%3D%2220%22 width%3D%2220%22%3E  %3Ccircle cx%3D%225%22 cy%3D%225%22 r%3D%225%22 style%3D%22fill%3A none%3B stroke%3A %235a5a5a%3B stroke-width%3A .02em%3B%22 %2F%3E%3C%2Fsvg%3E") 5 5,crosshair}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]{cursor:move}[_nghost-%COMP%]   .svgroot[_ngcontent-%COMP%]   .onMove[_ngcontent-%COMP%]   .handlers[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .HAND[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]   .SELECT[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .BRUSH[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 width%3D%2224%22 height%3D%2224%22%3E%3Cpath fill%3D%22%23333%22 stroke-width%3D%221%22 stroke%3D%22%23ccc%22 d%3D%22m16.318 6.11l-3.536-3.535l1.415-1.414c.63-.63 2.073-.755 2.828 0l.707.707c.755.755.631 2.198 0 2.829L16.318 6.11zm-1.414 1.415l-9.9 9.9l-4.596 1.06l1.06-4.596l9.9-9.9l3.536 3.536z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E") 1 18,crosshair}[_nghost-%COMP%]   .IMAGE[_ngcontent-%COMP%]{cursor:copy}[_nghost-%COMP%]   .LINE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .RECT[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .ELLIPSE[_ngcontent-%COMP%]{cursor:crosshair}[_nghost-%COMP%]   .TEXT[_ngcontent-%COMP%]{cursor:text}[_nghost-%COMP%]   .ERASER[_ngcontent-%COMP%]{cursor:url("data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 width%3D%2224%22 height%3D%2224%22%3E    %3Cpath fill%3D%22%23333%22 stroke-width%3D%221%22 stroke%3D%22%23ccc%22 d%3D%22M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm2.121.707a1 1 0 0 0-1.414 0L4.16 7.547l5.293 5.293l4.633-4.633a1 1 0 0 0 0-1.414l-3.879-3.879zM8.746 13.547L3.453 8.254L1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E") 0 12,crosshair}.foreign[_ngcontent-%COMP%]{text-align:left}.insideforeign[_ngcontent-%COMP%]{display:inline-block}.text-input[_ngcontent-%COMP%]{position:absolute;background:transparent;border:1px dashed #0b89f0;outline:none;height:25px;font-size:inherit;font-family:inherit;min-width:5ch;height:2ch;padding:0;pointer-events:auto;z-index:5}']});let n=e;return n})(),jx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({imports:[Wn]});let n=e;return n})();var Kx=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(X(gg),X(_t))},e.\u0275dir=nt({type:e});let n=e;return n})(),uD=(()=>{let e=class e extends Kx{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Il(e)))(o||e)}})(),e.\u0275dir=nt({type:e,features:[Gn]});let n=e;return n})(),id=new ft("");var hD={provide:id,useExisting:to(()=>od),multi:!0};function pD(){let n=mg()?mg().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var gD=new ft(""),od=(()=>{let e=class e extends Kx{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!pD())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(X(gg),X(_t),X(gD,8))},e.\u0275dir=nt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&K("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},features:[gn([hD]),Gn]});let n=e;return n})();function pi(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function $x(n){return n!=null&&typeof n.length=="number"}var Ng=new ft(""),Bg=new ft(""),fD=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ko=class{static min(e){return mD(e)}static max(e){return vD(e)}static required(e){return bD(e)}static requiredTrue(e){return xD(e)}static email(e){return _D(e)}static minLength(e){return yD(e)}static maxLength(e){return CD(e)}static pattern(e){return wD(e)}static nullValidator(e){return Xx(e)}static compose(e){return t_(e)}static composeAsync(e){return n_(e)}};function mD(n){return e=>{if(pi(e.value)||pi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function vD(n){return e=>{if(pi(e.value)||pi(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function bD(n){return pi(n.value)?{required:!0}:null}function xD(n){return n.value===!0?null:{required:!0}}function _D(n){return pi(n.value)||fD.test(n.value)?null:{email:!0}}function yD(n){return e=>pi(e.value)||!$x(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function CD(n){return e=>$x(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function wD(n){if(!n)return Xx;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(pi(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function Xx(n){return null}function Jx(n){return n!=null}function Qx(n){return ax(n)?Kb(n):n}function Yx(n){let e={};return n.forEach(t=>{e=t!=null?Ht(Ht({},e),t):e}),Object.keys(e).length===0?null:e}function Zx(n,e){return e.map(t=>t(n))}function PD(n){return!n.validate}function e_(n){return n.map(e=>PD(e)?e:t=>e.validate(t))}function t_(n){if(!n)return null;let e=n.filter(Jx);return e.length==0?null:function(t){return Yx(Zx(t,e))}}function qg(n){return n!=null?t_(e_(n)):null}function n_(n){if(!n)return null;let e=n.filter(Jx);return e.length==0?null:function(t){let r=Zx(t,e).map(Qx);return Jb(r).pipe(Xb(Yx))}}function Lg(n){return n!=null?n_(e_(n)):null}function Vx(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function r_(n){return n._rawValidators}function i_(n){return n._rawAsyncValidators}function Ig(n){return n?Array.isArray(n)?n:[n]:[]}function Jl(n,e){return Array.isArray(n)?n.includes(e):n===e}function Hx(n,e){let t=Ig(e);return Ig(n).forEach(i=>{Jl(t,i)||t.push(i)}),t}function Ux(n,e){return Ig(e).filter(t=>!Jl(n,t))}var Ql=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=qg(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Lg(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},$o=class extends Ql{get formDirective(){return null}get path(){return null}},io=class extends Ql{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Rg=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},OD={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},P$=si(Ht({},OD),{"[class.ng-submitted]":"isSubmitted"}),o_=(()=>{let e=class e extends Rg{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(X(io,2))},e.\u0275dir=nt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Re("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Gn]});let n=e;return n})();var Ds="VALID",Xl="INVALID",Wo="PENDING",Fs="DISABLED";function a_(n){return(ad(n)?n.validators:n)||null}function MD(n){return Array.isArray(n)?qg(n):n||null}function s_(n,e){return(ad(e)?e.asyncValidators:n)||null}function SD(n){return Array.isArray(n)?Lg(n):n||null}function ad(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function ED(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new zl(1e3,"");if(!r[t])throw new zl(1001,"")}function AD(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new zl(1002,"")})}var Yl=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ds}get invalid(){return this.status===Xl}get pending(){return this.status==Wo}get disabled(){return this.status===Fs}get enabled(){return this.status!==Fs}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Hx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Hx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ux(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ux(e,this._rawAsyncValidators))}hasValidator(e){return Jl(this._rawValidators,e)}hasAsyncValidator(e){return Jl(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Wo,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Fs,this.errors=null,this._forEachChild(r=>{r.disable(si(Ht({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(si(Ht({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ds,this._forEachChild(r=>{r.enable(si(Ht({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(si(Ht({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ds||this.status===Wo)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fs:Ds}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Wo,this._hasOwnPendingAsyncValidator=!0;let t=Qx(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ie,this.statusChanges=new ie}_calculateStatus(){return this._allControlsDisabled()?Fs:this.errors?Xl:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Wo)?Wo:this._anyControlsHaveStatus(Xl)?Xl:Ds}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ad(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=MD(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=SD(this._rawAsyncValidators)}},Zl=class extends Yl{constructor(e,t,r){super(a_(t),s_(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){AD(this,!0,e),Object.keys(e).forEach(r=>{ED(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var sd=new ft("CallSetDisabledState",{providedIn:"root",factory:()=>jg}),jg="always";function ed(n,e,t=jg){Vg(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),DD(n,e),TD(n,e),FD(n,e),kD(n,e)}function td(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),rd(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function nd(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function kD(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Vg(n,e){let t=r_(n);e.validator!==null?n.setValidators(Vx(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=i_(n);e.asyncValidator!==null?n.setAsyncValidators(Vx(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();nd(e._rawValidators,i),nd(e._rawAsyncValidators,i)}function rd(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=r_(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=i_(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return nd(e._rawValidators,r),nd(e._rawAsyncValidators,r),t}function DD(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&c_(n,e)})}function FD(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&c_(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function c_(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function TD(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function l_(n,e){n==null,Vg(n,e)}function zD(n,e){return rd(n,e)}function ID(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function RD(n){return Object.getPrototypeOf(n.constructor)===uD}function d_(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function ND(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===od?t=o:RD(o)?r=o:i=o}),i||r||t||null}function BD(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var qD={provide:$o,useExisting:to(()=>Hg)},Ts=Promise.resolve(),Hg=(()=>{let e=class e extends $o{constructor(r,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ie,this.form=new Zl({},qg(r),Lg(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){Ts.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),ed(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){Ts.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){Ts.then(()=>{let i=this._findContainer(r.path),o=new Zl({});l_(o,r),i.registerControl(r.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){Ts.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){Ts.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,d_(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(X(Ng,10),X(Bg,10),X(sd,8))},e.\u0275dir=nt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,o){i&1&&K("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{options:[pn.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gn([qD]),Gn]});let n=e;return n})();function Gx(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Wx(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ug=class extends Yl{constructor(e=null,t,r){super(a_(t),s_(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ad(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Wx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Gx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Gx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Wx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var LD=n=>n instanceof Ug;var u_=new ft(""),jD={provide:io,useExisting:to(()=>Gg)},Gg=(()=>{let e=class e extends io{set isDisabled(r){}constructor(r,i,o,a,s){super(),this._ngModelWarningConfig=a,this.callSetDisabledState=s,this.update=new ie,this._ngModelWarningSent=!1,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=ND(this,o)}ngOnChanges(r){if(this._isControlChanged(r)){let i=r.form.previousValue;i&&td(i,this,!1),ed(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}ID(r,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&td(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_isControlChanged(r){return r.hasOwnProperty("form")}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(X(Ng,10),X(Bg,10),X(id,10),X(u_,8),X(sd,8))},e.\u0275dir=nt({type:e,selectors:[["","formControl",""]],inputs:{form:[pn.None,"formControl","form"],isDisabled:[pn.None,"disabled","isDisabled"],model:[pn.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[gn([jD]),Gn,tr]});let n=e;return n})(),VD={provide:$o,useExisting:to(()=>Wg)},Wg=(()=>{let e=class e extends $o{constructor(r,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ie,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(rd(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return ed(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){td(r.control||null,r,!1),BD(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,d_(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,o=this.form.get(r.path);i!==o&&(td(i||null,r),LD(o)&&(ed(o,r,this.callSetDisabledState),r.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);l_(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&zD(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Vg(this.form,this),this._oldForm&&rd(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(X(Ng,10),X(Bg,10),X(sd,8))},e.\u0275dir=nt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,o){i&1&&K("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{form:[pn.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gn([VD]),Gn,tr]});let n=e;return n})();var HD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({});let n=e;return n})();var h_=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:u_,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:sd,useValue:r.callSetDisabledState??jg}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({imports:[HD]});let n=e;return n})();var UD=["hueSlider"],GD=["alphaSlider"];function WD(n,e){if(n&1){let t=yt();q(0,"div",10),K("newValue",function(i){ae(t);let o=ne();return se(o.onSliderChange("saturation-lightness",i))}),q(1,"div",11),Z(2,"div"),j()()}if(n&2){let t=ne();tn("background-color",t.hueSliderColor),ee("rgX",1)("rgY",1),H(),tn("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function KD(n,e){if(n&1&&(q(0,"div",12),Z(1,"div",13)(2,"div",14),j()),n&2){let t=ne();H(2),tn("background-color",t.selectedColor)}}function $D(n,e){if(n&1){let t=yt();q(0,"div",15,1),K("newValue",function(i){ae(t);let o=ne();return se(o.onSliderChange("hue",i))}),q(2,"div",16)(3,"div"),Z(4,"div"),j()()()}if(n&2){let t=ne();ee("rgX",1),H(2),tn("left",t.slider==null?null:t.slider.h,"px")}}function XD(n,e){if(n&1){let t=yt();q(0,"div",17,2),K("newValue",function(i){ae(t);let o=ne();return se(o.onSliderChange("alpha",i))}),Z(2,"div",18),q(3,"div",16)(4,"div"),Z(5,"div"),j()()()}if(n&2){let t=ne();ee("rgX",1),H(2),ee("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),H(),tn("left",t.slider==null?null:t.slider.a,"px")}}var JD=["dialog"],QD=n=>({background:n});function YD(n,e){n&1&&Z(0,"div",12)}function ZD(n,e){if(n&1){let t=yt();ci(0),q(1,"div",9)(2,"div",10),K("click",function(){let i=ae(t).$implicit,o=ne(2);return se(o.onColorClick(i))}),we(3,YD,1,0,"div",11),j()(),li()}if(n&2){let t=e.$implicit,r=e.index,i=ne(2);H(2),Re("colornull",!t),ee("ngStyle",i.getBackgroundColor(t)),H(),ee("ngIf",r==i.indexSeleccionado)}}function eF(n,e){if(n&1&&Z(0,"div",18),n&2){let t=ne(3);ee("ngStyle",t.getBackgroundColor(t.color))}}function tF(n,e){if(n&1){let t=yt();q(0,"div",13),K("click",function(){ae(t);let i=ne(2);return se(i.addColor())}),we(1,eF,1,1,"div",14),ce(),q(2,"svg",15),Z(3,"path",16)(4,"path",17),j()()}if(n&2){let t=ne(2);H(),ee("ngIf",t.indexSeleccionado===void 0)}}function nF(n,e){if(n&1){let t=yt();q(0,"color-picker",19),K("colorChange",function(i){ae(t);let o=ne(2);return se(o.onChangeColorPicker(i))})("onAlphaChange",function(i){ae(t);let o=ne(2);return se(o.onAlphaChange(i))}),j()}if(n&2){let t=ne(2);ee("controls",t.colorPickerControls)("color",t.hsva)}}function rF(n,e){if(n&1&&(ci(0),q(1,"div",5),we(2,ZD,4,4,"ng-container",6)(3,tF,5,1,"div",7)(4,nF,1,2,"color-picker",8),j(),li()),n&2){let t=ne();H(),ee("@colorsAnimation",t.colorsAnimationEffect),H(),ee("ngForOf",t.palette),H(),ee("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),H(),ee("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function iF(n,e){n&1&&Z(0,"div",12)}function oF(n,e){if(n&1){let t=yt();ci(0),q(1,"div",9)(2,"div",25),K("click",function(){let i=ae(t).$implicit,o=ne(2);return se(o.changeColor(i))}),we(3,iF,1,0,"div",11),j()(),li()}if(n&2){let t=e.$implicit,r=ne(2);H(2),Re("colornull",!t),ee("ngStyle",Nl(4,QD,t)),H(),ee("ngIf",r.isSelected(t))}}function aF(n,e){if(n&1){let t=yt();ci(0),q(1,"div",5)(2,"div",20)(3,"div",21),K("click",function(){ae(t);let i=ne();return se(i.onClickBack())}),ce(),q(4,"svg",22),Z(5,"path",23)(6,"path",24),j()()(),we(7,oF,4,6,"ng-container",6),j(),li()}if(n&2){let t=ne();H(),ee("@colorsAnimation",t.colorsAnimationEffect),H(6),ee("ngForOf",t.variants)}}function sF(n,e){if(n&1){let t=yt();ci(0),q(1,"div",26)(2,"div",27),K("click",function(){ae(t);let i=ne();return se(i.onClickBack())}),ce(),q(3,"svg",22),Z(4,"path",23)(5,"path",24),j()(),nr(),q(6,"button",28),K("click",function(){ae(t);let i=ne();return se(i.emitClose("cancel"))}),it(7),j(),q(8,"button",28),K("click",function(){ae(t);let i=ne();return se(i.emitClose("accept"))}),it(9),j()(),q(10,"div",29)(11,"color-picker",30),K("sliderChange",function(i){ae(t);let o=ne();return se(o.onChangeColorPicker(i))}),j()(),li()}if(n&2){let t=ne();H(7),no(" ",t.cancelLabel," "),H(2),no(" ",t.acceptLabel," "),H(2),ee("controls",t.colorPickerControls)("color",t.hsva)}}function cF(n,e){if(n&1){let t=yt();q(0,"div",31)(1,"p",32),K("click",function(){ae(t);let i=ne();return se(i.nextFormat())}),it(2),j(),q(3,"div",33)(4,"input",34,1),K("keyup",function(){ae(t);let i=_r(5),o=ne();return se(o.changeColorManual(i.value))})("keydown.enter",function(){ae(t);let i=ne();return se(i.emitClose("accept"))}),j()()()}if(n&2){let t=ne();H(2),Rl(t.colorFormats[t.format]),H(2),tn("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),ee("placeholder",t.placeholder)("value",t.color)}}var zs=["hex","rgba","hsla"],Lr=function(n){return n[n.HEX=0]="HEX",n[n.RGBA=1]="RGBA",n[n.HSLA=2]="HSLA",n[n.CMYK=3]="CMYK",n}(Lr||{}),g_=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],Cr=class{constructor(e,t,r,i){this.r=e,this.g=t,this.b=r,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},ar=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i,this.onChange=new ie(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},oo=class{constructor(e,t,r,i){this.h=e,this.s=t,this.l=r,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Xo=class{constructor(e,t,r,i,o=1){this.c=e,this.m=t,this.y=r,this.k=i,this.a=o}},Kg=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},ld=(()=>{class n{constructor(){}toFormat(t,r){var i="";if(t)switch(r){case Lr.HEX:var a=this.hsvaToRgba(t);a.denormalize();var i=this.rgbaToHex(a,!0);break;case Lr.HSLA:var o=this.hsva2hsla(t);o.denormalize();var i=o.toString();break;case Lr.RGBA:var a=this.hsvaToRgba(t),i=a.toString();break;case Lr.CMYK:var a=this.hsvaToRgba(t),s=this.rgbaToCmyk(a);break}return i}stringToFormat(t,r){var i=this.stringToHsva(t,!0);return this.toFormat(i,r)}hsva2hsla(t){let r=t.h,i=t.s,o=t.v,a=t.a;if(o===0)return new oo(r,0,0,a);if(i===0&&o===1)return new oo(r,1,1,a);{let s=o*(2-i)/2;return new oo(r,o*i/(1-Math.abs(2*s-1)),s,a)}}hsla2hsva(t){let r=Math.min(t.h,1),i=Math.min(t.s,1),o=Math.min(t.l,1),a=Math.min(t.a,1);if(o===0)return new ar(r,0,0,a);{let s=o+i*(1-Math.abs(2*o-1))/2;return new ar(r,2*(s-o)/s,s,a)}}hsvaToRgba(t){let r,i,o,a=t.h,s=t.s,c=t.v,l=t.a,h=Math.floor(a*6),u=a*6-h,d=c*(1-s),p=c*(1-u*s),m=c*(1-(1-u)*s);switch(h%6){case 0:r=c,i=m,o=d;break;case 1:r=p,i=c,o=d;break;case 2:r=d,i=c,o=m;break;case 3:r=d,i=p,o=c;break;case 4:r=m,i=d,o=c;break;case 5:r=c,i=d,o=p;break;default:r=0,i=0,o=0}return new Cr(r,i,o,l)}cmykToRgb(t){let r=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),o=(1-t.y)*(1-t.k);return new Cr(r,i,o,t.a)}rgbaToCmyk(t){let r=1-Math.max(t.r,t.g,t.b);if(r===1)return new Xo(0,0,0,1,t.a);{let i=(1-t.r-r)/(1-r),o=(1-t.g-r)/(1-r),a=(1-t.b-r)/(1-r);return new Xo(i,o,a,r,t.a)}}rgbaToHsva(t){let r,i,o=Math.min(t.r,1),a=Math.min(t.g,1),s=Math.min(t.b,1),c=Math.min(t.a,1),l=Math.max(o,a,s),h=Math.min(o,a,s),u=l,d=l-h;if(i=l===0?0:d/l,l===h)r=0;else{switch(l){case o:r=(a-s)/d+(a<s?6:0);break;case a:r=(s-o)/d+2;break;case s:r=(o-a)/d+4;break;default:r=0}r/=6}return new ar(r,i,u,c)}rgbaToHex(t,r){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new Xo(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new Xo(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new Cr(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",r=!0){let i=null;t=(t||"").toLowerCase();let o=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new Cr(parseInt(a[2],10)/255,parseInt(a[3],10)/255,parseInt(a[4],10)/255,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new oo(parseInt(a[2],10)/360,parseInt(a[3],10)/100,parseInt(a[4],10)/100,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}}];r?o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(a){return new Cr(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,parseInt(a[4]||"FF",16)/255)}}):o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(a){return new Cr(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,1)}}),o.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(a){return new Cr(parseInt(a[1]+a[1],16)/255,parseInt(a[2]+a[2],16)/255,parseInt(a[3]+a[3],16)/255,1)}});for(let a in o)if(o.hasOwnProperty(a)){let s=o[a],c=s.re.exec(t),l=c&&s.parse(c);if(l)return l instanceof Cr?i=this.rgbaToHsva(l):l instanceof oo&&(i=this.hsla2hsva(l)),i}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let r=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,o=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/;if(r.test(t))return"hex";if(i.test(t))return"rgba";if(o.test(t))return"hsla"}return"hex"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Et({token:n,factory:n.\u0275fac}),n})(),cd=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i}},$g=class{constructor(e,t,r,i){this.h=e,this.s=t,this.v=r,this.a=i}},lF=(()=>{class n{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new ie,this.dragStart=new ie,this.newValue=new ie,this.listenerMove=r=>this.move(r),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let r=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-r.left-window.pageXOffset}getY(t){let r=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-r.top-window.pageYOffset}setCursor(t){let r=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,o=Math.max(0,Math.min(this.getX(t),r)),a=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:o/r,v:1-a/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:a/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:o/r,rgX:this.rgX})}}return n.\u0275fac=function(t){return new(t||n)(X(_t))},n.\u0275dir=nt({type:n,selectors:[["","slider",""]],hostBindings:function(t,r){t&1&&K("mousedown",function(o){return r.mouseDown(o)})("touchstart",function(o){return r.touchStart(o)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"}}),n})(),dF=(()=>{class n{constructor(t,r){this.service=t,this.cdr=r,this.color=new ar(0,1,1,1),this.controls="default",this.sliderChange=new ie(!1),this.onAlphaChange=new ie(!1),this.hsva=new ar(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new ar(0,1,1,1)),this.slider=new cd(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,r=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new $g(t,220,130,r),this.update()}onSliderChange(t,r){switch(t){case"saturation-lightness":this.hsva.onColorChange(r);break;case"hue":this.hsva.onHueChange(r);break;case"alpha":this.hsva.onAlphaChange(r),this.onAlphaChange.emit(r);break;case"value":this.hsva.onValueChange(r);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),r=this.service.hsvaToRgba(new ar(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+r.r+","+r.g+","+r.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new cd(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return n.\u0275fac=function(t){return new(t||n)(X(ld),X(yr))},n.\u0275cmp=fe({type:n,selectors:[["color-picker"]],viewQuery:function(t,r){if(t&1&&(Ct(UD,5),Ct(GD,5)),t&2){let i;Xe(i=Je())&&(r.hueSlider=i.first),Xe(i=Je())&&(r.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},features:[tr],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,r){if(t&1){let i=yt();q(0,"div",3,0),K("click",function(a){return ae(i),se(a.stopPropagation())}),we(2,WD,3,8,"div",4),q(3,"div",5),we(4,KD,3,2,"div",6),q(5,"div",7),we(6,$D,5,3,"div",8)(7,XD,6,4,"div",9),j()()()}t&2&&(H(2),ee("ngIf",r.controls!="only-alpha"),H(2),ee("ngIf",r.controls!="only-alpha"),H(2),ee("ngIf",r.controls!="only-alpha"),H(),ee("ngIf",r.controls!="no-alpha"))},dependencies:[ro,vg,lF],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),n})(),uF=(()=>{class n{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,r){this.service=t,this.cdr=r,this.color="#000000",this.previewColor="#000000",this.hsva=new ar(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=g_,this.variants=[],this.colorFormats=zs,this.format=Lr.HEX,this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let r;if(this.color)for(let i=0;i<t.length;i++){let o=t[i];typeof o=="string"?this.service.stringToFormat(this.color,Lr.HEX)==this.service.stringToFormat(o,Lr.HEX)&&(r=i):o===void 0?this.color=void 0:this.findIndexSelectedColor(o.variants)!=null&&(r=i)}return r}iniciate(t,r,i,o,a,s,c,l,h,u,d,p){if(this.colorPickerControls=d,this.triggerInstance=t,this.TriggerBBox=r,this.color=i,this.hideColorPicker=l,this.hideTextInput=c,this.acceptLabel=h,this.cancelLabel=u,s?zs.includes(s)?(this.format=zs.indexOf(s.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=s.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=Lr.HEX):this.format=zs.indexOf(this.service.getFormatByString(this.color)),this.previewColor=this.color,this.palette=o??g_,this.colorsAnimationEffect=a,p=="top"){let m=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+m.height+"px ))"}}setPosition(){if(this.TriggerBBox){let r=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=r.top+r.height,r.left+250>window.innerWidth?this.left=r.right<250?window.innerWidth/2-250/2:r.right-250:this.left=r.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),r=this.panelRef.nativeElement.getBoundingClientRect(),i=r.height;t.bottom+i>window.innerHeight?this.positionString=t.top<r.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(r=>r.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,r){var i=[];for(let o=0;o<r.length;o++){let a=r[o];if(typeof a=="string"){let s=this.service.stringToHsva(a);s.onAlphaChange(t),i.push(this.service.toFormat(s,this.format))}else{let s=new Kg,c=this.service.stringToHsva(a.preview);c.onAlphaChange(t),s.preview=this.service.toFormat(c,this.format),s.variants=this.ChangeAlphaOnPalette(t,a.variants),i.push(s)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color)}setColor(t){this.hsva=t,this.color=this.service.toFormat(t,this.format),this.setPreviewColor(t),this.triggerInstance.setColor(this.color)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){this.canChangeFormat&&(this.format=(this.format+1)%this.colorFormats.length,this.setColor(this.hsva),this.placeholder=this.service.toFormat(new ar(0,0,1,1),this.format))}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return n.\u0275fac=function(t){return new(t||n)(X(ld),X(yr))},n.\u0275cmp=fe({type:n,selectors:[["ngx-colors-panel"]],viewQuery:function(t,r){if(t&1&&Ct(JD,5),t&2){let i;Xe(i=Je())&&(r.panelRef=i.first)}},hostVars:4,hostBindings:function(t,r){t&1&&K("mousedown",function(o){return r.click(o)},!1,xs)("scroll",function(){return r.onScroll()},!1,xs)("resize",function(){return r.onResize()},!1,Zb),t&2&&tn("top",r.top,"px")("left",r.left,"px")},decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,r){t&1&&(q(0,"div",2,0),we(2,rF,5,4,"ng-container",3)(3,aF,8,2,"ng-container",3)(4,sF,12,4,"ng-container",3)(5,cF,6,7,"div",4),j()),t&2&&(nx(r.positionString),H(2),ee("ngIf",r.menu==1),H(),ee("ngIf",r.menu==2),H(),ee("ngIf",r.menu==3),H(),ee("ngIf",!r.hideTextInput))},dependencies:[Lo,ro,vg,dF],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[Bl("colorsAnimation",[ys("void => slide-in",[Cs(":enter",Kn({opacity:0}),{optional:!0}),Cs(":enter",xg("10ms",[_s(".3s ease-in",bg([Kn({opacity:0,transform:"translatex(-50%)",offset:0}),Kn({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),Kn({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),ys("void => popup",[Cs(":enter",Kn({opacity:0,transform:"scale(0)"}),{optional:!0}),Cs(":enter",xg("10ms",[_s("500ms ease-out",bg([Kn({opacity:.5,transform:"scale(.5)",offset:.3}),Kn({opacity:1,transform:"scale(1.1)",offset:.8}),Kn({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),n})(),f_={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},m_=(()=>{class n{constructor(t,r,i){this.resolver=t,this.applicationRef=r,this.injector=i}createPanel(t,r){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(uF);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let o=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(r),Object.keys(f_).forEach(a=>{this.overlay.style[a]=f_[a]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(o),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return n.\u0275fac=function(t){return new(t||n)(ht(tx),ht(sx),ht(xr))},n.\u0275prov=Et({token:n,factory:n.\u0275fac}),n})(),v_=(()=>{class n{onClick(){this.openPanel()}constructor(t,r,i){this.triggerRef=t,this.panelFactory=r,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new ie,this.input=new ie,this.slider=new ie,this.close=new ie,this.open=new ie,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t){this.writeValue(t),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t){if(t!==this.color){if(this.format){let r=zs.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,r)}this.color=t,this.change.emit(t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return n.\u0275fac=function(t){return new(t||n)(X(_t),X(m_),X(ld))},n.\u0275dir=nt({type:n,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,r){t&1&&K("click",function(){return r.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},features:[gn([{provide:id,useExisting:to(()=>n),multi:!0}])]}),n})();var dd=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gt({type:n}),n.\u0275inj=Ut({providers:[ld,m_],imports:[Wn]}),n})();var Is={strokeColor:"#ff0",strokeWidth:5,fill:"#000",backgroundColor:"#fff",canvasHeight:800,canvasWidth:800,dasharray:""},b_=800,x_=800,Xg=1,__=50,y_=50,C_=[6,12,16,25,50,75,100,150,200,300,400,600,800,1600];var pF=(n,e,t)=>{let r=`
    <svg width="60px" height="60px" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M24.5 25.98C29.4725 25.98 33.5 21.9227 33.5 16.9133C33.5 11.904 29.4725 7.84668 24.5 7.84668C19.5275 7.84668 15.5 11.904 15.5 16.9133C15.5 21.9227 19.5275 25.98 24.5 25.98Z" fill="${t}"/>
      <path d="M17.3786 29.2021C17.8814 29.0785 18.3971 29.3313 18.6254 29.7991L22.6893 32.7994C24.5 32.799 24.5 32.7995 26.3105 32.7991L30.3746 29.7991C30.6029 29.3313 31.1186 29.0785 31.6214 29.2021C37.0255 30.5301 42.5 33.238 42.5 37.3116V41.845H6.5V37.3116C6.5 33.238 11.9745 30.5301 17.3786 29.2021Z" fill="${t}"/>
      <text x="50%" y="35" fill="${t}">${e}</text>
    </svg>
  `,i=`
    <svg fill="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60" width="60px" height="60px">
      <path d="M 9 3 A 1 1 0 0 0 8 4 L 8 21 A 1 1 0 0 0 9 22 A 1 1 0 0 0 9.796875 21.601562 L 12.919922 18.119141 L 16.382812 26.117188 C 16.701812 26.855187 17.566828 27.188469 18.298828 26.855469 C 19.020828 26.527469 19.340672 25.678078 19.013672 24.955078 L 15.439453 17.039062 L 21 17 A 1 1 0 0 0 22 16 A 1 1 0 0 0 21.628906 15.222656 L 9.7832031 3.3789062 A 1 1 0 0 0 9 3 z"/>
      <text x="0" y="40" fill="${t}">${e}!</text>
    </svg>
  `;return n==="person"?r:i};function w_(n,e,t){let r=()=>{if(t){let i=t.userName;e.innerHTML="",n.getMousePresences().forEach((o,a)=>{if(a.userName!==i){let s=document.createElement("div");s.innerHTML=pF("person",a.userName,a.additionalDetails.color),s.style.position="absolute",s.style.left=`${o.x}px`,s.style.top=`${o.y}px`,e.appendChild(s)}})}};r(),n.on("mousePositionChanged",r)}function mF(n,e){}var ao=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}};var Yg=(()=>{let e=class e extends Sx{constructor(r,i,o,a,s,c,l,h){super(),this._elementRef=r,this._focusTrapFactory=i,this._config=a,this._interactivityChecker=s,this._ngZone=c,this._overlayRef=l,this._focusMonitor=h,this._platform=Nn(ui),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=Nn(yr),this.attachDomPortal=u=>{this._portalOutlet.hasAttached();let d=this._portalOutlet.attachDomPortal(u);return this._contentAttached(),d},this._document=o,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(r){this._ariaLabelledByQueue.push(r),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(r){let i=this._ariaLabelledByQueue.indexOf(r);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(r){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachComponentPortal(r);return this._contentAttached(),i}attachTemplatePortal(r){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachTemplatePortal(r);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(r,i){this._interactivityChecker.isFocusable(r)||(r.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{r.removeEventListener("blur",o),r.removeEventListener("mousedown",o),r.removeAttribute("tabindex")};r.addEventListener("blur",o),r.addEventListener("mousedown",o)})),r.focus(i)}_focusByCssSelector(r,i){let o=this._elementRef.nativeElement.querySelector(r);o&&this._forceFocus(o,i)}_trapFocus(){let r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus);break}}_restoreFocus(){let r=this._config.restoreFocus,i=null;if(typeof r=="string"?i=this._document.querySelector(r):typeof r=="boolean"?i=r?this._elementFocusedBeforeDialogWasOpened:null:r&&(i=r),this._config.restoreFocus&&i&&typeof i.focus=="function"){let o=ql(),a=this._elementRef.nativeElement;(!o||o===this._document.body||o===a||a.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){let r=this._elementRef.nativeElement,i=ql();return r===i||r.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=ql()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(Hl),X(qo,8),X(ao),X(Vl),X(en),X(Vo),X(Ul))},e.\u0275cmp=fe({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(i,o){if(i&1&&Ct(Ps,7),i&2){let a;Xe(a=Je())&&(o._portalOutlet=a.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,o){i&2&&me("id",o._config.id||null)("role",o._config.role)("aria-modal",o._config.ariaModal)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null)},standalone:!0,features:[Gn,xe],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,o){i&1&&we(0,mF,0,0,"ng-template",0)},dependencies:[Ps],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2});let n=e;return n})(),Rs=class{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new tt,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(r=>{r.keyCode===27&&!this.disableClose&&!Ll(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{t.closeOnOverlayDetachments!==!1&&this.close()})}close(e,t){if(this.containerInstance){let r=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(e),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}},vF=new ft("DialogScrollStrategy",{providedIn:"root",factory:()=>{let n=Nn(hi);return()=>n.scrollStrategies.block()}}),bF=new ft("DialogData"),xF=new ft("DefaultDialogConfig");var _F=0,Zg=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(r,i,o,a,s,c){this._overlay=r,this._injector=i,this._defaultOptions=o,this._parentDialog=a,this._overlayContainer=s,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new tt,this._afterOpenedAtThisLevel=new tt,this._ariaHiddenElements=new Map,this.afterAllClosed=kl(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Tl(void 0))),this._scrollStrategy=c}open(r,i){let o=this._defaultOptions||new ao;i=Ht(Ht({},o),i),i.id=i.id||`cdk-dialog-${_F++}`,i.id&&this.getDialogById(i.id);let a=this._getOverlayConfig(i),s=this._overlay.create(a),c=new Rs(s,i),l=this._attachContainer(s,c,i);return c.containerInstance=l,this._attachDialogContent(r,c,l,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){Jg(this.openDialogs,r=>r.close())}getDialogById(r){return this.openDialogs.find(i=>i.id===r)}ngOnDestroy(){Jg(this._openDialogsAtThisLevel,r=>{r.config.closeOnDestroy===!1&&this._removeOpenDialog(r,!1)}),Jg(this._openDialogsAtThisLevel,r=>r.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(r){let i=new Ex({positionStrategy:r.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:r.scrollStrategy||this._scrollStrategy(),panelClass:r.panelClass,hasBackdrop:r.hasBackdrop,direction:r.direction,minWidth:r.minWidth,minHeight:r.minHeight,maxWidth:r.maxWidth,maxHeight:r.maxHeight,width:r.width,height:r.height,disposeOnNavigation:r.closeOnNavigation});return r.backdropClass&&(i.backdropClass=r.backdropClass),i}_attachContainer(r,i,o){let a=o.injector||o.viewContainerRef?.injector,s=[{provide:ao,useValue:o},{provide:Rs,useValue:i},{provide:Vo,useValue:r}],c;o.container?typeof o.container=="function"?c=o.container:(c=o.container.type,s.push(...o.container.providers(o))):c=Yg;let l=new Pg(c,o.viewContainerRef,xr.create({parent:a||this._injector,providers:s}),o.componentFactoryResolver);return r.attach(l).instance}_attachDialogContent(r,i,o,a){if(r instanceof ex){let s=this._createInjector(a,i,o,void 0),c={$implicit:a.data,dialogRef:i};a.templateContext&&(c=Ht(Ht({},c),typeof a.templateContext=="function"?a.templateContext():a.templateContext)),o.attachTemplatePortal(new Mx(r,null,c,s))}else{let s=this._createInjector(a,i,o,this._injector),c=o.attachComponentPortal(new Pg(r,a.viewContainerRef,s,a.componentFactoryResolver));i.componentRef=c,i.componentInstance=c.instance}}_createInjector(r,i,o,a){let s=r.injector||r.viewContainerRef?.injector,c=[{provide:bF,useValue:r.data},{provide:Rs,useValue:i}];return r.providers&&(typeof r.providers=="function"?c.push(...r.providers(i,r,o)):c.push(...r.providers)),r.direction&&(!s||!s.get(ws,null,{optional:!0}))&&c.push({provide:ws,useValue:{value:r.direction,change:$b()}}),xr.create({parent:s||a,providers:c})}_removeOpenDialog(r,i){let o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((a,s)=>{a?s.setAttribute("aria-hidden",a):s.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let r=this._overlayContainer.getContainerElement();if(r.parentElement){let i=r.parentElement.children;for(let o=i.length-1;o>-1;o--){let a=i[o];a!==r&&a.nodeName!=="SCRIPT"&&a.nodeName!=="STYLE"&&!a.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(a,a.getAttribute("aria-hidden")),a.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}};e.\u0275fac=function(i){return new(i||e)(ht(hi),ht(xr),ht(xF,8),ht(e,12),ht(Gl),ht(vF))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Jg(n,e){let t=n.length;for(;t--;)e(n[t])}var P_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({providers:[Zg],imports:[Wl,Os,wx,Os]});let n=e;return n})();function yF(n,e){}var Ns=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}},ef="mdc-dialog--open",O_="mdc-dialog--opening",M_="mdc-dialog--closing",CF=150,wF=75,PF=(()=>{let e=class e extends Yg{constructor(r,i,o,a,s,c,l,h,u){super(r,i,o,a,s,c,l,u),this._animationMode=h,this._animationStateChanged=new ie,this._animationsEnabled=this._animationMode!=="NoopAnimations",this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?E_(this._config.enterAnimationDuration)??CF:0,this._exitAnimationDuration=this._animationsEnabled?E_(this._config.exitAnimationDuration)??wF:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(S_,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(O_,ef)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(ef),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(ef),this._animationsEnabled?(this._hostElement.style.setProperty(S_,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(M_)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(r){this._actionSectionCount+=r,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(O_,M_)}_waitForAnimationToComplete(r,i){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,r)}_requestAnimationFrame(r){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(r):r()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(r){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:r})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(r){let i=super.attachComponentPortal(r);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(Hl),X(qo,8),X(Ns),X(Vl),X(en),X(Vo),X(bs,8),X(Ul))},e.\u0275cmp=fe({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,o){i&2&&(Bo("id",o._config.id),me("aria-modal",o._config.ariaModal)("role",o._config.role)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null),Re("_mat-animation-noopable",!o._animationsEnabled)("mat-mdc-dialog-container-with-actions",o._actionSectionCount>0))},standalone:!0,features:[Gn,xe],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),we(2,yF,0,0,"ng-template",2),j()())},dependencies:[Ps],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0;transform:scale(0.8)}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--closing .mdc-dialog__surface{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{opacity:1}.mdc-dialog--open .mdc-dialog__surface{transform:none}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{width:100%;height:100%}.mat-mdc-dialog-component-host{display:contents}.mat-mdc-dialog-container{--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition:opacity linear var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container .mdc-dialog__surface{transition:transform var(--mat-dialog-transition-duration, 0ms) 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container,.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__surface{transition:none}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-title{padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2});let n=e;return n})(),S_="--mat-dialog-transition-duration";function E_(n){return n==null?null:typeof n=="number"?n:n.endsWith("ms")?jl(n.substring(0,n.length-2)):n.endsWith("s")?jl(n.substring(0,n.length-1))*1e3:n==="0"?0:null}var ud=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(ud||{}),Bs=class{constructor(e,t,r){this._ref=e,this._containerInstance=r,this._afterOpened=new tt,this._beforeClosed=new tt,this._state=ud.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(eo(i=>i.state==="opened"),Fl(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(eo(i=>i.state==="closed"),Fl(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Dl(this.backdropClick(),this.keydownEvents().pipe(eo(i=>i.keyCode===27&&!this.disableClose&&!Ll(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),A_(this,i.type==="keydown"?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(eo(t=>t.state==="closing"),Fl(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=ud.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=ud.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function A_(n,e,t){return n._closeInteractionType=e,n.close(t)}var OF=new ft("MatMdcDialogData"),MF=new ft("mat-mdc-dialog-default-options"),SF=new ft("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let n=Nn(hi);return()=>n.scrollStrategies.block()}});var EF=0,qs=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let r=this._parentDialog;return r?r._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(r,i,o,a,s,c,l,h){this._overlay=r,this._defaultOptions=a,this._scrollStrategy=s,this._parentDialog=c,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new tt,this._afterOpenedAtThisLevel=new tt,this.dialogConfigClass=Ns,this.afterAllClosed=kl(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Tl(void 0))),this._dialog=i.get(Zg),this._dialogRefConstructor=Bs,this._dialogContainerType=PF,this._dialogDataToken=OF}open(r,i){let o;i=Ht(Ht({},this._defaultOptions||new Ns),i),i.id=i.id||`mat-mdc-dialog-${EF++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();let a=this._dialog.open(r,si(Ht({},i),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:ao,useValue:i}]},templateContext:()=>({dialogRef:o}),providers:(s,c,l)=>(o=new this._dialogRefConstructor(s,i,l),o.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:l},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:o}])}));return o.componentRef=a.componentRef,o.componentInstance=a.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{let s=this.openDialogs.indexOf(o);s>-1&&(this.openDialogs.splice(s,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(r){return this.openDialogs.find(i=>i.id===r)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(r){let i=r.length;for(;i--;)r[i].close()}};e.\u0275fac=function(i){return new(i||e)(ht(hi),ht(xr),ht(cx,8),ht(MF,8),ht(SF),ht(e,12),ht(Gl),ht(bs,8))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var k_=(()=>{let e=class e{constructor(r,i,o){this.dialogRef=r,this._elementRef=i,this._dialog=o,this.type="button"}ngOnInit(){this.dialogRef||(this.dialogRef=T_(this._elementRef,this._dialog.openDialogs))}ngOnChanges(r){let i=r._matDialogClose||r._matDialogCloseResult;i&&(this.dialogResult=i.currentValue)}_onButtonClick(r){A_(this.dialogRef,r.screenX===0&&r.screenY===0?"keyboard":"mouse",this.dialogResult)}};e.\u0275fac=function(i){return new(i||e)(X(Bs,8),X(_t),X(qs))},e.\u0275dir=nt({type:e,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(i,o){i&1&&K("click",function(s){return o._onButtonClick(s)}),i&2&&me("aria-label",o.ariaLabel||null)("type",o.type)},inputs:{ariaLabel:[pn.None,"aria-label","ariaLabel"],type:"type",dialogResult:[pn.None,"mat-dialog-close","dialogResult"],_matDialogClose:[pn.None,"matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],standalone:!0,features:[tr]});let n=e;return n})(),AF=(()=>{let e=class e{constructor(r,i,o){this._dialogRef=r,this._elementRef=i,this._dialog=o}ngOnInit(){this._dialogRef||(this._dialogRef=T_(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}};e.\u0275fac=function(i){return new(i||e)(X(Bs,8),X(_t),X(qs))},e.\u0275dir=nt({type:e,standalone:!0});let n=e;return n})();var D_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=nt({type:e,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0});let n=e;return n})(),F_=(()=>{let e=class e extends AF{_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Il(e)))(o||e)}})(),e.\u0275dir=nt({type:e,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(i,o){i&2&&Re("mat-mdc-dialog-actions-align-start",o.align==="start")("mat-mdc-dialog-actions-align-center",o.align==="center")("mat-mdc-dialog-actions-align-end",o.align==="end")},inputs:{align:"align"},standalone:!0,features:[Gn]});let n=e;return n})();function T_(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(r=>r.id===t.id):null}var z_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({providers:[qs],imports:[P_,Wl,Os,Br,Br]});let n=e;return n})();var tf=class{constructor(e){this._box=e,this._destroyed=new tt,this._resizeSubject=new tt,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new Gb(t=>{let r=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),r.unsubscribe(),this._elementObservables.delete(e)}}).pipe(eo(t=>t.some(r=>r.target===e)),Qb({bufferSize:1,refCount:!0}),No(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},I_=(()=>{let e=class e{constructor(){this._observers=new Map,this._ngZone=Nn(en),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,r]of this._observers)r.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(r,i){let o=i?.box||"content-box";return this._observers.has(o)||this._observers.set(o,new tf(o)),this._observers.get(o).observe(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var DF=["notch"],FF=["matFormFieldNotchedOutline",""],TF=["*"],zF=["textField"],IF=["iconPrefixContainer"],RF=["textPrefixContainer"],NF=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],BF=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function qF(n,e){n&1&&Z(0,"span",17)}function LF(n,e){if(n&1&&(q(0,"label",16),rr(1,1),we(2,qF,1,0,"span",17),j()),n&2){let t=ne(2);ee("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),me("for",t._control.disableAutomaticLabeling?null:t._control.id),H(2),nn(2,!t.hideRequiredMarker&&t._control.required?2:-1)}}function jF(n,e){if(n&1&&we(0,LF,3,5,"label",16),n&2){let t=ne();nn(0,t._hasFloatingLabel()?0:-1)}}function VF(n,e){n&1&&Z(0,"div",5)}function HF(n,e){}function UF(n,e){if(n&1&&we(0,HF,0,0,"ng-template",11),n&2){ne(2);let t=_r(1);ee("ngTemplateOutlet",t)}}function GF(n,e){if(n&1&&(q(0,"div",7),we(1,UF,1,1,null,11),j()),n&2){let t=ne();ee("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),H(),nn(1,t._forceDisplayInfixLabel()?-1:1)}}function WF(n,e){n&1&&(q(0,"div",8,2),rr(2,2),j())}function KF(n,e){n&1&&(q(0,"div",9,3),rr(2,3),j())}function $F(n,e){}function XF(n,e){if(n&1&&we(0,$F,0,0,"ng-template",11),n&2){ne();let t=_r(1);ee("ngTemplateOutlet",t)}}function JF(n,e){n&1&&(q(0,"div",12),rr(1,4),j())}function QF(n,e){n&1&&(q(0,"div",13),rr(1,5),j())}function YF(n,e){n&1&&Z(0,"div",14)}function ZF(n,e){if(n&1&&(q(0,"div",18),rr(1,6),j()),n&2){let t=ne();ee("@transitionMessages",t._subscriptAnimationState)}}function eT(n,e){if(n&1&&(q(0,"mat-hint",20),it(1),j()),n&2){let t=ne(2);ee("id",t._hintLabelId),H(),Rl(t.hintLabel)}}function tT(n,e){if(n&1&&(q(0,"div",19),we(1,eT,2,2,"mat-hint",20),rr(2,7),Z(3,"div",21),rr(4,8),j()),n&2){let t=ne();ee("@transitionMessages",t._subscriptAnimationState),H(),nn(1,t.hintLabel?1:-1)}}var pd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=nt({type:e,selectors:[["mat-label"]],standalone:!0});let n=e;return n})();var nT=new ft("MatError");var rT=0,gd=(()=>{let e=class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${rT++}`}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=nt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,o){i&2&&(Bo("id",o.id),me("align",null),Re("mat-mdc-form-field-hint-end",o.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let n=e;return n})(),iT=new ft("MatPrefix");var oT=new ft("MatSuffix");var U_=new ft("FloatingLabelParent"),R_=(()=>{let e=class e{get floating(){return this._floating}set floating(r){this._floating=r,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(r){this._monitorResize=r,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(r){this._elementRef=r,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Nn(I_),this._ngZone=Nn(en),this._parent=Nn(U_),this._resizeSubscription=new Ub}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return aT(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};e.\u0275fac=function(i){return new(i||e)(X(_t))},e.\u0275dir=nt({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,o){i&2&&Re("mdc-floating-label--float-above",o.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let n=e;return n})();function aT(n){let e=n;if(e.offsetParent!==null)return e.scrollWidth;let t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);let r=t.scrollWidth;return t.remove(),r}var N_="mdc-line-ripple--active",hd="mdc-line-ripple--deactivating",B_=(()=>{let e=class e{constructor(r,i){this._elementRef=r,this._handleTransitionEnd=o=>{let a=this._elementRef.nativeElement.classList,s=a.contains(hd);o.propertyName==="opacity"&&s&&a.remove(N_,hd)},i.runOutsideAngular(()=>{r.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let r=this._elementRef.nativeElement.classList;r.remove(hd),r.add(N_)}deactivate(){this._elementRef.nativeElement.classList.add(hd)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(en))},e.\u0275dir=nt({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let n=e;return n})(),q_=(()=>{let e=class e{constructor(r,i){this._elementRef=r,this._ngZone=i,this.open=!1}ngAfterViewInit(){let r=this._elementRef.nativeElement.querySelector(".mdc-floating-label");r?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(r.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>r.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(r){!this.open||!r?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${r}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(en))},e.\u0275cmp=fe({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,o){if(i&1&&Ct(DF,5),i&2){let a;Xe(a=Je())&&(o._notch=a.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,o){i&2&&Re("mdc-notched-outline--notched",o.open)},inputs:{open:[pn.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[xe],attrs:FF,ngContentSelectors:TF,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(i,o){i&1&&(fg(),Z(0,"div",1),q(1,"div",2,0),rr(3),j(),Z(4,"div",3))},encapsulation:2,changeDetection:0});let n=e;return n})(),sT={transitionMessages:Bl("transitionMessages",[mx("enter",Kn({opacity:1,transform:"translateY(0%)"})),ys("void => enter",[Kn({opacity:0,transform:"translateY(-5px)"}),_s("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},nf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=nt({type:e});let n=e;return n})();var rf=new ft("MatFormField"),cT=new ft("MAT_FORM_FIELD_DEFAULT_OPTIONS"),L_=0,j_="fill",lT="auto",V_="fixed",dT="translateY(-50%)",G_=(()=>{let e=class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(r){this._hideRequiredMarker=jo(r)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||lT}set floatLabel(r){r!==this._floatLabel&&(this._floatLabel=r,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(r){let i=this._appearance,o=r||this._defaults?.appearance||j_;this._appearance=o,this._appearance==="outline"&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||V_}set subscriptSizing(r){this._subscriptSizing=r||this._defaults?.subscriptSizing||V_}get hintLabel(){return this._hintLabel}set hintLabel(r){this._hintLabel=r,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(r){this._explicitFormFieldControl=r}constructor(r,i,o,a,s,c,l,h){this._elementRef=r,this._changeDetectorRef=i,this._ngZone=o,this._dir=a,this._platform=s,this._defaults=c,this._animationMode=l,this._hideRequiredMarker=!1,this.color="primary",this._appearance=j_,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${L_++}`,this._hintLabelId=`mat-mdc-hint-${L_++}`,this._subscriptAnimationState="",this._destroyed=new tt,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,c&&(c.appearance&&(this.appearance=c.appearance),this._hideRequiredMarker=!!c?.hideRequiredMarker,c.color&&(this.color=c.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let r=this._control;r.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${r.controlType}`),r.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),r.ngControl&&r.ngControl.valueChanges&&r.ngControl.valueChanges.pipe(No(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(r=>!r._isText),this._hasTextPrefix=!!this._prefixChildren.find(r=>r._isText),this._hasIconSuffix=!!this._suffixChildren.find(r=>!r._isText),this._hasTextSuffix=!!this._suffixChildren.find(r=>r._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Dl(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(No(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(No(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(r){let i=this._control?this._control.ngControl:null;return i&&i[r]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let r=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&r.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let i=this._hintChildren?this._hintChildren.find(a=>a.align==="start"):null,o=this._hintChildren?this._hintChildren.find(a=>a.align==="end"):null;i?r.push(i.id):this._hintLabel&&r.push(this._hintLabelId),o&&r.push(o.id)}else this._errorChildren&&r.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(r)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let r=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){r.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let i=this._iconPrefixContainer?.nativeElement,o=this._textPrefixContainer?.nativeElement,a=i?.getBoundingClientRect().width??0,s=o?.getBoundingClientRect().width??0,c=this._dir.value==="rtl"?"-1":"1",l=`${a+s}px`,u=`calc(${c} * (${l} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;r.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${dT} translateX(${u})
    )`}_isAttachedToDom(){let r=this._elementRef.nativeElement;if(r.getRootNode){let i=r.getRootNode();return i&&i!==r}return document.documentElement.contains(r)}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(yr),X(en),X(ws),X(ui),X(cT,8),X(bs,8),X(qo))},e.\u0275cmp=fe({type:e,selectors:[["mat-form-field"]],contentQueries:function(i,o,a){if(i&1&&(di(a,pd,5),di(a,pd,7),di(a,nf,5),di(a,iT,5),di(a,oT,5),di(a,nT,5),di(a,gd,5)),i&2){let s;Xe(s=Je())&&(o._labelChildNonStatic=s.first),Xe(s=Je())&&(o._labelChildStatic=s.first),Xe(s=Je())&&(o._formFieldControl=s.first),Xe(s=Je())&&(o._prefixChildren=s),Xe(s=Je())&&(o._suffixChildren=s),Xe(s=Je())&&(o._errorChildren=s),Xe(s=Je())&&(o._hintChildren=s)}},viewQuery:function(i,o){if(i&1&&(Ct(zF,5),Ct(IF,5),Ct(RF,5),Ct(R_,5),Ct(q_,5),Ct(B_,5)),i&2){let a;Xe(a=Je())&&(o._textField=a.first),Xe(a=Je())&&(o._iconPrefixContainer=a.first),Xe(a=Je())&&(o._textPrefixContainer=a.first),Xe(a=Je())&&(o._floatingLabel=a.first),Xe(a=Je())&&(o._notchedOutline=a.first),Xe(a=Je())&&(o._lineRipple=a.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,o){i&2&&Re("mat-mdc-form-field-label-always-float",o._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",o._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",o._hasIconSuffix)("mat-form-field-invalid",o._control.errorState)("mat-form-field-disabled",o._control.disabled)("mat-form-field-autofilled",o._control.autofilled)("mat-form-field-no-animations",o._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",o.appearance=="fill")("mat-form-field-appearance-outline",o.appearance=="outline")("mat-form-field-hide-placeholder",o._hasFloatingLabel()&&!o._shouldLabelFloat())("mat-focused",o._control.focused)("mat-primary",o.color!=="accent"&&o.color!=="warn")("mat-accent",o.color==="accent")("mat-warn",o.color==="warn")("ng-untouched",o._shouldForward("untouched"))("ng-touched",o._shouldForward("touched"))("ng-pristine",o._shouldForward("pristine"))("ng-dirty",o._shouldForward("dirty"))("ng-valid",o._shouldForward("valid"))("ng-invalid",o._shouldForward("invalid"))("ng-pending",o._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[gn([{provide:rf,useExisting:e},{provide:U_,useExisting:e}]),xe],ngContentSelectors:BF,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(i,o){if(i&1){let a=yt();fg(NF),we(0,jF,1,1,"ng-template",null,0,ox),q(2,"div",4,1),K("click",function(c){return ae(a),se(o._control.onContainerClick(c))}),we(4,VF,1,0,"div",5),q(5,"div",6),we(6,GF,2,2,"div",7)(7,WF,3,0,"div",8)(8,KF,3,0,"div",9),q(9,"div",10),we(10,XF,1,1,null,11),rr(11),j(),we(12,JF,2,0,"div",12)(13,QF,2,0,"div",13),j(),we(14,YF,1,0,"div",14),j(),q(15,"div",15),we(16,ZF,2,1)(17,tT,5,2),j()}if(i&2){let a;H(2),Re("mdc-text-field--filled",!o._hasOutline())("mdc-text-field--outlined",o._hasOutline())("mdc-text-field--no-label",!o._hasFloatingLabel())("mdc-text-field--disabled",o._control.disabled)("mdc-text-field--invalid",o._control.errorState),H(2),nn(4,!o._hasOutline()&&!o._control.disabled?4:-1),H(2),nn(6,o._hasOutline()?6:-1),H(),nn(7,o._hasIconPrefix?7:-1),H(),nn(8,o._hasTextPrefix?8:-1),H(2),nn(10,!o._hasOutline()||o._forceDisplayInfixLabel()?10:-1),H(2),nn(12,o._hasTextSuffix?12:-1),H(),nn(13,o._hasIconSuffix?13:-1),H(),nn(14,o._hasOutline()?-1:14),H(),Re("mat-mdc-form-field-subscript-dynamic-size",o.subscriptSizing==="dynamic"),H(),nn(16,(a=o._getDisplayedMessages())==="error"?16:a==="hint"?17:-1)}},dependencies:[R_,q_,px,B_,gd],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[sT.transitionMessages]},changeDetection:0});let n=e;return n})(),Ls=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({imports:[Br,Wn,Cx,Br]});let n=e;return n})();var W_=yx({passive:!0}),K_=(()=>{let e=class e{constructor(r,i){this._platform=r,this._ngZone=i,this._monitoredElements=new Map}monitor(r){if(!this._platform.isBrowser)return Wb;let i=wg(r),o=this._monitoredElements.get(i);if(o)return o.subject;let a=new tt,s="cdk-text-field-autofilled",c=l=>{l.animationName==="cdk-text-field-autofill-start"&&!i.classList.contains(s)?(i.classList.add(s),this._ngZone.run(()=>a.next({target:l.target,isAutofilled:!0}))):l.animationName==="cdk-text-field-autofill-end"&&i.classList.contains(s)&&(i.classList.remove(s),this._ngZone.run(()=>a.next({target:l.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",c,W_),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:a,unlisten:()=>{i.removeEventListener("animationstart",c,W_)}}),a}stopMonitoring(r){let i=wg(r),o=this._monitoredElements.get(i);o&&(o.unlisten(),o.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((r,i)=>this.stopMonitoring(i))}};e.\u0275fac=function(i){return new(i||e)(ht(ui),ht(en))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var $_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({});let n=e;return n})();var pT=new ft("MAT_INPUT_VALUE_ACCESSOR"),gT=["button","checkbox","file","hidden","image","radio","range","reset","submit"],fT=0,X_=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(r){this._disabled=jo(r),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(r){this._id=r||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(Ko.required)??!1}set required(r){this._required=jo(r)}get type(){return this._type}set type(r){this._type=r||"text",this._validateType(),!this._isTextarea&&Cg().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(r){this._errorStateTracker.matcher=r}get value(){return this._inputValueAccessor.value}set value(r){r!==this.value&&(this._inputValueAccessor.value=r,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(r){this._readonly=jo(r)}get errorState(){return this._errorStateTracker.errorState}set errorState(r){this._errorStateTracker.errorState=r}constructor(r,i,o,a,s,c,l,h,u,d){this._elementRef=r,this._platform=i,this.ngControl=o,this._autofillMonitor=h,this._formField=d,this._uid=`mat-input-${fT++}`,this.focused=!1,this.stateChanges=new tt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(f=>Cg().has(f)),this._iOSKeyupListener=f=>{let x=f.target;!x.value&&x.selectionStart===0&&x.selectionEnd===0&&(x.setSelectionRange(1,1),x.setSelectionRange(0,0))};let p=this._elementRef.nativeElement,m=p.nodeName.toLowerCase();this._inputValueAccessor=l||p,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&u.runOutsideAngular(()=>{r.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new Px(c,o,s,a,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=m==="select",this._isTextarea=m==="textarea",this._isInFormField=!!d,this._isNativeSelect&&(this.controlType=p.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(r=>{this.autofilled=r.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(r){this._elementRef.nativeElement.focus(r)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(r){r!==this.focused&&(this.focused=r,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let r=this._elementRef.nativeElement.value;this._previousNativeValue!==r&&(this._previousNativeValue=r,this.stateChanges.next())}_dirtyCheckPlaceholder(){let r=this._getPlaceholder();if(r!==this._previousPlaceholder){let i=this._elementRef.nativeElement;this._previousPlaceholder=r,r?i.setAttribute("placeholder",r):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){gT.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let r=this._elementRef.nativeElement.validity;return r&&r.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let r=this._elementRef.nativeElement,i=r.options[0];return this.focused||r.multiple||!this.empty||!!(r.selectedIndex>-1&&i&&i.label)}else return this.focused||!this.empty}setDescribedByIds(r){r.length?this._elementRef.nativeElement.setAttribute("aria-describedby",r.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let r=this._elementRef.nativeElement;return this._isNativeSelect&&(r.multiple||r.size>1)}};e.\u0275fac=function(i){return new(i||e)(X(_t),X(ui),X(io,10),X(Hg,8),X(Wg,8),X(Ox),X(pT,10),X(K_),X(en),X(rf,8))},e.\u0275dir=nt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(i,o){i&1&&K("focus",function(){return o._focusChanged(!0)})("blur",function(){return o._focusChanged(!1)})("input",function(){return o._onInput()}),i&2&&(Bo("id",o.id)("disabled",o.disabled)("required",o.required),me("name",o.name||null)("readonly",o.readonly&&!o._isNativeSelect||null)("aria-invalid",o.empty&&o.required?null:o.errorState)("aria-required",o.required)("id",o.id),Re("mat-input-server",o._isServer)("mat-mdc-form-field-textarea-control",o._isInFormField&&o._isTextarea)("mat-mdc-form-field-input-control",o._isInFormField)("mdc-text-field__input",o._isInFormField)("mat-mdc-native-select-inline",o._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[pn.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[gn([{provide:nf,useExisting:e}]),tr]});let n=e;return n})(),J_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Gt({type:e}),e.\u0275inj=Ut({imports:[Br,Ls,Ls,$_,Br]});let n=e;return n})();var Q_=(()=>{let e=class e{constructor(){this.nameControl=new Ug("",[Ko.required])}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-save-whiteboard"]],standalone:!0,features:[xe],decls:9,vars:5,consts:[["matDialogContent",""],["matInput","",3,"formControl"],["matDialogActions",""],["mat-raised-button","",3,"disabled","mat-dialog-close"]],template:function(i,o){i&1&&(q(0,"mat-form-field",0)(1,"mat-label"),it(2,"Name"),j(),Z(3,"input",1),q(4,"mat-hint"),it(5," Provide a new name for the board"),j()(),q(6,"div",2)(7,"button",3),it(8,"Save"),j()()),i&2&&(H(3),ee("formControl",o.nameControl),H(3),tn("padding-left","1.5rem"),H(),ee("disabled",o.nameControl.invalid)("mat-dialog-close",o.nameControl.value))},dependencies:[Ls,G_,pd,gd,J_,X_,kx,Ax,D_,F_,k_,h_,od,o_,Gg]});let n=e;return n})();var Y_=(()=>{let e=class e{constructor(){this.onImageAdd=new ie}addImage(r){this.onImageAdd.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-add-image"]],outputs:{onImageAdd:"onImageAdd"},standalone:!0,features:[xe],decls:7,vars:0,consts:[[1,"menu"],["matTooltip","Add image",1,"menu_title"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#fff","d","M4 5h13v7h2V5c0-1.103-.897-2-2-2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h8v-2H4V5z"],["fill","#565a66","d","m8 11l-3 4h11l-4-6l-3 4z"],["fill","#565a66","d","M19 14h-2v3h-3v2h3v3h2v-3h3v-2h-3z"],["type","file","accept","image/png, image/gif, image/jpeg",1,"file-input",3,"change"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"label",1),ce(),q(2,"svg",2),Z(3,"path",3)(4,"path",4)(5,"path",5),j(),nr(),q(6,"input",6),K("change",function(s){return o.addImage(s.target)}),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var Z_=(()=>{let e=class e{constructor(){this.onUndo=new ie}undo(){this.onUndo.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-undo"]],outputs:{onUndo:"onUndo"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","Undo(ctrl + z)","title","Undo",1,"menu_title",3,"click"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#fff","d","M9 10h6c1.654 0 3 1.346 3 3s-1.346 3-3 3h-3v2h3c2.757 0 5-2.243 5-5s-2.243-5-5-5H9V5L4 9l5 4v-3z"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),K("click",function(){return o.undo()}),ce(),q(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ey=(()=>{let e=class e{constructor(){this.onNewDocument=new ie}newDocument(){this.onNewDocument.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-new-document"]],outputs:{onNewDocument:"onNewDocument"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","New document",1,"menu_title",3,"click"],["viewBox","0 0 16 16","width","20","height","20"],["fill","#fff","d","m9.5 1.1l3.4 3.5l.1.4v2h-1V6H8V2H3v11h4v1H2.5l-.5-.5v-12l.5-.5h6.7l.3.1zM9 2v3h2.9L9 2zm4 14h-1v-3H9v-1h3V9h1v3h3v1h-3v3z"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),K("click",function(){return o.newDocument()}),ce(),q(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ty=(()=>{let e=class e{constructor(){this.onRedo=new ie}redo(){this.onRedo.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-redo"]],outputs:{onRedo:"onRedo"},standalone:!0,features:[xe],decls:4,vars:0,consts:[[1,"menu"],["matTooltip","Redo(ctrl + y)","title","Redo",1,"menu_title",3,"click"],["viewBox","0 0 20 20","width","20","height","20"],["fill","#fff","d","M9 18h3v-2H9c-1.654 0-3-1.346-3-3s1.346-3 3-3h6v3l5-4l-5-4v3H9c-2.757 0-5 2.243-5 5s2.243 5 5 5z"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),K("click",function(){return o.redo()}),ce(),q(2,"svg",2),Z(3,"path",3),j()()())},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var vT=n=>({disabled:n});function bT(n,e){n&1&&(ce(),q(0,"g",4),Z(1,"path",5)(2,"path",6),j())}function xT(n,e){n&1&&(ce(),q(0,"g",7),Z(1,"path",5)(2,"path",6),j())}var ny=(()=>{let e=class e{constructor(){this.onSaveToDB=new ie}SaveToDB(){this.onSaveToDB.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-save-to-db"]],inputs:{disabled:"disabled"},outputs:{onSaveToDB:"onSaveToDB"},standalone:!0,features:[xe],decls:9,vars:5,consts:[[1,"menu",3,"ngClass","matTooltip"],["matTooltip","Save","title","Save",1,"menu_title",3,"click"],["width","20","height","20","viewBox","0 -0.5 17 17","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",1,"si-glyph","si-glyph-file-upload"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["transform","translate(1.000000, 1.000000)","fill","#565a66"],["d","M14,8.047 L14,12.047 L2,12.047 L2,8.047 L0,8.047 L0,15 L15.969,15 L15.969,8.047 L14,8.047 Z",1,"si-glyph-fill"],["d","M7.997,0 L5,3.963 L7.016,3.984 L7.016,8.969 L8.953,8.969 L8.953,3.984 L10.953,3.984 L7.997,0 Z",1,"si-glyph-fill"],["transform","translate(1.000000, 1.000000)","fill","#fff"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),K("click",function(){return o.SaveToDB()}),ce(),q(2,"svg",2)(3,"title"),it(4,"1126"),j(),Z(5,"defs"),q(6,"g",3),we(7,bT,3,0,":svg:g",4)(8,xT,3,0),j()()()()),i&2&&(ee("ngClass",Nl(3,vT,o.disabled))("matTooltip",o.disabled?"login to save your board":""),H(7),nn(7,o.disabled?7:8))},dependencies:[Wn,lx,Kl,Fx],styles:[".disabled[_ngcontent-%COMP%]{cursor:not-allowed;pointer-events:none}",'@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ry=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.SELECT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whitebord-button-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Select Tool",1,"tool_button",3,"click"],["viewBox","0 0 24 24","width","24","height","24"],["d","M17.15 20.76l-2.94 1.5-3.68-6-4.41 3V1.24l12.5 12.01-4.41 1.5 2.94 6z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.SELECT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var iy=(()=>{let e=class e{constructor(){this.formatTypes=qr,this.onSaveAs=new ie}saveAs(r){this.onSaveAs.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-save-as-menu"]],outputs:{onSaveAs:"onSaveAs"},standalone:!0,features:[xe],decls:13,vars:0,consts:[[1,"menu"],["title","Save Board",1,"menu_title"],["viewBox","0 0 20 20","width","20","height","20"],["d","M12.984 12.656l2.625-2.578 1.406 1.406-5.016 5.016-5.016-5.016 1.406-1.406 2.625 2.578v-9.656h1.969v9.656zM18.984 12h2.016v6.984q0 0.797-0.609 1.406t-1.406 0.609h-13.969q-0.797 0-1.406-0.609t-0.609-1.406v-6.984h2.016v6.984h13.969v-6.984z","fill","#fff"],["id","file_menu",1,"menu_list","inverted-undo"],[1,"menu_item",3,"click"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),ce(),q(2,"svg",2),Z(3,"path",3),j()(),nr(),q(4,"div",4)(5,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Png)}),it(6,"Save as PNG"),j(),q(7,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Jpeg)}),it(8,"Save as JPEG"),j(),q(9,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Svg)}),it(10,"Save as SVG"),j(),q(11,"div",5),K("click",function(){return o.saveAs(o.formatTypes.Base64)}),it(12,"Copy Base-64"),j()()())}});let n=e;return n})();var oy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(_e.BRUSH)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-brush-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Brush Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24",2,"transform","scale(-1, 1)"],["d","M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.BRUSH)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ay=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.IMAGE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-image-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:4,vars:2,consts:[["matTooltip","Image Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24"],["d","M0 0h24v24H0z","fill","none"],["d","M17 7l-5 5 5 5V7zm-2 9.17L12.83 12 15 9.83 17.17 12 15 14.17zM3 3v18h18V3H3zm16 16H5V5h14v14z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2)(3,"path",3),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.IMAGE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var sy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.LINE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-line-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Line Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["d","M 3 1 L 26 24 L 24 26 L 1 3 L 3 1 Z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.LINE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var cy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.RECT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-rect-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Square/Rect Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["d","M 0 8 L 0 24 L 24 24 L 25 8 L 0 8 Z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.RECT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var ly=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.ELLIPSE)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-ellipse-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Ellipse/Circle Tool",1,"tool_button",3,"click"],["viewBox","0 0 27 27","xmlns","http://www.w3.org/2000/svg","width","24","height","24"],["cx","13","cy","13","rx","13","ry","9"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"ellipse",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.ELLIPSE)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var dy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.TEXT)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-text-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:3,vars:2,consts:[["matTooltip","Text Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27","height","27"],["d","M5 4v3h5.5v12h3V7H19V4z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.TEXT)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var uy=(()=>{let e=class e{constructor(){this.onToolSelectionChanged=new ie,this.toolsEnum=_e}toolSelectionChanged(){this.onToolSelectionChanged.emit(this.toolsEnum.ERASER)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-eraser-tool"]],inputs:{selectedTool:"selectedTool"},outputs:{onToolSelectionChanged:"onToolSelectionChanged"},standalone:!0,features:[xe],decls:4,vars:2,consts:[["matTooltip","Eraser Tool",1,"tool_button",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24"],["d","M0 0h24v24H0z","fill","none"],["d","M19 13H5v-2h14v2z"]],template:function(i,o){i&1&&(q(0,"div",0),K("click",function(){return o.toolSelectionChanged()}),ce(),q(1,"svg",1),Z(2,"path",2)(3,"path",3),j()()),i&2&&Re("active",o.selectedTool===o.toolsEnum.ERASER)},styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();var hy=(()=>{let e=class e{constructor(){this.onColorChange=new ie,this.onSwapColors=new ie,this.options=Is}colorChange(r,i){this.onColorChange.emit({type:r,event:i})}swapColors(){this.onSwapColors.emit()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-color-tool"]],outputs:{onColorChange:"onColorChange",onSwapColors:"onSwapColors"},standalone:!0,features:[xe],decls:18,vars:2,consts:[["id","color_tools"],["id","tool_switch","matTooltip","Switch stroke and fill colors [X]",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 11 11"],["d","M3.01 2A6 6 0 019 8h1.83l-2.91 2.91L5 8h2a4 4 0 00-3.99-4v1.93L.1 3.02 3.01.1V2z"],["id","tool_fill","ngx-colors-trigger","",1,"color_tool","active",3,"change"],["title","Change fill color",1,"icon_label"],[1,"color_block"],["id","fill_bg"],["id","fill_color",1,"color_block"],["xmlns","http://www.w3.org/2000/svg","width","100%"],["width","100%","height","100%","opacity","1"],["id","tool_stroke","ngx-colors-trigger","",1,"color_tool",3,"change"],["title","Change stroke color",1,"icon_label"],["id","stroke_bg"],["id","stroke_color","title","Change stroke color",1,"color_block"]],template:function(i,o){i&1&&(q(0,"div",0)(1,"div",1),K("click",function(){return o.swapColors()}),ce(),q(2,"svg",2),Z(3,"path",3),j()(),nr(),q(4,"div",4),K("change",function(s){return o.colorChange("fill",s)}),Z(5,"label",5),q(6,"div",6),Z(7,"div",7),q(8,"div",8),ce(),q(9,"svg",9),Z(10,"rect",10),j()()()(),nr(),q(11,"div",11),K("change",function(s){return o.colorChange("strokeColor",s)}),Z(12,"label",12),q(13,"div",6),Z(14,"div",13),q(15,"div",14),ce(),q(16,"svg",9),Z(17,"rect",10),j()()()()()),i&2&&(H(10),me("fill",o.options.fill),H(7),me("fill",o.options.strokeColor))},dependencies:[dd,v_],styles:['@charset "UTF-8";.editor[_ngcontent-%COMP%]{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container[_ngcontent-%COMP%]{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor[_ngcontent-%COMP%]{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}[_ngcontent-%COMP%]::selection{background:#000;color:#fff}[_ngcontent-%COMP%]::-moz-selection{background:#000;color:#fff}.editor[_ngcontent-%COMP%]{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:10px;background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:transparent}input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit][_ngcontent-%COMP%]:hover, input[type=button][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{background:var(--accent9)}input[type=submit][_ngcontent-%COMP%]:active, input[type=button][_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit][_ngcontent-%COMP%]:focus, input[type=button][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:none}button.cancel[_ngcontent-%COMP%], input.Cancel[_ngcontent-%COMP%], input.cancel[_ngcontent-%COMP%], input.jGraduate_Cancel[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel[_ngcontent-%COMP%]{display:block}#tool_bold[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom[_ngcontent-%COMP%]{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix[_ngcontent-%COMP%]:before, .clearfix[_ngcontent-%COMP%]:after{content:"";display:table}.clearfix[_ngcontent-%COMP%]:after{clear:both}#color_canvas_tools[_ngcontent-%COMP%], #fill_bg[_ngcontent-%COMP%], #stroke_bg[_ngcontent-%COMP%]{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools[_ngcontent-%COMP%]{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools[_ngcontent-%COMP%]{display:block}#stroke_style_label[_ngcontent-%COMP%]{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:60%}.draginputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput[_ngcontent-%COMP%]{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]{pointer-events:none}.dragging[_ngcontent-%COMP%]   .draginput.active[_ngcontent-%COMP%]{pointer-events:all;box-shadow:none}.draginput[_ngcontent-%COMP%]:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--z15)}.draginput[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:var(--accent8)}.draginput.active[_ngcontent-%COMP%], .draginput.active[_ngcontent-%COMP%]:hover{background-color:var(--z0)}.draginput.active[_ngcontent-%COMP%]:hover{transition:none}.draginput[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]{margin-top:40px}.draginput[_ngcontent-%COMP%]   label#seg_type_label[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{top:66%}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   .pull[_ngcontent-%COMP%]{position:relative;left:-15px}.draginput[_ngcontent-%COMP%]   label#resolution_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection{background:var(--accent9)}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput.text-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput.textcontent[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:text}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%], .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover, .draginput[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active{cursor:pointer}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{color:var(--a7)}.draginput[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput[_ngcontent-%COMP%]:hover   .draginput_cursor[_ngcontent-%COMP%]{border-color:var(--accent6)}.draginput_cursor[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput[_ngcontent-%COMP%]   input[readonly=readonly][_ngcontent-%COMP%]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{z-index:10;color:var(--z15)}.draginput[_ngcontent-%COMP%]   .push_bottom[_ngcontent-%COMP%]{bottom:0;position:absolute}.draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging[_ngcontent-%COMP%]   .draginput[_ngcontent-%COMP%]   .angle[_ngcontent-%COMP%]{background-color:var(--z1)}.draginput[_ngcontent-%COMP%]:hover   .angle[_ngcontent-%COMP%]{background:var(--z4)}.draginput[_ngcontent-%COMP%]   .angle-cursor[_ngcontent-%COMP%]{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar[_ngcontent-%COMP%]{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]:hover   .menu_list[_ngcontent-%COMP%]{display:block}.menu[_ngcontent-%COMP%]{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]:hover{background:var(--z2)}.menu_list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list[_ngcontent-%COMP%]{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]   .menu_title[_ngcontent-%COMP%]{background:var(--z15);color:var(--z1)}.menu[_ngcontent-%COMP%]   .menu_list[_ngcontent-%COMP%]{display:none;position:absolute}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list[_ngcontent-%COMP%]   .menu_item.tool_button[_ngcontent-%COMP%]{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]:hover{background:var(--accent15);color:#000}.menu_list[_ngcontent-%COMP%]   .menu_item.disabled[_ngcontent-%COMP%]:hover, .menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed.disabled[_ngcontent-%COMP%]:hover{background:transparent;color:var(--z3)}.menu_list[_ngcontent-%COMP%]   .menu_item.push_button_pressed[_ngcontent-%COMP%]{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list[_ngcontent-%COMP%]   .menu_item[_ngcontent-%COMP%]:not(.disabled):hover   span[_ngcontent-%COMP%]{background:var(--accent13)}.menu-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z12)}.menu-right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z5)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z13)}#logo[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z9)}#logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{fill:var(--z15)}#rulers[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers[_ngcontent-%COMP%]   #ruler_corner[_ngcontent-%COMP%]{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x[_ngcontent-%COMP%]{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y[_ngcontent-%COMP%]{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], #ruler_y[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{overflow:hidden}#stroke_color[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch[_ngcontent-%COMP%]{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z6)}#tool_switch[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15)}.color_block[_ngcontent-%COMP%]{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}#tool_stroke[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}#color_tools[_ngcontent-%COMP%]{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools[_ngcontent-%COMP%]{width:auto;height:auto}#tool_fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:1}#tool_stroke[_ngcontent-%COMP%]{top:14px;left:14px}#tool_fill[_ngcontent-%COMP%], #tool_stroke[_ngcontent-%COMP%], #tool_canvas[_ngcontent-%COMP%]{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]{width:58px;height:38px}#tool_canvas[_ngcontent-%COMP%]   .color_block[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto}#shape_cats[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas[_ngcontent-%COMP%]{background-color:var(--z2);display:block;width:100%;height:100%}#workarea[_ngcontent-%COMP%]{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left[_ngcontent-%COMP%]{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button[_ngcontent-%COMP%]{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button[_ngcontent-%COMP%]:hover{transform:scale(1)}.tool_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z13)}.tool_button.active[_ngcontent-%COMP%]{transform:scale(1.4)}.tool_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:center;fill:var(--z5)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent8)}.tool_button.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--accent7)}.tool_button.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:-1px;left:1px}#tool_ellipse[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:2px;left:1px}.select-input[_ngcontent-%COMP%]{margin:var(--x2) 0;position:relative}.select-input[_ngcontent-%COMP%]:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel[_ngcontent-%COMP%]{display:none}.context_panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--z13);white-space:nowrap}#align_tools[_ngcontent-%COMP%]{display:none}.align_buttons[_ngcontent-%COMP%]{margin-bottom:var(--x2)}.align_button[_ngcontent-%COMP%], .align_button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition:var(--transition)}.align_button[_ngcontent-%COMP%]:hover, .align_button[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{transition:none}.align_button[_ngcontent-%COMP%]{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button[_ngcontent-%COMP%]:hover{background-color:var(--z0);border-color:var(--z3)}.align_button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10)}.align_button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--z15);transition:none}.align_button[_ngcontent-%COMP%]:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button[_ngcontent-%COMP%]:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button[_ngcontent-%COMP%]:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button[_ngcontent-%COMP%]:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons[_ngcontent-%COMP%]   .push_button[_ngcontent-%COMP%]{display:block;float:left}#tool_bold[_ngcontent-%COMP%], #tool_italic[_ngcontent-%COMP%]{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold[_ngcontent-%COMP%]{right:0}#tool_italic[_ngcontent-%COMP%]{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold[_ngcontent-%COMP%]:hover, #tool_italic[_ngcontent-%COMP%]:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled[_ngcontent-%COMP%], #tool_italic.disabled[_ngcontent-%COMP%]{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active[_ngcontent-%COMP%], #tool_italic.active[_ngcontent-%COMP%]{color:#50a0ff}#preview_font[_ngcontent-%COMP%]{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font[_ngcontent-%COMP%] + .caret[_ngcontent-%COMP%]{right:var(--x2)}.draginput[_ngcontent-%COMP%]:hover   #preview_font[_ngcontent-%COMP%]:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel[_ngcontent-%COMP%], #zoom_select[_ngcontent-%COMP%]{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label[_ngcontent-%COMP%]:after{content:""}#zoom_select[_ngcontent-%COMP%]{opacity:0;z-index:100}#zoom_select[_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]{opacity:1}#zoom_label[_ngcontent-%COMP%]{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-top:-5px}#zoom_label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #zoom_label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4)}#zoomLabel[_ngcontent-%COMP%]{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--z10);position:relative;top:2px}#zoom_label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;position:absolute;inset:0}#zoom_label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{top:0;left:0}']});let n=e;return n})();function _T(n,e){if(n&1&&(q(0,"option",9),it(1),j()),n&2){let t=e.$implicit;ee("value",t)("selected",t===100),H(),no(" ",t+"%"," ")}}var py=(()=>{let e=class e{constructor(){this.whiteBoardZoomOptions=C_,this.onZoom=new ie}setZoom(r){this.onZoom.emit(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-zoom-panel"]],inputs:{zoom:"zoom"},outputs:{onZoom:"onZoom"},standalone:!0,features:[xe],decls:9,vars:2,consts:[["zoomSelect",""],["id","zoom_select",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["id","zoom_panel","title","Change zoom level",1,"toolset"],["id","zoom_label",1,"select-input"],["id","zoomLabel",1,"zoom_tool","icon_label"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","2 2 20 20","width","27"],["d","M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"],["id","zoom","type","text","readonly","readonly",3,"value"],[3,"value","selected"]],template:function(i,o){if(i&1){let a=yt();q(0,"select",1,0),K("change",function(){ae(a);let c=_r(1);return se(o.setZoom(c.value))}),we(2,_T,2,3,"option",2),j(),q(3,"div",3)(4,"div",4)(5,"span",5),ce(),q(6,"svg",6),Z(7,"path",7),j()(),nr(),Z(8,"input",8),j()()}i&2&&(H(2),ee("ngForOf",o.whiteBoardZoomOptions),H(6),ee("value",o.zoom*100+"%"))},dependencies:[Wn,Lo]});let n=e;return n})();Y();var IP=(()=>{let e=class e extends Pe{constructor(r,i,o){super(),this.audience=i,this.signalManager=o,this.posMap=new Map,this.onMouseSignalFn=(a,s)=>{let c=s.userId,l=s.pos,h=this.posMap.get(c);h===void 0&&(h=new Map,this.posMap.set(c,h)),h.set(a,l),this.emit("mousePositionChanged")},this.audience.on("memberRemoved",(a,s)=>{let c=this.posMap.get(s.userId);c!==void 0&&(c.delete(a),c.size===0&&this.posMap.delete(s.userId)),this.emit("mousePositionChanged")}),this.signalManager.on("error",a=>{this.emit("error",a)}),this.signalManager.onSignal(e.mouseSignalType,(a,s,c)=>{this.onMouseSignalFn(a,c)}),window.addEventListener("mousemove",a=>{let s={x:a.clientX,y:a.clientY};if(this.prevPosition){let l=s.x>=this.prevPosition.x+this.prevPosition.x*.02||s.x<=this.prevPosition.x-this.prevPosition.x*.02,h=s.y>=this.prevPosition.y+this.prevPosition.y*.02||s.y<=this.prevPosition.y-this.prevPosition.y*.02;(l||h)&&this.sendMouseSignal(s)}else this.sendMouseSignal(s);this.prevPosition=s})}sendMouseSignal(r){this.signalManager.submitSignal(e.mouseSignalType,{userId:this.audience.getMyself()?.userId,pos:r})}getMousePresences(){let r=new Map;return this.audience.getMembers().forEach((i,o)=>{i.connections.forEach(a=>{let s=this.getMousePresenceForUser(o,a.id);s!==void 0&&r.set(i,s)})}),r}getMousePresenceForUser(r,i){return this.posMap.get(r)?.get(i)}};e.mouseSignalType="positionChanged";let n=e;return n})();function Kf(n,e){if(!n)throw new Error(typeof e=="number"?`0x${e.toString(16).padStart(3,"0")}`:e)}Y();var ac=class extends Pe{constructor(e,t){super(),this.container=e,this.rootDataObject=t,this.connectedHandler=()=>this.emit("connected"),this.disconnectedHandler=()=>this.emit("disconnected"),this.disposedHandler=r=>this.emit("disposed",r),this.savedHandler=()=>this.emit("saved"),this.dirtyHandler=()=>this.emit("dirty"),e.on("connected",this.connectedHandler),e.on("closed",this.disposedHandler),e.on("disconnected",this.disconnectedHandler),e.on("saved",this.savedHandler),e.on("dirty",this.dirtyHandler)}get isDirty(){return this.container.isDirty}get attachState(){return this.container.attachState}get disposed(){return this.container.closed}get connectionState(){return this.container.connectionState}get initialObjects(){return this.rootDataObject.initialObjects}attach(){return v(this,null,function*(){throw new Error("Cannot attach container. Container is not in detached state")})}connect(){return v(this,null,function*(){var e,t;(t=(e=this.container).connect)===null||t===void 0||t.call(e)})}disconnect(){return v(this,null,function*(){var e,t;(t=(e=this.container).disconnect)===null||t===void 0||t.call(e)})}create(e){return v(this,null,function*(){return this.rootDataObject.create(e)})}dispose(){this.container.close(),this.container.off("connected",this.connectedHandler),this.container.off("closed",this.disposedHandler),this.container.off("disconnected",this.disconnectedHandler),this.container.off("saved",this.savedHandler),this.container.off("dirty",this.dirtyHandler)}};var sc=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(sc||{});var xi=class{constructor(e){this.internalStorageService=e}set policies(e){this._policies=e}get policies(){var e;return(e=this._policies)!==null&&e!==void 0?e:this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.internalStorageService.getSnapshotTree(e,t)})}getVersions(e,t,r){return v(this,null,function*(){return this.internalStorageService.getVersions(e,t,r)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.internalStorageService.downloadSummary(e)})}createBlob(e){return v(this,null,function*(){return this.internalStorageService.createBlob(e)})}readBlob(e){return v(this,null,function*(){return this.internalStorageService.readBlob(e)})}};var zd=class extends xi{constructor(e,t){super(e),this.blobs=t}get policies(){return this.internalStorageService.policies}readBlob(e){return v(this,null,function*(){let t=this.blobs.get(e);return t!==void 0?t:this.internalStorageService.readBlob(e)})}};var lo=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(lo||{});var Id=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(Id||{}),cc=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(cc||{});var _i=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(_i||{});Y();Hr();Nt();function IO(n,e,t){let r=[];for(let i of e){let o=`${n}${i.path}`;if(i.type===cc.Blob){let a=i.value,s=Bn(a.contents,a.encoding),c=ke();t.set(c,s);let l={mode:Id[i.mode],path:o,sha:c,size:0,type:"blob",url:""};r.push(l)}else if(i.type===cc.Tree){w(i.type===cc.Tree,257);let a=i.value,s={mode:Id[i.mode],path:o,sha:"",size:-1,type:"tree",url:""};r.push(s);let c=IO(`${o}/`,a.entries,t);r.push(...c)}}return r}function LB(n,e){return{sha:"",tree:IO("",n,e),url:""}}function ru(n,e){let t=LB(n,e);return ma(t)}var $t=function(n){return n.genericError="genericError",n.genericNetworkError="genericNetworkError",n.authorizationError="authorizationError",n.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",n.throttlingError="throttlingError",n.offlineError="offlineError",n.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",n.writeError="writeError",n.fetchFailure="fetchFailure",n.incorrectServerResponse="incorrectServerResponse",n.fileOverwrittenInStorage="fileOverwrittenInStorage",n.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",n.locationRedirection="locationRedirection",n}($t||{});var Ai=function(n){return n[n.NoCaching=0]="NoCaching",n[n.Prefetch=1]="Prefetch",n}(Ai||{});var ki=function(n){return n.summarizingClient="fluid-client-summarizer",n.createNew="createNew",n}(ki||{});var wv=Ce($m());var Dc=n=>n?.type==="fluid";function bn(n){if(!Dc(n))throw new Error(`resolved is not a Fluid url. Type: ${n?.type}`)}var Su=class n{constructor(e){this.protocolName="none:",this.protocolToDocumentFactoryMap=new Map,e.forEach(t=>{this.protocolToDocumentFactoryMap.set(t.protocolName,t)})}static create(e){if(Array.isArray(e)){let t=[];return e.forEach(r=>{let i=r;i.protocolToDocumentFactoryMap!==void 0?t.push(...i.protocolToDocumentFactoryMap.values()):t.push(r)}),t.length===1?t[0]:new n(t)}return e}createDocumentService(e,t,r){return v(this,null,function*(){bn(e);let i=(0,wv.parse)(e.url);if(i.protocol===void 0||i.protocol===null)throw new Error("No protocol provided");let o=this.protocolToDocumentFactoryMap.get(i.protocol);if(o===void 0)throw new Error("Unknown Fluid protocol");return o.createDocumentService(e,t,r)})}createContainer(e,t,r,i){return v(this,null,function*(){bn(t);let o=(0,wv.parse)(t.url);if(o.protocol===void 0||o.protocol===null)throw new Error("No protocol provided");let a=this.protocolToDocumentFactoryMap.get(o.protocol);if(a===void 0)throw new Error("Unknown Fluid protocol");return a.createContainer(e,t,r,i)})}};function Cj(n,e){return v(this,null,function*(){let t;for(let r of n)if(t=yield r.resolve(Object.assign({},e)),t!==void 0)return t})}var Eu=class n{constructor(e){this.urlResolvers=e}static create(e){return Array.isArray(e)?e.length===1?e[0]:new n(e):e}resolve(e){return v(this,null,function*(){return Cj(this.urlResolvers,e)})}getAbsoluteUrl(e,t){return v(this,null,function*(){throw new Error("Not implmented")})}};Oe();var Pv,Gr=function(n){return n[n.Offline=0]="Offline",n[n.Online=1]="Online",n[n.Unknown=2]="Unknown",n}(Gr||{});function Tc(){return typeof navigator=="object"&&navigator!==null&&typeof navigator.onLine=="boolean"?navigator.onLine?Gr.Online:Gr.Offline:Gr.Unknown}var za=class extends Be{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=$t.genericNetworkError}},nE="deltaStreamConnectionForbidden",Fc=class n extends Be{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=n.errorType,this.canRetry=!1}};Fc.errorType=(Pv=$t[nE])!==null&&Pv!==void 0?Pv:nE;var Au=class extends Be{constructor(e,t,r,i){super(e,i,new Set(["claims","tenantId"])),this.claims=t,this.tenantId=r,this.errorType=$t.authorizationError,this.canRetry=!1}},Ov=class extends Be{constructor(e,t,r,i){super(e,i),this.errorType=t,this.canRetry=r}},Wr=class extends Ov{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}};var Mv=class extends Be{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=$t.throttlingError,this.canRetry=!0}},rE=(n,e)=>new Wr(n,$t.writeError,e);function Sr(n,e,t){return e.retryAfterMs!==void 0&&e.canRetry?new Mv(n,e.retryAfterMs/1e3,t):new za(n,e.canRetry,t)}var Er=n=>n?.canRetry===!0,Sv=n=>n?.retryAfterSeconds,_o=n=>n?.retryAfterSeconds!==void 0?n.retryAfterSeconds*1e3:void 0;Y();function Ze(n,e){return v(this,null,function*(){let t=yield n.readBlob(e),r=gi(t,"utf8");return JSON.parse(r)})}function Ia(n,e){return{type:_i.Tree,tree:{".protocol":e,".app":n}}}function iE(n){var e;let t=n.tree.attributes,r=JSON.parse(t.content);return r.term=(e=r.term)!==null&&e!==void 0?e:1,r}function oE(n){let e=n.tree.quorumValues;return JSON.parse(e.content)}Y();Oe();function zc(n,e,t){var r,i;let o=Object.assign({},e),a=t.online;if(o.online=typeof a=="string"?a:Gr[Tc()],typeof navigator=="object"&&navigator!==null){let s=navigator,c=(i=(r=s.connection)!==null&&r!==void 0?r:s.mozConnection)!==null&&i!==void 0?i:s.webkitConnection;c!==null&&typeof c=="object"&&(o.connectionType=c.type)}o.category=Er(t)?"generic":"error",n.sendTelemetryEvent(o,t)}function Ic(n){return new Promise(t=>{let r=t,i=n;Tc()===Gr.Offline&&window?.addEventListener!==void 0&&(r=()=>{t(),window.removeEventListener("online",r)},window.addEventListener("online",r,!1),i=Math.max(n,3e4)),setTimeout(r,i)})}var ku="1.4.0";var wj=1e4,Pj=100,Ev=class{constructor(e,t,r,i,o,a){this.to=t,this.payloadSize=r,this.logger=i,this.requestCallback=o,this.responseCallback=a,this.results=new Map,this.workingState="working",this.requestsInFlight=0,this.endEvent=new Ee,this.requests=0,this.latestRequested=e,this.nextToDeliver=e,this.knewTo=t!==void 0}get working(){return this.workingState==="working"}get canceled(){return this.workingState==="canceled"}cancel(){this.working&&(this.workingState="canceled",this.endEvent.resolve())}run(e){return v(this,null,function*(){w(e>0,258),w(this.working,259);let t=e;for(;t>0;)t--,this.addRequest();return this.dispatch(),this.endEvent.promise})}done(){w(this.to!==void 0,260),w(this.nextToDeliver>=this.to,261),this.working&&(this.workingState="done",this.endEvent.resolve())}fail(e){this.working&&(this.workingState="done",this.endEvent.reject(e))}dispatch(){for(;this.working;){let e=this.results.get(this.nextToDeliver);if(e===void 0)break;this.results.delete(this.nextToDeliver),w(e.length<=this.payloadSize,473),this.nextToDeliver+=e.length,this.responseCallback(e)}this.working&&(this.requestsInFlight===0?(w(this.results.size===0,263),this.done()):this.to!==void 0&&this.nextToDeliver>=this.to&&(w(!this.knewTo,264),this.done()))}getNextChunk(){if(!this.working)return;let e=this.latestRequested;if(!(this.to!==void 0&&this.to<=e))return this.latestRequested+=this.payloadSize,this.to!==void 0&&(this.latestRequested=Math.min(this.to,this.latestRequested)),w(e<this.latestRequested,265),{from:e,to:this.latestRequested}}addRequest(){let e=this.getNextChunk();e!==void 0&&this.addRequestCore(e.from,e.to).catch(this.fail.bind(this))}addRequestCore(e,t){return v(this,null,function*(){w(this.working,266);let r=e,i=t;for(this.requestsInFlight++;this.working;){let o=i-r;w(o>0,267),this.to!==void 0&&(w(r<this.to,268),w(i<=this.to,269)),this.requests++;let a=this.requestCallback(this.requests,r,i,this.to!==void 0,{});this.dispatch();let{payload:s,cancel:c,partial:l}=yield a;if(c&&this.cancel(),this.to!==void 0&&r>=this.to){w(!this.knewTo,270),s.length!==0&&this.logger.sendErrorEvent({eventName:"ParallelRequests_GotExtra",from:r,to:i,end:this.to,length:s.length});break}if(this.working){let h=r,u=s.length,d=o<=u;if(u!==0){o<u&&this.logger.sendTelemetryEvent({eventName:"ParallelRequests_Over",from:r,to:i,length:u});let p=s.splice(0,o);this.results.set(r,p),r+=p.length}else w(!l,271),w(!this.knewTo,272);if(!l&&!d){if(!this.knewTo){(this.to===void 0||this.to>r)&&(this.to=r);break}this.logger.sendPerformanceEvent({eventName:"ParallelRequests_Partial",from:h,to:i,length:u})}if(i===this.latestRequested&&(s.length!==0&&(this.results.set(r,s),r+=s.length),this.latestRequested=r,d=!0),d){let p=this.getNextChunk();if(p===void 0)break;r=p.from,i=p.to}}}this.requestsInFlight--,this.dispatch()})}},Av=class{constructor(){this.queue=[],this.done=!1}pushValue(e){this.pushCore(Promise.resolve({done:!1,value:e}))}pushError(e){this.pushCore(Promise.reject(e)),this.done=!0}pushDone(){this.pushCore(Promise.resolve({done:!0})),this.done=!0}pushCore(e){w(!this.done,274),this.deferred?(w(this.queue.length===0,275),this.deferred.resolve(e),this.deferred=void 0):this.queue.push(e)}read(){return v(this,null,function*(){w(this.deferred===void 0,276);let e=this.queue.shift();return e!==void 0?e:(w(!this.done,277),this.deferred=new Ee,this.deferred.promise)})}};function Oj(n,e,t,r,i,o){return v(this,null,function*(){let a,s=0,c=[],l={partial:!1,cancel:!0,payload:[]};for(;i?.aborted!==!0;){s++;let h=Math.min(wj,Pj*Math.pow(2,s)),u=de.now();try{let d=n(Object.assign(Object.assign({},e),{retry:s})),{messages:p,partialResult:m}=yield d;if(c.push(...p),p.length!==0||!t)return{payload:c,cancel:!1,partial:m};if(a===void 0)a=de.now();else if(de.now()-a>3e4)throw Sr("Failed to retrieve ops from storage (Too Many Retries)",{canRetry:!1},Object.assign({retry:s,driverVersion:ku},e))}catch(d){let p=Er(d);a=void 0;let m=_o(d);if(zc(r,Object.assign(Object.assign({eventName:"GetDeltas_Error"},e),{retry:s,duration:de.now()-u,retryAfter:m,reason:o}),d),!p)throw d;m!==void 0&&m>=0&&(h=m)}yield Ic(h)}return l})}function aE(n,e,t,r,i,o,a,s){let c=0,l,h=0,u=new Av,d={fromTotal:t,toTotal:r},p=le.start(o,Object.assign(Object.assign({eventName:"GetDeltas"},d),{reason:s})),m=new Ev(t,r,i,o,(x,b,_,O,S)=>v(this,null,function*(){return c++,Oj(E=>v(this,null,function*(){return n(b,_,E)}),Object.assign(Object.assign({request:x,from:b,to:_},d),S),O,o,a,s)}),x=>{l===void 0?w(x[0].sequenceNumber===t,621):w(x[0].sequenceNumber===l+1,622),l=x[x.length-1].sequenceNumber,w(l-x[0].sequenceNumber+1===x.length,623),h+=x.length,u.pushValue(x)}),f=x=>{m.cancel()};return a!==void 0&&a.addEventListener("abort",f),m.run(e).finally(()=>{a!==void 0&&a.removeEventListener("abort",f)}).then(()=>{let x={lastFetch:l,length:h,requests:c};m.canceled?p.cancel(Object.assign(Object.assign({},x),{error:"ops request cancelled by client"})):(w(r===void 0||l!==void 0&&l>=r-1,624),p.end(x)),u.pushDone()}).catch(x=>{p.cancel({lastFetch:l,length:h,requests:c},x),u.pushError(x)}),u}var sE={read:()=>v(void 0,null,function*(){return{done:!0}})};var Du=class extends xi{constructor(){super(...arguments),this.prefetchCache=new Map,this.prefetchEnabled=!0}get policies(){let e=this.internalStorageService.policies;if(e)return Object.assign(Object.assign({},e),{caching:Ai.NoCaching})}getSnapshotTree(e){return v(this,null,function*(){let t=this.internalStorageService.getSnapshotTree(e);return this.prefetchEnabled&&t.then(r=>{r!=null&&this.prefetchTree(r)}),t})}readBlob(e){return v(this,null,function*(){return this.cachedRead(e)})}stopPrefetch(){this.prefetchEnabled=!1,this.prefetchCache.clear()}cachedRead(e){return v(this,null,function*(){if(this.prefetchEnabled){let t=this.prefetchCache.get(e);if(t!==void 0)return t;let r=this.internalStorageService.readBlob(e);return this.prefetchCache.set(e,r.catch(i=>{throw Er(i)&&this.prefetchCache.delete(e),i})),r}return this.internalStorageService.readBlob(e)})}prefetchTree(e){let t=[];this.prefetchTreeCore(e,t);for(let r of t)this.cachedRead(r)}prefetchTreeCore(e,t){for(let r of Object.keys(e.blobs)){let i=e.blobs[r];r.startsWith(".")||r==="header"||r.startsWith("quorum")?i!==null&&this.cachedRead(i):r.startsWith("deltas")||i!==null&&t.push(i)}for(let r of Object.keys(e.trees))this.prefetchTreeCore(e.trees[r],t)}};Y();var Ri=class{constructor(e){this.maxRequests=e,this.tasks=[],this.release=()=>{let t=this.tasks.shift();if(t!==void 0)return t();this.maxRequests++},w(e>0,174)}get waitQueueLength(){return this.tasks.length}acquire(){return v(this,null,function*(){if(this.maxRequests>0){this.maxRequests--;return}return new Promise(e=>{this.tasks.push(e)})})}schedule(e){return v(this,null,function*(){return yield this.acquire(),e().finally(this.release)})}};Y();function Ra(n,e,t,r){return v(this,null,function*(){var i,o;let a,s=!1,c=1e3,l=0,h=de.now(),u;do try{a=yield n(r.cancel),s=!0}catch(d){if(!Er(d))throw t.sendTelemetryEvent({eventName:`${e}_cancel`,retry:l,duration:de.now()-h,fetchCallName:e},d),d;if(((i=r.cancel)===null||i===void 0?void 0:i.aborted)===!0)throw t.sendTelemetryEvent({eventName:`${e}_runWithRetryAborted`,retry:l,duration:de.now()-h,fetchCallName:e},d),new Wr("runWithRetry was Aborted",$t.genericError,{driverVersion:ku,fetchCallName:e});l++,u=d,c=(o=_o(d))!==null&&o!==void 0?o:Math.min(c*2,8e3),r.onRetry&&r.onRetry(c,d),yield ic(c)}while(!s);return l>0&&t.sendTelemetryEvent({eventName:`${e}_lastError`,retry:l,duration:de.now()-h,fetchCallName:e},u),a})}Y();var kv=class{constructor(e){this.props=e,this.attachmentCounter=0,this.summaryTree={}}get summary(){var e;return{type:_i.Tree,tree:Object.assign({},this.summaryTree),unreferenced:(e=this.props)===null||e===void 0?void 0:e.unreferenced}}addBlob(e,t){this.summaryTree[e]={type:_i.Blob,content:t}}addHandle(e,t,r){this.summaryTree[e]={type:_i.Handle,handleType:t,handle:r}}addTree(e,t){this.summaryTree[e]=t}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:_i.Attachment}}};function Dv(n,e){let t=new kv({unreferenced:n.unreferenced});for(let[r,i]of Object.entries(n.blobs)){let o=e.get(i);w(o!==void 0,733),t.addBlob(r,Wt.from(o).toString("utf-8"))}for(let[r,i]of Object.entries(n.trees)){let o=Dv(i,e);t.addTree(r,o)}return t.summary}function cE(n){if(Ni(n))return!0;switch(n.type){case lo.Propose:case lo.Reject:case lo.NoOp:return!0;default:return!1}}function Ni(n){return n.type===lo.Operation||n.type===lo.Summarize}var lE=function(n){return n.FluidDataStoreOp="component",n.Attach="attach",n.ChunkedOp="chunkedOp",n.BlobAttach="blobAttach",n.Rejoin="rejoin",n.Alias="alias",n.Operation="op",n}(lE||{});function yo(n){return!!Object.values(lE).includes(n.type)}vt();Y();qt();Y();Oe();qt();Oe();var _n=class extends Be{constructor(e,t,r){super(e,r,new Set(["error"])),this.error=t,this.errorType=ji.genericError}},Gu=class n extends Be{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=ji.throttlingError}static wrap(e,t,r){return vc(e,o=>new n(o,t),r)}},ye=class extends Be{constructor(e){super(e,{usageError:!0}),this.errorType="usageError"}},Wu=class extends Be{constructor(e,t){super(e,{timeoutMs:t}),this.expiryMs=t,this.errorType=ji.clientSessionExpiredError}},Xt=class extends Be{constructor(e,t){super(e,Object.assign(Object.assign({},t),{dataProcessingError:1})),this.errorType=ji.dataCorruptionError,this.canRetry=!1}},Ot=class n extends Be{constructor(e){super(e),this.errorType=ji.dataProcessingError,this.canRetry=!1}static create(e,t,r,i={}){let o=n.wrapIfUnrecognized(e,t,r);return o.addTelemetryProperties(i),o}static wrapIfUnrecognized(e,t,r){let i=Object.assign({dataProcessingError:1,dataProcessingCodepath:t},r===void 0?void 0:ur(r)),o=cn(e,{props:i});if(!Wd(o))return o;let a=Pi(o,s=>new n(s));return a.addTelemetryProperties(o.getTelemetryProperties()),a}},ur=n=>({messageClientId:n.clientId,messageSequenceNumber:n.sequenceNumber,messageClientSequenceNumber:n.clientSequenceNumber,messageReferenceSequenceNumber:n.referenceSequenceNumber,messageMinimumSequenceNumber:n.minimumSequenceNumber,messageTimestamp:n.timestamp});var lt=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(lt||{});var Dr=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Dr||{});var hr=Ce(Ln());vt();ja();Nt();qt();vt();var Ku=class{constructor(e,t,r){this.path=e,this.runtime=t,this.routeContext=r,this.absolutePath=cr(e,this.routeContext)}get IFluidHandleContext(){return this}attachGraph(){throw new Error("can't attach container runtime form within container!")}get isAttached(){return this.runtime.attachState!==oe.Detached}resolveHandle(e){return v(this,null,function*(){return this.runtime.resolveHandle(e)})}};var Kr=class{constructor(e){this.map=new Map;for(let t of e){if(this.map.has(t[0]))throw new ye("Duplicate entry names exist");this.map.set(t[0],t[1])}}get IFluidDataStoreRegistry(){return this}get(e){return v(this,null,function*(){if(this.map.has(e))return this.map.get(e)})}};var uA=Ce(fi());Y();qt();vt();Oe();Y();var Jt="summarizer",$u=(()=>{class n extends Pe{constructor(t,r,i,o,a){super(),this.logger=t,this.summaryCollection=r,this.clientElection=i,this.maxOpsSinceLastSummary=o,this.electionEnabled=a,this.lastReportedSeq=0,this.summaryCollection.on("default",({sequenceNumber:s})=>{var c,l,h;let u=this.electedClientId;if(u===void 0){this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(s);return}let d=this.clientElection.electionSequenceNumber;if(s-((c=this.lastSummaryAckSeqForClient)!==null&&c!==void 0?c:d)>this.maxOpsSinceLastSummary){let m=s-this.lastReportedSeq;if(m>this.maxOpsSinceLastSummary&&(this.logger.sendErrorEvent({eventName:"ElectedClientNotSummarizing",electedClientId:u,lastSummaryAckSeqForClient:this.lastSummaryAckSeqForClient,electionSequenceNumber:d,nextElectedClientId:(l=this.clientElection.peekNextElectedClient())===null||l===void 0?void 0:l.clientId,electionEnabled:this.electionEnabled}),this.lastReportedSeq=s),this.electionEnabled){let f=this.electedParentId;this.clientElection.incrementElectedClient(s),d=this.clientElection.electionSequenceNumber,s>((h=this.lastSummaryAckSeqForClient)!==null&&h!==void 0?h:d)&&m>this.maxOpsSinceLastSummary&&this.logger.sendErrorEvent({eventName:"UnexpectedElectionSequenceNumber",lastSummaryAckSeqForClient:this.lastSummaryAckSeqForClient,electionSequenceNumber:d,sequenceNumber:s,previousClientId:u,previousParentId:f,electedParentId:this.electedParentId,electedClientId:this.electedClientId,opsSinceLastReport:m,maxOpsSinceLastSummary:o})}}}),this.summaryCollection.on(lt.SummaryAck,s=>{this.lastSummaryAckSeqForClient=s.sequenceNumber}),this.clientElection.on("election",(s,c)=>{this.lastSummaryAckSeqForClient=void 0,s===void 0&&this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(c),this.emit("electedSummarizerChanged")})}get electedClientId(){var t;return(t=this.clientElection.electedClient)===null||t===void 0?void 0:t.clientId}get electedParentId(){var t;return(t=this.clientElection.electedParent)===null||t===void 0?void 0:t.clientId}serialize(){var t;let{electedClientId:r,electedParentId:i,electionSequenceNumber:o}=this.clientElection.serialize();return{electedClientId:r,electedParentId:i,electionSequenceNumber:(t=this.lastSummaryAckSeqForClient)!==null&&t!==void 0?t:o}}static isClientEligible(t){let r=t.client.details;return r===void 0?!0:n.clientDetailsPermitElection(r)}}return n.clientDetailsPermitElection=e=>e.capabilities.interactive||e.type===Jt,n})();qt();Y();Oe();var Gv=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Gv||{});var kn=Ce(Ln());vt();ja();Nt();vt();Y();var Xu=class{constructor(e,t,r,i,o){this.objectId=e,this._connected=t,this.submit=r,this.dirty=i,this.addedGCOutboundReference=o}get handler(){return w(!!this._handler,375),this._handler}get connected(){return this._connected}attach(e){w(this._handler===void 0,376),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}process(e,t,r){try{this.handler.process(e,t,r)}catch(i){throw Ot.wrapIfUnrecognized(i,"channelDeltaConnectionFailedToProcessMessage",e)}}reSubmit(e,t){this.handler.reSubmit(e,t)}rollback(e,t){if(this.handler.rollback===void 0)throw new Error("Handler doesn't support rollback");this.handler.rollback(e,t)}applyStashedOp(e){return this.handler.applyStashedOp(e)}};vt();var Ju=class n{constructor(e,t,r,i){this.tree=e,this.storage=t,this.logger=r,this.extraBlobs=i,this.flattenedTree={},e!==void 0&&n.flattenTree("",e,this.flattenedTree)}static flattenTree(e,t,r){for(let i in t.trees)n.flattenTree(`${e}${i}/`,t.trees[i],r);for(let i in t.blobs)r[`${e}${i}`]=t.blobs[i]}contains(e){return v(this,null,function*(){return this.flattenedTree[e]!==void 0})}readBlob(e){return v(this,null,function*(){let t=yield this.getIdForPath(e),r=this.extraBlobs!==void 0?this.extraBlobs.get(t):void 0;if(r!==void 0)return r;let i=this.storage.readBlob(t);return i.catch(o=>this.logger.sendErrorEvent({eventName:"ChannelStorageBlobError"},o)),i})}list(e){return v(this,null,function*(){var t;let r=this.tree,i=Tu(e);for(;r!==void 0&&i.length>0;){let o=i.shift();r=r.trees[o]}if(r===void 0||i.length!==0)throw new Error("path does not exist");return Object.keys((t=r?.blobs)!==null&&t!==void 0?t:{})})}getIdForPath(e){return v(this,null,function*(){return this.flattenedTree[e]})}};var Uc=".attributes";function Gc(n,e,t,r,i,o,a,s,c){let l=new Xu(n,e,(u,d)=>t(u,d),r,i),h=new Ju(s,o,a,c);return{deltaConnection:l,objectStorage:h}}function Qu(n,e=!1,t=!1,r){let i=n.getAttachSummary(e,t,r);return En(i,Uc,JSON.stringify(n.attributes)),i}function Yu(n,e=!1,t=!1,r){return v(this,null,function*(){let i=yield n.summarize(e,t,r);return En(i,Uc,JSON.stringify(n.attributes)),i})}var aA=Ce(Td());Y();var Ha=class{constructor(e,t,r,i){this.id=e,this.registry=t,this.runtime=r,this.servicesGetter=i,this.globallyVisible=!1,this.pending=[],w(!this.id.includes("/"),783)}getChannel(){return v(this,null,function*(){return w(this.channel!==void 0,519),this.channel})}get isLoaded(){return this.channel!==void 0}setConnectionState(e,t){this.globallyVisible&&this.isLoaded&&this.servicesGetter().value.deltaConnection.setConnectionState(e)}processOp(e,t,r){w(this.globallyVisible,723),this.isLoaded?this.servicesGetter().value.deltaConnection.process(e,t,r):(w(t===!1,393),this.pending.push(e))}reSubmit(e,t){w(this.isLoaded,394),w(this.globallyVisible,724),this.servicesGetter().value.deltaConnection.reSubmit(e,t)}rollback(e,t){w(this.isLoaded,750),w(this.globallyVisible,751),this.servicesGetter().value.deltaConnection.rollback(e,t)}applyStashedOp(){throw new Error("no stashed ops on local channel")}summarize(e=!1,t=!1,r){return v(this,null,function*(){return w(this.isLoaded&&this.channel!==void 0,396),Yu(this.channel,e,t,r)})}getAttachSummary(e){return w(this.isLoaded&&this.channel!==void 0,397),Qu(this.channel,!0,!1,e)}makeVisible(){if(this.globallyVisible)throw new Error("Channel is already globally visible");this.isLoaded&&(w(!!this.channel,402),this.channel.connect(this.servicesGetter().value)),this.globallyVisible=!0}getGCData(e=!1){return v(this,null,function*(){return w(this.isLoaded&&this.channel!==void 0,403),this.channel.getGCData(e)})}updateUsedRoutes(e,t){}},Zu=class extends Ha{constructor(e,t,r,i,o,a,s,c,l,h){super(e,t,r,()=>this.services),this.snapshotTree=h;let u=new Map,d=(0,aA.default)(this.snapshotTree);this.isSnapshotInOldFormatAndCollectBlobs(d,u)&&this.sanitizeSnapshot(d),this.services=new On(()=>Gc(this.id,i.connected,s,this.dirtyFn,l,o,a,d,u)),this.dirtyFn=()=>{c(e)}}getChannel(){return v(this,null,function*(){return this.channel===void 0&&(this.channel=yield this.loadChannel().catch(e=>{throw Ot.wrapIfUnrecognized(e,"rehydratedLocalChannelContextFailedToLoadChannel",void 0)})),this.channel})}loadChannel(){return v(this,null,function*(){w(!this.isLoaded,398),w(yield this.services.value.objectStorage.contains(".attributes"),400);let e=yield Ze(this.services.value.objectStorage,".attributes");if(w(this.factory===void 0,520),this.factory=this.registry.get(e.type),this.factory===void 0)throw new Error(`Channel Factory ${e.type} not registered`);let t=yield this.factory.load(this.runtime,this.id,this.services.value,e);this.channel=t;for(let r of this.pending)this.services.value.deltaConnection.process(r,!1,void 0);return this.channel})}isSnapshotInOldFormatAndCollectBlobs(e,t){let r=!1,i=e.blobsContents;Object.entries(i).forEach(([o,a])=>{t.set(o,a),e.blobs[o]!==void 0&&(r=!0)});for(let o of Object.values(e.trees))r=r||this.isSnapshotInOldFormatAndCollectBlobs(o,t);return r}sanitizeSnapshot(e){let t=new Map(Object.entries(e.blobs));for(let[r,i]of t.entries())t.get(i)===void 0&&delete e.blobs[r];for(let r of Object.values(e.trees))this.sanitizeSnapshot(r)}},eh=class extends Ha{constructor(e,t,r,i,o,a,s,c,l,h){if(super(e,t,i,()=>this.services),w(r!==void 0,521),this.factory=t.get(r),this.factory===void 0)throw new Error(`Channel Factory ${r} not registered`);this.channel=this.factory.create(i,e),this.services=new On(()=>Gc(this.id,o.connected,c,this.dirtyFn,h,a,s)),this.dirtyFn=()=>{l(e)}}};Y();Oe();var Wv=(()=>{class n{constructor(t,r,i,o,a,s,c,l,h,u,d,p,m){this.runtime=t,this.dataStoreContext=r,this.id=c,this.registry=h,this.attachMessageType=m,this.isLoaded=!1,this.pending=[],w(!this.id.includes("/"),784),this.subLogger=ue.create(this.runtime.logger,"RemoteChannelContext"),this.services=Gc(this.id,this.dataStoreContext.connected,o,()=>a(this.id),s,i,this.subLogger,l,u);let f=(x,b,_)=>v(this,null,function*(){return this.summarizeInternal(x,b,_)});this.summarizerNode=d(f,x=>v(this,null,function*(){return this.getGCDataInternal(x)}),()=>v(this,null,function*(){return p()})),this.thresholdOpsCounter=new go(n.pendingOpsCountThreshold,this.subLogger)}getChannel(){return this.channelP===void 0&&(this.channelP=this.loadChannel()),this.channelP}setConnectionState(t,r){this.isLoaded&&this.services.deltaConnection.setConnectionState(t)}applyStashedOp(t){return w(this.isLoaded,404),this.services.deltaConnection.applyStashedOp(t)}processOp(t,r,i){this.summarizerNode.invalidate(t.sequenceNumber),this.isLoaded?this.services.deltaConnection.process(t,r,i):(w(!r,405),w(this.pending!==void 0,574),this.pending.push(t),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length))}reSubmit(t,r){w(this.isLoaded,406),this.services.deltaConnection.reSubmit(t,r)}rollback(t,r){w(this.isLoaded,752),this.services.deltaConnection.rollback(t,r)}summarize(t=!1,r=!0,i){return v(this,null,function*(){return this.summarizerNode.summarize(t,r,i)})}summarizeInternal(t,r,i){return v(this,null,function*(){let o=yield this.getChannel(),a=yield Yu(o,t,r,i);return Object.assign(Object.assign({},a),{id:this.id})})}loadChannel(){return v(this,null,function*(){w(!this.isLoaded,407);let t;(yield this.services.objectStorage.contains(Uc))&&(t=yield Ze(this.services.objectStorage,Uc));let r;if(t===void 0){if(this.attachMessageType===void 0)throw new Xt("channelTypeNotAvailable",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/")});if(r=this.registry.get(this.attachMessageType),r===void 0)throw new Xt("channelFactoryNotRegisteredForAttachMessageType",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:this.attachMessageType});t=r.attributes}else if(r=this.registry.get(t.type),r===void 0)throw new Xt("channelFactoryNotRegisteredForGivenType",{channelId:{value:this.id,tag:Ne.PackageData},dataStoreId:{value:this.dataStoreContext.id,tag:Ne.PackageData},dataStorePackagePath:this.dataStoreContext.packagePath.join("/"),channelFactoryType:t.type});t.snapshotFormatVersion!==void 0&&t.snapshotFormatVersion!==r.attributes.snapshotFormatVersion&&this.subLogger.sendTelemetryEvent({eventName:"ChannelAttributesVersionMismatch",channelType:{value:t.type,tag:Ne.PackageData},channelSnapshotVersion:{value:`${t.snapshotFormatVersion}@${t.packageVersion}`,tag:Ne.PackageData},channelCodeVersion:{value:`${r.attributes.snapshotFormatVersion}@${r.attributes.packageVersion}`,tag:Ne.PackageData}});let i=yield r.load(this.runtime,this.id,this.services,t);w(this.pending!==void 0,575);for(let o of this.pending)this.services.deltaConnection.process(o,!1,void 0);return this.thresholdOpsCounter.send("ProcessPendingOps",this.pending.length),this.channel=i,this.pending=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(this.dataStoreContext.connected),this.channel})}getGCData(t=!1){return v(this,null,function*(){return this.summarizerNode.getGCData(t)})}getGCDataInternal(t=!1){return v(this,null,function*(){return(yield this.getChannel()).getGCData(t)})}updateUsedRoutes(t,r){this.summarizerNode.updateUsedRoutes([""])}}return n.pendingOpsCountThreshold=1e3,n})();var Vi=function(n){return n.Attach="attach",n.ChannelOp="op",n}(Vi||{}),Po=class n extends Pe{constructor(e,t,r){super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this._disposed=!1,this.contexts=new Map,this.contextsDeferred=new Map,this.pendingAttach=new Map,this.deferredAttached=new Ee,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.pendingHandlesToMakeVisible=new Set,w(!e.id.includes("/"),782),this.logger=ue.create(e.logger,"FluidDataStoreRuntime",{all:{dataStoreId:ke()}}),this.id=e.id,this.options=e.options,this.deltaManager=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();let i=e.baseSnapshot;this.channelsBaseGCDetails=new Rt(()=>v(this,null,function*(){var o,a,s;let c=yield(s=(a=(o=this.dataStoreContext).getBaseGCDetails)===null||a===void 0?void 0:a.call(o))!==null&&s!==void 0?s:this.dataStoreContext.getInitialGCSummaryDetails();return ju(c)})),i?.trees!==void 0&&Object.keys(i.trees).forEach(o=>{if(o==="_search")return;let a;e.isLocalDataStore?(a=new Zu(o,this.sharedObjectRegistry,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(c,l)=>this.submitChannelOp(o,c,l),c=>this.setChannelDirty(c),(c,l)=>this.addedGCOutboundReference(c,l),i.trees[o]),e.attachState!==oe.Detached?a.makeVisible():this.localChannelContextQueue.set(o,a)):a=new Wv(this,e,e.storage,(c,l)=>this.submitChannelOp(o,c,l),c=>this.setChannelDirty(c),(c,l)=>this.addedGCOutboundReference(c,l),o,i.trees[o],this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(o,{type:kn.CreateSummarizerNodeSource.FromSummary}),()=>v(this,null,function*(){return this.getChannelBaseGCDetails(o)}));let s=new Ee;s.resolve(a),this.contexts.set(o,a),this.contextsDeferred.set(o,s)}),this.attachListener(),this.bindState=r?xn.Bound:xn.NotBound,this._attachState=e.attachState,r?this.visibilityState=e.attachState===oe.Detached?kn.VisibilityState.LocallyVisible:kn.VisibilityState.GloballyVisible:this.visibilityState=kn.VisibilityState.NotVisible,r&&this.deferredAttached.resolve()}static load(e,t,r){return new n(e,t,r)}get IFluidRouter(){return this}get connected(){return this.dataStoreContext.connected}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.clientDetails}get isAttached(){return this.attachState!==oe.Detached}get attachState(){return this._attachState}get absolutePath(){return cr(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.IFluidHandleContext}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}resolveHandle(e){return v(this,null,function*(){return this.request(e)})}request(e){return v(this,null,function*(){try{let t=Sn.create(e),r=t.pathParts[0];if(r==="_channels"||r==="_custom")return this.request(t.createSubRequest(1));if(this.contextsDeferred.has(r)&&t.isLeaf(1))try{return{mimeType:"fluid/object",status:200,value:yield(yield this.contextsDeferred.get(r).promise).getChannel()}}catch(i){return this.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},i),Fu(500,`Failed to get Channel: ${i}`,e)}return Ft(e)}catch(t){return Bi(t)}})}getChannel(e){return v(this,null,function*(){return this.verifyNotClosed(),this.contextsDeferred.has(e)||this.contextsDeferred.set(e,new Ee),yield(yield this.contextsDeferred.get(e).promise).getChannel()})}createChannel(e=ke(),t){if(e.includes("/"))throw new ye(`Id cannot contain slashes: ${e}`);this.verifyNotClosed(),w(!this.contexts.has(e),377),this.notBoundedChannelContextSet.add(e);let r=new eh(e,this.sharedObjectRegistry,t,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(i,o)=>this.submitChannelOp(e,i,o),i=>this.setChannelDirty(i),(i,o)=>this.addedGCOutboundReference(i,o));if(this.contexts.set(e,r),this.contextsDeferred.has(e))this.contextsDeferred.get(e).resolve(r);else{let i=new Ee;i.resolve(r),this.contextsDeferred.set(e,i)}return w(!!r.channel,378),r.channel}bindChannel(e){if(w(this.notBoundedChannelContextSet.has(e.id),379),this.notBoundedChannelContextSet.delete(e.id),this.isAttached){this.attachChannel(e);return}this.pendingHandlesToMakeVisible.has(e.handle)||(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}makeVisibleAndAttachGraph(){this.visibilityState===kn.VisibilityState.NotVisible&&(this.visibilityState=kn.VisibilityState.LocallyVisible,this.pendingHandlesToMakeVisible.forEach(e=>{e.attachGraph()}),this.pendingHandlesToMakeVisible.clear(),this.bindToContext())}attachGraph(){this.makeVisibleAndAttachGraph()}bindToContext(){this.bindState===xn.NotBound&&(this.bindState=xn.Binding,this.dataStoreContext.bindToContext(),this.bindState=xn.Bound)}bind(e){if(this.visibilityState!==kn.VisibilityState.NotVisible){e.attachGraph();return}this.pendingHandlesToMakeVisible.add(e)}setConnectionState(e,t){this.verifyNotClosed();for(let[,r]of this.contexts)r.setConnectionState(e,t);po(this.logger,this,e,t)}getQuorum(){return this.quorum}getAudience(){return this.audience}uploadBlob(e){return v(this,null,function*(){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e)})}process(e,t,r){this.verifyNotClosed();try{switch(e.type){case Vi.Attach:{let i=e.contents,o=i.id;if(t)w(this.pendingAttach.has(o),380),this.pendingAttach.delete(o);else{w(!this.contexts.has(o),381);let a=new Map,s=ru(i.snapshot.entries,a),c=new Wv(this,this.dataStoreContext,this.dataStoreContext.storage,(l,h)=>this.submitChannelOp(o,l,h),l=>this.setChannelDirty(l),(l,h)=>this.addedGCOutboundReference(l,h),o,s,this.sharedObjectRegistry,a,this.dataStoreContext.getCreateChildSummarizerNodeFn(o,{type:kn.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:i.snapshot}),()=>v(this,null,function*(){return this.getChannelBaseGCDetails(o)}),i.type);if(this.contexts.set(o,c),this.contextsDeferred.has(o))this.contextsDeferred.get(o).resolve(c);else{let l=new Ee;l.resolve(c),this.contextsDeferred.set(o,l)}}break}case Vi.ChannelOp:this.processChannelOp(e,t,r);break;default:}this.emit("op",e)}catch(i){throw Ot.wrapIfUnrecognized(i,"fluidDataStoreRuntimeFailedToProcessMessage",e)}}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}getOutboundRoutes(){let e=[];for(let[t]of this.contexts)e.push(`${this.absolutePath}/${t}`);return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}getGCData(e=!1){return v(this,null,function*(){let t=new Li;return yield Promise.all(Array.from(this.contexts).filter(([r,i])=>this.isChannelAttached(r)).map(o=>v(this,[o],function*([r,i]){let a=yield i.getGCData(e);t.prefixAndAddNodes(r,a.gcNodes)}))),this.updateGCNodes(t),t.getGCData()})}updateUsedRoutes(e,t){var r;let i=Vu(e);for(let[o]of i)w(this.contexts.has(o),382);for(let[o,a]of this.contexts)a.updateUsedRoutes((r=i.get(o))!==null&&r!==void 0?r:[],t)}addedGCOutboundReference(e,t){var r,i;(i=(r=this.dataStoreContext).addedGCOutboundReference)===null||i===void 0||i.call(r,e,t)}getChannelBaseGCDetails(e){return v(this,null,function*(){var t;let r=(yield this.channelsBaseGCDetails).get(e);return r===void 0?r={}:((t=r.gcData)===null||t===void 0?void 0:t.gcNodes)!==void 0&&HE(r.gcData.gcNodes,this.absolutePath),(r.usedRoutes===void 0||r.usedRoutes.length===0)&&(r.usedRoutes=[""]),r})}summarize(e=!1,t=!0,r){return v(this,null,function*(){let i=new Pt;return yield Promise.all(Array.from(this.contexts).filter(([o,a])=>{let s=this.isChannelAttached(o);return w(s,383),s}).map(s=>v(this,[s],function*([o,a]){let c=yield a.summarize(e,t,r);i.addWithStats(o,c)}))),i.getSummaryTree()})}getAttachSummary(e){this.attachGraph();let t=new Pt;for(let[r,i]of this.contexts){if(!(i instanceof Ha))throw new Be("Should only be called with local channel handles");if(!this.notBoundedChannelContextSet.has(r)){let o;if(i.isLoaded){let a=i.getAttachSummary(e);w(a.summary.type===Gv.Tree,384),o={stats:a.stats,summary:a.summary}}else w(!!this.dataStoreContext.baseSnapshot,385),o=qa(this.dataStoreContext.baseSnapshot.trees[r]);t.addWithStats(r,o)}}return t.getSummaryTree()}submitMessage(e,t,r){this.submit(e,t,r)}submitSignal(e,t){return this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t)}waitAttached(){return v(this,null,function*(){return this.deferredAttached.promise})}attachChannel(e){if(this.verifyNotClosed(),e.handle.isAttached)return;e.handle.attachGraph(),w(this.isAttached,386),w(this.visibilityState===kn.VisibilityState.GloballyVisible,720);let t=Qu(e,!0,!1),r=La(t.summary),i={id:e.id,snapshot:r,type:e.attributes.type};this.pendingAttach.set(e.id,i),this.submit(Vi.Attach,i),this.contexts.get(e.id).makeVisible()}submitChannelOp(e,t,r){let i={address:e,contents:t};this.submit(Vi.ChannelOp,i,r)}submit(e,t,r=void 0){this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,r)}reSubmit(e,t,r){switch(this.verifyNotClosed(),e){case Vi.ChannelOp:{let i=t,o=this.contexts.get(i.address);w(!!o,387),o.reSubmit(i.contents,r);break}case Vi.Attach:this.submit(e,t,r);break;default:mt(e)}}rollback(e,t,r){switch(this.verifyNotClosed(),e){case Vi.ChannelOp:{let i=t,o=this.contexts.get(i.address);w(!!o,749),o.rollback(i.contents,r);break}default:throw new Be(`Can't rollback ${e} message`)}}applyStashedOp(e){return v(this,null,function*(){let t=e,r=this.contexts.get(t.address);return w(!!r,388),yield r.getChannel(),r.applyStashedOp(t.contents)})}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}processChannelOp(e,t,r){this.verifyNotClosed();let i=e.contents,o=Object.assign(Object.assign({},e),{contents:i.contents}),a=this.contexts.get(i.address);return w(!!a,389),a.processOp(o,t,r),a}attachListener(){this.setMaxListeners(Number.MAX_SAFE_INTEGER),this.dataStoreContext.once("attaching",()=>{this.attachGraph(),this._attachState=oe.Attaching,w(this.visibilityState===kn.VisibilityState.LocallyVisible,721),this.visibilityState=kn.VisibilityState.GloballyVisible,this.localChannelContextQueue.forEach(e=>{e.makeVisible()}),this.localChannelContextQueue.clear(),this.deferredAttached.resolve(),this.emit("attaching")}),this.dataStoreContext.once("attached",()=>{w(this.visibilityState===kn.VisibilityState.GloballyVisible,722),this._attachState=oe.Attached,this.emit("attached")})}verifyNotClosed(){if(this._disposed)throw new Be("Runtime is closed")}},sA=(n,e=Po)=>class cA extends e{request(r){return v(this,null,function*(){let i=yield er(cA.prototype,this,"request").call(this,r);return i.status===404?n(r,this):i})}};vt();var Qn=class{constructor(e,t,r){this.value=e,this.path=t,this.routeContext=r,this.pendingHandlesToMakeVisible=new Set,this.locallyVisible=!1,this.absolutePath=cr(t,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return this.routeContext.isAttached}get visible(){return this.isAttached||this.locallyVisible}get(){return v(this,null,function*(){return this.value})}attachGraph(){this.visible||(this.locallyVisible=!0,this.pendingHandlesToMakeVisible.forEach(e=>{e.attachGraph()}),this.pendingHandlesToMakeVisible.clear(),this.routeContext.attachGraph())}bind(e){if(this.visible){e.attachGraph();return}this.pendingHandlesToMakeVisible.add(e)}};var th=class extends Qn{get(){return v(this,null,function*(){throw Error("Do not try to get a summarizer object from the handle. Reference it directly.")})}attach(){}bind(e){}};Y();Oe();Y();var nh=class{constructor(e,t){this.lastOpSequenceNumber=e,this._lastAttempt=t,this._lastSuccessfulSummary=Object.assign({},t)}get lastAttempt(){return this._lastAttempt}get lastSuccessfulSummary(){return this._lastSuccessfulSummary}updateWithLastSummaryAckInfo(e){this._lastAttempt=e,this._lastSuccessfulSummary=Object.assign({},e)}recordAttempt(e){this._lastAttempt={refSequenceNumber:e??this.lastOpSequenceNumber,summaryTime:Date.now()}}markLastAttemptAsSuccessful(){this._lastSuccessfulSummary=Object.assign({},this.lastAttempt)}},rh=class{constructor(e,t,r,i){this.heuristicData=e,this.configuration=t,this.trySummarize=r,this.logger=i,this.idleTimer=new fn(this.configuration.idleTime,()=>this.trySummarize("idle")),this.minOpsForLastSummaryAttempt=this.configuration.minOpsForLastSummaryAttempt}get opsSinceLastAck(){return this.heuristicData.lastOpSequenceNumber-this.heuristicData.lastSuccessfulSummary.refSequenceNumber}run(){let e=Date.now()-this.heuristicData.lastSuccessfulSummary.summaryTime,t=this.opsSinceLastAck;e>this.configuration.maxTime?(this.idleTimer.clear(),this.trySummarize("maxTime")):t>this.configuration.maxOps?(this.idleTimer.clear(),this.trySummarize("maxOps")):this.idleTimer.restart()}shouldRunLastSummary(){let e=this.opsSinceLastAck,t=this.minOpsForLastSummaryAttempt;return this.logger.sendTelemetryEvent({eventName:"ShouldRunLastSummary",opsSinceLastAck:e,minOpsForLastSummaryAttempt:t}),e>=t}dispose(){this.idleTimer.clear()}};Y();Oe();function ih(n,e,t){return v(this,null,function*(){let r=[n.then(i=>({result:"done",value:i})),e.then(({timerResult:i})=>({result:i}))];return t!==void 0&&r.push(t.waitCancelled.then(()=>({result:"cancelled"}))),Promise.race(r)})}var lA=2e4,Nj=5,dA={submitSummaryFailure:"Error while generating, uploading, or submitting summary",summaryOpWaitTimeout:"Timeout while waiting for summarize op broadcast",summaryAckWaitTimeout:"Timeout while waiting for summaryAck/summaryNack op",summaryNack:"Server rejected summary via summaryNack op",disconnect:"Summary cancelled due to summarizer or main client disconnect"},$r=class{constructor(){this.summarySubmitted=new Ee,this.summaryOpBroadcasted=new Ee,this.receivedSummaryAckOrNack=new Ee}fail(e,t,r,i){w(!this.receivedSummaryAckOrNack.isCompleted,606);let o={success:!1,message:e,data:void 0,error:t,retryAfterSeconds:i};this.summarySubmitted.resolve(o),this.summaryOpBroadcasted.resolve(o),this.receivedSummaryAckOrNack.resolve(Object.assign(Object.assign({},o),{data:r}))}build(){return{summarySubmitted:this.summarySubmitted.promise,summaryOpBroadcasted:this.summaryOpBroadcasted.promise,receivedSummaryAckOrNack:this.receivedSummaryAckOrNack.promise}}},oh=class{constructor(e,t,r,i,o,a,s){this.pendingAckTimer=e,this.heuristicData=t,this.submitSummaryCallback=r,this.raiseSummarizingError=i,this.successfulSummaryCallback=o,this.summaryWatcher=a,this.logger=s,this.summarizeTimer=new fn(lA,()=>this.summarizeTimerHandler(lA,1))}summarize(e,t,r,i=new $r){return this.summarizeCore(e,t,i,r).catch(o=>{let a="UnexpectedSummarizeError";this.logger.sendErrorEvent(Object.assign({eventName:a},e),o),i.fail(a,o)}),i.build()}summarizeCore(e,t,r,i){return v(this,null,function*(){let{refreshLatestAck:o,fullTree:a}=t,s=ue.create(this.logger,void 0,{all:e}),c=Date.now()-this.heuristicData.lastAttempt.summaryTime,l=Date.now()-this.heuristicData.lastSuccessfulSummary.summaryTime,h={fullTree:a,timeSinceLastAttempt:c,timeSinceLastSummary:l},u=le.start(s,Object.assign({eventName:"Summarize",refreshLatestAck:o},h)),d=f=>`${f}: ${dA[f]}`,p=(f,x,b,_)=>{this.raiseSummarizingError(dA[f]);let O=Sv(x),S=i.cancelled||x?.errorType===$t.offlineError?"generic":"error";u.cancel(Object.assign(Object.assign({},b),{reason:f,category:S,retryAfterSeconds:O}),x),r.fail(d(f),x,_,O)};this.summarizeTimer.start();let m;try{m=yield this.submitSummaryCallback({fullTree:a,refreshLatestAck:o,summaryLogger:s,cancellationToken:i});let f=m.referenceSequenceNumber,x=f-this.heuristicData.lastSuccessfulSummary.refSequenceNumber;if(h=Object.assign(Object.assign({},h),{referenceSequenceNumber:f,minimumSequenceNumber:m.minimumSequenceNumber,opsSinceLastAttempt:f-this.heuristicData.lastAttempt.refSequenceNumber,opsSinceLastSummary:x}),m.stage!=="base"&&(h=Object.assign(Object.assign(Object.assign({},h),m.summaryStats),{generateDuration:m.generateDuration}),m.stage!=="generate"&&(h=Object.assign(Object.assign({},h),{handle:m.handle,uploadDuration:m.uploadDuration}),m.stage!=="upload"&&(h=Object.assign(Object.assign({},h),{clientSequenceNumber:m.clientSequenceNumber})))),m.stage!=="submit")return p("submitSummaryFailure",m.error,h);if(!a&&!m.forcedFullTree){let{summarizedDataStoreCount:b,gcStateUpdatedDataStoreCount:_=0}=m.summaryStats;b>_+x&&s.sendErrorEvent({eventName:"IncrementalSummaryViolation",summarizedDataStoreCount:b,gcStateUpdatedDataStoreCount:_,opsSinceLastSummary:x})}u.reportEvent("generate",Object.assign({},h)),r.summarySubmitted.resolve({success:!0,data:m})}catch(f){return p("submitSummaryFailure",f)}finally{this.heuristicData.recordAttempt(m?.referenceSequenceNumber),this.summarizeTimer.clear()}try{let f=this.pendingAckTimer.start(),x=this.summaryWatcher.watchSummary(m.clientSequenceNumber),b=yield ih(x.waitBroadcast(),f,i);if(b.result==="cancelled")return p("disconnect");if(b.result!=="done")return p("summaryOpWaitTimeout");let _=b.value,O=Date.now()-this.heuristicData.lastAttempt.summaryTime;r.summaryOpBroadcasted.resolve({success:!0,data:{summarizeOp:_,broadcastDuration:O}}),this.heuristicData.lastAttempt.summarySequenceNumber=_.sequenceNumber,s.sendTelemetryEvent({eventName:"Summarize_Op",duration:O,referenceSequenceNumber:_.referenceSequenceNumber,summarySequenceNumber:_.sequenceNumber,handle:_.contents.handle});let S=yield ih(x.waitAckNack(),f,i);if(S.result==="cancelled")return p("disconnect");if(S.result!=="done")return p("summaryAckWaitTimeout");let E=S.value;this.pendingAckTimer.clear();let F=Date.now()-this.heuristicData.lastAttempt.summaryTime;if(h=Object.assign({ackWaitDuration:F,ackNackSequenceNumber:E.sequenceNumber,summarySequenceNumber:E.contents.summaryProposal.summarySequenceNumber},h),E.type===lt.SummaryAck)this.heuristicData.markLastAttemptAsSuccessful(),this.successfulSummaryCallback(),u.end(Object.assign(Object.assign({},h),{handle:E.contents.handle})),r.receivedSummaryAckOrNack.resolve({success:!0,data:{summaryAckOp:E,ackNackDuration:F}});else{w(E.type===lt.SummaryNack,628);let I=E.contents,y=I?.message,P=I?.retryAfter,C=new Be(`Received summaryNack: ${y}`,{retryAfterSeconds:P});return w(Sv(C)===P,607),p("summaryNack",C,Object.assign(Object.assign({},h),{nackRetryAfter:P}),{summaryNackOp:E,ackNackDuration:F})}}finally{this.pendingAckTimer.clear()}})}summarizeTimerHandler(e,t){if(this.logger.sendPerformanceEvent({eventName:"SummarizeTimeout",timeoutTime:e,timeoutCount:t}),t<Nj){let r=e*2;this.summarizeTimer.start(r,()=>this.summarizeTimerHandler(r,t+1))}}dispose(){this.summarizeTimer.clear()}};var Kv=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t},Bj=10*60*1e3,ah=class n{constructor(e,t,r,i,o,a,s,c,l){this.summaryWatcher=t,this.configuration=r,this.submitSummaryCallback=i,this.heuristicData=o,this.raiseSummarizingError=a,this.summaryCollection=s,this.cancellationToken=c,this.stopSummarizerCallback=l,this.stopping=!1,this._disposed=!1,this.tryWhileSummarizing=!1,this.summarizeCount=0,this.totalSuccessfulAttempts=0,this.tryGetCorrelatedLogger=d=>this.heuristicData.lastAttempt.refSequenceNumber===d?this.logger:void 0;let h={summarizeCount:()=>this.summarizeCount,summarizerSuccessfulAttempts:()=>this.totalSuccessfulAttempts};this.logger=ue.create(e,"Running",{all:h}),r.state!=="disableHeuristics"&&(w(this.configuration.state==="enabled",746),this.heuristicRunner=new rh(o,this.configuration,d=>this.trySummarize(d),this.logger)),w(this.configuration.state!=="disabled",747);let u=Math.min(this.configuration.maxAckWaitTime,Bj);this.pendingAckTimer=new rc(u,()=>{this.raiseSummarizingError("Pending summary ack not received in time"),this.logger.sendErrorEvent({eventName:"SummaryAckWaitTimeout",maxAckWaitTime:u,referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber,timePending:Date.now()-this.heuristicData.lastAttempt.summaryTime})}),s.setPendingAckTimerTimeoutCallback(u,()=>{this.pendingAckTimer.hasTimer&&(this.logger.sendTelemetryEvent({eventName:"MissingSummaryAckFoundByOps",referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber}),this.pendingAckTimer.clear())}),this.generator=new oh(this.pendingAckTimer,this.heuristicData,this.submitSummaryCallback,this.raiseSummarizingError,()=>{this.totalSuccessfulAttempts++},this.summaryWatcher,this.logger)}static start(e,t,r,i,o,a,s,c,l){return v(this,null,function*(){var h;let u=new n(e,t,r,i,o,a,s,c,l);return yield u.waitStart(),(h=u.heuristicRunner)===null||h===void 0||h.run(),u})}get disposed(){return this._disposed}dispose(){var e;this.summaryWatcher.dispose(),(e=this.heuristicRunner)===null||e===void 0||e.dispose(),this.heuristicRunner=void 0,this.generator.dispose(),this.pendingAckTimer.clear(),this.disposeEnqueuedSummary(),this._disposed=!0,this.stopping=!0}handleSystemOp(e){switch(e.type){case lt.ClientLeave:case lt.ClientJoin:case lt.Propose:{this.handleOp(void 0,e);return}default:return}}handleOp(e,{sequenceNumber:t,type:r,clientId:i,contents:o}){var a;e===void 0&&(this.heuristicData.lastOpSequenceNumber=t,this.tryRunEnqueuedSummary()||(a=this.heuristicRunner)===null||a===void 0||a.run())}waitStop(e){return v(this,null,function*(){var t;this.stopping||(this.stopping=!0,this.disposeEnqueuedSummary(),e&&(!((t=this.heuristicRunner)===null||t===void 0)&&t.shouldRunLastSummary())&&this.summarizingLock===void 0&&this.trySummarizeOnce({reason:"lastSummary"},{}),yield this.summarizingLock)})}waitStart(){return v(this,null,function*(){let e=yield ih(this.summaryWatcher.waitFlushed(),this.pendingAckTimer.start());this.pendingAckTimer.clear(),this.summaryCollection.unsetPendingAckTimerTimeoutCallback(),e.result==="done"&&e.value!==void 0&&this.heuristicData.updateWithLastSummaryAckInfo({refSequenceNumber:e.value.summaryOp.referenceSequenceNumber,summaryTime:Date.now(),summarySequenceNumber:e.value.summaryOp.sequenceNumber})})}lockedRefreshSummaryAckAction(e){return v(this,null,function*(){w(this.refreshSummaryAckLock===void 0,"Refresh Summary Ack - Caller is responsible for checking lock");let t=new Ee;return this.refreshSummaryAckLock=t.promise,e().finally(()=>{t.resolve(),this.refreshSummaryAckLock=void 0})})}lockedSummaryAction(e){return v(this,null,function*(){w(this.summarizingLock===void 0,603);let t=new Ee;return this.summarizingLock=t.promise,this.summarizeCount++,yield this.refreshSummaryAckLock,e().finally(()=>{var r;t.resolve(),this.summarizingLock=void 0;let i=this.tryWhileSummarizing;this.tryWhileSummarizing=!1,!this.stopping&&!this.tryRunEnqueuedSummary()&&i&&((r=this.heuristicRunner)===null||r===void 0||r.run())})})}trySummarizeOnce(e,t,r=this.cancellationToken,i=new $r){return this.lockedSummaryAction(()=>v(this,null,function*(){return this.generator.summarize(e,t,r,i).receivedSummaryAckOrNack})).catch(o=>{}),i.build()}trySummarize(e,t=this.cancellationToken){if(this.summarizingLock!==void 0){this.tryWhileSummarizing=!0;return}this.lockedSummaryAction(()=>v(this,null,function*(){let r=[{refreshLatestAck:!1,fullTree:!1},{refreshLatestAck:!0,fullTree:!1},{refreshLatestAck:!0,fullTree:!1,delaySeconds:120},{refreshLatestAck:!0,fullTree:!0,delaySeconds:600}],i,o=0,a=0,s;for(let c=0;c<r.length;){if(this.cancellationToken.cancelled||++o>1&&e==="lastSummary")return;a++;let l=r[c],{delaySeconds:h=0}=l,u=Kv(l,["delaySeconds"]),d=i??h,p=Object.assign({reason:e,summaryAttempts:o,summaryAttemptsPerPhase:a,summaryAttemptPhase:c+1},u);d>0&&(this.logger.sendPerformanceEvent(Object.assign({eventName:"SummarizeAttemptDelay",duration:d,summaryNackDelay:i!==void 0},p)),yield ic(d*1e3)),yield this.refreshSummaryAckLock;let f=yield this.generator.summarize(p,u,t).receivedSummaryAckOrNack;if(f.success)return;i=f.retryAfterSeconds,(i===void 0||a>1)&&(c++,a=0),s=f}this.logger.sendErrorEvent({eventName:"FailToSummarize",reason:e,message:s?.message},s?.error),this.stopSummarizerCallback("failToSummarize")})).catch(r=>{this.logger.sendErrorEvent({eventName:"UnexpectedSummarizeError"},r)})}summarizeOnDemand(e=new $r,t){var{reason:r}=t,i=Kv(t,["reason"]);if(this.stopping)return e.fail("RunningSummarizer stopped or disposed",void 0),e.build();if(this.summarizingLock!==void 0)throw new ye("Attempted to run an already-running summarizer on demand");return this.trySummarizeOnce({reason:`onDemand/${r}`},i,this.cancellationToken,e)}enqueueSummarize(e){var{reason:t,afterSequenceNumber:r=0,override:i=!1}=e,o=Kv(e,["reason","afterSequenceNumber","override"]);let a=`enqueue;${t}`,s=!1;if(this.enqueuedSummary!==void 0){if(!i)return{alreadyEnqueued:!0};this.enqueuedSummary.resultsBuilder.fail("Aborted; overridden by another enqueue summarize attempt",void 0),this.enqueuedSummary=void 0,s=!0}this.enqueuedSummary={reason:a,afterSequenceNumber:r,options:o,resultsBuilder:new $r};let c=this.enqueuedSummary.resultsBuilder.build();return this.tryRunEnqueuedSummary(),s?Object.assign(Object.assign({},c),{alreadyEnqueued:!0,overridden:!0}):c}tryRunEnqueuedSummary(){if(this.stopping)return this.disposeEnqueuedSummary(),!1;if(this.enqueuedSummary===void 0||this.heuristicData.lastOpSequenceNumber<this.enqueuedSummary.afterSequenceNumber||this.summarizingLock!==void 0)return!1;let{reason:e,resultsBuilder:t,options:r}=this.enqueuedSummary;return this.enqueuedSummary=void 0,this.trySummarizeOnce({reason:`enqueuedSummary/${e}`},r,this.cancellationToken,t),!0}disposeEnqueuedSummary(){this.enqueuedSummary!==void 0&&(this.enqueuedSummary.resultsBuilder.fail("RunningSummarizer stopped or disposed",void 0),this.enqueuedSummary=void 0)}};var qj="summarizingError",Wc=class n extends Be{constructor(e,t=!1){super(e),this.logged=t,this.errorType=qj,this.canRetry=!0}static wrap(e,t=!1,r){return vc(e,o=>new n(o,t),r)}},Lj=(n,e)=>new Wc(n,e),sh=class n extends uA.EventEmitter{constructor(e,t,r,i,o,a,s){super(),this.runtime=t,this.configurationGetter=r,this.internalsProvider=i,this.summaryCollection=a,this.runCoordinatorCreateFn=s,this._disposed=!1,this.starting=!1,this.stopDeferred=new Ee,this.summarizeOnDemand=(...c)=>{var l;try{if(this._disposed||!((l=this.runningSummarizer)===null||l===void 0)&&l.disposed)throw new ye("Summarizer is already disposed.");if(this.runtime.summarizerClientId!==void 0&&this.runtime.summarizerClientId!==this.runtime.clientId)throw new ye("On-demand summary attempted while an elected summarizer is present");let h=new $r;return this.runningSummarizer?this.runningSummarizer.summarizeOnDemand(h,...c):(this.runCoordinatorCreateFn(this.runtime).then(d=>{this.start(this.runtime.clientId,d).then(m=>v(this,null,function*(){m.summarizeOnDemand(h,...c);let f=yield Promise.race([this.stopDeferred.promise,d.waitCancelled]);yield m.waitStop(!1),d.stop(f),this.close()})).catch(m=>{h.fail("Failed to start summarizer",m)})}).catch(d=>{h.fail("Failed to create cancellation token",d)}),h.build())}catch(h){throw Wc.wrap(h,!1,this.logger)}},this.enqueueSummarize=(...c)=>{if(this._disposed||this.runningSummarizer===void 0||this.runningSummarizer.disposed)throw new ye("Summarizer is not running or already disposed.");return this.runningSummarizer.enqueueSummarize(...c)},this.logger=ue.create(this.runtime.logger,"Summarizer"),this.innerHandle=new th(this,e,o)}get IFluidLoadable(){return this}get ISummarizer(){return this}get handle(){return this.innerHandle}static create(e,t){return v(this,null,function*(){let r={headers:{[ct.cache]:!1,[ct.clientDetails]:{capabilities:{interactive:!1},type:Jt},[ki.summarizingClient]:!0,[ct.reconnect]:!1},url:t},i=yield e.resolve(r),o=yield Ar(i,{url:"_summarizer"});if(o.ISummarizer===void 0)throw new ye("Fluid object does not implement ISummarizer");return o.ISummarizer})}run(e){return v(this,null,function*(){try{return yield this.runCore(e)}catch(t){throw this.stop("summarizerException"),Wc.wrap(t,!1,this.logger)}finally{this.close()}})}stop(e){this.stopDeferred.resolve(e)}close(){this.dispose(),this.runtime.closeFn()}runCore(e){return v(this,null,function*(){let t=yield this.runCoordinatorCreateFn(this.runtime),r=Promise.race([t.waitCancelled,this.stopDeferred.promise]);if(r.then(a=>{this.logger.sendTelemetryEvent({eventName:"StoppingSummarizer",onBehalfOf:e,reason:a})}),t.cancelled)return t.waitCancelled;let i=yield this.start(e,t),o=yield r;return yield i.waitStop(!t.cancelled&&n.stopReasonCanRunLastSummary(o)),t.stop(o),o})}static stopReasonCanRunLastSummary(e){return e==="parentNotConnected"}start(e,t){return v(this,null,function*(){if(this.runningSummarizer){if(this.runningSummarizer.disposed)throw new ye("Starting a disposed summarizer");return this.runningSummarizer}if(this.starting)throw new ye("Attempting to start a summarizer that is already starting");this.starting=!0,this.logger.sendTelemetryEvent({eventName:"RunningSummarizer",onBehalfOf:e,initSummarySeqNumber:this.runtime.deltaManager.initialSequenceNumber,config:JSON.stringify(this.configurationGetter())});let r=this.runtime.clientId;if(r===void 0)throw new ye("clientId should be defined if connected.");let i=yield ah.start(this.logger,this.summaryCollection.createWatcher(r),this.configurationGetter(),(...o)=>v(this,null,function*(){return this.internalsProvider.submitSummary(...o)}),new nh(this.runtime.deltaManager.lastSequenceNumber,{refSequenceNumber:this.runtime.deltaManager.initialSequenceNumber,summaryTime:Date.now()}),o=>{this._disposed||this.logger.sendErrorEvent({eventName:"summarizingError"},Lj(o,!0))},this.summaryCollection,t,o=>t.stop(o));return this.runningSummarizer=i,this.starting=!1,this.handleSummaryAcks().catch(o=>{this.logger.sendErrorEvent({eventName:"HandleSummaryAckFatalError"},o)}),this.systemOpListener=o=>i.handleSystemOp(o),this.runtime.deltaManager.inbound.on("op",this.systemOpListener),this.opListener=(o,a)=>i.handleOp(o,a),this.runtime.on("batchEnd",this.opListener),i})}dispose(){this.stop("summarizerClientDisconnected"),this._disposed=!0,this.runningSummarizer&&(this.runningSummarizer.dispose(),this.runningSummarizer=void 0),this.systemOpListener&&this.runtime.deltaManager.inbound.off("op",this.systemOpListener),this.opListener&&this.runtime.removeListener("batchEnd",this.opListener)}handleSummaryAcks(){return v(this,null,function*(){var e,t,r,i,o;let a=this.runtime.deltaManager.initialSequenceNumber,s;for(;this.runningSummarizer;){let c=(e=this.runningSummarizer.tryGetCorrelatedLogger(a))!==null&&e!==void 0?e:this.logger;try{s=void 0,s=yield this.summaryCollection.waitSummaryAck(a),a=s.summaryOp.referenceSequenceNumber;let l=s.summaryOp.contents.handle,h=s.summaryAck.contents.handle;yield this.runningSummarizer.lockedRefreshSummaryAckAction(()=>v(this,null,function*(){return this.internalsProvider.refreshLatestSummaryAck(l,h,a,c).catch(u=>v(this,null,function*(){if(gc(u)&&u.errorType===$t.fileNotFoundOrAccessDeniedError)c.sendTelemetryEvent({eventName:"HandleSummaryAckErrorIgnored",referenceSequenceNumber:a,proposalHandle:l,ackHandle:h},u);else throw u}))}))}catch(l){c.sendErrorEvent({eventName:"HandleSummaryAckError",referenceSequenceNumber:a,handle:(r=(t=s?.summaryOp)===null||t===void 0?void 0:t.contents)===null||r===void 0?void 0:r.handle,ackHandle:(o=(i=s?.summaryAck)===null||i===void 0?void 0:i.contents)===null||o===void 0?void 0:o.handle},l)}a++}})}};Y();Oe();var jj=5e3,Vj=4e3,Qt=function(n){return n[n.Off=0]="Off",n[n.Starting=1]="Starting",n[n.Running=2]="Running",n[n.Stopping=3]="Stopping",n}(Qt||{}),hA=(()=>{class n{constructor(t,r,i,o,a,s,{initialDelayMs:c=jj,opsToBypassInitialDelay:l=Vj}={},h){this.clientElection=t,this.connectedState=r,this.summaryCollection=i,this.requestSummarizerFn=a,this.startThrottler=s,this.disableHeuristics=h,this.state=Qt.Off,this._disposed=!1,this.handleConnected=u=>{this.latestClientId=u,this.refreshSummarizer()},this.handleDisconnected=()=>{this.refreshSummarizer()},this.refreshSummarizer=()=>{let u=this.getShouldSummarizeState();switch(this.state){case Qt.Off:{u.shouldSummarize&&this.startSummarization();return}case Qt.Starting:return;case Qt.Running:{u.shouldSummarize===!1&&this.stop(u.stopReason);return}case Qt.Stopping:return;default:return}},this.summarizeOnDemand=(...u)=>{if(this.summarizer===void 0)throw Error("No running summarizer client");return this.summarizer.summarizeOnDemand(...u)},this.enqueueSummarize=(...u)=>{if(this.summarizer===void 0)throw Error("No running summarizer client");return this.summarizer.enqueueSummarize(...u)},this.logger=ue.create(o,"SummaryManager",{all:{clientId:()=>this.latestClientId}}),this.connectedState.on("connected",this.handleConnected),this.connectedState.on("disconnected",this.handleDisconnected),this.latestClientId=this.connectedState.clientId,this.opsToBypassInitialDelay=l,this.initialDelayMs=c}get disposed(){return this._disposed}get currentState(){return this.state}start(){this.clientElection.on("electedSummarizerChanged",this.refreshSummarizer),this.refreshSummarizer()}getShouldSummarizeState(){if(this.connectedState.clientId!==this.clientElection.electedParentId||this.state!==Qt.Running&&this.connectedState.clientId!==this.clientElection.electedClientId)return{shouldSummarize:!1,stopReason:"parentShouldNotSummarize"};if(this.connectedState.connected)if(this.disposed)w(!1,608);else return{shouldSummarize:!0};else return{shouldSummarize:!1,stopReason:"parentNotConnected"}}startSummarization(){w(this.state===Qt.Off,609),this.state=Qt.Starting,w(this.summarizer===void 0,610),this.delayBeforeCreatingSummarizer().then(t=>v(this,null,function*(){if(t&&this.getShouldSummarizeState().shouldSummarize===!1)return"early exit";w(this.state===Qt.Starting,611),this.state=Qt.Running;let r=yield this.requestSummarizerFn();this.summarizer=r;let i=this.getShouldSummarizeState();if(i.shouldSummarize===!1)return this.state=Qt.Starting,r.stop(i.stopReason),"early exit after starting summarizer";let o=this.latestClientId;return le.timedExecAsync(this.logger,{eventName:"RunningSummarizer",attempt:this.startThrottler.numAttempts},()=>v(this,null,function*(){return r.run(o,this.disableHeuristics)}))})).then(t=>{this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:t})}).catch(t=>{if(this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:"exception"},t),this.getShouldSummarizeState().shouldSummarize||this.summarizer!==void 0){let r=t?.errorType===$t.offlineError?"generic":"error";this.logger.sendTelemetryEvent({eventName:"SummarizerException",category:r},t)}}).finally(()=>{var t;w(this.state!==Qt.Off,612),this.state=Qt.Off,(t=this.summarizer)===null||t===void 0||t.close(),this.summarizer=void 0,this.getShouldSummarizeState().shouldSummarize&&this.startSummarization()})}stop(t){var r;n.isStartingOrRunning(this.state)&&(this.state=Qt.Stopping,(r=this.summarizer)===null||r===void 0||r.stop(t))}delayBeforeCreatingSummarizer(){return v(this,null,function*(){let t=this.startThrottler.getDelay();this.logger.sendTelemetryEvent({eventName:"CreatingSummarizer",throttlerDelay:t,initialDelay:this.initialDelayMs,startThrottlerMaxDelayMs:this.startThrottler.maxDelayMs,opsSinceLastAck:this.summaryCollection.opsSinceLastAck,opsToBypassInitialDelay:this.opsToBypassInitialDelay});let r=!1;if(this.summaryCollection.opsSinceLastAck<this.opsToBypassInitialDelay&&(r=!0,t=Math.max(t,this.initialDelayMs)),t>0){let i,o,a=()=>{this.summaryCollection.opsSinceLastAck>=this.opsToBypassInitialDelay&&(clearTimeout(i),o())},s=new Promise(l=>{i=setTimeout(()=>l(),t)}),c=new Promise(l=>{o=l});this.summaryCollection.addOpListener(a),yield Promise.race([s,c]),this.summaryCollection.removeOpListener(a)}return r})}dispose(){this.clientElection.off("electedSummarizerChanged",this.refreshSummarizer),this.connectedState.off("connected",this.handleConnected),this.connectedState.off("disconnected",this.handleDisconnected),this._disposed=!0}}return n.isStartingOrRunning=e=>e===Qt.Starting||e===Qt.Running,n})();Y();Oe();var pA=(()=>{class n{constructor(t,r){this.logger=r,this.processingTimeIncrement=10,this.currentAllowedProcessingTimeForTurn=n.processingTime,this.schedulingCount=0,this.deltaManager=t,this.deltaManager.inbound.on("idle",()=>{this.inboundQueueIdle()})}batchBegin(t){this.processingStartTime||(this.processingStartTime=de.now()),this.schedulingLog===void 0&&this.schedulingCount%500===0&&(this.schedulingLog={opsRemainingToProcess:0,numberOfTurns:1,totalProcessingTime:0,numberOfBatchesProcessed:0,firstSequenceNumber:t.sequenceNumber,lastSequenceNumber:t.sequenceNumber,startTime:de.now()})}batchEnd(t){if(this.schedulingLog&&(this.schedulingLog.numberOfBatchesProcessed++,this.schedulingLog.lastSequenceNumber=t.sequenceNumber,this.schedulingLog.opsRemainingToProcess=this.deltaManager.inbound.length),this.shouldRunScheduler()){let r=de.now(),i=r-this.processingStartTime;i>this.currentAllowedProcessingTimeForTurn&&(this.deltaManager.inbound.pause(),this.currentAllowedProcessingTimeForTurn+=this.processingTimeIncrement,this.schedulingLog&&(this.schedulingLog.numberOfTurns++,this.schedulingLog.totalProcessingTime+=i),setTimeout(()=>{this.schedulingLog&&this.logger.sendTelemetryEvent({eventName:"InboundOpsPartialProcessingTime",duration:at.formatTick(i),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,opsRemainingToProcess:this.deltaManager.inbound.length,processingTime:at.formatTick(this.schedulingLog.totalProcessingTime),numberOfTurns:this.schedulingLog.numberOfTurns,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,timeToResume:at.formatTick(de.now()-r)}),this.deltaManager.inbound.resume()}),this.processingStartTime=void 0)}}inboundQueueIdle(){if(this.schedulingLog){let t=de.now();this.schedulingLog.totalProcessingTime+=t-this.processingStartTime,this.logger.sendTelemetryEvent({eventName:"InboundOpsProcessingTime",opsRemainingToProcess:this.schedulingLog.opsRemainingToProcess,numberOfTurns:this.schedulingLog.numberOfTurns,processingTime:at.formatTick(this.schedulingLog.totalProcessingTime),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,duration:at.formatTick(t-this.schedulingLog.startTime),schedulingCount:this.schedulingCount}),this.schedulingLog=void 0}this.schedulingCount++,this.processingStartTime=void 0,this.currentAllowedProcessingTimeForTurn=n.processingTime}shouldRunScheduler(){return this.deltaManager.inbound.length>0}}return n.processingTime=50,n})();Oe();Y();var Xv=5e3,$v=class{constructor(e,t,r){this.clientId=e,this.deltaManager=t,this.pongCount=0,this.msnTrackingTimestamp=0,this.opProcessingTimes={},this.opPerfData={},this.firstConnection=!0,this.bootTime=de.now(),this.connectionStartTime=0,this.gap=0,this.logger=ue.create(r,"OpPerf"),this.deltaManager.on("pong",i=>this.recordPingTime(i)),this.deltaManager.on("submitOp",i=>this.beforeOpSubmit(i)),this.deltaManager.on("op",i=>this.afterProcessingOp(i)),this.deltaManager.on("connect",(i,o)=>{this.clientId=i.clientId,o!==void 0&&(this.connectionOpSeqNumber=this.deltaManager.lastKnownSeqNumber,this.gap=o,this.connectionStartTime=de.now(),this.gap<=0&&this.reportGettingUpToDate())}),this.deltaManager.on("disconnect",()=>{this.sequenceNumberForMsnTracking=void 0,this.clientSequenceNumberForLatencyStatistics=void 0,this.opProcessingTimes={},this.opPerfData={},this.connectionOpSeqNumber=void 0,this.firstConnection=!1,this.pongCount=0}),this.deltaManager.outbound.on("push",i=>{for(let o of i)o.type===lt.Operation&&this.clientSequenceNumberForLatencyStatistics===o.clientSequenceNumber&&(w(this.opProcessingTimes.outboundPushEventTime===void 0,712),w(this.opPerfData.durationNetwork===void 0,713),this.opProcessingTimes.outboundPushEventTime=Date.now(),w(this.opPerfData.durationOutboundBatching===void 0,714),w(this.opProcessingTimes.submitOpEventTime!==void 0,715),this.opPerfData.durationOutboundBatching=this.opProcessingTimes.outboundPushEventTime-this.opProcessingTimes.submitOpEventTime)}),this.deltaManager.inbound.on("push",i=>{this.clientId===i.clientId&&i.type===lt.Operation&&this.clientSequenceNumberForLatencyStatistics===i.clientSequenceNumber&&this.opProcessingTimes.outboundPushEventTime!==void 0&&(this.opProcessingTimes.inboundPushEventTime=Date.now(),this.opPerfData.durationNetwork=this.opProcessingTimes.inboundPushEventTime-this.opProcessingTimes.outboundPushEventTime,this.opProcessingTimes.outboundPushEventTime=void 0,this.opPerfData.lengthInboundQueue=this.deltaManager.inbound.length)}),this.deltaManager.inbound.on("idle",(i,o)=>{typeof i=="number"&&i>=100&&this.logger.sendPerformanceEvent({eventName:"GetDeltas_OpProcessing",count:i,duration:o})})}reportGettingUpToDate(){this.connectionOpSeqNumber=void 0,this.logger.sendPerformanceEvent({eventName:"ConnectionSpeed",duration:de.now()-this.connectionStartTime,ops:this.gap,timeToConnect:this.firstConnection?at.formatTick(this.connectionStartTime-this.bootTime):void 0,firstConnection:this.firstConnection})}recordPingTime(e){this.pingLatency=e,this.pongCount%100===0&&this.deltaManager.active&&this.logger.sendPerformanceEvent({eventName:"DeltaLatency",duration:e}),this.pongCount++}beforeOpSubmit(e){this.clientSequenceNumberForLatencyStatistics===void 0&&e.clientSequenceNumber%500===1&&(w(this.opProcessingTimes.outboundPushEventTime===void 0,716),w(this.opPerfData.durationNetwork===void 0,717),this.opProcessingTimes.submitOpEventTime=Date.now(),this.clientSequenceNumberForLatencyStatistics=e.clientSequenceNumber)}afterProcessingOp(e){let t=e.sequenceNumber;if(t===this.connectionOpSeqNumber&&this.reportGettingUpToDate(),this.sequenceNumberForMsnTracking===void 0&&t%1e3===0&&(this.sequenceNumberForMsnTracking=t,this.msnTrackingTimestamp=e.timestamp),this.sequenceNumberForMsnTracking!==void 0&&e.minimumSequenceNumber>=this.sequenceNumberForMsnTracking&&(w(this.msnTrackingTimestamp!==void 0,718),this.logger.sendPerformanceEvent({eventName:"MsnStatistics",sequenceNumber:t,msnDistance:t-this.sequenceNumberForMsnTracking,duration:e.timestamp-this.msnTrackingTimestamp}),this.sequenceNumberForMsnTracking=void 0),this.clientId===e.clientId&&this.clientSequenceNumberForLatencyStatistics===e.clientSequenceNumber){w(this.opProcessingTimes.submitOpEventTime!==void 0,288);let r=Date.now();this.opProcessingTimes.inboundPushEventTime!==void 0&&(this.opPerfData.durationInboundToProcessing=r-this.opProcessingTimes.inboundPushEventTime);let i=r-this.opProcessingTimes.submitOpEventTime,o=i>Xv?"error":"performance";this.logger.sendPerformanceEvent(Object.assign({eventName:"OpRoundtripTime",sequenceNumber:t,referenceSequenceNumber:e.referenceSequenceNumber,duration:i,category:o,pingLatency:this.pingLatency,msnDistance:this.deltaManager.lastSequenceNumber-this.deltaManager.minimumSequenceNumber},this.opPerfData)),this.clientSequenceNumberForLatencyStatistics=void 0,this.opPerfData={}}}};function gA(n,e,t){new $v(n,e,t)}Y();var ch=Ce(Ln());Oe();var Qv=Ce(Jv());var lh=class{constructor(e,t,r){var i;this.stateHandler=e,this.pendingStates=new Qv.default,this.disposeOnce=new On(()=>{this.initialStates.clear(),this.pendingStates.clear()}),this._pendingMessagesCount=0,this.isProcessingBatch=!1,this.dispose=()=>this.disposeOnce.value,this.initialStates=new Qv.default((i=r?.pendingStates)!==null&&i!==void 0?i:[]),this.flushModeForNextMessage=t,this.onFlushModeUpdated(t)}get pendingMessagesCount(){return this._pendingMessagesCount}hasPendingMessages(){return this._pendingMessagesCount!==0||!this.initialStates.isEmpty()}getLocalState(){if(w(this.initialStates.isEmpty(),745),this.hasPendingMessages())return{pendingStates:this.pendingStates.toArray().map(e=>e.type==="message"?Object.assign(Object.assign({},e),{localOpMetadata:void 0}):e)}}get disposed(){return this.disposeOnce.evaluated}onSubmitMessage(e,t,r,i,o,a){let s={type:"message",messageType:e,clientSequenceNumber:t,referenceSequenceNumber:r,content:i,localOpMetadata:o,opMetadata:a};this.pendingStates.push(s),this._pendingMessagesCount++}onFlushModeUpdated(e){this.pendingStates.push({type:"flushMode",flushMode:e})}onFlush(){if(this.stateHandler.flushMode()===ch.FlushMode.Immediate)return;let e=this.pendingStates.peekBack();e?.type==="message"&&this.pendingStates.push({type:"flush"})}applyStashedOpsAt(e){return v(this,null,function*(){for(;!this.initialStates.isEmpty();){let t=this.initialStates.peekFront();if(t.type==="message"){if(e!==void 0){if(t.referenceSequenceNumber>e)break;if(t.referenceSequenceNumber<e)throw new Error("loaded from snapshot too recent to apply stashed ops")}let r=yield this.stateHandler.applyStashedOp(t.messageType,t.content);t.localOpMetadata=r}this.pendingStates.push(this.initialStates.shift())}})}processPendingLocalMessage(e){this.maybeProcessBatchBegin(e);let t=this.peekNextPendingState();if(w(t.type==="message",361),this.pendingStates.shift(),t.clientSequenceNumber!==e.clientSequenceNumber){let r=Ot.create("pending local message clientSequenceNumber mismatch","unexpectedAckReceived",e,{expectedClientSequenceNumber:t.clientSequenceNumber});this.stateHandler.close(r);return}return this._pendingMessagesCount--,this.maybeProcessBatchEnd(e),t.localOpMetadata}maybeProcessBatchBegin(e){let t,r=!1,i=this.peekNextPendingState();for(;i.type!=="message";)i.type==="flushMode"&&(t=i.flushMode),i.type==="flush"&&(r=!0),this.pendingStates.shift(),i=this.peekNextPendingState();t!==void 0&&(this.flushModeForNextMessage=t),t!==ch.FlushMode.Immediate&&(t===ch.FlushMode.TurnBased||r)&&(w(!this.isProcessingBatch&&this.pendingBatchBeginMessage===void 0,363),this.pendingBatchBeginMessage=e,this.isProcessingBatch=!0)}maybeProcessBatchEnd(e){var t,r;if(!this.isProcessingBatch)return;let i=this.peekNextPendingState();if(i.type==="message")return;w(i.type!=="flushMode",701),w(this.pendingBatchBeginMessage!==void 0,365);let o=(t=this.pendingBatchBeginMessage.metadata)===null||t===void 0?void 0:t.batch;if(this.pendingBatchBeginMessage===e)w(o===void 0,366);else{let a=(r=e.metadata)===null||r===void 0?void 0:r.batch;w(o===!0,367),w(a===!1,368)}this.pendingBatchBeginMessage=void 0,this.isProcessingBatch=!1}checkpoint(){let e=this.pendingStates.peekBack();return{rollback:()=>{try{for(;this.pendingStates.peekBack()!==e;)this.rollbackNextPendingState()}catch(t){let r=Pi(t,i=>Ot.create(`RollbackError: ${i}`,"checkpointRollback",void 0));throw this.stateHandler.close(r),r}}}}peekNextPendingState(){let e=this.pendingStates.peekFront();return w(!!e,369),e}rollbackNextPendingState(){if(this.pendingStates.length===0)return;this._pendingMessagesCount--;let t=this.pendingStates.pop();switch(t.type){case"message":this.stateHandler.rollback(t.messageType,t.content,t.localOpMetadata);break;default:throw new Error(`Can't rollback state ${t.type}`)}}replayPendingStates(){w(this.stateHandler.connected(),370),w(this.clientId!==this.stateHandler.clientId(),371),this.clientId=this.stateHandler.clientId(),w(this.initialStates.isEmpty(),372);let e=this.pendingStates.length;if(e===0)return;this._pendingMessagesCount=0;let t=this.stateHandler.flushMode();for(this.stateHandler.setFlushMode(this.flushModeForNextMessage);e>0;){let r=this.pendingStates.shift();switch(r.type){case"message":this.stateHandler.reSubmit(r.messageType,r.content,r.localOpMetadata,r.opMetadata);break;case"flushMode":this.stateHandler.setFlushMode(r.flushMode);break;case"flush":this.stateHandler.flush();break;default:break}e--}this.stateHandler.setFlushMode(t)}};var Kc="1.4.0";vt();Y();qt();Oe();var dh=class{constructor(e,t,r){this.path=e,this.routeContext=t,this.get=r,this.attached=!1,this.absolutePath=cr(e,this.routeContext)}get IFluidHandle(){return this}get isAttached(){return this.attached}attachGraph(){this.attached=!0}bind(e){throw new Error("Cannot bind to blob handle")}},Ua=(()=>{class n{constructor(t,r,i,o,a,s,c){this.routeContext=t,this.getStorage=i,this.attachBlobCallback=o,this.gcNodeUpdated=a,this.runtime=s,this.logger=c,this.blobIds=new Set,this.pendingBlobIds=new Map,this.detachedBlobIds=new Set,this.runtime.once("dispose",()=>{for(let l of this.pendingBlobIds.values())l.reject(new Error("runtime disposed while blobAttach op in flight"))}),this.load(r)}hasBlob(t){return this.blobIds.has(t)||this.detachedBlobIds.has(t)}getBlobGCNodePath(t){return`/${n.basePath}/${t}`}getBlob(t){return v(this,null,function*(){var r,i;let o=(i=(r=this.redirectTable)===null||r===void 0?void 0:r.get(t))!==null&&i!==void 0?i:t;return w(this.hasBlob(o),287),this.gcNodeUpdated(this.getBlobGCNodePath(t)),new dh(`${n.basePath}/${o}`,this.routeContext,()=>v(this,null,function*(){return le.timedExecAsync(this.logger,{eventName:"AttachmentReadBlob",id:o},()=>v(this,null,function*(){return this.getStorage().readBlob(o)}),{end:!0,cancel:"error"})}))})}createBlob(t){return v(this,null,function*(){var r,i;this.runtime.attachState===oe.Attaching&&(this.logger.sendTelemetryEvent({eventName:"CreateBlobWhileAttaching"}),yield new Promise(s=>this.runtime.once("attached",s))),!this.runtime.connected&&this.runtime.attachState===oe.Attached&&(yield new Promise(s=>this.runtime.once("connected",s)));let o=yield le.timedExecAsync(this.logger,{eventName:"createBlob"},()=>v(this,null,function*(){return this.getStorage().createBlob(t)}),{end:!0,cancel:"error"}),a=new dh(`${n.basePath}/${o.id}`,this.routeContext,()=>v(this,null,function*(){return this.getBlob(o.id).then(s=>v(this,null,function*(){return s.get()}))}));return this.runtime.attachState===oe.Detached?(this.detachedBlobIds.add(o.id),a):(this.pendingBlobIds.has(o.id)?yield(r=this.pendingBlobIds.get(o.id))===null||r===void 0?void 0:r.promise:this.blobIds.has(o.id)||(this.pendingBlobIds.set(o.id,new Ee),this.attachBlobCallback(o.id),yield(i=this.pendingBlobIds.get(o.id))===null||i===void 0?void 0:i.promise),a)})}processBlobAttachOp(t,r){if(r){let i=this.pendingBlobIds.get(t);w(i!==void 0,504),i.resolve(),this.pendingBlobIds.delete(t)}this.blobIds.add(t)}static load(t,r){return v(this,null,function*(){if(!t)return{};let i,o=t.blobs[this.redirectTableBlobName];return o&&(i=yield r(o)),{ids:Object.entries(t.blobs).filter(([s,c])=>s!==this.redirectTableBlobName).map(([s,c])=>c),redirectTable:i}})}load(t){var r,i,o;if(t.ids){let a=this.runtime.attachState===oe.Detached;t.ids.map(s=>a?this.detachedBlobIds.add(s):this.blobIds.add(s))}t.redirectTable&&(this.redirectTable=new Map(t.redirectTable)),this.logger.sendTelemetryEvent({eventName:"AttachmentBlobsLoaded",count:(i=(r=t.ids)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0,redirectTable:(o=t.redirectTable)===null||o===void 0?void 0:o.length})}getGCData(t=!1){let r={gcNodes:{}};if(this.blobIds.forEach(i=>{r.gcNodes[this.getBlobGCNodePath(i)]=[]}),this.redirectTable!==void 0)for(let[i,o]of this.redirectTable)r.gcNodes[this.getBlobGCNodePath(i)]=[this.getBlobGCNodePath(o)];return r}deleteUnusedRoutes(t){var r;for(let i of t){let o=i.split("/");w(o.length===3&&o[1]===n.basePath,725);let a=o[2];if(!((r=this.redirectTable)===null||r===void 0)&&r.has(a)){this.redirectTable.delete(a);continue}this.blobIds.delete(a)}}summarize(t){let i=!!this.redirectTable||this.runtime.attachState!==oe.Detached?this.blobIds:this.detachedBlobIds,o=new Pt;return i.forEach(a=>{o.addAttachment(a)}),this.redirectTable&&this.redirectTable.size>0&&o.addBlob(n.redirectTableBlobName,JSON.stringify(Array.from(this.redirectTable.entries()))),o.getSummaryTree()}setRedirectTable(t){w(this.runtime.attachState===oe.Detached,594),w(!this.redirectTable,595);for(let[r,i]of t)w(this.detachedBlobIds.delete(r),596),this.blobIds.add(i);w(this.detachedBlobIds.size===0,597),this.redirectTable=t}}return n.basePath="_blobs",n.redirectTableBlobName=".redirectTable",n})();var Hi=Ce(Ln());vt();Oe();qt();Y();Nt();ja();Y();Oe();var uh=class{constructor(e){this.notBoundContexts=new Set,this._contexts=new Map,this.deferredContexts=new Map,this.disposeOnce=new On(()=>{for(let[t,r]of this.deferredContexts)r.promise.then(i=>{i.dispose()}).catch(i=>{this._logger.sendErrorEvent({eventName:"FluidDataStoreContextDisposeError",fluidDataStoreId:t},i)})}),this.dispose=()=>this.disposeOnce.value,this._logger=ue.create(e)}[Symbol.iterator](){return this._contexts.entries()}get size(){return this._contexts.size}get disposed(){return this.disposeOnce.evaluated}notBoundLength(){return this.notBoundContexts.size}isNotBound(e){return this.notBoundContexts.has(e)}has(e){return this._contexts.has(e)}get(e){return this._contexts.get(e)}delete(e){return this.deferredContexts.delete(e),this.notBoundContexts.delete(e),this._contexts.delete(e)}getUnbound(e){if(!(this._contexts.get(e)===void 0||!this.notBoundContexts.has(e)))return this._contexts.get(e)}addUnbound(e){let t=e.id;w(!this._contexts.has(t),344),this._contexts.set(t,e),this.notBoundContexts.add(t),this.ensureDeferred(t)}getBoundOrRemoted(e,t){return v(this,null,function*(){let r=this.ensureDeferred(e);if(!(!t&&!r.isCompleted))return r.promise})}ensureDeferred(e){let t=this.deferredContexts.get(e);if(t)return t;let r=new Ee;return this.deferredContexts.set(e,r),r}bind(e){let t=this.notBoundContexts.delete(e);w(t,345),this.resolveDeferred(e)}resolveDeferred(e){let t=this._contexts.get(e);w(!!t,346),w(!this.notBoundContexts.has(e),347);let r=this.deferredContexts.get(e);w(!!r,348),r.resolve(t)}addBoundOrRemoted(e){let t=e.id;w(!this._contexts.has(t),349),this._contexts.set(t,e),this.ensureDeferred(t),this.resolveDeferred(t)}};qt();Y();Hr();var Wa=Ce(Ln());vt();Oe();Y();var yA=Ce(Ln());Y();ja();var xA=Ce(Ln());vt();Oe();var Gj=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t},Wj=1,Fr="gc",_A="__gc",Kj="Fluid.GarbageCollection.RunGC",$j="Fluid.GarbageCollection.RunSweep",Xj="Fluid.GarbageCollection.GCTestMode",Jj="Fluid.GarbageCollection.WriteDataAtRoot",Qj="Fluid.GarbageCollection.RunSessionExpiry",Yj="Fluid.GarbageCollection.DisableSessionExpiry",Zj="Fluid.GarbageCollection.TrackGCState",eV="Fluid.GarbageCollection.DisableSweepLog",e0=1*24*60*60*1e3,tV=7*e0,nV=30*e0,Yt={DataStore:"DataStore",SubDataStore:"SubDataStore",Blob:"Blob",Other:"Other"},jn={Active:"Active",Inactive:"Inactive",SweepReady:"SweepReady"},hh=class{constructor(e,t,r,i){this.unreferencedTimestampMs=e,this.inactiveTimeoutMs=t,this.sweepTimeoutMs=r,this._state=jn.Active,i!==void 0&&this.updateTracking(i)}get state(){return this._state}updateTracking(e){let t=e-this.unreferencedTimestampMs;if(this.sweepTimeoutMs!==void 0&&t>=this.sweepTimeoutMs){this._state=jn.SweepReady,this.clearTimers();return}if(t>=this.inactiveTimeoutMs){this._state=jn.Inactive,this.clearTimers(),this.sweepTimeoutMs!==void 0&&gh(this.sweepTimeoutMs-t,()=>{this._state=jn.SweepReady},i=>{this.sweepTimer=i});return}let r=this.inactiveTimeoutMs-t;if(this.inactiveTimer===void 0){let i=()=>{this._state=jn.Inactive,this.sweepTimeoutMs!==void 0&&gh(this.sweepTimeoutMs-this.inactiveTimeoutMs,()=>{this._state=jn.SweepReady},o=>{this.sweepTimer=o})};this.inactiveTimer=new fn(r,()=>i())}this.inactiveTimer.restart(r)}clearTimers(){var e;(e=this.inactiveTimer)===null||e===void 0||e.clear(),this.sweepTimer!==void 0&&clearTimeout(this.sweepTimer)}stopTracking(){this.clearTimers(),this._state=jn.Active}},ph=class n{constructor(e){var t,r,i,o,a,s,c;this._writeDataAtRoot=!0,this.initialStateNeedsReset=!1,this.currentGCVersion=Wj,this.newReferencesSinceLastRun=new Map,this.unreferencedNodesState=new Map,this.loggedUnreferencedEvents=new Set,this.pendingEventsQueue=[],this.completedRuns=0,this.runtime=e.runtime,this.isSummarizerClient=e.isSummarizerClient,this.gcOptions=e.gcOptions,this.getNodePackagePath=e.getNodePackagePath,this.getLastSummaryTimestampMs=e.getLastSummaryTimestampMs;let l=e.baseSnapshot,h=e.metadata,u=e.readAndParseBlob;this.mc=Mn(ue.create(e.baseLogger,"GarbageCollector",{all:{completedGCRuns:()=>this.completedRuns}}));let d;if(e.existing)d=Zv(h),this.gcEnabled=d>0,this.sweepEnabled=(t=h?.sweepEnabled)!==null&&t!==void 0?t:!1,this.sessionExpiryTimeoutMs=h?.sessionExpiryTimeoutMs;else{if(this.gcOptions.sweepAllowed&&this.gcOptions.gcAllowed===!1)throw new ye("GC sweep phase cannot be enabled without enabling GC mark phase");this.gcEnabled=this.gcOptions.gcAllowed!==!1,this.sweepEnabled=this.gcOptions.sweepAllowed===!0,this.mc.config.getBoolean(Qj)&&this.gcEnabled&&(this.sessionExpiryTimeoutMs=nV)}if(this.sessionExpiryTimeoutMs!==void 0&&this.mc.config.getBoolean(Yj)!==!0){let f=this.mc.config.getNumber("Fluid.GarbageCollection.TestOverride.SessionExpiryMs"),x=f??this.sessionExpiryTimeoutMs;gh(x,()=>{this.runtime.closeFn(new Wu("Client session expired.",x))},b=>{this.sessionExpiryTimer=b}),e.snapshotCacheExpiryMs!==void 0&&(this.sweepTimeoutMs=this.sessionExpiryTimeoutMs+e.snapshotCacheExpiryMs+e0)}if(this.latestSummaryGCVersion=d??this.currentGCVersion,this.shouldRunGC=(r=this.mc.config.getBoolean(Kj))!==null&&r!==void 0?r:this.gcEnabled&&!this.gcOptions.disableGC,this.shouldRunSweep=this.shouldRunGC&&this.sweepTimeoutMs!==void 0&&((i=this.mc.config.getBoolean($j))!==null&&i!==void 0?i:this.sweepEnabled),this.trackGCState=this.mc.config.getBoolean(Zj)===!0,this.inactiveTimeoutMs=(a=(o=this.mc.config.getNumber("Fluid.GarbageCollection.TestOverride.InactiveTimeoutMs"))!==null&&o!==void 0?o:this.gcOptions.inactiveTimeoutMs)!==null&&a!==void 0?a:tV,this.sweepTimeoutMs!==void 0&&this.inactiveTimeoutMs>this.sweepTimeoutMs)throw new ye("inactive timeout should not be greated than the sweep timeout");if(this.testMode=(s=this.mc.config.getBoolean(Xj))!==null&&s!==void 0?s:this.gcOptions.runGCInTestMode===!0,this._writeDataAtRoot=(c=this.mc.config.getBoolean(Jj))!==null&&c!==void 0?c:!0,this._writeDataAtRoot){let f=l?.trees[Fr]!==void 0;this.initialStateNeedsReset=f!==this.shouldRunGC}let p=new Rt(()=>v(this,null,function*(){var f;if(l===void 0)return;let x=l.trees[Fr];if(x!==void 0){this._writeDataAtRoot=!0;let O=yield bA(x,u);return this.trackGCState&&(this.latestSerializedSummaryState=JSON.stringify(Yv(O))),O}let b={gcNodes:{"/":{outboundRoutes:[]}}},_=fh(l,h);w(_!==void 0,680);for(let[O,S]of Object.entries(_.trees)){let E=S.blobs[xA.gcBlobKey];if(E===void 0)continue;let F=yield u(E);if(((f=F.gcData)===null||f===void 0?void 0:f.gcNodes)===void 0)continue;let I=`/${O}`;(yield u(S.blobs[Xr])).isRootDataStore&&b.gcNodes["/"].outboundRoutes.push(I);for(let[P,C]of Object.entries(F.gcData.gcNodes)){let M=P==="/"?I:`${I}${P}`;b.gcNodes[M]={outboundRoutes:Array.from(C)}}w(b.gcNodes[I]!==void 0,681),b.gcNodes[I].unreferencedTimestampMs=F.unrefTimestamp}return Object.keys(b.gcNodes).length===1?void 0:b}));this.initializeBaseStateP=new Rt(()=>v(this,null,function*(){let f=this.runtime.getCurrentReferenceTimestampMs(),x=yield p;if(x===void 0)return;let b={};for(let[_,O]of Object.entries(x.gcNodes))O.unreferencedTimestampMs!==void 0&&this.unreferencedNodesState.set(_,new hh(O.unreferencedTimestampMs,this.inactiveTimeoutMs,this.sweepTimeoutMs,f)),b[_]=Array.from(O.outboundRoutes);this.previousGCDataFromLastRun={gcNodes:b}})),this.baseGCDetailsP=new Rt(()=>v(this,null,function*(){let f=yield p;if(f===void 0)return new Map;let x={};for(let[O,S]of Object.entries(f.gcNodes))x[O]=Array.from(S.outboundRoutes);let b=Lu(x,["/"]).referencedNodeIds,_=ju({gcData:{gcNodes:x},usedRoutes:b});for(let[O,S]of Object.entries(f.gcNodes))if(S.unreferencedTimestampMs!==void 0){let E=_.get(O.slice(1));E!==void 0&&(E.unrefTimestamp=S.unreferencedTimestampMs)}return _}));let m=JSON.stringify(Object.assign({gcEnabled:this.gcEnabled,sweepEnabled:this.sweepEnabled,runGC:this.shouldRunGC,runSweep:this.shouldRunSweep,writeAtRoot:this._writeDataAtRoot,testMode:this.testMode,sessionExpiry:this.sessionExpiryTimeoutMs,inactiveTimeout:this.inactiveTimeoutMs,existing:e.existing,trackGCState:this.trackGCState},this.gcOptions));this.isSummarizerClient&&this.mc.logger.sendTelemetryEvent({eventName:"GarbageCollectorLoaded",gcConfigs:m}),this.shouldRunGC&&this.initializeBaseStateP.catch(f=>{let x=Ot.wrapIfUnrecognized(f,"FailedToInitializeGC");throw x.addTelemetryProperties({gcConfigs:m}),x})}static create(e){return new n(e)}get summaryStateNeedsReset(){return this.initialStateNeedsReset||this.shouldRunGC&&this.latestSummaryGCVersion!==this.currentGCVersion}get writeDataAtRoot(){return this._writeDataAtRoot}collectGarbage(e){return v(this,null,function*(){let{fullGC:t=this.gcOptions.runFullGC===!0||this.summaryStateNeedsReset}=e,r=e.logger?ue.create(e.logger,void 0,{all:{completedGCRuns:()=>this.completedRuns}}):this.mc.logger;return le.timedExecAsync(r,{eventName:"GarbageCollection"},i=>v(this,null,function*(){yield this.runPreGCSteps();let o=yield this.runtime.getGCData(t),a=Lu(o.gcNodes,["/"]),s=yield this.runPostGCSteps(o,a,r);return i.end(Object.assign({},s)),this.completedRuns++,s}),{end:!0,cancel:"error"})})}runPreGCSteps(){return v(this,null,function*(){yield this.initializeBaseStateP,yield this.runtime.updateStateBeforeGC()})}runPostGCSteps(e,t,r){return v(this,null,function*(){let i=this.generateStats(t);this.updateStateSinceLastRun(e,r);let o=this.runtime.getCurrentReferenceTimestampMs();return this.updateCurrentState(e,t,o),this.runtime.updateUsedRoutes(t.referencedNodeIds,o),this.logSweepEvents(r,o),this.testMode&&this.runtime.deleteUnusedRoutes(t.deletedNodeIds),yield this.logUnreferencedEvents(r),i})}summarize(e,t,r){var i;if(!this.shouldRunGC||this.previousGCDataFromLastRun===void 0)return;let o={gcNodes:{}};for(let[c,l]of Object.entries(this.previousGCDataFromLastRun.gcNodes))o.gcNodes[c]={outboundRoutes:l,unreferencedTimestampMs:(i=this.unreferencedNodesState.get(c))===null||i===void 0?void 0:i.unreferencedTimestampMs};let a=JSON.stringify(Yv(o));if(this.trackGCState&&(this.pendingSerializedSummaryState=a,this.latestSerializedSummaryState!==void 0&&this.latestSerializedSummaryState===a&&!e&&t)){let c=dr();return c.handleNodeCount++,{summary:{type:Dr.Handle,handle:`/${Fr}`,handleType:Dr.Tree},stats:c}}let s=new Pt;return s.addBlob(`${_A}_root`,a),s.getSummaryTree()}getMetadata(){return{gcFeature:this.gcEnabled?this.currentGCVersion:0,sessionExpiryTimeoutMs:this.sessionExpiryTimeoutMs,sweepEnabled:this.sweepEnabled}}getBaseGCDetails(){return v(this,null,function*(){return this.baseGCDetailsP})}latestSummaryStateRefreshed(e,t){return v(this,null,function*(){if(!this.shouldRunGC||!e.latestSummaryUpdated)return;if(e.wasSummaryTracked){this.latestSummaryGCVersion=this.currentGCVersion,this.initialStateNeedsReset=!1,this.trackGCState&&(this.latestSerializedSummaryState=this.pendingSerializedSummaryState,this.pendingSerializedSummaryState=void 0);return}let r=e.snapshot,i=r.blobs[$c];if(i){let a=yield t(i);this.latestSummaryGCVersion=Zv(a)}let o=r.trees[Fr];if(o!==void 0&&this.trackGCState){let a=yield bA(o,t);this.latestSerializedSummaryState=JSON.stringify(Yv(a))}else this.latestSerializedSummaryState=void 0;this.pendingSerializedSummaryState=void 0})}nodeUpdated(e,t,r,i,o){if(!this.shouldRunGC)return;let a=this.unreferencedNodesState.get(e);a&&a.state!==jn.Active&&this.inactiveNodeUsed(t,e,a,void 0,i,r,o)}addedOutboundReference(e,t){var r;if(!this.shouldRunGC)return;let i=(r=this.newReferencesSinceLastRun.get(e))!==null&&r!==void 0?r:[];i.push(t),this.newReferencesSinceLastRun.set(e,i);let o=this.unreferencedNodesState.get(t);o&&o.state!==jn.Active&&this.inactiveNodeUsed("Revived",t,o,e)}dispose(){this.sessionExpiryTimer!==void 0&&(clearTimeout(this.sessionExpiryTimer),this.sessionExpiryTimer=void 0)}updateCurrentState(e,t,r){this.previousGCDataFromLastRun=wo(e),this.newReferencesSinceLastRun.clear();for(let i of t.referencedNodeIds){let o=this.unreferencedNodesState.get(i);o!==void 0&&(o.stopTracking(),this.unreferencedNodesState.delete(i))}if(r!==void 0)for(let i of t.deletedNodeIds){let o=this.unreferencedNodesState.get(i);o===void 0?this.unreferencedNodesState.set(i,new hh(r,this.inactiveTimeoutMs,this.sweepTimeoutMs,r)):o.updateTracking(r)}}updateStateSinceLastRun(e,t){if(this.previousGCDataFromLastRun===void 0)return;let r=this.findMissingExplicitReferences(e,this.previousGCDataFromLastRun,this.newReferencesSinceLastRun);if(this.writeDataAtRoot&&r.length>0&&r.forEach(a=>{let s={eventName:"gcUnknownOutboundReferences",gcNodeId:a[0],gcRoutes:JSON.stringify(a[1])};t.sendPerformanceEvent(s)}),this.newReferencesSinceLastRun.size===0)return;let i=GE(this.previousGCDataFromLastRun,e);this.newReferencesSinceLastRun.forEach((a,s)=>{i.gcNodes[s]===void 0?i.gcNodes[s]=a:i.gcNodes[s].push(...a)});let o=Lu(i.gcNodes,["/"]);for(let a of o.referencedNodeIds){let s=this.unreferencedNodesState.get(a);s!==void 0&&(s.stopTracking(),this.unreferencedNodesState.delete(a))}}findMissingExplicitReferences(e,t,r){w(t!==void 0,695);let i=Object.entries(e.gcNodes),o=[];return i.forEach(([a,s])=>{var c,l;let h=(c=t.gcNodes[a])!==null&&c!==void 0?c:[],u=(l=r.get(a))!==null&&l!==void 0?l:[],d=[];s.forEach(p=>{let m=this.runtime.getNodeType(p)===Yt.Blob||this.runtime.getNodeType(p)===Yt.DataStore,f=!a.startsWith(p);m&&f&&!h.includes(p)&&!u.includes(p)&&d.push(p)}),d.length>0&&o.push([a,d])}),o}generateStats(e){let t={nodeCount:0,dataStoreCount:0,attachmentBlobCount:0,unrefNodeCount:0,unrefDataStoreCount:0,unrefAttachmentBlobCount:0,updatedNodeCount:0,updatedDataStoreCount:0,updatedAttachmentBlobCount:0},r=(i,o)=>{t.nodeCount++;let a=this.previousGCDataFromLastRun===void 0||this.unreferencedNodesState.has(i)===o;a&&t.updatedNodeCount++,o||t.unrefNodeCount++,this.runtime.getNodeType(i)===Yt.DataStore&&(t.dataStoreCount++,a&&t.updatedDataStoreCount++,o||t.unrefDataStoreCount++),this.runtime.getNodeType(i)===Yt.Blob&&(t.attachmentBlobCount++,a&&t.updatedAttachmentBlobCount++,o||t.unrefAttachmentBlobCount++)};for(let i of e.referencedNodeIds)r(i,!0);for(let i of e.deletedNodeIds)r(i,!1);return t}logSweepEvents(e,t){this.mc.config.getBoolean(eV)===!0||t===void 0||this.sweepTimeoutMs===void 0||this.unreferencedNodesState.forEach((r,i)=>{if(r.state!==jn.SweepReady)return;let o=this.runtime.getNodeType(i);if(o!==Yt.DataStore&&o!==Yt.Blob)return;let a=`Deleted-${i}`;this.loggedUnreferencedEvents.has(a)||(this.loggedUnreferencedEvents.add(a),e.sendTelemetryEvent({eventName:"GCObjectDeleted",id:i,type:o,age:t-r.unreferencedTimestampMs,timeout:this.sweepTimeoutMs,completedGCRuns:this.completedRuns,lastSummaryTime:this.getLastSummaryTimestampMs()}))})}inactiveNodeUsed(e,t,r,i,o,a=this.runtime.getCurrentReferenceTimestampMs(),s){if(a===void 0||r.state===jn.Active||!this.isSummarizerClient&&e!=="Loaded")return;let c=this.runtime.getNodeType(t);if(c!==Yt.DataStore&&c!==Yt.Blob)return;let l=r.state,h=`${l}-${t}-${e}`;if(this.loggedUnreferencedEvents.has(h))return;this.loggedUnreferencedEvents.add(h);let u={id:t,type:c,unrefTime:r.unreferencedTimestampMs,age:a-r.unreferencedTimestampMs,timeout:r.state===jn.Inactive?this.inactiveTimeoutMs:this.sweepTimeoutMs,completedGCRuns:this.completedRuns,lastSummaryTime:this.getLastSummaryTimestampMs(),externalRequest:s?.[Tr.externalRequest],viaHandle:s?.[Tr.viaHandle],fromId:i};this.isSummarizerClient?this.pendingEventsQueue.push(Object.assign(Object.assign({},u),{usageType:e,state:l})):this.mc.logger.sendErrorEvent(Object.assign(Object.assign({},u),{eventName:`${l}Object_${e}`,pkg:o?{value:o.join("/"),tag:Ne.CodeArtifact}:void 0}))}logUnreferencedEvents(e){return v(this,null,function*(){for(let t of this.pendingEventsQueue){let{usageType:r,state:i}=t,o=Gj(t,["usageType","state"]),a=this.unreferencedNodesState.get(t.id),s=a===void 0||a.state===jn.Active;if(r==="Revived"===s){let c=yield this.getNodePackagePath(t.id),l=t.fromId?yield this.getNodePackagePath(t.fromId):void 0;e.sendErrorEvent(Object.assign(Object.assign({},o),{eventName:`${i}Object_${r}`,pkg:c?{value:c.join("/"),tag:Ne.CodeArtifact}:void 0,fromPkg:l?{value:l.join("/"),tag:Ne.CodeArtifact}:void 0}))}}this.pendingEventsQueue=[]})}};function bA(n,e){return v(this,null,function*(){let t={gcNodes:{}};for(let r of Object.keys(n.blobs)){if(!r.startsWith(_A))continue;let i=n.blobs[r];if(i===void 0)continue;let o=yield e(i);w(o!==void 0,685),t=UE(t,o)}return t})}function Yv(n){let e=Object.entries(n.gcNodes);e.sort(([r],[i])=>r.localeCompare(i));let t={gcNodes:{}};for(let[r,i]of e)i.outboundRoutes.sort(),t.gcNodes[r]=i;return t}function gh(n,e,t){let i;if(n>2147483647){let o=n-2147483647;i=setTimeout(()=>gh(o,e,t),2147483647)}else i=setTimeout(()=>e(),n);t(i)}function t0(n){return n.summaryFormatVersion?n.summaryFormatVersion:n.snapshotFormatVersion==="0.1"?1:0}function n0(n){return!!n.summaryFormatVersion&&!n.disableIsolatedChannels}var CA=n=>n===void 0?void 0:{clientId:n.clientId,clientSequenceNumber:n.clientSequenceNumber,minimumSequenceNumber:n.minimumSequenceNumber,referenceSequenceNumber:n.referenceSequenceNumber,sequenceNumber:n.sequenceNumber,timestamp:n.timestamp,type:n.type};var r0=".aliases",$c=".metadata",i0=".chunks",o0=".electedSummarizer",mh=".blobs";function wA(n){return!!n&&!n.disableIsolatedChannels}function Zv(n){var e;return n&&(e=n.gcFeature)!==null&&e!==void 0?e:0}var rV=".protocol",PA=[rV,".logTail",".serviceProtocol",mh,Fr],Xr=".component";function Ga(n){n.summary={type:Dr.Tree,tree:{[yA.channelsTreeName]:n.summary}},n.stats.treeNodeCount++}function OA(n,e){return v(this,null,function*(){let t=yield Ze(n,e.blobs[Xr]),r=t0(t);return w(r>0,469),t})}function a0(n,e,t){let r=JSON.stringify(n);return t?{pkg:r,snapshotFormatVersion:"0.1",isRootDataStore:e}:{pkg:r,summaryFormatVersion:2,isRootDataStore:e}}function MA(n,e,t){let r=a0(n,e,t);return new fa(Xr,JSON.stringify(r))}var SA=(()=>{class n extends Pe{constructor(t,r,i,o,a){super(),this.existing=r,this.bindState=i,this.isLocalDataStore=o,this.makeLocallyVisibleFn=a,this._disposed=!1,this.detachedRuntimeCreation=!1,this.loaded=!1,this.pending=[],this._isInMemoryRoot=!1,this._containerRuntime=t.runtime,this.id=t.id,this.storage=t.storage,this.scope=t.scope,this.writeGCDataAtRoot=t.writeGCDataAtRoot,this.disableIsolatedChannels=t.disableIsolatedChannels,this.pkg=t.pkg,w(!this.id.includes("/"),314),this._attachState=this.containerRuntime.attachState!==oe.Detached&&this.existing?this.containerRuntime.attachState:oe.Detached,this.bindToContext=()=>{w(this.bindState===xn.NotBound,315),this.bindState=xn.Binding,w(this.channel!==void 0,316),this.makeLocallyVisible(),this.bindState=xn.Bound};let s=(c,l,h)=>v(this,null,function*(){return this.summarizeInternal(c,l,h)});this.summarizerNode=t.createSummarizerNodeFn(s,c=>v(this,null,function*(){return this.getGCDataInternal(c)}),()=>v(this,null,function*(){return this.getBaseGCDetails()})),this.subLogger=ue.create(this.logger,"FluidDataStoreContext"),this.thresholdOpsCounter=new go(n.pendingOpsCountThreshold,this.subLogger)}get packagePath(){return w(this.pkg!==void 0,313),this.pkg}get options(){return this._containerRuntime.options}get clientId(){return this._containerRuntime.clientId}get clientDetails(){return this._containerRuntime.clientDetails}get logger(){return this._containerRuntime.logger}get deltaManager(){return this._containerRuntime.deltaManager}get connected(){return this._containerRuntime.connected}get IFluidHandleContext(){return this._containerRuntime.IFluidHandleContext}get containerRuntime(){return this._containerRuntime}get isLoaded(){return this.loaded}get baseSnapshot(){return this._baseSnapshot}get disposed(){return this._disposed}get attachState(){return this._attachState}get IFluidDataStoreRegistry(){return this.registry}isRoot(){return v(this,null,function*(){return this.isInMemoryRoot()||(yield this.getInitialSnapshotDetails()).isRootDataStore})}isInMemoryRoot(){return this._isInMemoryRoot}dispose(){this._disposed||(this._disposed=!0,this.channelDeferred&&this.channelDeferred.promise.then(t=>{t.dispose()}).catch(t=>{}))}rejectDeferredRealize(t,r){throw new Be(t,{packageName:{value:r,tag:Ne.PackageData}})}realize(){return v(this,null,function*(){return w(!this.detachedRuntimeCreation,317),this.channelDeferred||(this.channelDeferred=new Ee,this.realizeCore(this.existing).catch(t=>{var r;let i=Ot.wrapIfUnrecognized(t,"realizeFluidDataStoreContext");i.addTelemetryProperties({fluidDataStoreId:{value:this.id,tag:"PackageData"}}),(r=this.channelDeferred)===null||r===void 0||r.reject(i),this.logger.sendErrorEvent({eventName:"RealizeError"},i)})),this.channelDeferred.promise})}factoryFromPackagePath(t){return v(this,null,function*(){w(this.pkg===t,318),t===void 0&&this.rejectDeferredRealize("packages is undefined");let r,i=this._containerRuntime.IFluidDataStoreRegistry,o;for(let s of t)i||this.rejectDeferredRealize("No registry for package",o),o=s,r=yield i.get(s),r||this.rejectDeferredRealize("Registry does not contain entry for the package",s),i=r.IFluidDataStoreRegistry;let a=r?.IFluidDataStoreFactory;return a===void 0&&this.rejectDeferredRealize("Can't find factory for package",o),{factory:a,registry:i}})}realizeCore(t){return v(this,null,function*(){let r=yield this.getInitialSnapshotDetails();this._baseSnapshot=r.snapshot;let i=r.pkg,{factory:o,registry:a}=yield this.factoryFromPackagePath(i);w(this.registry===void 0,319),this.registry=a;let s=yield o.instantiateDataStore(this,t);w(s!==void 0,320),this.bindRuntime(s)})}setConnectionState(t,r){this.verifyNotClosed(),this.loaded&&(w(this.connected===t,321),this.channel.setConnectionState(t,r))}process(t,r,i){var o;this.verifyNotClosed();let a=t.contents,s=Object.assign(Object.assign({},t),{type:a.type,contents:a.content});if(this.summarizerNode.recordChange(s),this.loaded)return(o=this.channel)===null||o===void 0?void 0:o.process(s,r,i);w(!r,322),w(this.pending!==void 0,573),this.pending.push(s),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length)}processSignal(t,r){var i;this.verifyNotClosed(),this.loaded&&((i=this.channel)===null||i===void 0||i.processSignal(t,r))}getQuorum(){return this._containerRuntime.getQuorum()}getAudience(){return this._containerRuntime.getAudience()}summarize(t=!1,r=!0,i){return v(this,null,function*(){return this.summarizerNode.summarize(t,r,i)})}summarizeInternal(t,r,i){return v(this,null,function*(){yield this.realize();let o=yield this.channel.summarize(t,r,i),a;this.disableIsolatedChannels||(Ga(o),a=[Wa.channelsTreeName]);let{pkg:s}=yield this.getInitialSnapshotDetails(),c=yield this.isRoot(),l=a0(s,c,this.disableIsolatedChannels);return En(o,Xr,JSON.stringify(l)),this.writeGCDataAtRoot||En(o,Wa.gcBlobKey,JSON.stringify(this.summarizerNode.getGCSummaryDetails())),this.summarizerNode.isReferenced()||(o.summary.unreferenced=!0,o.stats.unreferencedBlobSize=o.stats.totalBlobSize),Object.assign(Object.assign({},o),{id:this.id,pathPartsForChildren:a})})}getGCData(t=!1){return v(this,null,function*(){return this.summarizerNode.getGCData(t)})}getGCDataInternal(t=!1){return v(this,null,function*(){return yield this.realize(),w(this.channel!==void 0,323),this.channel.getGCData(t)})}updateUsedRoutes(t,r){this.summarizerNode.updateUsedRoutes(t,r),this.lastUsedState={usedRoutes:t,gcTimestamp:r},this.loaded&&this.updateChannelUsedRoutes()}addedGCOutboundReference(t,r){this._containerRuntime.addedGCOutboundReference(t,r)}updateChannelUsedRoutes(){if(w(this.loaded,324),w(this.channel!==void 0,325),this.lastUsedState===void 0)return;let t=this.lastUsedState.usedRoutes.filter(r=>r!=="/"&&r!=="");this.channel.updateUsedRoutes(t,this.lastUsedState.gcTimestamp)}request(t){return v(this,null,function*(){return(yield this.realize()).request(t)})}submitMessage(t,r,i){this.verifyNotClosed(),w(!!this.channel,326);let o={content:r,type:t};this._containerRuntime.submitDataStoreOp(this.id,o,i)}setChannelDirty(t){this.verifyNotClosed();let r=this.deltaManager.lastSequenceNumber;this.summarizerNode.invalidate(r);let i=this.summarizerNode.getChild(t);i&&i.invalidate(r)}submitSignal(t,r){return this.verifyNotClosed(),w(!!this.channel,327),this._containerRuntime.submitDataStoreSignal(this.id,t,r)}makeLocallyVisible(){w(this.channel!==void 0,719),this.makeLocallyVisibleFn()}bindRuntime(t){var r;if(this.channel)throw new Error("Runtime already bound");try{w(!this.detachedRuntimeCreation,328),w(this.channelDeferred!==void 0,329),w(this.pkg!==void 0,330);let i=this.pending;for(let o of i)t.process(o,!1,void 0);this.thresholdOpsCounter.send("ProcessPendingOps",i.length),this.pending=void 0,this.loaded=!0,this.channel=t,Object.freeze(this.pkg),this.updateChannelUsedRoutes(),this.channelDeferred.resolve(this.channel)}catch(i){(r=this.channelDeferred)===null||r===void 0||r.reject(i),this.logger.sendErrorEvent({eventName:"BindRuntimeError",fluidDataStoreId:{value:this.id,tag:"PackageData"}},i)}}getAbsoluteUrl(t){return v(this,null,function*(){if(this.attachState===oe.Attached)return this._containerRuntime.getAbsoluteUrl(t)})}setInMemoryRoot(){this._isInMemoryRoot=!0}reSubmit(t,r){w(!!this.channel,331);let i=t;this.channel.reSubmit(i.type,i.content,r)}rollback(t,r){if(!this.channel)throw new Error("Channel must exist when rolling back ops");if(!this.channel.rollback)throw new Error("Channel doesn't support rollback");let i=t;this.channel.rollback(i.type,i.content,r)}applyStashedOp(t){return v(this,null,function*(){this.channel||(yield this.realize()),w(!!this.channel,332);let r=t;return this.channel.applyStashedOp(r.content)})}verifyNotClosed(){if(this._disposed)throw new Error("Context is closed")}getCreateChildSummarizerNodeFn(t,r){return(i,o,a)=>this.summarizerNode.createChild(i,t,r,{throwOnFailure:!0},o,a)}uploadBlob(t){return v(this,null,function*(){return this.containerRuntime.uploadBlob(t)})}}return n.pendingOpsCountThreshold=1e3,n})(),Xc=class extends SA{constructor(e){super(e,!0,xn.Bound,!1,()=>{throw new Error("Already attached")}),this.initialSnapshotDetailsP=new Rt(()=>v(this,null,function*(){var t,r;let i,o=!0;if(typeof this.initSnapshotValue=="string"){let s=(yield this.storage.getVersions(this.initSnapshotValue,1))[0];i=(t=yield this.storage.getSnapshotTree(s))!==null&&t!==void 0?t:void 0}else i=this.initSnapshotValue;let a=s=>v(this,null,function*(){return Ze(this.storage,s)});if(i){let s=yield this.summarizerNode.loadBaseSummary(i,a);i=s.baseSummary,this.pending=s.outstandingOps.concat(this.pending)}if(i&&i.blobs[Xr]!==void 0){let s=yield a(i.blobs[Xr]),c;t0(s)<1?s.pkg.startsWith('["')&&s.pkg.endsWith('"]')?c=JSON.parse(s.pkg):c=[s.pkg]:c=JSON.parse(s.pkg),this.pkg=c,o=(r=s.isRootDataStore)!==null&&r!==void 0?r:!0,n0(s)&&(i=i.trees[Wa.channelsTreeName],w(i!==void 0,510))}return{pkg:this.pkg,isRootDataStore:o,snapshot:i}})),this.initSnapshotValue=e.snapshotTree,this.baseGCDetailsP=new Rt(()=>v(this,null,function*(){var t;return(t=yield e.getBaseGCDetails())!==null&&t!==void 0?t:{}}))}getInitialSnapshotDetails(){return v(this,null,function*(){return this.initialSnapshotDetailsP})}getInitialGCSummaryDetails(){return v(this,null,function*(){return this.getBaseGCDetails()})}getBaseGCDetails(){return v(this,null,function*(){return this.baseGCDetailsP})}generateAttachMessage(){throw new Error("Cannot attach remote store")}},vh=class extends SA{constructor(e){super(e,e.snapshotTree!==void 0,e.snapshotTree?xn.Bound:xn.NotBound,!0,e.makeLocallyVisibleFn),this.snapshotTree=e.snapshotTree,e.isRootDataStore===!0&&this.setInMemoryRoot(),this.createProps=e.createProps,this.attachListeners()}attachListeners(){this.once("attaching",()=>{w(this.attachState===oe.Detached,333),this._attachState=oe.Attaching}),this.once("attached",()=>{w(this.attachState===oe.Attaching,334),this._attachState=oe.Attached})}generateAttachMessage(){w(this.channel!==void 0,335),w(this.pkg!==void 0,336);let e=this.channel.getAttachSummary();this.disableIsolatedChannels||Ga(e);let t=a0(this.pkg,this.isInMemoryRoot(),this.disableIsolatedChannels);En(e,Xr,JSON.stringify(t));let r=La(e.summary);return{id:this.id,snapshot:r,type:this.pkg[this.pkg.length-1]}}getInitialSnapshotDetails(){return v(this,null,function*(){var e;let t=this.snapshotTree,r,i=!1;return t!==void 0&&(r=yield OA(this.storage,t),n0(r)&&(t=t.trees[Wa.channelsTreeName],w(t!==void 0,511)),this.pkg===void 0&&(this.pkg=JSON.parse(r.pkg),(!((e=r.isRootDataStore)!==null&&e!==void 0)||e)&&(i=!0,this.setInMemoryRoot()))),w(this.pkg!==void 0,338),{pkg:this.pkg,isRootDataStore:i,snapshot:t}})}getInitialGCSummaryDetails(){return v(this,null,function*(){return{}})}getBaseGCDetails(){return v(this,null,function*(){return{}})}},Jc=class extends vh{constructor(e){super(e)}},bh=class n extends vh{constructor(e){super(e),this.detachedRuntimeCreation=!0}attachRuntime(e,t){return v(this,null,function*(){w(this.detachedRuntimeCreation,340),w(this.channelDeferred===void 0,341);let r=e.IFluidDataStoreFactory,i=yield this.factoryFromPackagePath(this.pkg);w(i.factory===r,342),w(this.registry===void 0,343),this.registry=i.registry,this.detachedRuntimeCreation=!1,this.channelDeferred=new Ee,er(n.prototype,this,"bindRuntime").call(this,t),(yield this.isRoot())&&(t.makeVisibleAndAttachGraph!==void 0?t.makeVisibleAndAttachGraph():t.bindToContext())})}getInitialSnapshotDetails(){return v(this,null,function*(){if(this.detachedRuntimeCreation)throw new Error("Detached Fluid Data Store context can't be realized! Please attach runtime first!");return er(n.prototype,this,"getInitialSnapshotDetails").call(this)})}};Y();qt();Oe();var xh=n=>typeof n?.internalId=="string"&&typeof n?.alias=="string",_h=(n,e,t,r,i)=>new s0(n,e,t,r,i),Jr=function(n){return n.Aliased="Aliased",n.Aliasing="Aliasing",n.None="None",n}(Jr||{}),s0=class{constructor(e,t,r,i,o){this.fluidDataStoreChannel=e,this.internalId=t,this.runtime=r,this.datastores=i,this.logger=o,this.aliasState=Jr.None}trySetAlias(e){return v(this,null,function*(){if(e.includes("/"))throw new ye(`The alias cannot contain slashes: '${e}'`);switch(this.aliasState){case Jr.Aliasing:return w(this.aliasResult!==void 0,790),yield this.aliasResult,this.alias===e?"Success":"AlreadyAliased";case Jr.Aliased:return this.alias===e?"Success":"AlreadyAliased";case Jr.None:break;default:mt(this.aliasState)}return this.aliasState=Jr.Aliasing,this.aliasResult=this.trySetAliasInternal(e),this.aliasResult})}trySetAliasInternal(e){return v(this,null,function*(){let t={internalId:this.internalId,alias:e};if(this.fluidDataStoreChannel.makeVisibleAndAttachGraph!==void 0?this.fluidDataStoreChannel.makeVisibleAndAttachGraph():this.fluidDataStoreChannel.bindToContext(),this.runtime.attachState===oe.Detached){let i=this.datastores.processAliasMessageCore(t);return this.aliasState=Jr.Aliased,i?"Success":"Conflict"}return(yield this.ackBasedPromise(i=>{this.runtime.submitDataStoreAliasOp(t,i)}).then(i=>(this.aliasState=Jr.Aliased,i&&(this.alias=e),i)).catch(i=>(this.logger.sendErrorEvent({eventName:"AliasingException",alias:{value:e,tag:Ne.UserData},internalId:{value:this.internalId,tag:Ne.PackageData}},i),this.aliasState=Jr.None,!1)))?"Success":"Conflict"})}request(e){return v(this,null,function*(){return this.fluidDataStoreChannel.request(e)})}get IFluidRouter(){return this.fluidDataStoreChannel}ackBasedPromise(e){return v(this,null,function*(){let t;return new Promise((r,i)=>{if(t=()=>i(new Error("ContainerRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed){t();return}this.runtime.on("dispose",t),e(r,i)}).finally(()=>{this.runtime.off("dispose",t)})})}};var yh=class{constructor(e,t,r,i,o,a,s,c,l,h,u=new uh(a)){this.baseSnapshot=e,this.runtime=t,this.submitAttachFn=r,this.getCreateChildSummarizerNodeFn=i,this.deleteChildSummarizerNodeFn=o,this.gcNodeUpdated=c,this.aliasMap=l,this.writeGCDataAtRoot=h,this.contexts=u,this.pendingAttach=new Map,this.attachOpFiredForDataStore=new Set,this.disposeOnce=new On(()=>this.contexts.dispose()),this.dataStoresSinceLastGC=[],this.dispose=()=>this.disposeOnce.value,this.logger=ue.create(a),this.containerRuntimeHandle=new Qn(this.runtime,"/",this.runtime.IFluidHandleContext);let d=new Rt(()=>v(this,null,function*(){return s()})),p=x=>v(this,null,function*(){return(yield d).get(x)}),m=new Map;if(e)for(let[x,b]of Object.entries(e.trees))m.set(x,b);let f=0;for(let[x,b]of m){let _;if(b.unreferenced&&f++,this.runtime.attachState!==oe.Detached)_=new Xc({id:x,snapshotTree:b,getBaseGCDetails:()=>v(this,null,function*(){return p(x)}),runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(x,{type:Hi.CreateSummarizerNodeSource.FromSummary}),writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels});else{if(typeof b!="object")throw new Be("Snapshot should be there to load from!!");let O=b;_=new Jc({id:x,pkg:void 0,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(x,{type:Hi.CreateSummarizerNodeSource.FromSummary}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(x),snapshotTree:O,isRootDataStore:void 0,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels})}this.contexts.addBoundOrRemoted(_)}this.containerLoadStats={containerLoadDataStoreCount:m.size,referencedDataStoreCount:m.size-f}}aliases(){return this.aliasMap}processAttachMessage(e,t){var r,i;let o=e.contents;if(this.dataStoresSinceLastGC.push(o.id),t){w(this.pendingAttach.has(o.id),350),(r=this.contexts.get(o.id))===null||r===void 0||r.emit("attached"),this.pendingAttach.delete(o.id);return}if(this.alreadyProcessed(o.id))throw new Xt("Duplicate DataStore created with existing id",Object.assign(Object.assign({},ur(e)),{dataStoreId:{value:o.id,tag:Ne.PackageData}}));let a=new Map,s;o.snapshot&&(s=ru(o.snapshot.entries,a));let c=[o.type],l=new Xc({id:o.id,snapshotTree:s,getBaseGCDetails:()=>v(this,null,function*(){return{}}),runtime:this.runtime,storage:new zd(this.runtime.storage,a),scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(o.id,{type:Hi.CreateSummarizerNodeSource.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:(i=o.snapshot)!==null&&i!==void 0?i:{entries:[MA(c,!0,this.runtime.disableIsolatedChannels)]}}),writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels,pkg:c});this.contexts.addBoundOrRemoted(l)}processAliasMessage(e,t,r){let i=e.contents;if(!xh(i))throw new Xt("malformedDataStoreAliasMessage",Object.assign({},ur(e)));let o=t,a=this.processAliasMessageCore(i);r&&o(a)}processAliasMessageCore(e){if(this.alreadyProcessed(e.alias))return!1;let t=this.contexts.get(e.internalId);if(t===void 0)return this.logger.sendErrorEvent({eventName:"AliasFluidDataStoreNotFound",fluidDataStoreId:e.internalId}),!1;let r=new Qn(t,e.internalId,this.runtime.IFluidHandleContext);return this.runtime.addedGCOutboundReference(this.containerRuntimeHandle,r),this.aliasMap.set(e.alias,t.id),t.setInMemoryRoot(),!0}alreadyProcessed(e){return this.aliasMap.get(e)!==void 0||this.contexts.get(e)!==void 0}makeDataStoreLocallyVisible(e){let t=this.contexts.getUnbound(e);if(w(!!t,351),this.runtime.attachState!==oe.Detached){t.emit("attaching");let r=t.generateAttachMessage();this.pendingAttach.set(e,r),this.submitAttachFn(r),this.attachOpFiredForDataStore.add(e)}this.contexts.bind(e)}createDetachedDataStoreCore(e,t,r=ke()){w(!r.includes("/"),780);let i=new bh({id:r,pkg:e,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(r,{type:Hi.CreateSummarizerNodeSource.Local}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(r),snapshotTree:void 0,isRootDataStore:t,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels});return this.contexts.addUnbound(i),i}_createFluidDataStoreContext(e,t,r,i){w(!t.includes("/"),781);let o=new Jc({id:t,pkg:e,runtime:this.runtime,storage:this.runtime.storage,scope:this.runtime.scope,createSummarizerNodeFn:this.getCreateChildSummarizerNodeFn(t,{type:Hi.CreateSummarizerNodeSource.Local}),makeLocallyVisibleFn:()=>this.makeDataStoreLocallyVisible(t),snapshotTree:void 0,isRootDataStore:r,writeGCDataAtRoot:this.writeGCDataAtRoot,disableIsolatedChannels:this.runtime.disableIsolatedChannels,createProps:i});return this.contexts.addUnbound(o),o}get disposed(){return this.disposeOnce.evaluated}resubmitDataStoreOp(e,t){let r=e,i=this.contexts.get(r.address);w(!!i,352),i.reSubmit(r.contents,t)}rollbackDataStoreOp(e,t){let r=e,i=this.contexts.get(r.address);w(!!i,744),i.rollback(r.contents,t)}applyStashedOp(e){return v(this,null,function*(){let t=e,r=this.contexts.get(t.address);return w(!!r,353),r.applyStashedOp(t.contents)})}applyStashedAttachOp(e){return v(this,null,function*(){this.pendingAttach.set(e.id,e),this.processAttachMessage({contents:e},!1)})}processFluidDataStoreOp(e,t,r){let i=e.contents,o=Object.assign(Object.assign({},e),{contents:i.contents}),a=this.contexts.get(i.address);w(!!a,354),a.process(o,t,r),this.gcNodeUpdated(`/${i.address}`,e.timestamp,a.isLoaded?a.packagePath:void 0)}getDataStore(e,t){return v(this,null,function*(){let r=yield this.contexts.getBoundOrRemoted(e,t);if(r===void 0){let i={url:e};throw qi(Ft(i),i)}return r})}processSignal(e,t,r){let i=this.contexts.get(e);if(!i){w(!r,355),this.logger.sendTelemetryEvent({eventName:"SignalFluidDataStoreNotFound",fluidDataStoreId:{value:e,tag:Ne.PackageData}});return}i.processSignal(t,r)}setConnectionState(e,t){for(let[r,i]of this.contexts)try{i.setConnectionState(e,t)}catch(o){this.logger.sendErrorEvent({eventName:"SetConnectionStateError",clientId:t,fluidDataStore:r},o)}}setAttachState(e){let t;e===oe.Attaching?t="attaching":t="attached";for(let[,r]of this.contexts)this.contexts.isNotBound(r.id)||r.emit(t)}get size(){return this.contexts.size}summarize(e,t,r){return v(this,null,function*(){let i=new Pt;return yield Promise.all(Array.from(this.contexts).filter(([o,a])=>(w(a.attachState!==oe.Attaching,357),a.attachState===oe.Attached)).map(s=>v(this,[s],function*([o,a]){let c=yield a.summarize(e,t,r);i.addWithStats(o,c)}))),i.getSummaryTree()})}createSummary(e){let t=new Pt,r;do{let i=t.summary.tree;r=this.contexts.notBoundLength(),Array.from(this.contexts).filter(([o,a])=>!(this.contexts.isNotBound(o)||i[o]||this.attachOpFiredForDataStore.has(o))).map(([o,a])=>{let s;if(a.isLoaded){let c=a.generateAttachMessage().snapshot;s=Ba(c,!0)}else w(!!this.baseSnapshot,358),s=qa(this.baseSnapshot.trees[o]);t.addWithStats(o,s)})}while(r!==this.contexts.notBoundLength());return t.getSummaryTree()}updateStateBeforeGC(){return v(this,null,function*(){for(let e of this.dataStoresSinceLastGC){let t=this.contexts.get(e);if(w(t!==void 0,694),yield t.isRoot()){let r=new Qn(t,e,this.runtime.IFluidHandleContext);this.runtime.addedGCOutboundReference(this.containerRuntimeHandle,r)}}this.dataStoresSinceLastGC=[]})}getGCData(e=!1){return v(this,null,function*(){let t=new Li;return yield Promise.all(Array.from(this.contexts).filter(([r,i])=>i.attachState===oe.Attached).map(o=>v(this,[o],function*([r,i]){let a=yield i.getGCData(e);t.prefixAndAddNodes(r,a.gcNodes)}))),t.addNode("/",yield this.getOutboundRoutes()),t.getGCData()})}updateUsedRoutes(e,t){var r;let i=Vu(e);for(let[o]of i)w(this.contexts.has(o),359);for(let[o,a]of this.contexts)a.updateUsedRoutes((r=i.get(o))!==null&&r!==void 0?r:[],t)}deleteUnusedRoutes(e){for(let t of e){let r=t.split("/");if(r.length>2)continue;let i=r[1];w(this.contexts.has(i),727),this.contexts.delete(i),this.deleteChildSummarizerNodeFn(i)}}getOutboundRoutes(){return v(this,null,function*(){let e=[];for(let[t,r]of this.contexts)(yield r.isRoot())&&e.push(`/${t}`);return e})}getDataStorePackagePath(e){return v(this,null,function*(){var t;let r=this.contexts.get(e.split("/")[1]);return(t=yield r?.getInitialSnapshotDetails())===null||t===void 0?void 0:t.pkg})}getGCNodeType(e){let t=e.split("/");if(this.contexts.has(t[1]))return t.length===2?Yt.DataStore:Yt.SubDataStore}};function fh(n,e){if(n)if(wA(e)){let t=n.trees[Hi.channelsTreeName];return w(!!t,360),t}else{let t={};for(let[r,i]of Object.entries(n.trees))PA.includes(r)||(t[r]=i);return Object.assign(Object.assign({},n),{trees:t})}}Y();var Ui=function(n){return n[n.Local=0]="Local",n[n.Broadcast=1]="Broadcast",n[n.Acked=2]="Acked",n[n.Nacked=-1]="Nacked",n}(Ui||{}),Ch=class n{constructor(e,t){this.clientId=e,this.clientSequenceNumber=t,this.state=Ui.Local,this.defSummaryOp=new Ee,this.defSummaryAck=new Ee}static createLocal(e,t){return new n(e,t)}static createFromOp(e){let t=new n(e.clientId,e.clientSequenceNumber);return t.broadcast(e),t}get summaryOp(){return this._summaryOp}get summaryAckNack(){return this._summaryAckNack}hasBeenAcked(){return this.state===Ui.Acked}broadcast(e){return w(this.state===Ui.Local,373),this._summaryOp=e,this.defSummaryOp.resolve(),this.state=Ui.Broadcast,!0}ackNack(e){return w(this.state===Ui.Broadcast,374),this._summaryAckNack=e,this.defSummaryAck.resolve(),this.state=e.type===lt.SummaryAck?Ui.Acked:Ui.Nacked,!0}waitBroadcast(){return v(this,null,function*(){return yield this.defSummaryOp.promise,this._summaryOp})}waitAckNack(){return v(this,null,function*(){return yield this.defSummaryAck.promise,this._summaryAckNack})}},c0=class{constructor(e,t){this.clientId=e,this.summaryCollection=t,this.localSummaries=new Map,this._disposed=!1}get disposed(){return this._disposed}watchSummary(e){let t=this.localSummaries.get(e);return t||(t=Ch.createLocal(this.clientId,e),this.localSummaries.set(t.clientSequenceNumber,t)),t}waitFlushed(){return this.summaryCollection.waitFlushed()}tryGetSummary(e){return this.localSummaries.get(e)}setSummary(e){this.localSummaries.set(e.clientSequenceNumber,e)}dispose(){this.summaryCollection.removeWatcher(this.clientId),this._disposed=!0}},wh=class extends Pe{constructor(e,t){super(),this.deltaManager=e,this.logger=t,this.summaryWatchers=new Map,this.pendingSummaries=new Map,this.refreshWaitNextAck=new Ee,this.deltaManager.on("op",r=>this.handleOp(r))}get latestAck(){return this.lastAck}emit(e,...t){return super.emit(e,...t)}get opsSinceLastAck(){var e,t;return this.deltaManager.lastSequenceNumber-((t=(e=this.lastAck)===null||e===void 0?void 0:e.summaryAck.sequenceNumber)!==null&&t!==void 0?t:this.deltaManager.initialSequenceNumber)}addOpListener(e){this.deltaManager.on("op",e)}removeOpListener(e){this.deltaManager.off("op",e)}createWatcher(e){let t=new c0(e,this);return this.summaryWatchers.set(e,t),t}removeWatcher(e){this.summaryWatchers.delete(e)}setPendingAckTimerTimeoutCallback(e,t){this.maxAckWaitTime=e,this.pendingAckTimerTimeoutCallback=t}unsetPendingAckTimerTimeoutCallback(){this.maxAckWaitTime=void 0,this.pendingAckTimerTimeoutCallback=void 0}waitFlushed(){return v(this,null,function*(){for(;this.pendingSummaries.size>0;){let e=Array.from(this.pendingSummaries,([,t])=>t.waitAckNack());yield Promise.all(e)}return this.lastAck})}waitSummaryAck(e){return v(this,null,function*(){for(;!this.lastAck||this.lastAck.summaryOp.referenceSequenceNumber<e;)yield this.refreshWaitNextAck.promise;return this.lastAck})}handleOp(e){var t;switch(e.type){case lt.Summarize:{this.handleSummaryOp(e);return}case lt.SummaryAck:{this.handleSummaryAck(e);return}case lt.SummaryNack:{this.handleSummaryNack(e);return}default:{let r=e.timestamp;this.lastSummaryTimestamp!==void 0&&this.maxAckWaitTime!==void 0&&r-this.lastSummaryTimestamp>=this.maxAckWaitTime&&((t=this.pendingAckTimerTimeoutCallback)===null||t===void 0||t.call(this)),this.emit("default",e);return}}}handleSummaryOp(e){let t,r=this.summaryWatchers.get(e.clientId);r&&(t=r.tryGetSummary(e.clientSequenceNumber),t&&t.broadcast(e)),t||(t=Ch.createFromOp(e),r&&r.setSummary(t)),this.pendingSummaries.set(e.sequenceNumber,t),this.lastSummaryTimestamp=e.timestamp,this.emit(lt.Summarize,e)}handleSummaryAck(e){let t=e.contents.summaryProposal.summarySequenceNumber,r=this.pendingSummaries.get(t);if(!r||r.summaryOp===void 0){t>=this.deltaManager.initialSequenceNumber&&this.logger.sendErrorEvent({eventName:"SummaryAckWithoutOp",sequenceNumber:e.sequenceNumber,summarySequenceNumber:t,initialSequenceNumber:this.deltaManager.initialSequenceNumber});return}r.ackNack(e),this.pendingSummaries.delete(t),(!this.lastAck||t>this.lastAck.summaryAck.contents.summaryProposal.summarySequenceNumber)&&(this.lastAck={summaryOp:r.summaryOp,summaryAck:e},this.refreshWaitNextAck.resolve(),this.refreshWaitNextAck=new Ee,this.emit(lt.SummaryAck,e))}handleSummaryNack(e){let t=e.contents.summaryProposal.summarySequenceNumber,r=this.pendingSummaries.get(t);r&&(r.ackNack(e),this.pendingSummaries.delete(t),this.emit(lt.SummaryNack,e))}};Y();Oe();var Ph=class extends Pe{constructor(e,t,r){super(),this.clientMap=new Map,this.rootNode={sequenceNumber:-1,olderClient:void 0,youngerClient:void 0},this._youngestClient=this.rootNode,this.logger=ue.create(e,"OrderedClientCollection");let i=r.getMembers();for(let[o,a]of i)this.addClient(o,a);r.on("addMember",(o,a)=>{let s=this.addClient(o,a);this.emit("addClient",s,t.lastSequenceNumber)}),r.on("removeMember",o=>{let a=t.lastSequenceNumber,s=this.removeClient(o);s===void 0?this.logger.sendErrorEvent({eventName:"ClientNotFound",clientId:o,sequenceNumber:a}):this.emit("removeClient",s,a)})}get count(){return this.clientMap.size}get oldestClient(){return this.rootNode.youngerClient}addClient(e,t){w(t.sequenceNumber>-1,502);let r=this._youngestClient;for(;r.sequenceNumber>t.sequenceNumber;)w(r.olderClient!==void 0,503),r=r.olderClient;let i={clientId:e,sequenceNumber:t.sequenceNumber,client:Object.assign({},t.client),olderClient:r,youngerClient:r.youngerClient};return i.olderClient.youngerClient=i,i.youngerClient===void 0?this._youngestClient=i:i.youngerClient.olderClient=i,this.clientMap.set(e,i),i}removeClient(e){let t=this.clientMap.get(e);if(t!==void 0)return t.olderClient.youngerClient=t.youngerClient,t.youngerClient===void 0?this._youngestClient=t.olderClient:t.youngerClient.olderClient=t.olderClient,this.clientMap.delete(e),t}getAllClients(){let e=[],t=this.rootNode;for(;t.youngerClient!==void 0;)e.push(t.youngerClient),t=t.youngerClient;return e}},Oh=class extends Pe{constructor(e,t,r,i){super(),this.orderedClientCollection=t,this.isEligibleFn=i,this._eligibleCount=0;let o,a;for(let s of t.getAllClients())this.addClient(s,0),typeof r!="number"&&(s.clientId===r.electedClientId&&(o=s,r.electedParentId===void 0&&s.client.details.type!==Jt&&(a=s)),s.clientId===r.electedParentId&&(a=s));t.on("addClient",(s,c)=>this.addClient(s,c)),t.on("removeClient",(s,c)=>this.removeClient(s,c)),typeof r=="number"?this._electionSequenceNumber=r:(o?.clientId!==r.electedClientId?e.sendErrorEvent({eventName:"InitialElectedClientNotFound",electionSequenceNumber:r.electionSequenceNumber,expectedClientId:r.electedClientId,electedClientId:o?.clientId,clientCount:t.count}):o!==void 0&&!i(o)&&(o=a=this.findFirstEligibleParent(a),e.sendErrorEvent({eventName:"InitialElectedClientIneligible",electionSequenceNumber:r.electionSequenceNumber,expectedClientId:r.electedClientId,electedClientId:o?.clientId})),this._electedParent=a,this._electedClient=o,this._electionSequenceNumber=r.electionSequenceNumber)}get eligibleCount(){return this._eligibleCount}get electionSequenceNumber(){return this._electionSequenceNumber}get electedClient(){return this._electedClient}get electedParent(){return this._electedParent}tryElectingClient(e,t){let r=!1,i=e?.client.details.type===Jt,o=this._electedClient;this._electedClient!==e&&(this._electionSequenceNumber=t,this._electedClient=e,r=!0),this._electedParent!==e&&!i&&(this._electedParent=e,r=!0),r&&this.emit("election",e,t,o)}tryElectingParent(e,t){this._electedParent!==e&&(this._electedParent=e,this.emit("election",this._electedClient,t,this._electedClient))}findFirstEligibleParent(e){let t=e;for(;t!==void 0&&(!this.isEligibleFn(t)||t.client.details.type===Jt);)t=t.youngerClient;return t}addClient(e,t){var r;if(this.isEligibleFn(e)){this._eligibleCount++;let i=e.client.details.type===Jt,o=((r=this._electedClient)===null||r===void 0?void 0:r.client.details.type)===Jt;this._electedClient===void 0||!o&&i?this.tryElectingClient(e,t):this._electedParent===void 0&&!i&&this.tryElectingParent(e,t)}}removeClient(e,t){var r,i,o,a,s;if(this.isEligibleFn(e)){if(this._eligibleCount--,this._electedClient===e)if(this._electedParent!==e){if(this._electedClient.client.details.type!==Jt)throw new ye("Elected client should be a summarizer client 1");this.tryElectingClient(this._electedParent,t)}else{let c=(i=this.findFirstEligibleParent((r=this._electedParent)===null||r===void 0?void 0:r.youngerClient))!==null&&i!==void 0?i:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this.tryElectingClient(c,t)}else if(this._electedParent===e){if(((o=this._electedClient)===null||o===void 0?void 0:o.client.details.type)!==Jt)throw new ye("Elected client should be a summarizer client 2");let c=(s=this.findFirstEligibleParent((a=this._electedParent)===null||a===void 0?void 0:a.youngerClient))!==null&&s!==void 0?s:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this.tryElectingParent(c,t)}}}getAllEligibleClients(){return this.orderedClientCollection.getAllClients().filter(this.isEligibleFn)}incrementElectedClient(e){var t,r;let i=(r=this.findFirstEligibleParent((t=this._electedParent)===null||t===void 0?void 0:t.youngerClient))!==null&&r!==void 0?r:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this._electedClient===void 0||this._electedClient===this._electedParent?this.tryElectingClient(i,e):this.tryElectingParent(i,e)}resetElectedClient(e){let t=this.findFirstEligibleParent(this.orderedClientCollection.oldestClient);this._electedClient===void 0||this._electedClient===this._electedParent?this.tryElectingClient(t,e):this.tryElectingParent(t,e)}peekNextElectedClient(){var e,t;return(t=this.findFirstEligibleParent((e=this._electedParent)===null||e===void 0?void 0:e.youngerClient))!==null&&t!==void 0?t:this.findFirstEligibleParent(this.orderedClientCollection.oldestClient)}serialize(){var e,t;return{electionSequenceNumber:this.electionSequenceNumber,electedClientId:(e=this.electedClient)===null||e===void 0?void 0:e.clientId,electedParentId:(t=this.electedParent)===null||t===void 0?void 0:t.clientId}}};var Mh=class{constructor(e,t,r){this.delayWindowMs=e,this.maxDelayMs=t,this.delayFn=r,this.startTimes=[]}get numAttempts(){return this.startTimes.length}getAttempts(){return[...this.startTimes]}get latestAttemptTime(){return this.startTimes.length>0?this.startTimes[this.startTimes.length-1]:void 0}getDelay(){let e=Date.now(),t=this.latestAttemptTime;if(t!==void 0){let i=t-e;i>0&&(this.startTimes=this.startTimes.map(o=>o-i))}this.startTimes=this.startTimes.filter(i=>e-i<this.delayWindowMs);let r=Math.min(this.delayFn(this.startTimes.length),this.maxDelayMs);return this.startTimes.push(e),this.startTimes=this.startTimes.map(i=>i+r),r===this.maxDelayMs&&this.startTimes.shift(),r}},EA=({multiplier:n=2,coefficient:e=1,offset:t=0,initialDelay:r=void 0}={})=>i=>Math.max(0,i<=0&&r!==void 0?r:e*Math.pow(n,i)+t);Y();var Qde={cancelled:!1,waitCancelled:new Promise(()=>{})},Sh=class n{constructor(e){this.runtime=e,this._cancelled=!1,this.stopDeferred=new Ee}get cancelled(){return this._cancelled||w(this.runtime.deltaManager.active,605),this._cancelled}get waitCancelled(){return this.stopDeferred.promise}static create(e){return v(this,null,function*(){let t=new n(e);return yield t.waitStart(),t})}waitStart(){return v(this,null,function*(){if(this.runtime.disposed){this.stop("summarizerClientDisconnected");return}if(this.runtime.once("dispose",()=>this.stop("summarizerClientDisconnected")),!this.runtime.connected){let e=new Promise(t=>this.runtime.once("connected",t));yield Promise.race([e,this.waitCancelled])}this.runtime.once("disconnected",()=>this.stop("summarizerClientDisconnected"))})}stop(e){this._cancelled||(this._cancelled=!0,this.stopDeferred.resolve(e))}};Y();Oe();var l0=class{constructor(e,t,r,i,o=()=>de.now()){this.batchEventEmitter=e,this.trackedBatchCount=0,this.logger=ue.create(t,"Batching"),this.batchEventEmitter.on("batchBegin",a=>{this.startBatchSequenceNumber=a.sequenceNumber,this.batchProcessingStartTimeStamp=o(),this.trackedBatchCount++}),this.batchEventEmitter.on("batchEnd",(a,s)=>{w(this.startBatchSequenceNumber!==void 0&&this.batchProcessingStartTimeStamp!==void 0,698);let c=s.sequenceNumber-this.startBatchSequenceNumber+1;c>=r&&this.logger.sendErrorEvent({eventName:"LengthTooBig",length:c,threshold:r,batchEndSequenceNumber:s.sequenceNumber,duration:o()-this.batchProcessingStartTimeStamp,batchError:a!==void 0}),this.trackedBatchCount%i===0&&this.logger.sendPerformanceEvent({eventName:"Length",length:c,samplingRate:i,batchEndSequenceNumber:s.sequenceNumber,duration:o()-this.batchProcessingStartTimeStamp}),this.startBatchSequenceNumber=void 0,this.batchProcessingStartTimeStamp=void 0})}},AA=(n,e,t=1e3,r=1e3)=>new l0(n,e,t,r);Y();var Ka=class{constructor(e,t){this.storageGetter=e,this.blobs=t}static serializeTree(e,t){return v(this,null,function*(){let r={};return yield this.serializeTreeCore(e,r,t),r})}static serializeTreeCore(e,t,r){return v(this,null,function*(){let i=[];for(let o of Object.values(e.trees))i.push(this.serializeTreeCore(o,t,r));for(let o of Object.values(e.blobs)){let a=yield r.readBlob(o);t[o]=gi(a,"utf8")}return Promise.all(i)})}static serializeTreeWithBlobContents(e){let t={};return this.serializeTreeWithBlobContentsCore(e,t),t}static serializeTreeWithBlobContentsCore(e,t){for(let r of Object.values(e.trees))this.serializeTreeWithBlobContentsCore(r,t);for(let r of Object.values(e.blobs)){let i=e.blobsContents[r];w(!!i,748),t[r]=gi(i,"utf8")}}get storage(){return this._storage?this._storage:(this._storage=this.storageGetter(),this._storage)}get repositoryUrl(){return this.storage.repositoryUrl}readBlob(e){return v(this,null,function*(){return this.blobs[e]!==void 0?Bn(this.blobs[e],"utf8"):this.storage.readBlob(e)})}getSnapshotTree(e){return v(this,null,function*(){return this.storage.getSnapshotTree(e)})}getVersions(e,t){return v(this,null,function*(){return this.storage.getVersions(e,t)})}createBlob(e){return v(this,null,function*(){return this.storage.createBlob(e)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.storage.uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.storage.downloadSummary(e)})}};var Eh=class n{constructor(e,t){this.messageSize=new Map,this._nonSystemOpCount=0,this._opsSizeAccumulator=0,!t&&(e.inbound.on("push",r=>{var i;let o=typeof r.contents=="string"?r.contents:(i=JSON.stringify(r.contents))!==null&&i!==void 0?i:"",a=n.messageHasData(r)?r.data:"";this.messageSize[n.messageId(r)]=o.length+a.length}),e.on("op",r=>{var i;this._nonSystemOpCount+=Ni(r)?1:0;let o=n.messageId(r);this._opsSizeAccumulator+=(i=this.messageSize[o])!==null&&i!==void 0?i:0,this.messageSize.delete(o)}))}get nonSystemOpCount(){return this._nonSystemOpCount}get opsSizeAccumulator(){return this._opsSizeAccumulator}static messageId(e){return e.sequenceNumber}static messageHasData(e){return e.data!==void 0}reset(){this._nonSystemOpCount=0,this._opsSizeAccumulator=0}};var We=function(n){return n.FluidDataStoreOp="component",n.Attach="attach",n.ChunkedOp="chunkedOp",n.BlobAttach="blobAttach",n.Rejoin="rejoin",n.Alias="alias",n}(We||{}),kA={state:"enabled",idleTime:5e3*3,maxTime:5e3*12,maxOps:100,minOpsForLastSummaryAttempt:10,maxAckWaitTime:6*10*1e3,maxOpsSinceLastSummary:7e3,initialSummarizerDelayMs:5e3,summarizerClientElection:!1},Tr=function(n){return n.wait="wait",n.externalRequest="externalRequest",n.viaHandle="viaHandle",n}(Tr||{}),iV="Fluid.ContainerRuntime.UseDataStoreAliasing",oV="Fluid.ContainerRuntime.MaxConsecutiveReconnects",aV="Fluid.ContainerRuntime.MaxOpSizeInBytes",sV=768e3,cV="Fluid.ContainerRuntime.DisableOpTracking",lV=hr.FlushMode.TurnBased;function DA(n){if(n.type===lt.Operation){if(n.contents.address!==void 0&&n.contents.type===void 0)n.type=We.FluidDataStoreOp;else{let e=n.contents;w(e.type!==void 0,289),n.type=e.type,n.contents=e.contents}w(yo(n),290)}return n}var d0=class{constructor(e,t){this.deltaManager=e,this.logger=t,this.localPaused=!1,this.timePaused=0,this.batchCount=0,this.deltaManager.on("prepareSend",i=>{if(i.length===0)return;let o=i[0].metadata;if(!o?.batch)return;if(i.length===1){delete o.batch;return}let a=i[i.length-1];a.metadata=Object.assign(Object.assign({},a.metadata),{batch:!1})}),this.deltaManager.inbound.on("push",i=>{this.trackPending(i)}),w(!this.localPaused,659);let r=this.deltaManager.inbound.toArray();for(let i of r)this.trackPending(i);this.deltaManager.on("op",i=>this.afterOpProcessing(i.sequenceNumber))}afterOpProcessing(e){if(w(!this.localPaused,660),this.deltaManager.inbound.length===0){w(this.pauseSequenceNumber===void 0,661);return}this.pauseSequenceNumber!==void 0&&(w(e<this.pauseSequenceNumber,662),e+1===this.pauseSequenceNumber&&this.pauseQueue())}pauseQueue(){w(!this.localPaused,663),this.localPaused=!0,this.timePaused=de.now(),this.deltaManager.inbound.pause()}resumeQueue(e,t){let r=t.sequenceNumber,i=this.localPaused?de.now()-this.timePaused:void 0;this.batchCount++,this.batchCount%1e3===1&&this.logger.sendTelemetryEvent({eventName:"BatchStats",sequenceNumber:r,length:r-e+1,msnDistance:r-t.minimumSequenceNumber,duration:i,batchCount:this.batchCount,interrupted:this.localPaused}),this.localPaused&&(this.localPaused=!1,i!==void 0&&i>Xv&&this.logger.sendErrorEvent({eventName:"MaxBatchWaitTimeExceeded",duration:i,sequenceNumber:r,length:r-e}),this.deltaManager.inbound.resume())}trackPending(e){w(this.deltaManager.inbound.length!==0,664),w(this.currentBatchClientId===void 0==(this.pauseSequenceNumber===void 0),665);let t=e.metadata,r=t?.batch;if(!yo(e)){w(this.currentBatchClientId===void 0,666),w(r===void 0,667),w(!this.localPaused,668);return}if(this.currentBatchClientId===void 0&&r===void 0){w(!this.localPaused,669);return}if((this.currentBatchClientId!==void 0||r===!1)&&this.currentBatchClientId!==e.clientId)throw new Xt("OpBatchIncomplete",Object.assign({runtimeVersion:Kc,batchClientId:this.currentBatchClientId},ur(e)));r?(w(this.currentBatchClientId===void 0,670),w(!this.localPaused,671),this.pauseSequenceNumber=e.sequenceNumber,this.currentBatchClientId=e.clientId,this.deltaManager.inbound.length===1&&this.pauseQueue()):r===!1?(w(this.pauseSequenceNumber!==void 0,672),this.resumeQueue(this.pauseSequenceNumber,e),this.pauseSequenceNumber=void 0,this.currentBatchClientId=void 0):w(this.currentBatchClientId!==void 0,673)}},Ah=class{constructor(e,t,r){this.deltaManager=e,this.emitter=t,this.logger=r,this.hitError=!1,this.deltaScheduler=new pA(this.deltaManager,ue.create(this.logger,"DeltaScheduler")),new d0(e,r)}beforeOpProcessing(e){var t;this.batchClientId!==e.clientId&&(w(this.batchClientId===void 0,674),this.emitter.emit("batchBegin",e),this.deltaScheduler.batchBegin(e),((t=e?.metadata)===null||t===void 0?void 0:t.batch)?this.batchClientId=e.clientId:this.batchClientId=void 0)}afterOpProcessing(e,t){var r;if(w(!this.hitError,675),e){this.hitError=!0,this.batchClientId=void 0,this.emitter.emit("batchEnd",e,t),this.deltaScheduler.batchEnd(t);return}let i=(r=t?.metadata)===null||r===void 0?void 0:r.batch;if(this.batchClientId===void 0||i===!1){this.batchClientId=void 0,this.emitter.emit("batchEnd",void 0,t),this.deltaScheduler.batchEnd(t);return}}},u0="_scheduler";function dV(){try{if(typeof navigator=="object"&&navigator!==null)return{deviceMemory:navigator.deviceMemory,hardwareConcurrency:navigator.hardwareConcurrency}}catch{}return{}}var Qc=class n extends Pe{constructor(e,t,r,i,o,a,s,c,l,h,u,d,p,m){var f,x,b,_,O,S,E,F,I;m===void 0&&(m=Object.assign(Object.assign({},kA),(f=s.summaryOptions)===null||f===void 0?void 0:f.summaryConfigOverrides)),super(),this.context=e,this.registry=t,this.runtimeOptions=s,this.containerScope=c,this.logger=l,this._storage=d,this.requestHandler=p,this.summaryConfiguration=m,this.defaultMaxConsecutiveReconnects=15,this._orderSequentiallyCalls=0,this.needsFlush=!1,this.flushTrigger=!1,this.savedOps=[],this.consecutiveReconnects=0,this._disposed=!1,this.emitDirtyDocumentEvent=!0,this.defaultTelemetrySignalSampleCount=100,this._perfSignalData={signalsLost:0,signalSequenceNumber:0,signalTimestamp:0,trackingSignalSequenceNumber:void 0},this.summarizeOnDemand=(...A)=>{if(this.clientDetails.type===Jt)return this.summarizer.summarizeOnDemand(...A);if(this.summaryManager!==void 0)return this.summaryManager.summarizeOnDemand(...A);throw new ye(`Can't summarize, disableSummaries: ${this.summariesDisabled}`)},this.enqueueSummarize=(...A)=>{if(this.clientDetails.type===Jt)return this.summarizer.enqueueSummarize(...A);if(this.summaryManager!==void 0)return this.summaryManager.enqueueSummarize(...A);throw new ye(`Can't summarize, disableSummaries: ${this.summariesDisabled}`)},this.messageAtLastSummary=r?.message,this.disableIsolatedChannels=(x=this.runtimeOptions.summaryOptions.disableIsolatedChannels)!==null&&x!==void 0?x:!1,this._connected=this.context.connected,this.chunkMap=new Map(o),this.handleContext=new Ku("",this),this.mc=Mn(ue.create(this.logger,"ContainerRuntime")),this.summariesDisabled=this.isSummariesDisabled(),this.heuristicsDisabled=this.isHeuristicsDisabled(),this.summarizerClientElectionEnabled=this.isSummarizerClientElectionEnabled(),this.maxOpsSinceLastSummary=this.getMaxOpsSinceLastSummary(),this.initialSummarizerDelayMs=this.getInitialSummarizerDelayMs(),this._aliasingEnabled=((b=this.mc.config.getBoolean(iV))!==null&&b!==void 0?b:!1)||((_=s.useDataStoreAliasing)!==null&&_!==void 0?_:!1),this._maxOpSizeInBytes=(O=this.mc.config.getNumber(aV))!==null&&O!==void 0?O:sV,this.maxConsecutiveReconnects=(S=this.mc.config.getNumber(oV))!==null&&S!==void 0?S:this.defaultMaxConsecutiveReconnects,this._flushMode=s.flushMode;let y=e.pendingLocalState,P=(E=y?.baseSnapshot)!==null&&E!==void 0?E:e.baseSnapshot;this.garbageCollector=ph.create({runtime:this,gcOptions:this.runtimeOptions.gcOptions,baseSnapshot:P,baseLogger:this.mc.logger,existing:h,metadata:r,isSummarizerClient:this.context.clientDetails.type===Jt,getNodePackagePath:A=>v(this,null,function*(){return this.getGCNodePackagePath(A)}),getLastSummaryTimestampMs:()=>{var A;return(A=this.messageAtLastSummary)===null||A===void 0?void 0:A.timestamp},readAndParseBlob:A=>v(this,null,function*(){return Ze(this.storage,A)})});let C=this.deltaManager.initialSequenceNumber;if(this.summarizerNode=Hu(ue.create(this.logger,"SummarizerNode"),(A,T,k)=>v(this,null,function*(){return this.summarizeInternal(A,T,k)}),C,P?C:void 0,{canReuseHandle:!1,throwOnFailure:!0,gcDisabled:!this.garbageCollector.shouldRunGC}),P&&this.summarizerNode.loadBaseSummaryWithoutDifferential(P),this.dataStores=new yh(fh(P,r),this,A=>this.submit(We.Attach,A),(A,T)=>(k,D,R)=>this.summarizerNode.createChild(k,A,T,void 0,D,R),A=>this.summarizerNode.deleteChild(A),this.mc.logger,()=>v(this,null,function*(){return this.garbageCollector.getBaseGCDetails()}),(A,T,k)=>this.garbageCollector.nodeUpdated(A,"Changed",T,k),new Map(a),this.garbageCollector.writeDataAtRoot),this.blobManager=new Ua(this.handleContext,u,()=>this.storage,A=>this.submit(We.BlobAttach,void 0,void 0,{blobId:A}),A=>this.garbageCollector.nodeUpdated(A,"Loaded"),this,this.logger),this.scheduleManager=new Ah(e.deltaManager,this,ue.create(this.logger,"ScheduleManager")),this.deltaSender=this.deltaManager,this.pendingStateManager=new lh({applyStashedOp:this.applyStashedOp.bind(this),clientId:()=>this.clientId,close:this.closeFn,connected:()=>this.connected,flush:this.flush.bind(this),flushMode:()=>this.flushMode,reSubmit:this.reSubmit.bind(this),rollback:this.rollback.bind(this),setFlushMode:A=>this.setFlushMode(A)},this._flushMode,y?.pending),this.context.quorum.on("removeMember",A=>{this.clearPartialChunks(A)}),this.summaryCollection=new wh(this.deltaManager,this.logger),this.dirtyContainer=this.context.attachState!==oe.Attached||this.pendingStateManager.hasPendingMessages(),this.context.updateDirtyContainerState(this.dirtyContainer),this.summariesDisabled)this.mc.logger.sendTelemetryEvent({eventName:"SummariesDisabled"});else{let A=ue.create(this.logger,"OrderedClientElection"),T=new Ph(A,this.context.deltaManager,this.context.quorum),k=new Oh(A,T,i??this.context.deltaManager.lastSequenceNumber,$u.isClientEligible);if(this.summarizerClientElection=new $u(A,this.summaryCollection,k,this.maxOpsSinceLastSummary,this.summarizerClientElectionEnabled),this.context.clientDetails.type===Jt)this._summarizer=new sh("/_summarizer",this,()=>this.summaryConfiguration,this,this.handleContext,this.summaryCollection,D=>v(this,null,function*(){return Sh.create(D)}));else if($u.clientDetailsPermitElection(this.context.clientDetails)){let D=()=>{this.summaryCollection.opsSinceLastAck>this.maxOpsSinceLastSummary&&(this.logger.sendErrorEvent({eventName:"SummaryStatus:Behind"}),this.summaryCollection.once(lt.SummaryAck,()=>{this.logger.sendTelemetryEvent({eventName:"SummaryStatus:CaughtUp"}),this.summaryCollection.on("default",D)}),this.summaryCollection.off("default",D))};this.summaryCollection.on("default",D),this.summaryManager=new hA(this.summarizerClientElection,this,this.summaryCollection,this.logger,this.formRequestSummarizerFn(this.context.loader),new Mh(60*1e3,30*1e3,EA({coefficient:20,initialDelay:0})),{initialDelayMs:this.initialSummarizerDelayMs},this.heuristicsDisabled),this.summaryManager.start()}}this.deltaManager.on("readonly",A=>{w(A===this.deltaManager.readOnlyInfo.readonly,292),w(!A||!this.connected,293),this.replayPendingStates()}),l.sendTelemetryEvent(Object.assign({eventName:"DeviceSpec"},dV()));let M;h?(this.createContainerMetadata={createContainerRuntimeVersion:r?.createContainerRuntimeVersion,createContainerTimestamp:r?.createContainerTimestamp},M=(I=(F=r?.summaryNumber)!==null&&F!==void 0?F:r?.summaryCount)!==null&&I!==void 0?I:0):(this.createContainerMetadata={createContainerRuntimeVersion:Kc,createContainerTimestamp:Date.now()},M=0),this.nextSummaryNumber=M+1,this.logger.sendTelemetryEvent(Object.assign(Object.assign(Object.assign({eventName:"ContainerLoadStats"},this.createContainerMetadata),this.dataStores.containerLoadStats),{summaryNumber:M,summaryFormatVersion:r?.summaryFormatVersion,disableIsolatedChannels:r?.disableIsolatedChannels,gcVersion:r?.gcFeature})),gA(this.context.clientId,this.deltaManager,this.logger),AA(this,this.logger),this.opTracker=new Eh(this.deltaManager,this.mc.config.getBoolean(cV)===!0)}get IContainerRuntime(){return this}get IFluidRouter(){return this}static load(s,c,l){return v(this,arguments,function*(e,t,r,i={},o=e.scope,a){var h,u,d;let p=e,m=(h=p.taggedLogger)!==null&&h!==void 0?h:new bc(p.logger),f=ue.create(m,void 0,{all:{runtimeVersion:Kc}}),{summaryOptions:x={},gcOptions:b={},loadSequenceNumberVerification:_="close",useDataStoreAliasing:O=!1,flushMode:S=lV,enableOfflineLoad:E=!1}=i,F=e.pendingLocalState,I=(u=F?.baseSnapshot)!==null&&u!==void 0?u:e.baseSnapshot,y=F?new Ka(()=>e.storage,F.snapshotBlobs):e.storage,P=new Kr(t),C=V=>v(this,null,function*(){let G=I?.blobs[V];if(I&&G)return w(y!==void 0,501),Ze(y,G)}),[M,A,T,k]=yield Promise.all([C(i0),C($c),C(o0),C(r0)]),D=a===!0||e.existing===!0,R=yield Ua.load(I?.trees[mh],V=>v(this,null,function*(){return w(y!==void 0,598),Ze(y,V)})),N=(d=A?.message)===null||d===void 0?void 0:d.sequenceNumber;if(!F&&N!==void 0){let V=e.deltaManager.initialSequenceNumber;if(_!=="bypass"&&N!==V){let G=new Xt("Summary metadata mismatch",{runtimeVersion:Kc,runtimeSequenceNumber:N,protocolSequenceNumber:V});_==="log"?f.sendErrorEvent({eventName:"SequenceNumberMismatch"},G):e.closeFn(G)}}let L=new n(e,P,A,T,M??[],k??[],{summaryOptions:x,gcOptions:b,loadSequenceNumberVerification:_,useDataStoreAliasing:O,flushMode:S,enableOfflineLoad:E},o,f,D,R,y,r);return F&&(yield L.processSavedOps(F),F.savedOps=[]),yield L.getSnapshotBlobs(),L})}get options(){return this.context.options}get clientId(){return this.context.clientId}get clientDetails(){return this.context.clientDetails}get deltaManager(){return this.context.deltaManager}get storage(){return this._storage}get reSubmitFn(){return this.reSubmit}get closeFn(){return this.context.closeFn}get flushMode(){return this._flushMode}get scope(){return this.containerScope}get IFluidDataStoreRegistry(){return this.registry}get attachState(){return this.context.attachState}get IFluidHandleContext(){return this.handleContext}get connected(){return this._connected}get summarizerClientId(){var e;return(e=this.summarizerClientElection)===null||e===void 0?void 0:e.electedClientId}get disposed(){return this._disposed}get summarizer(){return w(this._summarizer!==void 0,599),this._summarizer}isSummariesDisabled(){return this.runtimeOptions.summaryOptions.disableSummaries===!0?!0:this.summaryConfiguration.state==="disabled"}isHeuristicsDisabled(){var e;return((e=this.runtimeOptions.summaryOptions.summarizerOptions)===null||e===void 0?void 0:e.disableHeuristics)===!0?!0:this.summaryConfiguration.state==="disableHeuristics"}isSummarizerClientElectionEnabled(){var e;return this.mc.config.getBoolean("Fluid.ContainerRuntime.summarizerClientElection")?(e=this.mc.config.getBoolean("Fluid.ContainerRuntime.summarizerClientElection"))!==null&&e!==void 0?e:!0:this.runtimeOptions.summaryOptions.summarizerClientElection===!0?!0:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.summarizerClientElection===!0:!1}getMaxOpsSinceLastSummary(){return this.runtimeOptions.summaryOptions.maxOpsSinceLastSummary!==void 0?this.runtimeOptions.summaryOptions.maxOpsSinceLastSummary:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.maxOpsSinceLastSummary:0}getInitialSummarizerDelayMs(){return this.runtimeOptions.summaryOptions.initialSummarizerDelayMs!==void 0?this.runtimeOptions.summaryOptions.initialSummarizerDelayMs:this.summaryConfiguration.state!=="disabled"?this.summaryConfiguration.initialSummarizerDelayMs:0}dispose(e){var t;this._disposed||(this._disposed=!0,this.logger.sendTelemetryEvent({eventName:"ContainerRuntimeDisposed",isDirty:this.isDirty,lastSequenceNumber:this.deltaManager.lastSequenceNumber,attachState:this.attachState},e),this.summaryManager!==void 0&&this.summaryManager.dispose(),this.garbageCollector.dispose(),(t=this._summarizer)===null||t===void 0||t.dispose(),this.dataStores.dispose(),this.pendingStateManager.dispose(),this.emit("dispose"),this.removeAllListeners())}get IFluidTokenProvider(){var e;if(!((e=this.options)===null||e===void 0)&&e.intelligence)return{intelligence:this.options.intelligence}}request(e){return v(this,null,function*(){try{let t=Sn.create(e);return t.pathParts[0]==="_summarizer"&&t.pathParts.length===1?this._summarizer!==void 0?{status:200,mimeType:"fluid/object",value:this.summarizer}:Ft(e):this.requestHandler!==void 0?this.requestHandler(t,this):Ft(e)}catch(t){return Bi(t)}})}resolveHandle(e){return v(this,null,function*(){try{let t=Sn.create(e),r=t.pathParts[0];if(r==="_channels")return this.resolveHandle(t.createSubRequest(1));if(r===Ua.basePath&&t.isLeaf(2)){let i=yield this.blobManager.getBlob(t.pathParts[1]);return i?{status:200,mimeType:"fluid/object",value:i.get()}:Ft(e)}else if(t.pathParts.length>0){let i=yield this.getDataStoreFromRequest(r,e),o=t.createSubRequest(1);return w(o.url.startsWith("/"),294),i.IFluidRouter.request(o)}return Ft(e)}catch(t){return Bi(t)}})}internalId(e){var t;return(t=this.dataStores.aliases().get(e))!==null&&t!==void 0?t:e}getDataStoreFromRequest(e,t){return v(this,null,function*(){var r,i,o;let a=typeof((r=t.headers)===null||r===void 0?void 0:r[Tr.wait])=="boolean"?(i=t.headers)===null||i===void 0?void 0:i[Tr.wait]:!0,s=this.internalId(e),c=yield this.dataStores.getDataStore(s,a);if(!((o=t.headers)===null||o===void 0)&&o[Tr.externalRequest]&&this.garbageCollector.shouldRunGC){let u=(yield c.getBaseGCDetails()).usedRoutes;if(!(u===void 0||u.includes("")||u.includes("/")))throw qi(Ft(t),t)}let l=yield c.realize(),h=VE(t.url.split("?")[0]);return this.garbageCollector.nodeUpdated(`/${h}`,"Loaded",void 0,c.packagePath,t?.headers),l})}addMetadataToSummary(e){var t;let r=Object.assign(Object.assign(Object.assign(Object.assign({},this.createContainerMetadata),{summaryCount:this.nextSummaryNumber,summaryNumber:this.nextSummaryNumber++,summaryFormatVersion:1,disableIsolatedChannels:this.disableIsolatedChannels||void 0}),this.garbageCollector.getMetadata()),{message:(t=CA(this.deltaManager.lastMessage))!==null&&t!==void 0?t:this.messageAtLastSummary});En(e,$c,JSON.stringify(r))}addContainerStateToSummary(e,t,r,i){var o;if(this.addMetadataToSummary(e),this.chunkMap.size>0){let c=JSON.stringify([...this.chunkMap]);En(e,i0,c)}let a=this.dataStores.aliases();if(a.size>0&&En(e,r0,JSON.stringify([...a])),this.summarizerClientElection){let c=JSON.stringify((o=this.summarizerClientElection)===null||o===void 0?void 0:o.serialize());En(e,o0,c)}let s=this.blobManager.summarize();if(Object.keys(s.summary.tree).length>0&&zv(e,mh,s),this.garbageCollector.writeDataAtRoot){let c=this.garbageCollector.summarize(t,r,i);c!==void 0&&Iv(e,Fr,c)}}shouldContinueReconnecting(){return this.maxConsecutiveReconnects<=0?!0:this.pendingStateManager.hasPendingMessages()?(this.consecutiveReconnects===Math.floor(this.maxConsecutiveReconnects/2)&&this.mc.logger.sendTelemetryEvent({eventName:"ReconnectsWithNoProgress",attempts:this.consecutiveReconnects,pendingMessages:this.pendingStateManager.pendingMessagesCount}),this.consecutiveReconnects<this.maxConsecutiveReconnects):(this.resetReconnectCount(),!0)}resetReconnectCount(){this.consecutiveReconnects=0}replayPendingStates(){if(!this.canSendOps())return;let e=this.dirtyContainer;this.dirtyContainer=!1,w(this.emitDirtyDocumentEvent,295),this.emitDirtyDocumentEvent=!1;let t;try{this.pendingStateManager.replayPendingStates()}finally{t=this.dirtyContainer,this.dirtyContainer=e,this.emitDirtyDocumentEvent=!0}this.updateDocumentDirtyState(t)}applyStashedOp(e,t){return v(this,null,function*(){switch(e){case We.FluidDataStoreOp:return this.dataStores.applyStashedOp(t);case We.Attach:return this.dataStores.applyStashedAttachOp(t);case We.Alias:case We.BlobAttach:return;case We.ChunkedOp:throw new Error("chunkedOp not expected here");case We.Rejoin:throw new Error("rejoin not expected here");default:mt(e,`Unknown ContainerMessageType: ${e}`)}})}setConnectionState(e,t){this.verifyNotClosed();let r=this._connected!==e,i=r&&e;if(this._connected=e,e||(this._perfSignalData.signalsLost=0,this._perfSignalData.signalTimestamp=0,this._perfSignalData.trackingSignalSequenceNumber=void 0),i&&(this.consecutiveReconnects++,!this.shouldContinueReconnecting())){this.closeFn(Ot.create("Runtime detected too many reconnects with no progress syncing local ops","setConnectionState",void 0,{dataLoss:1,attempts:this.consecutiveReconnects,pendingMessages:this.pendingStateManager.pendingMessagesCount}));return}r&&this.replayPendingStates(),this.dataStores.setConnectionState(e,t),po(this.mc.logger,this,e,t)}process(e,t){var r,i;if(this.verifyNotClosed(),!yo(e))return;((r=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&r!==void 0?r:this.runtimeOptions.enableOfflineLoad)&&this.savedOps.push(e);let o=Object.assign({},e);this.scheduleManager.beforeOpProcessing(o);try{o=DA(o),o=this.processRemoteChunkedMessage(o);let a;switch(t&&o.type!==We.ChunkedOp&&(a=this.pendingStateManager.processPendingLocalMessage(o)),this.pendingStateManager.hasPendingMessages()||this.updateDocumentDirtyState(!1),o.type){case We.Attach:this.dataStores.processAttachMessage(o,t);break;case We.Alias:this.processAliasMessage(o,a,t);break;case We.FluidDataStoreOp:this.dataStores.processFluidDataStoreOp(o,t,a);break;case We.BlobAttach:w((i=o?.metadata)===null||i===void 0?void 0:i.blobId,298),this.blobManager.processBlobAttachOp(o.metadata.blobId,t);break;default:}this.emit("op",o),this.scheduleManager.afterOpProcessing(void 0,o),t&&this.resetReconnectCount()}catch(a){throw this.scheduleManager.afterOpProcessing(a,o),a}}processAliasMessage(e,t,r){this.dataStores.processAliasMessage(e,t,r)}sendSignalTelemetryEvent(e){let t=Date.now()-this._perfSignalData.signalTimestamp;this.logger.sendPerformanceEvent({eventName:"SignalLatency",duration:t,signalsLost:this._perfSignalData.signalsLost}),this._perfSignalData.signalsLost=0,this._perfSignalData.signalTimestamp=0}processSignal(e,t){let r=e.content,i={clientId:e.clientId,content:r.contents.content,type:r.contents.type};if(e.clientId===this.clientId&&this.connected&&(this._perfSignalData.trackingSignalSequenceNumber!==void 0&&r.clientSignalSequenceNumber>this._perfSignalData.trackingSignalSequenceNumber?(this._perfSignalData.signalsLost++,this._perfSignalData.trackingSignalSequenceNumber=void 0,this.logger.sendErrorEvent({eventName:"SignalLost",type:r.contents.type,signalsLost:this._perfSignalData.signalsLost,trackingSequenceNumber:this._perfSignalData.trackingSignalSequenceNumber,clientSignalSequenceNumber:r.clientSignalSequenceNumber})):r.clientSignalSequenceNumber===this._perfSignalData.trackingSignalSequenceNumber&&(this.sendSignalTelemetryEvent(r.clientSignalSequenceNumber),this._perfSignalData.trackingSignalSequenceNumber=void 0)),r.address===void 0){this.emit("signal",i,t);return}this.dataStores.processSignal(r.address,i,t)}getRootDataStore(e,t=!0){return v(this,null,function*(){let r=this.internalId(e),i=yield this.dataStores.getDataStore(r,t);return w(yield i.isRoot(),299),i.realize()})}setFlushMode(e){e!==this._flushMode&&(this.mc.logger.sendTelemetryEvent({eventName:"FlushMode Updated",old:this._flushMode,new:e}),e===hr.FlushMode.Immediate&&this.flush(),this._flushMode=e,this.pendingStateManager.onFlushModeUpdated(e))}flush(){if(w(this._orderSequentiallyCalls===0,588),!!this.deltaSender&&(this.pendingStateManager.onFlush(),!!this.needsFlush&&(this.needsFlush=!1,!!this.canSendOps())))return this.deltaSender.flush()}orderSequentially(e){if(this.flushMode===hr.FlushMode.TurnBased){this.trackOrderSequentiallyCalls(e);return}let t=this.flushMode;this.setFlushMode(hr.FlushMode.TurnBased);try{this.trackOrderSequentiallyCalls(e),this.flush()}finally{this.setFlushMode(t)}}trackOrderSequentiallyCalls(e){let t;this.mc.config.getBoolean("Fluid.ContainerRuntime.EnableRollback")&&(t=this.pendingStateManager.checkpoint());try{this._orderSequentiallyCalls++,e()}catch(r){throw t?t.rollback():this.closeFn(new _n("orderSequentially callback exception",r)),r}finally{this._orderSequentiallyCalls--}}createDataStore(e){return v(this,null,function*(){let t=ke();return _h(yield this._createDataStore(e,!1,t),t,this,this.dataStores,this.mc.logger)})}createRootDataStoreLegacy(e,t){return v(this,null,function*(){let r=yield this._createDataStore(e,!0,t);return r.makeVisibleAndAttachGraph!==void 0?r.makeVisibleAndAttachGraph():r.bindToContext(),r})}createRootDataStore(e,t){return v(this,null,function*(){if(t.includes("/"))throw new ye(`Id cannot contain slashes: '${t}'`);return this._aliasingEnabled===!0?this.createAndAliasDataStore(e,t):this.createRootDataStoreLegacy(e,t)})}createAndAliasDataStore(e,t,r){return v(this,null,function*(){let i=ke(),o=yield this._createDataStore(e,!1,i,r),a=_h(o,i,this,this.dataStores,this.mc.logger),s=yield a.trySetAlias(t);if(s!=="Success")throw new _n("dataStoreAliasFailure",void 0,{alias:{value:t,tag:Ne.UserData},internalId:{value:i,tag:Ne.PackageData},aliasResult:s});return a})}createDetachedRootDataStore(e,t){if(t.includes("/"))throw new ye(`Id cannot contain slashes: '${t}'`);return this.dataStores.createDetachedDataStoreCore(e,!0,t)}createDetachedDataStore(e){return this.dataStores.createDetachedDataStoreCore(e,!1)}_createDataStoreWithPropsLegacy(o,a){return v(this,arguments,function*(e,t,r=ke(),i=!1){let s=yield this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],r,i,t).realize();return i&&(s.makeVisibleAndAttachGraph!==void 0?s.makeVisibleAndAttachGraph():s.bindToContext(),this.logger.sendTelemetryEvent({eventName:"Root datastore with props",hasProps:t!==void 0})),_h(s,r,this,this.dataStores,this.mc.logger)})}_createDataStoreWithProps(o,a){return v(this,arguments,function*(e,t,r=ke(),i=!1){return this._aliasingEnabled===!0&&i?this.createAndAliasDataStore(e,r,t):this._createDataStoreWithPropsLegacy(e,t,r,i)})}_createDataStore(o,a){return v(this,arguments,function*(e,t,r=ke(),i){return this.dataStores._createFluidDataStoreContext(Array.isArray(e)?e:[e],r,t,i).realize()})}canSendOps(){return this.connected&&!this.deltaManager.readOnlyInfo.readonly}getQuorum(){return this.context.quorum}getAudience(){return this.context.audience}get isDirty(){return this.dirtyContainer}isContainerMessageDirtyable(e,t){if(e===We.Attach){if(t.id===u0)return!1}else if(e===We.FluidDataStoreOp&&t.address===u0)return!1;return!0}createNewSignalEnvelope(e,t,r){let i=++this._perfSignalData.signalSequenceNumber,o={address:e,clientSignalSequenceNumber:i,contents:{type:t,content:r}};return i%this.defaultTelemetrySignalSampleCount===1&&this._perfSignalData.trackingSignalSequenceNumber===void 0&&(this._perfSignalData.signalTimestamp=Date.now(),this._perfSignalData.trackingSignalSequenceNumber=i),o}submitSignal(e,t){this.verifyNotClosed();let r=this.createNewSignalEnvelope(void 0,e,t);return this.context.submitSignalFn(r)}submitDataStoreSignal(e,t,r){let i=this.createNewSignalEnvelope(e,t,r);return this.context.submitSignalFn(i)}setAttachState(e){e===oe.Attaching?w(this.attachState===oe.Attaching,301):(w(this.attachState===oe.Attached,302),this.emit("attached")),e===oe.Attached&&!this.pendingStateManager.hasPendingMessages()&&this.updateDocumentDirtyState(!1),this.dataStores.setAttachState(e)}createSummary(e,t){e&&this.blobManager.setRedirectTable(e);let r=this.dataStores.createSummary(t);return this.disableIsolatedChannels||Ga(r),this.addContainerStateToSummary(r,!0,!1,t),r.summary}getAbsoluteUrl(e){return v(this,null,function*(){if(this.context.getAbsoluteUrl===void 0)throw new Error("Driver does not implement getAbsoluteUrl");if(this.attachState===oe.Attached)return this.context.getAbsoluteUrl(e)})}summarizeInternal(e,t,r){return v(this,null,function*(){let i=yield this.dataStores.summarize(e,t,r),o;return this.disableIsolatedChannels||(Ga(i),o=[hr.channelsTreeName]),this.addContainerStateToSummary(i,e,t,r),Object.assign(Object.assign({},i),{id:"",pathPartsForChildren:o})})}summarize(e){return v(this,null,function*(){this.verifyNotClosed();let{fullTree:t=!1,trackState:r=!0,summaryLogger:i=this.mc.logger,runGC:o=this.garbageCollector.shouldRunGC,runSweep:a,fullGC:s}=e,c;o&&(c=yield this.collectGarbage({logger:i,runSweep:a,fullGC:s}));let l=new Bc,{stats:h,summary:u}=yield this.summarizerNode.summarize(t,r,l);return this.logger.sendTelemetryEvent({eventName:"SummarizeTelemetry",details:l.serialize()}),w(u.type===Dr.Tree,303),{stats:h,summary:u,gcStats:c}})}updateStateBeforeGC(){return v(this,null,function*(){return this.dataStores.updateStateBeforeGC()})}getGCData(e){return v(this,null,function*(){let t=new Li,r=yield this.dataStores.getGCData(e);t.addNodes(r.gcNodes);let i=this.blobManager.getGCData(e);return t.addNodes(i.gcNodes),t.getGCData()})}updateUsedRoutes(e,t){this.summarizerNode.updateUsedRoutes([""]);let r=[];for(let i of e)i.split("/")[1]!==Ua.basePath&&r.push(i);return this.dataStores.updateUsedRoutes(r,t)}deleteUnusedRoutes(e){let t=[],r=[];for(let i of e)this.isBlobPath(i)?t.push(i):r.push(i);this.blobManager.deleteUnusedRoutes(t),this.dataStores.deleteUnusedRoutes(r)}getCurrentReferenceTimestampMs(){var e,t,r;return(t=(e=this.deltaManager.lastMessage)===null||e===void 0?void 0:e.timestamp)!==null&&t!==void 0?t:(r=this.messageAtLastSummary)===null||r===void 0?void 0:r.timestamp}getNodeType(e){var t;return this.isBlobPath(e)?Yt.Blob:(t=this.dataStores.getGCNodeType(e))!==null&&t!==void 0?t:Yt.Other}getGCNodePackagePath(e){return v(this,null,function*(){switch(this.getNodeType(e)){case Yt.Blob:return["_blobs"];case Yt.DataStore:case Yt.SubDataStore:return this.dataStores.getDataStorePackagePath(e);default:w(!1,734)}})}isBlobPath(e){let t=e.split("/");return!(t.length<2||t[1]!==Ua.basePath)}collectGarbage(e){return v(this,null,function*(){return this.garbageCollector.collectGarbage(e)})}addedGCOutboundReference(e,t){this.garbageCollector.addedOutboundReference(e.absolutePath,t.absolutePath)}submitSummary(e){return v(this,null,function*(){var t,r,i;let{fullTree:o,refreshLatestAck:a,summaryLogger:s}=e,c=this.nextSummaryNumber,l=ue.create(s,void 0,{all:{summaryNumber:c}}),h;if(a){let u=yield this.refreshLatestSummaryAckFromServer(ue.create(l,void 0,{all:{safeSummary:!0}})),d=u.latestSnapshotRefSeq;h=u.latestSnapshotVersionId,d>this.deltaManager.lastSequenceNumber&&(yield le.timedExecAsync(l,{eventName:"WaitingForSeq",lastSequenceNumber:this.deltaManager.lastSequenceNumber,targetSequenceNumber:d,lastKnownSeqNumber:this.deltaManager.lastKnownSeqNumber},()=>v(this,null,function*(){return uV(this.deltaManager,d)}),{start:!0,end:!0,cancel:"error"}))}try{yield this.deltaManager.inbound.pause();let u=this.deltaManager.lastSequenceNumber,d=this.deltaManager.minimumSequenceNumber,p=`Summary @${u}:${this.deltaManager.minimumSequenceNumber}`;u!==((t=this.deltaManager.lastMessage)===null||t===void 0?void 0:t.sequenceNumber)&&l.sendErrorEvent({eventName:"LastSequenceMismatch",error:p}),this.summarizerNode.startSummary(u,l);let m=()=>e.cancellationToken.cancelled?{continue:!1,error:"disconnected"}:(w(this.connected,600),this.deltaManager.lastSequenceNumber!==u?{continue:!1,error:`lastSequenceNumber changed before uploading to storage. ${this.deltaManager.lastSequenceNumber} !== ${u}`}:{continue:!0}),f=m();if(!f.continue)return{stage:"base",referenceSequenceNumber:u,minimumSequenceNumber:d,error:f.error};let x=ca.start(),b,_=this.garbageCollector.summaryStateNeedsReset;try{b=yield this.summarize({fullTree:o||_,trackState:!0,summaryLogger:l,runGC:this.garbageCollector.shouldRunGC})}catch(L){return{stage:"base",referenceSequenceNumber:u,minimumSequenceNumber:d,error:L}}let{summary:O,stats:S}=b;this.messageAtLastSummary=this.deltaManager.lastMessage;let E=this.disableIsolatedChannels?O:O.tree[hr.channelsTreeName];w(E.type===Dr.Tree,508);let F=Object.values(E.tree).filter(L=>L.type===Dr.Handle).length,I=O.tree[Fr]?qc(O.tree[Fr]):void 0,y=Object.assign({dataStoreCount:this.dataStores.size,summarizedDataStoreCount:this.dataStores.size-F,gcStateUpdatedDataStoreCount:(r=b.gcStats)===null||r===void 0?void 0:r.updatedDataStoreCount,gcBlobNodeCount:I?.blobNodeCount,gcTotalBlobsSize:I?.totalBlobSize,opsSizesSinceLastSummary:this.opTracker.opsSizeAccumulator,nonSystemOpsSinceLastSummary:this.opTracker.nonSystemOpCount,summaryNumber:c},S),P={referenceSequenceNumber:u,minimumSequenceNumber:d,summaryTree:O,summaryStats:y,generateDuration:x.trace().duration,forcedFullTree:_};if(f=m(),!f.continue)return Object.assign(Object.assign({stage:"generate"},P),{error:f.error});let C=this.summaryCollection.latestAck,M;C?.summaryAck.contents.handle!==h&&h!==void 0?M={proposalHandle:void 0,ackHandle:h,referenceSequenceNumber:u}:C===void 0?M={proposalHandle:void 0,ackHandle:(i=this.context.getLoadedFromVersion())===null||i===void 0?void 0:i.id,referenceSequenceNumber:u}:M={proposalHandle:C.summaryOp.contents.handle,ackHandle:C.summaryAck.contents.handle,referenceSequenceNumber:u};let A;try{A=yield this.storage.uploadSummaryWithContext(b.summary,M)}catch(L){return Object.assign(Object.assign({stage:"generate"},P),{error:L})}let T=M.ackHandle,k={handle:A,head:T,message:p,parents:T?[T]:[]},D=Object.assign(Object.assign({},P),{handle:A,uploadDuration:x.trace().duration});if(f=m(),!f.continue)return Object.assign(Object.assign({stage:"upload"},D),{error:f.error});let R;try{R=this.submitSystemMessage(lt.Summarize,k)}catch(L){return Object.assign(Object.assign({stage:"upload"},D),{error:L})}let N=Object.assign(Object.assign({stage:"submit"},D),{clientSequenceNumber:R,submitOpDuration:x.trace().duration});return this.summarizerNode.completeSummary(A),this.opTracker.reset(),N}finally{this.summarizerNode.clearSummary(),this.deltaManager.inbound.resume()}})}processRemoteChunkedMessage(e){if(e.type!==We.ChunkedOp)return e;let t=e.clientId,r=e.contents;if(this.addChunk(t,r),r.chunkId===r.totalChunks){let i=Object.assign({},e),o=this.chunkMap.get(t).join("");return i.contents=JSON.parse(o),i.type=r.originalType,this.clearPartialChunks(t),i}return e}addChunk(e,t){let r=this.chunkMap.get(e);r===void 0&&(r=[],this.chunkMap.set(e,r)),w(t.chunkId===r.length+1,305),r.push(t.contents)}clearPartialChunks(e){this.chunkMap.has(e)&&this.chunkMap.delete(e)}updateDocumentDirtyState(e){this.dirtyContainer!==e&&(this.dirtyContainer=e,this.emitDirtyDocumentEvent&&(this.emit(e?"dirty":"saved"),this.context.updateDirtyContainerState(e)))}submitDataStoreOp(e,t,r=void 0){let i={address:e,contents:t};this.submit(We.FluidDataStoreOp,i,r)}submitDataStoreAliasOp(e,t){if(!xh(e))throw new ye("malformedDataStoreAliasMessage");this.submit(We.Alias,e,t)}uploadBlob(e){return v(this,null,function*(){return this.verifyNotClosed(),this.blobManager.createBlob(e)})}submit(e,t,r=void 0,i=void 0){this.verifyNotClosed(),w(this.attachState!==oe.Detached,306);let o=-1,a=i;if(this.canSendOps()){let s=JSON.stringify(t),c=this.context.deltaManager.maxMessageSize;this.flushMode===hr.FlushMode.TurnBased&&!this.needsFlush&&(a=Object.assign(Object.assign({},i),{batch:!0}),this.needsFlush=!0,this.flushTrigger||Promise.resolve().then(()=>{this.flushTrigger=!1,this.flush()})),o=this.submitMaybeChunkedMessages(e,t,s,c,this._flushMode===hr.FlushMode.TurnBased,a)}this.pendingStateManager.onSubmitMessage(e,o,this.deltaManager.lastSequenceNumber,t,r,a),this.isContainerMessageDirtyable(e,t)&&this.updateDocumentDirtyState(!0)}submitMaybeChunkedMessages(e,t,r,i,o,a=void 0){return this._maxOpSizeInBytes>=0?!r||r.length<=this._maxOpSizeInBytes?this.submitRuntimeMessage(e,t,o,a):(this.closeFn(new _n("OpTooLarge",void 0,{length:{value:r.length,tag:Ne.PackageData},limit:{value:this._maxOpSizeInBytes,tag:Ne.PackageData}})),-1):!r||r.length<=i?this.submitRuntimeMessage(e,t,o,a):this.submitChunkedMessage(e,r,i)}submitChunkedMessage(e,t,r){let i=t.length,o=Math.floor((i-1)/r)+1,a=0,s=0;for(let c=1;c<=o;c=c+1){let l={chunkId:c,contents:t.substr(a,r),originalType:e,totalChunks:o};a+=r,s=this.submitRuntimeMessage(We.ChunkedOp,l,!1)}return s}submitSystemMessage(e,t){this.verifyNotClosed(),w(this.connected,307);let r=this.flushMode===hr.FlushMode.TurnBased&&this.needsFlush;return r&&this.mc.logger.sendErrorEvent({eventName:"submitSystemMessageError",type:e}),this.context.submitFn(e,t,r)}submitRuntimeMessage(e,t,r,i){this.verifyNotClosed(),w(this.connected,601);let o={type:e,contents:t};return this.context.submitFn(lt.Operation,o,r,i)}verifyNotClosed(){if(this._disposed)throw new Error("Runtime is closed")}reSubmit(e,t,r,i){switch(e){case We.FluidDataStoreOp:this.dataStores.resubmitDataStoreOp(t,r);break;case We.Attach:case We.Alias:this.submit(e,t,r);break;case We.ChunkedOp:throw new Error("chunkedOp not expected here");case We.BlobAttach:this.submit(e,t,r,i);break;case We.Rejoin:this.submit(e,t);break;default:mt(e,`Unknown ContainerMessageType: ${e}`)}}rollback(e,t,r){switch(e){case We.FluidDataStoreOp:this.dataStores.rollbackDataStoreOp(t,r);break;default:throw new Error(`Can't rollback ${e}`)}}refreshLatestSummaryAck(e,t,r,i){return v(this,null,function*(){let o=c=>v(this,null,function*(){return Ze(this.storage,c)}),{snapshotTree:a}=yield this.fetchSnapshotFromStorage(t,i,{eventName:"RefreshLatestSummaryGetSnapshot",ackHandle:t,summaryRefSeq:r,fetchLatest:!1}),s=yield this.summarizerNode.refreshLatestSummary(e,r,()=>v(this,null,function*(){return a}),o,i);yield this.garbageCollector.latestSummaryStateRefreshed(s,o)})}refreshLatestSummaryAckFromServer(e){return v(this,null,function*(){let{snapshotTree:t,versionId:r}=yield this.fetchSnapshotFromStorage(null,e,{eventName:"RefreshLatestSummaryGetSnapshot",fetchLatest:!0}),i=s=>v(this,null,function*(){return Ze(this.storage,s)}),o=yield jv(t,i),a=yield this.summarizerNode.refreshLatestSummary(void 0,o,()=>v(this,null,function*(){return t}),i,e);return yield this.garbageCollector.latestSummaryStateRefreshed(a,i),{latestSnapshotRefSeq:o,latestSnapshotVersionId:r}})}fetchSnapshotFromStorage(e,t,r){return v(this,null,function*(){return le.timedExecAsync(t,r,i=>v(this,null,function*(){let o={},a=ca.start(),s=yield this.storage.getVersions(e,1);w(!!s&&!!s[0],311),o.getVersionDuration=a.trace().duration;let c=yield this.storage.getSnapshotTree(s[0]);return w(!!c,312),o.getSnapshotDuration=a.trace().duration,i.end(o),{snapshotTree:c,versionId:s[0].id}}))})}notifyAttaching(e){var t;((t=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&t!==void 0?t:this.runtimeOptions.enableOfflineLoad)&&(this.baseSnapshotBlobs=Ka.serializeTreeWithBlobContents(e))}getSnapshotBlobs(){return v(this,null,function*(){var e;!((e=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&e!==void 0?e:this.runtimeOptions.enableOfflineLoad)||this.attachState!==oe.Attached||this.context.pendingLocalState||(w(!!this.context.baseSnapshot,741),this.baseSnapshotBlobs=yield Ka.serializeTree(this.context.baseSnapshot,this.storage))})}getPendingLocalState(){var e;if(!((e=this.mc.config.getBoolean("enableOfflineLoad"))!==null&&e!==void 0?e:this.runtimeOptions.enableOfflineLoad))throw new ye("can't get state when offline load disabled");let t=this.context.pendingLocalState;return t?{pending:this.pendingStateManager.getLocalState(),snapshotBlobs:t.snapshotBlobs,baseSnapshot:t.baseSnapshot,savedOps:this.savedOps}:(w(!!this.context.baseSnapshot,742),w(!!this.baseSnapshotBlobs,743),{pending:this.pendingStateManager.getLocalState(),snapshotBlobs:this.baseSnapshotBlobs,baseSnapshot:this.context.baseSnapshot,savedOps:this.savedOps})}formRequestSummarizerFn(e){return()=>v(this,null,function*(){let t={headers:{[ct.cache]:!1,[ct.clientDetails]:{capabilities:{interactive:!1},type:Jt},[ki.summarizingClient]:!0,[ct.reconnect]:!1},url:"/_summarizer"},i=(yield Ar(e,t)).ISummarizer;if(!i)throw new ye("Fluid object does not implement ISummarizer");return i})}processSavedOps(e){return v(this,null,function*(){for(let t of e.savedOps)this.process(t,!1),yield this.pendingStateManager.applyStashedOpsAt(t.sequenceNumber);yield this.pendingStateManager.applyStashedOpsAt()})}},uV=(n,e)=>v(void 0,null,function*(){return new Promise((t,r)=>{n.on("closed",r);let i=o=>{o.sequenceNumber>=e&&(t(),n.off("op",i))};n.on("op",i)})});vt();var kh=class{constructor(e,t){this.absolutePath=e,this.routeContext=t,this.isAttached=!0,w(e.startsWith("/"),413)}get IFluidRouter(){return this}get IFluidHandleContext(){return this}get IFluidHandle(){return this}get(){return v(this,null,function*(){if(this.objectP===void 0){let e={url:this.absolutePath,headers:{[Tr.viaHandle]:!0}};this.objectP=this.routeContext.resolveHandle(e).then(t=>{if(t.mimeType==="fluid/object")return t.value;throw qi(t,e)})}return this.objectP})}attachGraph(){}bind(e){e.attachGraph()}request(e){return v(this,null,function*(){try{let r=(yield this.get()).IFluidRouter;return r!==void 0?r.request(e):Ft(e)}catch(t){return Bi(t)}})}};var hV=n=>n?.type==="__fluid_handle__",$a=class{constructor(e,t){for(this.context=e,this.handleParsedCb=t,this.encodeValue=(r,i)=>{let o=r?.IFluidHandle;return o!==void 0?this.serializeHandle(o,i):r},this.decodeValue=r=>{if(hV(r)){let i=r.url.startsWith("/")?r.url:cr(r.url,this.context),o=new kh(i,this.root);return this.handleParsedCb(o),o}else return r},this.root=this.context;this.root.routeContext!==void 0;)this.root=this.root.routeContext}get IFluidSerializer(){return this}encode(e,t){return e&&typeof e=="object"?this.recursivelyReplace(e,this.encodeValue,t):e}decode(e){return e&&typeof e=="object"?this.recursivelyReplace(e,this.decodeValue):e}stringify(e,t){return JSON.stringify(e,(r,i)=>this.encodeValue(i,t))}parse(e){return JSON.parse(e,(t,r)=>this.decodeValue(r))}recursivelyReplace(e,t,r){let i=t(e,r);if(i!==e)return i;let o;for(let a of Object.keys(e)){let s=e[a];if(s&&typeof s=="object"){let c=this.recursivelyReplace(s,t,r);c!==s&&(o=o??(Array.isArray(e)?[...e]:Object.assign({},e)),o[a]=c)}}return o??e}serializeHandle(e,t){return t.bind(e),{type:"__fluid_handle__",url:e.absolutePath}}};Nt();Y();qt();var Xa=Ce(Ln());Oe();var Dh=class extends Qn{get isAttached(){return this.value.isAttached()}constructor(e,t,r){super(e,t,r)}attachGraph(){this.value.bindToContext(),super.attachGraph()}};var Fh=class extends $a{constructor(){super(...arguments),this.serializedRoutes=new Set}getSerializedRoutes(){return Array.from(this.serializedRoutes)}serializeHandle(e,t){return this.serializedRoutes.add(e.absolutePath),super.serializeHandle(e,t)}};var h0=class extends Vr{constructor(e,t,r){super((i,o)=>this.eventListenerErrorHandler(i,o)),this.id=e,this.runtime=t,this.attributes=r,this._connected=!1,this._isBoundToContext=!1,w(!e.includes("/"),772),this.handle=new Dh(this,e,t.IFluidHandleContext),this.logger=ue.create(t.logger,void 0,{all:{sharedObjectId:ke(),ddsType:{value:this.attributes.type,tag:Ne.CodeArtifact}}}),this.mc=Mn(this.logger),[this.opProcessingHelper,this.callbacksHelper]=this.setUpSampledTelemetryHelpers(),this.attachListeners()}get IFluidLoadable(){return this}get connected(){return this._connected}setUpSampledTelemetryHelpers(){var e,t;w(this.mc!==void 0&&this.logger!==void 0,"this.mc and/or this.logger has not been set");let r=new ga({eventName:"ddsOpProcessing",category:"performance"},this.logger,(e=this.mc.config.getNumber("Fluid.SharedObject.OpProcessingTelemetrySampling"))!==null&&e!==void 0?e:100,!0,new Map([["local",{localOp:!0}],["remote",{localOp:!1}]])),i=new ga({eventName:"ddsEventCallbacks",category:"performance"},this.logger,(t=this.mc.config.getNumber("Fluid.SharedObject.DdsCallbacksTelemetrySampling"))!==null&&t!==void 0?t:100,!0);return this.runtime.once("dispose",()=>{this.callbacksHelper.dispose(),this.opProcessingHelper.dispose()}),[r,i]}closeWithError(e){this.closeError===void 0&&(this.closeError=e)}verifyNotClosed(){if(this.closeError!==void 0)throw this.closeError}eventListenerErrorHandler(e,t){let r=Ot.wrapIfUnrecognized(t,"SharedObjectEventListenerException");throw r.addTelemetryProperties({emittedEventName:String(e)}),this.closeWithError(r),r}attachListeners(){this.isAttached()||this.runtime.once("attaching",()=>{this.didAttach()})}load(e){return v(this,null,function*(){this.runtime.attachState!==oe.Detached&&(this.services=e),yield this.loadCore(e.objectStorage),this.runtime.attachState!==oe.Detached&&this.attachDeltaHandler()})}initializeLocal(){this.initializeLocalCore()}bindToContext(){this._isBoundToContext||(this._isBoundToContext=!0,this.runtime.bindChannel(this))}connect(e){this.services=e,this.attachDeltaHandler()}isAttached(){return this.services!==void 0&&this.runtime.attachState!==oe.Detached}handleDecoded(e){var t,r,i;this.isAttached()&&((i=(t=this.services)===null||t===void 0?void 0:(r=t.deltaConnection).addedGCOutboundReference)===null||i===void 0||i.call(r,this.handle,e))}initializeLocalCore(){}didAttach(){}submitLocalMessage(e,t=void 0){this.verifyNotClosed(),this.isAttached()&&this.services.deltaConnection.submit(e,t)}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}newAckBasedPromise(e){return v(this,null,function*(){let t;return new Promise((r,i)=>{if(t=()=>i(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed){t();return}this.runtime.on("dispose",t),e(r,i)}).finally(()=>{this.runtime.off("dispose",t)})})}attachDeltaHandler(){w(this.services!==void 0,122),this._isBoundToContext=!0,this.didAttach(),this.services.deltaConnection.attach({process:(e,t,r)=>{this.process(e,t,r)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t)=>{this.reSubmit(e,t)},applyStashedOp:e=>this.applyStashedOp(e),rollback:(e,t)=>{this.rollback(e,t)}}),this.setConnectionState(this.services.deltaConnection.connected)}setConnectionState(e){this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,r){this.verifyNotClosed(),this.emitInternal("pre-op",e,t,this),this.opProcessingHelper.measure(()=>{this.processCore(e,t,r)},t?"local":"remote"),this.emitInternal("op",e,t,this)}reSubmit(e,t){this.reSubmitCore(e,t)}rollback(e,t){throw new Error("rollback not supported")}emit(e,...t){return this.callbacksHelper.measure(()=>super.emit(e,...t))}emitInternal(e,...t){return super.emit(e,...t)}},Ja=class extends h0{constructor(e,t,r,i){super(e,t,r),this.telemetryContextPrefix=i,this._isGCing=!1,this._serializer=new $a(this.runtime.channelsRoutingContext,o=>this.handleDecoded(o))}get serializer(){return w(!this._isGCing,117),this._serializer}getAttachSummary(e=!1,t=!1,r){let i=this.summarizeCore(this.serializer,r);return this.incrementTelemetryMetric(Xa.blobCountPropertyName,i.stats.blobNodeCount,r),this.incrementTelemetryMetric(Xa.totalBlobSizePropertyName,i.stats.totalBlobSize,r),i}summarize(e=!1,t=!1,r){return v(this,null,function*(){let i=this.summarizeCore(this.serializer,r);return this.incrementTelemetryMetric(Xa.blobCountPropertyName,i.stats.blobNodeCount,r),this.incrementTelemetryMetric(Xa.totalBlobSizePropertyName,i.stats.totalBlobSize,r),i})}getGCData(e=!1){w(!this._isGCing,120),this._isGCing=!0;let t;try{let r=new Fh(this.runtime.channelsRoutingContext,i=>this.handleDecoded(i));this.processGCDataCore(r),t={gcNodes:{"/":r.getSerializedRoutes()}},w(this._isGCing,121)}finally{this._isGCing=!1}return t}processGCDataCore(e){this.summarizeCore(e)}incrementTelemetryMetric(e,t,r){var i;let o=(i=r?.get(this.telemetryContextPrefix,e))!==null&&i!==void 0?i:0;r?.set(this.telemetryContextPrefix,e,o+t)}};function FA(n,e,t){return n!==void 0?e.stringify(n,t):n}function TA(n,e){return n!==void 0?e.parse(JSON.stringify(n)):n}var Lt=function(n){return n[n.Shared=0]="Shared",n[n.Plain=1]="Plain",n}(Lt||{});vt();Y();function Yc(n,e,t){let r=n.makeSerialized(e,t);return{type:r.type,value:r.value&&JSON.parse(r.value)}}var Th=class{constructor(e){this.value=e}get type(){return Lt[Lt.Plain]}makeSerialized(e,t){let r=FA(this.value,e,t);return{type:this.type,value:r}}},Qa=class{constructor(e){this.serializer=e}fromSerializable(e){if(e.type===Lt[Lt.Shared]){e.type=Lt[Lt.Plain];let r={type:"__fluid_handle__",url:e.value};e.value=r}let t=TA(e.value,this.serializer);return new Th(t)}fromInMemory(e){return new Th(e)}};function p0(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="add"||n.type==="edit")}function zA(n){return n!==void 0&&n.type==="clear"&&typeof n.pendingMessageId=="number"}function pV(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="add"||n.type==="edit"||n.type==="clear")}var zh=class{constructor(e,t,r,i,o){this.serializer=e,this.handle=t,this.submitMessage=r,this.isAttached=i,this.eventEmitter=o,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localValueMaker=new Qa(e),this.messageHandlers=this.getMessageHandlers()}get size(){return this.data.size}keys(){return this.data.keys()}entries(){let e=this.data.entries();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:[r.value[0],r.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){let e=this.data.values();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:r.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach((t,r,i)=>{e(t.value,r,i)})}get(e){let t=this.data.get(e);return t===void 0?void 0:t.value}has(e){return this.data.has(e)}set(e,t){if(e==null)throw new Error("Undefined and null keys are not supported");let r=this.localValueMaker.fromInMemory(t),i=Yc(r,this.serializer,this.handle),o=this.setCore(e,r,!0);if(!this.isAttached())return;let a={key:e,type:"set",value:i};this.submitMapKeyMessage(a,o)}delete(e){let t=this.deleteCore(e,!0);if(!this.isAttached())return t!==void 0;let r={key:e,type:"delete"};return this.submitMapKeyMessage(r,t),t!==void 0}clear(){let e=this.isAttached()?new Map(this.data):void 0;if(this.clearCore(!0),!this.isAttached())return;let t={type:"clear"};this.submitMapClearMessage(t,e)}getSerializedStorage(e){let t={};return this.data.forEach((r,i)=>{t[i]=r.makeSerialized(e,this.handle)}),t}getSerializableStorage(e){let t={};return this.data.forEach((r,i)=>{t[i]=Yc(r,e,this.handle)}),t}serialize(e){return JSON.stringify(this.getSerializableStorage(e))}populateFromSerializable(e){for(let[t,r]of Object.entries(e)){let i={key:t,value:this.makeLocal(t,r)};this.data.set(i.key,i.value)}}populate(e){this.populateFromSerializable(JSON.parse(e))}trySubmitMessage(e,t){let r=this.messageHandlers.get(e.type);return r===void 0?!1:(r.submit(e,t),!0)}tryGetStashedOpLocalMetadata(e){let t=this.messageHandlers.get(e.type);if(t===void 0)throw new Error("no apply stashed op handler");return t.getStashedOpLocalMetadata(e)}tryProcessMessage(e,t,r){let i=this.messageHandlers.get(e.type);return i===void 0?!1:(i.process(e,t,r),!0)}rollback(e,t){if(!pV(t))throw new Error("Invalid localOpMetadata");if(e.type==="clear"&&t.type==="clear"){if(t.previousMap===void 0)throw new Error("Cannot rollback without previous map");t.previousMap.forEach((i,o)=>{this.setCore(o,i,!0)});let r=this.pendingClearMessageIds.pop();if(r===void 0||r!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if(e.type==="delete"||e.type==="set"){if(t.type==="add")this.deleteCore(e.key,!0);else if(t.type==="edit"&&t.previousValue!==void 0)this.setCore(e.key,t.previousValue,!0);else throw new Error("Cannot rollback without previous value");let r=this.pendingKeys.get(e.key),i=r?.pop();if(!r||i!==t.pendingMessageId)throw new Error("Rollback op does not match last pending");r.length===0&&this.pendingKeys.delete(e.key)}else throw new Error("Unsupported op for rollback")}setCore(e,t,r){let i=this.data.get(e),o=i?.value;return this.data.set(e,t),this.eventEmitter.emit("valueChanged",{key:e,previousValue:o},r,this.eventEmitter),i}clearCore(e){this.data.clear(),this.eventEmitter.emit("clear",e,this.eventEmitter)}deleteCore(e,t){let r=this.data.get(e),i=r?.value;return this.data.delete(e)&&this.eventEmitter.emit("valueChanged",{key:e,previousValue:i},t,this.eventEmitter),r}clearExceptPendingKeys(){let e=new Map;this.pendingKeys.forEach((t,r)=>{e.set(r,this.data.get(r))}),this.clearCore(!1),e.forEach((t,r)=>{this.setCore(r,t,!0)})}makeLocal(e,t){if(t.type===Lt[Lt.Plain]||t.type===Lt[Lt.Shared])return this.localValueMaker.fromSerializable(t);throw new Error("Unknown local value type")}needProcessKeyOperation(e,t,r){if(this.pendingClearMessageIds.length>0)return t&&w(r!==void 0&&p0(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],19),!1;if(this.pendingKeys.get(e.key)!==void 0){if(t){w(r!==void 0&&p0(r),20);let o=this.pendingKeys.get(e.key);w(o!==void 0&&o[0]===r.pendingMessageId,762),o.shift(),o.length===0&&this.pendingKeys.delete(e.key)}return!1}return!t}getMessageHandlers(){let e=new Map;return e.set("clear",{process:(t,r,i)=>{if(r){w(zA(i),21);let o=this.pendingClearMessageIds.shift();w(o===i.pendingMessageId,763);return}if(this.pendingKeys.size!==0){this.clearExceptPendingKeys();return}this.clearCore(r)},submit:(t,r)=>{w(zA(r),764);let i=this.pendingClearMessageIds.shift();w(i===r.pendingMessageId,765),this.submitMapClearMessage(t,r.previousMap)},getStashedOpLocalMetadata:t=>({type:"clear",pendingMessageId:this.getMapClearMessageId()})}),e.set("delete",{process:(t,r,i)=>{this.needProcessKeyOperation(t,r,i)&&this.deleteCore(t.key,r)},submit:(t,r)=>{this.resubmitMapKeyMessage(t,r)},getStashedOpLocalMetadata:t=>({type:"edit",pendingMessageId:this.getMapKeyMessageId(t)})}),e.set("set",{process:(t,r,i)=>{if(!this.needProcessKeyOperation(t,r,i))return;let o=this.makeLocal(t.key,t.value);this.setCore(t.key,o,r)},submit:(t,r)=>{this.resubmitMapKeyMessage(t,r)},getStashedOpLocalMetadata:t=>({type:"edit",pendingMessageId:this.getMapKeyMessageId(t)})}),e}getMapClearMessageId(){let e=++this.pendingMessageId;return this.pendingClearMessageIds.push(e),e}submitMapClearMessage(e,t){let r={type:"clear",pendingMessageId:this.getMapClearMessageId(),previousMap:t};this.submitMessage(e,r)}getMapKeyMessageId(e){let t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return r!==void 0?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitMapKeyMessage(e,t){let r=this.getMapKeyMessageId(e),i=t?{type:"edit",pendingMessageId:r,previousValue:t}:{type:"add",pendingMessageId:r};this.submitMessage(e,i)}resubmitMapKeyMessage(e,t){w(p0(t),766);let r=this.pendingKeys.get(e.key);w(r!==void 0&&r[0]===t.pendingMessageId,767),r.shift(),r.length===0&&this.pendingKeys.delete(e.key);let i=this.getMapKeyMessageId(e),o=t.type==="edit"?{type:"edit",pendingMessageId:i,previousValue:t.previousValue}:{type:"add",pendingMessageId:i};this.submitMessage(e,o)}};var Ih="1.4.0";var IA,RA="header",pr=class n{get type(){return n.Type}get attributes(){return n.Attributes}load(e,t,r,i){return v(this,null,function*(){let o=new Gi(t,e,i);return yield o.load(r),o})}create(e,t){let r=new Gi(t,e,n.Attributes);return r.initializeLocal(),r}};pr.Type="https://graph.microsoft.com/types/map";pr.Attributes={type:pr.Type,snapshotFormatVersion:"0.2",packageVersion:Ih};var Gi=class extends Ja{constructor(e,t,r){super(e,t,r,"fluid_map_"),this[IA]="SharedMap",this.kernel=new zh(this.serializer,this.handle,(i,o)=>this.submitLocalMessage(i,o),()=>this.isAttached(),this)}static create(e,t){return e.createChannel(t,pr.Type)}static getFactory(){return new pr}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[(IA=Symbol.toStringTag,Symbol.iterator)](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}summarizeCore(e,t){let r=0,i=0,o={},a=[],s=new Pt,c=this.kernel.getSerializedStorage(e),l=8*1024,h=16*1024;for(let d of Object.keys(c)){let p=c[d];if(p.value&&p.value.length>=l){let m=`blob${i}`;i++,a.push(m);let f={[d]:{type:p.type,value:JSON.parse(p.value)}};s.addBlob(m,JSON.stringify(f))}else{if(r+=p.type.length+21,p.value&&(r+=p.value.length),r>h){let m=`blob${i}`;i++,a.push(m),s.addBlob(m,JSON.stringify(o)),o={},r=0}o[d]={type:p.type,value:p.value===void 0?void 0:JSON.parse(p.value)}}}let u={blobs:a,content:o};return s.addBlob(RA,JSON.stringify(u)),s.getSummaryTree()}loadCore(e){return v(this,null,function*(){let t=yield Ze(e,RA),r=t;Array.isArray(r.blobs)?(this.kernel.populateFromSerializable(r.content),yield Promise.all(r.blobs.map(i=>v(this,null,function*(){let o=yield Ze(e,i);this.kernel.populateFromSerializable(o)})))):this.kernel.populateFromSerializable(t)})}onDisconnect(){}reSubmitCore(e,t){this.kernel.trySubmitMessage(e,t)}applyStashedOp(e){return this.kernel.tryProcessMessage(e,!1,void 0),this.kernel.tryGetStashedOpLocalMetadata(e)}processCore(e,t,r){e.type===sc.Operation&&this.kernel.tryProcessMessage(e.contents,t,r)}rollback(e,t){this.kernel.rollback(e,t)}};Y();vt();var GA=Ce(qA());var LA,jA,Dn=GA.posix,VA="header",Qr=class n{get type(){return n.Type}get attributes(){return n.Attributes}load(e,t,r,i){return v(this,null,function*(){let o=new Wi(t,e,i);return yield o.load(r),o})}create(e,t){let r=new Wi(t,e,n.Attributes);return r.initializeLocal(),r}};Qr.Type="https://graph.microsoft.com/types/directory";Qr.Attributes={type:Qr.Type,snapshotFormatVersion:"0.1",packageVersion:Ih};var Wi=class extends Ja{constructor(e,t,r){super(e,t,r,"fluid_directory_"),this[LA]="SharedDirectory",this.root=new Rh(this,this.runtime,this.serializer,Dn.sep),this.messageHandlers=new Map,this.localValueMaker=new Qa(this.serializer),this.setMessageHandlers(),this.root.on("containedValueChanged",(i,o)=>{this.emit("containedValueChanged",i,o,this)}),this.root.on("subDirectoryCreated",(i,o)=>{this.emit("subDirectoryCreated",i,o,this)}),this.root.on("subDirectoryDeleted",(i,o)=>{this.emit("subDirectoryDeleted",i,o,this)})}static create(e,t){return e.createChannel(t,Qr.Type)}static getFactory(){return new Qr}get absolutePath(){return this.root.absolutePath}get(e){return this.root.get(e)}set(e,t){return this.root.set(e,t),this}dispose(e){this.root.dispose(e)}get disposed(){return this.root.disposed}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[(LA=Symbol.toStringTag,Symbol.iterator)](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}countSubDirectory(){return this.root.countSubDirectory()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){let t=this.makeAbsolute(e);if(t===Dn.sep)return this.root;let r=this.root,i=t.substr(1).split(Dn.sep);for(let o of i)if(r=r.getSubDirectory(o),!r)return;return r}summarizeCore(e,t){return this.serializeDirectory(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}onDisconnect(){}reSubmitCore(e,t){let r=e,i=this.messageHandlers.get(r.type);w(i!==void 0,13),i.submit(r,t)}loadCore(e){return v(this,null,function*(){let t=yield Ze(e,VA),r=t;Array.isArray(r.blobs)?(this.populate(r.content),yield Promise.all(r.blobs.map(i=>v(this,null,function*(){let o=yield Ze(e,i);this.populate(o)})))):this.populate(t)})}populate(e){let t=[];for(t.push([this.root,e]);t.length>0;){let[r,i]=t.pop();if(i.subdirectories)for(let[o,a]of Object.entries(i.subdirectories)){let s=r.getSubDirectory(o);s||(s=new Rh(this,this.runtime,this.serializer,Dn.join(r.absolutePath,o)),r.populateSubDirectory(o,s)),t.push([s,a])}if(i.storage)for(let[o,a]of Object.entries(i.storage)){let s=this.makeLocal(o,r.absolutePath,a);r.populateStorage(o,s)}}}processCore(e,t,r){if(e.type===sc.Operation){let i=e.contents,o=this.messageHandlers.get(i.type);w(o!==void 0,14),o.process(i,t,r)}}rollback(e,t){let r=e,i=this.getWorkingDirectory(r.path);i&&i.rollback(r,t)}makeAbsolute(e){return Dn.resolve(Dn.sep,e)}makeLocal(e,t,r){return w(r.type===Lt[Lt.Plain]||r.type===Lt[Lt.Shared],484),this.localValueMaker.fromSerializable(r)}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processClearMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitClearMessage(e,t)}}),this.messageHandlers.set("delete",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processDeleteMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("set",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);if(i){let o=t?void 0:this.makeLocal(e.key,e.path,e.value);i.processSetMessage(e,o,t,r)}},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processCreateSubDirectoryMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,r)=>{let i=this.getWorkingDirectory(e.path);i&&i.processDeleteSubDirectoryMessage(e,t,r)},submit:(e,t)=>{let r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}})}applyStashedOp(){throw new Error("not implemented")}serializeDirectory(e,t,r){let o=new Pt,a=0,s=[],c=[],l={};for(c.push([e,l]);c.length>0;){let[u,d]=c.pop();for(let[p,m]of u.getSerializedStorage(t)){d.storage||(d.storage={});let f={type:m.type,value:m.value&&JSON.parse(m.value)};if(m.value&&m.value.length>=8192){let x={},b=x;if(u.absolutePath!==Dn.sep)for(let O of u.absolutePath.substr(1).split(Dn.sep)){let S={};b.subdirectories={[O]:S},b=S}b.storage={[p]:f};let _=`blob${a}`;a++,s.push(_),o.addBlob(_,JSON.stringify(x))}else d.storage[p]=f}for(let[p,m]of u.subdirectories()){d.subdirectories||(d.subdirectories={});let f={};d.subdirectories[p]=f,c.push([m,f])}}let h={blobs:s,content:l};return o.addBlob(VA,JSON.stringify(h)),o.getSummaryTree()}};function g0(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&n.type==="edit"}function HA(n){return n!==void 0&&n.type==="clear"&&typeof n.pendingMessageId=="number"&&typeof n.previousStorage=="object"}function UA(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="createSubDir"&&typeof n.previouslyExisted=="boolean"||n.type==="deleteSubDir")}function fV(n){return n!==void 0&&typeof n.pendingMessageId=="number"&&(n.type==="edit"||n.type==="deleteSubDir"||n.type==="clear"&&typeof n.previousStorage=="object"||n.type==="createSubDir"&&typeof n.previouslyExisted=="boolean")}var Rh=class n extends Pe{constructor(e,t,r,i){super(),this.directory=e,this.runtime=t,this.serializer=r,this.absolutePath=i,this._deleted=!1,this[jA]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingSubDirectories=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[]}dispose(e){this._deleted=!0,this.emit("disposed",this)}undispose(){this._deleted=!1}get disposed(){return this._deleted}throwIfDisposed(){if(this._deleted)throw new ye("Cannot access Disposed subDirectory")}has(e){return this.throwIfDisposed(),this._storage.has(e)}get(e){var t;return this.throwIfDisposed(),(t=this._storage.get(e))===null||t===void 0?void 0:t.value}set(e,t){if(this.throwIfDisposed(),e==null)throw new Error("Undefined and null keys are not supported");let r=this.directory.localValueMaker.fromInMemory(t),i=Yc(r,this.serializer,this.directory.handle),o=this.setCore(e,r,!0);if(!this.directory.isAttached())return this;let a={key:e,path:this.absolutePath,type:"set",value:i};return this.submitKeyMessage(a,o),this}countSubDirectory(){return this._subdirectories.size}createSubDirectory(e){if(this.throwIfDisposed(),e==null)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(Dn.sep))throw new Error(`SubDirectory name may not contain ${Dn.sep}`);let t=this.createSubDirectoryCore(e,!0),r=this._subdirectories.get(e);if(!this.directory.isAttached())return r;let i={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};return this.submitCreateSubDirectoryMessage(i,!t),r}getSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.get(e)}hasSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.has(e)}deleteSubDirectory(e){this.throwIfDisposed();let t=this.deleteSubDirectoryCore(e,!0);if(!this.directory.isAttached())return t!==void 0;let r={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};return this.submitDeleteSubDirectoryMessage(r,t),t!==void 0}subdirectories(){return this.throwIfDisposed(),this._subdirectories.entries()}getWorkingDirectory(e){return this.throwIfDisposed(),this.directory.getWorkingDirectory(this.makeAbsolute(e))}delete(e){this.throwIfDisposed();let t=this.deleteCore(e,!0);if(!this.directory.isAttached())return t!==void 0;let r={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(r,t),t!==void 0}clear(){if(this.throwIfDisposed(),!this.directory.isAttached()){this.clearCore(!0);return}let e=new Map(this._storage);this.clearCore(!0);let t={path:this.absolutePath,type:"clear"};this.submitClearMessage(t,e)}forEach(e){this.throwIfDisposed(),this._storage.forEach((t,r,i)=>{e(t.value,r,i)})}get size(){return this.throwIfDisposed(),this._storage.size}entries(){this.throwIfDisposed();let e=this._storage.entries();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:[r.value[0],r.value[1].value],done:!1}},[Symbol.iterator](){return this}}}keys(){return this.throwIfDisposed(),this._storage.keys()}values(){this.throwIfDisposed();let e=this._storage.values();return{next(){let r=e.next();return r.done?{value:void 0,done:!0}:{value:r.value.value,done:!1}},[Symbol.iterator](){return this}}}[(jA=Symbol.toStringTag,Symbol.iterator)](){return this.throwIfDisposed(),this.entries()}processClearMessage(e,t,r){if(this.throwIfDisposed(),t){w(HA(r),15);let i=this.pendingClearMessageIds.shift();w(i===r.pendingMessageId,810);return}this.clearExceptPendingKeys()}processDeleteMessage(e,t,r){this.throwIfDisposed(),this.needProcessStorageOperation(e,t,r)&&this.deleteCore(e.key,t)}processSetMessage(e,t,r,i){this.throwIfDisposed(),this.needProcessStorageOperation(e,r,i)&&this.setCore(e.key,t,r)}processCreateSubDirectoryMessage(e,t,r){this.throwIfDisposed(),this.needProcessSubDirectoryOperation(e,t,r)&&this.createSubDirectoryCore(e.subdirName,t)}processDeleteSubDirectoryMessage(e,t,r){this.throwIfDisposed(),this.needProcessSubDirectoryOperation(e,t,r)&&this.deleteSubDirectoryCore(e.subdirName,t)}submitClearMessage(e,t){this.throwIfDisposed();let r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);let i={type:"clear",pendingMessageId:r,previousStorage:t};this.directory.submitDirectoryMessage(e,i)}resubmitClearMessage(e,t){w(HA(t),811);let r=this.pendingClearMessageIds.shift();w(r===t.pendingMessageId,812),this.submitClearMessage(e,t.previousStorage)}getKeyMessageId(e){let t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return r!==void 0?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitKeyMessage(e,t){this.throwIfDisposed();let i={type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t};this.directory.submitDirectoryMessage(e,i)}resubmitKeyMessage(e,t){w(g0(t),813);let r=this.pendingKeys.get(e.key);w(r!==void 0&&r[0]===t.pendingMessageId,814),r.shift(),r.length===0&&this.pendingKeys.delete(e.key),this.submitKeyMessage(e,t.previousValue)}getSubDirMessageId(e){let t=++this.pendingMessageId,r=this.pendingSubDirectories.get(e.subdirName);return r!==void 0?r.push(t):this.pendingSubDirectories.set(e.subdirName,[t]),t}submitCreateSubDirectoryMessage(e,t){this.throwIfDisposed();let i={type:"createSubDir",pendingMessageId:this.getSubDirMessageId(e),previouslyExisted:t};this.directory.submitDirectoryMessage(e,i)}submitDeleteSubDirectoryMessage(e,t){this.throwIfDisposed();let i={type:"deleteSubDir",pendingMessageId:this.getSubDirMessageId(e),subDirectory:t};this.directory.submitDirectoryMessage(e,i)}resubmitSubDirectoryMessage(e,t){w(UA(t),815);let r=this.pendingSubDirectories.get(e.subdirName);w(r!==void 0&&r[0]===t.pendingMessageId,816),r.shift(),r.length===0&&this.pendingSubDirectories.delete(e.subdirName),t.type==="createSubDir"?this.submitCreateSubDirectoryMessage(e,t.previouslyExisted):this.submitDeleteSubDirectoryMessage(e,t.subDirectory)}*getSerializedStorage(e){this.throwIfDisposed();for(let[t,r]of this._storage){let i=r.makeSerialized(e,this.directory.handle);yield[t,i]}}populateStorage(e,t){this.throwIfDisposed(),this._storage.set(e,t)}populateSubDirectory(e,t){this.throwIfDisposed(),this._subdirectories.set(e,t)}getLocalValue(e){return this.throwIfDisposed(),this._storage.get(e)}rollbackPendingMessageId(e,t,r){let i=e.get(t),o=i?.pop();if(!i||o!==r)throw new Error("Rollback op does not match last pending");i.length===0&&e.delete(t)}rollback(e,t){if(!fV(t))throw new Error("Invalid localOpMetadata");if(e.type==="clear"&&t.type==="clear"){t.previousStorage.forEach((i,o)=>{this.setCore(o,i,!0)});let r=this.pendingClearMessageIds.pop();if(r===void 0||r!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if((e.type==="delete"||e.type==="set")&&t.type==="edit")t.previousValue===void 0?this.deleteCore(e.key,!0):this.setCore(e.key,t.previousValue,!0),this.rollbackPendingMessageId(this.pendingKeys,e.key,t.pendingMessageId);else if(e.type==="createSubDirectory"&&t.type==="createSubDir")t.previouslyExisted||this.deleteSubDirectoryCore(e.subdirName,!0),this.rollbackPendingMessageId(this.pendingSubDirectories,e.subdirName,t.pendingMessageId);else if(e.type==="deleteSubDirectory"&&t.type==="deleteSubDir")t.subDirectory!==void 0&&(this.undeleteSubDirectoryTree(t.subDirectory),this._subdirectories.set(e.subdirName,t.subDirectory),this.emit("subDirectoryCreated",e.subdirName,!0,this)),this.rollbackPendingMessageId(this.pendingSubDirectories,e.subdirName,t.pendingMessageId);else throw new Error("Unsupported op for rollback")}makeAbsolute(e){return Dn.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,r){if(this.pendingClearMessageIds.length>0)return t&&w(r!==void 0&&g0(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],16),!1;if(this.pendingKeys.get(e.key)!==void 0){if(t){w(r!==void 0&&g0(r),17);let o=this.pendingKeys.get(e.key);w(o!==void 0&&o[0]===r.pendingMessageId,817),o.shift(),o.length===0&&this.pendingKeys.delete(e.key)}return!1}return!t}needProcessSubDirectoryOperation(e,t,r){if(this.pendingSubDirectories.get(e.subdirName)!==void 0){if(t){w(UA(r),18);let o=this.pendingSubDirectories.get(e.subdirName);w(o!==void 0&&o[0]===r.pendingMessageId,818),o.shift(),o.length===0&&this.pendingSubDirectories.delete(e.subdirName)}return!1}return!t}clearExceptPendingKeys(){let e=new Map;this.pendingKeys.forEach((t,r,i)=>{e.set(r,this._storage.get(r))}),this.clearCore(!1),e.forEach((t,r,i)=>{this.setCore(r,t,!0)})}clearCore(e){this._storage.clear(),this.directory.emit("clear",e,this.directory)}deleteCore(e,t){let r=this._storage.get(e),i=r?.value;if(this._storage.delete(e)){let a={key:e,path:this.absolutePath,previousValue:i};this.directory.emit("valueChanged",a,t,this.directory);let s={key:e,previousValue:i};this.emit("containedValueChanged",s,t,this)}return r}setCore(e,t,r){let i=this._storage.get(e),o=i?.value;this._storage.set(e,t);let a={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",a,r,this.directory);let s={key:e,previousValue:o};return this.emit("containedValueChanged",s,r,this),i}createSubDirectoryCore(e,t){if(!this._subdirectories.has(e)){let r=Dn.join(this.absolutePath,e),i=new n(this.directory,this.runtime,this.serializer,r);return this.registerEventsOnSubDirectory(i,e),this._subdirectories.set(e,i),this.emit("subDirectoryCreated",e,t,this),!0}return!1}registerEventsOnSubDirectory(e,t){e.on("subDirectoryCreated",(r,i)=>{this.emit("subDirectoryCreated",Dn.join(t,r),i,this)}),e.on("subDirectoryDeleted",(r,i)=>{this.emit("subDirectoryDeleted",Dn.join(t,r),i,this)})}deleteSubDirectoryCore(e,t){let r=this._subdirectories.get(e);return r!==void 0&&(this._subdirectories.delete(e),this.disposeSubDirectoryTree(r),this.emit("subDirectoryDeleted",e,t,this)),r}disposeSubDirectoryTree(e){if(!e)return;let t=e.subdirectories();for(let[r,i]of t)this.disposeSubDirectoryTree(i);typeof e.dispose=="function"&&e.dispose()}undeleteSubDirectoryTree(e){for(let[t,r]of this._subdirectories.entries())this.undeleteSubDirectoryTree(r);e.undispose()}};var f0="IFluidDependencySynthesizer";var Za=class n{constructor(...e){this.providers=new Map,this.parents=e.filter(t=>t!==void 0)}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${e} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){let r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,f0,{get:()=>this}),r}has(e,t){return this.providers.has(e)?!0:t!==!0?this.parents.some(r=>r.has(e)):!1}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(let t of this.parents){if(t instanceof n)return t.getProvider(e);{let r=t;if(r?.getProvider!==void 0)return r.getProvider(e)}}}}generateRequired(e,t){if(t!==void 0)for(let r of Object.keys(t)){let i=this.resolveProvider(r);if(i===void 0)throw new Error(`Object attempted to be created without registered required provider ${r}`);Object.defineProperty(e,r,i)}}generateOptional(e,t){var r;if(t!==void 0)for(let i of Object.keys(t)){let o=(r=this.resolveProvider(i))!==null&&r!==void 0?r:{get:()=>v(this,null,function*(){})};Object.defineProperty(e,i,o)}}resolveProvider(e){let t=this.providers.get(e);if(t===void 0){for(let r of this.parents){let i={[e]:e},o=r.synthesize(i,{}),a=Object.getOwnPropertyDescriptor(o,e);if(a!==void 0)return a}return}return typeof t=="function"?{get(){if(t&&typeof t=="function")return Promise.resolve(this[f0]).then(r=>v(this,null,function*(){return t(r)})).then(r=>r?.[e])}}:{get(){if(t)return Promise.resolve(t).then(r=>{if(r)return r[e]})}}}};vt();Y();Y();var m0=class{constructor(e,t){this.absolutePath=e,this.runtime=t,this.isAttached=!0}get IFluidHandle(){return this}attachGraph(){w(!1,202)}get(){return v(this,null,function*(){let e=yield this.runtime.IFluidHandleContext.resolveHandle({url:this.absolutePath});if(e.status===200&&e.mimeType==="fluid/object")return e.value;throw new Error(`Failed to resolve container path ${this.absolutePath}`)})}bind(e){throw new Error("Cannot bind to LegacyUriHandle")}};function WA(n,e){return new m0(n,e)}vt();var v0=class{constructor(){this.handlers=[]}pushHandler(...e){e!==void 0&&this.handlers.push(...e)}handleRequest(e,t){return v(this,null,function*(){let r=Sn.create(e);for(let i of this.handlers){let o=yield i(r,t);if(o!==void 0)return o}return Ft(e)})}};function KA(...n){let e=new v0;return e.pushHandler(...n),(t,r)=>v(this,null,function*(){return e.handleRequest(t,r)})}var $A="_services";vt();var XA=n=>(e,t)=>v(void 0,null,function*(){let r=Sn.create(e);if(r.pathParts.length===0)return t.IFluidHandleContext.resolveHandle({url:`/${n}${r.query}`,headers:e.headers})});function JA(n,e){return e.url===""||e.url==="/"||e.url.startsWith("/?")?{mimeType:"fluid/object",status:200,value:n}:Ft(e)}var Oo=class extends mi{constructor(e){super(),this._disposed=!1,this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps,w(this.runtime._dataObject===void 0,189),this.runtime._dataObject=this,this.innerHandle=new Qn(this,"",this.runtime.objectsRoutingContext),this.runtime.once("dispose",()=>{this._disposed=!0,this.dispose()})}get disposed(){return this._disposed}get id(){return this.runtime.id}get IFluidRouter(){return this}get IFluidLoadable(){return this}get IFluidHandle(){return this.innerHandle}get handle(){return this.innerHandle}static getDataObject(e){return v(this,null,function*(){let t=e._dataObject;return w(t!==void 0,188),yield t.finishInitialization(!0),t})}request(e){return v(this,null,function*(){return JA(this,e)})}finishInitialization(e){return v(this,null,function*(){return this.initializeP!==void 0?this.initializeP:(this.initializeP=this.initializeInternal(e),this.initializeP)})}initializeInternal(e){return v(this,null,function*(){var t;yield this.preInitialize(),e?(w(this.initProps===void 0,190),yield this.initializingFromExisting()):yield this.initializingFirstTime((t=this.context.createProps)!==null&&t!==void 0?t:this.initProps),yield this.hasInitialized()})}getFluidObjectFromDirectory(e,t,r){return v(this,null,function*(){let i=r?r(e,t):t.get(e),o=i?.IFluidHandle;if(o)return o.get()})}getService(e){return v(this,null,function*(){return WA(`/${$A}/${e}`,this.context.containerRuntime).get()})}preInitialize(){return v(this,null,function*(){})}initializingFirstTime(e){return v(this,null,function*(){})}initializingFromExisting(){return v(this,null,function*(){})}hasInitialized(){return v(this,null,function*(){})}dispose(){super.dispose()}};var Mo=class n extends Oo{constructor(){super(...arguments),this.rootDirectoryId="root"}request(e){return v(this,null,function*(){let t=Sn.create(e);if(t.pathParts[0]==="bigBlobs"){let i=this.root.get(t.pathParts.join("/"));return i===void 0?Ft(t):{mimeType:"fluid/object",status:200,value:i}}else return er(n.prototype,this,"request").call(this,t)})}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}initializeInternal(e){return v(this,null,function*(){e?(this.internalRoot=yield this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===pr.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=Wi.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),yield er(n.prototype,this,"initializeInternal").call(this,e)})}getUninitializedErrorString(e){return`${e} must be initialized before being accessed.`}};function QA(n,e,t,r,i,o,a){return v(this,null,function*(){let s=i;s=sA((p,m)=>v(this,null,function*(){return(yield Oo.getDataObject(m)).request(p)}),s);let c=new s(e,t,o),l=e.scope,u=new Za(l.IFluidDependencySynthesizer).synthesize(r,{}),d=new n({runtime:c,context:e,providers:u,initProps:a});return o||(yield d.finishInitialization(o)),{instance:d,runtime:c}})}var Nh=class{constructor(e,t,r,i,o,a=Po){if(this.type=e,this.ctor=t,this.optionalProviders=i,this.runtimeClass=a,this.type==="")throw new Error("undefined type member");o!==void 0&&(this.registry=new Kr(o)),this.sharedObjectRegistry=new Map(r.map(s=>[s.type,s]))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}instantiateDataStore(e,t){return v(this,null,function*(){let{runtime:r}=yield QA(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,t);return r})}createChildInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t)})}createPeerInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t)})}createInstance(e,t){return v(this,null,function*(){return this.createNonRootInstanceCore(e,[this.type],t)})}createRootInstance(e,t,r){return v(this,null,function*(){let i=t.createDetachedRootDataStore([this.type],e);return this.createInstanceCore(i,r)})}createNonRootInstanceCore(e,t,r){return v(this,null,function*(){let i=e.createDetachedDataStore(t);return this.createInstanceCore(i,r)})}createInstanceCore(e,t){return v(this,null,function*(){let{instance:r,runtime:i}=yield QA(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,!1,t);return yield e.attachRuntime(this,i),r})}};var es=class extends Nh{constructor(e,t,r=[],i,o,a=Po){let s=[...r];r.find(c=>c.type===Qr.Type)||s.push(Wi.getFactory()),r.find(c=>c.type===pr.Type)||s.push(Gi.getFactory()),super(e,t,s,i,o,a)}};var e4=Ce(ZA());vt();var qh=class extends Rc{constructor(e,t,r=[],i){super(),this.registryEntries=e,this.dependencyContainer=t,this.requestHandlers=r,this.runtimeOptions=i,this.registry=new Kr(e)}get IFluidDataStoreRegistry(){return this.registry}instantiateFirstTime(e){return v(this,null,function*(){yield this.containerInitializingFirstTime(e),yield this.containerHasInitialized(e)})}instantiateFromExisting(e){return v(this,null,function*(){yield this.containerHasInitialized(e)})}preInitialize(e,t){return v(this,null,function*(){let r=e.scope,i=new Za(this.dependencyContainer,r.IFluidDependencySynthesizer);r.IFluidDependencySynthesizer=i;let o=yield Qc.load(e,this.registryEntries,KA(...this.requestHandlers),this.runtimeOptions,r,t);return i.register(e4.IContainerRuntime,o),o})}containerInitializingFirstTime(e){return v(this,null,function*(){})}containerHasInitialized(e){return v(this,null,function*(){})}};var r4=Ce(Ln());vt();var b0=n=>n?.factory!==void 0,x0=n=>n?.getFactory!==void 0,t4=n=>{var e;let t=new Set,r=new Set,i=a=>{if(x0(a))r.add(a.getFactory());else if(b0(a))t.add([a.factory.type,Promise.resolve(a.factory)]);else throw new Error("Entry is neither a DataObject or a SharedObject")};if(new Set([...Object.values(n.initialObjects),...(e=n.dynamicObjectTypes)!==null&&e!==void 0?e:[]]).forEach(i),t.size===0&&r.size===0)throw new Error("Container cannot be initialized without any DataTypes");return[Array.from(t),Array.from(r)]};var _0=class extends Mo{constructor(){super(...arguments),this.initialObjectsDirKey="initial-objects-key",this._initialObjects={}}get initialObjectsDir(){let e=this.root.getSubDirectory(this.initialObjectsDirKey);if(e===void 0)throw new Error("InitialObjects sub-directory was not initialized");return e}initializingFirstTime(e){return v(this,null,function*(){this.root.createSubDirectory(this.initialObjectsDirKey);let t=[];Object.entries(e.initialObjects).forEach(([r,i])=>{let o=()=>v(this,null,function*(){let a=yield this.create(i);this.initialObjectsDir.set(r,a.handle)});t.push(o())}),yield Promise.all(t)})}hasInitialized(){return v(this,null,function*(){let e=[];for(let[t,r]of Array.from(this.initialObjectsDir.entries())){let i=()=>v(this,null,function*(){let o=yield r.get();Object.assign(this._initialObjects,{[t]:o})});e.push(i())}yield Promise.all(e)})}get initialObjects(){if(Object.keys(this._initialObjects).length===0)throw new Error("Initial Objects were not correctly initialized");return this._initialObjects}create(e){return v(this,null,function*(){if(b0(e))return this.createDataObject(e);if(x0(e))return this.createSharedObject(e);throw new Error("Could not create new Fluid object because an unknown object was passed")})}createDataObject(e){return v(this,null,function*(){let t=e.factory,r=[...this.context.packagePath,t.type],i=yield this.context.containerRuntime.createDataStore(r);return Ar(i,"/")})}createSharedObject(e){let t=e.getFactory();return this.runtime.createChannel(void 0,t.type)}},n4="rootDOId",Lh=class extends qh{constructor(e){let[t,r]=t4(e),i=new es("rootDO",_0,r,{},t);super([i.registryEntry],void 0,[XA(n4)],{flushMode:r4.FlushMode.Immediate}),this.rootDataObjectFactory=i,this.initialObjects=e.initialObjects}containerInitializingFirstTime(e){return v(this,null,function*(){yield this.rootDataObjectFactory.createRootInstance(n4,e,{initialObjects:this.initialObjects})})}};Y();var jh=class extends Pe{constructor(e){super(),this.container=e,this.lastMembers=new Map,this.audience=e.audience,this.getMembers(),this.audience.on("addMember",(t,r)=>{if(this.shouldIncludeAsMember(r)){let i=this.getMember(t);this.emit("memberAdded",t,i),this.emit("membersChanged")}}),this.audience.on("removeMember",t=>{this.lastMembers.has(t)&&(this.emit("memberRemoved",t,this.lastMembers.get(t)),this.emit("membersChanged"))}),this.container.on("connected",()=>this.emit("membersChanged"))}getMembers(){let e=new Map,t=new Map;return this.audience.getMembers().forEach((r,i)=>{if(this.shouldIncludeAsMember(r)){let o=r.user.id,a=e.get(o);a===void 0&&(a=this.createServiceMember(r),e.set(o,a)),a.connections.push({id:i,mode:r.mode}),t.set(i,a)}}),this.lastMembers=t,e}getMyself(){let e=this.container.clientId;if(e!==void 0)return this.getMember(e)}getMember(e){let t=this.audience.getMember(e);if(t===void 0)return;let i=this.getMembers().get(t?.user.id);if(i===void 0)throw Error(`Attempted to fetch client ${e} that is not part of the current member list`);return i}shouldIncludeAsMember(e){return e.details.capabilities.interactive}};var Vh=class extends jh{createServiceMember(e){let t=e.user;return Kf(t?.name!==void 0,'Provided user was not an "AzureUser".'),{userId:e.user.id,userName:t.name,connections:[],additionalDetails:t.additionalDetails}}};qt();var Ie=function(n){return n[n.Disconnected=0]="Disconnected",n[n.EstablishingConnection=3]="EstablishingConnection",n[n.Connecting=1]="Connecting",n[n.CatchingUp=1]="CatchingUp",n[n.Connected=2]="Connected",n}(Ie||{});var ck=Ce($4());Nt();Y();qt();Hr();var yn=function(n){return n.NoOp="noop",n.ClientJoin="join",n.ClientLeave="leave",n.Propose="propose",n.Reject="reject",n.Summarize="summarize",n.SummaryAck="summaryAck",n.SummaryNack="summaryNack",n.Operation="op",n.RemoteHelp="remoteHelp",n.NoClient="noClient",n.RoundTrip="tripComplete",n.Control="control",n}(yn||{});var Fn=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Fn||{});var Hh=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(Hh||{});Oe();var X4=Ce(fi());var Uh=class extends X4.EventEmitter{constructor(){super(...arguments),this.members=new Map}on(e,t){return super.on(e,t)}addMember(e,t){this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){let t=this.members.get(e);return t!==void 0?(this.members.delete(e),this.emit("removeMember",e,t),!0):!1}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}clear(){let e=this.members.keys();for(let t of e)this.removeMember(t)}};Y();qt();Oe();var IH="Code package does not implement IRuntimeFactory",Gh=class n{constructor(e,t,r,i,o,a,s,c,l,h,u,d,p,m,f){this.container=e,this.scope=t,this.codeLoader=r,this._codeDetails=i,this._baseSnapshot=o,this.deltaManager=a,this.loader=c,this.submitFn=l,this.submitSignalFn=h,this.closeFn=u,this.version=d,this.updateDirtyContainerState=p,this.existing=m,this.pendingLocalState=f,this._disposed=!1,this._quorum=s,this.taggedLogger=e.subLogger,this._fluidModuleP=new Rt(()=>v(this,null,function*(){return this.loadCodeModule(i)})),this.attachListener()}static createOrLoad(e,t,r,i,o,a,s,c,l,h,u,d,p,m,f){return v(this,null,function*(){let x=new n(e,t,r,i,o,a,s,c,l,h,u,d,p,m,f);return yield x.instantiateRuntime(m),x})}get clientId(){return this.container.clientId}get id(){let e=this.container.resolvedUrl;return Dc(e)?e.id:""}get clientDetails(){return this.container.clientDetails}get connected(){return this.container.connected}get canSummarize(){return"summarize"in this.runtime}get serviceConfiguration(){return this.container.serviceConfiguration}get audience(){return this.container.audience}get options(){return this.container.options}get baseSnapshot(){return this._baseSnapshot}get storage(){return this.container.storage}get runtime(){if(this._runtime===void 0)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get disposed(){return this._disposed}get codeDetails(){return this._codeDetails}get quorum(){return this._quorum}getSpecifiedCodeDetails(){var e;return(e=this._quorum.get("code"))!==null&&e!==void 0?e:this._quorum.get("code2")}dispose(e){this._disposed||(this._disposed=!0,this.runtime.dispose(e),this._quorum.dispose(),this.deltaManager.dispose())}getLoadedFromVersion(){return this.container.loadedFromVersion}get attachState(){return this.container.attachState}createSummary(e){return this.runtime.createSummary(e)}setConnectionState(e,t){let r=this.runtime;w(e===this.connected,222),r.setConnectionState(e,t)}process(e,t,r){this.runtime.process(e,t,r)}processSignal(e,t){this.runtime.processSignal(e,t)}request(e){return v(this,null,function*(){return this.runtime.request(e)})}getAbsoluteUrl(e){return v(this,null,function*(){return this.container.getAbsoluteUrl(e)})}getPendingLocalState(){return this.runtime.getPendingLocalState()}satisfies(e){return v(this,null,function*(){var t;let r=[],i=this.codeLoader;i.IFluidCodeDetailsComparer!==void 0&&r.push(i.IFluidCodeDetailsComparer);let o=yield this._fluidModuleP,a=(t=o.module)===null||t===void 0?void 0:t.fluidExport;if(a?.IFluidCodeDetailsComparer!==void 0&&r.push(a.IFluidCodeDetailsComparer),r.length===0)return!1;for(let s of r)if((yield s.satisfies(o.details,e))===!1)return!1;return!0})}notifyAttaching(e){var t,r;this._baseSnapshot=e,(r=(t=this.runtime).notifyAttaching)===null||r===void 0||r.call(t,e),this.runtime.setAttachState(oe.Attaching)}getRuntimeFactory(){return v(this,null,function*(){var e;let t=(e=(yield this._fluidModuleP).module)===null||e===void 0?void 0:e.fluidExport,r=t?.IRuntimeFactory;if(r===void 0)throw new Error(IH);return r})}instantiateRuntime(e){return v(this,null,function*(){let t=yield this.getRuntimeFactory();this._runtime=yield t.instantiateRuntime(this,e)})}attachListener(){this.container.once("attached",()=>{this.runtime.setAttachState(oe.Attached)})}loadCodeModule(e){return v(this,null,function*(){let t=yield le.timedExecAsync(this.taggedLogger,{eventName:"CodeLoad"},()=>v(this,null,function*(){return this.codeLoader.load(e)}));if("module"in t){let{module:r,details:i}=t;return{module:r,details:i??e}}else return this.taggedLogger.sendTelemetryEvent({eventName:"LegacyCodeLoader"}),t})}};qt();var dn=function(n){return n.Never="Never",n.Disabled="Disabled",n.Enabled="Enabled",n}(dn||{}),J4=n=>{let e;return n&&"name"in n?e=n:Va(n?.package)?e=n?.package.name:e=n?.package,{name:e}};var O0=Ce(P0());Nt();Y();Oe();Y();var Y4=Ce(Jv());var Eo=class extends Pe{constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new Y4.default,this.pauseCount=1}get disposed(){return this.isDisposed}get paused(){return this.pauseCount!==0}get length(){return this.q.length}get idle(){return this.processingPromise===void 0&&this.q.length===0}waitTillProcessingDone(){return v(this,null,function*(){var e;return(e=this.processingPromise)!==null&&e!==void 0?e:{count:0,duration:0}})}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(t){this.emit("error",t)}}pause(){return v(this,null,function*(){this.pauseCount++,yield this.waitTillProcessingDone()})}resume(){w(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&this.processingPromise===void 0&&(this.processingPromise=Promise.resolve().then(()=>{w(this.processingPromise!==void 0,"reentrancy?");let e=this.processDeltas();return w(this.processingPromise!==void 0,"reentrancy?"),this.processingPromise=void 0,e}).catch(e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0})),w(this.processingPromise!==void 0,"processDeltas() should run async"))}anythingToProcess(){return this.q.length!==0&&!this.paused&&this.error===void 0}processDeltas(){let e=de.now(),t=0;for(;this.anythingToProcess();){let i=this.q.shift();t++,this.worker(i),this.emit("op",i)}let r=de.now()-e;return this.q.length===0&&this.emit("idle",t,r),{count:t,duration:r}}};var Kh=class extends Pe{constructor(e,t,r,i){super(),this.serviceProvider=e,this.logger=t,this._active=r,this.pending=[],this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.baseTerm=0,this.opsSize=0,this.initSequenceNumber=0,this.closed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new O0.default,this.deltaStorageDelayId=ke(),this.deltaStreamDelayId=ke(),this.messageBuffer=[];let o={incomingOpHandler:(a,s)=>{try{this.enqueueMessages(a,s)}catch(c){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},c),this.close(cn(c))}},signalHandler:a=>this._inboundSignal.push(a),reconnectionDelayHandler:(a,s)=>this.emitDelayInfo(this.deltaStreamDelayId,a,s),closeHandler:a=>this.close(a),disconnectHandler:a=>this.disconnectHandler(a),connectHandler:a=>this.connectHandler(a),pongHandler:a=>this.emit("pong",a),readonlyChangeHandler:a=>dm(this,this.logger,"readonly",a)};this.connectionManager=i(o),this._inbound=new Eo(a=>{this.processInboundMessage(a)}),this._inbound.on("error",a=>{this.close(Ot.wrapIfUnrecognized(a,"deltaManagerInboundErrorHandler",this.lastMessage))}),this._inboundSignal=new Eo(a=>{if(this.handler===void 0)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({clientId:a.clientId,content:JSON.parse(a.content)})}),this._inboundSignal.on("error",a=>{this.close(cn(a))})}get active(){return this._active()}get disposed(){return this.closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get referenceTerm(){return this.baseTerm}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return w(this.connectionManager.connected,223),this._checkpointSequenceNumber!==void 0}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t,r=!1,i){let o={contents:JSON.stringify(t),metadata:i,referenceSequenceNumber:this.lastProcessedSequenceNumber,type:e};r||this.flush();let a=this.connectionManager.prepareMessageToSend(o);return a===void 0?-1:(this.opsSize+=a.contents.length,this.messageBuffer.push(a),this.emit("submitOp",a),r||this.flush(),a.clientSequenceNumber)}submitSignal(e){return this.connectionManager.submitSignal(e)}flush(){this.messageBuffer.length!==0&&(this.emit("prepareSend",this.messageBuffer),this.connectionManager.sendMessages(this.messageBuffer),this.messageBuffer=[])}get connectionProps(){return Object.assign({sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0},this.connectionManager.connectionProps)}logConnectionIssue(e){var t;w(this.connectionManager.connected,568);let r=this.pending.sort((i,o)=>i.sequenceNumber-o.sequenceNumber);this.logger.sendErrorEvent(Object.assign(Object.assign(Object.assign(Object.assign({},e),{fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber}),this.connectionManager.connectionVerboseProps),{pendingOps:this.pending.length,pendingFirst:(t=r[0])===null||t===void 0?void 0:t.sequenceNumber,haveHandler:this.handler!==void 0,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused}))}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);let t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;let r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,r!==void 0&&this.updateLatestKnownOpSeqNumber(r),w(this.messageBuffer.length===0,233),this.opsSize=0,this.emit("connect",e,r!==void 0?this.lastObservedSeqNumber-this.lastSequenceNumber:void 0),r!==void 0?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):e.mode==="read"&&this.fetchMissingDeltas("AfterReadConnection")}dispose(){throw new Error("Not implemented.")}attachOpHandler(e,t,r,i,o="none"){return v(this,null,function*(){if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=t,this.baseTerm=r,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=t,this.lastObservedSeqNumber=t,w(this.handler===void 0,226),this.handler=i,w(!!this.handler,227),w(this.fetchReason===void 0,616),!this.closed){if(this._inbound.resume(),this._inboundSignal.resume(),o!=="none"){let a=o==="cached";yield this.fetchMissingDeltasCore(`DocumentOpen_${o}`,a),a&&this.fetchMissingDeltas("PostDocumentOpen")}w(this.fetchReason!==void 0||this.pending.length===0,617)}})}connect(e){var t;let r=(t=e.fetchOpsFromStorage)!==null&&t!==void 0?t:!0;hm(this.handler!==void 0||!r,this.logger,"CantFetchWithoutBaseline"),r&&this.fetchMissingDeltas(e.reason),this.connectionManager.connect(e.mode)}getDeltas(e,t,r,i,o){return v(this,null,function*(){let a=this.serviceProvider();if(a===void 0)throw new Error("Delta manager is not attached");this.deltaStorage===void 0&&(this.deltaStorage=yield a.connectToDeltaStorage());let s;if(t!==void 0){let u=t-1;if(this.lastQueuedSequenceNumber>=u){this.logger.sendPerformanceEvent(Object.assign({reason:r,eventName:"ExtraStorageCall",early:!0,from:e,to:t},this.connectionManager.connectionVerboseProps));return}s=d=>d.sequenceNumber>=u}else s=u=>u.sequenceNumber>=this.lastObservedSeqNumber;let c=new O0.default,l=!1,h=u=>{w(u.sequenceNumber===this.lastQueuedSequenceNumber,570),!l&&s(u)&&(c.abort(),this._inbound.off("push",h))};try{this._inbound.on("push",h),w(this.closeAbortController.signal.onabort===null,488),this.closeAbortController.signal.onabort=()=>c.abort();let u=this.deltaStorage.fetchMessages(e,t,c.signal,o,r);for(;;){let d=yield u.read();if(d.done)break;try{l=!0,i(d.value)}finally{l=!1}}}finally{this.closeAbortController.signal.onabort=null,this._inbound.off("push",h),w(!l,649)}})}close(e){this.closed||(this.closed=!0,this.connectionManager.dispose(e),this.closeAbortController.abort(),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[],this.emit("closed",e),this.removeAllListeners())}refreshDelayInfo(e){this.throttlingIdSet.delete(e),this.throttlingIdSet.size===0&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e)}emitDelayInfo(e,t,r){let i=Date.now();if(this.throttlingIdSet.add(e),t>0&&i+t>this.timeTillThrottling){this.timeTillThrottling=i+t;let o=Gu.wrap(r,t/1e3,this.logger);this.emit("throttled",o)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t,r=!1){var i,o;if(this.handler===void 0){this.pending=this.pending.concat(e);return}if(w(this.pending.length===0||this.fetchReason!==void 0,489),e.length===0)return;let a=e[0].sequenceNumber,s=e[e.length-1].sequenceNumber;if(s>this.lastQueuedSequenceNumber){let l=a-1,h=l-this.lastQueuedSequenceNumber,u,d=0,p=0;for(let f of e)f.sequenceNumber===l?d++:f.sequenceNumber!==l+1&&(p++,u===void 0&&(u=l+1)),l=f.sequenceNumber;let m;d!==0||p!==0&&!r||h>0&&this.fetchReason===void 0?m="enqueueMessages":this.fetchReason!==void 0&&this.fetchReason!==t&&a<=this.lastQueuedSequenceNumber+1&&s>this.lastQueuedSequenceNumber&&(m="enqueueMessagesExtraFetch"),m!==void 0&&this.logger.sendPerformanceEvent(Object.assign({eventName:m,reason:t,previousReason:this.prevEnqueueMessagesReason,from:a,to:s+1,length:e.length,fetchReason:this.fetchReason,duplicate:d>0?d:void 0,initialGap:h!==0?h:void 0,gap:p>0?p:void 0,firstMissing:u,dmInitialSeqNumber:this.initialSequenceNumber},this.connectionManager.connectionVerboseProps))}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);let c=(i=this.previouslyProcessedMessage)===null||i===void 0?void 0:i.sequenceNumber;w(c===void 0||c===this.lastQueuedSequenceNumber,236);for(let l of e)if(l.sequenceNumber<=this.lastQueuedSequenceNumber){if(((o=this.previouslyProcessedMessage)===null||o===void 0?void 0:o.sequenceNumber)===l.sequenceNumber){let h=this.comparableMessagePayload(this.previouslyProcessedMessage),u=this.comparableMessagePayload(l);if(h!==u){let d=new Wr("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",$t.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:l.sequenceNumber,message1:h,message2:u,driverVersion:void 0});this.close(d)}}}else l.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(l),this.fetchMissingDeltas(t,l.sequenceNumber)):(this.lastQueuedSequenceNumber=l.sequenceNumber,this.previouslyProcessedMessage=l,this._inbound.push(l));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){let t=Date.now();if(this.lastProcessedMessage=e,w(e.clientId!==void 0||!cE(e),237),typeof e.contents=="string"&&e.contents!==""&&e.type!==yn.ClientLeave&&(e.contents=JSON.parse(e.contents)),this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw new Xt("Found a lower minimumSequenceNumber (msn) than previously recorded",Object.assign(Object.assign({},ur(e)),{clientId:this.connectionManager.clientId}));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Xt("Found a non-Sequential sequenceNumber",Object.assign(Object.assign({},ur(e)),{clientId:this.connectionManager.clientId}));if(this.lastProcessedSequenceNumber=e.sequenceNumber,w(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),e.term===void 0&&(e.term=1),this.baseTerm=e.term,this.handler===void 0)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e);let r=Date.now();this.emit("op",e,r-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch(r=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},r)})}fetchMissingDeltasCore(e,t,r){return v(this,null,function*(){var i;if(this.fetchReason===void 0){if(this.closed){this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});return}if(this.handler===void 0){w(this.lastQueuedSequenceNumber===0,619);return}try{let o=this.lastQueuedSequenceNumber+1,a=(i=this.previouslyProcessedMessage)===null||i===void 0?void 0:i.sequenceNumber;a!==void 0&&(w(a===this.lastQueuedSequenceNumber,242),w(o>1,243),o--);let s=`${e}_fetch`;this.fetchReason=s,yield this.getDeltas(o,r,s,c=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(c,s)},t)}catch(o){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},o),this.close(cn(o))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}}})}processPendingOps(e){if(this.closed)return;w(this.handler!==void 0,620);let t=this.pending.sort((r,i)=>r.sequenceNumber-i.sequenceNumber);this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),this.fetchReason===void 0&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}};Y();var Zc=class extends mi{constructor(e){super(e),this.queue=e}get paused(){return this.queue.paused}get length(){return this.queue.length}get idle(){return this.queue.idle}peek(){return this.queue.peek()}toArray(){return this.queue.toArray()}systemPause(){return v(this,null,function*(){return this.pause()})}pause(){return v(this,null,function*(){return this.queue.pause()})}systemResume(){return v(this,null,function*(){return this.resume()})}resume(){return v(this,null,function*(){this.queue.resume()})}waitTillProcessingDone(){return v(this,null,function*(){return this.queue.waitTillProcessingDone()})}},$h=class extends mi{constructor(e){super(e),this.deltaManager=e,this.inbound=new Zc(e.inbound),this.outbound=new Zc(e.outbound),this.inboundSignal=new Zc(e.inboundSignal)}get IDeltaSender(){return this}get minimumSequenceNumber(){return this.deltaManager.minimumSequenceNumber}get lastSequenceNumber(){return this.deltaManager.lastSequenceNumber}get lastMessage(){return this.deltaManager.lastMessage}get lastKnownSeqNumber(){return this.deltaManager.lastKnownSeqNumber}get initialSequenceNumber(){return this.deltaManager.initialSequenceNumber}get hasCheckpointSequenceNumber(){return this.deltaManager.hasCheckpointSequenceNumber}get clientDetails(){return this.deltaManager.clientDetails}get version(){return this.deltaManager.version}get maxMessageSize(){return this.deltaManager.maxMessageSize}get serviceConfiguration(){return this.deltaManager.serviceConfiguration}get active(){return this.deltaManager.active}get readOnlyInfo(){return this.deltaManager.readOnlyInfo}dispose(){this.inbound.dispose(),this.outbound.dispose(),this.inboundSignal.dispose(),super.dispose()}submitSignal(e){return this.deltaManager.submitSignal(e)}flush(){return this.deltaManager.flush()}};Nt();qt();Oe();var Z4=Ce($m());Nt();Y();Oe();function Xh(n){var e;let t=(0,Z4.parse)(n,!0);if(typeof t.pathname!="string")throw new Be("Failed to parse pathname");let r=(e=t.search)!==null&&e!==void 0?e:"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return o?.length===3?{id:o[1],path:o[2],query:r,version:t.query.version}:void 0}function ek(n){let e={blobs:{},blobsContents:{},trees:{},id:ke(),unreferenced:n.unreferenced},t=Object.keys(n.tree);for(let r of t){let i=n.tree[r];switch(i.type){case Fn.Tree:{e.trees[r]=ek(i);break}case Fn.Attachment:e.blobs[r]=i.id;break;case Fn.Blob:{let o=ke();e.blobs[r]=o;let a=typeof i.content=="string"?Bn(i.content,"utf8"):Wf(i.content);e.blobsContents[o]=a;break}case Fn.Handle:throw new Be("No handles should be there in summary in detached container!!");default:mt(i,`Unknown tree type ${i.type}`)}}return e}function NH(n,e){let t={type:Fn.Tree,tree:Object.assign({},e.tree)};return t.tree[".protocol"]=n,ek(t)}var Jh=n=>{let e=n.tree[".protocol"],t=n.tree[".app"];return w(e!==void 0&&t!==void 0,480),NH(e,t)};function M0(n){return".protocol"in n.trees?n.trees[".protocol"]:n}var Qh="1.4.0";function tk(n){return n.headers===void 0?!0:n.headers[ct.cache]!==!1}var tl=class{constructor(e,t){this.container=e,this.loader=t}get IFluidRouter(){return this}resolve(e){return v(this,null,function*(){var t,r,i,o,a;if(e.url.startsWith("/")){if(tk(e))return this.container;{let s=this.container.resolvedUrl;return bn(s),yield el.load(this.loader,{canReconnect:(t=e.headers)===null||t===void 0?void 0:t[ct.reconnect],clientDetailsOverride:(r=e.headers)===null||r===void 0?void 0:r[ct.clientDetails],resolvedUrl:Object.assign({},s),version:(o=(i=e.headers)===null||i===void 0?void 0:i[ct.version])!==null&&o!==void 0?o:void 0,loadMode:(a=e.headers)===null||a===void 0?void 0:a[ct.loadMode]})}}if(this.loader===void 0)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)})}request(e){return v(this,null,function*(){return e.url.startsWith("/")?(yield this.resolve(e)).request(e):this.loader===void 0?{status:404,value:"Cannot request external containers",mimeType:"plain/text"}:this.loader.request(e)})}};function BH(n){let e=Object.create(n),t=new Map;return e.resolve=r=>v(this,null,function*(){return tk(r)?(t.has(r.url)||t.set(r.url,n.resolve(r)),t.get(r.url)):n.resolve(r)}),e}var nl=class{constructor(e){var t,r;this.containers=new Map;let i=Object.assign({},e.scope);((t=e.options)===null||t===void 0?void 0:t.provideScopeLoader)!==!1&&(i.ILoader=this);let o={loaderId:ke(),loaderVersion:Qh},a=ho(_c.mixinDebugLogger("fluid:telemetry",e.logger,{all:o}),lc.value,e.configProvider);this.services={urlResolver:BH(Eu.create(e.urlResolver)),documentServiceFactory:Su.create(e.documentServiceFactory),codeLoader:e.codeLoader,options:(r=e.options)!==null&&r!==void 0?r:{},scope:i,subLogger:a.logger,detachedBlobStorage:e.detachedBlobStorage},this.mc=Mn(ue.create(this.services.subLogger,"Loader"))}get IFluidRouter(){return this}createDetachedContainer(e){return v(this,null,function*(){let t=yield el.createDetached(this,e);return this.cachingEnabled&&t.once("attached",()=>{bn(t.resolvedUrl);let r=Xh(t.resolvedUrl.url);r!==void 0&&this.addToContainerCache(r.id,Promise.resolve(t))}),t})}rehydrateDetachedContainerFromSnapshot(e){return v(this,null,function*(){return el.rehydrateDetachedFromSnapshot(this,e)})}resolve(e,t){return v(this,null,function*(){let r=t===void 0?"Resolve":"ResolveWithPendingState";return le.timedExecAsync(this.mc.logger,{eventName:r},()=>v(this,null,function*(){return(yield this.resolveCore(e,t!==void 0?JSON.parse(t):void 0)).container}))})}request(e){return v(this,null,function*(){return le.timedExecAsync(this.mc.logger,{eventName:"Request"},()=>v(this,null,function*(){let t=yield this.resolveCore(e);return t.container.request(Object.assign(Object.assign({},e),{url:`${t.parsed.path}${t.parsed.query}`}))}))})}getKeyForContainerCache(e,t){var r;return((r=e.headers)===null||r===void 0?void 0:r[ct.version])!==void 0?`${t.id}@${e.headers[ct.version]}`:t.id}addToContainerCache(e,t){this.containers.set(e,t),t.then(r=>{r.closed?this.containers.delete(e):r.once("closed",()=>{this.containers.delete(e)})}).catch(r=>{})}resolveCore(e,t){return v(this,null,function*(){let r=yield this.services.urlResolver.resolve(e);bn(r);let i=Xh(r.url);if(i===void 0)throw new Error(`Invalid URL ${r.url}`);if(t!==void 0){let l=Xh(t.url);if(l?.id!==i.id||l?.path.replace(/\/$/,"")!==i.path.replace(/\/$/,"")){let h=`URL ${r.url} does not match pending state URL ${t.url}`;throw new Error(h)}}let{canCache:o,fromSequenceNumber:a}=this.parseHeader(i,e),s=t!==void 0?!1:o,c;if(s){let l=this.getKeyForContainerCache(e,i),h=yield this.containers.get(l);if(h!==void 0)c=h;else{let u=this.loadContainer(e,r);this.addToContainerCache(l,u),c=yield u}}else c=yield this.loadContainer(e,r,t);return c.deltaManager.lastSequenceNumber<=a&&(yield new Promise((l,h)=>{function u(d){d.sequenceNumber>a&&(l(),c.removeListener("op",u))}c.on("op",u)})),{container:c,parsed:i}})}get cachingEnabled(){return this.services.options.cache!==!1}canCacheForRequest(e){return this.cachingEnabled&&e[ct.cache]!==!1}parseHeader(e,t){var r,i;let o=-1;t.headers=(r=t.headers)!==null&&r!==void 0?r:{};let a=t.headers[ct.sequenceNumber];return a!==void 0&&(o=a),t.headers[ct.version]=(i=e.version)!==null&&i!==void 0?i:t.headers[ct.version],{canCache:this.canCacheForRequest(t.headers),fromSequenceNumber:o}}loadContainer(e,t,r){return v(this,null,function*(){var i,o,a,s,c;return el.load(this,{canReconnect:(i=e.headers)===null||i===void 0?void 0:i[ct.reconnect],clientDetailsOverride:(o=e.headers)===null||o===void 0?void 0:o[ct.clientDetails],resolvedUrl:t,version:(s=(a=e.headers)===null||a===void 0?void 0:a[ct.version])!==null&&s!==void 0?s:void 0,loadMode:(c=e.headers)===null||c===void 0?void 0:c[ct.loadMode]},r)})}};Y();Oe();var qH=45e3,Yh=class{constructor(e,t,r){var i;this.handler=e,this.logger=t,this._clientId=r,this._connectionState=Ie.Disconnected,this.prevClientLeftTimer=new fn((i=this.handler.maxClientLeaveWaitTime)!==null&&i!==void 0?i:3e5,()=>{w(!this.connected,684),this.applyForConnectedState("timeout")}),this.joinOpTimer=new fn(qH,()=>{var o;if(this.connectionState!==Ie.CatchingUp)return;let a=this.handler.quorumClients(),s={quorumInitialized:a!==void 0,hasPendingClientId:this.pendingClientId!==void 0,inQuorum:a?.getMember((o=this.pendingClientId)!==null&&o!==void 0?o:"")!==void 0,waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("NoJoinOp",s)})}get connectionState(){return this._connectionState}get connected(){return this.connectionState===Ie.Connected}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}startJoinOpTimer(){w(!this.joinOpTimer.hasTimer,564),this.joinOpTimer.start()}stopJoinOpTimer(){w(this.joinOpTimer.hasTimer,565),this.joinOpTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){w(!this.joinOpTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinOpTimer.hasTimer?this.stopJoinOpTimer():this.handler.logConnectionIssue("ReceivedJoinOp"),this.waitingForLeaveOp&&(this.waitEvent=le.start(this.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){var t,r;let i=this.handler.quorumClients();w(i!==void 0,566),w(this.waitingForLeaveOp===!1||this.clientId!==void 0&&i.getMember(this.clientId)!==void 0,738),this.pendingClientId!==this.clientId&&this.pendingClientId!==void 0&&i.getMember(this.pendingClientId)!==void 0&&!this.waitingForLeaveOp?((t=this.waitEvent)===null||t===void 0||t.end({source:e}),this.setConnectionState(Ie.Connected)):this.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:e==="timeout"?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,inQuorum:i?.getMember((r=this.pendingClientId)!==null&&r!==void 0?r:"")!==void 0})})}receivedRemoveMemberEvent(e){this.clientId===e&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.joinOpTimer.hasTimer&&this.stopJoinOpTimer(),this.setConnectionState(Ie.Disconnected,e)}receivedConnectEvent(e,t){let r=this._connectionState;this._connectionState=Ie.CatchingUp;let i=e==="write";w(i||!this.handler.shouldClientJoinWrite(),778),w(i||!this.waitingForLeaveOp,678);let o=this.handler.quorumClients();this._pendingClientId=t.clientId,this.handler.logConnectionStateChangeTelemetry(Ie.CatchingUp,r),i&&o?.getMember(this._pendingClientId)===void 0?this.startJoinOpTimer():this.waitingForLeaveOp||this.setConnectionState(Ie.Connected)}setConnectionState(e,t){if(this.connectionState===e){this.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});return}let r=this._connectionState;this._connectionState=e;let i=this.handler.quorumClients(),o;this._clientId!==void 0&&(o=i?.getMember(this._clientId)),e===Ie.Connected?(w(r===Ie.CatchingUp,472),o!==void 0&&(o.shouldHaveLeft=!0),this._clientId=this.pendingClientId):e===Ie.Disconnected&&(this._pendingClientId=void 0,o!==void 0&&this.handler.shouldClientJoinWrite()&&this.prevClientLeftTimer.hasTimer===!1?this.prevClientLeftTimer.restart():this.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({inQuorum:o!==void 0,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.logConnectionStateChangeTelemetry(this._connectionState,r,t),this.handler.connectionStateChanged()}initProtocol(e){e.quorum.on("addMember",(t,r)=>{this.receivedAddMemberEvent(t)}),e.quorum.on("removeMember",t=>{this.receivedRemoveMemberEvent(t)}),this.clientId!==void 0&&e.quorum.getMember(this.clientId)!==void 0&&this.prevClientLeftTimer.restart()}};Y();var Zh=class{constructor(e,t){this.internalStorageService=e,this.logger=t,this._disposed=!1}get policies(){return this.internalStorageService.policies}get disposed(){return this._disposed}dispose(){this._disposed=!0}get repositoryUrl(){return this.internalStorageService.repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.getSnapshotTree(e,t)}),"storage_getSnapshotTree")})}readBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.readBlob(e)}),"storage_readBlob")})}getVersions(e,t,r){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.getVersions(e,t,r)}),"storage_getVersions")})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return w(t.referenceSequenceNumber===0==(t.ackHandle===void 0),593),t.referenceSequenceNumber!==0?this.internalStorageService.uploadSummaryWithContext(e,t):this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(e,t)}),"storage_uploadSummaryWithContext")})}downloadSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.downloadSummary(e)}),"storage_downloadSummary")})}createBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalStorageService.createBlob(e)}),"storage_createBlob")})}checkStorageDisposed(){if(this._disposed)throw new _n("Storage Service is disposed. Cannot retry",{canRetry:!1})}runWithRetry(e,t){return v(this,null,function*(){return Ra(e,t,this.logger,{onRetry:()=>this.checkStorageDisposed()})})}};var ep=class{constructor(e,t){this.internalStorageService=e,this.generateProtocolTree=t,this.getSnapshotTree=this.internalStorageService.getSnapshotTree.bind(this.internalStorageService),this.getVersions=this.internalStorageService.getVersions.bind(this.internalStorageService),this.createBlob=this.internalStorageService.createBlob.bind(this.internalStorageService),this.readBlob=this.internalStorageService.readBlob.bind(this.internalStorageService),this.downloadSummary=this.internalStorageService.downloadSummary.bind(this.internalStorageService),this.dispose=this.internalStorageService.dispose.bind(this.internalStorageService)}get policies(){return this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}get disposed(){return this.internalStorageService.disposed}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.internalStorageService.uploadSummaryWithContext(Ia(e,this.generateProtocolTree()),t)})}};var tp=class{constructor(e){this.storageGetter=e,this.blobContents={}}loadSnapshotForRehydratingContainer(e){this.getBlobContents(e)}getBlobContents(e){for(let[t,r]of Object.entries(e.blobsContents))this.blobContents[t]=r;for(let[t,r]of Object.entries(e.trees))this.getBlobContents(r)}get policies(){try{return this.storageGetter().policies}catch{}}get repositoryUrl(){return this.storageGetter().repositoryUrl}getSnapshotTree(e,t){return v(this,null,function*(){return this.storageGetter().getSnapshotTree(e,t)})}readBlob(e){return v(this,null,function*(){let t=this.blobContents[e];return t!==void 0?t:this.storageGetter().readBlob(e)})}getVersions(e,t,r){return v(this,null,function*(){return this.storageGetter().getVersions(e,t,r)})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return this.storageGetter().uploadSummaryWithContext(e,t)})}downloadSummary(e){return v(this,null,function*(){return this.storageGetter().downloadSummary(e)})}createBlob(e){return v(this,null,function*(){return this.storageGetter().createBlob(e)})}},np=class{constructor(e,t){this.blobStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}createBlob(e){return v(this,null,function*(){return this.blobStorage.createBlob(e)})}readBlob(e){return v(this,null,function*(){return this.blobStorage.readBlob(e)})}get policies(){return this.notCalled()}get repositoryUrl(){return this.notCalled()}notCalled(){try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendErrorEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}};Y();var rp=class extends mi{constructor(e){super(e),super.setMaxListeners(50),this.propose=so(this,e.propose.bind(e)),this.has=so(this,e.has.bind(e)),this.get=so(this,e.get.bind(e)),this.getMembers=so(this,e.getMembers.bind(e)),this.getMember=so(this,e.getMember.bind(e))}};function nk(n){let t=new Map(n).get("code");return w(t!==void 0,732),t?.value}function S0(n){return[["code",{key:"code",value:n,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]]}Y();var LH=2e3,jH=50,ip=class{constructor(e,t=LH,r=jH){this.submit=e,this.NoopCountFrequency=r,this.opsCountSinceNoop=0,t!==1/0&&(this.timer=new fn(t,()=>{this.opsCountSinceNoop!==0&&this.submitNoop(!1)}))}scheduleSequenceNumberUpdate(e,t){if(t){this.submitNoop(!0);return}if(Ni(e)){if(this.opsCountSinceNoop++,this.opsCountSinceNoop>=this.NoopCountFrequency){this.submitNoop(!1);return}this.timer!==void 0&&(this.opsCountSinceNoop===1&&this.timer.restart(),w(this.timer.hasTimer,578))}}submitNoop(e){this.submit(yn.NoOp,e?"":null),w(this.opsCountSinceNoop===0,579)}stopSequenceNumberUpdate(){this.opsCountSinceNoop=0}};var ik=Ce(P0());Y();Oe();var VH=8e3,HH=1e3,UH=16*1024,rk={fatalConnectError:!0};function GH(n){let e=`Nack (${n.type}): ${n.message}`,t=n.code!==403,r=n.retryAfter!==void 0?n.retryAfter*1e3:void 0;return Sr(e,{canRetry:t,retryAfterMs:r},{statusCode:n.code,driverVersion:void 0})}var rl=class extends Pe{constructor(){super(...arguments),this.clientId="storage-only client",this.claims={scopes:[Hh.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[],this.serviceConfiguration={maxMessageSize:0,blockSize:0,summary:void 0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map(t=>({operation:t,content:{message:"Cannot submit with storage-only connection",code:403}})))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}},op=class n{constructor(e,t,r,i,o){this.serviceProvider=e,this.client=t,this.logger=i,this.props=o,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.trailingNoopCount=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this.closed=!1,this.opHandler=(a,s)=>{let c=Array.isArray(s)?s:[s];this.props.incomingOpHandler(c,"opHandler")},this.nackHandler=(a,s)=>{let c=s[0];if(this._readonlyPermissions===!0){this.props.closeHandler(rE("writeOnReadOnlyDocument",{driverVersion:void 0}));return}let l=GH(c.content);if(!l.canRetry){this.props.closeHandler(l);return}this.reconnectOnError("write",l)},this.disconnectHandlerInternal=a=>{this.reconnectOnError(this.defaultReconnectionMode,a)},this.errorHandler=a=>{this.reconnectOnError(this.defaultReconnectionMode,a)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=r?dn.Enabled:dn.Never,this._outbound=new Eo(a=>{if(this.connection===void 0)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(a)}),this._outbound.on("error",a=>{this.props.closeHandler(cn(a))})}get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){var e,t;return(t=(e=this.connection)===null||e===void 0?void 0:e.mode)!==null&&t!==void 0?t:"read"}get connected(){return this.connection!==void 0}get clientId(){var e;return(e=this.connection)===null||e===void 0?void 0:e.clientId}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){var e,t,r;return(r=(t=(e=this.connection)===null||e===void 0?void 0:e.serviceConfiguration)===null||t===void 0?void 0:t.maxMessageSize)!==null&&r!==void 0?r:UH}get version(){if(this.connection===void 0)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){var e;return(e=this.connection)===null||e===void 0?void 0:e.serviceConfiguration}get scopes(){var e;return(e=this.connection)===null||e===void 0?void 0:e.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return this.connection!==void 0?this._connectionProps:Object.assign(Object.assign({},this._connectionProps),{sentOps:this.clientSequenceNumber})}shouldJoinWrite(){return this.clientSequenceNumberObserved<this.clientSequenceNumber-this.trailingNoopCount}get readonly(){return this._forceReadonly?!0:this._readonlyPermissions}get readOnlyInfo(){let e=this.connection!==void 0&&this.connection instanceof rl;return e||this._forceReadonly||this._readonlyPermissions===!0?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e){return{claims:e.claims,clientId:e.clientId,existing:e.existing,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version}}dispose(e){if(this.closed)return;this.closed=!0,this.pendingConnection=void 0,this._reconnectMode=dn.Never,this._outbound.clear();let t=e!==void 0?`Closing DeltaManager (${e.message})`:"Closing DeltaManager";this.disconnectFromDeltaStream(t),this.set_readonlyPermissions(!0)}setAutoReconnect(e){w(e!==dn.Never&&this._reconnectMode!==dn.Never,632),this._reconnectMode=e,e!==dn.Enabled&&this.disconnectFromDeltaStream("setAutoReconnect")}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});let t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===dn.Never)throw new ye("API is not supported for non-connecting or closed container");let r=!1;this.readonly===!0&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),r=this.disconnectFromDeltaStream("Force readonly")),this.props.readonlyChangeHandler(this.readonly),r&&this.triggerConnect("read")}}set_readonlyPermissions(e){let t=this.readonly;this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly)}connect(e){this.connectCore(e).catch(t=>{let r=cn(t,{props:rk});this.props.closeHandler(r)})}connectCore(e){return v(this,null,function*(){var t,r;if(w(!this.closed,618),this.connection!==void 0)return;let i;this.pendingConnection!==void 0&&(i=this.pendingConnection.connectionMode,this.cancelConnection(),w(this.pendingConnection===void 0,836));let o=(t=e??i)!==null&&t!==void 0?t:this.defaultReconnectionMode;this.shouldJoinWrite()&&(o="write");let a=this.serviceProvider();w(a!==void 0,679);let s;if(((r=a.policies)===null||r===void 0?void 0:r.storageOnly)===!0){s=new rl,this.setupNewSuccessfulConnection(s,"read"),w(this.pendingConnection===void 0,691);return}let c=HH,l=0,h=de.now(),u,d=new ik.default,p=d.signal;for(this.pendingConnection={abort:()=>{d.abort()},connectionMode:o};s===void 0;){if(this.closed)throw new Error("Attempting to connect a closed DeltaManager");if(p.aborted===!0){this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:at.formatTick(de.now()-h),connectionEstablished:!1});return}l++;try{this.client.mode=o,s=yield a.connectToDeltaStream(Object.assign(Object.assign({},this.client),{mode:o})),s.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),s=void 0)}catch(m){if(typeof m=="object"&&m!==null&&m?.errorType===Fc.errorType){s=new rl,o="read";break}if(!Er(m)){let x=cn(m,{props:rk});throw this.props.closeHandler(x),x}zc(this.logger,{attempts:l,delay:c,eventName:"DeltaConnectionFailureToConnect",duration:at.formatTick(de.now()-h)},m),u=m;let f=_o(m);c=f??Math.min(c*2,VH),f!==void 0&&this.props.reconnectionDelayHandler(f,m),yield Ic(c)}}if(l>1&&zc(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:l,duration:at.formatTick(de.now()-h)},u),p.aborted===!0){s.dispose(),this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:at.formatTick(de.now()-h),connectionEstablished:!0});return}this.setupNewSuccessfulConnection(s,o)})}triggerConnect(e){w(this.connection===void 0,569),this.reconnectMode===dn.Enabled&&this.connect(e)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,this.connection===void 0)return this.pendingConnection!==void 0?(this.cancelConnection(),!0):!1;w(this.pendingConnection===void 0,635);let t=this.connection;return this.connection=void 0,t.off("op",this.opHandler),t.off("signal",this.props.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),this.props.disconnectHandler(e),t.dispose(),this._connectionVerboseProps={},!0}cancelConnection(){w(this.pendingConnection!==void 0,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived"})}setupNewSuccessfulConnection(e,t){w(this.connection===void 0,230),w(!e.disposed,650),this.pendingConnection=void 0,this.connection=e;let r=!e.claims.scopes.includes(Hh.DocWrite);if(w(t==="read"||r===(this.connectionMode==="read"),231),w(!r||this.connectionMode==="read",232),this.set_readonlyPermissions(r),this.closed){this.disconnectFromDeltaStream("ConnectionManager already closed");return}this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.props.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);let i=e.initialMessages.sort((c,l)=>c.sequenceNumber-l.sequenceNumber),o=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},e.relayServiceAgent!==void 0&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let a=-1;if(i.length!==0&&(this._connectionVerboseProps.connectionInitialOpsFrom=i[0].sequenceNumber,a=i[i.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=a+1,(o===void 0||o<a)&&(o=a)),this.props.incomingOpHandler(i,this.connectFirstConnection?"InitialOps":"ReconnectOps"),e.initialSignals!==void 0)for(let c of e.initialSignals)this.props.signalHandler(c);let s=n.detailsFromConnection(e);s.checkpointSequenceNumber=o,this.props.connectHandler(s),this.connectFirstConnection=!1}reconnectOnError(e,t){this.reconnect(e,t.message,t).catch(this.props.closeHandler)}reconnect(e,t,r){return v(this,null,function*(){if(w(this.connection!==void 0,235),this.disconnectFromDeltaStream(t),r!==void 0&&!r.canRetry&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},r),this.reconnectMode===dn.Never&&this.props.closeHandler(),this.closed||this.reconnectMode!==dn.Enabled)return;let i=_o(r);r!==void 0&&i!==void 0&&(this.props.reconnectionDelayHandler(i,r),yield Ic(i)),this.triggerConnect(e)})}prepareMessageToSend(e){var t,r;if(this.readonly===!0){w(this.readOnlyInfo.readonly===!0,496);let i=new _n("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly});this.props.closeHandler(i);return}return w(!!this.connection,228),this.lastSubmittedClientId!==((t=this.connection)===null||t===void 0?void 0:t.clientId)&&(this.lastSubmittedClientId=(r=this.connection)===null||r===void 0?void 0:r.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),e.type===yn.NoOp?this.trailingNoopCount++:this.trailingNoopCount=0,Object.assign(Object.assign({},e),{clientSequenceNumber:++this.clientSequenceNumber})}submitSignal(e){this.connection!==void 0?this.connection.submitSignal(e):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}sendMessages(e){if(w(this.connected,692),this.connectionMode==="read"){this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then(()=>v(this,null,function*(){this.pendingReconnect&&(yield this.reconnect("write","Switch to write"))})).catch(()=>{}));return}w(!this.pendingReconnect,693),this._outbound.push(e)}beforeProcessingIncomingOp(e){if(w(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),this.lastSubmittedClientId!==void 0&&this.lastSubmittedClientId===e.clientId){let t=e.clientSequenceNumber;w(this.clientSequenceNumberObserved<t,239),w(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}e.type===yn.ClientLeave&&JSON.parse(e.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read","Switch to read").catch(i=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},i)}))}};var WH=0,ok="dirty",E0="saved";var KH=n=>{var e;return(e=n.get("code"))!==null&&e!==void 0?e:n.get("code2")};function ak(n,e,t){return v(this,null,function*(){let r=le.start(n,{eventName:e}),i=yield t();r.duration>1e3&&r.end(i)})}var sk="summarizer",el=(()=>{class n extends Vr{constructor(t,r){var i,o;super((u,d)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:typeof u=="string"?u:void 0},d)}),this.loader=t,this._canReconnect=!0,this._lifecycleState="loading",this._attachState=oe.Detached,this.inboundQueuePausedFromInit=!0,this.firstConnection=!0,this.connectionTransitionTimes=[],this.messageCountAfterDisconnection=0,this.attachStarted=!1,this._dirtyContainer=!1,this.setAutoReconnectTime=de.now(),this._audience=new Uh,this.clientDetailsOverride=r.clientDetailsOverride,this._resolvedUrl=r.resolvedUrl,r.canReconnect!==void 0&&(this._canReconnect=r.canReconnect);let a=this.client.details.type,c=`${this.client.details.capabilities.interactive?"interactive":"noninteractive"}${a!==void 0&&a!==""?`/${a}`:""}`;this.subLogger=ue.create(t.services.subLogger,void 0,{all:{clientType:c,containerId:ke(),docId:()=>{var u,d;return(d=(u=this._resolvedUrl)===null||u===void 0?void 0:u.id)!==null&&d!==void 0?d:void 0},containerAttachState:()=>this._attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>Ie[this.connectionState],serializedContainer:r.serializedContainerState!==void 0},error:{dmInitialSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.initialSequenceNumber},dmLastProcessedSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.lastSequenceNumber},dmLastKnownSeqNumber:()=>{var u;return(u=this._deltaManager)===null||u===void 0?void 0:u.lastKnownSeqNumber},containerLoadedFromVersionId:()=>{var u;return(u=this.loadedFromVersion)===null||u===void 0?void 0:u.id},containerLoadedFromVersionDate:()=>{var u;return(u=this.loadedFromVersion)===null||u===void 0?void 0:u.date},dmLastMsqSeqNumber:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.sequenceNumber},dmLastMsqSeqTimestamp:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.timestamp},dmLastMsqSeqClientId:()=>{var u,d;return(d=(u=this.deltaManager)===null||u===void 0?void 0:u.lastMessage)===null||d===void 0?void 0:d.clientId},connectionStateDuration:()=>de.now()-this.connectionTransitionTimes[this.connectionState]}}),this.mc=Mn(ue.create(this.subLogger,"Container"));let l=(i=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree"))!==null&&i!==void 0?i:this.loader.services.options.summarizeProtocolTree;this.options=Object.assign(Object.assign({},this.loader.services.options),{summarizeProtocolTree:l}),this.connectionStateHandler=new Yh({quorumClients:()=>{var u;return(u=this._protocolHandler)===null||u===void 0?void 0:u.quorum},logConnectionStateChangeTelemetry:(u,d,p)=>this.logConnectionStateChangeTelemetry(u,d,p),shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:this.loader.services.options.maxClientLeaveWaitTime,logConnectionIssue:(u,d)=>{this._deltaManager.logConnectionIssue(Object.assign({eventName:u,duration:de.now()-this.connectionTransitionTimes[Ie.CatchingUp]},d===void 0?{}:{details:JSON.stringify(d)}))},connectionStateChanged:()=>{this._lifecycleState==="loaded"&&this.propagateConnectionState()}},this.mc.logger,(o=r.serializedContainerState)===null||o===void 0?void 0:o.clientId),this.on(E0,()=>{this.connectionStateHandler.containerSaved()}),this._deltaManager=this.createDeltaManager(),this._storage=new tp(()=>{if(this.attachState!==oe.Attached){if(this.loader.services.detachedBlobStorage!==void 0)return new np(this.loader.services.detachedBlobStorage,this.mc.logger);throw this.mc.logger.sendErrorEvent({eventName:"NoRealStorageInDetachedContainer"}),new Error("Real storage calls not allowed in Unattached container")}return this.storageService}),typeof document=="object"&&document!==null&&typeof document.addEventListener=="function"&&document.addEventListener!==null&&(this.lastVisible=document.hidden?de.now():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=de.now():setTimeout(()=>{this.lastVisible=void 0},0)},document.addEventListener("visibilitychange",this.visibilityEventHandler)),this.on("newListener",(u,d)=>{Promise.resolve().then(()=>{switch(u){case ok:this._dirtyContainer&&d();break;case E0:this._dirtyContainer||d();break;case $d:this.connected&&d(this.clientId);break;case Xd:this.connected||d();break;default:}}).catch(p=>{this.mc.logger.sendErrorEvent({eventName:"RaiseConnectedEventError"},p)})})}static load(t,r,i){return v(this,null,function*(){let o=new n(t,{clientDetailsOverride:r.clientDetailsOverride,resolvedUrl:r.resolvedUrl,canReconnect:r.canReconnect,serializedContainerState:i});return le.timedExecAsync(o.mc.logger,{eventName:"Load"},a=>v(this,null,function*(){return new Promise((s,c)=>{var l,h;let u=r.version,d={opsBeforeReturn:"cached"},p=i?Object.assign(Object.assign({},(l=r.loadMode)!==null&&l!==void 0?l:d),{opsBeforeReturn:void 0}):(h=r.loadMode)!==null&&h!==void 0?h:d,m=f=>{c(f??new _n("Container closed without error during load"))};o.on("closed",m),o.load(u,p,i).finally(()=>{o.removeListener("closed",m)}).then(f=>{a.end(Object.assign(Object.assign({},f),r.loadMode)),s(o)},f=>{let x=cn(f);o.close(x),m(x)})})}),{start:!0,end:!0,cancel:"generic"})})}static createDetached(t,r){return v(this,null,function*(){let i=new n(t,{});return le.timedExecAsync(i.mc.logger,{eventName:"CreateDetached"},o=>v(this,null,function*(){return yield i.createDetached(r),i}),{start:!0,end:!0,cancel:"generic"})})}static rehydrateDetachedFromSnapshot(t,r){return v(this,null,function*(){let i=new n(t,{});return le.timedExecAsync(i.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},o=>v(this,null,function*(){let a=JSON.parse(r);return yield i.rehydrateDetachedFromSnapshot(a),i}),{start:!0,end:!0,cancel:"generic"})})}setLoaded(){this._lifecycleState==="loading"&&(this.propagateConnectionState(),this._lifecycleState="loaded")}get closed(){return this._lifecycleState==="closing"||this._lifecycleState==="closed"}get storage(){return this._storage}get storageService(){if(this._storageService===void 0)throw new Error("Attempted to access storageService before it was defined");return this._storageService}get context(){if(this._context===void 0)throw new _n("Attempted to access context before it was defined");return this._context}get protocolHandler(){if(this._protocolHandler===void 0)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get IFluidRouter(){return this}get resolvedUrl(){return this._resolvedUrl}get loadedFromVersion(){return this._loadedFromVersion}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get closeSignal(){return this._deltaManager.closeAbortController.signal}forceReadonly(t){this._deltaManager.connectionManager.forceReadonly(t)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connected}get serviceConfiguration(){return this._deltaManager.serviceConfiguration}get clientId(){return this.connectionStateHandler.clientId}get scopes(){return this._deltaManager.connectionManager.scopes}get clientDetails(){return this._deltaManager.clientDetails}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){var t;return(t=this._context)===null||t===void 0?void 0:t.codeDetails}get audience(){return this._audience}get isDirty(){return this._dirtyContainer}get serviceFactory(){return this.loader.services.documentServiceFactory}get urlResolver(){return this.loader.services.urlResolver}get scope(){return this.loader.services.scope}get codeLoader(){return this.loader.services.codeLoader}getQuorum(){return this.protocolHandler.quorum}close(t){this._deltaManager.close(t),w(this.connectionState===Ie.Disconnected,207),w(this._lifecycleState==="closed",788)}closeCore(t){var r,i,o,a;w(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:t===void 0?"generic":"error"},t),this._lifecycleState="closing",(r=this._protocolHandler)===null||r===void 0||r.close(),this.connectionStateHandler.dispose(),(i=this._context)===null||i===void 0||i.dispose(t!==void 0?new Error(t.message):void 0),(o=this._storageService)===null||o===void 0||o.dispose(),(a=this.service)===null||a===void 0||a.dispose(t)}catch(s){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},s)}this.emit("closed",t),this.removeAllListeners(),this.visibilityEventHandler!==void 0&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed"}}closeAndGetPendingLocalState(){w(this.attachState===oe.Attached,209),w(this.resolvedUrl!==void 0&&this.resolvedUrl.type==="fluid",210),w(!!this._protocolHandler,739),w(this._protocolHandler.attributes.term!==void 0,779);let t={pendingRuntimeState:this.context.getPendingLocalState(),url:this.resolvedUrl.url,protocol:this.protocolHandler.getProtocolState(),term:this._protocolHandler.attributes.term,clientId:this.clientId};return this.close(),JSON.stringify(t)}get attachState(){return this._attachState}serialize(){w(this.attachState===oe.Detached,211);let t=this.context.createSummary(),r=this.captureProtocolSummary(),i=Ia(t,r);return this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0&&(i.tree[".hasAttachmentBlobs"]={type:Fn.Blob,content:"true"}),JSON.stringify(i)}attach(t){return v(this,null,function*(){yield le.timedExecAsync(this.mc.logger,{eventName:"Attach"},()=>v(this,null,function*(){if(this._lifecycleState!=="loaded")throw new ye(`The Container is not in a valid state for attach [${this._lifecycleState}]`);w(this._attachState===oe.Detached&&!this.attachStarted,517),this.attachStarted=!0;let r=this.loader.services.detachedBlobStorage!==void 0&&this.loader.services.detachedBlobStorage.size>0;try{w(this.deltaManager.inbound.length===0,214);let i;if(!r){let s=this.context.createSummary(),c=this.captureProtocolSummary();i=Ia(s,c),this._attachState=oe.Attaching,this.context.notifyAttaching(Jh(i))}let o=yield this.urlResolver.resolve(t);bn(o),this.service===void 0&&(w(this.client.details.type!==sk,708),this.service=yield Ra(()=>v(this,null,function*(){return this.serviceFactory.createContainer(i,o,this.subLogger,!1)}),"containerAttach",this.mc.logger,{cancel:this.closeSignal}));let a=this.service.resolvedUrl;if(bn(a),this._resolvedUrl=a,yield this.connectStorageService(),r){w(!!this.loader.services.detachedBlobStorage,590);let s=new Map;for(;s.size<this.loader.services.detachedBlobStorage.size;){let h=this.loader.services.detachedBlobStorage.getBlobIds().filter(u=>!s.has(u));for(let u of h){let d=yield this.loader.services.detachedBlobStorage.readBlob(u),p=yield this.storageService.createBlob(d);s.set(u,p.id)}}let c=this.context.createSummary(s),l=this.captureProtocolSummary();i=Ia(c,l),this._attachState=oe.Attaching,this.context.notifyAttaching(Jh(i)),yield this.storageService.uploadSummaryWithContext(i,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0})}this._attachState=oe.Attached,this.emit("attached"),this.propagateConnectionState(),this.closed||this.resumeInternal({fetchOpsFromStorage:!1,reason:"createDetached"})}catch(i){let o=cn(i),a=this.resolvedUrl;throw Dc(a)&&o.addTelemetryProperties({resolvedUrl:a.url}),this.close(o),o}}),{start:!0,end:!0,cancel:"generic"})})}request(t){return v(this,null,function*(){return le.timedExecAsync(this.mc.logger,{eventName:"Request"},()=>v(this,null,function*(){return this.context.request(t)}),{end:!0,cancel:"error"})})}setAutoReconnectInternal(t){if(this._deltaManager.connectionManager.reconnectMode===t)return;let i=de.now(),o=i-this.setAutoReconnectTime;this.setAutoReconnectTime=i,this.mc.logger.sendTelemetryEvent({eventName:t===dn.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:Ie[this.connectionState],duration:o}),this._deltaManager.connectionManager.setAutoReconnect(t)}connect(){if(this.closed)throw new ye("The Container is closed and cannot be connected");if(this._attachState!==oe.Attached)throw new ye("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:"DocumentConnect",fetchOpsFromStorage:!1})}connectInternal(t){w(!this.closed,709),w(this._attachState===oe.Attached,710),this.resumeInternal(t);let r=dn.Enabled;this.setAutoReconnectInternal(r)}disconnect(){if(this.closed)throw new ye("The Container is closed and cannot be disconnected");this.disconnectInternal()}disconnectInternal(){w(!this.closed,711);let t=dn.Disabled;this.setAutoReconnectInternal(t)}resumeInternal(t){w(!this.closed,217),this.inboundQueuePausedFromInit&&(this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(t)}getAbsoluteUrl(t){return v(this,null,function*(){var r;if(this.resolvedUrl!==void 0)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,t,J4((r=this._context)===null||r===void 0?void 0:r.codeDetails))})}proposeCodeDetails(t){return v(this,null,function*(){if(!Uu(t))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){let r=yield this.codeLoader.IFluidCodeDetailsComparer.compare(t,this.getCodeDetailsFromQuorum());if(r!==void 0&&r<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",t).then(()=>!0).catch(()=>!1)})}processCodeProposal(){return v(this,null,function*(){let t=this.getCodeDetailsFromQuorum();if(yield Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]),(yield this.context.satisfies(t))===!0){this.deltaManager.inbound.resume(),this.deltaManager.inboundSignal.resume();return}this.close(new _n("Existing context does not satisfy incoming proposal"))})}getVersion(t){return v(this,null,function*(){return(yield this.storageService.getVersions(t,1))[0]})}recordConnectStartTime(){this.connectionTransitionTimes[Ie.Disconnected]===void 0&&(this.connectionTransitionTimes[Ie.Disconnected]=de.now())}connectToDeltaStream(t){this.recordConnectStartTime(),(!this._canReconnect||!this.client.details.capabilities.interactive)&&(t.mode="write"),this._deltaManager.connect(t)}load(t,r,i){return v(this,null,function*(){if(this._resolvedUrl===void 0)throw new Error("Attempting to load without a resolved url");this.service=yield this.serviceFactory.createDocumentService(this._resolvedUrl,this.subLogger,this.client.details.type===sk);let o={reason:"DocumentOpen",mode:"write",fetchOpsFromStorage:!1};r.deltaConnection===void 0&&this.connectToDeltaStream(o),i?this.connectStorageService().catch(u=>this.close(u)):yield this.connectStorageService(),this._attachState=oe.Attached;let{snapshot:a,versionId:s}=i===void 0?yield this.fetchSnapshotTree(t):{snapshot:void 0,versionId:void 0};w(a!==void 0||i!==void 0,567);let c=i===void 0?yield this.getDocumentAttributes(this.storageService,a):{sequenceNumber:i.protocol.sequenceNumber,minimumSequenceNumber:i.protocol.minimumSequenceNumber,term:i.term},l;switch(r.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(c,r.deltaConnection!=="none"?"all":"none");break;case"cached":l=this.attachDeltaManagerOpHandler(c,"cached");break;case"all":l=this.attachDeltaManagerOpHandler(c,"all");break;default:mt(r.opsBeforeReturn)}this._protocolHandler=i===void 0?yield this.initializeProtocolStateFromSnapshot(c,this.storageService,a):yield this.initializeProtocolState(c,i.protocol.members,i.protocol.proposals,i.protocol.values);let h=this.getCodeDetailsFromQuorum();if(yield this.instantiateContext(!0,h,a,i?.pendingRuntimeState),!this.closed)switch(l!==void 0&&(this._deltaManager.inbound.resume(),yield ak(this.mc.logger,"WaitOps",()=>v(this,null,function*(){return yield l,{}})),yield ak(this.mc.logger,"WaitOpProcessing",()=>v(this,null,function*(){return this._deltaManager.inbound.waitTillProcessingDone()})),this._deltaManager.inbound.pause()),r.deltaConnection){case void 0:case"delayed":w(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:mt(r.deltaConnection)}if(this.closed)throw new Error("Container was closed while load()");return this.setLoaded(),{sequenceNumber:c.sequenceNumber,version:s,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}})}createDetached(t){return v(this,null,function*(){let r={sequenceNumber:WH,term:1,minimumSequenceNumber:0};yield this.attachDeltaManagerOpHandler(r);let i=S0(t);this._protocolHandler=yield this.initializeProtocolState(r,[],[],i),yield this.instantiateContextDetached(!1),this.setLoaded()})}rehydrateDetachedFromSnapshot(t){return v(this,null,function*(){t.tree[".hasAttachmentBlobs"]!==void 0&&(w(!!this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0,592),delete t.tree[".hasAttachmentBlobs"]);let r=Jh(t);this._storage.loadSnapshotForRehydratingContainer(r);let i=yield this.getDocumentAttributes(this._storage,r);yield this.attachDeltaManagerOpHandler(i);let o=M0(r),a=yield Ze(this._storage,o.blobs.quorumValues),s=nk(a);this._protocolHandler=yield this.initializeProtocolState(i,[],[],s!==void 0?S0(s):[]),yield this.instantiateContextDetached(!0,r),this.setLoaded()})}connectStorageService(){return v(this,null,function*(){var t,r;if(this._storageService!==void 0)return;w(this.service!==void 0,495);let i=yield this.service.connectToStorage();this._storageService=new Zh(i,this.mc.logger),this.options.summarizeProtocolTree===!0&&(this.mc.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this._storageService=new ep(this._storageService,()=>this.captureProtocolSummary())),w(((t=i.policies)===null||t===void 0?void 0:t.minBlobSize)===((r=this.storageService.policies)===null||r===void 0?void 0:r.minBlobSize),224)})}getDocumentAttributes(t,r){return v(this,null,function*(){if(r===void 0)return{minimumSequenceNumber:0,sequenceNumber:0,term:1};let i=".protocol"in r.trees?r.trees[".protocol"].blobs.attributes:r.blobs[".attributes"],o=yield Ze(t,i);return o.term===void 0&&(o.term=1),o})}initializeProtocolStateFromSnapshot(t,r,i){return v(this,null,function*(){let o=[],a=[],s=[];if(i!==void 0){let l=M0(i);[o,a,s]=yield Promise.all([Ze(r,l.blobs.quorumMembers),Ze(r,l.blobs.quorumProposals),Ze(r,l.blobs.quorumValues)])}return yield this.initializeProtocolState(t,o,a,s)})}initializeProtocolState(t,r,i,o){return v(this,null,function*(){let a=new nu(t.minimumSequenceNumber,t.sequenceNumber,t.term,r,i,o,(c,l)=>this.submitMessage(yn.Propose,{key:c,value:l})),s=ue.create(this.subLogger,"ProtocolHandler");return a.quorum.on("error",c=>{s.sendErrorEvent(c)}),this.connectionStateHandler.initProtocol(a),a.quorum.on("addProposal",c=>{(c.key==="code"||c.key==="code2")&&this.emit("codeDetailsProposed",c.value,c)}),a.quorum.on("approveProposal",(c,l,h)=>{(l==="code"||l==="code2")&&(Uu(h)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch(u=>{throw this.close(cn(u)),u}))}),a})}captureProtocolSummary(){let t=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:Fn.Blob},quorumMembers:{content:JSON.stringify(t.members),type:Fn.Blob},quorumProposals:{content:JSON.stringify(t.proposals),type:Fn.Blob},quorumValues:{content:JSON.stringify(t.values),type:Fn.Blob}},type:Fn.Tree}}getCodeDetailsFromQuorum(){let t=this.protocolHandler.quorum;return KH(t)}get client(){var t;let r=((t=this.options)===null||t===void 0?void 0:t.client)!==void 0?this.options.client:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}};return this.clientDetailsOverride!==void 0&&(0,ck.default)(r.details,this.clientDetailsOverride),r.details.environment=[r.details.environment,` loaderVersion:${Qh}`].join(";"),r}activeConnection(){return this.connectionState===Ie.Connected&&this.connectionMode==="write"}createDeltaManager(){let t=()=>this.service,r=new Kh(t,ue.create(this.subLogger,"DeltaManager"),()=>this.activeConnection(),i=>new op(t,this.client,this._canReconnect,ue.create(this.subLogger,"ConnectionManager"),i));return r.inbound.pause(),r.inboundSignal.pause(),r.on("connect",(i,o)=>{var a;this._audience.clear();for(let s of(a=i.initialClients)!==null&&a!==void 0?a:[])this._audience.addMember(s.clientId,s.client);this.connectionStateHandler.receivedConnectEvent(this.connectionMode,i)}),r.on("disconnect",i=>{var o;(o=this.collabWindowTracker)===null||o===void 0||o.stopSequenceNumberUpdate(),this.connectionStateHandler.receivedDisconnectEvent(i)}),r.on("throttled",i=>{let o=i;o.logged!==!0&&this.logContainerError(o),this.emit("warning",o)}),r.on("readonly",i=>{this.emit("readonly",i)}),r.on("closed",i=>{this.closeCore(i)}),r}attachDeltaManagerOpHandler(t,r){return v(this,null,function*(){var i;return this._deltaManager.attachOpHandler(t.minimumSequenceNumber,t.sequenceNumber,(i=t.term)!==null&&i!==void 0?i:1,{process:o=>this.processRemoteMessage(o),processSignal:o=>{this.processSignal(o)}},r)})}logConnectionStateChangeTelemetry(t,r,i){var o;let a=de.now();this.connectionTransitionTimes[t]=a;let s=a-this.connectionTransitionTimes[r],c,l,h,u,d;t===Ie.Disconnected?h=this._deltaManager.connectionManager.reconnectMode:(t===Ie.Connected?(c=a-this.connectionTransitionTimes[Ie.Disconnected],c=at.formatTick(c)):(u=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&(d=u-this.deltaManager.lastSequenceNumber)),this.firstConnection?l="InitialConnect":l="AutoReconnect"),this.mc.logger.sendPerformanceEvent(Object.assign({eventName:`ConnectionStateChange_${Ie[t]}`,from:Ie[r],duration:s,durationFromDisconnected:c,reason:i,connectionInitiationReason:l,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.clientId,autoReconnect:h,opsBehind:d,online:Gr[Tc()],lastVisible:this.lastVisible!==void 0?de.now()-this.lastVisible:void 0,checkpointSequenceNumber:u,quorumSize:(o=this._protocolHandler)===null||o===void 0?void 0:o.quorum.getMembers().size},this._deltaManager.connectionProps)),t===Ie.Connected&&(this.firstConnection=!1)}propagateConnectionState(){var t;let r=this.connectionState===Ie.Connected&&!this.firstConnection&&this.connectionMode==="write";r&&(this.messageCountAfterDisconnection=0);let i=this.connectionState===Ie.Connected;((t=this._context)===null||t===void 0?void 0:t.disposed)===!1&&this.context.setConnectionState(i,this.clientId),this.protocolHandler.setConnectionState(i,this.clientId),po(this.mc.logger,this,i,this.clientId),r&&this.mc.logger.sendTelemetryEvent({eventName:"OpsSentOnReconnect",count:this.messageCountAfterDisconnection})}submitContainerMessage(t,r,i,o){switch(t){case yn.Operation:case yn.RemoteHelp:break;case yn.Summarize:{let s=r;s.details===void 0&&(s.details={}),s.details.includesProtocolTree=this.options.summarizeProtocolTree===!0;break}default:return this.close(new _n("invalidContainerSubmitOpType",void 0,{messageType:t})),-1}return this.submitMessage(t,r,i,o)}submitMessage(t,r,i,o){var a;return this.connectionState!==Ie.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:t}),-1):(this.messageCountAfterDisconnection+=1,(a=this.collabWindowTracker)===null||a===void 0||a.stopSequenceNumberUpdate(),this._deltaManager.submit(t,r,i,o))}processRemoteMessage(t){let r=this.clientId===t.clientId,i={immediateNoOp:!1};try{i=this.protocolHandler.processMessage(t,r)}catch(o){this.close(Pi(o,a=>new Xt(a,ur(t))))}return yo(t)&&!Ni(t)&&this.mc.logger.sendTelemetryEvent({eventName:"UnpackedRuntimeMessage",type:t.type}),(Ni(t)||yo(t))&&this.context.process(t,r,void 0),this.activeConnection()&&(this.collabWindowTracker===void 0&&(w(this.serviceConfiguration!==void 0,740),this.collabWindowTracker=new ip((o,a)=>{w(this.activeConnection(),577),this.submitMessage(o,a)},this.serviceConfiguration.noopTimeFrequency,this.serviceConfiguration.noopCountFrequency)),this.collabWindowTracker.scheduleSequenceNumberUpdate(t,i.immediateNoOp===!0)),this.emit("op",t),i}submitSignal(t){this._deltaManager.submitSignal(JSON.stringify(t))}processSignal(t){if(t.clientId===null){let r=t.content;if(r.type===yn.ClientJoin){let i=r.content;this._audience.addMember(i.clientId,i.client)}else if(r.type===yn.ClientLeave){let i=r.content;this._audience.removeMember(i)}}else{let r=this.clientId===t.clientId;this.context.processSignal(t,r)}}fetchSnapshotTree(t){return v(this,null,function*(){var r;let i=yield this.getVersion(t??null);i===void 0&&t!==void 0&&this.mc.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:t}),this._loadedFromVersion=i;let o=(r=yield this.storageService.getSnapshotTree(i))!==null&&r!==void 0?r:void 0;return o===void 0&&i!==void 0&&this.mc.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:i.id}),{snapshot:o,versionId:i?.id}})}instantiateContextDetached(t,r){return v(this,null,function*(){let i=this.getCodeDetailsFromQuorum();if(i===void 0)throw new Error("pkg should be provided in create flow!!");yield this.instantiateContext(t,i,r)})}instantiateContext(t,r,i,o){return v(this,null,function*(){var a;w(((a=this._context)===null||a===void 0?void 0:a.disposed)!==!1,221);let s=new tl(this,this.loader);this._context=yield Gh.createOrLoad(this,this.scope,this.codeLoader,r,i,new $h(this._deltaManager),new rp(this.protocolHandler.quorum),s,(c,l,h,u)=>this.submitContainerMessage(c,l,h,u),c=>this.submitSignal(c),c=>this.close(c),n.version,c=>this.updateDirtyContainerState(c),t,o),this.emit("contextChanged",r)})}updateDirtyContainerState(t){this._dirtyContainer!==t&&(this._dirtyContainer=t,this.emit(t?ok:E0))}logContainerError(t){this.mc.logger.sendErrorEvent({eventName:"ContainerWarning"},t)}}return n.version="^0.1.0",n})();var il=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(il||{});Y();Oe();var $H=2e3,ap=class{constructor(e,t,r,i){this.tenantId=e,this.id=t,this.deltaStorageService=r,this.documentStorageService=i,this.logtailSha=this.documentStorageService.logTailSha}fetchMessages(e,t,r,i,o){return i?sE:aE(this.getCore.bind(this),1,e,t,$H,new Us,r,o)}getCore(e,t){return v(this,null,function*(){let r=this.logtailSha?yield Ze(this.documentStorageService,this.logtailSha):[];if(this.logtailSha=void 0,r.length>0){let i=r.filter(o=>o.sequenceNumber>=e);if(i.length>0)return{messages:i,partialResult:!0}}return this.deltaStorageService.get(this.tenantId,this.id,e,t)})}},sp=class{constructor(e,t,r,i=()=>v(this,null,function*(){return this.restWrapper}),o=()=>this.url){this.url=e,this.restWrapper=t,this.logger=r,this.getRestWrapper=i,this.getDeltaStorageUrl=o}get(e,t,r,i){return v(this,null,function*(){return{messages:yield le.timedExecAsync(this.logger,{eventName:"getDeltas",from:r,to:i},a=>v(this,null,function*(){let s=yield this.getRestWrapper(),c=this.getDeltaStorageUrl(),l=yield s.get(c,{from:r-1,to:i});return a.end({count:l.length}),l})),partialResult:!1}})}};Y();var Xi=class extends Error{constructor(e,t,r,i,o){super(t),this.code=e,this.canRetry=r,this.isFatal=i,this.retryAfterMs=o,this.name="NetworkError",this.retryAfter=o!==void 0?o/1e3:void 0}get details(){return this.canRetry===void 0&&this.isFatal===void 0&&this.retryAfterMs===void 0?this.message:{message:this.message,canRetry:this.canRetry,isFatal:this.isFatal,retryAfter:this.retryAfter,retryAfterMs:this.retryAfterMs}}toJSON(){return{code:this.code,message:this.message,canRetry:this.canRetry,isFatal:this.isFatal,retryAfterMs:this.retryAfterMs,retryAfter:this.retryAfter}}};function yp(n,e){var t;let r,i,o,a;switch(e&&typeof e=="object"?(r=(t=e.message)!==null&&t!==void 0?t:"Unknown Error",i=e.canRetry,o=e.isFatal,a=e.retryAfter):e&&typeof e=="string"?r=e:r="Unknown Error",n){case 401:case 403:case 404:return new Xi(n,r,!1,!1);case 413:case 422:return new Xi(n,r,i??!1,o??!1,i?a:void 0);case 429:return new Xi(n,r,!0,!1,a);case 500:return new Xi(n,r,i??!0,o??!1,i?a:void 0);case 502:case 503:case 504:return new Xi(n,r,!0,!1,a);default:return new Xi(n,r,!1,!0)}}var Cp="x-correlation-id";Y();Hr();var W0=function(n){return n.File="100644",n.Executable="100755",n.Directory="040000",n.Symlink="120000",n}(W0||{}),Do=function(n){return n.Blob="Blob",n.Tree="Tree",n.Attachment="Attachment",n}(Do||{});var Hn=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Hn||{});var Ik=Ce($f());var Tk="@fluidframework/server-services-client",zk="0.1036.5002";var ti=(0,Ik.debug)("fluid:services-client");ti(`Package: ${Tk} - Version: ${zk}`);var dl=class{constructor(e){this.historian=e,this.blobCache=new Map,this.commitCache=new Map,this.treeCache=new Map,this.refCache=new Map}getHeader(e,t){return v(this,null,function*(){let r=yield this.historian.getHeader(t);for(let i of r.blobs)this.blobCache.set(i.sha,i);return ma(r.tree)})}getFullTree(e){return v(this,null,function*(){return this.historian.getFullTree(e)})}getCommit(e){return v(this,null,function*(){return this.commitCache.has(e)?(ti(`Cache hit on ${e}`),this.commitCache.get(e)):this.historian.getCommit(e)})}getCommits(e,t){return v(this,null,function*(){let r=e;if(this.refCache.has(e)&&(ti(`Commit cache hit on ${e}`),r=this.refCache.get(e),this.refCache.delete(e),!r))return[];if(this.commitCache.has(r)){let i=this.commitCache.get(r);return[{commit:{author:i.author,committer:i.committer,message:i.message,tree:i.tree,url:i.url},parents:i.parents,sha:i.sha,url:i.url}]}return this.historian.getCommits(r,t)})}getTree(e,t=!0){return v(this,null,function*(){return this.treeCache.has(e)?(ti(`Tree cache hit on ${e}`),this.treeCache.get(e)):this.historian.getTree(e,t)})}getBlob(e){return v(this,null,function*(){return this.blobCache.has(e)?(ti(`Blob cache hit on ${e}`),this.blobCache.get(e)):this.historian.getBlob(e)})}getRawUrl(e){return`${this.historian.endpoint}/git/blobs/raw/${e}`}getContent(e,t){return v(this,null,function*(){return this.historian.getContent(t,e)})}createBlob(e,t){return v(this,null,function*(){let r={content:e,encoding:t};return this.historian.createBlob(r)})}createGitTree(e){return v(this,null,function*(){return this.historian.createTree(e)})}createTree(e){return v(this,null,function*(){return this.createTreeCore(e,0)})}createCommit(e){return v(this,null,function*(){return this.historian.createCommit(e)})}createSummary(e){return v(this,null,function*(){return this.historian.createSummary(e)})}deleteSummary(e){return v(this,null,function*(){return this.historian.deleteSummary(e)})}getSummary(e){return v(this,null,function*(){return this.historian.getSummary(e)})}getRef(e){return v(this,null,function*(){return this.historian.getRef(`heads/${e}`).catch(t=>{if(t===400||t===404)return null;throw t})})}createRef(e,t){return v(this,null,function*(){let r={ref:`refs/heads/${e}`,sha:t,config:{enabled:!0}};return this.historian.createRef(r)})}upsertRef(e,t){return v(this,null,function*(){let r={force:!0,sha:t,config:{enabled:!0}};return this.historian.updateRef(`heads/${e}`,r)})}addRef(e,t){this.refCache.set(e,t)}addCommit(e){this.commitCache.set(e.sha,e)}addTree(e){this.treeCache.set(e.sha,e)}addBlob(e){this.blobCache.set(e.sha,e)}write(e,t,r,i){return v(this,null,function*(){let o=yield this.createTree(t),a={author:{date:new Date().toISOString(),email:"kurtb@microsoft.com",name:"Kurt Berglund"},message:i,parents:r,tree:o.sha},s=yield this.historian.createCommit(a);return(yield this.getRef(e))?yield this.upsertRef(e,s.sha):yield this.createRef(e,s.sha),s})}createTreeCore(e,t){return v(this,null,function*(){if(e.id)return this.getTree(e.id);let r=[];for(let c of e.entries)switch(Do[c.type]){case Do.Blob:{let l=c.value;c.mode===W0.Symlink&&(l.contents=this.translateSymlink(l.contents,t));let h=this.createBlob(l.contents,l.encoding);r.push(h);break}case Do.Tree:{let l=c.value,h=this.createTreeCore(l,t+1);r.push(h);break}default:throw new Error("Unknown entry type")}let i=yield Promise.all(r),o=[];w(i.length===e.entries.length,"File entries length is not correct");for(let c=0;c<e.entries.length;c++){let l=e.entries[c].type===Do.Tree?"tree":e.entries[c].type===Do.Blob?"blob":"commit";o.push({mode:e.entries[c].mode,path:e.entries[c].path,sha:i[c].sha,type:l})}let a={tree:o};return this.historian.createTree(a)})}translateSymlink(e,t){let r="";for(let i=0;i<=t;i++)r+="../";return`${r}${e}`}};Y();var Hk=Ce(Lk()),Uk=Ce($0()),Gk=Ce(tE());Nt();var pl=class{constructor(e,t={},r=1e3*1024*1024,i=1e3*1024*1024){this.baseurl=e,this.defaultQueryString=t,this.maxBodyLength=r,this.maxContentLength=i}get(e,t,r){return v(this,null,function*(){let i={baseURL:this.baseurl,headers:r,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"GET",url:`${e}${this.generateQueryString(t)}`};return this.request(i,200)})}post(e,t,r,i){return v(this,null,function*(){let o={baseURL:this.baseurl,data:t,headers:i,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"POST",url:`${e}${this.generateQueryString(r)}`};return this.request(o,201)})}delete(e,t,r){return v(this,null,function*(){let i={baseURL:this.baseurl,headers:r,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"DELETE",url:`${e}${this.generateQueryString(t)}`};return this.request(i,204)})}patch(e,t,r,i){return v(this,null,function*(){let o={baseURL:this.baseurl,data:t,headers:i,maxBodyLength:this.maxBodyLength,maxContentLength:this.maxContentLength,method:"PATCH",url:`${e}${this.generateQueryString(r)}`};return this.request(o,200)})}generateQueryString(e){if(this.defaultQueryString||e){let t=Object.assign(Object.assign({},this.defaultQueryString),e),r=Hk.stringify(t);if(r!=="")return`?${r}`}return""}},wp=class extends pl{constructor(e,t={},r=1e3*1024*1024,i=1e3*1024*1024,o={},a=Gk.default,s,c,l){super(e,t,r,i),this.defaultHeaders=o,this.axios=a,this.refreshDefaultQueryString=s,this.refreshDefaultHeaders=c,this.getCorrelationId=l}request(e,t,r=!0){return v(this,null,function*(){var i,o;let a=Object.assign({},e);return a.headers=this.generateHeaders(a.headers,(o=(i=this.getCorrelationId)===null||i===void 0?void 0:i.call(this))!==null&&o!==void 0?o:ke()),new Promise((s,c)=>{this.axios.request(a).then(l=>{s(l.data)}).catch(l=>{var h,u,d,p,m,f,x,b,_,O,S,E,F,I;if(((h=l?.response)===null||h===void 0?void 0:h.status)===t&&s((u=l?.response)===null||u===void 0?void 0:u.data),l?.config?ti(`[${l.config.method}] request to [${(d=l.config.baseURL)!==null&&d!==void 0?d:""}${(p=l.config.url)!==null&&p!==void 0?p:""}] failed with [${(m=l.response)===null||m===void 0?void 0:m.status}] [${(0,Uk.default)((f=l.response)===null||f===void 0?void 0:f.data,void 0,2)}]`):ti(`request to ${a.url} failed ${l?l.message:""}`),((x=l?.response)===null||x===void 0?void 0:x.status)===429&&((_=(b=l?.response)===null||b===void 0?void 0:b.data)===null||_===void 0?void 0:_.retryAfter)>0&&r)setTimeout(()=>{this.request(a,t).then(s).catch(c)},l.response.data.retryAfter*1e3);else if(((O=l?.response)===null||O===void 0?void 0:O.status)===401&&r&&this.refreshOnAuthError()){let y=Object.assign({},e);y.headers=this.generateHeaders(y.headers,a.headers[Cp]),this.request(y,t,!1).then(s).catch(c)}else if(l?.response)c(yp((S=l?.response)===null||S===void 0?void 0:S.status,(E=l?.response)===null||E===void 0?void 0:E.data));else if(l?.request)c(yp(502,`Network Error: ${(F=l?.message)!==null&&F!==void 0?F:"undefined"}`));else{let y={canRetry:!1,isFatal:!1,message:(I=l?.message)!==null&&I!==void 0?I:"Unknown Error"};c(yp(500,y))}})})})}generateHeaders(e,t){let r=e??{};return this.defaultHeaders&&(r=Object.assign(Object.assign({},this.defaultHeaders),e)),r[Cp]?r:Object.assign({[Cp]:t},r)}refreshOnAuthError(){return this.refreshDefaultQueryString===void 0&&this.refreshDefaultHeaders===void 0?!1:(this.refreshDefaultHeaders!==void 0&&(this.defaultHeaders=this.refreshDefaultHeaders()),this.refreshDefaultQueryString!==void 0&&(this.defaultQueryString=this.refreshDefaultQueryString()),!0)}};function HW(n,e){for(let t of e)if(n.endsWith(t))return!0;return!1}var Wk=n=>`Basic ${Vs(`${n.user}:${n.password}`)}`,gl=class{constructor(e,t,r,i){this.endpoint=e,this.historianApi=t,this.restWrapper=i,this.defaultQueryString={},r&&this.historianApi?(this.defaultQueryString.disableCache=r,this.cacheBust=!1):this.cacheBust=r,this.restWrapper===void 0&&(this.restWrapper=new wp(this.endpoint))}getHeader(e){return v(this,null,function*(){return this.historianApi?this.restWrapper.get(`/headers/${encodeURIComponent(e)}`,this.getQueryString()):this.getHeaderDirect(e)})}getFullTree(e){return v(this,null,function*(){return this.restWrapper.get(`/tree/${encodeURIComponent(e)}`,this.getQueryString())})}getBlob(e){return v(this,null,function*(){return this.restWrapper.get(`/git/blobs/${encodeURIComponent(e)}`,this.getQueryString())})}createBlob(e){return v(this,null,function*(){return this.restWrapper.post("/git/blobs",e,this.getQueryString())})}getContent(e,t){return v(this,null,function*(){return this.restWrapper.get(`/contents/${e}`,this.getQueryString({ref:t}))})}getCommits(e,t){return v(this,null,function*(){return this.restWrapper.get("/commits",this.getQueryString({count:t,sha:e})).catch(r=>r===400||r===404?[]:Promise.reject(r))})}getCommit(e){return v(this,null,function*(){return this.restWrapper.get(`/git/commits/${encodeURIComponent(e)}`,this.getQueryString())})}createCommit(e){return v(this,null,function*(){return this.restWrapper.post("/git/commits",e,this.getQueryString())})}getRefs(){return v(this,null,function*(){return this.restWrapper.get("/git/refs",this.getQueryString())})}getRef(e){return v(this,null,function*(){return this.restWrapper.get(`/git/refs/${e}`,this.getQueryString())})}createRef(e){return v(this,null,function*(){return this.restWrapper.post("/git/refs",e,this.getQueryString())})}updateRef(e,t){return v(this,null,function*(){return this.restWrapper.patch(`/git/refs/${e}`,t,this.getQueryString())})}deleteRef(e){return v(this,null,function*(){yield this.restWrapper.delete(`/git/refs/${e}`,this.getQueryString())})}createTag(e){return v(this,null,function*(){return this.restWrapper.post("/git/tags",e,this.getQueryString())})}getTag(e){return v(this,null,function*(){return this.restWrapper.get(`/git/tags/${e}`,this.getQueryString())})}createTree(e){return v(this,null,function*(){return this.restWrapper.post("/git/trees",e,this.getQueryString())})}getTree(e,t){return v(this,null,function*(){return this.restWrapper.get(`/git/trees/${encodeURIComponent(e)}`,this.getQueryString({recursive:t?1:0}))})}createSummary(e){return v(this,null,function*(){return this.restWrapper.post("/git/summaries",e,this.getQueryString())})}deleteSummary(e){return v(this,null,function*(){let t={"Soft-Delete":e};return this.restWrapper.delete("/git/summaries",this.getQueryString(),t)})}getSummary(e){return v(this,null,function*(){return this.restWrapper.get(`/git/summaries/${e}`,this.getQueryString())})}getHeaderDirect(e){return v(this,null,function*(){let t=yield this.getTree(e,!0),r=[".attributes",".blobs",".messages","header"],i=[];for(let a of t.tree)if(a.type==="blob"&&HW(a.path,r)){let s=this.getBlob(a.sha);i.push(s)}return{blobs:yield Promise.all(i),tree:t}})}getQueryString(e){return this.cacheBust?Object.assign(Object.assign({cacheBust:Date.now()},this.defaultQueryString),e):Object.assign(Object.assign({},this.defaultQueryString),e)}};var Pp=function(n){return n.Method="method",n.Header="header",n.Body="body",n}(Pp||{}),UW=(n,e)=>`${n}: ${e}`,Op=class{translate(e){var t,r;let i=Object.assign({},e),o=new URLSearchParams;if(o.append(Pp.Method,(t=i.method)!==null&&t!==void 0?t:"GET"),i.headers)for(let[a,s]of Object.entries(i.headers)){let c=UW(a,s);o.append(Pp.Header,c)}if(i.data&&["post","put","patch"].includes((r=i.method)===null||r===void 0?void 0:r.toLowerCase())){let a=JSON.stringify(i.data);o.append(Pp.Body,a)}return i.data=o.toString(),i.method="POST",i.headers={"Content-Type":"application/x-www-form-urlencoded;restless"},i}};Y();Hr();var X0=(...n)=>n.map(e=>e.replace(/^\//,"").replace(/\/$/,"")).filter(e=>!!e).join("/");function J0(n,e,t="",r=""){let i={type:"tree",entries:[]},o=Object.keys(e.tree);for(let a of o){let s=e.tree[a],c,l,h,u=X0(t===""?r:t,a);switch(s.type){case Hn.Tree:{l=J0(n,s,u,r),h=s.unreferenced||void 0;break}case Hn.Blob:{typeof s.content=="string"?l={type:"blob",content:s.content,encoding:"utf-8"}:l={type:"blob",content:Pn(s.content,"base64"),encoding:"base64"};break}case Hn.Handle:{if(s.embedded)c=s.handle;else{if(!n)throw Error("Parent summary does not exist to reference by handle.");c=X0(n,r,s.handle)}break}case Hn.Attachment:{c=s.id;break}default:mt(s,`Unknown type: ${s.type}`)}let d={path:encodeURIComponent(a),type:Yd(s)},p;if(l)w(c===void 0,173),p=Object.assign({value:l,unreferenced:h},d);else if(c)p=Object.assign(Object.assign({},d),{id:c});else throw new Error(`Invalid tree entry for ${s.type}`);i.entries.push(p)}return i}function GW(n,e){let t={},r={id:n.id,blobs:{},trees:{}};t[""]=r;for(let i of n.entries){let o=i.path.replace(new RegExp(`^${e}/`),""),a=o.lastIndexOf("/"),s=o.slice(0,Math.max(0,a)),c=o.slice(a+1),l=t[s];if(i.type==="tree"){let h={blobs:{},trees:{},unreferenced:i.unreferenced};l.trees[decodeURIComponent(c)]=h,t[o]=h}else if(i.type==="blob")l.blobs[decodeURIComponent(c)]=i.id;else throw new Error("Unknown entry type!!")}return r}function Q0(n,e=".app"){var t;let r=new Map;n.blobs&&n.blobs.forEach(s=>{var c;r.set(s.id,Bn(s.content,(c=s.encoding)!==null&&c!==void 0?c:"utf-8"))});let i=(t=n.trees)===null||t===void 0?void 0:t[0],o=i?.sequenceNumber,a=GW(i,e);return{blobs:r,snapshotTree:a,sequenceNumber:o}}Y();Hr();var Mp=class{constructor(e,t,r){this.manager=e,this.blobsShaCache=t,this.getPreviousFullSnapshot=r}writeSummaryTree(e,t,r,i){return v(this,null,function*(){let o=yield this.getPreviousFullSnapshot(t);return this.writeSummaryTreeCore(e,o??void 0)})}writeSummaryTreeCore(e,t){return v(this,null,function*(){let r=yield Promise.all(Object.keys(e.tree).map(o=>v(this,null,function*(){let a=e.tree[o],s=yield this.writeSummaryTreeObject(a,t);return{mode:AO(a),path:encodeURIComponent(o),sha:s,type:Yd(a)}})));return(yield this.manager.createGitTree({tree:r})).sha})}writeSummaryTreeObject(e,t){return v(this,null,function*(){switch(e.type){case Hn.Blob:return this.writeSummaryBlob(e.content);case Hn.Handle:{if(t===void 0)throw Error("Parent summary does not exist to reference by handle.");return this.getIdFromPath(e.handleType,e.handle,t)}case Hn.Tree:return this.writeSummaryTreeCore(e,t);case Hn.Attachment:return e.id;default:mt(e,`Unknown type: ${e.type}`)}})}writeSummaryBlob(e){return v(this,null,function*(){let{parsedContent:t,encoding:r}=typeof e=="string"?{parsedContent:e,encoding:"utf-8"}:{parsedContent:Pn(e,"base64"),encoding:"base64"},i=yield sf(Wt.from(t,r));if(!this.blobsShaCache.has(i)){this.blobsShaCache.set(i,"");let o=yield this.manager.createBlob(t,r);w(i===o.sha,182)}return i})}getIdFromPath(e,t,r){let i=t.split("/").map(o=>decodeURIComponent(o));return i[0]===""&&i.shift(),i.length===0?r.id:this.getIdFromPathCore(e,i,r)}getIdFromPathCore(e,t,r){var i;w(t.length>0,179);let o=t[0];if(t.length===1)switch(e){case Hn.Blob:{let a=r.blobs[o];return w(!!a,180),a}case Hn.Tree:{let a=(i=r.trees[o])===null||i===void 0?void 0:i.id;return w(!!a,181),a}default:throw Error(`Unexpected handle summary object type: "${e}".`)}return this.getIdFromPathCore(e,t.slice(1),r.trees[o])}};var Sp=class{constructor(e){this.manager=e}writeSummaryTree(e,t,r,i){return v(this,null,function*(){let o=yield this.writeSummaryTreeCore(t,e,r,i??0);if(!o)throw new Error("Failed to write summary tree");return o})}writeSummaryTreeCore(e,t,r,i){return v(this,null,function*(){let a={entries:J0(e,t,"",r==="channel"?".app":"").entries,message:void 0,sequenceNumber:i,type:r};return this.manager.createSummary(a).then(s=>s.id)})}};var fr=Object.create(null);fr.open="0";fr.close="1";fr.ping="2";fr.pong="3";fr.message="4";fr.upgrade="5";fr.noop="6";var fl=Object.create(null);Object.keys(fr).forEach(n=>{fl[fr[n]]=n});var ml={type:"error",data:"parser error"};var Xk=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Jk=typeof ArrayBuffer=="function",Qk=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,vl=({type:n,data:e},t,r)=>Xk&&e instanceof Blob?t?r(e):Kk(e,r):Jk&&(e instanceof ArrayBuffer||Qk(e))?t?r(e):Kk(new Blob([e]),r):r(fr[n]+(e||"")),Kk=(n,e)=>{let t=new FileReader;return t.onload=function(){let r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)};function $k(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}var Y0;function Yk(n,e){if(Xk&&n.data instanceof Blob)return n.data.arrayBuffer().then($k).then(e);if(Jk&&(n.data instanceof ArrayBuffer||Qk(n.data)))return e($k(n.data));vl(n,!1,t=>{Y0||(Y0=new TextEncoder),e(Y0.encode(t))})}var Zk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bl=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Zk.length;n++)bl[Zk.charCodeAt(n)]=n;var e3=n=>{let e=n.length*.75,t=n.length,r,i=0,o,a,s,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);let l=new ArrayBuffer(e),h=new Uint8Array(l);for(r=0;r<t;r+=4)o=bl[n.charCodeAt(r)],a=bl[n.charCodeAt(r+1)],s=bl[n.charCodeAt(r+2)],c=bl[n.charCodeAt(r+3)],h[i++]=o<<2|a>>4,h[i++]=(a&15)<<4|s>>2,h[i++]=(s&3)<<6|c&63;return l};var WW=typeof ArrayBuffer=="function",xl=(n,e)=>{if(typeof n!="string")return{type:"message",data:t3(n,e)};let t=n.charAt(0);return t==="b"?{type:"message",data:KW(n.substring(1),e)}:fl[t]?n.length>1?{type:fl[t],data:n.substring(1)}:{type:fl[t]}:ml},KW=(n,e)=>{if(WW){let t=e3(n);return t3(t,e)}else return{base64:!0,data:n}},t3=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}};var n3="",r3=(n,e)=>{let t=n.length,r=new Array(t),i=0;n.forEach((o,a)=>{vl(o,!1,s=>{r[a]=s,++i===t&&e(r.join(n3))})})},i3=(n,e)=>{let t=n.split(n3),r=[];for(let i=0;i<t.length;i++){let o=xl(t[i],e);if(r.push(o),o.type==="error")break}return r};function o3(){return new TransformStream({transform(n,e){Yk(n,t=>{let r=t.length,i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);let o=new DataView(i.buffer);o.setUint8(0,126),o.setUint16(1,r)}else{i=new Uint8Array(9);let o=new DataView(i.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(r))}n.data&&typeof n.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}var Z0;function Ep(n){return n.reduce((e,t)=>e+t.length,0)}function Ap(n,e){if(n[0].length===e)return n.shift();let t=new Uint8Array(e),r=0;for(let i=0;i<e;i++)t[i]=n[0][r++],r===n[0].length&&(n.shift(),r=0);return n.length&&r<n[0].length&&(n[0]=n[0].slice(r)),t}function a3(n,e){Z0||(Z0=new TextDecoder);let t=[],r=0,i=-1,o=!1;return new TransformStream({transform(a,s){for(t.push(a);;){if(r===0){if(Ep(t)<1)break;let c=Ap(t,1);o=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(Ep(t)<2)break;let c=Ap(t,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Ep(t)<8)break;let c=Ap(t,8),l=new DataView(c.buffer,c.byteOffset,c.length),h=l.getUint32(0);if(h>Math.pow(2,21)-1){s.enqueue(ml);break}i=h*Math.pow(2,32)+l.getUint32(4),r=3}else{if(Ep(t)<i)break;let c=Ap(t,i);s.enqueue(xl(o?c:Z0.decode(c),e)),r=0}if(i===0||i>n){s.enqueue(ml);break}}}})}var eb=4;function dt(n){if(n)return $W(n)}function $W(n){for(var e in dt.prototype)n[e]=dt.prototype[e];return n}dt.prototype.on=dt.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};dt.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};dt.prototype.off=dt.prototype.removeListener=dt.prototype.removeAllListeners=dt.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};dt.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};dt.prototype.emitReserved=dt.prototype.emit;dt.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};dt.prototype.hasListeners=function(n){return!!this.listeners(n).length};var hn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function kp(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}var XW=hn.setTimeout,JW=hn.clearTimeout;function ni(n,e){e.useNativeTimers?(n.setTimeoutFn=XW.bind(hn),n.clearTimeoutFn=JW.bind(hn)):(n.setTimeoutFn=hn.setTimeout.bind(hn),n.clearTimeoutFn=hn.clearTimeout.bind(hn))}var QW=1.33;function s3(n){return typeof n=="string"?YW(n):Math.ceil((n.byteLength||n.size)*QW)}function YW(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function c3(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function l3(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let o=t[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}var Dp=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},ri=class extends dt{constructor(e){super(),this.writable=!1,ni(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new Dp(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=xl(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=c3(e);return t.length?"?"+t:""}};var p3="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),tb=64,ZW={},d3=0,Fp=0,u3;function h3(n){let e="";do e=p3[n%tb]+e,n=Math.floor(n/tb);while(n>0);return e}function Tp(){let n=h3(+new Date);return n!==u3?(d3=0,u3=n):n+"."+h3(d3++)}for(;Fp<tb;Fp++)ZW[p3[Fp]]=Fp;var g3=!1;try{g3=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var f3=g3;function nb(n){let e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||f3))return new XMLHttpRequest}catch{}if(!e)try{return new hn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function eK(){}var tK=function(){return new nb({xdomain:!1}).responseType!=null}(),Ip=class extends ri{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let r=location.protocol==="https:",i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}let t=e&&e.forceBase64;this.supportsBinary=tK&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};i3(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,r3(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Tp()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new zp(this.uri(),e)}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,o)=>{this.onError("xhr post error",i,o)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}},zp=(()=>{class n extends dt{constructor(t,r){super(),ni(this,r),this.opts=r,this.method=r.method||"GET",this.uri=t,this.data=r.data!==void 0?r.data:null,this.create()}create(){var t;let r=kp(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;let i=this.xhr=new nb(r);try{i.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.opts.extraHeaders[o])}}catch{}if(this.method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this.opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{var o;i.readyState===3&&((o=this.opts.cookieJar)===null||o===void 0||o.parseCookies(i)),i.readyState===4&&(i.status===200||i.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof i.status=="number"?i.status:0)},0))},i.send(this.data)}catch(o){this.setTimeoutFn(()=>{this.onError(o)},0);return}typeof document<"u"&&(this.index=n.requestsCount++,n.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=eK,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete n.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return n.requestsCount=0,n.requests={},n})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",m3);else if(typeof addEventListener=="function"){let n="onpagehide"in hn?"pagehide":"unload";addEventListener(n,m3,!1)}}function m3(){for(let n in zp.requests)zp.requests.hasOwnProperty(n)&&zp.requests[n].abort()}var Fo=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),_l=hn.WebSocket||hn.MozWebSocket,Rp=!0,v3="arraybuffer";var b3=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Np=class extends ri{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,r=b3?{}:kp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Rp&&!b3?t?new _l(e,t):new _l(e):new _l(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;vl(r,this.supportsBinary,o=>{let a={};Rp||(r.options&&(a.compress=r.options.compress),this.opts.perMessageDeflate&&(typeof o=="string"?Buffer.byteLength(o):o.length)<this.opts.perMessageDeflate.threshold&&(a.compress=!1));try{Rp?this.ws.send(o):this.ws.send(o,a)}catch{}i&&Fo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Tp()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!_l}};var Bp=class extends ri{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t=a3(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),i=o3();i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();let o=()=>{r.read().then(({done:s,value:c})=>{s||(this.onPacket(c),o())}).catch(s=>{})};o();let a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this.writer.write(a).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;this.writer.write(r).then(()=>{i&&Fo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}};var rb={websocket:Np,webtransport:Bp,polling:Ip};var nK=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rK=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function cs(n){if(n.length>2e3)throw"URI too long";let e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=nK.exec(n||""),o={},a=14;for(;a--;)o[rK[a]]=i[a]||"";return t!=-1&&r!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=iK(o,o.path),o.queryKey=oK(o,o.query),o}function iK(n,e){let t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function oK(n,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,o){i&&(t[i]=o)}),t}var qp=(()=>{class n extends dt{constructor(t,r={}){super(),this.binaryType=v3,this.writeBuffer=[],t&&typeof t=="object"&&(r=t,t=null),t?(t=cs(t),r.hostname=t.host,r.secure=t.protocol==="https"||t.protocol==="wss",r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=cs(r.host).host),ni(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=l3(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let r=Object.assign({},this.opts.query);r.EIO=eb,r.transport=t,this.id&&(r.sid=this.id);let i=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new rb[t](i)}open(){let t;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(t){let r=this.createTransport(t),i=!1;n.priorWebsocketSuccess=!1;let o=()=>{i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{let p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function a(){i||(i=!0,u(),r.close(),r=null)}let s=d=>{let p=new Error("probe error: "+d);p.transport=r.name,a(),this.emitReserved("upgradeError",p)};function c(){s("transport closed")}function l(){s("socket closed")}function h(d){r&&d.name!==r.name&&a()}let u=()=>{r.removeListener("open",o),r.removeListener("error",s),r.removeListener("close",c),this.off("close",l),this.off("upgrading",h)};r.once("open",o),r.once("error",s),r.once("close",c),this.once("close",l),this.once("upgrading",h),this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||r.open()},200):r.open()}onOpen(){if(this.readyState="open",n.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let t=0,r=this.upgrades.length;for(;t<r;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=t.data,this.onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let i=0;i<this.writeBuffer.length;i++){let o=this.writeBuffer[i].data;if(o&&(r+=s3(o)),i>0&&r>this.maxPayload)return this.writeBuffer.slice(0,i);r+=2}return this.writeBuffer}write(t,r,i){return this.sendPacket("message",t,r,i),this}send(t,r,i){return this.sendPacket("message",t,r,i),this}sendPacket(t,r,i,o){if(typeof r=="function"&&(o=r,r=void 0),typeof i=="function"&&(o=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let a={type:t,data:r,options:i};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),o&&this.once("flush",o),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(t){n.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let r=[],i=0,o=t.length;for(;i<o;i++)~this.transports.indexOf(t[i])&&r.push(t[i]);return r}}return n.protocol=eb,n})();var d0e=qp.protocol;function x3(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=cs(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let o=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(t&&t.port===r.port?"":":"+r.port),r}var lb={};Zi(lb,{Decoder:()=>sb,Encoder:()=>ab,PacketType:()=>Te,protocol:()=>P3});var aK=typeof ArrayBuffer=="function",sK=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,_3=Object.prototype.toString,cK=typeof Blob=="function"||typeof Blob<"u"&&_3.call(Blob)==="[object BlobConstructor]",lK=typeof File=="function"||typeof File<"u"&&_3.call(File)==="[object FileConstructor]";function Cl(n){return aK&&(n instanceof ArrayBuffer||sK(n))||cK&&n instanceof Blob||lK&&n instanceof File}function yl(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(yl(n[t]))return!0;return!1}if(Cl(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return yl(n.toJSON(),!0);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&yl(n[t]))return!0;return!1}function y3(n){let e=[],t=n.data,r=n;return r.data=ib(t,e),r.attachments=e.length,{packet:r,buffers:e}}function ib(n,e){if(!n)return n;if(Cl(n)){let t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){let t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=ib(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){let t={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=ib(n[r],e));return t}return n}function C3(n,e){return n.data=ob(n.data,e),delete n.attachments,n}function ob(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=ob(n[t],e);else if(typeof n=="object")for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=ob(n[t],e));return n}var dK=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],P3=5,Te=function(n){return n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK",n}(Te||{}),ab=class{constructor(e){this.replacer=e}encode(e){return(e.type===Te.EVENT||e.type===Te.ACK)&&yl(e)?this.encodeAsBinary({type:e.type===Te.EVENT?Te.BINARY_EVENT:Te.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Te.BINARY_EVENT||e.type===Te.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=y3(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}};function w3(n){return Object.prototype.toString.call(n)==="[object Object]"}var sb=class n extends dt{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let r=t.type===Te.BINARY_EVENT;r||t.type===Te.BINARY_ACK?(t.type=r?Te.EVENT:Te.ACK,this.reconstructor=new cb(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Cl(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(Te[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Te.BINARY_EVENT||r.type===Te.BINARY_ACK){let o=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let a=e.substring(o,t);if(a!=Number(a)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(a)}if(e.charAt(t+1)==="/"){let o=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(o,t)}else r.nsp="/";let i=e.charAt(t+1);if(i!==""&&Number(i)==i){let o=t+1;for(;++t;){let a=e.charAt(t);if(a==null||Number(a)!=a){--t;break}if(t===e.length)break}r.id=Number(e.substring(o,t+1))}if(e.charAt(++t)){let o=this.tryParse(e.substr(t));if(n.isPayloadValid(r.type,o))r.data=o;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Te.CONNECT:return w3(t);case Te.DISCONNECT:return t===void 0;case Te.CONNECT_ERROR:return typeof t=="string"||w3(t);case Te.EVENT:case Te.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&dK.indexOf(t[0])===-1);case Te.ACK:case Te.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},cb=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=C3(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Un(n,e,t){return n.on(e,t),function(){n.off(e,t)}}var uK=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),ls=class extends dt{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Un(e,"open",this.onopen.bind(this)),Un(e,"packet",this.onpacket.bind(this)),Un(e,"error",this.onerror.bind(this)),Un(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(uK.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let r={type:Te.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let a=this.ids++,s=t.pop();this._registerAckCallback(a,s),r.id=a}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;let i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},i),a=(...s)=>{this.io.clearTimeoutFn(o),t.apply(this,s)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...t){return new Promise((r,i)=>{let o=(a,s)=>a?i(a):r(s);o.withError=!0,t.push(o),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...o)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...o)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Te.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){let r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Te.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Te.EVENT:case Te.BINARY_EVENT:this.onevent(e);break;case Te.ACK:case Te.BINARY_ACK:this.onack(e);break;case Te.DISCONNECT:this.ondisconnect();break;case Te.CONNECT_ERROR:this.destroy();let r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...i){r||(r=!0,t.packet({type:Te.ACK,id:e,data:i}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Te.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}};function To(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}To.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};To.prototype.reset=function(){this.attempts=0};To.prototype.setMin=function(n){this.ms=n};To.prototype.setMax=function(n){this.max=n};To.prototype.setJitter=function(n){this.jitter=n};var ds=class extends dt{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,ni(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new To({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||lb;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new qp(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let i=Un(t,"open",function(){r.onopen(),e&&e()}),o=s=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",s),e?e(s):this.maybeReconnectOnOpen()},a=Un(t,"error",o);if(this._timeout!==!1){let s=this._timeout,c=this.setTimeoutFn(()=>{i(),o(new Error("timeout")),t.close()},s);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Un(e,"ping",this.onping.bind(this)),Un(e,"data",this.ondata.bind(this)),Un(e,"error",this.onerror.bind(this)),Un(e,"close",this.onclose.bind(this)),Un(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Fo(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new ls(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t)if(this.nsps[r].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var wl={};function Pl(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};let t=x3(n,e.path||"/socket.io"),r=t.source,i=t.id,o=t.path,a=wl[i]&&o in wl[i].nsps,s=e.forceNew||e["force new connection"]||e.multiplex===!1||a,c;return s?c=new ds(r,e):(wl[i]||(wl[i]=new ds(r,e)),c=wl[i]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(Pl,{Manager:ds,Socket:ls,io:Pl,connect:Pl});Oe();Y();Oe();var mr=class{constructor(){this.cache=new Map}get(e){return v(this,null,function*(){return this.cache.get(e)})}put(e,t){return v(this,null,function*(){this.cache.set(e,t)})}};var O3="latest",Lp=class{constructor(e,t,r,i={},o,a=new mr,s=new mr,c,l=h=>v(this,null,function*(){return h&&this.noCacheGitManager!==void 0?this.noCacheGitManager:this.manager})){this.id=e,this.manager=t,this.logger=r,this.policies=i,this.driverPolicies=o,this.blobCache=a,this.snapshotTreeCache=s,this.noCacheGitManager=c,this.getStorageManager=l,this.firstVersionsCall=!0}get repositoryUrl(){return""}getSummaryUploadManager(){return v(this,null,function*(){let e=yield this.getStorageManager();return new Sp(e)})}getVersions(e,t){return v(this,null,function*(){var r;if(e!==this.id&&e!==null)return[{id:e,treeId:void 0}];if(this.firstVersionsCall&&t===1){this.firstVersionsCall=!1;let{id:a,snapshotTree:s}=!((r=this.driverPolicies)===null||r===void 0)&&r.enableDiscovery?yield this.fetchAndCacheSnapshotTree(O3,!0):yield this.fetchAndCacheSnapshotTree(O3,!1);return[{id:a,treeId:s.id}]}let i=e||this.id;return(yield le.timedExecAsync(this.logger,{eventName:"getVersions",versionId:i,count:t},()=>v(this,null,function*(){return(yield this.getStorageManager()).getCommits(i,t)}))).map(a=>({date:a.commit.author.date,id:a.sha,treeId:a.commit.tree.sha}))})}getSnapshotTree(e){return v(this,null,function*(){let t=e;if(!t){let r=yield this.getVersions(this.id,1);if(r.length===0)return null;t=r[0]}return(yield this.fetchAndCacheSnapshotTree(t.id)).snapshotTree})}readBlob(e){return v(this,null,function*(){let t=yield this.blobCache.get(this.getCacheKey(e));if(t!==void 0)return t;let r=yield le.timedExecAsync(this.logger,{eventName:"readBlob",blobId:e},o=>v(this,null,function*(){let s=yield(yield this.getStorageManager()).getBlob(e);return o.end({size:s.size}),s})),i=Bn(r.content,r.encoding);return yield this.blobCache.put(this.getCacheKey(r.sha),i),i})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return yield le.timedExecAsync(this.logger,{eventName:"uploadSummaryWithContext"},()=>v(this,null,function*(){var i;return(yield this.getSummaryUploadManager()).writeSummaryTree(e,(i=t.ackHandle)!==null&&i!==void 0?i:"","channel")}))})}downloadSummary(e){return v(this,null,function*(){let t=yield le.timedExecAsync(this.logger,{eventName:"getWholeFlatSummary",treeId:e.handle},o=>v(this,null,function*(){var a;let c=yield(yield this.getStorageManager()).getSummary(e.handle);return o.end({size:(a=c.trees[0])===null||a===void 0?void 0:a.entries.length}),c})),{blobs:r,snapshotTree:i}=Q0(t,"");return Dv(i,r)})}createBlob(e){return v(this,null,function*(){let t=new Uint8Array(e);return le.timedExecAsync(this.logger,{eventName:"createBlob",size:t.length},r=>v(this,null,function*(){let o=yield(yield this.getStorageManager()).createBlob(Pn(t,"base64"),"base64").then(a=>({id:a.sha,url:a.url}));return r.end({blobId:o.id}),o}))})}fetchAndCacheSnapshotTree(e,t){return v(this,null,function*(){let r=yield this.snapshotTreeCache.get(this.getCacheKey(e));if(r!==void 0)return{id:r.id,snapshotTree:r.snapshotTree};let i=yield le.timedExecAsync(this.logger,{eventName:"getWholeFlatSummary",treeId:e},h=>v(this,null,function*(){var u;let p=yield(yield this.getStorageManager(t)).getSummary(e);return h.end({size:(u=p.trees[0])===null||u===void 0?void 0:u.entries.length}),p})),o=Q0(i),a=i.id,s=o.snapshotTree.id;w(s!==void 0,629);let c={id:a,snapshotTree:o.snapshotTree},l=[this.snapshotTreeCache.put(this.getCacheKey(s),c),this.initBlobCache(o.blobs)];return s!==e&&l.push(this.snapshotTreeCache.put(this.getCacheKey(e),c)),yield Promise.all(l),c})}initBlobCache(e){return v(this,null,function*(){let t=[];e.forEach((r,i)=>{let o=this.getCacheKey(i);t.push(this.blobCache.put(o,r))}),yield Promise.all(t)})}getCacheKey(e){return`${this.id}:${e}`}};Y();Hr();Oe();var jp=class{constructor(e,t){this.internalGitManager=e,this.logger=t}getHeader(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getHeader(e,t)}),"gitManager_getHeader")})}getFullTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getFullTree(e)}),"gitManager_getFullTree")})}getCommit(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getCommit(e)}),"gitManager_getCommit")})}getCommits(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getCommits(e,t)}),"gitManager_getCommits")})}getTree(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getTree(e,t)}),"gitManager_getTree")})}getBlob(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getBlob(e)}),"gitManager_getBlob")})}getRawUrl(e){return this.internalGitManager.getRawUrl(e)}getContent(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getContent(e,t)}),"gitManager_getContent")})}createBlob(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createBlob(e,t)}),"gitManager_createBlob")})}createGitTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createGitTree(e)}),"gitManager_createGitTree")})}createTree(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createTree(e)}),"gitManager_createTree")})}createCommit(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createCommit(e)}),"gitManager_createCommit")})}getRef(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getRef(e)}),"gitManager_getRef")})}createRef(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createRef(e,t)}),"gitManager_createRef")})}upsertRef(e,t){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.upsertRef(e,t)}),"gitManager_upsertRef")})}write(e,t,r,i){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.write(e,t,r,i)}),"gitManager_write")})}createSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.createSummary(e)}),"gitManager_createSummary")})}deleteSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.deleteSummary(e)}),"gitManager_deleteSummary")})}getSummary(e){return v(this,null,function*(){return this.runWithRetry(()=>v(this,null,function*(){return this.internalGitManager.getSummary(e)}),"gitManager_getSummary")})}runWithRetry(e,t){return v(this,null,function*(){return Ra(e,t,this.logger,{})})}};var hK=typeof window>"u",Vp=class{constructor(e,t,r,i={},o,a,s,c=()=>v(this,null,function*(){return this.manager})){this.id=e,this.manager=t,this.logger=r,this.policies=i,this.getStorageManager=c,this.blobsShaCache=new Map,(o?.enableRestLess===!0||hK)&&(this.blobCache=a??new mr,this.snapshotTreeCache=s??new mr)}get repositoryUrl(){return""}getSummaryUploadManager(){return v(this,null,function*(){let e=yield this.getStorageManager();return new Mp(new jp(e,this.logger),this.blobsShaCache,this.getPreviousFullSnapshot.bind(this))})}getVersions(e,t){return v(this,null,function*(){let r=e||this.id;return(yield le.timedExecAsync(this.logger,{eventName:"getVersions",versionId:r,count:t},()=>v(this,null,function*(){return(yield this.getStorageManager()).getCommits(r,t)}))).map(o=>({date:o.commit.author.date,id:o.sha,treeId:o.commit.tree.sha}))})}getSnapshotTree(e){return v(this,null,function*(){var t,r;let i=e;if(!i){let c=yield this.getVersions(this.id,1);if(c.length===0)return null;i=c[0]}let o=yield(t=this.snapshotTreeCache)===null||t===void 0?void 0:t.get(this.getCacheKey(i.treeId));if(o)return o.snapshotTree;let a=yield le.timedExecAsync(this.logger,{eventName:"getSnapshotTree",treeId:i.treeId},c=>v(this,null,function*(){let h=yield(yield this.getStorageManager()).getTree(i.treeId);return c.end({size:h.tree.length}),h})),s=ma(a,this.blobsShaCache,!0);return yield(r=this.snapshotTreeCache)===null||r===void 0?void 0:r.put(this.getCacheKey(s.id),{id:i.id,snapshotTree:s}),s})}readBlob(e){return v(this,null,function*(){var t,r;let i=yield(t=this.blobCache)===null||t===void 0?void 0:t.get(this.getCacheKey(e));if(i)return i;let o=yield le.timedExecAsync(this.logger,{eventName:"readBlob",blobId:e},s=>v(this,null,function*(){let l=yield(yield this.getStorageManager()).getBlob(e);return s.end({size:l.size}),l}));this.blobsShaCache.set(o.sha,"");let a=Bn(o.content,o.encoding);return yield(r=this.blobCache)===null||r===void 0?void 0:r.put(this.getCacheKey(o.sha),a),a})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return yield le.timedExecAsync(this.logger,{eventName:"uploadSummaryWithContext"},()=>v(this,null,function*(){var i;return(yield this.getSummaryUploadManager()).writeSummaryTree(e,(i=t.ackHandle)!==null&&i!==void 0?i:"","channel")}))})}downloadSummary(e){return v(this,null,function*(){throw new Error("NOT IMPLEMENTED!")})}createBlob(e){return v(this,null,function*(){let t=new Uint8Array(e);return le.timedExecAsync(this.logger,{eventName:"createBlob",size:t.length},r=>v(this,null,function*(){let o=yield(yield this.getStorageManager()).createBlob(Pn(t,"base64"),"base64").then(a=>({id:a.sha,url:a.url}));return r.end({blobId:o.id}),o}))})}getPreviousFullSnapshot(e){return v(this,null,function*(){return e?this.getVersions(e,1).then(t=>v(this,null,function*(){return this.blobsShaCache.clear(),this.getSnapshotTree(t[0])})):void 0})}getCacheKey(e){return`${this.id}:${e}`}};var Hp=class n extends xi{constructor(e,t,r,i={},o,a,s,c,l){super(n.loadInternalDocumentStorageService(e,t,r,i,o,a,s,c,l)),this.id=e,this.manager=t,this.noCacheGitManager=c,this._logTailSha=void 0}get logTailSha(){return this._logTailSha}static loadInternalDocumentStorageService(e,t,r,i,o,a,s,c,l){let h=o?.enableWholeSummaryUpload?new Lp(e,t,r,i,o,a,s,c,l):new Vp(e,t,r,i,o,a,s,l);return!o?.enableWholeSummaryUpload&&i.caching===Ai.Prefetch?new Du(h):h}getSnapshotTree(e){return v(this,null,function*(){let t=yield this.internalStorageService.getSnapshotTree(e);return t!==null&&(this._logTailSha=".logTail"in t.trees?t.trees[".logTail"].blobs.logTail:void 0),t})}};Y();var db=function(n){return n.DocRead="doc:read",n.DocWrite="doc:write",n.SummaryWrite="summary:write",n}(db||{});Oe();var ub="1.4.0";var M3=(()=>{class n extends Vr{constructor(t,r,i,o=!1){super((a,s)=>{i.sendErrorEvent({eventName:"DeltaConnection:EventException",name:a},s)}),this.socket=t,this.documentId=r,this.enableLongPollingDowngrades=o,this.queuedMessages=[],this.queuedSignals=[],this.earlyOpHandlerAttached=!1,this.connectionListeners=new Map,this.trackedListeners=new Map,this._disposed=!1,this.earlyOpHandler=(a,s)=>{this.queuedMessages.push(...s)},this.earlySignalHandler=a=>{this.queuedSignals.push(a)},this.mc=Mn(ue.create(i,"DeltaConnection")),this.on("newListener",(a,s)=>{if(w(!this.disposed,522),n.eventsAlwaysForwarded.includes(a)){w(this.trackedListeners.has(a),581);return}if(!n.eventsToForward.includes(a))throw new Error(`DocumentDeltaConnection: Registering for unknown event: ${a}`);w(this.listeners(a).length!==0===this.trackedListeners.has(a),523),this.trackedListeners.has(a)||this.addTrackedListener(a,(...c)=>{this.emit(a,...c)})})}get hasDetails(){return!!this._details}get disposed(){return w(this._disposed||this.socket.connected,580),this._disposed}get logger(){return this.mc.logger}get details(){if(!this._details)throw new Error("Internal error: calling method before _details is initialized!");return this._details}get clientId(){return this.details.clientId}get mode(){return this.details.mode}get claims(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.serviceConfiguration.maxMessageSize}get version(){return this.details.version}get serviceConfiguration(){return this.details.serviceConfiguration}checkNotClosed(){w(!this.disposed,524)}get initialMessages(){return this.checkNotClosed(),w(this.earlyOpHandlerAttached,142),w(this.listeners("op").length!==0,143),this.removeEarlyOpHandler(),this.queuedMessages.length>0&&(this.details.initialMessages.push(...this.queuedMessages),this.details.initialMessages.sort((t,r)=>t.sequenceNumber-r.sequenceNumber),this.queuedMessages.length=0),this.details.initialMessages}get initialSignals(){return this.checkNotClosed(),w(this.listeners("signal").length!==0,144),this.removeEarlySignalHandler(),this.queuedSignals.length>0&&(this.details.initialSignals.push(...this.queuedSignals),this.queuedSignals.length=0),this.details.initialSignals}get initialClients(){return this.checkNotClosed(),this.details.initialClients}emitMessages(t,r){this.disposed||this.socket.emit(t,this.clientId,r)}submitCore(t,r){this.emitMessages(t,[r])}submit(t){this.checkNotClosed(),this.submitCore("submitOp",t)}submitSignal(t){this.checkNotClosed(),this.submitCore("submitSignal",[t])}dispose(){this.disposeCore(!1,Sr("Client closing delta connection",{canRetry:!0},{driverVersion:ub}))}disposeCore(t,r){this._disposed||(this._disposed=!0,this.removeTrackedListeners(),this.disconnect(t,r))}disconnect(t,r){this.socket.disconnect()}initialize(t,r){return v(this,null,function*(){this.socket.on("op",this.earlyOpHandler),this.socket.on("signal",this.earlySignalHandler),this.earlyOpHandlerAttached=!0;let i=0,o=()=>this.socket.io.reconnection(),a=()=>o()?this.socket.io.reconnectionAttempts():0,s=()=>a()+1;this._details=yield new Promise((c,l)=>{let h=(u,d)=>{this.disposeCore(u,d),l(d)};this.addConnectionListener("connect_error",u=>{var d;i++;let p=!1;try{let m=u?.description;m&&typeof m=="object"&&(u.type==="TransportError"&&(p=!0),m.target=void 0)}catch{}p&&this.enableLongPollingDowngrades&&((d=this.socket.io.opts.transports)===null||d===void 0?void 0:d[0])!=="polling"&&(this.socket.io.opts.transports=["polling","websocket"],o()||(this.socket.io.reconnection(!0),this.socket.io.reconnectionAttempts(1))),!(o()&&i<s())&&h(!0,this.createErrorObject("connect_error",u))}),this.addConnectionListener("connect_timeout",()=>{h(!0,this.createErrorObject("connect_timeout"))}),this.addConnectionListener("connect_document_success",u=>{if(t.nonce!==void 0&&u.nonce!==void 0&&u.nonce!==t.nonce)return;let d=t.mode,p=u.mode;if(u.claims.scopes.includes(db.DocWrite)){if(p!==d){h(!1,this.createErrorObject("connect_document_success","Connected in a different mode than was requested",!1));return}}else if(p==="write"){h(!1,this.createErrorObject("connect_document_success","Connected in write mode without write permissions",!1));return}this.checkpointSequenceNumber=u.checkpointSequenceNumber,this.removeConnectionListeners(),c(u)}),this.addTrackedListener("disconnect",u=>{let d=this.createErrorObject("disconnect",u);this.emit("disconnect",d),h(!0,d)}),this.addTrackedListener("error",u=>{let d=this.createErrorObject("error",u,u!=="Invalid namespace");this.emit("error",d),h(!0,d)}),this.addConnectionListener("connect_document_error",u=>{t.nonce!==void 0&&u.nonce!==void 0&&u.nonce!==t.nonce||h(!1,this.createErrorObject("connect_document_error",u))}),this.socket.emit("connect_document",t),this.socketConnectionTimeout=setTimeout(()=>{h(!1,this.createErrorObject("orderingServiceHandshakeTimeout"))},r+2e3)}),w(!this.disposed,582)})}removeEarlyOpHandler(){this.socket.removeListener("op",this.earlyOpHandler),this.earlyOpHandlerAttached=!1}removeEarlySignalHandler(){this.socket.removeListener("signal",this.earlySignalHandler)}addConnectionListener(t,r){w(!n.eventsAlwaysForwarded.includes(t),583),w(!n.eventsToForward.includes(t),584),this.socket.on(t,r),w(!this.connectionListeners.has(t),525),this.connectionListeners.set(t,r)}addTrackedListener(t,r){this.socket.on(t,r),w(!this.trackedListeners.has(t),526),this.trackedListeners.set(t,r)}removeTrackedListeners(){for(let[t,r]of this.trackedListeners.entries())this.socket.off(t,r);this.removeConnectionListeners(),this.removeEarlyOpHandler(),this.removeEarlySignalHandler(),this.trackedListeners.clear()}removeConnectionListeners(){this.socketConnectionTimeout!==void 0&&clearTimeout(this.socketConnectionTimeout);for(let[t,r]of this.connectionListeners.entries())this.socket.off(t,r);this.connectionListeners.clear()}createErrorObject(t,r,i=!0){let o;return r?.type==="TransportError"?o=`${r?.message!==void 0?`${r.message}: `:""}${JSON.stringify(r,am())}`:o=pf(r).message,Sr(`socket.io (${t}): ${o}`,{canRetry:i},{driverVersion:ub})}}return n.eventsToForward=["nack","op","signal","pong"],n.eventsAlwaysForwarded=["disconnect","error"],n})();var Ji="1.4.0";var S3=function(n){return n.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",n}(S3||{});function E3(n,e,t){let r={statusCode:e,driverVersion:Ji};switch(e){case void 0:return new za(n,n.startsWith("NetworkError"),r);case 401:case 403:return new Au(n,void 0,void 0,r);case 404:let i=S3.fileNotFoundOrAccessDeniedError;return new Wr(n,i,r);case 429:return Sr(n,{canRetry:!0,retryAfterMs:t},r);case 500:case 502:return new za(n,!0,r);default:return Sr(n,{canRetry:t!==void 0,retryAfterMs:t},r)}}function hb(n,e,t){throw E3(n,e,t)}function A3(n,e){let t=`R11s socket error (${e}): ${n.message}`;return E3(t,n.code,n.retryAfterMs)}var pK=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"],Up=class n extends M3{static create(e,t,r,i,o,a,s,c=2e4){return v(this,null,function*(){let l=i(a,{query:{documentId:t,tenantId:e},reconnection:!1,transports:["websocket"],timeout:c}),h={client:o,id:t,mode:o.mode,tenantId:e,token:r,versions:pK,relayUserAgent:[o.details.environment,` driverVersion:${Ji}`].join(";")},u=!0,d=new n(l,t,s,u);return yield d.initialize(h,c),d})}createErrorObject(e,t,r=!0){return r&&Number.isInteger(t?.code)&&typeof t?.message=="string"?A3(t,e):super.createErrorObject(e,t,r)}};var Gp=class{get repositoryUrl(){throw new Error("Invalid operation")}getSnapshotTree(e){return v(this,null,function*(){return e?Promise.reject(new Error("Invalid operation")):null})}getVersions(e,t){return v(this,null,function*(){return[]})}uploadSummaryWithContext(e,t){return v(this,null,function*(){return Promise.reject(new Error("Invalid operation"))})}downloadSummary(e){return v(this,null,function*(){return Promise.reject(new Error("Invalid operation"))})}createBlob(e){return v(this,null,function*(){return Promise.reject(new Error("Null blob storage can not create blob"))})}readBlob(e){return v(this,null,function*(){return Promise.reject(new Error("Null blob storage can not read blob"))})}};Y();Oe();var T3=Ce(F3()),pb=Ce($0());Nt();var gK=n=>{var e,t;let r=n.baseURL!==void 0?`${n.baseURL}${(e=n.url)!==null&&e!==void 0?e:""}`:(t=n.url)!==null&&t!==void 0?t:"",i={method:n.method,headers:n.headers,body:n.data};return[r,i]},Kp=class extends pl{constructor(e,t,r,i,o,a={}){super(o,a),this.rateLimiter=t,this.getAuthorizationHeader=r,this.useRestLess=i,this.restLess=new Op}load(){return v(this,null,function*(){this.authorizationHeader=yield this.getAuthorizationHeader()})}request(e,t,r=!0){return v(this,null,function*(){var i;let o=Object.assign(Object.assign({},e),{headers:this.generateHeaders(e.headers)}),a=this.useRestLess?this.restLess.translate(o):o,s=gK(a),c=yield this.rateLimiter.schedule(()=>v(this,null,function*(){return(0,T3.default)(...s).catch(u=>v(this,null,function*(){let d=["TypeError","FetchError"].includes(u?.name);hb(d?`NetworkError: ${u.message}`:(0,pb.default)(u))}))})),l=!((i=c.headers.get("content-type"))===null||i===void 0)&&i.includes("application/json")?yield c.json():yield c.text();if(c.ok||c.status===t)return l;if(c.status===401&&r)return this.authorizationHeader=yield this.getAuthorizationHeader(!0),this.request(o,t,!1);if(c.status===429&&l?.retryAfter>0)return new Promise((u,d)=>setTimeout(()=>{this.request(o,t).then(u).catch(d)},l.retryAfter*1e3));let h=l!==void 0?typeof l=="string"?l:(0,pb.default)(l):c.statusText;hb(`R11s fetch error: ${h}`,c.status,l?.retryAfter)})}generateHeaders(e){let t=e?.["x-correlation-id"]||ke();return Object.assign(Object.assign({},e),{"x-correlation-id":t,"x-driver-version":Ji,Authorization:this.authorizationHeader})}},$p=class n extends Kp{constructor(e,t,r,i,o,a={}){super(e,t,r,i,o,a)}static load(e,t,r,i,o,a,s){return v(this,null,function*(){let c={token:`${Vs(e)}`},l=u=>v(this,null,function*(){return le.timedExecAsync(i,{eventName:"FetchStorageToken",docId:t},()=>v(this,null,function*(){let p={password:(yield r.fetchStorageToken(e,t,u)).jwt,user:e};return Wk(p)}))}),h=new n(i,o,l,a,s,c);try{yield h.load()}catch(u){i.sendErrorEvent({eventName:"R11sRestWrapperLoadFailure"},u),yield h.load()}return h})}},zo=class n extends Kp{constructor(e,t,r,i,o,a={}){super(e,t,r,i,o,a)}static load(e,t,r,i,o,a,s){return v(this,null,function*(){let c=h=>v(this,null,function*(){return le.timedExecAsync(i,{eventName:"FetchOrdererToken",docId:t},()=>v(this,null,function*(){return`Basic ${(yield r.fetchOrdererToken(e,t,h)).jwt}`}))}),l=new n(i,o,c,a,s);try{yield l.load()}catch(h){i.sendErrorEvent({eventName:"R11sRestWrapperLoadFailure"},h),yield l.load()}return l})}};var fK=5*6e4,Xp=class{constructor(e,t,r,i,o,a,s,c,l,h,u,d){this._resolvedUrl=e,this.ordererUrl=t,this.deltaStorageUrl=r,this.storageUrl=i,this.logger=o,this.tokenProvider=a,this.tenantId=s,this.documentId=c,this.driverPolicies=l,this.blobCache=h,this.snapshotTreeCache=u,this.discoverFluidResolvedUrl=d,this.lastDiscoveredAt=Date.now()}get resolvedUrl(){return this._resolvedUrl}dispose(){}connectToStorage(){return v(this,null,function*(){if(this.documentStorageService!==void 0)return this.documentStorageService;if(this.storageUrl===void 0)return new Gp;let e=o=>v(this,null,function*(){let a=this.shouldUpdateDiscoveredSessionInfo();if(a&&(yield this.refreshDiscovery()),!this.storageManager||!this.noCacheStorageManager||a){let s=new Ri(this.driverPolicies.maxConcurrentStorageRequests),c=yield $p.load(this.tenantId,this.documentId,this.tokenProvider,this.logger,s,this.driverPolicies.enableRestLess,this.storageUrl),l=new gl(this.storageUrl,!0,!1,c);this.storageManager=new dl(l);let h=new gl(this.storageUrl,!0,!0,c);this.noCacheStorageManager=new dl(h)}return o?this.noCacheStorageManager:this.storageManager}),t=yield e(),r=yield e(!0),i={caching:this.driverPolicies.enablePrefetch?Ai.Prefetch:Ai.NoCaching,minBlobSize:this.driverPolicies.aggregateBlobsSmallerThanBytes};return this.documentStorageService=new Hp(this.documentId,t,this.logger,i,this.driverPolicies,this.blobCache,this.snapshotTreeCache,r,e),this.documentStorageService})}connectToDeltaStorage(){return v(this,null,function*(){yield this.connectToStorage(),w(!!this.documentStorageService,177);let e=()=>v(this,null,function*(){let i=this.shouldUpdateDiscoveredSessionInfo();if(i&&(yield this.refreshDiscovery()),!this.ordererRestWrapper||i){let o=new Ri(this.driverPolicies.maxConcurrentOrdererRequests);this.ordererRestWrapper=yield zo.load(this.tenantId,this.documentId,this.tokenProvider,this.logger,o,this.driverPolicies.enableRestLess)}return this.ordererRestWrapper}),t=yield e(),r=new sp(this.deltaStorageUrl,t,this.logger,e,()=>this.deltaStorageUrl);return new ap(this.tenantId,this.documentId,r,this.documentStorageService)})}connectToDeltaStream(e){return v(this,null,function*(){let t=r=>v(this,null,function*(){this.shouldUpdateDiscoveredSessionInfo()&&(yield this.refreshDiscovery());let i=yield le.timedExecAsync(this.logger,{eventName:"GetDeltaStreamToken",docId:this.documentId,details:JSON.stringify({refreshToken:r})},()=>v(this,null,function*(){return this.tokenProvider.fetchOrdererToken(this.tenantId,this.documentId,r)}));return le.timedExecAsync(this.logger,{eventName:"ConnectToDeltaStream",docId:this.documentId},()=>v(this,null,function*(){return Up.create(this.tenantId,this.documentId,i.jwt,Pl,e,this.ordererUrl,this.logger)}))});try{return yield t()}catch(r){if(r?.statusCode===401)return t(!0);throw r}})}refreshDiscovery(){return v(this,null,function*(){return this.discoverP||(this.discoverP=le.timedExecAsync(this.logger,{eventName:"RefreshDiscovery"},()=>v(this,null,function*(){return this.refreshDiscoveryCore()}))),this.discoverP})}refreshDiscoveryCore(){return v(this,null,function*(){let e=yield this.discoverFluidResolvedUrl();this._resolvedUrl=e,this.storageUrl=e.endpoints.storageUrl,this.ordererUrl=e.endpoints.ordererUrl,this.deltaStorageUrl=e.endpoints.deltaStorageUrl})}shouldUpdateDiscoveredSessionInfo(){if(!this.driverPolicies.enableDiscovery)return!1;let t=Date.now()-this.lastDiscoveredAt>fK;return t&&(this.lastDiscoveredAt=Date.now(),this.discoverP=void 0,this.refreshDiscovery().catch(()=>{this.lastDiscoveredAt=0})),t}};Y();Oe();Y();var Ol=function(n){return n.Tree=1,n.Blob=2,n.Handle=3,n.Attachment=4,n}(Ol||{});function gb(n){let e=Object.keys(n.tree);for(let t of e){let r=n.tree[t];switch(r.type){case Ol.Tree:{n.tree[t]=gb(r);break}case Ol.Blob:{r.content=typeof r.content=="string"?r.content:Pn(r.content,"utf8");break}case Ol.Handle:throw new Error("No handle should be present for first summary!!");default:throw new Error(`Unknown tree type ${r.type}`)}}return n}var Io=Ce(W3());var Ml=n=>new Io.default(n,!0),bb=(n,e)=>n.split("/").slice(0,-1).concat([e]).join("/"),xb=(n,e)=>{if(e){let t=new Io.default(e.ordererUrl),r=new Io.default(n.endpoints.deltaStorageUrl);r.set("host",t.host);let i=new Io.default(e.historianUrl),o=new Io.default(n.endpoints.storageUrl);o.set("host",i.host);let a=Ml(n.url);return{endpoints:{deltaStorageUrl:r.toString(),ordererUrl:e.ordererUrl,storageUrl:o.toString()},id:n.id,tokens:n.tokens,type:n.type,url:new Io.default(`fluid://${t.host}${a.pathname}`).toString()}}else return n};var SK={enablePrefetch:!0,maxConcurrentStorageRequests:100,maxConcurrentOrdererRequests:100,aggregateBlobsSmallerThanBytes:void 0,enableDiscovery:!1,enableWholeSummaryUpload:!1,enableRestLess:!0},Qp=class{constructor(e,t={}){this.tokenProvider=e,this.protocolName="fluid:",this.blobCache=new mr,this.snapshotTreeCache=new mr,this.driverPolicies=Object.assign(Object.assign({},SK),t)}createContainer(e,t,r,i){return v(this,null,function*(){if(bn(t),e===void 0)throw new Error("Empty file summary creation isn't supported in this driver.");w(!!t.endpoints.ordererUrl,178);let o=Ml(t.url);if(!o.pathname)throw new Error("Parsed url should contain tenant and doc Id!!");let[,a]=o.pathname.split("/"),s=e.tree[".protocol"],c=e.tree[".app"];if(!(s&&c))throw new Error("Protocol and App Summary required in the full summary");let l=iE(s),h=oE(s),u=ue.create(r,"RouterliciousDriver"),d=new Ri(this.driverPolicies.maxConcurrentOrdererRequests),p=yield zo.load(a,void 0,this.tokenProvider,u,d,this.driverPolicies.enableRestLess,t.endpoints.ordererUrl),m=yield le.timedExecAsync(u,{eventName:"CreateNew",details:JSON.stringify({enableDiscovery:this.driverPolicies.enableDiscovery,sequenceNumber:l.sequenceNumber})},S=>v(this,null,function*(){let E=yield p.post(`/documents/${a}`,{summary:gb(c),sequenceNumber:l.sequenceNumber,values:h,enableDiscovery:this.driverPolicies.enableDiscovery,generateToken:this.tokenProvider.documentPostCreateCallback!==void 0});return S.end({docId:typeof E=="string"?E:E.id}),E})),f,x,b;typeof m=="string"?f=m:(f=m.id,x=m.token,b=this.driverPolicies.enableDiscovery?m.session:void 0),o=Ml(t.url);try{yield le.timedExecAsync(u,{eventName:"DocPostCreateCallback",docId:f},()=>v(this,null,function*(){if(x&&this.tokenProvider.documentPostCreateCallback!==void 0)return this.tokenProvider.documentPostCreateCallback(f,x)}))}catch(S){throw new _b(S)}o.set("pathname",bb(o.pathname,f));let _=t.endpoints.deltaStorageUrl;if(!_)throw new Error(`All endpoints urls must be provided. [deltaStorageUrl:${_}]`);let O=new URL(_);return O.pathname=bb(O.pathname,f),this.createDocumentService(Object.assign(Object.assign({},t),{url:o.toString(),id:f,endpoints:Object.assign(Object.assign({},t.endpoints),{deltaStorageUrl:O.toString()})}),r,i,b)})}createDocumentService(e,t,r,i){return v(this,null,function*(){bn(e);let o=Ml(e.url),[,a,s]=o.pathname.split("/");if(!s||!a)throw new Error(`Couldn't parse documentId and/or tenantId. [documentId:${s}][tenantId:${a}]`);let c=ue.create(t,"RouterliciousDriver",{all:{driverVersion:Ji}}),l=()=>v(this,null,function*(){if(!this.driverPolicies.enableDiscovery)return e;let m=new Ri(this.driverPolicies.maxConcurrentOrdererRequests),f=yield zo.load(a,s,this.tokenProvider,c,m,this.driverPolicies.enableRestLess,e.endpoints.ordererUrl),x=yield le.timedExecAsync(c,{eventName:"DiscoverSession",docId:s},()=>v(this,null,function*(){return f.get(`/documents/${a}/session/${s}`)}));return xb(e,x)}),h=i!==void 0?xb(e,i):yield l(),u=h.endpoints.storageUrl,d=h.endpoints.ordererUrl,p=h.endpoints.deltaStorageUrl;if(!d||!p)throw new Error(`All endpoints urls must be provided. [ordererUrl:${d}][deltaStorageUrl:${p}]`);return new Xp(h,d,p,u,c,this.tokenProvider,a,s,this.driverPolicies,this.blobCache,this.snapshotTreeCache,l)})}},_b=class extends Error{constructor(e){super(e.message),this.innerError=e,this.name="DocumentPostCreateError"}get stack(){return this.innerError.stack}};vt();var Yp=class{constructor(){}resolve(e){return v(this,null,function*(){let{ordererUrl:t,storageUrl:r,tenantId:i,containerId:o}=EK(e.url);if(e.headers&&e.headers[ki.createNew]===!0)return{endpoints:{deltaStorageUrl:`${t}/deltas/${i}/new`,ordererUrl:t,storageUrl:`${r}/repos/${i}`},id:"",tokens:{},type:"fluid",url:`${t}/${i}/new`};if(o===void 0)throw new Error("Azure URL did not contain containerId");let a=`${t}/${i}/${o}`;return{endpoints:{deltaStorageUrl:`${t}/deltas/${i}/${o}`,ordererUrl:t,storageUrl:`${r}/repos/${i}`},id:o,tokens:{},type:"fluid",url:a}})}getAbsoluteUrl(e,t){return v(this,null,function*(){if(e.type!=="fluid")throw new Error("Invalid Resolved Url");return`${e.url}/${t}`})}};function EK(n){let e=new URL(n),t=e.origin,r=e.searchParams,i=r.get("storage");if(i===null)throw new Error("Azure URL did not contain a storage URL");let o=r.get("tenantId");if(o===null)throw new Error("Azure URL did not contain a tenant ID");let a=decodeURIComponent(i),s=decodeURIComponent(o),c=r.get("containerId"),l=c!==null?decodeURIComponent(c):void 0;return{ordererUrl:t,storageUrl:a,tenantId:s,containerId:l}}var K3=(n,e)=>{let t=new URL(n);return t.searchParams.append("storage",encodeURIComponent(n)),t.searchParams.append("tenantId",encodeURIComponent(e)),{url:t.href,headers:{[ki.createNew]:!0}}};function yb(n){return n.type==="remote"}var AK="local",Zp=n=>yb(n)?n.tenantId:AK,kK=5,Sl=class{constructor(e){this.props=e,e.connection.endpoint=e.connection.endpoint.replace(/\/$/,""),this.urlResolver=new Yp;let t=yb(this.props.connection);this.documentServiceFactory=new Qp(this.props.connection.tokenProvider,{enableWholeSummaryUpload:t,enableDiscovery:t})}createContainer(e){return v(this,null,function*(){let r=yield this.createLoader(e).createDetachedContainer({package:"no-dynamic-package",config:{}}),i=yield this.createFluidContainer(r,this.props.connection),o=this.getContainerServices(r);return{container:i,services:o}})}copyContainer(e,t,r){return v(this,null,function*(){var i;let o=this.createLoader(t),a=new URL(this.props.connection.endpoint);a.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),a.searchParams.append("tenantId",encodeURIComponent(Zp(this.props.connection))),a.searchParams.append("containerId",encodeURIComponent(e));let s=yield o.resolve({url:a.href});if(s.resolvedUrl===void 0)throw new Error("Source container cannot resolve URL.");let l=yield(yield this.documentServiceFactory.createDocumentService(s.resolvedUrl)).connectToStorage(),h={type:il.Handle,handleType:il.Tree,handle:(i=r?.id)!==null&&i!==void 0?i:"latest"},u=yield l.downloadSummary(h),d=yield o.rehydrateDetachedContainerFromSnapshot(JSON.stringify(u)),p=yield this.createFluidContainer(d,this.props.connection),m=this.getContainerServices(d);return{container:p,services:m}})}getContainer(e,t){return v(this,null,function*(){let r=this.createLoader(t),i=new URL(this.props.connection.endpoint);i.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),i.searchParams.append("tenantId",encodeURIComponent(Zp(this.props.connection))),i.searchParams.append("containerId",encodeURIComponent(e));let o=yield r.resolve({url:i.href}),a=yield Ar(o,"/"),s=new ac(o,a),c=this.getContainerServices(o);return{container:s,services:c}})}getContainerVersions(e,t){return v(this,null,function*(){var r;let i=new URL(this.props.connection.endpoint);i.searchParams.append("storage",encodeURIComponent(this.props.connection.endpoint)),i.searchParams.append("tenantId",encodeURIComponent(Zp(this.props.connection))),i.searchParams.append("containerId",encodeURIComponent(e));let o=yield this.urlResolver.resolve({url:i.href});if(!o)throw new Error("Unable to resolved URL");return(yield(yield(yield this.documentServiceFactory.createDocumentService(o)).connectToStorage()).getVersions(null,(r=t?.maxCount)!==null&&r!==void 0?r:kK)).map(l=>({id:l.id,date:l.date}))})}getContainerServices(e){return{audience:new Vh(e)}}createLoader(e){let t=new Lh(e),i={load:()=>v(this,null,function*(){return{module:{fluidExport:t},details:{package:"no-dynamic-package",config:{}}}})},o={details:{capabilities:{interactive:!0}},permission:[],scopes:[],user:{id:""},mode:"write"};return new nl({urlResolver:this.urlResolver,documentServiceFactory:this.documentServiceFactory,codeLoader:i,logger:this.props.logger,options:{client:o}})}createFluidContainer(e,t){return v(this,null,function*(){let r=K3(t.endpoint,Zp(t)),i=yield Ar(e,"/"),o=()=>v(this,null,function*(){if(e.attachState!==oe.Detached)throw new Error("Cannot attach container. Container is not in detached state");yield e.attach(r);let s=e.resolvedUrl;return bn(s),s.id}),a=new ac(e,i);return a.attach=o,a})}};var Vb=Ce(M5());var S5=Ce(fi());Y();var jb=class extends Pe{constructor(e,t){super(),this.signaler=e,this.emitter=new S5.EventEmitter,this.emitter.on("error",r=>{this.emit("error",r)}),this.managerId=t?`#${t}`:void 0,this.signaler.on("signal",(r,i)=>{let o=r.clientId;this.signaler.connected&&o!==null&&this.emitter.emit(r.type,o,i,r.content)})}getManagerSignalName(e){return this.managerId?`${e}${this.managerId}`:e}onSignal(e,t){let r=this.getManagerSignalName(e);return this.emitter.on(r,t),this}offSignal(e,t){let r=this.getManagerSignalName(e);return this.emitter.off(r,t),this}submitSignal(e,t){let r=this.getManagerSignalName(e);this.signaler.connected&&this.signaler.submitSignal(r,t)}},Ro=class extends Mo{get manager(){return w(this._manager!==void 0,587),this._manager}static get Name(){return"@fluid-example/signal-manager"}hasInitialized(){return v(this,null,function*(){this._manager=new jb(this.runtime),this.manager.on("error",e=>{this.emit("error",e)})})}onSignal(e,t){return this.manager.onSignal(e,t),this}offSignal(e,t){return this.manager.offSignal(e,t),this}submitSignal(e,t){this.manager.submitSignal(e,t)}};Ro.factory=new es(Ro.Name,Ro,[],{});Nt();var E5=(()=>{let e=class e{constructor(){this.userConfig={id:ke(),name:localStorage.getItem("userName")??this.getRandomName(),additionalDetails:{color:this.getRandomColor()}},this.remoteConnectionConfig={tenantId:process.env.NG_APP_TENANT_ID,type:"remote",tokenProvider:new Vb.InsecureTokenProvider(process.env.NG_APP_PRIMARY_KEY,this.userConfig),endpoint:process.env.NG_APP_ENDPOINT_URL},this.localConnectionConfig={type:"local",tokenProvider:new Vb.InsecureTokenProvider("",this.userConfig),endpoint:"http://localhost:7070"},this.useAzure=process.env.NG_APP_USE_AZURE,this.connectionConfig={connection:this.useAzure==="true"?this.remoteConnectionConfig:this.localConnectionConfig}}getFluidData(){return v(this,null,function*(){let r,i,o="",a={initialObjects:{map:Gi,signaler:Ro}},s=new Sl(this.connectionConfig);return!location.hash?({container:r,services:i}=yield s.createContainer(a),o=yield r.attach(),location.hash=o):(o=location.hash.substring(1),{container:r,services:i}=yield s.getContainer(o,a)),r.connectionState!==Ie.Connected&&(yield new Promise(l=>{r.once("connected",()=>{l()})})),{container:r,services:i,sharedMap:r.initialObjects.map,signaler:r.initialObjects.signaler,containerID:o}})}getRandomName(){let r=["Alice","Bob","Charlie","David","Eve","Frank","George","Hannah","Irene","Jack","Karen","Linda","Molly","Nancy","Olivia","Peter","Quelle","Richard","Susan","Tina","Ursula","Vicky","Wendy","Xavier","Yvonne","Zoe"];return r[Math.floor(Math.random()*r.length)]}getRandomColor(){let r=["red","green","blue","orange","purple","brown","chocolate","coral","cyan","darkblue","darkgreen","darkred","darkyellow","darkorange","darkpurple","darkpink","darkbrown","darkchocolate","darkcoral","darkcyan","cornflowerblue"];return r[Math.floor(Math.random()*r.length)]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var A5=(()=>{let e=class e{constructor(r){this.fluidContainerService=r,this.behaviorSubject$=new Al({elementToBeDrawn:[]}),this.elementToBeDrawn=[],this.behaviorSubjectObservable$=this.behaviorSubject$.asObservable()}initFluid(){return v(this,null,function*(){this.whiteBoardSharedMap||(this.fluidData=yield this.fluidContainerService.getFluidData(),this.whiteBoardSharedMap=this.fluidData.sharedMap,this.syncWhiteboardData(),this.mouseTracker=new IP(this.fluidData.container,this.fluidData.services.audience,this.fluidData.container.initialObjects.signaler))})}updatewhiteBoardSharedMap(r){this.whiteBoardSharedMap&&this.whiteBoardSharedMap.set("elementToBeDrawn",r)}syncWhiteboardData(){this.whiteBoardSharedMap&&(this.syncSharedMap=()=>{this.elementToBeDrawn=this.whiteBoardSharedMap.get("elementToBeDrawn")??[],this.behaviorSubject$.next({elementToBeDrawn:this.elementToBeDrawn})},this.syncSharedMap(),this.whiteBoardSharedMap.on("valueChanged",this.syncSharedMap))}};e.\u0275fac=function(i){return new(i||e)(ht(E5))},e.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var HK=["workarea"],UK=["whiteboard"],GK=["mouseTrackerDiv"];function WK(n,e){n&1&&(q(0,"span"),it(1," Warning: login to save your board "),j()),n&2&&tn("color","#fff")}var rye=(()=>{let e=class e{constructor(r,i,o,a,s,c,l){this._whiteboardService=r,this.fluidService=i,this.sharedService=o,this.dialog=a,this.toaster=s,this.router=c,this.route=l,this.selectedTool=_e.BRUSH,this.selectedElement=null,this.options=Is,this.zoom=Xg,this.outerWidth=b_,this.outerHeight=x_,this.x=__,this.y=y_,this.mouseTrackerDiv={}}handleDeleteKeyboardEvent(r){r.key==="Delete"||r.key==="Backspace"?this.deleteSelectedElement():r.getModifierState&&r.getModifierState("Control")&&(r.key==="z"?this.undoSelectedElement():r.key==="y"&&this.redoSelectedElement())}ngOnInit(){this.sharedService.setHasWhiteBoardLoaded(!0),this.initializeFluidService(),this.auth=this.sharedService.getAuth(),this.fireStore=this.sharedService.getFirestore(),this.sharedService.isLoggedIn().subscribe(r=>{this.isLoggedIn=!!r}),this.checkForMode()}toolSelectionChanged(r){this.selectedTool=r}zoomWheel(r){let i=r;if(i.altKey||i.ctrlKey){r.preventDefault();let o=this.zoom*100;this.setZoom(Math.trunc(o-i.deltaY/100*(i.altKey?10:5)))}}setZoom(r){let i=this.zoom,o=+r/100;o<.001&&(o=.1);let a={w:this.options.canvasWidth,h:this.options.canvasHeight},s=null;s!=null&&window.cancelAnimationFrame(s);let c=Date.now(),l=500,h=o-i,u=()=>{let p=(Date.now()-c)/l;p=Math.pow(p-1,3)+1,this.zoom=i+h*p,this.updateSize(a.w,a.h),p<1&&p>-.9?s=requestAnimationFrame(u):(this.zoom=o,this.updateSize(a.w,a.h))};u()}dataChanged(){this.fluidService.updatewhiteBoardSharedMap(this.whiteboard.data)}newDocument(){this._whiteboardService.erase()}saveAs(r){this._whiteboardService.save(r)}addImage(r){if(r){let i=r.files;if(i){let o=new FileReader;o.onload=a=>{let s=a.target.result;this._whiteboardService.addImage(s)},o.readAsDataURL(i[0])}}}undo(){this._whiteboardService.undo()}redo(){this._whiteboardService.redo()}colorChange(r,i){this.selectedElement?this.selectedElement.options[r]=i:(this.options[r]=i,this.options=this.options,this.updateOptions())}swapColors(){[this.options.fill,this.options.strokeColor]=[this.options.strokeColor,this.options.fill],this.updateOptions()}setSelectedElement(r){this.selectedElement=r}onSave(r){let i=navigator.clipboard;i&&(this.base64Img=r,i.writeText(r))}SaveToDB(){if(!this.boardID){this.dialog.open(Q_,{width:"300px"}).afterClosed().subscribe(i=>{i&&this.saveToFirestore(i)});return}this.saveToFirestore()}saveToFirestore(r){return v(this,null,function*(){this.saveAs(qr.Base64),setTimeout(()=>{this.boardID?this.editDoc():this.addDoc(r)},600)})}addDoc(r){let i=crypto.randomUUID();bx(_g(this.fireStore,"boards"),{user:this.auth?.currentUser?.email||null,board:JSON.stringify(this.whiteboard.data),name:r,id:i,boardBase64:this.base64Img}).then(o=>{this.boardID=o.id,this.router.navigate(["/whiteboard/board/"+this.boardID]),this.initializeFluidService(),this.toaster.success("Board saved successfully","Success")})}editDoc(){_x(yg(this.fireStore,"boards",this.boardID),{board:JSON.stringify(this.whiteboard.data),boardBase64:this.base64Img}).then(r=>{this.toaster.success("Board updated successfully","Success")})}deleteSelectedElement(){let r=this.whiteboard.data.findIndex(i=>i.id===this.selectedElement?.id);r>-1&&this.whiteboard.data.splice(r,1)}undoSelectedElement(){this._whiteboardService.undo()}redoSelectedElement(){this._whiteboardService.redo()}updateSize(r,i){this.options.canvasWidth=r,this.options.canvasHeight=i;let o=this.zoom,a=this.outerWidth,s=this.outerHeight,c=a/2-r*o/2,l=s/2-i*o/2;setTimeout(()=>{this.x=c,this.y=l},0)}updateOptions(){this.options=Object.assign({},this.options)}initializeFluidService(){return v(this,null,function*(){this.sharedService.hasWhiteBoardLoaded$().subscribe(r=>v(this,null,function*(){location.hash||(location.hash=this.fluidService?.fluidData?.containerID??""),r&&(yield this.fluidService.initFluid(),this.myself=yield this.fluidService.fluidData?.services.audience.getMyself(),this.fluidService.behaviorSubjectObservable$.subscribe(i=>{this.triggeredFromBehaviouSubject=!0,this.whiteboard.data=i.elementToBeDrawn}),w_(this.fluidService.mouseTracker,this.mouseTrackerDiv.nativeElement,this.myself))}))})}setBoard(){let r=_g(this.fireStore,"boards"),i=yg(r,this.boardID);this.boardLoading=!0,xx(i).then(o=>{this.boardLoading=!1,this.fluidService.updatewhiteBoardSharedMap(JSON.parse(o.data().board))})}checkForMode(){this.route.params.subscribe(r=>{r.id?(this.boardID=r.id,this.setBoard()):location.hash!==this.fluidService?.fluidData?.containerID&&this.fluidService.updatewhiteBoardSharedMap(null),this.sharedService.setIsNewBoard(!this.boardID)})}};e.\u0275fac=function(i){return new(i||e)(X(ks),X(A5),X(Dx),X(qs),X(vx),X(fx),X(gx))},e.\u0275cmp=fe({type:e,selectors:[["app-whiteboard-component"]],viewQuery:function(i,o){if(i&1&&(Ct(HK,5),Ct(UK,5),Ct(GK,7)),i&2){let a;Xe(a=Je())&&(o.workarea=a.first),Xe(a=Je())&&(o.whiteboard=a.first),Xe(a=Je())&&(o.mouseTrackerDiv=a.first)}},hostBindings:function(i,o){i&1&&K("keyup",function(s){return o.handleDeleteKeyboardEvent(s)},!1,xs)},standalone:!0,features:[gn([ks]),xe],decls:34,vars:22,consts:[["workarea",""],["whiteboard",""],["mouseTrackerDiv",""],[1,"whiteboard-container"],[1,"editor"],["id","rulers"],["id","ruler_corner"],["id","ruler_x"],["id","ruler_y"],["id","workarea",1,"select",2,"overflow","scroll",3,"mousewheel"],["id","svgcanvas"],[3,"selectElement","save","toolChanged","undo","redo","click","drag","drop","selectedTool","options","strokeWidth","zoom","canvasHeight","canvasWidth","center","fullScreen","strokeColor","fill","backgroundColor"],["id","menu_bar",1,"active"],[3,"onNewDocument"],[3,"onSaveAs"],[3,"onImageAdd"],[3,"onUndo"],[3,"onRedo"],[3,"onSaveToDB","disabled"],[3,"color",4,"ngIf"],["id","tools_left",1,"tools_panel"],[3,"onToolSelectionChanged","selectedTool"],[3,"onColorChange","onSwapColors"],["id","tools_bottom",1,"tools_panel"],[3,"onZoom","zoom"]],template:function(i,o){if(i&1){let a=yt();q(0,"div",3)(1,"div",4)(2,"div",5),Z(3,"div",6)(4,"div",7)(5,"div",8),j(),q(6,"div",9,0),K("mousewheel",function(c){return ae(a),se(o.zoomWheel(c))}),q(8,"div",10)(9,"ng-whiteboard",11,1),K("selectElement",function(c){return ae(a),se(o.setSelectedElement(c))})("save",function(c){return ae(a),se(o.onSave(c))})("toolChanged",function(c){return ae(a),se(o.selectedTool=c)})("selectElement",function(){return ae(a),se(o.dataChanged())})("undo",function(){return ae(a),se(o.dataChanged())})("redo",function(){return ae(a),se(o.dataChanged())})("click",function(){return ae(a),se(o.dataChanged())})("drag",function(){return ae(a),se(o.dataChanged())})("drop",function(){return ae(a),se(o.dataChanged())})("drag",function(){return ae(a),se(o.dataChanged())}),j()()(),q(11,"div",12)(12,"app-whiteboard-new-document",13),K("onNewDocument",function(){return ae(a),se(o.newDocument())}),j(),q(13,"app-whiteboard-save-as-menu",14),K("onSaveAs",function(c){return ae(a),se(o.saveAs(c))}),j(),q(14,"app-whiteboard-add-image",15),K("onImageAdd",function(c){return ae(a),se(o.addImage(c))}),j(),q(15,"app-whiteboard-undo",16),K("onUndo",function(){return ae(a),se(o.undo())}),j(),q(16,"app-whiteboard-redo",17),K("onRedo",function(){return ae(a),se(o.redo())}),j(),q(17,"app-whiteboard-save-to-db",18),K("onSaveToDB",function(){return ae(a),se(o.SaveToDB())}),j(),we(18,WK,2,2,"span",19),j(),q(19,"div",20)(20,"app-whitebord-button-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(21,"app-whiteboard-brush-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(22,"app-whiteboard-image-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(23,"app-whiteboard-line-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(24,"app-whiteboard-rect-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(25,"app-whiteboard-ellipse-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(26,"app-whiteboard-text-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(27,"app-whiteboard-eraser-tool",21),K("onToolSelectionChanged",function(c){return ae(a),se(o.toolSelectionChanged(c))}),j(),q(28,"app-whiteboard-color-tool",22),K("onColorChange",function(c){return ae(a),se(o.colorChange(c.type,c.event))})("onSwapColors",function(){return ae(a),se(o.swapColors())}),j(),it(29,"\xA0 "),j(),q(30,"div",23)(31,"app-whiteboard-zoom-panel",24),K("onZoom",function(c){return ae(a),se(o.setZoom(c))}),j()()()(),Z(32,"div",null,2)}i&2&&(H(9),ee("selectedTool",o.selectedTool)("options",o.options)("strokeWidth",o.options.strokeWidth)("zoom",o.zoom)("canvasHeight",o.options.canvasHeight)("canvasWidth",o.options.canvasWidth)("center",!0)("fullScreen",!1)("strokeColor",o.options.strokeColor)("fill",o.options.fill)("backgroundColor",o.options.backgroundColor),H(8),ee("disabled",!o.isLoggedIn),H(),ee("ngIf",!o.isLoggedIn),H(2),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(),ee("selectedTool",o.selectedTool),H(4),ee("zoom",o.zoom))},dependencies:[Wn,ro,jx,Lx,Kl,dd,z_,iy,Y_,Z_,ey,ty,ny,ry,oy,ay,sy,cy,ly,dy,uy,hy,py],styles:[`@charset "UTF-8";.editor{--z0: #111827;--z1: #1e2433;--a1: #421f24;--b1: #45322a;--c1: #1c3b3b;--z2: #2b313f;--z3: #393e4c;--z4: #474c59;--z5: #565a66;--z6: #656974;--z7: #747782;--a7: #d4100b;--z8: #848790;--z9: #94969f;--z10: #a4a6ae;--z12: #c5c7cc;--z13: #d6d8db;--z14: #e7e9eb;--z15: #f9fafb;--d0: #152239;--d1: #1a3050;--d4: #1e5a9d;--d6: #1779d4;--d7: #0b89f0;--d8: #3797ff;--d9: #62a3ff;--d13: #c3d4fd;--d14: #d7e2fd;--d15: #eaeffc;-webkit-font-smoothing:antialiased;--shadow-bg: 0 var(--x2) var(--x4) var(--z0);--shadow: 0 var(--x1) var(--x8) rgba(0, 0, 0, .4);--accent1: var(--d1);--accent4: var(--d4);--accent6: var(--d6);--accent7: var(--d7);--accent8: var(--d8);--accent9: var(--d9);--accent13: var(--d13);--accent14: var(--d14);--accent15: var(--d15);--x1: 4px;--x2: 8px;--x3: 12px;--x4: 16px;--x5: 20px;--x6: 24px;--x7: 28px;--x8: 32px;--x9: 36px;--x10: 40px;--x12: 48px;--x13: 52px;--x16: 64px;--mono-font: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;--panel-width: calc(var(--x10) * 2 * 2 + var(--x1));--transition-duration: .2s;--transition: all var(--transition-duration) ease}.whiteboard-container{width:100%;height:768px;border:2px dashed #ccc;background:#fff;overflow:hidden;position:relative}.editor{background:var(--z1);font:14px/120% -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;padding:.5rem 0}::selection{background:#000;color:#fff}::-moz-selection{background:#000;color:#fff}.editor{overscroll-behavior-x:none;overflow:hidden;width:100%;height:100%}::-webkit-scrollbar{width:var(--x1);height:var(--x1);background:transparent;position:absolute}::-webkit-scrollbar-track{border-radius:10px;background:transparent}::-webkit-scrollbar-thumb{border-radius:10px;background:var(--z3)}::-webkit-scrollbar-corner{background:transparent}input[type=submit],input[type=button],button{background:var(--accent7);color:var(--z15);border-radius:var(--x1);padding:var(--x2) var(--x4);border:none;line-height:140%;font-size:16px;font-weight:550;cursor:pointer}input[type=submit]:hover,input[type=button]:hover,button:hover{background:var(--accent9)}input[type=submit]:active,input[type=button]:active,button:active{box-shadow:0 0 0 var(--x1) var(--accent14);outline:none}input[type=submit]:focus,input[type=button]:focus,button:focus{outline:none}button.cancel,input.Cancel,input.cancel,input.jGraduate_Cancel{-webkit-appearance:none;background-color:var(--z12);color:var(--z3);margin:0}#canvas_panel{display:block}#tool_bold span,#tool_italic span{position:absolute;width:100%;height:100%;top:0;left:0;background:#ccc;opacity:0}#tools_bottom{position:absolute;left:var(--x12);right:0;bottom:0;height:var(--x10);overflow:visible}.clearfix:before,.clearfix:after{content:"";display:table}.clearfix:after{clear:both}#color_canvas_tools,#fill_bg,#stroke_bg{background:var(--z15) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAQMAAABsu86kAAAAA3NCSVQICAjb4U/gAAAABlBMVEXu7u7///8o06qaAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFXRFWHRDcmVhdGlvbiBUaW1lADcvMjIvMTL7FNdCAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAABFJREFUCJljYP7AgIb+MKAhAM8/C5vWL6zSAAAAAElFTkSuQmCC) top left repeat}#color_canvas_tools{width:60px;height:40px;margin:23px 5px 5px;position:relative;overflow:hidden}#color_canvas_tools{display:block}#stroke_style_label{font-size:30px;margin-top:33px;letter-spacing:-1px}.stroke_tool .caret{top:60%}.draginputs{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.draginput{background-color:var(--z2);border-radius:var(--x1);width:calc(50% - var(--x2));height:calc(var(--x9) * 2);display:block;position:relative;margin:0 var(--x2) var(--x2) 0;overflow:hidden;transition:var(--transition);box-shadow:none}.dragging .draginput{pointer-events:none}.dragging .draginput.active{pointer-events:all;box-shadow:none}.draginput:hover{background-color:var(--z3);transition:none;box-shadow:var(--shadow-bg)}.draginput:hover span,.draginput.active span{color:var(--z15)}.draginput:hover input,.draginput.active input{color:var(--accent8)}.draginput.active,.draginput.active:hover{background-color:var(--z0)}.draginput.active:hover{transition:none}.draginput .caret{border:solid transparent 5px;border-top-color:var(--z9);position:absolute;width:0;height:0;right:5px;margin-top:-2px;top:50%}.draginput label{margin:28px 10px 0 5px;font-size:14px;color:var(--z15);font-weight:700}.draginput label#resolution_label,.draginput label#seg_type_label{font:700 12px/110% sans-serif;position:absolute;left:auto;right:10px;z-index:0;text-align:right}.draginput label#seg_type_label{margin-top:40px}.draginput label#seg_type_label .caret{top:66%}.draginput label#resolution_label .pull{position:relative;left:-15px}.draginput label#resolution_label span{right:-13px;left:auto;font-size:16px;top:2px;font-weight:700;color:#fff}.draginput input{border:none;background:transparent;font:24px/normal sans-serif;text-align:center;color:var(--accent7);padding:30px 0 16px;width:100%;height:24px;position:relative;z-index:2}.draginput input::selection{background:var(--accent9)}.draginput.text-input input,.draginput.text-input input:hover,.draginput.text-input input:active{cursor:text}.draginput.text-input input{text-align:left;text-indent:var(--x2)}.draginput.textcontent input{cursor:text;text-align:left;text-indent:var(--x2)}.draginput.textcontent input,.draginput.textcontent input:hover,.draginput.textcontent input:active{cursor:text}.draginput input,.draginput input:hover,.draginput input:active{cursor:grab;cursor:-webkit-grab;cursor:-moz-grab}.draginput input[type=checkbox],.draginput input[type=checkbox]:hover,.draginput input[type=checkbox]:active{cursor:pointer}.draginput input:invalid{color:var(--a7)}.draginput span{font:12px/130% sans-serif;color:var(--z8);display:block;position:absolute;top:5px;left:5px;text-align:left;white-space:nowrap;z-index:1}.draginput select{-webkit-appearance:none;opacity:0;display:block;position:absolute;height:100%;width:100%;margin:0;z-index:1;top:0;left:0;cursor:pointer}.draginput:hover .draginput_cursor{border-color:var(--accent6)}.draginput_cursor{position:absolute;top:50%;width:100%;border-top:solid var(--accent4) 1px;z-index:0}.draginput input[readonly=readonly]{-webkit-appearance:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.draginput input:focus{background:var(--accent7);color:var(--accent15);outline:none;box-shadow:0 0 5px 2px var(--accent7)}.draginput input:focus+span{z-index:10;color:var(--z15)}.draginput .push_bottom{bottom:0;position:absolute}.draginput .angle{width:var(--x12);height:var(--x12);border-radius:var(--x12);background-color:var(--z3);position:absolute;bottom:var(--x1);left:14px}.editor.dragging .draginput .angle{background-color:var(--z1)}.draginput:hover .angle{background:var(--z4)}.draginput .angle-cursor{width:4px;height:25px;border-top:solid var(--accent7) 3px;position:absolute;margin:0 0 0 23px;transform-origin:50% 0}#menu_bar{padding:0 0 1rem var(--x12);position:relative;z-index:2;height:var(--x8);display:flex}#menu_bar .menu:hover .menu_list{display:block}.menu{position:relative;z-index:5;color:var(--z3);display:inline-block}.menu_title{cursor:pointer;display:inline-block;z-index:10;color:var(--z15);position:relative;line-height:var(--x8);padding:0 var(--x3);vertical-align:top}.menu .menu_title:hover{background:var(--z2)}.menu_list .separator{margin:var(--x1) 0;border-top:solid var(--z14) 1px}.menu_list{position:absolute;left:0;top:var(--x8);white-space:nowrap;background:var(--z15);padding:var(--x2) 0;border-radius:0 var(--x2) var(--x2) var(--x2);box-shadow:var(--shadow)}#menu_bar.active .menu.open .menu_title{background:var(--z15);color:var(--z1)}.menu .menu_list{display:none;position:absolute}.menu_list .menu_item{position:relative;overflow:hidden;line-height:var(--x6);padding:var(--x1) var(--x16) var(--x1) var(--x6);cursor:pointer;color:var(--z3)}.file-input{-webkit-appearance:none;position:absolute;opacity:0;cursor:pointer;inset:0;display:block;background:red;z-index:100}.menu_list .menu_item.tool_button{background:transparent;border:none;margin:0;padding:var(--x1) var(--x16) var(--x1) var(--x6);height:auto;width:auto}.menu_list .menu_item.push_button_pressed:before{content:"\\2714";position:absolute;display:block;left:6px;top:var(--x1)}.menu_list .menu_item:hover,.menu_list .menu_item.push_button_pressed:hover{background:var(--accent15);color:#000}.menu_list .menu_item.disabled:hover,.menu_list .menu_item.push_button_pressed.disabled:hover{background:transparent;color:var(--z3)}.menu_list .menu_item.push_button_pressed{background:transparent;border:none;width:auto;height:auto;margin:0}.menu_list .menu_item span{display:block;position:absolute;right:var(--x2);padding:0 var(--x2);background:var(--z14);top:50%;transform:translateY(-50%);text-align:center;font-size:12px;line-height:var(--x6);border-radius:var(--x1);font-weight:600}.menu_list .menu_item:not(.disabled):hover span{background:var(--accent13)}.menu-right button:hover svg{fill:var(--z12)}.menu-right svg{fill:var(--z5)}#logo svg{pointer-events:none;margin-top:var(--x2);fill:var(--z7)}#logo svg path:last-child{fill:var(--z13)}#logo:hover svg{fill:var(--z9)}#logo svg path:last-child{fill:var(--z15)}#rulers>div{position:absolute;background:var(--z2);z-index:1;overflow:hidden;-webkit-font-smoothing:none}#rulers #ruler_corner{top:var(--x8);left:var(--x12);width:var(--x4);height:var(--x4);z-index:2;border-radius:var(--x2) 0 0 0}#ruler_x{height:var(--x4);top:var(--x8);left:var(--x12);right:calc(var(--panel-width) + var(--x4));overflow:hidden;border-radius:var(--x2)}#ruler_y{width:var(--x4);top:var(--x8);left:var(--x12);bottom:var(--x10);overflow:hidden;border-radius:var(--x2)}#ruler_x>div,#ruler_y>div{overflow:hidden}#stroke_color:after{content:"";position:absolute;display:block;left:var(--x1);right:var(--x1);top:var(--x1);bottom:var(--x1);background:var(--z1);box-shadow:0 0 0 1px var(--z13)}#tool_switch{cursor:pointer;width:11px;height:11px;position:absolute;top:-5px;right:0;cursor:nwse-resize}#tool_switch svg{fill:var(--z6)}#tool_switch:hover svg{fill:var(--z15)}.color_block{width:var(--x5);height:var(--x5);overflow:hidden;border:solid var(--z12) 1px;cursor:pointer}.color_block svg{width:22px;height:22px}#tool_stroke .color_block>div{position:absolute;bottom:0;right:0}#color_tools{position:relative;width:48px;height:48px;margin:12px 6px 0}#color_tools{width:auto;height:auto}#tool_fill{position:absolute;top:0;left:0;z-index:1}#tool_stroke{top:14px;left:14px}#tool_fill,#tool_stroke,#tool_canvas{box-shadow:0 0 0 1px var(--z0);position:absolute}#tool_canvas .color_block{width:58px;height:38px}#tool_canvas .color_block svg{width:auto;height:auto}#shape_cats>div{padding:0 var(--x4);background:var(--z14);color:var(--z6);height:var(--x7);line-height:var(--x7);transition:background-color .1s ease}#svgcanvas{background-color:var(--z2);display:block;width:100%;height:100%}#workarea{display:block;position:absolute;top:var(--x8);left:var(--x12);bottom:var(--x10);right:calc(var(--panel-width) + var(--x4));background-color:var(--z2);overflow:auto;align-items:center;justify-content:center;transition:transform .5s cubic-bezier(.13,.66,.24,.92);border-radius:var(--x2);box-shadow:var(--shadow-bg)}#tools_left{position:absolute;border-right:none;width:var(--x12);top:var(--x8);bottom:0;left:0;z-index:4}.tool_button{height:var(--x12);width:var(--x12);cursor:pointer;line-height:60px;text-align:center;transform:scale(.8)}.tool_button:hover{transform:scale(1)}.tool_button:hover svg{fill:var(--z13)}.tool_button.active{transform:scale(1.4)}.tool_button svg{vertical-align:center;fill:var(--z5)}.tool_button.active svg{fill:var(--accent8)}.tool_button.active svg{fill:var(--accent7)}.tool_button.disabled svg{background-color:#aaa;cursor:not-allowed;fill:var(--z3);pointer-events:none}#tool_rect svg{position:relative;top:-1px;left:1px}#tool_ellipse svg{position:relative;top:2px;left:1px}.select-input{margin:var(--x2) 0;position:relative}.select-input:after{content:"\\2193";font-weight:700;position:absolute;right:var(--x6);top:50%;color:var(--z7);transform:translateY(-50%)}.select-input select{-webkit-appearance:none;background-color:var(--z3);color:var(--z14);height:var(--x8);display:block;width:calc(100% - var(--x2));padding:0 var(--x4);border:none;border-radius:var(--x1)}.select-input select:focus{outline:none;box-shadow:0 0 0 1px var(--accent7)}#panels{position:absolute;box-sizing:border-box;width:var(--panel-width);right:var(--x1);top:var(--x5);bottom:0;border-bottom:none;overflow:auto;padding:0}.context_panel{display:none}.context_panel h4{color:var(--z15);font-weight:400;margin:0;padding:10px 0 5px}.context_panel label{display:block;color:var(--z13);white-space:nowrap}#align_tools{display:none}.align_buttons{margin-bottom:var(--x2)}.align_button,.align_button *{transition:var(--transition)}.align_button:hover,.align_button:hover *{transition:none}.align_button{float:left;height:var(--x13);width:var(--x13);line-height:var(--x16);text-align:center;cursor:pointer;position:relative}.align_button:hover{background-color:var(--z0);border-color:var(--z3)}.align_button svg{fill:var(--z10)}.align_button:hover svg{fill:var(--z15);transition:none}.align_button:nth-child(1){border-radius:var(--x1) 0 0 0}.align_button:nth-child(3){border-radius:0 var(--x1) 0 0}.align_button:nth-child(4){border-radius:0 0 0 var(--x1)}.align_button:nth-child(6){border-radius:0 0 var(--x1) 0}.align_buttons .push_button{display:block;float:left}#tool_bold,#tool_italic{font:700 20px/35px serif;text-align:center;position:absolute;padding:0;color:var(--z13);background:transparent;border:none;margin:0;width:50%;top:var(--x8);line-height:var(--x10);bottom:0;border-top:solid var(--z1) 2px;cursor:pointer}#tool_bold{right:0}#tool_italic{border-right:solid var(--z1) 2px;line-height:var(--x9);left:0;font-weight:700;font-style:italic;font-size:24px}#tool_bold:hover,#tool_italic:hover{color:var(--z15);background-color:var(--z3)}#tool_bold.disabled,#tool_italic.disabled{opacity:1;color:var(--z4);pointer-events:none}#tool_bold.active,#tool_italic.active{color:#50a0ff}#preview_font{color:var(--z15);font-size:2em;line-height:80px;padding:0 var(--x2);white-space:nowrap}#preview_font+.caret{right:var(--x2)}.draginput:hover #preview_font:after{border-right-color:var(--z3);background:linear-gradient(to right,rgba(0,0,0,0),var(--z3))}#preview_font:after{content:"";position:absolute;right:0;top:3px;bottom:3px;width:15px;border-right:solid var(--z2) 10px;background:linear-gradient(to right,rgba(0,0,0,0),var(--z2))}#zoom_panel,#zoom_select{padding:var(--x2) 0;right:calc(var(--panel-width) + var(--x2));position:absolute;cursor:pointer;width:100px}#zoom_label:after{content:""}#zoom_select{opacity:0;z-index:100}#zoom_select:hover+div{opacity:1}#zoom_label{position:absolute;background:transparent;width:100%;margin:0}#zoom_panel .caret{margin-top:-5px}#zoom_label img,#zoom_label svg{width:var(--x4);height:var(--x4)}#zoomLabel{width:var(--x4);height:var(--x4);cursor:pointer}#zoomLabel svg{fill:var(--z10);position:relative;top:2px}#zoom_label input{-webkit-appearance:none;color:var(--z10);font-size:13px;height:auto;width:var(--x12);padding:0;cursor:default;position:absolute;background:transparent;border:none;top:2px;left:var(--x6);pointer-events:none}#zoom_label select{-webkit-appearance:none;position:absolute;inset:0}#zoom_label span{top:0;left:0}
`],encapsulation:3});let n=e;return n})();export{rye as a};
